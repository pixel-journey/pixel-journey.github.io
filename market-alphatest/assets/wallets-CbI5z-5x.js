const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/protocol-scatter.m-DczvepMa.js","assets/wharfkit-D5dpuvSo.js","assets/vendor--z6sR0Be.js"])))=>i.map(i=>d[i]);
import{a as e}from"./vendor--z6sR0Be.js";import{U as t,C as n,a as r,S as o,B as i,b as s,P as a,c,d as u,e as l,A as d,W as h,L as p,f,R as g,g as y,_ as m,h as w,i as v,j as b,k as A,l as E,m as S,n as I,o as T,p as C,I as k,T as N,N as O,q as x,r as D,s as _}from"./wharfkit-D5dpuvSo.js";const R={},M=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),o=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/market-alphatest/"+e}(e))in R)return;R[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,o&&r.setAttribute("nonce",o),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})};var P,L={exports:{}};const U=e((P||(P=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function s(e,t){0===--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,s){var a=n?n+e:e;if(!this._events[a])return!1;var c,u,l=this._events[a],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,o),!0;case 5:return l.fn.call(l.context,t,r,o,i),!0;case 6:return l.fn.call(l.context,t,r,o,i,s),!0}for(u=1,c=new Array(d-1);u<d;u++)c[u-1]=arguments[u];l.fn.apply(l.context,c)}else{var h,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(e,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,t);break;case 3:l[u].fn.call(l[u].context,t,r);break;case 4:l[u].fn.call(l[u].context,t,r,o);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];l[u].fn.apply(l[u].context,c)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,u=[],l=a.length;c<l;c++)(a[c].fn!==t||o&&!a[c].once||r&&a[c].context!==r)&&u.push(a[c]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}(L)),L.exports));
/**
 * @greymass/buoy v1.0.4
 * https://github.com/greymass/buoy-client
 *
 * @license
 * Copyright (c) 2021 FFF00 Agents AB & Greymass Inc. All Rights Reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 *  1. Redistribution of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 * 
 *  2. Redistribution in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 * 
 *  3. Neither the name of the copyright holder nor the names of its contributors
 *     may be used to endorse or promote products derived from this software without
 *     specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE
 * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.
 */class j extends Error{event;code="E_NETWORK";constructor(e){super("Socket error"),this.event=e}}class K extends Error{reason;underlyingError;code="E_MESSAGE";constructor(e,t){super(e),this.reason=e,this.underlyingError=t}}const B=globalThis||window;var F,q;(q=F||(F={})).binary="binary",q.text="text",q.json="json";class V extends U{url;active=!1;socket;timer;reconnectTimer;encoding;WebSocket;constructor(e){if(super(),!e.service)throw new Error("Options must include a service url");if(!e.channel)throw new Error("Options must include a channel name");const t=e.service.replace(/^http/,"ws").replace(/\/$/,"");this.url=`${t}/${e.channel}?v=2`,this.encoding=e.encoding||F.text,this.WebSocket=e.WebSocket||B.WebSocket,!1!==e.autoConnect&&this.connect()}connect(){if(this.active)return;this.active=!0;let e,t=0;const n=()=>{const r=new this.WebSocket(this.url);r.onmessage=e=>{if("undefined"!=typeof Blob&&e.data instanceof Blob){const t=new FileReader;t.onload=()=>{this.handleMessage(new Uint8Array(t.result))},t.onerror=()=>{this.emit("error",new K("Could not read message"))},t.readAsArrayBuffer(e.data)}else if("string"==typeof e.data)this.handleMessage((new TextEncoder).encode(e.data));else if(void 0!==B.Buffer&&(e.data instanceof B.Buffer||Array.isArray(e.data))){let t=e.data;B.Buffer.isBuffer(t)||(t=B.Buffer.concat(t)),this.handleMessage(new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}else e.data instanceof Uint8Array?this.handleMessage(e.data):e.data instanceof ArrayBuffer?this.handleMessage(new Uint8Array(e.data)):this.emit("error",new K("Unhandled event data type"))},r.onerror=e=>{this.socket===r&&this.active&&this.emit("error",new j(e))},r.onopen=()=>{t=0,this.emit("connect")},r.onclose=()=>{var r;this.active&&(clearTimeout(this.timer),this.timer=setTimeout(n,(r=t++,Math.min(Math.pow(7*r,2),5e3)))),this.socket=void 0,clearTimeout(e),this.reconnectTimer&&clearInterval(this.reconnectTimer),this.emit("disconnect")},this.setupReconnectionTimer();const o=r;"function"==typeof o.on&&"function"==typeof o.terminate&&o.on("ping",()=>{clearTimeout(e),e=setTimeout(()=>{o.terminate()},15e3)}),this.socket=r};n()}disconnect(){this.active=!1,!this.socket||this.socket.readyState!==this.WebSocket.OPEN&&this.socket.readyState!==this.WebSocket.CONNECTING||this.socket.close(1e3)}get isConnected(){return this.active&&this.socket?.readyState==this.WebSocket.OPEN}handleMessage(e){let t;switch(66===e[0]&&66===e[1]&&1===e[2]&&(this.socket?.send(new Uint8Array([66,66,2,e[3]])),e=e.subarray(4)),this.encoding){case F.binary:t=e;break;case F.text:t=(new TextDecoder).decode(e);break;case F.json:try{t=JSON.parse((new TextDecoder).decode(e))}catch(n){return void this.emit("error",new K("Unable to decode JSON",n))}}this.emit("message",t)}setupReconnectionTimer(){this.reconnectTimer=setInterval(()=>{this.socket?.close(1e3)},6e5)}}const G=globalThis||window;var z,W;
/**
 * @wharfkit/sealed-messages v1.1.0
 * https://github.com/wharfkit/sealed-messages
 *
 * @license
 * Copyright (c) 2023 Greymass Inc. All Rights Reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * 1.  Redistribution of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 * 
 * 2.  Redistribution in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 * 
 * 3.  Neither the name of the copyright holder nor the names of its contributors
 *     may be used to endorse or promote products derived from this software without
 *     specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE
 * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.
 */
function Q(e,t,n,r){var o,i=arguments.length,s=i<3?t:r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}(W=z||(z={})).buffered="buffered",W.delivered="delivered";let J=class extends s{};async function Y(e,s,a,c){c||(c=t.random());const u=s.sharedSecret(a),l=function(e,t){return r.hash(o.encode({object:e}).appending(t.array))}(c,u),d=await async function(e,t){const n=r.hash(o.encode({object:t}).appending(e.array));return await crypto.subtle.importKey("raw",n.array.slice(0,32),{name:"AES-CBC"},!1,["encrypt","decrypt"])}(u,c),h=await async function(e,t,n){return i.from(await crypto.subtle.encrypt({name:"AES-CBC",iv:e.array.slice(32,48)},t,i.from(n,"utf8").array))}(l,d,e),p=new DataView(n.hash(l.array).array.buffer).getUint32(0,!0);return new J({from:s.toPublic(),nonce:c,ciphertext:h,checksum:p})}
/**
 * @wharfkit/protocol-esr v1.5.0
 * https://github.com/wharfkit/protocol-esr
 *
 * @license
 * Copyright (c) 2023 Greymass Inc. All Rights Reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * 1.  Redistribution of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 * 
 * 2.  Redistribution in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 * 
 * 3.  Neither the name of the copyright holder nor the names of its contributors
 *     may be used to endorse or promote products derived from this software without
 *     specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE
 * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.
 */function H(e,t,n,r){var o,i=arguments.length,s=i<3?t:r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}Q([s.field("public_key")],J.prototype,"from",void 0),Q([s.field("uint64")],J.prototype,"nonce",void 0),Q([s.field("bytes")],J.prototype,"ciphertext",void 0),Q([s.field("uint32")],J.prototype,"checksum",void 0),J=Q([s.type("sealed_message")],J),"function"==typeof SuppressedError&&SuppressedError;let Z=class extends s{};H([s.field("name")],Z.prototype,"session_name",void 0),H([s.field("public_key")],Z.prototype,"request_key",void 0),H([s.field("string",{extension:!0})],Z.prototype,"user_agent",void 0),Z=H([s.type("link_create")],Z);let X=class extends s{};H([s.field("time_point_sec")],X.prototype,"expiration",void 0),X=H([s.type("link_info")],X);let $=class extends s{};H([s.field("public_key")],$.prototype,"from",void 0),H([s.field("uint64")],$.prototype,"nonce",void 0),H([s.field("bytes")],$.prototype,"ciphertext",void 0),H([s.field("uint32")],$.prototype,"checksum",void 0),$=H([s.type("buoy_message")],$);let ee=class extends s{};H([s.field("name")],ee.prototype,"session_name",void 0),H([s.field("public_key")],ee.prototype,"request_key",void 0),H([s.field("string",{extension:!0})],ee.prototype,"user_agent",void 0),ee=H([s.type("buoy_session")],ee);let te=class extends s{};async function ne(e,t,n){const r=await(o={...e,WebSocket:t||WebSocket},new Promise((e,t)=>{const n=new V({...o,autoConnect:!0});let r,i;const s=(o,i)=>{clearTimeout(r),o?t(o):e(i),n.disconnect()};o.timeout&&(r=setTimeout(()=>{s(new K("Timed out",i))},o.timeout)),n.on("error",e=>{e instanceof j?i=e:s(e)}),n.once("message",e=>{s(void 0,e)})}));var o;if(!r)throw new Error(r.rejected);if("string"==typeof r.rejected)throw new Error(r.rejected);const i=JSON.parse(r);if(void 0===i.sa||void 0===i.sp||void 0===i.cid)throw new Error(n("error.cancelled",{default:"The request was cancelled from Anchor."}));return i}function re(){let e,t="";const n="0123456789abcdef";for(e=0;e<36;e+=1)switch(e){case 8:case 13:case 18:case 23:t+="-";break;case 14:t+="4";break;case 19:t+=n[4*Math.random()|8];break;default:t+=n[16*Math.random()|0]}return t}function oe(){if(!ie()||!de()){if(se())return"googlechrome://";if(ce())return"firefox:://";if(ie()&&ue())return"brave://";if(ie()){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t=window.location.href.split("#")[0]+"#";for(let n=0;n<8;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}return le()&&/Firefox/i.test(navigator.userAgent)?"android-app://org.mozilla.firefox":le()&&/Edg/.test(navigator.userAgent)?"android-app://com.microsoft.emmx":le()&&(/OPR/.test(navigator.userAgent)||/Opera/.test(navigator.userAgent))?"android-app://com.opera.browser":le()&&ue()?"android-app://com.brave.browser":le()&&he()?"android-app://webview":le()&&ae()?"android-app://com.android.chrome":window.location.href}}function ie(){return/iP(ad|od|hone)/i.test(navigator.userAgent)}function se(){return/CriOS/.test(navigator.userAgent)}function ae(){return/Chrome\/[.0-9]* Mobile/i.test(navigator.userAgent)}function ce(){return/FxiOS/.test(navigator.userAgent)}function ue(){return navigator.brave&&"function"==typeof navigator.brave.isBrave}function le(){return/Android/.test(navigator.userAgent)}function de(){return!!window.ReactNativeWebView}function he(){return/wv/.test(navigator.userAgent)||/Android/.test(navigator.userAgent)&&de()}function pe(){let e="@wharfkit/protocol-esr 1.5.0";return"undefined"!=typeof navigator&&(e+=" "+navigator.userAgent),e}function fe(e){const{service:t,channel:n}=e;return{url:`${t}/${n}`,background:!0}}function ge(e){return{service:e,channel:re()}}function ye(e){const t=[];let n=0,r=e.sig;for(;r;)t.push(String(r)),r=e[`sig${n}`],n++;return[...new Set(t)].map(e=>l.from(e))}H([s.field("time_point_sec")],te.prototype,"expiration",void 0),te=H([s.type("buoy_info")],te);
/**
 * @wharfkit/wallet-plugin-anchor v1.6.0
 * https://github.com/wharfkit/wallet-plugin-anchor
 *
 * @license
 * Copyright (c) 2023 Greymass Inc. All Rights Reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * 1.  Redistribution of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 * 
 * 2.  Redistribution in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 * 
 * 3.  Neither the name of the copyright holder nor the names of its contributors
 *     may be used to endorse or promote products derived from this software without
 *     specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE
 * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.
 */
var me={en:{login:{title:"Connect with Anchor",body:"Scan with Anchor on your mobile device or click the button below to open on this device.",link:"Launch Anchor"},transact:{title:"Complete using Anchor",body:'Please open your Anchor Wallet on "{{channelName}}" to review and approve this transaction.',label:"Sign manually or with another device",link:"Trigger Manually",await:"Waiting for response from Anchor"},error:{expired:"The request expired, please try again.",invalid_response:"Invalid response from Anchor, must contain link_ch, link_key, link_name and cid flags.",not_completed:"The request was not completed.",cancelled:"The request was cancelled from Anchor."}},ko:{},"zh-Hans":{login:{link:"启动Anchor",body:"在您的设备上使用Anchor扫描或者点击下方按钮打开。",title:"连接Anchor"},error:{cancelled:"请求已从Anchor取消。",not_completed:"此请求未完成。",invalid_response:"无效的Anchor响应，必须包含link_ch, link_key, link_name和cid标识符。",expired:"请求已过期，请重试。"},transact:{await:"等待Anchor响应",link:"手动触发",label:"手动或使用其他设备签约",body:'请在"{{channelName}}"上打开您的Anchor钱包以浏览并批准此交易。',title:"完成使用Anchor"}},"zh-Hant":{}};class we extends d{constructor(e){super(),this.id="anchor",this.translations=me,this.config={requiresChainSelect:!1,requiresPermissionSelect:!1},this.metadata=h.from({name:"Anchor",description:"",logo:p.from({dark:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS40NCwgMCwgMCwgMS40NCwgLTguNTAxOTI1LCAtNTcuMDc0NTcpIiBzdHlsZT0iIj4KICAgIDx0aXRsZT5XaGl0ZTwvdGl0bGU+CiAgICA8Y2lyY2xlIGN4PSI5NC43OTMiIGN5PSIxMjguNTI0IiByPSI4MCIgZmlsbD0iI0ZCRkRGRiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0gOTQuNzk5IDc4LjUyNCBDIDk3LjA5OCA3OC41MjQgOTkuMTk1IDc5LjgzNyAxMDAuMTk4IDgxLjkwNiBMIDEyNC4yMDQgMTMxLjQwNiBMIDEyNC43NDYgMTMyLjUyNCBMIDExMS40MDkgMTMyLjUyNCBMIDEwNy41MyAxMjQuNTI0IEwgODIuMDY5IDEyNC41MjQgTCA3OC4xODkgMTMyLjUyNCBMIDY0Ljg1MyAxMzIuNTI0IEwgNjUuMzk1IDEzMS40MDYgTCA4OS40MDEgODEuOTA2IEMgOTAuNDA0IDc5LjgzNyA5Mi41MDEgNzguNTI0IDk0Ljc5OSA3OC41MjQgWiBNIDg2LjkxOSAxMTQuNTI0IEwgMTAyLjY4IDExNC41MjQgTCA5NC43OTkgOTguMjc0IEwgODYuOTE5IDExNC41MjQgWiBNIDExMi43OTMgMTQ5LjUyNCBMIDEyNC43OTggMTQ5LjUyNCBDIDEyNC40MzcgMTY1LjY3NiAxMTEuMDY3IDE3OC41MjQgOTQuNzk5IDE3OC41MjQgQyA3OC41MzIgMTc4LjUyNCA2NS4xNjIgMTY1LjY3NiA2NC44MDEgMTQ5LjUyNCBMIDc2LjgwNiAxNDkuNTI0IEMgNzcuMDg3IDE1Ni44NzggODEuOTc0IDE2My4xNTUgODguNzkzIDE2NS41MiBMIDg4Ljc5MyAxNDEuNTI0IEMgODguNzkzIDEzOC4yMSA5MS40OCAxMzUuNTI0IDk0Ljc5MyAxMzUuNTI0IEMgOTguMTA3IDEzNS41MjQgMTAwLjc5MyAxMzguMjEgMTAwLjc5MyAxNDEuNTI0IEwgMTAwLjc5MyAxNjUuNTI0IEMgMTA3LjYyIDE2My4xNjIgMTEyLjUxMSAxNTYuODgzIDExMi43OTMgMTQ5LjUyNCBaIiBmaWxsPSIjMzY1MEEyIi8+CiAgPC9nPgo8L3N2Zz4=",light:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDE2MCAxNjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjgwIiBjeT0iODAiIHI9IjgwIiBmaWxsPSIjMzY1MEEyIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNODAuMDA2MyAzMEM4Mi4zMDUxIDMwIDg0LjQwMTkgMzEuMzEzNCA4NS40MDUgMzMuMzgxOEwxMDkuNDExIDgyLjg4MjJMMTA5Ljk1MyA4NEg5Ni42MTYzTDkyLjczNjYgNzZINjcuMjc1OUw2My4zOTYxIDg0SDUwLjA1OTRMNTAuNjAxNyA4Mi44ODE4TDc0LjYwNzcgMzMuMzgxOEM3NS42MTA4IDMxLjMxMzQgNzcuNzA3NSAzMCA4MC4wMDYzIDMwWk03Mi4xMjU2IDY2SDg3Ljg4N0w4MC4wMDYzIDQ5Ljc1MDFMNzIuMTI1NiA2NlpNOTcuOTk5NSAxMDFIMTEwLjAwNUMxMDkuNjQ0IDExNy4xNTIgOTYuMjczOCAxMzAgODAuMDA2MyAxMzBDNjMuNzM4OCAxMzAgNTAuMzY4NiAxMTcuMTUyIDUwLjAwNzggMTAxSDYyLjAxMzFDNjIuMjk0MSAxMDguMzU0IDY3LjE4MDQgMTE0LjYzMSA3NC4wMDAzIDExNi45OTZWOTNDNzQuMDAwMyA4OS42ODYzIDc2LjY4NjYgODcgODAuMDAwMyA4N0M4My4zMTQgODcgODYuMDAwMyA4OS42ODYzIDg2LjAwMDMgOTNWMTE3QzkyLjgyNjUgMTE0LjYzOCA5Ny43MTgzIDEwOC4zNTkgOTcuOTk5NSAxMDFaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K"}),homepage:"https://greymass.com/anchor",download:"https://greymass.com/anchor/download"}),this.buoyUrl=e?.buoyUrl||"https://cb.anchor.link",this.buoyWs=e?.buoyWs}login(e){return new Promise((t,n)=>{this.handleLogin(e).then(e=>{t(e)}).catch(e=>{n(e)})})}async handleLogin(e){if(!e.ui)throw new Error("No UI available");const t=e.ui.getTranslate(this.id),{callback:r,request:o,sameDeviceRequest:i,requestKey:s,privateKey:l}=await async function(e,t){const n=a.generate("K1"),r=n.toPublic(),o=ee.from({session_name:e.appName,request_key:r,user_agent:pe()}),i=!(e.chain||1===e.chains.length),s=ge(t),l=i?null:e.chain?c.from(e.chain.id.array):null,d=i?e.chains.map(e=>c.from(e.id.array)):[],h=u.identity({callback:fe(s),scope:String(e.appName),chainId:l,chainIds:d,info:{link:o,scope:String(e.appName)}},e.esrOptions),p=h.clone();if("undefined"!=typeof window){const e=oe();p.setInfoKey("same_device",!0),void 0!==e&&p.setInfoKey("return_path",e)}return{callback:s,request:h,sameDeviceRequest:p,requestKey:r,privateKey:n}}(e,this.buoyUrl),d=[{type:"link",label:t("login.link",{default:"Launch Anchor"}),data:{href:i.encode(!0,!1,"esr:"),label:t("login.link",{default:"Launch Anchor"}),variant:"primary"}}];ie()||se()||ae()||ce()||le()||he()||d.unshift({type:"qr",data:o.encode(!0,!1,"esr:")}),window.location.href=i.encode(!0,!1,"esr:");const h=e.ui?.prompt({title:t("login.title",{default:"Connect with Anchor"}),body:t("login.body",{default:"Scan with Anchor on your mobile device or click the button below to open on this device."}),elements:d});h.catch(()=>{console.info("Modal closed")});const p=await ne(r,this.buoyWs,t);if(async function(e,t){if(!e.sig||0===e.sig.length)throw new Error("Invalid response, must have at least one signature");let n;if(!t.chain&&t.chains.length>1){if(!e.cid)throw new Error("Multi chain response payload must specify resolved chain id (cid)")}else if(n=t.chain||t.chains[0],e.cid&&String(n.id)!==e.cid)throw new Error("Got response for wrong chain id")}(p,e),!p.cid||!p.sa||!p.sp)throw new Error("Invalid callback response");if(p.link_ch&&p.link_key&&p.link_name){this.data.requestKey=s,this.data.privateKey=l,this.data.signerKey=p.link_key&&f.from(p.link_key),this.data.channelUrl=p.link_ch,this.data.channelName=p.link_name;try{if(p.link_meta){const e=JSON.parse(p.link_meta);this.data.sameDevice=e.sameDevice,this.data.launchUrl=e.launchUrl,this.data.triggerUrl=e.triggerUrl}}catch(w){}}const m=(await g.fromPayload(p,e.esrOptions)).getIdentityProof(p.sig);return{chain:n.from(p.cid),permissionLevel:y.from({actor:p.sa,permission:p.sp}),identityProof:m}}sign(e,t){return this.handleSigningRequest(e,t)}async handleSigningRequest(e,t){if(!t.ui)throw new Error("No UI available");const n=t.ui.getTranslate(this.id),r=e.transaction.expiration.toDate(),i=new Date,s=Math.floor(r.getTime()-i.getTime()),c=await t.createRequest({transaction:e.transaction});c.setInfoKey("link",X.from({expiration:r}));const u=function(e,t){const n=ge(t);return e.setCallback(`${n.service}/${n.channel}`,!0),n}(c,this.buoyUrl),l=c.encode(!0,!1),d=!1!==this.data.sameDevice,h=c.clone(),p=oe();h.setInfoKey("same_device",!0),p&&h.setInfoKey("return_path",p),this.data.sameDevice&&(this.data.launchUrl?window.location.href=this.data.launchUrl:ie()&&(window.location.href="anchor://link"));const y=t.ui.prompt({title:n("transact.title",{default:"Complete using Anchor"}),body:n("transact.body",{channelName:this.data.channelName,default:`Please open your Anchor Wallet on "${this.data.channelName}" to review and approve this transaction.`}),elements:[{type:"countdown",data:{label:n("transact.await",{default:"Waiting for response from Anchor"}),end:r.toISOString()}},{type:"button",label:n("transact.label",{default:"Sign manually or with another device"}),data:{onClick:d?()=>window.location.href=h.encode():()=>{t.ui?.prompt({title:n("transact.sign_manually.title",{default:"Sign manually"}),body:n("transact.sign_manually.body",{default:"Scan the QR-code with Anchor on another device or use the button to open it here."}),elements:[{type:"qr",data:String(l)},{type:"link",label:n("transact.sign_manually.link.title",{default:"Open Anchor"}),data:{href:String(h),label:n("transact.sign_manually.link.title",{default:"Open Anchor"})}}]})},label:n("transact.label",{default:"Sign manually or with another device"})}}]}),m=setTimeout(()=>{if(!t.ui)throw new Error("No UI available");y.cancel(n("error.expired",{default:"The request expired, please try again."}))},s);y.catch(()=>clearTimeout(m));const w=ne(u,this.buoyWs,n);if(this.data.channelUrl){const e=new URL(this.data.channelUrl).origin,t=new URL(this.data.channelUrl).pathname.substring(1),n=await async function(e,t,n,r){return Y(e,t,n,r)}((this.data.sameDevice?h:c).encode(!0,!1,"esr:"),a.from(this.data.privateKey),f.from(this.data.signerKey));!async function(e,t){const n=t.fetch||G.fetch,r=`${t.service.replace(/^ws/,"http").replace(/\/$/,"")}/${t.channel}`,o={};if(t.requireDelivery){if(!t.timeout)throw new Error("requireDelivery can only be used with timeout");o["X-Buoy-Wait"]=`${Math.ceil(t.timeout/1e3)}`}else t.timeout&&(o["X-Buoy-Soft-Wait"]=`${Math.ceil(t.timeout/1e3)}`);let i;i="string"==typeof e||e instanceof Uint8Array?e:JSON.stringify(e);const s=await n(r,{method:"POST",body:i,headers:o});if(2!==Math.floor(s.status/100))throw 408===s.status?new Error("Unable to deliver message"):410===s.status?new Error("Request cancelled"):new Error(`Unexpected status code ${s.status}`);s.headers.get("X-Buoy-Delivery")||z.buffered}(o.encode({object:n}).array,{service:e,channel:t})}else window.location.href=h.encode();const v=await Promise.race([w,y]).finally(()=>{clearTimeout(m)});if("tx"in v&&ye(v).length>0){const e=await g.fromPayload(v,t.esrOptions);return{signatures:ye(v),resolved:e}}const b=n("error.not_completed",{default:"The request was not completed."});throw y.cancel(b),new Error(b)}}const ve=[];for(let Od=0;Od<256;++Od)ve.push((Od+256).toString(16).slice(1));let be;const Ae=new Uint8Array(16);const Ee={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Se(e,t,n){if(Ee.randomUUID&&!t&&!e)return Ee.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!be){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");be=crypto.getRandomValues.bind(crypto)}return be(Ae)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(ve[e[t+0]]+ve[e[t+1]]+ve[e[t+2]]+ve[e[t+3]]+"-"+ve[e[t+4]]+ve[e[t+5]]+"-"+ve[e[t+6]]+ve[e[t+7]]+"-"+ve[e[t+8]]+ve[e[t+9]]+"-"+ve[e[t+10]]+ve[e[t+11]]+ve[e[t+12]]+ve[e[t+13]]+ve[e[t+14]]+ve[e[t+15]]).toLowerCase()}(r)}const Ie="x-amz-user-agent";var Te,Ce;(Ce=Te||(Te={})).DEBUG="DEBUG",Ce.ERROR="ERROR",Ce.INFO="INFO",Ce.WARN="WARN",Ce.VERBOSE="VERBOSE",Ce.NONE="NONE";const ke={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};let Ne=class e{constructor(e,t=Te.WARN){this.name=e,this.level=t,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(t,...n){let r=this.level;e.LOG_LEVEL&&(r=e.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(r=window.LOG_LEVEL);if(!(ke[t]>=ke[r]))return;let o=console.log.bind(console);t===Te.ERROR&&console.error&&(o=console.error.bind(console)),t===Te.WARN&&console.warn&&(o=console.warn.bind(console)),e.BIND_ALL_LOG_LEVELS&&(t===Te.INFO&&console.info&&(o=console.info.bind(console)),t===Te.DEBUG&&console.debug&&(o=console.debug.bind(console)));const i=`[${t}] ${this._ts()} ${this.name}`;let s="";if(1===n.length&&"string"==typeof n[0])s=`${i} - ${n[0]}`,o(s);else if(1===n.length)s=`${i} ${n[0]}`,o(i,n[0]);else if("string"==typeof n[0]){let e=n.slice(1);1===e.length&&(e=e[0]),s=`${i} - ${n[0]} ${e}`,o(`${i} - ${n[0]}`,e)}else s=`${i} ${n}`,o(i,n);for(const e of this._pluggables){const t={message:s,timestamp:Date.now()};e.pushLogs([t])}}log(...e){this._log(Te.INFO,...e)}info(...e){this._log(Te.INFO,...e)}warn(...e){this._log(Te.WARN,...e)}error(...e){this._log(Te.ERROR,...e)}debug(...e){this._log(Te.DEBUG,...e)}verbose(...e){this._log(Te.VERBOSE,...e)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}};Ne.LOG_LEVEL=null,Ne.BIND_ALL_LOG_LEVELS=!1;let Oe=class e extends Error{constructor({message:t,name:n,recoverySuggestion:r,underlyingError:o,metadata:i}){if(super(t),this.name=n,this.underlyingError=o,this.recoverySuggestion=r,i){const{extendedRequestId:e,httpStatusCode:t,requestId:n}=i;this.metadata={extendedRequestId:e,httpStatusCode:t,requestId:n}}this.constructor=e,Object.setPrototypeOf(this,e.prototype)}};var xe,De;(De=xe||(xe={})).NoEndpointId="NoEndpointId",De.PlatformNotSupported="PlatformNotSupported",De.Unknown="Unknown",De.NetworkError="NetworkError";const _e="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",Re=new Ne("Hub");const Me=new class{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter(({callback:e})=>e!==t)]):Re.warn(`No listeners for ${e}`)}dispatch(e,t,n,r){if("string"==typeof e&&this.protectedChannels.indexOf(e)>-1){r===_e||Re.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`)}const o={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(o)}catch(i){Re.error(i)}}listen(e,t,n="noname"){let r;if("function"!=typeof t)throw new Oe({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});r=t;let o=this.listeners.get(e);return o||(o=[],this.listeners.set(e,o)),o.push({name:n,callback:r}),()=>{this._remove(e,r)}}_toListeners(e){const{channel:t,payload:n}=e,r=this.listeners.get(t);r&&r.forEach(r=>{Re.debug(`Dispatching to ${t} with `,n);try{r.callback(e)}catch(o){Re.error(o)}})}}("__default__"),Pe=e=>e&&e.nonRetryable,Le=new Ne("retryUtil");const Ue=e=>{const t=Reflect.ownKeys(e);for(const n of t){const t=e[n];(t&&"object"==typeof t||"function"==typeof t)&&Ue(t)}return Object.freeze(e)},je=new Ne("parseAWSExports"),Ke={API_KEY:"apiKey",AWS_IAM:"iam",AMAZON_COGNITO_USER_POOLS:"userPool",OPENID_CONNECT:"oidc",NONE:"none",AWS_LAMBDA:"lambda",LAMBDA:"lambda"},Be=e=>e?.split(",")??[],Fe=({domain:e,scope:t,redirectSignIn:n,redirectSignOut:r,responseType:o})=>({domain:e,scopes:t,redirectSignIn:Be(n),redirectSignOut:Be(r),responseType:o}),qe=e=>e.map(e=>{const t=e.toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}),Ve=Symbol("oauth-listener");function Ge(e){const t={};if(e.storage&&(t.Storage=function(e){if(!e)return;const{bucket_name:t,aws_region:n,buckets:r}=e;return{S3:{bucket:t,region:n,buckets:r&&He(r)}}}(e.storage)),e.auth&&(t.Auth=function(e){if(!e)return;const{user_pool_id:t,user_pool_client_id:n,identity_pool_id:r,password_policy:o,mfa_configuration:i,mfa_methods:s,unauthenticated_identities_enabled:a,oauth:c,username_attributes:u,standard_required_attributes:l,groups:d}=e,h={Cognito:{userPoolId:t,userPoolClientId:n,groups:d}};return r&&(h.Cognito={...h.Cognito,identityPoolId:r}),o&&(h.Cognito.passwordFormat={requireLowercase:o.require_lowercase,requireNumbers:o.require_numbers,requireUppercase:o.require_uppercase,requireSpecialCharacters:o.require_symbols,minLength:o.min_length??6}),i&&(h.Cognito.mfa={status:Ye(i),smsEnabled:s?.includes("SMS"),totpEnabled:s?.includes("TOTP")}),a&&(h.Cognito.allowGuestAccess=a),c&&(h.Cognito.loginWith={oauth:{domain:c.domain,redirectSignIn:c.redirect_sign_in_uri,redirectSignOut:c.redirect_sign_out_uri,responseType:"token"===c.response_type?"token":"code",scopes:c.scopes,providers:Je(c.identity_providers)}}),u&&(h.Cognito.loginWith={...h.Cognito.loginWith,email:u.includes("email"),phone:u.includes("phone_number"),username:u.includes("username")}),l&&(h.Cognito.userAttributes=l.reduce((e,t)=>({...e,[t]:{required:!0}}),{})),h}(e.auth)),e.analytics&&(t.Analytics=function(e){if(!e?.amazon_pinpoint)return;const{amazon_pinpoint:t}=e;return{Pinpoint:{appId:t.app_id,region:t.aws_region}}}(e.analytics)),e.geo&&(t.Geo=function(e){if(!e)return;const{aws_region:t,geofence_collections:n,maps:r,search_indices:o}=e;return{LocationService:{region:t,searchIndices:o,geofenceCollections:n,maps:r}}}(e.geo)),e.data&&(t.API=function(e){if(!e)return;const{aws_region:t,default_authorization_type:n,url:r,api_key:o,model_introspection:i}=e;return{GraphQL:{endpoint:r,defaultAuthMode:We(n),region:t,apiKey:o,modelIntrospection:i}}}(e.data)),e.custom){const n=function(e){if(!e?.events)return;const{url:t,aws_region:n,api_key:r,default_authorization_type:o}=e.events;return{Events:{endpoint:t,defaultAuthMode:We(o),region:n,apiKey:r}}}(e.custom);n&&"Events"in n&&(t.API={...t.API,...n})}return e.notifications&&(t.Notifications=function(e){if(!e)return;const{aws_region:t,channels:n,amazon_pinpoint_app_id:r}=e,o=n.includes("IN_APP_MESSAGING"),i=n.includes("APNS")||n.includes("FCM");if(!o&&!i)return;const s={};return o&&(s.InAppMessaging={Pinpoint:{appId:r,region:t}}),i&&(s.PushNotification={Pinpoint:{appId:r,region:t}}),s}(e.notifications)),t}const ze={AMAZON_COGNITO_USER_POOLS:"userPool",API_KEY:"apiKey",AWS_IAM:"iam",AWS_LAMBDA:"lambda",OPENID_CONNECT:"oidc"};function We(e){return ze[e]}const Qe={GOOGLE:"Google",LOGIN_WITH_AMAZON:"Amazon",FACEBOOK:"Facebook",SIGN_IN_WITH_APPLE:"Apple"};function Je(e=[]){return e.reduce((e,t)=>(void 0!==Qe[t]&&e.push(Qe[t]),e),[])}function Ye(e){return"OPTIONAL"===e?"optional":"REQUIRED"===e?"on":"off"}function He(e){const t={};return e.forEach(({name:e,bucket_name:n,aws_region:r,paths:o})=>{if(e in t)throw new Error(`Duplicate friendly name found: ${e}. Name must be unique.`);const i=o?Object.entries(o).reduce((e,[t,n])=>(void 0!==n&&(e[t]=n),e),{}):void 0;t[e]={bucketName:n,region:r,paths:i}}),t}const Ze=e=>Object.keys(e).some(e=>e.startsWith("aws_"))?((e={})=>{if(!Object.prototype.hasOwnProperty.call(e,"aws_project_region"))throw new Oe({name:"InvalidParameterException",message:"Invalid config parameter.",recoverySuggestion:"Ensure passing the config object imported from  `amplifyconfiguration.json`."});const{aws_appsync_apiKey:t,aws_appsync_authenticationType:n,aws_appsync_graphqlEndpoint:r,aws_appsync_region:o,aws_bots_config:i,aws_cognito_identity_pool_id:s,aws_cognito_sign_up_verification_method:a,aws_cognito_mfa_configuration:c,aws_cognito_mfa_types:u,aws_cognito_password_protection_settings:l,aws_cognito_verification_mechanisms:d,aws_cognito_signup_attributes:h,aws_cognito_social_providers:p,aws_cognito_username_attributes:f,aws_mandatory_sign_in:g,aws_mobile_analytics_app_id:y,aws_mobile_analytics_app_region:m,aws_user_files_s3_bucket:w,aws_user_files_s3_bucket_region:v,aws_user_files_s3_dangerously_connect_to_http_endpoint_for_testing:b,aws_user_pools_id:A,aws_user_pools_web_client_id:E,geo:S,oauth:I,predictions:T,aws_cloud_logic_custom:C,Notifications:k,modelIntrospection:N}=e,O={};y&&(O.Analytics={Pinpoint:{appId:y,region:m}});const{InAppMessaging:x,Push:D}=k??{};if(x?.AWSPinpoint||D?.AWSPinpoint){if(x?.AWSPinpoint){const{appId:e,region:t}=x.AWSPinpoint;O.Notifications={InAppMessaging:{Pinpoint:{appId:e,region:t}}}}if(D?.AWSPinpoint){const{appId:e,region:t}=D.AWSPinpoint;O.Notifications={...O.Notifications,PushNotification:{Pinpoint:{appId:e,region:t}}}}}if(Array.isArray(i)&&(O.Interactions={LexV1:Object.fromEntries(i.map(e=>[e.name,e]))}),r){const e=Ke[n];e||je.debug(`Invalid authentication type ${n}. Falling back to IAM.`),O.API={GraphQL:{endpoint:r,apiKey:t,region:o,defaultAuthMode:e??"iam"}},N&&(O.API.GraphQL.modelIntrospection=N)}const _=c?{status:c&&c.toLowerCase(),totpEnabled:u?.includes("TOTP")??!1,smsEnabled:u?.includes("SMS")??!1}:void 0,R=l?{minLength:l.passwordPolicyMinLength,requireLowercase:l.passwordPolicyCharacters?.includes("REQUIRES_LOWERCASE")??!1,requireUppercase:l.passwordPolicyCharacters?.includes("REQUIRES_UPPERCASE")??!1,requireNumbers:l.passwordPolicyCharacters?.includes("REQUIRES_NUMBERS")??!1,requireSpecialCharacters:l.passwordPolicyCharacters?.includes("REQUIRES_SYMBOLS")??!1}:void 0,M=Array.from(new Set([...d??[],...h??[]])).reduce((e,t)=>({...e,[t.toLowerCase()]:{required:!0}}),{}),P=f?.includes("EMAIL")??!1,L=f?.includes("PHONE_NUMBER")??!1;(s||A)&&(O.Auth={Cognito:{identityPoolId:s,allowGuestAccess:"enable"!==g,signUpVerificationMethod:a,userAttributes:M,userPoolClientId:E,userPoolId:A,mfa:_,passwordFormat:R,loginWith:{username:!(P||L),email:P,phone:L}}});const U=!!I&&Object.keys(I).length>0,j=!!p&&p.length>0;if(O.Auth&&U&&(O.Auth.Cognito.loginWith={...O.Auth.Cognito.loginWith,oauth:{...Fe(I),...j&&{providers:qe(p)}}}),w&&(O.Storage={S3:{bucket:w,region:v,dangerouslyConnectToHttpEndpointForTesting:b}}),S){const{amazon_location_service:e}=S;O.Geo={LocationService:{maps:e.maps,geofenceCollections:e.geofenceCollections,searchIndices:e.search_indices,region:e.region}}}if(C&&(O.API={...O.API,REST:C.reduce((e,t)=>{const{name:n,endpoint:r,region:o,service:i}=t;return{...e,[n]:{endpoint:r,...i?{service:i}:void 0,...o?{region:o}:void 0}}},{})}),T){const{VoiceId:e}=T?.convert?.speechGenerator?.defaults??{};O.Predictions=e?{...T,convert:{...T.convert,speechGenerator:{...T.convert.speechGenerator,defaults:{voiceId:e}}}}:T}return O})(e):function(e){const{version:t}=e;return!!t&&t.startsWith("1")}(e)?Ge(e):e;var Xe=64,$e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),et=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],tt=Math.pow(2,53)-1,nt=function(){function e(){this.state=Int32Array.from(et),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return e.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var t=0,n=e.byteLength;if(this.bytesHashed+=n,8*this.bytesHashed>tt)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[t++],n--,this.bufferLength===Xe&&(this.hashBuffer(),this.bufferLength=0)},e.prototype.digest=function(){if(!this.finished){var e=8*this.bytesHashed,t=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(t.setUint8(this.bufferLength++,128),n%Xe>=56){for(var r=this.bufferLength;r<Xe;r++)t.setUint8(r,0);this.hashBuffer(),this.bufferLength=0}for(r=this.bufferLength;r<56;r++)t.setUint8(r,0);t.setUint32(56,Math.floor(e/4294967296),!0),t.setUint32(60,e),this.hashBuffer(),this.finished=!0}var o=new Uint8Array(32);for(r=0;r<8;r++)o[4*r]=this.state[r]>>>24&255,o[4*r+1]=this.state[r]>>>16&255,o[4*r+2]=this.state[r]>>>8&255,o[4*r+3]=this.state[r]>>>0&255;return o},e.prototype.hashBuffer=function(){for(var e=this.buffer,t=this.state,n=t[0],r=t[1],o=t[2],i=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=0;l<Xe;l++){if(l<16)this.temp[l]=(255&e[4*l])<<24|(255&e[4*l+1])<<16|(255&e[4*l+2])<<8|255&e[4*l+3];else{var d=this.temp[l-2],h=(d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10,p=((d=this.temp[l-15])>>>7|d<<25)^(d>>>18|d<<14)^d>>>3;this.temp[l]=(h+this.temp[l-7]|0)+(p+this.temp[l-16]|0)}var f=(((s>>>6|s<<26)^(s>>>11|s<<21)^(s>>>25|s<<7))+(s&a^~s&c)|0)+(u+($e[l]+this.temp[l]|0)|0)|0,g=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&r^n&o^r&o)|0;u=c,c=a,a=s,s=i+f|0,i=o,o=r,r=n,n=f+g|0}t[0]+=n,t[1]+=r,t[2]+=o,t[3]+=i,t[4]+=s,t[5]+=a,t[6]+=c,t[7]+=u},e}();var rt="undefined"!=typeof Buffer&&Buffer.from?function(e){return Buffer.from(e,"utf8")}:e=>(new TextEncoder).encode(e);function ot(e){return e instanceof Uint8Array?e:"string"==typeof e?rt(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}var it=function(){function e(e){this.secret=e,this.hash=new nt,this.reset()}return e.prototype.update=function(e){var t;if(("string"==typeof(t=e)?0!==t.length:0!==t.byteLength)&&!this.error)try{this.hash.update(ot(e))}catch(n){this.error=n}},e.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},e.prototype.digest=function(){return m(this,void 0,void 0,function(){return w(this,function(e){return[2,this.digestSync()]})})},e.prototype.reset=function(){if(this.hash=new nt,this.secret){this.outer=new nt;var e=function(e){var t=ot(e);if(t.byteLength>Xe){var n=new nt;n.update(t),t=n.digest()}var r=new Uint8Array(Xe);return r.set(t),r}(this.secret),t=new Uint8Array(Xe);t.set(e);for(var n=0;n<Xe;n++)e[n]^=54,t[n]^=92;this.hash.update(e),this.outer.update(t);for(n=0;n<e.byteLength;n++)e[n]=0}},e}();const st={};for(let Od=0;Od<256;Od++){let e=Od.toString(16).toLowerCase();1===e.length&&(e=`0${e}`),st[Od]=e}var at,ct,ut,lt,dt,ht,pt,ft,gt,yt,mt,wt,vt,bt,At,Et,St,It,Tt,Ct,kt,Nt,Ot,xt,Dt,_t;(ct=at||(at={})).WebUnknown="0",ct.React="1",ct.NextJs="2",ct.Angular="3",ct.VueJs="4",ct.Nuxt="5",ct.Svelte="6",ct.ServerSideUnknown="100",ct.ReactSSR="101",ct.NextJsSSR="102",ct.AngularSSR="103",ct.VueJsSSR="104",ct.NuxtSSR="105",ct.SvelteSSR="106",ct.ReactNative="201",ct.Expo="202",(lt=ut||(ut={})).AI="ai",lt.API="api",lt.Auth="auth",lt.Analytics="analytics",lt.DataStore="datastore",lt.Geo="geo",lt.InAppMessaging="inappmessaging",lt.Interactions="interactions",lt.Predictions="predictions",lt.PubSub="pubsub",lt.PushNotification="pushnotification",lt.Storage="storage",(ht=dt||(dt={})).CreateConversation="1",ht.GetConversation="2",ht.ListConversations="3",ht.DeleteConversation="4",ht.SendMessage="5",ht.ListMessages="6",ht.OnMessage="7",ht.Generation="8",ht.UpdateConversation="9",(ft=pt||(pt={})).Record="1",ft.IdentifyUser="2",(yt=gt||(gt={})).GraphQl="1",yt.Get="2",yt.Post="3",yt.Put="4",yt.Patch="5",yt.Del="6",yt.Head="7",(wt=mt||(mt={})).SignUp="1",wt.ConfirmSignUp="2",wt.ResendSignUpCode="3",wt.SignIn="4",wt.FetchMFAPreference="6",wt.UpdateMFAPreference="7",wt.SetUpTOTP="10",wt.VerifyTOTPSetup="11",wt.ConfirmSignIn="12",wt.DeleteUserAttributes="15",wt.DeleteUser="16",wt.UpdateUserAttributes="17",wt.FetchUserAttributes="18",wt.ConfirmUserAttribute="22",wt.SignOut="26",wt.UpdatePassword="27",wt.ResetPassword="28",wt.ConfirmResetPassword="29",wt.FederatedSignIn="30",wt.RememberDevice="32",wt.ForgetDevice="33",wt.FetchDevices="34",wt.SendUserAttributeVerificationCode="35",wt.SignInWithRedirect="36",wt.StartWebAuthnRegistration="37",wt.CompleteWebAuthnRegistration="38",wt.ListWebAuthnCredentials="39",wt.DeleteWebAuthnCredential="40",(bt=vt||(vt={})).Subscribe="1",bt.GraphQl="2",(Et=At||(At={})).SearchByText="0",Et.SearchByCoordinates="1",Et.SearchForSuggestions="2",Et.SearchByPlaceId="3",Et.SaveGeofences="4",Et.GetGeofence="5",Et.ListGeofences="6",Et.DeleteGeofences="7",(It=St||(St={})).SyncMessages="1",It.IdentifyUser="2",It.NotifyMessageInteraction="3",(Tt||(Tt={})).None="0",(kt=Ct||(Ct={})).Convert="1",kt.Identify="2",kt.Interpret="3",(Nt||(Nt={})).Subscribe="1",(xt=Ot||(Ot={})).InitializePushNotifications="1",xt.IdentifyUser="2",(_t=Dt||(Dt={})).UploadData="1",_t.DownloadData="2",_t.List="3",_t.Copy="4",_t.Remove="5",_t.GetProperties="6",_t.GetUrl="7",_t.GetDataAccess="8",_t.ListCallerAccessGrants="9";const Rt=()=>"undefined"!=typeof globalThis,Mt=()=>"undefined"!=typeof window,Pt=()=>"undefined"!=typeof document,Lt=()=>"undefined"!=typeof process,Ut=(e,t)=>!!Object.keys(e).find(e=>e.startsWith(t));var jt={};var Kt={};var Bt={};const Ft=[{platform:at.Expo,detectionMethod:function(){return Rt()&&void 0!==globalThis.expo}},{platform:at.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:at.NextJs,detectionMethod:function(){return Mt()&&window.next&&"object"==typeof window.next}},{platform:at.Nuxt,detectionMethod:function(){return Mt()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:at.Angular,detectionMethod:function(){const e=Boolean(Pt()&&document.querySelector("[ng-version]")),t=Boolean(Mt()&&void 0!==window.ng);return e||t}},{platform:at.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return Pt()&&Array.from(document.querySelectorAll("[id]")).some(t=>Object.keys(t).find(e))}},{platform:at.VueJs,detectionMethod:function(){return Mt()&&Ut(window,"__VUE")}},{platform:at.Svelte,detectionMethod:function(){return Mt()&&Ut(window,"__SVELTE")}},{platform:at.WebUnknown,detectionMethod:function(){return Mt()}},{platform:at.NextJsSSR,detectionMethod:function(){return Rt()&&(Ut(globalThis,"__next")||Ut(globalThis,"__NEXT"))}},{platform:at.NuxtSSR,detectionMethod:function(){return Rt()&&void 0!==globalThis.__NUXT_PATHS__}},{platform:at.ReactSSR,detectionMethod:function(){return Lt()&&!!Object.keys(jt).find(e=>e.includes("react"))}},{platform:at.VueJsSSR,detectionMethod:function(){return Rt()&&Ut(globalThis,"__VUE")}},{platform:at.AngularSSR,detectionMethod:function(){return Lt()&&"object"==typeof Bt&&Bt.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:at.SvelteSSR,detectionMethod:function(){return Lt()&&!!Object.keys(Kt).find(e=>e.includes("svelte"))}}];let qt;const Vt=[];let Gt=!1;const zt=()=>{if(!qt){if(qt=Ft.find(e=>e.detectionMethod())?.platform||at.ServerSideUnknown,Gt)for(;Vt.length;)Vt.pop()?.();else Vt.forEach(e=>{e()});Wt(at.ServerSideUnknown,10),Wt(at.WebUnknown,10)}return qt};function Wt(e,t){qt!==e||Gt||setTimeout(()=>{qt=void 0,Gt=!0,setTimeout(zt,1e3)},t)}const Qt={},Jt=({category:e,action:t}={})=>{const n=[["aws-amplify",(r="6.15.6",r.replace(/\+.*/,""))]];var r;if(e&&n.push([e,t]),n.push(["framework",zt()]),e&&t){const r=((e,t)=>Qt[e]?.[t]?.additionalDetails)(e,t);r&&r.forEach(e=>{n.push(e)})}return n},Yt=e=>Jt(e).map(([e,t])=>e&&t?`${e}/${t}`:e).join(" ");function Ht(e){return"function"==typeof e}var Zt,Xt=((Zt=function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(e,t){return t+1+") "+e.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}(function(e){Error.call(e),e.stack=(new Error).stack})).prototype=Object.create(Error.prototype),Zt.prototype.constructor=Zt,Zt);function $t(e,t){if(e){var n=e.indexOf(t);0<=n&&e.splice(n,1)}}var en=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}var t;return e.prototype.unsubscribe=function(){var e,t,n,r,o;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var s=v(i),a=s.next();!a.done;a=s.next()){a.value.remove(this)}}catch(p){e={error:p}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(Ht(c))try{c()}catch(f){o=f instanceof Xt?f.errors:[f]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var l=v(u),d=l.next();!d.done;d=l.next()){var h=d.value;try{nn(h)}catch(g){o=null!=o?o:[],g instanceof Xt?o=b(b([],A(o)),A(g.errors)):o.push(g)}}}catch(y){n={error:y}}finally{try{d&&!d.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}if(o)throw new Xt(o)}},e.prototype.add=function(t){var n;if(t&&t!==this)if(this.closed)nn(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(n=this._finalizers)&&void 0!==n?n:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&$t(t,e)},e.prototype.remove=function(t){var n=this._finalizers;n&&$t(n,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}();function tn(e){return e instanceof en||e&&"closed"in e&&Ht(e.remove)&&Ht(e.add)&&Ht(e.unsubscribe)}function nn(e){Ht(e)?e():e.unsubscribe()}en.EMPTY;var rn=void 0,on=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout.apply(void 0,b([e,t],A(n)))};function sn(e){on(function(){throw e})}function an(){}var cn=function(e){function t(t){var n=e.call(this)||this;return n.isStopped=!1,t?(n.destination=t,tn(t)&&t.add(n)):n.destination=hn,n}return E(t,e),t.create=function(e,t,n){return new ln(e,t,n)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(en),un=function(){function e(e){this.partialObserver=e}return e.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(n){dn(n)}},e.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(n){dn(n)}else dn(e)},e.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){dn(t)}},e}(),ln=function(e){function t(t,n,r){var o,i=e.call(this)||this;return o=Ht(t)||!t?{next:null!=t?t:void 0,error:null!=n?n:void 0,complete:null!=r?r:void 0}:t,i.destination=new un(o),i}return E(t,e),t}(cn);function dn(e){sn(e)}var hn={closed:!0,next:an,error:function(e){throw e},complete:an},pn="function"==typeof Symbol&&Symbol.observable||"@@observable";function fn(e){return e}var gn=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var n=new e;return n.source=this,n.operator=t,n},e.prototype.subscribe=function(e,t,n){var r,o=this,i=(r=e)&&r instanceof cn||function(e){return e&&Ht(e.next)&&Ht(e.error)&&Ht(e.complete)}(r)&&tn(r)?e:new ln(e,t,n);return function(){var e=o,t=e.operator,n=e.source;i.add(t?t.call(i,n):n?o._subscribe(i):o._trySubscribe(i))}(),i},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var n=this;return new(t=yn(t))(function(t,r){var o=new ln({next:function(t){try{e(t)}catch(n){r(n),o.unsubscribe()}},error:r,complete:t});n.subscribe(o)})},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[pn]=function(){return this},e.prototype.pipe=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(0===(e=t).length?fn:1===e.length?e[0]:function(t){return e.reduce(function(e,t){return t(e)},t)})(this)},e.prototype.toPromise=function(e){var t=this;return new(e=yn(e))(function(e,n){var r;t.subscribe(function(e){return r=e},function(e){return n(e)},function(){return e(r)})})},e.create=function(t){return new e(t)},e}();function yn(e){var t;return null!==(t=null!=e?e:rn)&&void 0!==t?t:Promise}function mn(e){return function(t){if(function(e){return Ht(null==e?void 0:e.lift)}(t))return t.lift(function(t){try{return e(t,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function wn(e,t,n,r,o){return new vn(e,t,n,r,o)}var vn=function(e){function t(t,n,r,o,i,s){var a=e.call(this,t)||this;return a.onFinalize=i,a.shouldUnsubscribe=s,a._next=n?function(e){try{n(e)}catch(r){t.error(r)}}:e.prototype._next,a._error=o?function(e){try{o(e)}catch(n){t.error(n)}finally{this.unsubscribe()}}:e.prototype._error,a._complete=r?function(){try{r()}catch(e){t.error(e)}finally{this.unsubscribe()}}:e.prototype._complete,a}return E(t,e),t.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}},t}(cn),bn=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function An(e){return Ht(null==e?void 0:e.then)}function En(e){return Ht(e[pn])}function Sn(e){return Symbol.asyncIterator&&Ht(null==e?void 0:e[Symbol.asyncIterator])}function In(e){return new TypeError("You provided "+(null!==e&&"object"==typeof e?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}var Tn="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Cn(e){return Ht(null==e?void 0:e[Tn])}function kn(e){return S(this,arguments,function(){var t,n,r;return w(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,I(t.read())];case 3:return n=o.sent(),r=n.value,n.done?[4,I(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,I(r)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function Nn(e){return Ht(null==e?void 0:e.getReader)}function On(e){if(e instanceof gn)return e;if(null!=e){if(En(e))return o=e,new gn(function(e){var t=o[pn]();if(Ht(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")});if(bn(e))return r=e,new gn(function(e){for(var t=0;t<r.length&&!e.closed;t++)e.next(r[t]);e.complete()});if(An(e))return n=e,new gn(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,sn)});if(Sn(e))return xn(e);if(Cn(e))return t=e,new gn(function(e){var n,r;try{for(var o=v(t),i=o.next();!i.done;i=o.next()){var s=i.value;if(e.next(s),e.closed)return}}catch(a){n={error:a}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.complete()});if(Nn(e))return xn(kn(e))}var t,n,r,o;throw In(e)}function xn(e){return new gn(function(t){(function(e,t){var n,r,o,i;return m(this,void 0,void 0,function(){var s,a;return w(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),n=T(e),c.label=1;case 1:return[4,n.next()];case 2:if((r=c.sent()).done)return[3,4];if(s=r.value,t.next(s),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return a=c.sent(),o={error:a},[3,11];case 6:return c.trys.push([6,,9,10]),r&&!r.done&&(i=n.return)?[4,i.call(n)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})})(e,t).catch(function(e){return t.error(e)})})}function Dn(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=!1);var i=t.schedule(function(){n(),o?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(i),!o)return i}function _n(e,t){return void 0===t&&(t=0),mn(function(n,r){n.subscribe(wn(r,function(n){return Dn(r,e,function(){return r.next(n)},t)},function(){return Dn(r,e,function(){return r.complete()},t)},function(n){return Dn(r,e,function(){return r.error(n)},t)}))})}function Rn(e,t){return void 0===t&&(t=0),mn(function(n,r){r.add(e.schedule(function(){return n.subscribe(r)},t))})}function Mn(e,t){if(!e)throw new Error("Iterable cannot be null");return new gn(function(n){Dn(n,t,function(){var r=e[Symbol.asyncIterator]();Dn(n,t,function(){r.next().then(function(e){e.done?n.complete():n.next(e.value)})},0,!0)})})}function Pn(e,t){if(null!=e){if(En(e))return function(e,t){return On(e).pipe(Rn(t),_n(t))}(e,t);if(bn(e))return function(e,t){return new gn(function(n){var r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(An(e))return function(e,t){return On(e).pipe(Rn(t),_n(t))}(e,t);if(Sn(e))return Mn(e,t);if(Cn(e))return function(e,t){return new gn(function(n){var r;return Dn(n,t,function(){r=e[Tn](),Dn(n,t,function(){var e,t,o;try{t=(e=r.next()).value,o=e.done}catch(i){return void n.error(i)}o?n.complete():n.next(t)},0,!0)}),function(){return Ht(null==r?void 0:r.return)&&r.return()}})}(e,t);if(Nn(e))return function(e,t){return Mn(kn(e),t)}(e,t)}throw In(e)}function Ln(e,t){return mn(function(n,r){var o=0;n.subscribe(wn(r,function(n){r.next(e.call(t,n,o++))}))})}function Un(e){return mn(function(t,n){var r,o=null,i=!1;o=t.subscribe(wn(n,void 0,void 0,function(s){r=On(e(s,Un(e)(t))),o?(o.unsubscribe(),o=null,r.subscribe(n)):i=!0})),i&&(o.unsubscribe(),o=null,r.subscribe(n))})}class jn{networkMonitor(e){const t=(()=>{if("undefined"==typeof self)return!1;const e=self;return void 0!==e.WorkerGlobalScope&&self instanceof e.WorkerGlobalScope})()?self:"undefined"!=typeof window&&window;return t?new gn(e=>{e.next({online:t.navigator.onLine});const n=()=>{e.next({online:!0})},r=()=>{e.next({online:!1})};return t.addEventListener("online",n),t.addEventListener("offline",r),jn._observers.push(e),()=>{t.removeEventListener("online",n),t.removeEventListener("offline",r),jn._observers=jn._observers.filter(t=>t!==e)}}):(n=[{online:!0}],r?Pn(n,r):On(n));var n,r}static _observerOverride(e){for(const t of this._observers)t.closed?this._observers=this._observers.filter(e=>e!==t):t?.next&&t.next(e)}}jn._observers=[];const Kn=new Ne("Auth");class Bn{configure(e,t){this.authConfig=e,this.authOptions=t,e&&e.Cognito?.userPoolEndpoint&&Kn.warn(Fn("Amazon Cognito User Pool")),e&&e.Cognito?.identityPoolEndpoint&&Kn.warn(Fn("Amazon Cognito Identity Pool"))}async fetchAuthSession(e={}){let t,n;const r=await this.getTokens(e);return r?(n=r.accessToken?.payload?.sub,t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,tokens:r,authenticated:!0,forceRefresh:e.forceRefresh}))):t=await(this.authOptions?.credentialsProvider?.getCredentialsAndIdentityId({authConfig:this.authConfig,authenticated:!1,forceRefresh:e.forceRefresh})),{tokens:r,credentials:t?.credentials,identityId:t?.identityId,userSub:n}}async clearCredentials(){await(this.authOptions?.credentialsProvider?.clearCredentialsAndIdentityId())}async getTokens(e){return await(this.authOptions?.tokenProvider?.getTokens(e))??void 0}}const Fn=e=>`You are using a custom Amazon ${e} endpoint, ensure the endpoint is correct.`;const qn=new class{constructor(){this.oAuthListener=void 0,this.isConfigured=!1,this.resourcesConfig={},this.libraryOptions={},this.Auth=new Bn}configure(e,t){const n=Ze(e);this.resourcesConfig=n,t&&(this.libraryOptions=t),this.resourcesConfig=Ue(this.resourcesConfig),this.Auth.configure(this.resourcesConfig.Auth,this.libraryOptions.Auth),Me.dispatch("core",{event:"configure",data:this.resourcesConfig},"Configure",_e),this.notifyOAuthListener(),this.isConfigured=!0}getConfig(){return this.isConfigured||console.warn("Amplify has not been configured. Please call Amplify.configure() before using this service."),this.resourcesConfig}[Ve](e){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth?e(this.resourcesConfig.Auth?.Cognito):this.oAuthListener=e}notifyOAuthListener(){this.resourcesConfig.Auth?.Cognito.loginWith?.oauth&&this.oAuthListener&&(this.oAuthListener(this.resourcesConfig.Auth?.Cognito),this.oAuthListener=void 0)}},Vn=e=>((e,t)=>e.Auth.fetchAuthSession(t))(qn,e),Gn=e=>{const{headers:t,statusCode:n}=e;return{...zn(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},zn=e=>"object"==typeof e?.$metadata,Wn=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:Gn(e)})};function Qn(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}const Jn=3e5,Yn=e=>{const t=Qn(Jn)(e);return!1===t?Jn:t},Hn=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],Zn=e=>async(t,n)=>{const r=n??await e(t)??void 0,o=r?.code||r?.name,i=t?.statusCode;return{retryable:tr(n)||er(i,o)||(e=>!!e&&Hn.includes(e))(o)||nr(i,o)}},Xn=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],$n=["TimeoutError","RequestTimeout","RequestTimeoutException"],er=(e,t)=>429===e||!!t&&Xn.includes(t),tr=e=>[xe.NetworkError,"ERR_NETWORK"].includes(e?.name),nr=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&$n.includes(t),rr=({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(o,i)=>async function(s){let a,c,u=i.attemptsCount??0;const l=()=>{if(c)return ir(c,u),c;throw ir(a,u),a};for(;!r?.aborted&&u<e;){try{c=await o(s),a=void 0}catch(d){a=d,c=void 0}u=(i.attemptsCount??0)>u?i.attemptsCount??0:u+1,i.attemptsCount=u;const{isCredentialsExpiredError:h,retryable:p}=await t(c,a,i);if(!p)return l();if(i.isCredentialsExpired=!!h,!r?.aborted&&u<e){const e=n(u);await or(e,r)}}if(r?.aborted)throw new Error("Request aborted.");return l()}},or=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,r;const o=new Promise(t=>{r=t,n=setTimeout(t,e)});return t?.addEventListener("abort",function e(o){clearTimeout(n),t?.removeEventListener("abort",e),r()}),o},ir=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},sr=Se,ar=({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(r){if(0===t.trim().length){return await n(r)}{const o=e.toLowerCase();r.headers[o]=r.headers[o]?`${r.headers[o]} ${t}`:t;return await n(r)}},cr=(e,t)=>(n,r)=>{const o={};let i=t=>e(t,r);for(let e=t.length-1;e>=0;e--){i=(0,t[e])(r)(i,o)}return i(n)},ur=e=>{let t;return()=>(t||(t=e()),t)},lr=e=>!["HEAD","GET"].includes(e.toUpperCase()),dr=async({url:e,method:t,headers:n,body:r},{abortSignal:o,cache:i,withCrossDomainCredentials:s})=>{let a;try{a=await fetch(e,{method:t,headers:n,body:lr(t)?r:void 0,signal:o,cache:i,credentials:s?"include":"same-origin"})}catch(u){if(u instanceof TypeError)throw new Oe({name:xe.NetworkError,message:"A network error has occurred.",underlyingError:u});throw u}const c={};a.headers?.forEach((e,t)=>{c[t.toLowerCase()]=e});return{...{statusCode:a.status,headers:c,body:null},body:Object.assign(a.body??{},{text:ur(()=>a.text()),blob:ur(()=>a.blob()),json:ur(()=>a.json())})}},hr=URL,pr=URLSearchParams;let fr=class extends Oe{constructor(){super({name:xe.PlatformNotSupported,message:"Function not supported on current platform"})}},gr=class{constructor(e){this.storage=e}async setItem(e,t){if(!this.storage)throw new fr;this.storage.setItem(e,t)}async getItem(e){if(!this.storage)throw new fr;return this.storage.getItem(e)}async removeItem(e){if(!this.storage)throw new fr;this.storage.removeItem(e)}async clear(){if(!this.storage)throw new fr;this.storage.clear()}},yr=class{constructor(){this.storage=new Map}get length(){return this.storage.size}key(e){return e>this.length-1?null:Array.from(this.storage.keys())[e]}setItem(e,t){this.storage.set(e,t)}getItem(e){return this.storage.get(e)??null}removeItem(e){this.storage.delete(e)}clear(){this.storage.clear()}};const mr=new Ne("CoreStorageUtils"),wr=()=>{try{if("undefined"!=typeof window&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch(e){return mr.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new yr}};let vr=class{constructor(e){this._storage=e}get storage(){if(!this._storage)throw new fr;return this._storage}setItem(e,t){this.storage.setItem(e,t)}getItem(e){return this.storage.getItem(e)}removeItem(e){this.storage.removeItem(e)}clear(){this.storage.clear()}};
/*! js-cookie v3.0.5 | MIT */
function br(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var Ar=function e(t,n){function r(e,r,o){if("undefined"!=typeof document){"number"==typeof(o=br({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var s in o)o[s]&&(i+="; "+s,!0!==o[s]&&(i+="="+o[s].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var i=n[o].split("="),s=i.slice(1).join("=");try{var a=decodeURIComponent(i[0]);if(r[a]=t.read(s,a),e===a)break}catch(c){}}return e?r[e]:r}},remove:function(e,t){r(e,"",br({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,br({},this.attributes,t))},withConverter:function(t){return e(br({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});class Er{constructor(e={}){const{path:t,domain:n,expires:r,sameSite:o,secure:i}=e;if(this.domain=n,this.path=t||"/",this.expires=Object.prototype.hasOwnProperty.call(e,"expires")?r:365,this.secure=!Object.prototype.hasOwnProperty.call(e,"secure")||i,Object.prototype.hasOwnProperty.call(e,"sameSite")){if(!o||!["strict","lax","none"].includes(o))throw new Error('The sameSite value of cookieStorage must be "lax", "strict" or "none".');if("none"===o&&!this.secure)throw new Error("sameSite = None requires the Secure attribute in latest browser versions.");this.sameSite=o}}async setItem(e,t){Ar.set(e,t,this.getData())}async getItem(e){return Ar.get(e)??null}async removeItem(e){Ar.remove(e,this.getData())}async clear(){const e=Ar.get(),t=Object.keys(e).map(e=>this.removeItem(e));await Promise.all(t)}getData(){return{path:this.path,expires:this.expires,domain:this.domain,secure:this.secure,...this.sameSite&&{sameSite:this.sameSite}}}}const Sr=new class extends gr{constructor(){super((()=>{try{if("undefined"!=typeof window&&window.localStorage)return window.localStorage}catch(e){mr.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new yr})())}};new class extends gr{constructor(){super(wr())}},new class extends vr{constructor(){super(wr())}};const Ir=e=>Object.keys(e).map(e=>e.toLowerCase()).sort().join(";"),Tr="X-Amz-Date".toLowerCase(),Cr="X-Amz-Security-Token".toLowerCase(),kr="aws4_request",Nr="AWS4-HMAC-SHA256",Or=({credentials:e,signingDate:t=new Date,signingRegion:n,signingService:r,uriEscapePath:o=!0})=>{const{accessKeyId:i,secretAccessKey:s,sessionToken:a}=e,{longDate:c,shortDate:u}=(e=>{const t=e.toISOString().replace(/[:-]|\.\d{3}/g,"");return{longDate:t,shortDate:t.slice(0,8)}})(t);return{accessKeyId:i,credentialScope:`${u}/${n}/${r}/${kr}`,longDate:c,secretAccessKey:s,sessionToken:a,shortDate:u,signingRegion:n,signingService:r,uriEscapePath:o}},xr=(e,t)=>{const n=new it(e??void 0);n.update(t);return n.digestSync()},Dr=(e,t)=>function(e){let t="";for(let n=0;n<e.byteLength;n++)t+=st[e[n]];return t}(xr(e,t)),_r=e=>Object.entries(e).map(([e,t])=>({key:e.toLowerCase(),value:t?.trim().replace(/\s+/g," ")??""})).sort((e,t)=>e.key<t.key?-1:1).map(e=>`${e.key}:${e.value}\n`).join(""),Rr=e=>encodeURIComponent(e).replace(/[!'()*]/g,Mr),Mr=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`,Pr=(e,t=!0)=>e?t?encodeURIComponent(e).replace(/%2F/g,"/"):e:"/",Lr=e=>{if(null==e)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(Ur(e)){return Dr(null,e)}return"UNSIGNED-PAYLOAD"},Ur=e=>"string"==typeof e||ArrayBuffer.isView(e)||jr(e),jr=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e),Kr=(e,{credentialScope:t,longDate:n,secretAccessKey:r,shortDate:o,signingRegion:i,signingService:s,uriEscapePath:a})=>{const c=(({body:e,headers:t,method:n,url:r},o=!0)=>{return[n,Pr(r.pathname,o),(i=r.searchParams,Array.from(i).sort(([e,t],[n,r])=>e===n?t<r?-1:1:e<n?-1:1).map(([e,t])=>`${Rr(e)}=${Rr(t)}`).join("&")),_r(t),Ir(t),Lr(e)].join("\n");var i})(e,a),u=((e,t,n)=>[Nr,e,t,n].join("\n"))(n,t,Dr(null,c)),l=Dr(((e,t,n,r)=>{const o=xr(`AWS4${e}`,t),i=xr(o,n),s=xr(i,r);return xr(s,kr)})(r,o,i,s),u);return l},Br=(e,t)=>{const n=Or(t),{accessKeyId:r,credentialScope:o,longDate:i,sessionToken:s}=n,a={...e.headers};a.host=e.url.host,a[Tr]=i,s&&(a[Cr]=s);const c={...e,headers:a},u=Kr(c,n),l=`Credential=${r}/${o}`,d=`SignedHeaders=${Ir(a)}`,h=`Signature=${u}`;return a.authorization=`${Nr} ${l}, ${d}, ${h}`,c},Fr=e=>new Date(Date.now()+e),qr=(e,t)=>((e,t)=>Math.abs(Fr(t).getTime()-e)>=3e5)(e,t)?e-Date.now():t,Vr=({headers:e}={})=>e?.date??e?.Date??e?.["x-amz-date"];class Gr extends Error{constructor(){super(...arguments),this.nonRetryable=!0}}const zr=(e,t,n=3e5,r)=>async function(e,t,n){if("function"!=typeof e)throw Error("functionToRetry must be a function");return new Promise(async(r,o)=>{let i,s=0,a=()=>{};for(;;){s++,Le.debug(`${e.name} attempt #${s} with this vars: ${JSON.stringify(t)}`);try{return void r(await e(...t))}catch(c){if(i=c,Le.debug(`error on ${e.name}`,c),Pe(c))return Le.debug(`${e.name} non retryable error`,c),void o(c);const r=n(s,t,c);if(Le.debug(`${e.name} retrying in ${r} ms`),!1===r)return void o(c);await new Promise(e=>{a=e,setTimeout(a,r)})}}o(i)})}(e,t,Qn(n));class Wr extends Oe{get response(){return this._response?Qr(this._response):void 0}constructor(e){super(e),this.constructor=Wr,Object.setPrototypeOf(this,Wr.prototype),e.response&&(this._response=e.response)}}const Qr=e=>({...e,headers:{...e.headers}});const Jr={convert(e,t={urlSafe:!1,skipPadding:!1}){const n="string"==typeof e?e:function(e){return Array.from(e,e=>String.fromCodePoint(e)).join("")}(e);let r=(()=>{if("undefined"!=typeof window&&"function"==typeof window.btoa)return window.btoa;if("function"==typeof btoa)return btoa;throw new Oe({name:"Base64EncoderError",message:"Cannot resolve the `btoa` function from the environment."})})()(n);return t.urlSafe&&(r=r.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(r=r.replace(/=/g,"")),r}};var Yr;!function(e){e.DEBUG="DEBUG",e.ERROR="ERROR",e.INFO="INFO",e.WARN="WARN",e.VERBOSE="VERBOSE",e.NONE="NONE"}(Yr||(Yr={}));const Hr={VERBOSE:1,DEBUG:2,INFO:3,WARN:4,ERROR:5,NONE:6};class Zr{constructor(e,t=Yr.WARN){this.name=e,this.level=t,this._pluggables=[]}_padding(e){return e<10?"0"+e:""+e}_ts(){const e=new Date;return[this._padding(e.getMinutes()),this._padding(e.getSeconds())].join(":")+"."+e.getMilliseconds()}configure(e){return e?(this._config=e,this._config):this._config}_log(e,...t){let n=this.level;Zr.LOG_LEVEL&&(n=Zr.LOG_LEVEL),"undefined"!=typeof window&&window.LOG_LEVEL&&(n=window.LOG_LEVEL);if(!(Hr[e]>=Hr[n]))return;let r=console.log.bind(console);e===Yr.ERROR&&console.error&&(r=console.error.bind(console)),e===Yr.WARN&&console.warn&&(r=console.warn.bind(console)),Zr.BIND_ALL_LOG_LEVELS&&(e===Yr.INFO&&console.info&&(r=console.info.bind(console)),e===Yr.DEBUG&&console.debug&&(r=console.debug.bind(console)));const o=`[${e}] ${this._ts()} ${this.name}`;let i="";if(1===t.length&&"string"==typeof t[0])i=`${o} - ${t[0]}`,r(i);else if(1===t.length)i=`${o} ${t[0]}`,r(o,t[0]);else if("string"==typeof t[0]){let e=t.slice(1);1===e.length&&(e=e[0]),i=`${o} - ${t[0]} ${e}`,r(`${o} - ${t[0]}`,e)}else i=`${o} ${t}`,r(o,t);for(const s of this._pluggables){const e={message:i,timestamp:Date.now()};s.pushLogs([e])}}log(...e){this._log(Yr.INFO,...e)}info(...e){this._log(Yr.INFO,...e)}warn(...e){this._log(Yr.WARN,...e)}error(...e){this._log(Yr.ERROR,...e)}debug(...e){this._log(Yr.DEBUG,...e)}verbose(...e){this._log(Yr.VERBOSE,...e)}addPluggable(e){e&&"Logging"===e.getCategoryName()&&(this._pluggables.push(e),e.configure(this._config))}listPluggables(){return this._pluggables}}Zr.LOG_LEVEL=null,Zr.BIND_ALL_LOG_LEVELS=!1;class Xr extends Error{constructor({message:e,name:t,recoverySuggestion:n,underlyingError:r,metadata:o}){if(super(e),this.name=t,this.underlyingError=r,this.recoverySuggestion=n,o){const{extendedRequestId:e,httpStatusCode:t,requestId:n}=o;this.metadata={extendedRequestId:e,httpStatusCode:t,requestId:n}}this.constructor=Xr,Object.setPrototypeOf(this,Xr.prototype)}}var $r;!function(e){e.NoEndpointId="NoEndpointId",e.PlatformNotSupported="PlatformNotSupported",e.Unknown="Unknown",e.NetworkError="NetworkError"}($r||($r={}));const eo=(e,t=Xr)=>(n,r,o)=>{const{message:i,recoverySuggestion:s}=e[r];if(!n)throw new t({name:r,message:o?`${i} ${o}`:i,recoverySuggestion:s})},to="undefined"!=typeof Symbol?Symbol("amplify_default"):"@@amplify_default",no=new Zr("Hub");const ro=new class{constructor(e){this.listeners=new Map,this.protectedChannels=["core","auth","api","analytics","interactions","pubsub","storage","ui","xr"],this.name=e}_remove(e,t){const n=this.listeners.get(e);n?this.listeners.set(e,[...n.filter(({callback:e})=>e!==t)]):no.warn(`No listeners for ${e}`)}dispatch(e,t,n,r){if("string"==typeof e&&this.protectedChannels.indexOf(e)>-1){r===to||no.warn(`WARNING: ${e} is protected and dispatching on it can have unintended consequences`)}const o={channel:e,payload:{...t},source:n,patternInfo:[]};try{this._toListeners(o)}catch(i){no.error(i)}}listen(e,t,n="noname"){let r;if("function"!=typeof t)throw new Xr({name:"NoHubcallbackProvidedException",message:"No callback supplied to Hub"});r=t;let o=this.listeners.get(e);return o||(o=[],this.listeners.set(e,o)),o.push({name:n,callback:r}),()=>{this._remove(e,r)}}_toListeners(e){const{channel:t,payload:n}=e,r=this.listeners.get(t);r&&r.forEach(r=>{no.debug(`Dispatching to ${t} with `,n);try{r.callback(e)}catch(o){no.error(o)}})}}("__default__"),oo={convert(e,t){let n=e;return t?.urlSafe&&(n=n.replace(/-/g,"+").replace(/_/g,"/")),(()=>{if("undefined"!=typeof window&&"function"==typeof window.atob)return window.atob;if("function"==typeof atob)return atob;throw new Xr({name:"Base64EncoderError",message:"Cannot resolve the `atob` function from the environment."})})()(n)}};var io,so;(so=io||(io={})).AuthTokenConfigException="AuthTokenConfigException",so.AuthUserPoolAndIdentityPoolException="AuthUserPoolAndIdentityPoolException",so.AuthUserPoolException="AuthUserPoolException",so.InvalidIdentityPoolIdException="InvalidIdentityPoolIdException",so.OAuthNotConfigureException="OAuthNotConfigureException";const ao=eo({[io.AuthTokenConfigException]:{message:"Auth Token Provider not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app."},[io.AuthUserPoolAndIdentityPoolException]:{message:"Auth UserPool or IdentityPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with UserPoolId and IdentityPoolId."},[io.AuthUserPoolException]:{message:"Auth UserPool not configured.",recoverySuggestion:"Make sure to call Amplify.configure in your app with userPoolId and userPoolClientId."},[io.InvalidIdentityPoolIdException]:{message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."},[io.OAuthNotConfigureException]:{message:"oauth param not configured.",recoverySuggestion:"Make sure to call Amplify.configure with oauth parameter in your app."}});function co(e){let t=!0;t=!!e&&(!!e.userPoolId&&!!e.userPoolClientId),ao(t,io.AuthUserPoolException)}function uo(e){ao(!!e?.identityPoolId,io.InvalidIdentityPoolIdException)}function lo(e){const t=e.split(".");if(3!==t.length)throw new Error("Invalid token");try{const n=t[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(oo.convert(n).split("").map(e=>`%${`00${e.charCodeAt(0).toString(16)}`.slice(-2)}`).join(""));return{toString:()=>e,payload:JSON.parse(r)}}catch(n){throw new Error("Invalid token payload")}}let ho;const po=new Uint8Array(16);function fo(){if(!ho&&(ho="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ho))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ho(po)}const go=[];for(let Od=0;Od<256;++Od)go.push((Od+256).toString(16).slice(1));const yo={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};var mo,wo,vo,bo,Ao,Eo,So,Io,To,Co,ko,No,Oo,xo;!function(e){e.WebUnknown="0",e.React="1",e.NextJs="2",e.Angular="3",e.VueJs="4",e.Nuxt="5",e.Svelte="6",e.ServerSideUnknown="100",e.ReactSSR="101",e.NextJsSSR="102",e.AngularSSR="103",e.VueJsSSR="104",e.NuxtSSR="105",e.SvelteSSR="106",e.ReactNative="201",e.Expo="202"}(mo||(mo={})),function(e){e.AI="ai",e.API="api",e.Auth="auth",e.Analytics="analytics",e.DataStore="datastore",e.Geo="geo",e.InAppMessaging="inappmessaging",e.Interactions="interactions",e.Predictions="predictions",e.PubSub="pubsub",e.PushNotification="pushnotification",e.Storage="storage"}(wo||(wo={})),function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnMessage="7",e.Generation="8",e.UpdateConversation="9"}(vo||(vo={})),function(e){e.Record="1",e.IdentifyUser="2"}(bo||(bo={})),function(e){e.GraphQl="1",e.Get="2",e.Post="3",e.Put="4",e.Patch="5",e.Del="6",e.Head="7"}(Ao||(Ao={})),function(e){e.SignUp="1",e.ConfirmSignUp="2",e.ResendSignUpCode="3",e.SignIn="4",e.FetchMFAPreference="6",e.UpdateMFAPreference="7",e.SetUpTOTP="10",e.VerifyTOTPSetup="11",e.ConfirmSignIn="12",e.DeleteUserAttributes="15",e.DeleteUser="16",e.UpdateUserAttributes="17",e.FetchUserAttributes="18",e.ConfirmUserAttribute="22",e.SignOut="26",e.UpdatePassword="27",e.ResetPassword="28",e.ConfirmResetPassword="29",e.FederatedSignIn="30",e.RememberDevice="32",e.ForgetDevice="33",e.FetchDevices="34",e.SendUserAttributeVerificationCode="35",e.SignInWithRedirect="36",e.StartWebAuthnRegistration="37",e.CompleteWebAuthnRegistration="38",e.ListWebAuthnCredentials="39",e.DeleteWebAuthnCredential="40"}(Eo||(Eo={})),function(e){e.Subscribe="1",e.GraphQl="2"}(So||(So={})),function(e){e.SearchByText="0",e.SearchByCoordinates="1",e.SearchForSuggestions="2",e.SearchByPlaceId="3",e.SaveGeofences="4",e.GetGeofence="5",e.ListGeofences="6",e.DeleteGeofences="7"}(Io||(Io={})),function(e){e.SyncMessages="1",e.IdentifyUser="2",e.NotifyMessageInteraction="3"}(To||(To={})),(Co||(Co={})).None="0",function(e){e.Convert="1",e.Identify="2",e.Interpret="3"}(ko||(ko={})),(No||(No={})).Subscribe="1",function(e){e.InitializePushNotifications="1",e.IdentifyUser="2"}(Oo||(Oo={})),function(e){e.UploadData="1",e.DownloadData="2",e.List="3",e.Copy="4",e.Remove="5",e.GetProperties="6",e.GetUrl="7",e.GetDataAccess="8",e.ListCallerAccessGrants="9"}(xo||(xo={}));const Do=()=>"undefined"!=typeof globalThis,_o=()=>"undefined"!=typeof window,Ro=()=>"undefined"!=typeof document,Mo=()=>"undefined"!=typeof process,Po=(e,t)=>!!Object.keys(e).find(e=>e.startsWith(t));var Lo={};var Uo={};var jo={};const Ko=[{platform:mo.Expo,detectionMethod:function(){return Do()&&void 0!==globalThis.expo}},{platform:mo.ReactNative,detectionMethod:function(){return"undefined"!=typeof navigator&&void 0!==navigator.product&&"ReactNative"===navigator.product}},{platform:mo.NextJs,detectionMethod:function(){return _o()&&window.next&&"object"==typeof window.next}},{platform:mo.Nuxt,detectionMethod:function(){return _o()&&(void 0!==window.__NUXT__||void 0!==window.$nuxt)}},{platform:mo.Angular,detectionMethod:function(){const e=Boolean(Ro()&&document.querySelector("[ng-version]")),t=Boolean(_o()&&void 0!==window.ng);return e||t}},{platform:mo.React,detectionMethod:function(){const e=e=>e.startsWith("_react")||e.startsWith("__react");return Ro()&&Array.from(document.querySelectorAll("[id]")).some(t=>Object.keys(t).find(e))}},{platform:mo.VueJs,detectionMethod:function(){return _o()&&Po(window,"__VUE")}},{platform:mo.Svelte,detectionMethod:function(){return _o()&&Po(window,"__SVELTE")}},{platform:mo.WebUnknown,detectionMethod:function(){return _o()}},{platform:mo.NextJsSSR,detectionMethod:function(){return Do()&&(Po(globalThis,"__next")||Po(globalThis,"__NEXT"))}},{platform:mo.NuxtSSR,detectionMethod:function(){return Do()&&void 0!==globalThis.__NUXT_PATHS__}},{platform:mo.ReactSSR,detectionMethod:function(){return Mo()&&!!Object.keys(Lo).find(e=>e.includes("react"))}},{platform:mo.VueJsSSR,detectionMethod:function(){return Do()&&Po(globalThis,"__VUE")}},{platform:mo.AngularSSR,detectionMethod:function(){return Mo()&&"object"==typeof jo&&jo.npm_lifecycle_script?.startsWith("ng ")||!1}},{platform:mo.SvelteSSR,detectionMethod:function(){return Mo()&&!!Object.keys(Uo).find(e=>e.includes("svelte"))}}];let Bo;const Fo=[];let qo=!1;const Vo=()=>{if(!Bo){if(Bo=Ko.find(e=>e.detectionMethod())?.platform||mo.ServerSideUnknown,qo)for(;Fo.length;)Fo.pop()?.();else Fo.forEach(e=>{e()});Go(mo.ServerSideUnknown,10),Go(mo.WebUnknown,10)}return Bo};function Go(e,t){Bo!==e||qo||setTimeout(()=>{Bo=void 0,qo=!0,setTimeout(Vo,1e3)},t)}const zo={},Wo=({category:e,action:t}={})=>{const n=[["aws-amplify",(r="6.15.0",r.replace(/\+.*/,""))]];var r;if(e&&n.push([e,t]),n.push(["framework",Vo()]),e&&t){const r=((e,t)=>zo[e]?.[t]?.additionalDetails)(e,t);r&&r.forEach(e=>{n.push(e)})}return n},Qo=e=>Wo(e).map(([e,t])=>e&&t?`${e}/${t}`:e).join(" "),Jo=e=>{const{headers:t,statusCode:n}=e;return{...Yo(e)?e.$metadata:{},httpStatusCode:n,requestId:t["x-amzn-requestid"]??t["x-amzn-request-id"]??t["x-amz-request-id"],extendedRequestId:t["x-amz-id-2"],cfId:t["x-amz-cf-id"]}},Yo=e=>"object"==typeof e?.$metadata,Ho=async e=>{if(!e||e.statusCode<300)return;const t=await Zo(e),n=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),r=t.message??t.Message??"Unknown error",o=new Error(r);return Object.assign(o,{name:n,$metadata:Jo(e)})},Zo=async e=>{if(!e.body)throw new Error("Missing response payload");const t=await e.body.json();return Object.assign(t,{$metadata:Jo(e)})},Xo=(e,t,n,r)=>async(o,i)=>{const s={...r,...o},a=await s.endpointResolver(s,i),c=await t(i,a),u=await e(c,{...s});return n(u)};const $o="amz-sdk-invocation-id",ei=3e5,ti=e=>{const t=function(e=3e5){return t=>{const n=2**t*100+100*Math.random();return!(n>e)&&n}}(ei),n=t(e);return!1===n?ei:n},ni=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch","BadRequestException"],ri=e=>async(t,n)=>{const r=n??await e(t)??void 0,o=r?.code||r?.name,i=t?.statusCode;return{retryable:ai(n)||si(i,o)||(e=>!!e&&ni.includes(e))(o)||ci(i,o)}},oi=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException"],ii=["TimeoutError","RequestTimeout","RequestTimeoutException"],si=(e,t)=>429===e||!!t&&oi.includes(t),ai=e=>[$r.NetworkError,"ERR_NETWORK"].includes(e?.name),ci=(e,t)=>!!e&&[500,502,503,504].includes(e)||!!t&&ii.includes(t),ui="cognito-identity",li={service:ui,retryDecider:ri(Ho),computeDelay:ti,cache:"no-store"},di=(e,t)=>{if(t?.aborted)return Promise.resolve();let n,r;const o=new Promise(t=>{r=t,n=setTimeout(t,e)});return t?.addEventListener("abort",function e(o){clearTimeout(n),t?.removeEventListener("abort",e),r()}),o},hi=(e,t)=>{"[object Object]"===Object.prototype.toString.call(e)&&(e.$metadata={...e.$metadata??{},attempts:t})},pi=function(e,t,n){if(yo.randomUUID&&!t&&!e)return yo.randomUUID();const r=(e=e||{}).random||(e.rng||fo)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return go[e[t+0]]+go[e[t+1]]+go[e[t+2]]+go[e[t+3]]+"-"+go[e[t+4]]+go[e[t+5]]+"-"+go[e[t+6]]+go[e[t+7]]+"-"+go[e[t+8]]+go[e[t+9]]+"-"+go[e[t+10]]+go[e[t+11]]+go[e[t+12]]+go[e[t+13]]+go[e[t+14]]+go[e[t+15]]}(r)},fi=(e,t)=>(n,r)=>{const o={};let i=t=>e(t,r);for(let e=t.length-1;e>=0;e--){i=(0,t[e])(r)(i,o)}return i(n)},gi=e=>{let t;return()=>(t||(t=e()),t)},yi=e=>!["HEAD","GET","DELETE"].includes(e.toUpperCase()),mi=fi(async({url:e,method:t,headers:n,body:r},{abortSignal:o,cache:i,withCrossDomainCredentials:s})=>{let a;try{a=await fetch(e,{method:t,headers:n,body:yi(t)?r:void 0,signal:o,cache:i,credentials:s?"include":"same-origin"})}catch(u){if(u instanceof TypeError)throw new Xr({name:$r.NetworkError,message:"A network error has occurred.",underlyingError:u});throw u}const c={};a.headers?.forEach((e,t)=>{c[t.toLowerCase()]=e});return{...{statusCode:a.status,headers:c,body:null},body:Object.assign(a.body??{},{text:gi(()=>a.text()),blob:gi(()=>a.blob()),json:gi(()=>a.json())})}},[({userAgentHeader:e="x-amz-user-agent",userAgentValue:t=""})=>n=>async function(r){if(0===t.trim().length){return await n(r)}{const o=e.toLowerCase();r.headers[o]=r.headers[o]?`${r.headers[o]} ${t}`:t;return await n(r)}},()=>e=>async function(t){return t.headers[$o]||(t.headers[$o]=pi()),e(t)},({maxAttempts:e=3,retryDecider:t,computeDelay:n,abortSignal:r})=>{if(e<1)throw new Error("maxAttempts must be greater than 0");return(o,i)=>async function(s){let a,c,u=i.attemptsCount??0;const l=()=>{if(c)return hi(c,u),c;throw hi(a,u),a};for(;!r?.aborted&&u<e;){try{c=await o(s),a=void 0}catch(d){a=d,c=void 0}u=(i.attemptsCount??0)>u?i.attemptsCount??0:u+1,i.attemptsCount=u;const{isCredentialsExpiredError:h,retryable:p}=await t(c,a,i);if(!p)return l();if(i.isCredentialsExpired=!!h,!r?.aborted&&u<e){const e=n(u);await di(e,r)}}if(r?.aborted)throw new Error("Request aborted.");return l()}},({maxAttempts:e=3})=>(t,n)=>async function(r){const o=n.attemptsCount??0;return r.headers["amz-sdk-request"]=`attempt=${o+1}; max=${e}`,t(r)}]),wi=fi(mi,[()=>e=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),vi=e=>(t,n)=>{const r=bi(e),o=JSON.stringify(t);return Ai(n,r,o)},bi=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityService.${e}`}),Ai=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"}),Ei=e=>Xo(wi,vi("GetCredentialsForIdentity"),Si,{...li,...e,userAgentValue:Qo()}),Si=async e=>{if(e.statusCode>=300){throw await Ho(e)}const t=await Zo(e);return{IdentityId:t.IdentityId,Credentials:Ii(t.Credentials),$metadata:Jo(e)}},Ii=({Expiration:e,...t}={})=>({...t,Expiration:e&&new Date(1e3*e)}),Ti=async e=>{if(e.statusCode>=300){throw await Ho(e)}return{IdentityId:(await Zo(e)).IdentityId,$metadata:Jo(e)}},Ci={id:"aws",outputs:{dnsSuffix:"amazonaws.com"},regionRegex:"^(us|eu|ap|sa|ca|me|af)\\-\\w+\\-\\d+$",regions:["aws-global"]},ki={partitions:[Ci,{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn"},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:["aws-cn-global"]}]},Ni=e=>{const{partitions:t}=ki;for(const{regions:n,outputs:r,regionRegex:o}of t){const t=new RegExp(o);if(n.includes(e)||t.test(e))return r.dnsSuffix}return Ci.outputs.dnsSuffix},Oi=URL;class xi extends Xr{constructor(){super({name:$r.PlatformNotSupported,message:"Function not supported on current platform"})}}class Di{constructor(e){this.storage=e}async setItem(e,t){if(!this.storage)throw new xi;this.storage.setItem(e,t)}async getItem(e){if(!this.storage)throw new xi;return this.storage.getItem(e)}async removeItem(e){if(!this.storage)throw new xi;this.storage.removeItem(e)}async clear(){if(!this.storage)throw new xi;this.storage.clear()}}class _i{constructor(){this.storage=new Map}get length(){return this.storage.size}key(e){return e>this.length-1?null:Array.from(this.storage.keys())[e]}setItem(e,t){this.storage.set(e,t)}getItem(e){return this.storage.get(e)??null}removeItem(e){this.storage.delete(e)}clear(){this.storage.clear()}}const Ri=new Zr("CoreStorageUtils"),Mi=()=>{try{if("undefined"!=typeof window&&window.sessionStorage)return window.sessionStorage.getItem("test"),window.sessionStorage;throw new Error("sessionStorage is not defined")}catch(e){return Ri.info("sessionStorage not found. InMemoryStorage is used as a fallback."),new _i}};class Pi{constructor(e){this._storage=e}get storage(){if(!this._storage)throw new xi;return this._storage}setItem(e,t){this.storage.setItem(e,t)}getItem(e){return this.storage.getItem(e)}removeItem(e){this.storage.removeItem(e)}clear(){this.storage.clear()}}const Li=new class extends Di{constructor(){super((()=>{try{if("undefined"!=typeof window&&window.localStorage)return window.localStorage}catch(e){Ri.info("localStorage not found. InMemoryStorage is used as a fallback.")}return new _i})())}};new class extends Di{constructor(){super(Mi())}},new class extends Pi{constructor(){super(Mi())}};function Ui({expiresAt:e,clockDrift:t,tolerance:n=5e3}){return Date.now()+t+n>e}class ji extends Xr{constructor(e){super(e),this.constructor=ji,Object.setPrototypeOf(this,ji.prototype)}}function Ki(e){if(!e||!e.includes(":"))throw new ji({name:"InvalidIdentityPoolIdException",message:"Invalid identity pool id provided.",recoverySuggestion:"Make sure a valid identityPoolId is given in the config."});return e.split(":")[0]}const Bi="UserUnAuthenticatedException";new ji({name:"InvalidRedirectException",message:"signInRedirect or signOutRedirect had an invalid format or was not found.",recoverySuggestion:"Please make sure the signIn/Out redirect in your oauth config is valid."}),new ji({name:"InvalidAppSchemeException",message:"A valid non-http app scheme was not found in the config.",recoverySuggestion:"Please make sure a valid custom app scheme is present in the config."}),new ji({name:"InvalidPreferredRedirectUrlException",message:"The given preferredRedirectUrl does not match any items in the redirectSignOutUrls array from the config.",recoverySuggestion:"Please make sure a matching preferredRedirectUrl is provided."});new ji({name:"InvalidOriginException",message:"redirect is coming from a different origin. The oauth flow needs to be initiated from the same origin",recoverySuggestion:"Please call signInWithRedirect from the same origin."});const Fi=new ji({name:"TokenRefreshException",message:"Token refresh is not supported when authenticated with the 'implicit grant' (token) oauth flow. \n\tPlease change your oauth configuration to use 'code grant' flow.",recoverySuggestion:"Please logout and change your Amplify configuration to use \"code grant\" flow. \n\tE.g { responseType: 'code' }"}),qi=new ji({name:Bi,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."});function Vi(e){if(function(e){return zi(e)&&!e?.refreshToken}(e))throw Fi;if(!function(e){return zi(e)&&e?.refreshToken}(e))throw qi}const Gi={inflightOAuth:"inflightOAuth",oauthSignIn:"oauthSignIn",oauthPKCE:"oauthPKCE",oauthState:"oauthState"};function zi(e){return e?.accessToken||e?.idToken}const Wi=e=>({"content-type":"application/x-amz-json-1.1","x-amz-target":`AWSCognitoIdentityProviderService.${e}`}),Qi=({url:e},t,n)=>({headers:t,url:e,body:n,method:"POST"});function Ji(e){if(!e||"Error"===e.name||e instanceof TypeError)throw new ji({name:$r.Unknown,message:"An unknown error has occurred.",underlyingError:e})}const Yi=fi(mi,[()=>(e,t)=>async function(t){return t.headers["cache-control"]="no-store",e(t)}]),Hi="cognito-idp",Zi={service:Hi,retryDecider:ri(Ho),computeDelay:ti,get userAgentValue(){return Qo()},cache:"no-store"},Xi=({endpointOverride:e})=>t=>e?{url:new Oi(e)}:(({region:e})=>({url:new Oi(`https://${Hi}.${e}.${Ni(e)}`)}))(t),$i=e=>{return Xo(Yi,(t="GetTokensFromRefreshToken",(e,n)=>{const r=Wi(t),o=JSON.stringify(e);return Qi(n,r,o)}),async e=>{if(e.statusCode>=300){const t=await Ho(e);throw Ji(t),new ji({name:t.name,message:t.message,metadata:t.$metadata})}return Zo(e)},{...Zi,...e});var t},es=(e=>{let t;return async(...n)=>t||(t=new Promise((r,o)=>{e(...n).then(e=>{r(e)}).catch(e=>{o(e)}).finally(()=>{t=void 0})}),t)})(async({tokens:e,authConfig:t,username:n})=>{co(t?.Cognito);const{userPoolId:r,userPoolClientId:o,userPoolEndpoint:i}=t.Cognito,s=function(e){const t=e?.split("_")[0];if(!e||e.indexOf("_")<0||!t||"string"!=typeof t)throw new ji({name:"InvalidUserPoolId",message:"Invalid user pool id provided."});return t}(r);Vi(e);const a=$i({endpointResolver:Xi({endpointOverride:i})}),{AuthenticationResult:c}=await a({region:s},{ClientId:o,RefreshToken:e.refreshToken,DeviceKey:e.deviceMetadata?.deviceKey}),u=lo(c?.AccessToken??""),l=c?.IdToken?lo(c.IdToken):void 0,{iat:d}=u.payload;if(!d)throw new ji({name:"iatNotFoundException",message:"iat not found in access token"});return{accessToken:u,idToken:l,clockDrift:1e3*d-(new Date).getTime(),refreshToken:c?.RefreshToken??e.refreshToken,username:n}}),ts={accessToken:"accessToken",idToken:"idToken",oidcProvider:"oidcProvider",clockDrift:"clockDrift",refreshToken:"refreshToken",deviceKey:"deviceKey",randomPasswordKey:"randomPasswordKey",deviceGroupKey:"deviceGroupKey",signInDetails:"signInDetails",oauthMetadata:"oauthMetadata"};var ns;(ns||(ns={})).InvalidAuthTokens="InvalidAuthTokens";const rs=eo({[ns.InvalidAuthTokens]:{message:"Invalid tokens.",recoverySuggestion:"Make sure the tokens are valid."}}),os="CognitoIdentityServiceProvider";class is{getKeyValueStorage(){if(!this.keyValueStorage)throw new ji({name:"KeyValueStorageNotFoundException",message:"KeyValueStorage was not found in TokenStore"});return this.keyValueStorage}setKeyValueStorage(e){this.keyValueStorage=e}setAuthConfig(e){this.authConfig=e}async loadTokens(){try{const e=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e.accessToken);if(!t)throw new ji({name:"NoSessionFoundException",message:"Auth session was not found. Make sure to call signIn."});const n=lo(t),r=await this.getKeyValueStorage().getItem(e.idToken),o=r?lo(r):void 0,i=await this.getKeyValueStorage().getItem(e.refreshToken)??void 0,s=await this.getKeyValueStorage().getItem(e.clockDrift)??"0",a=Number.parseInt(s),c=await this.getKeyValueStorage().getItem(e.signInDetails),u={accessToken:n,idToken:o,refreshToken:i,deviceMetadata:await this.getDeviceMetadata()??void 0,clockDrift:a,username:await this.getLastAuthUser()};return c&&(u.signInDetails=JSON.parse(c)),u}catch(e){return null}}async storeTokens(e){rs(void 0!==e,ns.InvalidAuthTokens);const t=e.username;await this.getKeyValueStorage().setItem(this.getLastAuthUserKey(),t);const n=await this.getAuthKeys();await this.getKeyValueStorage().setItem(n.accessToken,e.accessToken.toString()),e.idToken?await this.getKeyValueStorage().setItem(n.idToken,e.idToken.toString()):await this.getKeyValueStorage().removeItem(n.idToken),e.refreshToken?await this.getKeyValueStorage().setItem(n.refreshToken,e.refreshToken):await this.getKeyValueStorage().removeItem(n.refreshToken),e.deviceMetadata&&(e.deviceMetadata.deviceKey&&await this.getKeyValueStorage().setItem(n.deviceKey,e.deviceMetadata.deviceKey),e.deviceMetadata.deviceGroupKey&&await this.getKeyValueStorage().setItem(n.deviceGroupKey,e.deviceMetadata.deviceGroupKey),await this.getKeyValueStorage().setItem(n.randomPasswordKey,e.deviceMetadata.randomPassword)),e.signInDetails?await this.getKeyValueStorage().setItem(n.signInDetails,JSON.stringify(e.signInDetails)):await this.getKeyValueStorage().removeItem(n.signInDetails),await this.getKeyValueStorage().setItem(n.clockDrift,`${e.clockDrift}`)}async clearTokens(){const e=await this.getAuthKeys();await Promise.all([this.getKeyValueStorage().removeItem(e.accessToken),this.getKeyValueStorage().removeItem(e.idToken),this.getKeyValueStorage().removeItem(e.clockDrift),this.getKeyValueStorage().removeItem(e.refreshToken),this.getKeyValueStorage().removeItem(e.signInDetails),this.getKeyValueStorage().removeItem(this.getLastAuthUserKey()),this.getKeyValueStorage().removeItem(e.oauthMetadata)])}async getDeviceMetadata(e){const t=await this.getAuthKeys(e),n=await this.getKeyValueStorage().getItem(t.deviceKey),r=await this.getKeyValueStorage().getItem(t.deviceGroupKey),o=await this.getKeyValueStorage().getItem(t.randomPasswordKey);return o&&r&&n?{deviceKey:n,deviceGroupKey:r,randomPassword:o}:null}async clearDeviceMetadata(e){const t=await this.getAuthKeys(e);await Promise.all([this.getKeyValueStorage().removeItem(t.deviceKey),this.getKeyValueStorage().removeItem(t.deviceGroupKey),this.getKeyValueStorage().removeItem(t.randomPasswordKey)])}async getAuthKeys(e){co(this.authConfig?.Cognito);const t=e??await this.getLastAuthUser();return ss(os,`${this.authConfig.Cognito.userPoolClientId}.${t}`)}getLastAuthUserKey(){co(this.authConfig?.Cognito);const e=this.authConfig.Cognito.userPoolClientId;return`${os}.${e}.LastAuthUser`}async getLastAuthUser(){return await this.getKeyValueStorage().getItem(this.getLastAuthUserKey())??"username"}async setOAuthMetadata(e){const{oauthMetadata:t}=await this.getAuthKeys();await this.getKeyValueStorage().setItem(t,JSON.stringify(e))}async getOAuthMetadata(){const{oauthMetadata:e}=await this.getAuthKeys(),t=await this.getKeyValueStorage().getItem(e);return t&&JSON.parse(t)}}const ss=(e,t)=>as(ts)(`${e}`,t);function as(e){const t=Object.values({...e});return(e,n)=>t.reduce((t,r)=>({...t,[r]:`${e}.${n}.${r}`}),{})}const cs="amplify-signin-with-hostedUI",us="CognitoIdentityServiceProvider";const ls=(e,t)=>as(Gi)(e,t),ds=new class{constructor(e){this.keyValueStorage=e}async clearOAuthInflightData(){co(this.cognitoConfig);const e=ls(us,this.cognitoConfig.userPoolClientId);await Promise.all([this.keyValueStorage.removeItem(e.inflightOAuth),this.keyValueStorage.removeItem(e.oauthPKCE),this.keyValueStorage.removeItem(e.oauthState)])}async clearOAuthData(){co(this.cognitoConfig);const e=ls(us,this.cognitoConfig.userPoolClientId);return await this.clearOAuthInflightData(),await this.keyValueStorage.removeItem(cs),this.keyValueStorage.removeItem(e.oauthSignIn)}loadOAuthState(){co(this.cognitoConfig);const e=ls(us,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthState)}storeOAuthState(e){co(this.cognitoConfig);const t=ls(us,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthState,e)}loadPKCE(){co(this.cognitoConfig);const e=ls(us,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.getItem(e.oauthPKCE)}storePKCE(e){co(this.cognitoConfig);const t=ls(us,this.cognitoConfig.userPoolClientId);return this.keyValueStorage.setItem(t.oauthPKCE,e)}setAuthConfig(e){this.cognitoConfig=e}async loadOAuthInFlight(){co(this.cognitoConfig);const e=ls(us,this.cognitoConfig.userPoolClientId);return"true"===await this.keyValueStorage.getItem(e.inflightOAuth)}async storeOAuthInFlight(e){co(this.cognitoConfig);const t=ls(us,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(t.inflightOAuth,`${e}`)}async loadOAuthSignIn(){co(this.cognitoConfig);const e=ls(us,this.cognitoConfig.userPoolClientId),t=await this.keyValueStorage.getItem(cs),[n,r]=(await this.keyValueStorage.getItem(e.oauthSignIn))?.split(",")??[];return{isOAuthSignIn:"true"===n||"true"===t,preferPrivateSession:"true"===r}}async storeOAuthSignIn(e,t=!1){co(this.cognitoConfig);const n=ls(us,this.cognitoConfig.userPoolClientId);await this.keyValueStorage.setItem(n.oauthSignIn,`${e},${t}`)}}(Li);class hs{constructor(){this.waitForInflightOAuth="undefined"!=typeof window&&void 0!==window.document?async()=>{if(await ds.loadOAuthInFlight())return this.inflightPromise||(this.inflightPromise=new Promise((e,t)=>{})),this.inflightPromise}:async()=>{}}setAuthConfig(e){ds.setAuthConfig(e.Cognito),this.authConfig=e}setTokenRefresher(e){this.tokenRefresher=e}setAuthTokenStore(e){this.tokenStore=e}getTokenStore(){if(!this.tokenStore)throw new ji({name:"EmptyTokenStoreException",message:"TokenStore not set"});return this.tokenStore}getTokenRefresher(){if(!this.tokenRefresher)throw new ji({name:"EmptyTokenRefresherException",message:"TokenRefresher not set"});return this.tokenRefresher}async getTokens(e){let t;try{co(this.authConfig?.Cognito)}catch(i){return null}await this.waitForInflightOAuth(),this.inflightPromise=void 0,t=await this.getTokenStore().loadTokens();const n=await this.getTokenStore().getLastAuthUser();if(null===t)return null;const r=!!t?.idToken&&Ui({expiresAt:1e3*(t.idToken?.payload?.exp??0),clockDrift:t.clockDrift??0}),o=Ui({expiresAt:1e3*(t.accessToken?.payload?.exp??0),clockDrift:t.clockDrift??0});return(e?.forceRefresh||r||o)&&(t=await this.refreshTokens({tokens:t,username:n}),null===t)?null:{accessToken:t?.accessToken,idToken:t?.idToken,signInDetails:t?.signInDetails}}async refreshTokens({tokens:e,username:t}){try{const{signInDetails:n}=e,r=await this.getTokenRefresher()({tokens:e,authConfig:this.authConfig,username:t});return r.signInDetails=n,await this.setTokens({tokens:r}),ro.dispatch("auth",{event:"tokenRefresh"},"Auth",to),r}catch(n){return this.handleErrors(n)}}handleErrors(e){if(Ji(e),e.name!==$r.NetworkError&&this.clearTokens(),ro.dispatch("auth",{event:"tokenRefresh_failure",data:{error:e}},"Auth",to),e.name.startsWith("NotAuthorizedException"))return null;throw e}async setTokens({tokens:e}){return this.getTokenStore().storeTokens(e)}async clearTokens(){return this.getTokenStore().clearTokens()}getDeviceMetadata(e){return this.getTokenStore().getDeviceMetadata(e)}clearDeviceMetadata(e){return this.getTokenStore().clearDeviceMetadata(e)}setOAuthMetadata(e){return this.getTokenStore().setOAuthMetadata(e)}getOAuthMetadata(){return this.getTokenStore().getOAuthMetadata()}}const ps=new class{constructor(){this.authTokenStore=new is,this.authTokenStore.setKeyValueStorage(Li),this.tokenOrchestrator=new hs,this.tokenOrchestrator.setAuthTokenStore(this.authTokenStore),this.tokenOrchestrator.setTokenRefresher(es)}getTokens({forceRefresh:e}={forceRefresh:!1}){return this.tokenOrchestrator.getTokens({forceRefresh:e})}setKeyValueStorage(e){this.authTokenStore.setKeyValueStorage(e)}setAuthConfig(e){this.authTokenStore.setAuthConfig(e),this.tokenOrchestrator.setAuthConfig(e)}},{tokenOrchestrator:fs}=ps,gs={identityId:"identityId"},ys=new Zr("DefaultIdentityIdStore");class ms{setAuthConfig(e){uo(e.Cognito),this.authConfig=e,this._authKeys=ws("Cognito",e.Cognito.identityPoolId)}constructor(e){this._authKeys={},this._hasGuestIdentityId=!1,this.keyValueStorage=e}async loadIdentityId(){uo(this.authConfig?.Cognito);try{if(this._primaryIdentityId)return{id:this._primaryIdentityId,type:"primary"};{const e=await this.keyValueStorage.getItem(this._authKeys.identityId);return e?(this._hasGuestIdentityId=!0,{id:e,type:"guest"}):null}}catch(e){return ys.log("Error getting stored IdentityId.",e),null}}async storeIdentityId(e){uo(this.authConfig?.Cognito),"guest"===e.type?(this.keyValueStorage.setItem(this._authKeys.identityId,e.id),this._primaryIdentityId=void 0,this._hasGuestIdentityId=!0):(this._primaryIdentityId=e.id,this._hasGuestIdentityId&&(this.keyValueStorage.removeItem(this._authKeys.identityId),this._hasGuestIdentityId=!1))}async clearIdentityId(){this._primaryIdentityId=void 0,await this.keyValueStorage.removeItem(this._authKeys.identityId)}}const ws=(e,t)=>as(gs)(`com.amplify.${e}`,t),vs=({endpointOverride:e})=>t=>e?{url:new Oi(e)}:(({region:e})=>({url:new Oi(`https://${ui}.${e}.${Ni(e)}`)}))(t);function bs(e){const t=lo(e).payload.iss,n={};if(!t)throw new ji({name:"InvalidIdTokenException",message:"Invalid Idtoken."});return n[t.replace(/(^\w+:|^)\/\//,"")]=e,n}async function As({tokens:e,authConfig:t,identityIdStore:n}){n.setAuthConfig({Cognito:t});const r=await n.loadIdentityId();if(r)return r.id;const o=e?.idToken?bs(e.idToken.toString()):{},i=await async function(e,t){const n=t?.identityPoolId,r=Ki(n),o=(i={endpointResolver:vs({endpointOverride:t.identityPoolEndpoint})},Xo(wi,vi("GetId"),Ti,{...li,...i,userAgentValue:Qo()}));var i;let s;try{s=(await o({region:r},{IdentityPoolId:n,Logins:e})).IdentityId}catch(a){throw Ji(a),new ji(a)}if(!s)throw new ji({name:"GetIdResponseException",message:"Received undefined response from getId operation",recoverySuggestion:"Make sure to pass a valid identityPoolId in the configuration."});return s}(o,t);return n.storeIdentityId({id:i,type:e?"primary":"guest"}),i}const Es=new Zr("CognitoCredentialsProvider"),Ss=3e6;class Is{constructor(e){this._nextCredentialsRefresh=0,this._identityIdStore=e}async clearCredentialsAndIdentityId(){Es.debug("Clearing out credentials and identityId"),this._credentialsAndIdentityId=void 0,await this._identityIdStore.clearIdentityId()}async clearCredentials(){Es.debug("Clearing out in-memory credentials"),this._credentialsAndIdentityId=void 0}async getCredentialsAndIdentityId(e){const t=e.authenticated,{tokens:n}=e,{authConfig:r}=e;try{uo(r?.Cognito)}catch{return}if(!t&&!r.Cognito.allowGuestAccess)return;const{forceRefresh:o}=e,i=this.hasTokenChanged(n),s=await As({tokens:n,authConfig:r.Cognito,identityIdStore:this._identityIdStore});return(o||i)&&this.clearCredentials(),t?(function(e){if(!e||!e.idToken)throw new ji({name:Bi,message:"User needs to be authenticated to call this API.",recoverySuggestion:"Sign in before calling this API again."})}(n),this.credsForOIDCTokens(r.Cognito,n,s)):this.getGuestCredentials(s,r.Cognito)}async getGuestCredentials(e,t){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!1===this._credentialsAndIdentityId.isAuthenticatedCreds)return Es.info("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const n=Ki(t.identityPoolId),r=Ei({endpointResolver:vs({endpointOverride:t.identityPoolEndpoint})});let o;try{o=await r({region:n},{IdentityId:e})}catch(i){throw Ji(i),new ji(i)}if(o?.Credentials?.AccessKeyId&&o?.Credentials?.SecretKey){this._nextCredentialsRefresh=(new Date).getTime()+Ss;const t={credentials:{accessKeyId:o.Credentials.AccessKeyId,secretAccessKey:o.Credentials.SecretKey,sessionToken:o.Credentials.SessionToken,expiration:o.Credentials.Expiration},identityId:e};return o.IdentityId&&(t.identityId=o.IdentityId,this._identityIdStore.storeIdentityId({id:o.IdentityId,type:"guest"})),this._credentialsAndIdentityId={...t,isAuthenticatedCreds:!1},t}throw new ji({name:"CredentialsNotFoundException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}async credsForOIDCTokens(e,t,n){if(this._credentialsAndIdentityId&&!this.isPastTTL()&&!0===this._credentialsAndIdentityId.isAuthenticatedCreds)return Es.debug("returning stored credentials as they neither past TTL nor expired."),this._credentialsAndIdentityId;this.clearCredentials();const r=t.idToken?bs(t.idToken.toString()):{},o=Ki(e.identityPoolId),i=Ei({endpointResolver:vs({endpointOverride:e.identityPoolEndpoint})});let s;try{s=await i({region:o},{IdentityId:n,Logins:r})}catch(a){throw Ji(a),new ji(a)}if(s?.Credentials?.AccessKeyId&&s?.Credentials?.SecretKey){this._nextCredentialsRefresh=(new Date).getTime()+Ss;const e={credentials:{accessKeyId:s.Credentials.AccessKeyId,secretAccessKey:s.Credentials.SecretKey,sessionToken:s.Credentials.SessionToken,expiration:s.Credentials.Expiration},identityId:n};return s.IdentityId&&(e.identityId=s.IdentityId,this._identityIdStore.storeIdentityId({id:s.IdentityId,type:"primary"})),this._credentialsAndIdentityId={...e,isAuthenticatedCreds:!0,associatedIdToken:t.idToken?.toString()},e}throw new ji({name:"CredentialsException",message:"Cognito did not respond with either Credentials, AccessKeyId or SecretKey."})}isPastTTL(){return void 0===this._nextCredentialsRefresh||this._nextCredentialsRefresh<=Date.now()}hasTokenChanged(e){return!!e&&!!this._credentialsAndIdentityId?.associatedIdToken&&e.idToken?.toString()!==this._credentialsAndIdentityId.associatedIdToken}}const Ts=new Is(new ms(Li)),Cs={configure(e,t){const n=Ze(e),r=new Er({sameSite:"lax"}),o=t?.ssr?r:Sr,i=t?.ssr?new Is(new ms(r)):Ts;if(n.Auth)if(t?.Auth)qn.configure(n,t);else{if(!qn.libraryOptions.Auth)return ps.setAuthConfig(n.Auth),ps.setKeyValueStorage(o),void qn.configure(n,{...t,Auth:{tokenProvider:ps,credentialsProvider:i}});if(t){const e=qn.libraryOptions.Auth;return void 0!==t.ssr&&(ps.setKeyValueStorage(o),e.credentialsProvider=i),void qn.configure(n,{Auth:e,...t})}qn.configure(n)}else qn.configure(n,t)},getConfig:()=>qn.getConfig()};function ks(e){return(ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var Ns="function"==typeof Symbol&&null!=Symbol.toStringTag?Symbol.toStringTag:"@@toStringTag";function Os(e,t){for(var n,r=/\r\n|[\n\r]/g,o=1,i=t+1;(n=r.exec(e.body))&&n.index<t;)o+=1,i=t+1-(n.index+n[0].length);return{line:o,column:i}}function xs(e){return Ds(e.source,Os(e.source,e.start))}function Ds(e,t){var n=e.locationOffset.column-1,r=Rs(n)+e.body,o=t.line-1,i=e.locationOffset.line-1,s=t.line+i,a=1===t.line?n:0,c=t.column+a,u="".concat(e.name,":").concat(s,":").concat(c,"\n"),l=r.split(/\r\n|[\n\r]/g),d=l[o];if(d.length>120){for(var h=Math.floor(c/80),p=c%80,f=[],g=0;g<d.length;g+=80)f.push(d.slice(g,g+80));return u+_s([["".concat(s),f[0]]].concat(f.slice(1,h+1).map(function(e){return["",e]}),[[" ",Rs(p-1)+"^"],["",f[h+1]]]))}return u+_s([["".concat(s-1),l[o-1]],["".concat(s),d],["",Rs(c-1)+"^"],["".concat(s+1),l[o+1]]])}function _s(e){var t=e.filter(function(e){return e[0],void 0!==e[1]}),n=Math.max.apply(Math,t.map(function(e){return e[0].length}));return t.map(function(e){var t,r=e[0],o=e[1];return Rs(n-(t=r).length)+t+(o?" | "+o:" |")}).join("\n")}function Rs(e){return Array(e+1).join(" ")}function Ms(e){return(Ms="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ps(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Ls(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Us(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}function js(e,t){return!t||"object"!==Ms(t)&&"function"!=typeof t?Ks(e):t}function Ks(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Bs(e){var t="function"==typeof Map?new Map:void 0;return Bs=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return Fs(e,arguments,Gs(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),Vs(r,e)},Bs(e)}function Fs(e,t,n){return(Fs=qs()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&Vs(o,n.prototype),o}).apply(null,arguments)}function qs(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Vs(e,t){return(Vs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gs(e){return(Gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zs=function(){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vs(e,t)}(r,Bs(Error));var e,t,n=(e=r,t=qs(),function(){var n,r=Gs(e);if(t){var o=Gs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return js(this,n)});function r(e,t,o,i,s,a,c){var u,l,d,h;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(h=n.call(this,e)).name="GraphQLError",h.originalError=null!=a?a:void 0,h.nodes=Ws(Array.isArray(t)?t:t?[t]:void 0);for(var p=[],f=0,g=null!==(y=h.nodes)&&void 0!==y?y:[];f<g.length;f++){var y,m=g[f].loc;null!=m&&p.push(m)}p=Ws(p),h.source=null!=o?o:null===(u=p)||void 0===u?void 0:u[0].source,h.positions=null!=i?i:null===(l=p)||void 0===l?void 0:l.map(function(e){return e.start}),h.locations=i&&o?i.map(function(e){return Os(o,e)}):null===(d=p)||void 0===d?void 0:d.map(function(e){return Os(e.source,e.start)}),h.path=null!=s?s:void 0;var w,v=null==a?void 0:a.extensions;return null==c&&("object"==ks(w=v)&&null!==w)?h.extensions=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ps(Object(n),!0).forEach(function(t){Ls(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ps(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},v):h.extensions=null!=c?c:{},Object.defineProperties(Ks(h),{message:{enumerable:!0},locations:{enumerable:null!=h.locations},path:{enumerable:null!=h.path},extensions:{enumerable:null!=h.extensions&&Object.keys(h.extensions).length>0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),null!=a&&a.stack?(Object.defineProperty(Ks(h),"stack",{value:a.stack,writable:!0,configurable:!0}),js(h)):(Error.captureStackTrace?Error.captureStackTrace(Ks(h),r):Object.defineProperty(Ks(h),"stack",{value:Error().stack,writable:!0,configurable:!0}),h)}return Us(r,[{key:"toString",value:function(){return function(e){var t=e.message;if(e.nodes)for(var n=0,r=e.nodes;n<r.length;n++){var o=r[n];o.loc&&(t+="\n\n"+xs(o.loc))}else if(e.source&&e.locations)for(var i=0,s=e.locations;i<s.length;i++){var a=s[i];t+="\n\n"+Ds(e.source,a)}return t}(this)}},{key:Ns,get:function(){return"Object"}}]),r}();function Ws(e){return void 0===e||0===e.length?void 0:e}function Qs(e,t,n){return new zs("Syntax Error: ".concat(n),void 0,e,[t])}var Js=Object.freeze({NAME:"Name",DOCUMENT:"Document",OPERATION_DEFINITION:"OperationDefinition",VARIABLE_DEFINITION:"VariableDefinition",SELECTION_SET:"SelectionSet",FIELD:"Field",ARGUMENT:"Argument",FRAGMENT_SPREAD:"FragmentSpread",INLINE_FRAGMENT:"InlineFragment",FRAGMENT_DEFINITION:"FragmentDefinition",VARIABLE:"Variable",INT:"IntValue",FLOAT:"FloatValue",STRING:"StringValue",BOOLEAN:"BooleanValue",NULL:"NullValue",ENUM:"EnumValue",LIST:"ListValue",OBJECT:"ObjectValue",OBJECT_FIELD:"ObjectField",DIRECTIVE:"Directive",NAMED_TYPE:"NamedType",LIST_TYPE:"ListType",NON_NULL_TYPE:"NonNullType",SCHEMA_DEFINITION:"SchemaDefinition",OPERATION_TYPE_DEFINITION:"OperationTypeDefinition",SCALAR_TYPE_DEFINITION:"ScalarTypeDefinition",OBJECT_TYPE_DEFINITION:"ObjectTypeDefinition",FIELD_DEFINITION:"FieldDefinition",INPUT_VALUE_DEFINITION:"InputValueDefinition",INTERFACE_TYPE_DEFINITION:"InterfaceTypeDefinition",UNION_TYPE_DEFINITION:"UnionTypeDefinition",ENUM_TYPE_DEFINITION:"EnumTypeDefinition",ENUM_VALUE_DEFINITION:"EnumValueDefinition",INPUT_OBJECT_TYPE_DEFINITION:"InputObjectTypeDefinition",DIRECTIVE_DEFINITION:"DirectiveDefinition",SCHEMA_EXTENSION:"SchemaExtension",SCALAR_TYPE_EXTENSION:"ScalarTypeExtension",OBJECT_TYPE_EXTENSION:"ObjectTypeExtension",INTERFACE_TYPE_EXTENSION:"InterfaceTypeExtension",UNION_TYPE_EXTENSION:"UnionTypeExtension",ENUM_TYPE_EXTENSION:"EnumTypeExtension",INPUT_OBJECT_TYPE_EXTENSION:"InputObjectTypeExtension"});var Ys="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):void 0;function Hs(e){var t=e.prototype.toJSON;"function"==typeof t||function(e){if(!Boolean(e))throw new Error("Unexpected invariant triggered.")}(0),e.prototype.inspect=t,Ys&&(e.prototype[Ys]=t)}var Zs=function(){function e(e,t,n){this.start=e.start,this.end=t.end,this.startToken=e,this.endToken=t,this.source=n}return e.prototype.toJSON=function(){return{start:this.start,end:this.end}},e}();Hs(Zs);var Xs=function(){function e(e,t,n,r,o,i,s){this.kind=e,this.start=t,this.end=n,this.line=r,this.column=o,this.value=s,this.prev=i,this.next=null}return e.prototype.toJSON=function(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}},e}();function $s(e){return null!=e&&"string"==typeof e.kind}Hs(Xs);var ea=Object.freeze({SOF:"<SOF>",EOF:"<EOF>",BANG:"!",DOLLAR:"$",AMP:"&",PAREN_L:"(",PAREN_R:")",SPREAD:"...",COLON:":",EQUALS:"=",AT:"@",BRACKET_L:"[",BRACKET_R:"]",BRACE_L:"{",PIPE:"|",BRACE_R:"}",NAME:"Name",INT:"Int",FLOAT:"Float",STRING:"String",BLOCK_STRING:"BlockString",COMMENT:"Comment"});function ta(e){return(ta="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function na(e){return ra(e,[])}function ra(e,t){switch(ta(e)){case"string":return JSON.stringify(e);case"function":return e.name?"[function ".concat(e.name,"]"):"[function]";case"object":return null===e?"null":function(e,t){if(-1!==t.indexOf(e))return"[Circular]";var n=[].concat(t,[e]),r=function(e){var t=e[String(Ys)];if("function"==typeof t)return t;if("function"==typeof e.inspect)return e.inspect}(e);if(void 0!==r){var o=r.call(e);if(o!==e)return"string"==typeof o?o:ra(o,n)}else if(Array.isArray(e))return function(e,t){if(0===e.length)return"[]";if(t.length>2)return"[Array]";for(var n=Math.min(10,e.length),r=e.length-n,o=[],i=0;i<n;++i)o.push(ra(e[i],t));1===r?o.push("... 1 more item"):r>1&&o.push("... ".concat(r," more items"));return"["+o.join(", ")+"]"}(e,n);return function(e,t){var n=Object.keys(e);if(0===n.length)return"{}";if(t.length>2)return"["+function(e){var t=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if("Object"===t&&"function"==typeof e.constructor){var n=e.constructor.name;if("string"==typeof n&&""!==n)return n}return t}(e)+"]";var r=n.map(function(n){return n+": "+ra(e[n],t)});return"{ "+r.join(", ")+" }"}(e,n)}(e,t);default:return String(e)}}function oa(e,t){if(!Boolean(e))throw new Error(t)}function ia(e,t,n){return t&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e.prototype,t),e}var sa=function(){function e(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GraphQL request",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{line:1,column:1};"string"==typeof e||oa(0,"Body must be a string. Received: ".concat(na(e),".")),this.body=e,this.name=t,this.locationOffset=n,this.locationOffset.line>0||oa(0,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||oa(0,"column in locationOffset is 1-indexed and must be positive.")}return ia(e,[{key:Ns,get:function(){return"Source"}}]),e}();var aa=Object.freeze({QUERY:"QUERY",MUTATION:"MUTATION",SUBSCRIPTION:"SUBSCRIPTION",FIELD:"FIELD",FRAGMENT_DEFINITION:"FRAGMENT_DEFINITION",FRAGMENT_SPREAD:"FRAGMENT_SPREAD",INLINE_FRAGMENT:"INLINE_FRAGMENT",VARIABLE_DEFINITION:"VARIABLE_DEFINITION",SCHEMA:"SCHEMA",SCALAR:"SCALAR",OBJECT:"OBJECT",FIELD_DEFINITION:"FIELD_DEFINITION",ARGUMENT_DEFINITION:"ARGUMENT_DEFINITION",INTERFACE:"INTERFACE",UNION:"UNION",ENUM:"ENUM",ENUM_VALUE:"ENUM_VALUE",INPUT_OBJECT:"INPUT_OBJECT",INPUT_FIELD_DEFINITION:"INPUT_FIELD_DEFINITION"});function ca(e){var t=e.split(/\r\n|[\n\r]/g),n=function(e){for(var t,n=!0,r=!0,o=0,i=null,s=0;s<e.length;++s)switch(e.charCodeAt(s)){case 13:10===e.charCodeAt(s+1)&&++s;case 10:n=!1,r=!0,o=0;break;case 9:case 32:++o;break;default:r&&!n&&(null===i||o<i)&&(i=o),r=!1}return null!==(t=i)&&void 0!==t?t:0}(e);if(0!==n)for(var r=1;r<t.length;r++)t[r]=t[r].slice(n);for(var o=0;o<t.length&&ua(t[o]);)++o;for(var i=t.length;i>o&&ua(t[i-1]);)--i;return t.slice(o,i).join("\n")}function ua(e){for(var t=0;t<e.length;++t)if(" "!==e[t]&&"\t"!==e[t])return!1;return!0}var la=function(){function e(e){var t=new Xs(ea.SOF,0,0,0,0,null);this.source=e,this.lastToken=t,this.token=t,this.line=1,this.lineStart=0}var t=e.prototype;return t.advance=function(){return this.lastToken=this.token,this.token=this.lookahead()},t.lookahead=function(){var e=this.token;if(e.kind!==ea.EOF)do{var t;e=null!==(t=e.next)&&void 0!==t?t:e.next=ha(this,e)}while(e.kind===ea.COMMENT);return e},e}();function da(e){return isNaN(e)?ea.EOF:e<127?JSON.stringify(String.fromCharCode(e)):'"\\u'.concat(("00"+e.toString(16).toUpperCase()).slice(-4),'"')}function ha(e,t){for(var n=e.source,r=n.body,o=r.length,i=t.end;i<o;){var s=r.charCodeAt(i),a=e.line,c=1+i-e.lineStart;switch(s){case 65279:case 9:case 32:case 44:++i;continue;case 10:++i,++e.line,e.lineStart=i;continue;case 13:10===r.charCodeAt(i+1)?i+=2:++i,++e.line,e.lineStart=i;continue;case 33:return new Xs(ea.BANG,i,i+1,a,c,t);case 35:return fa(n,i,a,c,t);case 36:return new Xs(ea.DOLLAR,i,i+1,a,c,t);case 38:return new Xs(ea.AMP,i,i+1,a,c,t);case 40:return new Xs(ea.PAREN_L,i,i+1,a,c,t);case 41:return new Xs(ea.PAREN_R,i,i+1,a,c,t);case 46:if(46===r.charCodeAt(i+1)&&46===r.charCodeAt(i+2))return new Xs(ea.SPREAD,i,i+3,a,c,t);break;case 58:return new Xs(ea.COLON,i,i+1,a,c,t);case 61:return new Xs(ea.EQUALS,i,i+1,a,c,t);case 64:return new Xs(ea.AT,i,i+1,a,c,t);case 91:return new Xs(ea.BRACKET_L,i,i+1,a,c,t);case 93:return new Xs(ea.BRACKET_R,i,i+1,a,c,t);case 123:return new Xs(ea.BRACE_L,i,i+1,a,c,t);case 124:return new Xs(ea.PIPE,i,i+1,a,c,t);case 125:return new Xs(ea.BRACE_R,i,i+1,a,c,t);case 34:return 34===r.charCodeAt(i+1)&&34===r.charCodeAt(i+2)?wa(n,i,a,c,t,e):ma(n,i,a,c,t);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return ga(n,i,s,a,c,t);case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 95:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:return Aa(n,i,a,c,t)}throw Qs(n,i,pa(s))}var u=e.line,l=1+i-e.lineStart;return new Xs(ea.EOF,o,o,u,l,t)}function pa(e){return e<32&&9!==e&&10!==e&&13!==e?"Cannot contain the invalid character ".concat(da(e),"."):39===e?"Unexpected single quote character ('), did you mean to use a double quote (\")?":"Cannot parse the unexpected character ".concat(da(e),".")}function fa(e,t,n,r,o){var i,s=e.body,a=t;do{i=s.charCodeAt(++a)}while(!isNaN(i)&&(i>31||9===i));return new Xs(ea.COMMENT,t,a,n,r,o,s.slice(t+1,a))}function ga(e,t,n,r,o,i){var s=e.body,a=n,c=t,u=!1;if(45===a&&(a=s.charCodeAt(++c)),48===a){if((a=s.charCodeAt(++c))>=48&&a<=57)throw Qs(e,c,"Invalid number, unexpected digit after 0: ".concat(da(a),"."))}else c=ya(e,c,a),a=s.charCodeAt(c);if(46===a&&(u=!0,a=s.charCodeAt(++c),c=ya(e,c,a),a=s.charCodeAt(c)),69!==a&&101!==a||(u=!0,43!==(a=s.charCodeAt(++c))&&45!==a||(a=s.charCodeAt(++c)),c=ya(e,c,a),a=s.charCodeAt(c)),46===a||function(e){return 95===e||e>=65&&e<=90||e>=97&&e<=122}(a))throw Qs(e,c,"Invalid number, expected digit but got: ".concat(da(a),"."));return new Xs(u?ea.FLOAT:ea.INT,t,c,r,o,i,s.slice(t,c))}function ya(e,t,n){var r=e.body,o=t,i=n;if(i>=48&&i<=57){do{i=r.charCodeAt(++o)}while(i>=48&&i<=57);return o}throw Qs(e,o,"Invalid number, expected digit but got: ".concat(da(i),"."))}function ma(e,t,n,r,o){for(var i=e.body,s=t+1,a=s,c=0,u="";s<i.length&&!isNaN(c=i.charCodeAt(s))&&10!==c&&13!==c;){if(34===c)return u+=i.slice(a,s),new Xs(ea.STRING,t,s+1,n,r,o,u);if(c<32&&9!==c)throw Qs(e,s,"Invalid character within String: ".concat(da(c),"."));if(++s,92===c){switch(u+=i.slice(a,s-1),c=i.charCodeAt(s)){case 34:u+='"';break;case 47:u+="/";break;case 92:u+="\\";break;case 98:u+="\b";break;case 102:u+="\f";break;case 110:u+="\n";break;case 114:u+="\r";break;case 116:u+="\t";break;case 117:var l=va(i.charCodeAt(s+1),i.charCodeAt(s+2),i.charCodeAt(s+3),i.charCodeAt(s+4));if(l<0){var d=i.slice(s+1,s+5);throw Qs(e,s,"Invalid character escape sequence: \\u".concat(d,"."))}u+=String.fromCharCode(l),s+=4;break;default:throw Qs(e,s,"Invalid character escape sequence: \\".concat(String.fromCharCode(c),"."))}a=++s}}throw Qs(e,s,"Unterminated string.")}function wa(e,t,n,r,o,i){for(var s=e.body,a=t+3,c=a,u=0,l="";a<s.length&&!isNaN(u=s.charCodeAt(a));){if(34===u&&34===s.charCodeAt(a+1)&&34===s.charCodeAt(a+2))return l+=s.slice(c,a),new Xs(ea.BLOCK_STRING,t,a+3,n,r,o,ca(l));if(u<32&&9!==u&&10!==u&&13!==u)throw Qs(e,a,"Invalid character within String: ".concat(da(u),"."));10===u?(++a,++i.line,i.lineStart=a):13===u?(10===s.charCodeAt(a+1)?a+=2:++a,++i.line,i.lineStart=a):92===u&&34===s.charCodeAt(a+1)&&34===s.charCodeAt(a+2)&&34===s.charCodeAt(a+3)?(l+=s.slice(c,a)+'"""',c=a+=4):++a}throw Qs(e,a,"Unterminated string.")}function va(e,t,n,r){return ba(e)<<12|ba(t)<<8|ba(n)<<4|ba(r)}function ba(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function Aa(e,t,n,r,o){for(var i=e.body,s=i.length,a=t+1,c=0;a!==s&&!isNaN(c=i.charCodeAt(a))&&(95===c||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122);)++a;return new Xs(ea.NAME,t,a,n,r,o,i.slice(t,a))}function Ea(e,t){return new Sa(e,t).parseDocument()}var Sa=function(){function e(e,t){var n=function(e){return e instanceof sa}(e)?e:new sa(e);this._lexer=new la(n),this._options=t}var t=e.prototype;return t.parseName=function(){var e=this.expectToken(ea.NAME);return{kind:Js.NAME,value:e.value,loc:this.loc(e)}},t.parseDocument=function(){var e=this._lexer.token;return{kind:Js.DOCUMENT,definitions:this.many(ea.SOF,this.parseDefinition,ea.EOF),loc:this.loc(e)}},t.parseDefinition=function(){if(this.peek(ea.NAME))switch(this._lexer.token.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"schema":case"scalar":case"type":case"interface":case"union":case"enum":case"input":case"directive":return this.parseTypeSystemDefinition();case"extend":return this.parseTypeSystemExtension()}else{if(this.peek(ea.BRACE_L))return this.parseOperationDefinition();if(this.peekDescription())return this.parseTypeSystemDefinition()}throw this.unexpected()},t.parseOperationDefinition=function(){var e=this._lexer.token;if(this.peek(ea.BRACE_L))return{kind:Js.OPERATION_DEFINITION,operation:"query",name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet(),loc:this.loc(e)};var t,n=this.parseOperationType();return this.peek(ea.NAME)&&(t=this.parseName()),{kind:Js.OPERATION_DEFINITION,operation:n,name:t,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseOperationType=function(){var e=this.expectToken(ea.NAME);switch(e.value){case"query":return"query";case"mutation":return"mutation";case"subscription":return"subscription"}throw this.unexpected(e)},t.parseVariableDefinitions=function(){return this.optionalMany(ea.PAREN_L,this.parseVariableDefinition,ea.PAREN_R)},t.parseVariableDefinition=function(){var e=this._lexer.token;return{kind:Js.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(ea.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(ea.EQUALS)?this.parseValueLiteral(!0):void 0,directives:this.parseDirectives(!0),loc:this.loc(e)}},t.parseVariable=function(){var e=this._lexer.token;return this.expectToken(ea.DOLLAR),{kind:Js.VARIABLE,name:this.parseName(),loc:this.loc(e)}},t.parseSelectionSet=function(){var e=this._lexer.token;return{kind:Js.SELECTION_SET,selections:this.many(ea.BRACE_L,this.parseSelection,ea.BRACE_R),loc:this.loc(e)}},t.parseSelection=function(){return this.peek(ea.SPREAD)?this.parseFragment():this.parseField()},t.parseField=function(){var e,t,n=this._lexer.token,r=this.parseName();return this.expectOptionalToken(ea.COLON)?(e=r,t=this.parseName()):t=r,{kind:Js.FIELD,alias:e,name:t,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(ea.BRACE_L)?this.parseSelectionSet():void 0,loc:this.loc(n)}},t.parseArguments=function(e){var t=e?this.parseConstArgument:this.parseArgument;return this.optionalMany(ea.PAREN_L,t,ea.PAREN_R)},t.parseArgument=function(){var e=this._lexer.token,t=this.parseName();return this.expectToken(ea.COLON),{kind:Js.ARGUMENT,name:t,value:this.parseValueLiteral(!1),loc:this.loc(e)}},t.parseConstArgument=function(){var e=this._lexer.token;return{kind:Js.ARGUMENT,name:this.parseName(),value:(this.expectToken(ea.COLON),this.parseValueLiteral(!0)),loc:this.loc(e)}},t.parseFragment=function(){var e=this._lexer.token;this.expectToken(ea.SPREAD);var t=this.expectOptionalKeyword("on");return!t&&this.peek(ea.NAME)?{kind:Js.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1),loc:this.loc(e)}:{kind:Js.INLINE_FRAGMENT,typeCondition:t?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(e)}},t.parseFragmentDefinition=function(){var e,t=this._lexer.token;return this.expectKeyword("fragment"),!0===(null===(e=this._options)||void 0===e?void 0:e.experimentalFragmentVariables)?{kind:Js.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}:{kind:Js.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet(),loc:this.loc(t)}},t.parseFragmentName=function(){if("on"===this._lexer.token.value)throw this.unexpected();return this.parseName()},t.parseValueLiteral=function(e){var t=this._lexer.token;switch(t.kind){case ea.BRACKET_L:return this.parseList(e);case ea.BRACE_L:return this.parseObject(e);case ea.INT:return this._lexer.advance(),{kind:Js.INT,value:t.value,loc:this.loc(t)};case ea.FLOAT:return this._lexer.advance(),{kind:Js.FLOAT,value:t.value,loc:this.loc(t)};case ea.STRING:case ea.BLOCK_STRING:return this.parseStringLiteral();case ea.NAME:switch(this._lexer.advance(),t.value){case"true":return{kind:Js.BOOLEAN,value:!0,loc:this.loc(t)};case"false":return{kind:Js.BOOLEAN,value:!1,loc:this.loc(t)};case"null":return{kind:Js.NULL,loc:this.loc(t)};default:return{kind:Js.ENUM,value:t.value,loc:this.loc(t)}}case ea.DOLLAR:if(!e)return this.parseVariable()}throw this.unexpected()},t.parseStringLiteral=function(){var e=this._lexer.token;return this._lexer.advance(),{kind:Js.STRING,value:e.value,block:e.kind===ea.BLOCK_STRING,loc:this.loc(e)}},t.parseList=function(e){var t=this,n=this._lexer.token;return{kind:Js.LIST,values:this.any(ea.BRACKET_L,function(){return t.parseValueLiteral(e)},ea.BRACKET_R),loc:this.loc(n)}},t.parseObject=function(e){var t=this,n=this._lexer.token;return{kind:Js.OBJECT,fields:this.any(ea.BRACE_L,function(){return t.parseObjectField(e)},ea.BRACE_R),loc:this.loc(n)}},t.parseObjectField=function(e){var t=this._lexer.token,n=this.parseName();return this.expectToken(ea.COLON),{kind:Js.OBJECT_FIELD,name:n,value:this.parseValueLiteral(e),loc:this.loc(t)}},t.parseDirectives=function(e){for(var t=[];this.peek(ea.AT);)t.push(this.parseDirective(e));return t},t.parseDirective=function(e){var t=this._lexer.token;return this.expectToken(ea.AT),{kind:Js.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(e),loc:this.loc(t)}},t.parseTypeReference=function(){var e,t=this._lexer.token;return this.expectOptionalToken(ea.BRACKET_L)?(e=this.parseTypeReference(),this.expectToken(ea.BRACKET_R),e={kind:Js.LIST_TYPE,type:e,loc:this.loc(t)}):e=this.parseNamedType(),this.expectOptionalToken(ea.BANG)?{kind:Js.NON_NULL_TYPE,type:e,loc:this.loc(t)}:e},t.parseNamedType=function(){var e=this._lexer.token;return{kind:Js.NAMED_TYPE,name:this.parseName(),loc:this.loc(e)}},t.parseTypeSystemDefinition=function(){var e=this.peekDescription()?this._lexer.lookahead():this._lexer.token;if(e.kind===ea.NAME)switch(e.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}throw this.unexpected(e)},t.peekDescription=function(){return this.peek(ea.STRING)||this.peek(ea.BLOCK_STRING)},t.parseDescription=function(){if(this.peekDescription())return this.parseStringLiteral()},t.parseSchemaDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("schema");var n=this.parseDirectives(!0),r=this.many(ea.BRACE_L,this.parseOperationTypeDefinition,ea.BRACE_R);return{kind:Js.SCHEMA_DEFINITION,description:t,directives:n,operationTypes:r,loc:this.loc(e)}},t.parseOperationTypeDefinition=function(){var e=this._lexer.token,t=this.parseOperationType();this.expectToken(ea.COLON);var n=this.parseNamedType();return{kind:Js.OPERATION_TYPE_DEFINITION,operation:t,type:n,loc:this.loc(e)}},t.parseScalarTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("scalar");var n=this.parseName(),r=this.parseDirectives(!0);return{kind:Js.SCALAR_TYPE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("type");var n=this.parseName(),r=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),i=this.parseFieldsDefinition();return{kind:Js.OBJECT_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:o,fields:i,loc:this.loc(e)}},t.parseImplementsInterfaces=function(){var e;if(!this.expectOptionalKeyword("implements"))return[];if(!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLImplementsInterfaces)){var t=[];this.expectOptionalToken(ea.AMP);do{t.push(this.parseNamedType())}while(this.expectOptionalToken(ea.AMP)||this.peek(ea.NAME));return t}return this.delimitedMany(ea.AMP,this.parseNamedType)},t.parseFieldsDefinition=function(){var e;return!0===(null===(e=this._options)||void 0===e?void 0:e.allowLegacySDLEmptyFields)&&this.peek(ea.BRACE_L)&&this._lexer.lookahead().kind===ea.BRACE_R?(this._lexer.advance(),this._lexer.advance(),[]):this.optionalMany(ea.BRACE_L,this.parseFieldDefinition,ea.BRACE_R)},t.parseFieldDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseArgumentDefs();this.expectToken(ea.COLON);var o=this.parseTypeReference(),i=this.parseDirectives(!0);return{kind:Js.FIELD_DEFINITION,description:t,name:n,arguments:r,type:o,directives:i,loc:this.loc(e)}},t.parseArgumentDefs=function(){return this.optionalMany(ea.PAREN_L,this.parseInputValueDef,ea.PAREN_R)},t.parseInputValueDef=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName();this.expectToken(ea.COLON);var r,o=this.parseTypeReference();this.expectOptionalToken(ea.EQUALS)&&(r=this.parseValueLiteral(!0));var i=this.parseDirectives(!0);return{kind:Js.INPUT_VALUE_DEFINITION,description:t,name:n,type:o,defaultValue:r,directives:i,loc:this.loc(e)}},t.parseInterfaceTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("interface");var n=this.parseName(),r=this.parseImplementsInterfaces(),o=this.parseDirectives(!0),i=this.parseFieldsDefinition();return{kind:Js.INTERFACE_TYPE_DEFINITION,description:t,name:n,interfaces:r,directives:o,fields:i,loc:this.loc(e)}},t.parseUnionTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("union");var n=this.parseName(),r=this.parseDirectives(!0),o=this.parseUnionMemberTypes();return{kind:Js.UNION_TYPE_DEFINITION,description:t,name:n,directives:r,types:o,loc:this.loc(e)}},t.parseUnionMemberTypes=function(){return this.expectOptionalToken(ea.EQUALS)?this.delimitedMany(ea.PIPE,this.parseNamedType):[]},t.parseEnumTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("enum");var n=this.parseName(),r=this.parseDirectives(!0),o=this.parseEnumValuesDefinition();return{kind:Js.ENUM_TYPE_DEFINITION,description:t,name:n,directives:r,values:o,loc:this.loc(e)}},t.parseEnumValuesDefinition=function(){return this.optionalMany(ea.BRACE_L,this.parseEnumValueDefinition,ea.BRACE_R)},t.parseEnumValueDefinition=function(){var e=this._lexer.token,t=this.parseDescription(),n=this.parseName(),r=this.parseDirectives(!0);return{kind:Js.ENUM_VALUE_DEFINITION,description:t,name:n,directives:r,loc:this.loc(e)}},t.parseInputObjectTypeDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("input");var n=this.parseName(),r=this.parseDirectives(!0),o=this.parseInputFieldsDefinition();return{kind:Js.INPUT_OBJECT_TYPE_DEFINITION,description:t,name:n,directives:r,fields:o,loc:this.loc(e)}},t.parseInputFieldsDefinition=function(){return this.optionalMany(ea.BRACE_L,this.parseInputValueDef,ea.BRACE_R)},t.parseTypeSystemExtension=function(){var e=this._lexer.lookahead();if(e.kind===ea.NAME)switch(e.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(e)},t.parseSchemaExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");var t=this.parseDirectives(!0),n=this.optionalMany(ea.BRACE_L,this.parseOperationTypeDefinition,ea.BRACE_R);if(0===t.length&&0===n.length)throw this.unexpected();return{kind:Js.SCHEMA_EXTENSION,directives:t,operationTypes:n,loc:this.loc(e)}},t.parseScalarTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");var t=this.parseName(),n=this.parseDirectives(!0);if(0===n.length)throw this.unexpected();return{kind:Js.SCALAR_TYPE_EXTENSION,name:t,directives:n,loc:this.loc(e)}},t.parseObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),o=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===o.length)throw this.unexpected();return{kind:Js.OBJECT_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:o,loc:this.loc(e)}},t.parseInterfaceTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");var t=this.parseName(),n=this.parseImplementsInterfaces(),r=this.parseDirectives(!0),o=this.parseFieldsDefinition();if(0===n.length&&0===r.length&&0===o.length)throw this.unexpected();return{kind:Js.INTERFACE_TYPE_EXTENSION,name:t,interfaces:n,directives:r,fields:o,loc:this.loc(e)}},t.parseUnionTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseUnionMemberTypes();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:Js.UNION_TYPE_EXTENSION,name:t,directives:n,types:r,loc:this.loc(e)}},t.parseEnumTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseEnumValuesDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:Js.ENUM_TYPE_EXTENSION,name:t,directives:n,values:r,loc:this.loc(e)}},t.parseInputObjectTypeExtension=function(){var e=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");var t=this.parseName(),n=this.parseDirectives(!0),r=this.parseInputFieldsDefinition();if(0===n.length&&0===r.length)throw this.unexpected();return{kind:Js.INPUT_OBJECT_TYPE_EXTENSION,name:t,directives:n,fields:r,loc:this.loc(e)}},t.parseDirectiveDefinition=function(){var e=this._lexer.token,t=this.parseDescription();this.expectKeyword("directive"),this.expectToken(ea.AT);var n=this.parseName(),r=this.parseArgumentDefs(),o=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");var i=this.parseDirectiveLocations();return{kind:Js.DIRECTIVE_DEFINITION,description:t,name:n,arguments:r,repeatable:o,locations:i,loc:this.loc(e)}},t.parseDirectiveLocations=function(){return this.delimitedMany(ea.PIPE,this.parseDirectiveLocation)},t.parseDirectiveLocation=function(){var e=this._lexer.token,t=this.parseName();if(void 0!==aa[t.value])return t;throw this.unexpected(e)},t.loc=function(e){var t;if(!0!==(null===(t=this._options)||void 0===t?void 0:t.noLocation))return new Zs(e,this._lexer.lastToken,this._lexer.source)},t.peek=function(e){return this._lexer.token.kind===e},t.expectToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t;throw Qs(this._lexer.source,t.start,"Expected ".concat(Ta(e),", found ").concat(Ia(t),"."))},t.expectOptionalToken=function(e){var t=this._lexer.token;if(t.kind===e)return this._lexer.advance(),t},t.expectKeyword=function(e){var t=this._lexer.token;if(t.kind!==ea.NAME||t.value!==e)throw Qs(this._lexer.source,t.start,'Expected "'.concat(e,'", found ').concat(Ia(t),"."));this._lexer.advance()},t.expectOptionalKeyword=function(e){var t=this._lexer.token;return t.kind===ea.NAME&&t.value===e&&(this._lexer.advance(),!0)},t.unexpected=function(e){var t=null!=e?e:this._lexer.token;return Qs(this._lexer.source,t.start,"Unexpected ".concat(Ia(t),"."))},t.any=function(e,t,n){this.expectToken(e);for(var r=[];!this.expectOptionalToken(n);)r.push(t.call(this));return r},t.optionalMany=function(e,t,n){if(this.expectOptionalToken(e)){var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r}return[]},t.many=function(e,t,n){this.expectToken(e);var r=[];do{r.push(t.call(this))}while(!this.expectOptionalToken(n));return r},t.delimitedMany=function(e,t){this.expectOptionalToken(e);var n=[];do{n.push(t.call(this))}while(this.expectOptionalToken(e));return n},e}();function Ia(e){var t=e.value;return Ta(e.kind)+(null!=t?' "'.concat(t,'"'):"")}function Ta(e){return function(e){return e===ea.BANG||e===ea.DOLLAR||e===ea.AMP||e===ea.PAREN_L||e===ea.PAREN_R||e===ea.SPREAD||e===ea.COLON||e===ea.EQUALS||e===ea.AT||e===ea.BRACKET_L||e===ea.BRACKET_R||e===ea.BRACE_L||e===ea.PIPE||e===ea.BRACE_R}(e)?'"'.concat(e,'"'):e}var Ca={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},ka=Object.freeze({});function Na(e,t,n){var r=e[t];if(r){if(!n&&"function"==typeof r)return r;var o=n?r.leave:r.enter;if("function"==typeof o)return o}else{var i=n?e.leave:e.enter;if(i){if("function"==typeof i)return i;var s=i[t];if("function"==typeof s)return s}}}function Oa(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ca,r=void 0,o=Array.isArray(e),i=[e],s=-1,a=[],c=void 0,u=void 0,l=void 0,d=[],h=[],p=e;do{var f=++s===i.length,g=f&&0!==a.length;if(f){if(u=0===h.length?void 0:d[d.length-1],c=l,l=h.pop(),g){if(o)c=c.slice();else{for(var y={},m=0,w=Object.keys(c);m<w.length;m++){var v=w[m];y[v]=c[v]}c=y}for(var b=0,A=0;A<a.length;A++){var E=a[A][0],S=a[A][1];o&&(E-=b),o&&null===S?(c.splice(E,1),b++):c[E]=S}}s=r.index,i=r.keys,a=r.edits,o=r.inArray,r=r.prev}else{if(u=l?o?s:i[s]:void 0,null==(c=l?l[u]:p))continue;l&&d.push(u)}var I,T=void 0;if(!Array.isArray(c)){if(!$s(c))throw new Error("Invalid AST Node: ".concat(na(c),"."));var C=Na(t,c.kind,f);if(C){if((T=C.call(t,c,u,l,d,h))===ka)break;if(!1===T){if(!f){d.pop();continue}}else if(void 0!==T&&(a.push([u,T]),!f)){if(!$s(T)){d.pop();continue}c=T}}}void 0===T&&g&&a.push([u,c]),f?d.pop():(r={inArray:o,index:s,keys:i,edits:a,prev:r},i=(o=Array.isArray(c))?c:null!==(I=n[c.kind])&&void 0!==I?I:[],s=-1,a=[],l&&h.push(l),l=c)}while(void 0!==r);return 0!==a.length&&(p=a[a.length-1][1]),p}(e,{leave:xa})}var xa={Name:function(e){return e.value},Variable:function(e){return"$"+e.name},Document:function(e){return _a(e.definitions,"\n\n")+"\n"},OperationDefinition:function(e){var t=e.operation,n=e.name,r=Ma("(",_a(e.variableDefinitions,", "),")"),o=_a(e.directives," "),i=e.selectionSet;return n||o||r||"query"!==t?_a([t,_a([n,r]),o,i]," "):i},VariableDefinition:function(e){var t=e.variable,n=e.type,r=e.defaultValue,o=e.directives;return t+": "+n+Ma(" = ",r)+Ma(" ",_a(o," "))},SelectionSet:function(e){return Ra(e.selections)},Field:function(e){var t=e.alias,n=e.name,r=e.arguments,o=e.directives,i=e.selectionSet,s=Ma("",t,": ")+n,a=s+Ma("(",_a(r,", "),")");return a.length>80&&(a=s+Ma("(\n",Pa(_a(r,"\n")),"\n)")),_a([a,_a(o," "),i]," ")},Argument:function(e){return e.name+": "+e.value},FragmentSpread:function(e){return"..."+e.name+Ma(" ",_a(e.directives," "))},InlineFragment:function(e){var t=e.typeCondition,n=e.directives,r=e.selectionSet;return _a(["...",Ma("on ",t),_a(n," "),r]," ")},FragmentDefinition:function(e){var t=e.name,n=e.typeCondition,r=e.variableDefinitions,o=e.directives,i=e.selectionSet;return"fragment ".concat(t).concat(Ma("(",_a(r,", "),")")," ")+"on ".concat(n," ").concat(Ma("",_a(o," ")," "))+i},IntValue:function(e){return e.value},FloatValue:function(e){return e.value},StringValue:function(e,t){var n=e.value;return e.block?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=-1===e.indexOf("\n"),o=" "===e[0]||"\t"===e[0],i='"'===e[e.length-1],s="\\"===e[e.length-1],a=!r||i||s||n,c="";return!a||r&&o||(c+="\n"+t),c+=t?e.replace(/\n/g,"\n"+t):e,a&&(c+="\n"),'"""'+c.replace(/"""/g,'\\"""')+'"""'}(n,"description"===t?"":"  "):JSON.stringify(n)},BooleanValue:function(e){return e.value?"true":"false"},NullValue:function(){return"null"},EnumValue:function(e){return e.value},ListValue:function(e){return"["+_a(e.values,", ")+"]"},ObjectValue:function(e){return"{"+_a(e.fields,", ")+"}"},ObjectField:function(e){return e.name+": "+e.value},Directive:function(e){return"@"+e.name+Ma("(",_a(e.arguments,", "),")")},NamedType:function(e){return e.name},ListType:function(e){return"["+e.type+"]"},NonNullType:function(e){return e.type+"!"},SchemaDefinition:Da(function(e){var t=e.directives,n=e.operationTypes;return _a(["schema",_a(t," "),Ra(n)]," ")}),OperationTypeDefinition:function(e){return e.operation+": "+e.type},ScalarTypeDefinition:Da(function(e){return _a(["scalar",e.name,_a(e.directives," ")]," ")}),ObjectTypeDefinition:Da(function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return _a(["type",t,Ma("implements ",_a(n," & ")),_a(r," "),Ra(o)]," ")}),FieldDefinition:Da(function(e){var t=e.name,n=e.arguments,r=e.type,o=e.directives;return t+(Ua(n)?Ma("(\n",Pa(_a(n,"\n")),"\n)"):Ma("(",_a(n,", "),")"))+": "+r+Ma(" ",_a(o," "))}),InputValueDefinition:Da(function(e){var t=e.name,n=e.type,r=e.defaultValue,o=e.directives;return _a([t+": "+n,Ma("= ",r),_a(o," ")]," ")}),InterfaceTypeDefinition:Da(function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return _a(["interface",t,Ma("implements ",_a(n," & ")),_a(r," "),Ra(o)]," ")}),UnionTypeDefinition:Da(function(e){var t=e.name,n=e.directives,r=e.types;return _a(["union",t,_a(n," "),r&&0!==r.length?"= "+_a(r," | "):""]," ")}),EnumTypeDefinition:Da(function(e){var t=e.name,n=e.directives,r=e.values;return _a(["enum",t,_a(n," "),Ra(r)]," ")}),EnumValueDefinition:Da(function(e){return _a([e.name,_a(e.directives," ")]," ")}),InputObjectTypeDefinition:Da(function(e){var t=e.name,n=e.directives,r=e.fields;return _a(["input",t,_a(n," "),Ra(r)]," ")}),DirectiveDefinition:Da(function(e){var t=e.name,n=e.arguments,r=e.repeatable,o=e.locations;return"directive @"+t+(Ua(n)?Ma("(\n",Pa(_a(n,"\n")),"\n)"):Ma("(",_a(n,", "),")"))+(r?" repeatable":"")+" on "+_a(o," | ")}),SchemaExtension:function(e){var t=e.directives,n=e.operationTypes;return _a(["extend schema",_a(t," "),Ra(n)]," ")},ScalarTypeExtension:function(e){return _a(["extend scalar",e.name,_a(e.directives," ")]," ")},ObjectTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return _a(["extend type",t,Ma("implements ",_a(n," & ")),_a(r," "),Ra(o)]," ")},InterfaceTypeExtension:function(e){var t=e.name,n=e.interfaces,r=e.directives,o=e.fields;return _a(["extend interface",t,Ma("implements ",_a(n," & ")),_a(r," "),Ra(o)]," ")},UnionTypeExtension:function(e){var t=e.name,n=e.directives,r=e.types;return _a(["extend union",t,_a(n," "),r&&0!==r.length?"= "+_a(r," | "):""]," ")},EnumTypeExtension:function(e){var t=e.name,n=e.directives,r=e.values;return _a(["extend enum",t,_a(n," "),Ra(r)]," ")},InputObjectTypeExtension:function(e){var t=e.name,n=e.directives,r=e.fields;return _a(["extend input",t,_a(n," "),Ra(r)]," ")}};function Da(e){return function(t){return _a([t.description,e(t)],"\n")}}function _a(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return null!==(t=null==e?void 0:e.filter(function(e){return e}).join(n))&&void 0!==t?t:""}function Ra(e){return Ma("{\n",Pa(_a(e,"\n")),"\n}")}function Ma(e,t){return null!=t&&""!==t?e+t+(arguments.length>2&&void 0!==arguments[2]?arguments[2]:""):""}function Pa(e){return Ma("  ",e.replace(/\n/g,"\n  "))}function La(e){return-1!==e.indexOf("\n")}function Ua(e){return null!=e&&e.some(La)}class ja extends Wr{constructor(e){super(e),this.constructor=ja,Object.setPrototypeOf(this,ja.prototype)}}class Ka extends ja{constructor(e={}){super({name:"CanceledError",message:"Request is canceled by user",...e}),this.constructor=Ka,Object.setPrototypeOf(this,Ka.prototype)}}const Ba=e=>!!e&&e instanceof Ka;var Fa;(Fa||(Fa={})).InvalidApiName="InvalidApiName",Fa.InvalidApiName;const qa=async e=>{if(!e)return;const t=await(async e=>{if(!e||e.statusCode<300)return;const t=await Wn(e),n=(e=>{const[t]=e.toString().split(/[,:]+/);return t.includes("#")?t.split("#")[1]:t})(e.headers["x-amzn-errortype"]??t.code??t.__type??"UnknownError"),r=t.message??t.Message??"Unknown error",o=new Error(r);return Object.assign(o,{name:n,$metadata:Gn(e)})})(Va(e));if(t){const n=await(e.body?.text());return Ga(t,{statusCode:e.statusCode,headers:e.headers,body:n})}},Va=e=>{let t;const n=new Proxy(e.body,{get:(e,n,r)=>"json"===n?async()=>{t||(t=e.text());try{return JSON.parse(await t)}catch(n){return{}}}:"text"===n?async()=>(t||(t=e.text()),t):Reflect.get(e,n,r)});return new Proxy(e,{get:(e,t,r)=>"body"===t?n:Reflect.get(e,t,r)})},Ga=(e,t)=>{const n=new ja({name:e?.name,message:e.message,underlyingError:e,response:t});return Object.assign(n,{$metadata:e.$metadata})},za=new Ne("RestApis");const Wa="execute-api",Qa="us-east-1",Ja=/^.+\.([a-z0-9-]+)\.([a-z0-9-]+)\.amazonaws\.com/,Ya=({headers:e},t)=>!e.authorization&&!e["x-api-key"]&&!!t,Ha=cr(dr,[ar,rr,({credentials:e,region:t,service:n,uriEscapePath:r=!0})=>{let o;return(i,s)=>async function(a){o=o??0;const c={credentials:"function"==typeof e?await e({forceRefresh:!!s?.isCredentialsExpired}):e,signingDate:Fr(o),signingRegion:t,signingService:n,uriEscapePath:r},u=await Br(a,c),l=await i(u),d=Vr(l);return d&&(o=qr(Date.parse(d),o)),l}}]),Za=cr(dr,[ar,rr]),Xa=async(e,t,n,r)=>{const{url:o,method:i,headers:s,body:a,withCredentials:c,abortSignal:u,retryStrategy:l}=t,d=a?a instanceof FormData?a:JSON.stringify(a??""):void 0,h=((e,t)=>{const n={};for(const r in e)n[r.toLowerCase()]=e[r];if(t){const e=n["content-type"];e&&(e.startsWith("application/json")||e.startsWith("application/")&&e.includes("+json"))||(n["content-type"]="application/json; charset=UTF-8"),t instanceof FormData&&delete n["content-type"]}return n})(s,a),p={url:o,headers:h,method:i,body:d},f={retryDecider:$a(l??e?.libraryOptions?.API?.REST?.retryStrategy),computeDelay:Yn,withCrossDomainCredentials:c,abortSignal:u},g=n(p,r);let y;const m=await ec(e);if(g&&m){const e=(e=>{const{service:t=Wa,region:n=Qa}={},{hostname:r}=e,[,o,i]=Ja.exec(r)??[];return o===Wa?{service:o,region:i??n}:"appsync-api"===o?{service:"appsync",region:i??n}:{service:t,region:n}})(o),t=r?.service??e.service,n=r?.region??e.region;y=await Ha(p,{...f,credentials:m,region:n,service:t})}else y=await Za(p,{...f});return{statusCode:y.statusCode,headers:y.headers,body:y.body}},$a=e=>{const t=e?.strategy;return"no-retry"===t?()=>Promise.resolve({retryable:!1}):Zn(qa)},ec=async e=>{try{const{credentials:t}=await e.Auth.fetchAuthSession();if(t)return t}catch(t){za.debug("No credentials available, the request will be unsigned.")}return null},tc=new WeakMap,nc=(e,{url:t,options:n,abortController:r})=>{const o=r??new AbortController,i=function(e,t){const n=e=>!!t,r=new AbortController,o=r.signal,i=t?.signal;let s;const a=async()=>{try{const t=await(n()?e():e(o));if(t.statusCode>=300)throw await qa(t);return t}catch(t){const e=i??o,n=s??e.reason;if("AbortError"===t.name||!0===e?.aborted){const e=new Ka({...n&&{message:n},underlyingError:t,recoverySuggestion:"The API request was explicitly canceled. If this is not intended, validate if you called the `cancel()` function on the API request erroneously."});throw za.debug(t),e}throw za.debug(t),t}};if(n())return a();{const e=e=>{!0!==o.aborted&&(r.abort(e),e&&o.reason!==e&&(s=e))};return{response:a(),cancel:e}}}(async()=>Xa(e,{url:t,method:"POST",...n,abortSignal:o.signal,retryStrategy:{strategy:"jittered-exponential-backoff"}},Ya,n?.signingServiceInfo),o),s=i.finally(()=>{tc.delete(s)});return s},rc=(e,t)=>{const n=tc.get(e);return!!n&&(n.abort(t),t&&n.signal.reason!==t&&(n.signal.reason=t),!0)},oc=(e,t)=>{tc.set(e,t)},ic=[400,401,403],sc=["BadRequestException","UnauthorizedException"];var ac,cc,uc,lc,dc,hc;(cc=ac||(ac={})).GQL_CONNECTION_INIT="connection_init",cc.GQL_CONNECTION_ERROR="connection_error",cc.GQL_CONNECTION_ACK="connection_ack",cc.GQL_START="start",cc.GQL_START_ACK="start_ack",cc.DATA="data",cc.GQL_CONNECTION_KEEP_ALIVE="ka",cc.GQL_STOP="stop",cc.GQL_COMPLETE="complete",cc.GQL_ERROR="error",cc.EVENT_SUBSCRIBE="subscribe",cc.EVENT_PUBLISH="publish",cc.EVENT_SUBSCRIBE_ACK="subscribe_success",cc.EVENT_PUBLISH_ACK="publish_success",cc.EVENT_STOP="unsubscribe",cc.EVENT_COMPLETE="unsubscribe_success",cc.EVENT_SUBSCRIBE_ERROR="subscribe_error",(lc=uc||(uc={}))[lc.PENDING=0]="PENDING",lc[lc.CONNECTED=1]="CONNECTED",lc[lc.FAILED=2]="FAILED",(hc=dc||(dc={}))[hc.CLOSED=0]="CLOSED",hc[hc.READY=1]="READY",hc[hc.CONNECTING=2]="CONNECTING";const pc={accept:"application/json, text/javascript","content-encoding":"amz-1.0","content-type":"application/json; charset=UTF-8"},fc=3e5;var gc,yc,mc,wc;(yc=gc||(gc={})).CONNECTION_CLOSED="Connection closed",yc.CONNECTION_FAILED="Connection failed",yc.REALTIME_SUBSCRIPTION_INIT_ERROR="AppSync Realtime subscription init error",yc.SUBSCRIPTION_ACK="Subscription ack",yc.TIMEOUT_DISCONNECT="Timeout disconnect",(wc=mc||(mc={})).Connected="Connected",wc.ConnectedPendingNetwork="ConnectedPendingNetwork",wc.ConnectionDisrupted="ConnectionDisrupted",wc.ConnectionDisruptedPendingNetwork="ConnectionDisruptedPendingNetwork",wc.Connecting="Connecting",wc.ConnectedPendingDisconnect="ConnectedPendingDisconnect",wc.Disconnected="Disconnected",wc.ConnectedPendingKeepAlive="ConnectedPendingKeepAlive";const vc=()=>(new jn).networkMonitor(),bc={KEEP_ALIVE_MISSED:{keepAliveState:"unhealthy"},KEEP_ALIVE:{keepAliveState:"healthy"},CONNECTION_ESTABLISHED:{connectionState:"connected"},CONNECTION_FAILED:{intendedConnectionState:"disconnected",connectionState:"disconnected"},CLOSING_CONNECTION:{intendedConnectionState:"disconnected"},OPENING_CONNECTION:{intendedConnectionState:"connected",connectionState:"connecting"},CLOSED:{connectionState:"disconnected"},ONLINE:{networkState:"connected"},OFFLINE:{networkState:"disconnected"}};class Ac{constructor(){this._networkMonitoringSubscription=void 0,this._linkedConnectionState={networkState:"connected",connectionState:"disconnected",intendedConnectionState:"disconnected",keepAliveState:"healthy"},this._initialNetworkStateSubscription=vc().subscribe(({online:e})=>{this.record(e?bc.ONLINE:bc.OFFLINE),this._initialNetworkStateSubscription?.unsubscribe()}),this._linkedConnectionStateObservable=new gn(e=>{e.next(this._linkedConnectionState),this._linkedConnectionStateObserver=e})}enableNetworkMonitoring(){this._initialNetworkStateSubscription?.unsubscribe(),void 0===this._networkMonitoringSubscription&&(this._networkMonitoringSubscription=vc().subscribe(({online:e})=>{this.record(e?bc.ONLINE:bc.OFFLINE)}))}disableNetworkMonitoring(){this._networkMonitoringSubscription?.unsubscribe(),this._networkMonitoringSubscription=void 0}get connectionStateObservable(){let e;return this._linkedConnectionStateObservable.pipe(Ln(e=>this.connectionStatesTranslator(e))).pipe((t=t=>{const n=t!==e;return e=t,n},mn(function(e,r){var o=0;e.subscribe(wn(r,function(e){return t.call(n,e,o++)&&r.next(e)}))})));var t,n}record(e){"connected"===e.intendedConnectionState?this.enableNetworkMonitoring():"disconnected"===e.intendedConnectionState&&this.disableNetworkMonitoring();const t={...this._linkedConnectionState,...e};this._linkedConnectionState={...t},this._linkedConnectionStateObserver?.next(this._linkedConnectionState)}connectionStatesTranslator({connectionState:e,networkState:t,intendedConnectionState:n,keepAliveState:r}){return"connected"===e&&"disconnected"===t?mc.ConnectedPendingNetwork:"connected"===e&&"disconnected"===n?mc.ConnectedPendingDisconnect:"disconnected"===e&&"connected"===n&&"disconnected"===t?mc.ConnectionDisruptedPendingNetwork:"disconnected"===e&&"connected"===n?mc.ConnectionDisrupted:"connected"===e&&"unhealthy"===r?mc.ConnectedPendingKeepAlive:"connecting"===e?mc.Connecting:"disconnected"===e?mc.Disconnected:mc.Connected}}var Ec,Sc;(Sc=Ec||(Ec={})).START_RECONNECT="START_RECONNECT",Sc.HALT_RECONNECT="HALT_RECONNECT";class Ic{constructor(){this.reconnectObservers=[]}addObserver(e){this.reconnectObservers.push(e)}record(e){e===Ec.START_RECONNECT&&void 0===this.reconnectSetTimeoutId&&void 0===this.reconnectIntervalId&&(this.reconnectSetTimeoutId=setTimeout(()=>{this._triggerReconnect(),this.reconnectIntervalId=setInterval(()=>{this._triggerReconnect()},6e4)},5e3)),e===Ec.HALT_RECONNECT&&(this.reconnectIntervalId&&(clearInterval(this.reconnectIntervalId),this.reconnectIntervalId=void 0),this.reconnectSetTimeoutId&&(clearTimeout(this.reconnectSetTimeoutId),this.reconnectSetTimeoutId=void 0))}close(){this.reconnectObservers.forEach(e=>{e.complete?.()})}_triggerReconnect(){this.reconnectObservers.forEach(e=>{e.next?.()})}}const Tc="wss://",Cc=/^https:\/\/\w{26}\.appsync-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/graphql$/i,kc=/^https:\/\/\w{26}\.\w+-api\.\w{2}(?:(?:-\w{2,})+)-\d\.amazonaws.com(?:\.cn)?\/event$/i,Nc="/realtime",Oc=e=>{let t=e??"";return t=null!==t.match(kc)?t.concat(Nc).replace("ddpg-api","grt-gamma").replace("appsync-api","appsync-realtime-api"):(e=>null===e.match(Cc))(t)?t.concat(Nc):t.replace("appsync-api","appsync-realtime-api").replace("gogi-beta","grt-beta").replace("ddpg-api","grt-gamma"),t=t.replace("https://",Tc).replace("http://",Tc),new hr(t)},xc=async e=>{const{appSyncGraphqlEndpoint:t,query:n,libraryConfigHeaders:r=()=>({}),additionalHeaders:o={},authToken:i}=e;let s={};const a=await r();if("function"==typeof o){const e={url:t||"",queryString:n||""};s=await o(e)}else s=o;return i&&(s={...s,Authorization:i}),{additionalCustomHeaders:s,libraryConfigHeaders:a}},Dc=new Ne("AWSAppSyncRealTimeProvider Auth"),_c=async({host:e})=>{const t=await Vn();return{Authorization:t?.tokens?.accessToken?.toString(),host:e}},Rc=async({apiKey:e,host:t})=>({host:t,"x-amz-date":(new Date).toISOString().replace(/[:-]|\.\d{3}/g,""),"x-api-key":e}),Mc=async({payload:e,canonicalUri:t,appSyncGraphqlEndpoint:n,region:r})=>{const o={region:r,service:"appsync"},i=(await Vn()).credentials,s={url:`${n}${t}`,data:e,method:"POST",headers:{...pc}};return Br({headers:s.headers,method:s.method,url:new hr(s.url),body:s.data},{credentials:i,signingRegion:o.region,signingService:o.service}).headers},Pc=async({host:e,additionalCustomHeaders:t})=>{if(!t?.Authorization)throw new Error("No auth token specified");return{Authorization:t.Authorization,host:e}},Lc=async({apiKey:e,authenticationType:t,canonicalUri:n,appSyncGraphqlEndpoint:r,region:o,additionalCustomHeaders:i,payload:s})=>{const a={apiKey:Rc,iam:Mc,oidc:_c,userPool:_c,lambda:Pc,none:Pc};if(t&&a[t]){const c=a[t],u=r?new hr(r).host:void 0,l="apiKey"===t?e:void 0;Dc.debug(`Authenticating with ${JSON.stringify(t)}`);return await c({payload:s,canonicalUri:n,appSyncGraphqlEndpoint:r,apiKey:l,region:o,host:u,additionalCustomHeaders:i})}Dc.debug(`Authentication type ${t} not supported`)},Uc=e=>{Me.dispatch("api",e,"PubSub",_e)};class jc{constructor(e){this.subscriptionObserverMap=new Map,this.allowNoSubscriptions=!1,this.socketStatus=dc.CLOSED,this.keepAliveTimestamp=Date.now(),this.promiseArray=[],this.connectionStateMonitor=new Ac,this.reconnectionMonitor=new Ic,this._establishConnection=async(e,t)=>{this.logger.debug(`Establishing WebSocket connection to ${e}`);try{await this._openConnection(e,t),await this._initiateHandshake()}catch(n){const{errorType:e,errorCode:t}=n;throw ic.includes(t)||sc.includes(e)?new Gr(e):e?new Error(e):n}},this.logger=new Ne(e.providerName),this.wsProtocolName=e.wsProtocolName,this.wsConnectUri=e.connectUri,this.connectionStateMonitorSubscription=this._startConnectionStateMonitoring()}close(){return this.socketStatus=dc.CLOSED,this.connectionStateMonitor.record(bc.CONNECTION_FAILED),this.connectionStateMonitorSubscription.unsubscribe(),this.reconnectionMonitor.close(),new Promise((e,t)=>{this.awsRealTimeSocket?(this.awsRealTimeSocket.onclose=t=>{this._closeSocket(),this.subscriptionObserverMap=new Map,this.awsRealTimeSocket=void 0,e()},this.awsRealTimeSocket.onerror=e=>{t(e)},this.awsRealTimeSocket.close()):e()})}subscribe(e,t){return new gn(n=>{if(!e?.appSyncGraphqlEndpoint)return n.error({errors:[{...new zs("Subscribe only available for AWS AppSync endpoint")}]}),void n.complete();let r=!1;const o=sr(),i=()=>{r||(r=!0,this._startSubscriptionWithAWSAppSyncRealTime({options:e,observer:n,subscriptionId:o,customUserAgentDetails:t}).catch(e=>{this.logger.debug(`${gc.REALTIME_SUBSCRIPTION_INIT_ERROR}: ${e}`),this._closeSocket()}).finally(()=>{r=!1}))},s=new gn(e=>{this.reconnectionMonitor.addObserver(e)}).subscribe(()=>{i()});return i(),async()=>{await this._cleanupSubscription(o,s)}})}async connect(e){this.socketStatus!==dc.READY&&await this._connectWebSocket(e)}async publish(e,t){if(this.socketStatus!==dc.READY)throw new Error("Subscription has not been initialized");return this._publishMessage(e,t)}async _connectWebSocket(e){const{apiKey:t,appSyncGraphqlEndpoint:n,authenticationType:r,region:o}=e,{additionalCustomHeaders:i}=await xc(e);this.connectionStateMonitor.record(bc.OPENING_CONNECTION),await this._initializeWebSocketConnection({apiKey:t,appSyncGraphqlEndpoint:n,authenticationType:r,region:o,additionalCustomHeaders:i})}async _publishMessage(e,t){const n=sr(),{additionalCustomHeaders:r,libraryConfigHeaders:o}=await xc(e),i=await this._prepareSubscriptionPayload({options:e,subscriptionId:n,customUserAgentDetails:t,additionalCustomHeaders:r,libraryConfigHeaders:o,publish:!0});return new Promise((e,t)=>{if(this.awsRealTimeSocket){const r=o=>{const i=JSON.parse(o.data);if(i.id===n&&"publish_success"===i.type&&(this.awsRealTimeSocket&&this.awsRealTimeSocket.removeEventListener("message",r),a(),e()),i.errors&&i.errors.length>0){const e=i.errors.map(e=>e.errorType);a(),t(new Error(`Publish errors: ${e.join(", ")}`))}},o=e=>{a(),t(new Error(`WebSocket error: ${e}`))},s=()=>{a(),t(new Error("WebSocket is closed"))},a=()=>{this.awsRealTimeSocket?.removeEventListener("message",r),this.awsRealTimeSocket?.removeEventListener("error",o),this.awsRealTimeSocket?.removeEventListener("close",s)};this.awsRealTimeSocket.addEventListener("message",r),this.awsRealTimeSocket.addEventListener("error",o),this.awsRealTimeSocket.addEventListener("close",s),this.awsRealTimeSocket.send(i)}else t(new Error("WebSocket is not connected"))})}async _cleanupSubscription(e,t){t?.unsubscribe();try{await this._waitForSubscriptionToBeConnected(e);const{subscriptionState:t}=this.subscriptionObserverMap.get(e)||{};if(!t)return;if(t!==uc.CONNECTED)throw new Error("Subscription never connected");this._sendUnsubscriptionMessage(e)}catch(n){this.logger.debug(`Error while unsubscribing ${n}`)}finally{this._removeSubscriptionObserver(e)}}_startConnectionStateMonitoring(){return this.connectionStateMonitor.connectionStateObservable.subscribe(e=>{Uc({event:"ConnectionStateChange",data:{provider:this,connectionState:e},message:`Connection state is ${e}`}),this.connectionState=e,e===mc.ConnectionDisrupted&&this.reconnectionMonitor.record(Ec.START_RECONNECT),[mc.Connected,mc.ConnectedPendingDisconnect,mc.ConnectedPendingKeepAlive,mc.ConnectedPendingNetwork,mc.ConnectionDisruptedPendingNetwork,mc.Disconnected].includes(e)&&this.reconnectionMonitor.record(Ec.HALT_RECONNECT)})}async _startSubscriptionWithAWSAppSyncRealTime({options:e,observer:t,subscriptionId:n,customUserAgentDetails:r}){const{query:o,variables:i}=e;this.subscriptionObserverMap.set(n,{observer:t,query:o??"",variables:i??{},subscriptionState:uc.PENDING,startAckTimeoutId:void 0});const{additionalCustomHeaders:s,libraryConfigHeaders:a}=await xc(e),c=await this._prepareSubscriptionPayload({options:e,subscriptionId:n,customUserAgentDetails:r,additionalCustomHeaders:s,libraryConfigHeaders:a});try{await this._connectWebSocket(e)}catch(d){return void this._logStartSubscriptionError(n,t,d)}const{subscriptionFailedCallback:u,subscriptionReadyCallback:l}=this.subscriptionObserverMap.get(n)??{};this.subscriptionObserverMap.set(n,{observer:t,subscriptionState:uc.PENDING,query:o??"",variables:i??{},subscriptionReadyCallback:l,subscriptionFailedCallback:u,startAckTimeoutId:setTimeout(()=>{this._timeoutStartSubscriptionAck(n)},15e3)}),this.awsRealTimeSocket&&this.awsRealTimeSocket.send(c)}_logStartSubscriptionError(e,t,n){this.logger.debug({err:n});const r=String(n.message??"");if(this._closeSocket(),this.connectionState!==mc.ConnectionDisruptedPendingNetwork){Pe(n)?t.error({errors:[{...new zs(`${gc.CONNECTION_FAILED}: ${r}`)}]}):this.logger.debug(`${gc.CONNECTION_FAILED}: ${r}`);const{subscriptionFailedCallback:o}=this.subscriptionObserverMap.get(e)||{};"function"==typeof o&&o()}}async _waitForSubscriptionToBeConnected(e){const t=this.subscriptionObserverMap.get(e);if(t){const{subscriptionState:n}=t;if(n===uc.PENDING)return new Promise((n,r)=>{const{observer:o,subscriptionState:i,variables:s,query:a}=t;this.subscriptionObserverMap.set(e,{observer:o,subscriptionState:i,variables:s,query:a,subscriptionReadyCallback:n,subscriptionFailedCallback:r})})}}_sendUnsubscriptionMessage(e){try{if(this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.socketStatus===dc.READY){const t=this._unsubscribeMessage(e),n=JSON.stringify(t);this.awsRealTimeSocket.send(n)}}catch(t){this.logger.debug({err:t})}}_removeSubscriptionObserver(e){this.subscriptionObserverMap.delete(e),this.allowNoSubscriptions||setTimeout(this._closeSocketIfRequired.bind(this),1e3)}_closeSocketIfRequired(){if(!(this.subscriptionObserverMap.size>0))if(this.awsRealTimeSocket)if(this.connectionStateMonitor.record(bc.CLOSING_CONNECTION),this.awsRealTimeSocket.bufferedAmount>0)setTimeout(this._closeSocketIfRequired.bind(this),1e3);else{this.logger.debug("closing WebSocket...");const e=this.awsRealTimeSocket;e.onclose=null,e.onerror=null,e.close(1e3),this.awsRealTimeSocket=void 0,this.socketStatus=dc.CLOSED,this._closeSocket()}else this.socketStatus=dc.CLOSED}maintainKeepAlive(){this.keepAliveTimestamp=Date.now()}keepAliveHeartbeat(e){const t=Date.now();t-this.keepAliveTimestamp>65e3?this.connectionStateMonitor.record(bc.KEEP_ALIVE_MISSED):this.connectionStateMonitor.record(bc.KEEP_ALIVE),t-this.keepAliveTimestamp>e&&this._errorDisconnect(gc.TIMEOUT_DISCONNECT)}_handleIncomingSubscriptionMessage(e){if("string"!=typeof e.data)return;const[t,n]=this._handleSubscriptionData(e);if(t)return void this.maintainKeepAlive();const{type:r,id:o,payload:i}=n,{observer:s=null,query:a="",variables:c={},startAckTimeoutId:u,subscriptionReadyCallback:l,subscriptionFailedCallback:d}=this.subscriptionObserverMap.get(o)||{};if(r===ac.GQL_START_ACK||r===ac.EVENT_SUBSCRIBE_ACK){this.logger.debug(`subscription ready for ${JSON.stringify({query:a,variables:c})}`),"function"==typeof l&&l(),u&&clearTimeout(u),Uc({event:gc.SUBSCRIPTION_ACK,data:{query:a,variables:c},message:"Connection established for subscription"});const e=uc.CONNECTED;return s&&this.subscriptionObserverMap.set(o,{observer:s,query:a,variables:c,startAckTimeoutId:void 0,subscriptionState:e,subscriptionReadyCallback:l,subscriptionFailedCallback:d}),void this.connectionStateMonitor.record(bc.CONNECTION_ESTABLISHED)}if(r!==ac.GQL_CONNECTION_KEEP_ALIVE){if(r===ac.GQL_ERROR||r===ac.EVENT_SUBSCRIBE_ERROR){const t=uc.FAILED;if(s){this.subscriptionObserverMap.set(o,{observer:s,query:a,variables:c,startAckTimeoutId:u,subscriptionReadyCallback:l,subscriptionFailedCallback:d,subscriptionState:t});let h=JSON.stringify(i??n);if(r===ac.EVENT_SUBSCRIBE_ERROR){const{errors:t}=JSON.parse(String(e.data));if(Array.isArray(t)&&t.length>0){const e=t[0];h=`${e.errorType}: ${e.message}`}}this.logger.debug(`${gc.CONNECTION_FAILED}: ${h}`),s.error({errors:[{...new zs(`${gc.CONNECTION_FAILED}: ${h}`)}]}),u&&clearTimeout(u),"function"==typeof d&&d()}}}else this.maintainKeepAlive()}_errorDisconnect(e){this.logger.debug(`Disconnect error: ${e}`),this.awsRealTimeSocket&&(this._closeSocket(),this.awsRealTimeSocket.close()),this.socketStatus=dc.CLOSED}_closeSocket(){this.keepAliveHeartbeatIntervalId&&(clearInterval(this.keepAliveHeartbeatIntervalId),this.keepAliveHeartbeatIntervalId=void 0),this.connectionStateMonitor.record(bc.CLOSED)}_timeoutStartSubscriptionAck(e){const t=this.subscriptionObserverMap.get(e);if(t){const{observer:n,query:r,variables:o}=t;if(!n)return;this.subscriptionObserverMap.set(e,{observer:n,query:r,variables:o,subscriptionState:uc.FAILED}),this._closeSocket(),this.logger.debug("timeoutStartSubscription",JSON.stringify({query:r,variables:o}))}}_initializeWebSocketConnection({appSyncGraphqlEndpoint:e,authenticationType:t,apiKey:n,region:r,additionalCustomHeaders:o}){if(this.socketStatus!==dc.READY)return new Promise(async(i,s)=>{if(this.promiseArray.push({res:i,rej:s}),this.socketStatus===dc.CLOSED)try{this.socketStatus=dc.CONNECTING;const i="{}",s=await Lc({authenticationType:t,payload:i,canonicalUri:this.wsConnectUri,apiKey:n,appSyncGraphqlEndpoint:e,region:r,additionalCustomHeaders:o}),a=s?JSON.stringify(s):"",c=`header-${Jr.convert(a,{urlSafe:!0,skipPadding:!0})}`,u=(e=>{const t=(e=>{if(!e)return{};if("Authorization"in e){const{Authorization:t,...n}=e;return n}return e})(e),n=new pr;return Object.entries(t).forEach(([e,t])=>{n.append(e,t)}),n})(o),l=((e,t)=>{const n=Oc(e),r=new pr(n.search);for(const[o,i]of t.entries())r.append(o,i);return n.search=r.toString(),n.toString()})(e,u);await this._establishRetryableConnection(l,c),this.promiseArray.forEach(({res:e})=>{this.logger.debug("Notifying connection successful"),e()}),this.socketStatus=dc.READY,this.promiseArray=[]}catch(a){this.logger.debug("Connection exited with",a),this.promiseArray.forEach(({rej:e})=>{e(a)}),this.promiseArray=[],this.awsRealTimeSocket&&this.awsRealTimeSocket.readyState===WebSocket.OPEN&&this.awsRealTimeSocket.close(3001),this.awsRealTimeSocket=void 0,this.socketStatus=dc.CLOSED}})}async _establishRetryableConnection(e,t){this.logger.debug("Establishing retryable connection"),await zr(this._establishConnection.bind(this),[e,t],5e3)}async _openConnection(e,t){return new Promise((n,r)=>{const o=this._getNewWebSocket(e,[this.wsProtocolName,t]);o.onerror=()=>{this.logger.debug("WebSocket connection error")},o.onclose=()=>{this._closeSocket(),r(new Error("Connection handshake error"))},o.onopen=()=>{this.awsRealTimeSocket=o,n()}})}_getNewWebSocket(e,t){return new WebSocket(e,t)}async _initiateHandshake(){return new Promise((e,t)=>{if(!this.awsRealTimeSocket)return void t(new Error("awsRealTimeSocket undefined"));let n=!1;this.awsRealTimeSocket.onerror=e=>{this.logger.debug(`WebSocket error ${JSON.stringify(e)}`)},this.awsRealTimeSocket.onclose=e=>{this.logger.debug(`WebSocket closed ${e.reason}`),this._closeSocket(),t(new Error(JSON.stringify(e)))},this.awsRealTimeSocket.onmessage=r=>{if("string"!=typeof r.data)return;this.logger.debug(`subscription message from AWS AppSyncRealTime: ${r.data} `);const o=JSON.parse(r.data),{type:i}=o,s=this._extractConnectionTimeout(o);if(i===ac.GQL_CONNECTION_ACK)return n=!0,this._registerWebsocketHandlers(s),void e("Connected to AWS AppSyncRealTime");if(i===ac.GQL_CONNECTION_ERROR){const{errorType:e,errorCode:n}=this._extractErrorCodeAndType(o);t({errorType:e,errorCode:n})}};const r={type:ac.GQL_CONNECTION_INIT};this.awsRealTimeSocket.send(JSON.stringify(r));const o=e=>{e||(this.connectionStateMonitor.record(bc.CONNECTION_FAILED),t(new Error("Connection timeout: ack from AWSAppSyncRealTime was not received after 15000 ms")))};setTimeout(()=>{o(n)},15e3)})}_registerWebsocketHandlers(e){this.awsRealTimeSocket&&(this.keepAliveHeartbeatIntervalId=setInterval(()=>{this.keepAliveHeartbeat(e)},5e3),this.awsRealTimeSocket.onmessage=this._handleIncomingSubscriptionMessage.bind(this),this.awsRealTimeSocket.onerror=e=>{this.logger.debug(e),this._errorDisconnect(gc.CONNECTION_CLOSED)},this.awsRealTimeSocket.onclose=e=>{this.logger.debug(`WebSocket closed ${e.reason}`),this._closeSocket(),this._errorDisconnect(gc.CONNECTION_CLOSED)})}}const Kc="AWSAppSyncRealTimeProvider";class Bc extends jc{constructor(){super({providerName:Kc,wsProtocolName:"graphql-ws",connectUri:"/connect"})}getProviderName(){return Kc}subscribe(e,t){return super.subscribe(e,t)}async _prepareSubscriptionPayload({options:e,subscriptionId:t,customUserAgentDetails:n,additionalCustomHeaders:r,libraryConfigHeaders:o}){const{appSyncGraphqlEndpoint:i,authenticationType:s,query:a,variables:c,apiKey:u,region:l}=e,d={query:a,variables:c},h=JSON.stringify(d),p={id:t,payload:{data:h,extensions:{authorization:{...{...await Lc({apiKey:u,appSyncGraphqlEndpoint:i,authenticationType:s,payload:h,canonicalUri:"",region:l,additionalCustomHeaders:r}),...o,...r,[Ie]:Yt(n)}}}},type:ac.GQL_START};return JSON.stringify(p)}_handleSubscriptionData(e){this.logger.debug(`subscription message from AWS AppSync RealTime: ${e.data}`);const{id:t="",payload:n,type:r}=JSON.parse(String(e.data)),{observer:o=null,query:i="",variables:s={}}=this.subscriptionObserverMap.get(t)||{};return this.logger.debug({id:t,observer:o,query:i,variables:s}),r===ac.DATA&&n&&n.data?(o?o.next(n):this.logger.debug(`observer not found for id: ${t}`),[!0,{id:t,type:r,payload:n}]):[!1,{id:t,type:r,payload:n}]}_unsubscribeMessage(e){return{id:e,type:ac.GQL_STOP}}_extractConnectionTimeout(e){const{payload:{connectionTimeoutMs:t=fc}={}}=e;return t}_extractErrorCodeAndType(e){const{payload:{errors:[{errorType:t="",errorCode:n=0}={}]=[]}={}}=e;return{errorCode:n,errorType:t}}}class Fc extends Oe{constructor(e){super(e),this.constructor=Fc,Object.setPrototypeOf(this,Fc.prototype)}}var qc,Vc;(Vc=qc||(qc={})).NoAuthSession="NoAuthSession",Vc.NoRegion="NoRegion",Vc.NoCustomEndpoint="NoCustomEndpoint";const Gc={[qc.NoAuthSession]:{message:"Auth session should not be empty."},[qc.NoRegion]:{message:"Missing region."},[qc.NoCustomEndpoint]:{message:"Custom endpoint region is present without custom endpoint."}};const zc=new Ne("GraphQLAPI resolveConfig"),Wc=e=>{const t=e.getConfig();t.API?.GraphQL||zc.warn("The API configuration is missing. This is likely due to Amplify.configure() not being called prior to generateClient().");const{apiKey:n,customEndpoint:r,customEndpointRegion:o,defaultAuthMode:i,endpoint:s,region:a}=t.API?.GraphQL??{};return function(e,t){const{message:n,recoverySuggestion:r}=Gc[t];if(!e)throw new Fc({name:t,message:n,recoverySuggestion:r})}(!(!r&&o),qc.NoCustomEndpoint),{apiKey:n,customEndpoint:r,customEndpointRegion:o,defaultAuthMode:i,endpoint:s,region:a}},Qc=e=>{const t=e.libraryOptions?.API?.GraphQL?.headers,n=e.libraryOptions?.API?.GraphQL?.withCredentials;return{headers:t,withCredentials:n}};function Jc(e){return e.errors&&Array.isArray(e.errors)&&e.errors.forEach(e=>{(function(e){if(e?.originalError?.name?.startsWith("UnauthorizedException"))return!0;if(e.message?.startsWith("Connection failed:")&&e.message?.includes("Permission denied"))return!0;return!1})(e)&&(e.message="Unauthorized",e.recoverySuggestion="If you're calling an Amplify-generated API, make sure to set the \"authMode\" in generateClient({ authMode: '...' }) to the backend authorization rule's auth provider ('apiKey', 'userPool', 'iam', 'oidc', 'lambda')")}),e}var Yc,Hc;(Hc=Yc||(Yc={})).NO_API_KEY="No api-key configured",Hc.NO_CURRENT_USER="No current user",Hc.NO_CREDENTIALS="No credentials",Hc.NO_FEDERATED_JWT="No federated jwt",Hc.NO_AUTH_TOKEN="No auth token specified";const Zc=Symbol("amplify"),Xc=Symbol("authMode"),$c=Symbol("authToken"),eu=Symbol("apiKey"),tu=Symbol("headers"),nu=Symbol("endpoint");function ru(e){const t=e;return{amplify:t[Zc],apiKey:t[eu],authMode:t[Xc],authToken:t[$c],endpoint:t[nu],headers:t[tu]}}const ou={name:"NoApiKey",message:Yc.NO_API_KEY,recoverySuggestion:'The API request was made with `authMode: "apiKey"` but no API Key was passed into `Amplify.configure()`. Review if your API key is passed into the `Amplify.configure()` function.'},iu={name:"NoCredentials",message:Yc.NO_CREDENTIALS,recoverySuggestion:'The API request was made with `authMode: "iam"` but no authentication credentials are available.\n\nIf you intended to make a request using an authenticated role, review if your user is signed in before making the request.\n\nIf you intend to make a request using an unauthenticated role or also known as "guest access", verify if "Auth.Cognito.allowGuestAccess" is set to "true" in the `Amplify.configure()` function.'},su={name:"NoValidAuthTokens",message:Yc.NO_FEDERATED_JWT,recoverySuggestion:"If you intended to make an authenticated API request, review if the current user is signed in."},au={name:"NoSignedUser",message:Yc.NO_CURRENT_USER,recoverySuggestion:"Review the underlying exception field for more details. If you intended to make an authenticated API request, review if the current user is signed in."},cu={name:"NoAuthorizationHeader",message:Yc.NO_AUTH_TOKEN,recoverySuggestion:'The API request was made with `authMode: "lambda"` but no `authToken` is set. Review if a valid authToken is passed into the request options or in the `Amplify.configure()` function.'},uu={name:"NoEndpoint",message:"No GraphQL endpoint configured in `Amplify.configure()`.",recoverySuggestion:"Review if the GraphQL API endpoint is set in the `Amplify.configure()` function."},lu=e=>({data:{},errors:[new zs(e.message,null,null,null,null,e)]});const du="x-amz-user-agent";class hu{constructor(){this.appSyncRealTime=new Map,this._api={post:nc,cancelREST:rc,isCancelErrorREST:Ba,updateRequestToBeCancellable:oc}}getModuleName(){return"InternalGraphQLAPI"}getGraphqlOperationType(e){const t=Ea(e).definitions,[{operation:n}]=t;return n}graphql(e,{query:t,variables:n={},authMode:r,authToken:o,endpoint:i,apiKey:s},a,c){const u=Ea("string"==typeof t?t:Oa(t)),[l={}]=u.definitions.filter(e=>"OperationDefinition"===e.kind),{operation:d}=l,h=a||{};switch(d){case"query":case"mutation":{const t=new AbortController;let a;if((e=>"function"!=typeof e)(e))a=this._graphql(e,{query:u,variables:n,authMode:r,apiKey:s,endpoint:i},h,t,c,o);else{a=e(async e=>await this._graphql(e,{query:u,variables:n,authMode:r,apiKey:s,endpoint:i},h,t,c,o))}return this._api.updateRequestToBeCancellable(a,t),a}case"subscription":return this._graphqlSubscribe(e,{query:u,variables:n,authMode:r,apiKey:s,endpoint:i},h,c,o);default:throw new Error(`invalid operation type: ${d}`)}}async _graphql(e,{query:t,variables:n,authMode:r,endpoint:o,apiKey:i},s={},a,c,u){const{apiKey:l,region:d,endpoint:h,customEndpoint:p,customEndpointRegion:f,defaultAuthMode:g}=Wc(e),y=r||g||"iam",m="identityPool"===y?"iam":y,{headers:w,withCredentials:v}=Qc(e);let b;if("function"==typeof s){const e={method:"POST",url:new hr(o||p||h||"").toString(),queryString:Oa(t)};b=await s(e)}else b=s;u&&(b={...b,Authorization:u});const A=await async function(e,t,n,r={}){let o={};switch(t){case"apiKey":if(!n)throw new Fc(ou);o={"X-Api-Key":n};break;case"iam":if(void 0===(await e.Auth.fetchAuthSession()).credentials)throw new Fc(iu);break;case"oidc":case"userPool":{let t;try{t=(await e.Auth.fetchAuthSession()).tokens?.accessToken.toString()}catch(i){throw new Fc({...au,underlyingError:i})}if(!t)throw new Fc(su);o={Authorization:t};break}case"lambda":if("object"==typeof r&&!r.Authorization)throw new Fc(cu);o={Authorization:r.Authorization}}return o}(e,m,i??l,b),E={...!p&&A,...p&&(f?A:{})||{},...w&&await w({query:Oa(t),variables:n}),...b,...!p&&{[du]:Yt(c)}},S={query:Oa(t),variables:n||null};let I;I=p&&!f||"oidc"!==m&&"userPool"!==m&&"iam"!==m&&"lambda"!==m?void 0:{service:f?"execute-api":"appsync",region:f||d};const T=o||p||h;if(!T)throw lu(new Fc(uu));let C;try{const{body:t}=await this._api.post(e,{url:new hr(T),options:{headers:E,body:S,signingServiceInfo:I,withCredentials:v},abortController:a});C=await t.json()}catch(k){if(this.isCancelError(k))throw k;C=lu(k)}if(function(e){if(!e)return!1;const t=e;return Array.isArray(t.errors)&&t.errors.length>0}(C))throw Jc(C);return C}isCancelError(e){return this._api.isCancelErrorREST(e)}cancel(e,t){return this._api.cancelREST(e,t)}_graphqlSubscribe(e,{query:t,variables:n,authMode:r,apiKey:o,endpoint:i},s={},a,c){const u=Wc(e),l=r||u?.defaultAuthMode||"iam",d="identityPool"===l?"iam":l,{headers:h}=Qc(e),p=i??u?.endpoint,f=p??"none",g=this.appSyncRealTime.get(f)??new Bc;return this.appSyncRealTime.set(f,g),g.subscribe({query:Oa(t),variables:n,appSyncGraphqlEndpoint:p,region:u?.region,authenticationType:d,apiKey:o??u?.apiKey,additionalHeaders:s,authToken:c,libraryConfigHeaders:h},a).pipe(Un(e=>{if(e.errors)throw Jc(e);throw e}))}}function pu(e){const t=new Set;for(const n of e.attributes||[])if(fu(n))for(const e of n.properties.rules)"owner"===e.allow?t.add(e.ownerField||"owner"):"groups"===e.allow&&void 0!==e.groupsField&&t.add(e.groupsField);return Array.from(t)}function fu(e){return!("auth"!==e?.type||"object"!=typeof e?.properties||!Array.isArray(e?.properties?.rules))&&(e?.properties?.rules).every(e=>!!e.allow)}function gu(e){return`${e[0].toUpperCase()}${e.slice(1)}`}function yu(e){let t,n;const r=new Promise((e,r)=>{t=e,n=r});return e(r).then(e=>{t(e)}).catch(e=>{n(e)}),r}const mu=new WeakMap;function wu(e,t){return mu.set(t,e),e.finally(()=>{mu.delete(t)})}const vu="HAS_ONE",bu="HAS_MANY",Au="BELONGS_TO",Eu={ID:"ID",String:"String",AWSDate:"String",AWSTime:"String",AWSDateTime:"String",AWSTimestamp:"Int",AWSEmail:"String",AWSPhone:"String",AWSURL:"String",AWSIPAddress:"String",AWSJSON:"String",Boolean:"Boolean",Int:"Int",Float:"Float"},Su=e=>1===e.length?e[0]:e.reduce((e,t,n)=>0===n?t:e+gu(t),""),Iu=(e,t,n)=>{if(!n)return null;const r={};for(const[o,i]of Object.entries(n)){const n=t?e.models[t]?.fields[o]:void 0,s={fieldDef:n,value:i};Tu(s)?r[o]=s.value.items.map(t=>Iu(e,s.fieldDef.type.model,t)):Cu(n)?r[o]=Iu(e,n.type.model,i):r[o]=i}return r};function Tu(e){return"object"==typeof e.fieldDef?.type&&"model"in e.fieldDef.type&&"string"==typeof e.fieldDef.type.model&&e.fieldDef.isArray&&Array.isArray(e.value?.items)}function Cu(e){return"object"==typeof e?.type&&"model"in e.type&&"string"==typeof e.type.model}function ku(e,t,n,r,o,i,s=!1){const a=r.models[t],c=a.fields,u=Object.entries(c).filter(([e,t])=>void 0!==t?.type?.model).map(([e])=>e);return n.map(t=>{if(null==t)return t;const n={};for(const l of u){const u=c[l],d=u?.type,h=d.model,p=r.models[h],f=p.primaryKeyInfo.primaryKeyFieldName,g=p.primaryKeyInfo.sortKeyFieldNames,y=u.association?.connectionType;let m=[];u.association&&"associatedWith"in u.association&&(m=u.association.associatedWith);const w=[];switch(u.association&&"targetNames"in u.association&&w.push(...u.association.targetNames),y){case Au:{const r=g.reduce((e,n)=>(t[n]&&(e[n]=t[n]),e),{});if(void 0===e.models[h]?.get)break;n[l]=s?(n,s)=>t[w[0]]?e.models[h].get(n,{[f]:t[w[0]],...r},{authMode:s?.authMode||o,authToken:s?.authToken||i}):{data:null}:n=>t[w[0]]?e.models[h].get({[f]:t[w[0]],...r},{authMode:n?.authMode||o,authToken:n?.authToken||i}):{data:null};break}case vu:case bu:{const r=y===vu?e=>({data:e?.data.shift()||null,errors:e.errors,extensions:e.extensions}):e=>e,c=a.primaryKeyInfo.primaryKeyFieldName,u=a.primaryKeyInfo.sortKeyFieldNames,d=p.fields[m[0]];if(d.type.model){let a=[];d.association&&"targetNames"in d.association&&(a=d.association?.targetNames);const p=a.map((e,n)=>0===n?{[e]:{eq:t[c]}}:{[e]:{eq:t[u[n-1]]}});if(void 0===e.models[h]?.list)break;n[l]=s?(n,s)=>t[c]?yu(async t=>{const a=wu(e.models[h].list(n,{filter:{and:p},limit:s?.limit,nextToken:s?.nextToken,authMode:s?.authMode||o,authToken:s?.authToken||i}),t);return r(await a)}):[]:n=>t[c]?yu(async t=>{const s=wu(e.models[h].list({filter:{and:p},limit:n?.limit,nextToken:n?.nextToken,authMode:n?.authMode||o,authToken:n?.authToken||i}),t);return r(await s)}):[];break}const f=m.map((e,n)=>0===n?{[e]:{eq:t[c]}}:{[e]:{eq:t[u[n-1]]}});if(void 0===e.models[h]?.list)break;n[l]=s?(n,s)=>t[c]?yu(async t=>{const a=wu(e.models[h].list(n,{filter:{and:f},limit:s?.limit,nextToken:s?.nextToken,authMode:s?.authMode||o,authToken:s?.authToken||i}),t);return r(await a)}):[]:n=>t[c]?yu(async t=>{const s=wu(e.models[h].list({filter:{and:f},limit:n?.limit,nextToken:n?.nextToken,authMode:n?.authMode||o,authToken:n?.authToken||i}),t);return r(await s)}):[];break}}}return{...t,...n}})}const Nu={CREATE:{operationPrefix:"create",usePlural:!1},GET:{operationPrefix:"get",usePlural:!1},UPDATE:{operationPrefix:"update",usePlural:!1},DELETE:{operationPrefix:"delete",usePlural:!1},LIST:{operationPrefix:"list",usePlural:!0},INDEX_QUERY:{operationPrefix:"",usePlural:!1},ONCREATE:{operationPrefix:"onCreate",usePlural:!1},ONUPDATE:{operationPrefix:"onUpdate",usePlural:!1},ONDELETE:{operationPrefix:"onDelete",usePlural:!1},OBSERVEQUERY:{operationPrefix:"observeQuery",usePlural:!1}},Ou=(e,t)=>{const{fields:n}=e,r=Object.values(n).map(({type:e,name:n})=>"string"==typeof e.enum?[n,Du]:"string"==typeof e.nonModel?[n,Ou(t.nonModels[e.nonModel],t)]:"string"==typeof e?[n,Du]:void 0).filter(e=>void 0!==e);return Object.fromEntries(r)},xu=(e,t)=>{const{fields:n}=e,r=Object.values(n).map(({type:e,name:n})=>"string"==typeof e.enum||"string"==typeof e?[n,Du]:"string"==typeof e.nonModel?[n,Ou(t.nonModels[e.nonModel],t)]:void 0).filter(e=>void 0!==e),o=pu(e).map(e=>[e,Du]);return Object.fromEntries(r.concat(o))};const Du="";function _u(e,t,n){const r=(t,n)=>{const[o,...i]=t.split("."),s=i[0],a=e.models[n]??e.nonModels[n],c=a?.fields,u=c?.[o]?.type?.model,l=e.models[u],d=c?.[o]?.type?.nonModel,h=e.nonModels[d],p=l?"model":h?"nonModel":"field";if("nonModel"===p){let t={};if(!s)throw Error(`${o} must declare a wildcard (*) or a field of custom type ${d}`);return t="*"===s?{[o]:Ou(h,e)}:{[o]:r(i.join("."),d)},t}if("model"===p){let t={};if(!s)throw Error(`${o} must declare a wildcard (*) or a field of model ${u}`);if("*"===s){const n=e.models[u];t={[o]:xu(n,e)}}else t={[o]:r(i.join("."),u)};return c[o]?.isArray&&(t={[o]:{items:t[o]}}),t}{const t=c?.[o],r=e.nonModels[n],i=r?.fields?.[o];if(r){if(!i)throw Error(`${o} is not a field of custom type ${n}`)}else{const e=pu(a).includes(o);if(!t&&!e)throw Error(`${o} is not a field of model ${n}`)}return{[o]:Du}}};return n.reduce((e,n)=>Mu(r(n,t),e),{})}function Ru(e){const t=[];return Object.entries(e).forEach(([e,n])=>{n===Du?t.push(e):"object"==typeof n&&null!==n&&(n?.items?t.push(e,"{","items","{",Ru(n.items),"}","}"):t.push(e,"{",Ru(n),"}"))}),t.join(" ")}function Mu(e,t){const n=e=>e&&"object"==typeof e;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(Object.prototype.hasOwnProperty.call(t,r)&&n(t[r])?Mu(e[r],t[r]):t[r]=e[r]);return t}function Pu(e,t,n){const r=e.models[t],o=_u(e,t,n??function(e){const{fields:t}=e,n=Object.values(t).map(({type:e,name:t})=>{if("string"==typeof e)return t;if("object"==typeof e){if("string"==typeof e?.enum)return t;if("string"==typeof e?.nonModel)return`${t}.*`}}).filter(Boolean),r=pu(e);return Array.from(new Set(n.concat(r)))}(r));return Ru(o)}function Lu(e,t,n,r,o){const{name:i,pluralName:s,fields:a,primaryKeyInfo:{isCustomPrimaryKey:c,primaryKeyFieldName:u,sortKeyFieldNames:l},attributes:d}=t,h=i.charAt(0).toUpperCase()+i.slice(1),p=s.charAt(0).toUpperCase()+s.slice(1),{operationPrefix:f,usePlural:g}=Nu[n],{selectionSet:y}=r||{};let m,w,v,b,A;if(f)m=`${f}${g?p:h}`;else{if(!o)throw new Error("Error generating GraphQL Document - invalid operation name");{const{queryField:e,pk:t,sk:n=[]}=o;m=e;let r={};if(1===n.length){const[e]=n,t="string"==typeof a[e].type?a[e].type:"String",o=Eu[t];r={[e]:`Model${o}KeyConditionInput`}}else if(n.length>1){const t=Su(n),o=d?.find(t=>t?.properties?.queryField===e)?.properties?.name;r={[t]:`Model${gu(i)}${gu(o)}CompositeKeyConditionInput`}}w={[t]:`${Object.prototype.hasOwnProperty.call(a[t].type,"enum")?a[t].type.enum:a[t].type}!`,...r}}}const E=Pu(e,i,y),S={[u]:`${a[u].type}!`},I={},T=e=>{if(0===l.length)return{};if("get"===e)return l.reduce((t,n)=>{const r=a[n].type;return"get"===e&&(t[n]=`${r}!`),t},{});if(1===l.length){const[e]=l,t="string"==typeof a[e].type?a[e].type:"String",n=Eu[t];return{[e]:`Model${n}KeyConditionInput`}}{const e=Su(l);return{[e]:`Model${gu(i)}PrimaryCompositeKeyConditionInput`}}};switch(c&&(Object.assign(S,T("get")),Object.assign(I,{[u]:`${a[u].type}`,sortDirection:"ModelSortDirection"},T("list"))),n){case"CREATE":case"UPDATE":case"DELETE":A??(A={input:`${f.charAt(0).toLocaleUpperCase()+f.slice(1)}${h}Input!`}),v??(v="mutation");case"GET":A??(A=S),b??(b=E);case"LIST":A??(A={...I,filter:`Model${h}FilterInput`,limit:"Int",nextToken:"String"}),v??(v="query"),b??(b=`items { ${E} } nextToken __typename`);case"INDEX_QUERY":A??(A={...w,filter:`Model${h}FilterInput`,sortDirection:"ModelSortDirection",limit:"Int",nextToken:"String"}),v??(v="query"),b??(b=`items { ${E} } nextToken __typename`);case"ONCREATE":case"ONUPDATE":case"ONDELETE":A??(A={filter:`ModelSubscription${h}FilterInput`}),v??(v="subscription"),b??(b=E);break;default:throw new Error("Internal error: Attempted to generate graphql document for observeQuery. Please report this error.")}return`${v}${A?`(${Object.entries(A).map(([e,t])=>`$${e}: ${t}`)})`:""} { ${m}${A?`(${Object.keys(A).map(e=>`${e}: $${e}`)})`:""} { ${b} } }`}function Uu(e,t,n,r,o){const{fields:i,primaryKeyInfo:{isCustomPrimaryKey:s,primaryKeyFieldName:a,sortKeyFieldNames:c}}=e,u=c?.length&&Su(c);let l={};switch(t){case"CREATE":l={input:n?ju(n,e,r):{}};break;case"UPDATE":l={input:n?Object.fromEntries(Object.entries(ju(n,e,r)).filter(([t])=>i[t]?!i[t].isReadOnly:!pu(e).includes(t))):{}};break;case"GET":case"DELETE":n&&(l=s?[a,...c].reduce((e,t)=>(e[t]=n[t],e),{}):{[a]:n[a]}),"DELETE"===t&&(l={input:l});break;case"LIST":n?.filter&&(l.filter=n.filter),n?.sortDirection&&(l.sortDirection=n.sortDirection),n&&n[a]&&(l[a]=n[a]),u&&n&&n[u]&&(l[u]=n[u]),n?.nextToken&&(l.nextToken=n.nextToken),n?.limit&&(l.limit=n.limit);break;case"INDEX_QUERY":{const{pk:e,sk:t=[]}=o,r=t?.length&&Su(t);l[e]=n[e],r&&n&&n[r]&&(l[r]=n[r]),n?.filter&&(l.filter=n.filter),n?.sortDirection&&(l.sortDirection=n.sortDirection),n?.nextToken&&(l.nextToken=n.nextToken),n?.limit&&(l.limit=n.limit);break}case"ONCREATE":case"ONUPDATE":case"ONDELETE":n?.filter&&(l={filter:n.filter});break;case"OBSERVEQUERY":throw new Error("Internal error: Attempted to build variables for observeQuery. Please report this error.");default:throw new Error(`Unhandled operation case: ${t}`)}return l}function ju(e,t,n){const{fields:r}=t,o={};return Object.entries(e).forEach(([e,t])=>{const i=r[e]?.type,s=i?.model;if(s){const i=r[e]?.association,a=n.models[s].primaryKeyInfo;if(i?.connectionType===vu){const e=i;e.targetNames.forEach((n,r)=>{const i=e.associatedWith[r];o[n]=t[i]})}if(i?.connectionType===Au){i.targetNames.forEach((e,n)=>{if(0===n){const n=a.primaryKeyFieldName;o[e]=t[n]}else{const r=a.sortKeyFieldNames[n-1];o[e]=t[r]}})}}else o[e]=t}),o}function Ku(e,t,n={}){const r=t(e);return{authMode:n.authMode||r.authMode,authToken:n.authToken||r.authToken}}function Bu(e,t,n){let r=t(e).headers||{};return n&&(r=n),r}function Fu(e){if(e?.errors)return{...e,data:[]};throw e}function qu(e){if(e.errors)return{...e,data:null};throw e}const Vu=Symbol("INTERNAL_USER_AGENT_OVERRIDE");var Gu;!function(e){e.CreateConversation="1",e.GetConversation="2",e.ListConversations="3",e.DeleteConversation="4",e.SendMessage="5",e.ListMessages="6",e.OnStreamEvent="7",e.Generation="8",e.UpdateConversation="9"}(Gu||(Gu={}));const zu=e=>({category:"ai",action:e});function Wu(e){return e?{[Vu]:e}:void 0}function Qu(e,t,n,r,o,i,s){const a=void 0!==r.arguments;return(...c)=>{const u=c[c.length-1];let l,d;if(o){if(!(e=>"symbol"==typeof e?.token?.value)(c[0]))throw new Error(`Invalid first argument passed to ${r.name}. Expected contextSpec`);l=c[0]}return a&&(d=o?c[1]:c[0]),"subscription"===n?function(e,t,n,r,o,i,s){const a="subscription",{name:c}=n,u=Ku(e,r,i),l=Bu(e,r,i?.headers),d=Hu(n),h=Zu(n),p=Xu(t,n),f=Ju(n.type,"model")?n.type.model:void 0,g=`\n    ${a.toLocaleLowerCase()}${d} {\n      ${c}${h} ${p}\n    }\n  `,y=$u(n,o),m=Wu(s),w=e.graphql({...u,query:g,variables:y,...m},l);return w.pipe(Ln(n=>{const[r]=Object.keys(n.data),o=n.data[r],[i]=f?ku(e,f,[o],t,u.authMode,u.authToken):[o];return i}))}(e,t,r,i,d,u,s):function(e,t,n,r,o,i,s,a,c){return yu(async u=>{const{name:l}=r,d=Ku(e,o,s),h=Bu(e,o,s?.headers),p=Hu(r),f=Zu(r),g=Xu(t,r),y=Ju(r.type,"model")?r.type.model:void 0,m=`\n    ${n.toLocaleLowerCase()}${p} {\n      ${l}${f} ${g}\n    }\n  `,w=$u(r,i),v=Wu(c);try{const n=wu(a?e.graphql(a,{...d,query:m,variables:w},h):e.graphql({...d,query:m,variables:w,...v},h),u),{data:r,extensions:o}=await n;if(r){const[n]=Object.keys(r),i=Array.isArray(r[n]),s=i?r[n].filter(e=>e):r[n],c=y?ku(e,y,i?s:[s],t,d.authMode,d.authToken,!!a):s;return{data:!i&&Array.isArray(c)?c.shift():c,extensions:o}}return{data:null,extensions:o}}catch(b){const{data:n,errors:r}=b;if(n&&0!==Object.keys(n).length&&r){const[o]=Object.keys(n),i=Array.isArray(n[o]),s=i?n[o].filter(e=>e):n[o];if(s){const n=y?ku(e,y,i?s:[s],t,d.authMode,d.authToken,!!a):s;return{data:!i&&Array.isArray(n)?n.shift():n,errors:r}}return qu(b)}return qu(b)}})}(e,t,n,r,i,d,u,l,s)}}function Ju(e,t){return"string"==typeof e[t]}function Yu({type:e,isRequired:t}){const n=t?"!":"";return function(e){return e instanceof Object&&"enum"in e}(e)?`${e.enum}${n}`:function(e){return e instanceof Object&&"input"in e}(e)?`${e.input}${n}`:`${e}${n}`}function Hu(e){if(void 0===e.arguments)return"";const t=Object.entries(e.arguments).map(([e,t])=>{const n=Yu(t);return`$${e}: ${t.isArray?`[${n}]${t.isArrayNullable?"":"!"}`:n}`}).join(", ");return t.length>0?`(${t})`:""}function Zu(e){if(void 0===e.arguments)return"";const t=Object.keys(e.arguments).map(e=>`${e}: $${e}`).join(", ");return t.length>0?`(${t})`:""}function Xu(e,t){if(Ju(t,"type")||Ju(t.type,"enum"))return"";if(Ju(t.type,"nonModel")){const n=e.nonModels[t.type.nonModel];return`{${Ru(Ou(n,e))}}`}return Ju(t.type,"model")?`{${Pu(e,t.type.model)}}`:""}function $u(e,t={}){const n={};if(void 0===e.arguments)return n;for(const r of Object.values(e.arguments))if(void 0!==t[r.name])n[r.name]=t[r.name];else if(r.isRequired)throw new Error(`${e.name} requires arguments '${r.name}'`);return n}const el={queries:"query",mutations:"mutation",subscriptions:"subscription"};function tl(e,t,n,r){if(!t)return{};const o=t.modelIntrospection;if(!o)return{};const i=o[n];if(!i)return{};const s={},a=null===r(e).amplify;for(const c of Object.values(i))s[c.name]=Qu(e,o,el[n],c,a,r);return s}function nl(e,t,n,r,o,i=!1,s){return i?(i,a,c)=>rl(e,t,n,a,c,r,o,i,s):(i,a)=>rl(e,t,n,i,a,r,o,void 0,s)}function rl(e,t,n,r,o,i,s,a,c){return yu(async u=>{const{name:l}=n,d=Lu(t,n,i,o),h=Uu(n,i,r,t),p=Ku(e,s,o),f=Bu(e,s,o?.headers),g=Wu(c);try{const n=wu(a?e.graphql(a,{...p,query:d,variables:h},f):e.graphql({...p,query:d,variables:h,...g},f),u),{data:r,extensions:i}=await n;if(r){const[n]=Object.keys(r),s=Iu(t,l,r[n]);if(null===s)return{data:null,extensions:i};if(o?.selectionSet)return{data:s,extensions:i};{const[n]=ku(e,l,[s],t,p.authMode,p.authToken,!!a);return{data:n,extensions:i}}}return{data:null,extensions:i}}catch(y){const{data:n,errors:r}=y;if(n&&0!==Object.keys(n).length&&r){const[i]=Object.keys(n),s=Iu(t,l,n[i]);if(s){if(o?.selectionSet)return{data:s,errors:r};{const[n]=ku(e,l,[s],t,p.authMode,p.authToken,!!a);return{data:n,errors:r}}}return qu(y)}return qu(y)}})}function ol(e,t,n,r,o=!1,i){return o?(o,s)=>il(e,t,n,r,s,o,i):o=>il(e,t,n,r,o,void 0,i)}function il(e,t,n,r,o,i,s){return yu(async a=>{const{name:c}=n,u=Lu(t,n,"LIST",o),l=Uu(n,"LIST",o,t),d=Ku(e,r,o),h=Bu(e,r,o?.headers),p=Wu(s);try{const n=wu(i?e.graphql(i,{...d,query:u,variables:l},h):e.graphql({...d,query:u,variables:l,...p},h),a),{data:r,extensions:s}=await n;if(void 0!==r){const[n]=Object.keys(r);if(r[n].items){const a=r[n].items.map(e=>Iu(t,c,e));if(o?.selectionSet)return{data:a,nextToken:r[n].nextToken,extensions:s};return{data:ku(e,c,a,t,d.authMode,d.authToken,!!i),nextToken:r[n].nextToken,extensions:s}}return{data:r[n],nextToken:r[n].nextToken,extensions:s}}}catch(f){const{data:n,errors:r}=f;if(null!=n&&0!==Object.keys(n).length&&r){const[s]=Object.keys(n);if(n[s]?.items){const a=n[s].items.map(e=>Iu(t,c,e));if(a){if(o?.selectionSet)return{data:a,nextToken:n[s]?.nextToken,errors:r};return{data:ku(e,c,a,t,d.authMode,d.authToken,!!i),nextToken:n[s]?.nextToken,errors:r}}return{data:n[s],nextToken:n[s]?.nextToken,errors:r}}return Fu(f)}return Fu(f)}})}const sl={},al=new Array(64);for(let Od=0,xd="A".charCodeAt(0),Dd="Z".charCodeAt(0);Od+xd<=Dd;Od++){const e=String.fromCharCode(Od+xd);sl[e]=Od,al[Od]=e}for(let Od=0,xd="a".charCodeAt(0),Dd="z".charCodeAt(0);Od+xd<=Dd;Od++){const e=String.fromCharCode(Od+xd),t=Od+26;sl[e]=t,al[t]=e}for(let Od=0;Od<10;Od++){sl[Od.toString(10)]=Od+52;const e=Od.toString(10),t=Od+52;sl[e]=t,al[t]=e}sl["+"]=62,al[62]="+",sl["/"]=63,al[63]="/";const cl=e=>{let t=e.length/4*3;"=="===e.slice(-2)?t-=2:"="===e.slice(-1)&&t--;const n=new ArrayBuffer(t),r=new DataView(n);for(let o=0;o<e.length;o+=4){let t=0,n=0;for(let r=o,a=o+3;r<=a;r++)if("="!==e[r]){if(!(e[r]in sl))throw new TypeError(`Invalid character ${e[r]} in base64 string.`);t|=sl[e[r]]<<6*(a-r),n+=6}else t>>=6;const i=o/4*3;t>>=n%8;const s=Math.floor(n/8);for(let e=0;e<s;e++){const n=8*(s-e-1);r.setUint8(i+e,(t&255<<n)>>n)}}return new Uint8Array(n)};function ul(e){let t;t="string"==typeof e?(e=>(new TextEncoder).encode(e))(e):e;const n="object"==typeof t&&"number"==typeof t.length,r="object"==typeof t&&"number"==typeof t.byteOffset&&"number"==typeof t.byteLength;if(!n&&!r)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let o="";for(let i=0;i<t.length;i+=3){let e=0,n=0;for(let o=i,s=Math.min(i+3,t.length);o<s;o++)e|=t[o]<<8*(s-o-1),n+=8;const r=Math.ceil(n/6);e<<=6*r-n;for(let t=1;t<=r;t++){const n=6*(r-t);o+=al[(e&63<<n)>>n]}o+="==".slice(0,4-r)}return o}const ll=e=>e.map(e=>e.image?dl(e):e.document?hl(e):e.toolUse?pl(e):e.toolResult?fl(e):gl(e)),dl=({image:e})=>({image:{...e,source:{...e.source,bytes:cl(e.source.bytes)}}}),hl=({document:e})=>({document:{...e,source:{...e.source,bytes:cl(e.source.bytes)}}}),pl=({toolUse:e})=>({toolUse:{...e,input:JSON.parse(e.input)}}),fl=({toolResult:e})=>({toolResult:{toolUseId:e.toolUseId,content:e.content.map(e=>e.image?dl(e):e.json?(({json:e})=>({json:JSON.parse(e)}))(e):gl(e))}}),gl=e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>null!==t)),yl=({content:e,createdAt:t,id:n,conversationId:r,role:o})=>({content:ll(e??[]),conversationId:r,createdAt:t,id:n,role:o}),ml=(e,t,n,r,o)=>async i=>{const s=ol(e,t,r,o,!1,zu(Gu.ListMessages)),{data:a,nextToken:c,errors:u}=await s({...i,filter:{conversationId:{eq:n}}});return{data:a.map(e=>yl(e)),nextToken:c,errors:u}},wl=e=>{if(e){return{...e,input:JSON.parse(e.input)}}},vl=e=>Object.fromEntries(Object.entries(e).filter(([e,t])=>null!==t)),bl=(e,t,n,r,o)=>i=>{const{conversations:s}=t;if(!s)return{};const a=s[r].message.subscribe;return Qu(e,t,"subscription",a,!1,o,zu(Gu.OnStreamEvent))({conversationId:n}).subscribe(e=>{const{next:t,error:n}=(({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:r,contentBlockDoneAtIndex:o,contentBlockDeltaIndex:i,contentBlockText:s,contentBlockToolUse:a,stopReason:c,errors:u})=>{if(u)return{error:{id:e,conversationId:t,associatedUserMessageId:n,errors:u}};return{next:vl({id:e,conversationId:t,associatedUserMessageId:n,contentBlockIndex:r,contentBlockDoneAtIndex:o,contentBlockDeltaIndex:i,text:s,toolUse:wl(a),stopReason:c})}})(e);n&&i.error(n),t&&i.next(t)})},Al=e=>JSON.stringify(e),El=e=>e.map(e=>e.image?Il(e):e.document?Tl(e):e.toolResult?Cl(e):e),Sl=({tools:e})=>({tools:Object.entries(e).map(([e,t])=>({toolSpec:{name:e,description:t.description,inputSchema:{json:JSON.stringify(t.inputSchema.json)}}}))}),Il=({image:e})=>({image:{...e,source:{...e.source,bytes:ul(e.source.bytes)}}}),Tl=({document:e})=>({document:{...e,source:{...e.source,bytes:ul(e.source.bytes)}}}),Cl=({toolResult:e})=>({toolResult:{...e,content:e.content.map(e=>e.image?Il(e):e.json?(({json:e})=>({json:JSON.stringify(e)}))(e):e)}}),kl=(e,t,n,r,o)=>async i=>{const{conversations:s}=t;if(!s)return{};const a="string"==typeof i?{content:[{text:i}]}:i,{content:c,aiContext:u,toolConfiguration:l}=a,d=s[r].message.send,h=Qu(e,t,"mutation",d,!1,o,zu(Gu.SendMessage)),{data:p,errors:f}=await h({conversationId:n,content:El(c),...u&&{aiContext:Al(u)},...l&&{toolConfiguration:Sl(l)}});return{data:p?yl(p):p,errors:f}},Nl=(e,t,n,r,o,i,s,a,c,u)=>{if(!n)throw new Error(`An error occurred converting a ${i} conversation: Missing ID`);return{id:n,createdAt:r,updatedAt:o,metadata:c,name:u,onStreamEvent:bl(e,t,n,i,a),sendMessage:kl(e,t,n,i,a),listMessages:ml(e,t,n,s,a)}},Ol=(e,t,n,r,o,i)=>async s=>{const{name:a,metadata:c}=s??{},u=JSON.stringify(c),l=nl(e,t,r,"CREATE",i,!1,zu(Gu.CreateConversation)),{data:d,errors:h}=await l({name:a,metadata:u});return{data:Nl(e,t,d?.id,d?.createdAt,d?.updatedAt,n,o,i,d?.metadata,d?.name),errors:h}},xl=(e,t,n,r,o,i)=>async({id:s})=>{const a=nl(e,t,r,"GET",i,!1,zu(Gu.GetConversation)),{data:c,errors:u}=await a({id:s});return{data:c?Nl(e,t,c.id,c.createdAt,c.updatedAt,n,o,i,c?.metadata,c?.name):c,errors:u}},Dl=(e,t,n,r,o,i)=>async s=>{const a=ol(e,t,r,i,!1,zu(Gu.ListConversations)),{data:c,nextToken:u,errors:l}=await a(s);return{data:c.map(r=>Nl(e,t,r.id,r.createdAt,r.updatedAt,n,o,i,r?.metadata,r?.name)),nextToken:u,errors:l}},_l=(e,t,n,r,o,i)=>async({id:s})=>{const a=nl(e,t,r,"DELETE",i,!1,zu(Gu.DeleteConversation)),{data:c,errors:u}=await a({id:s});return{data:c?Nl(e,t,c?.id,c?.createdAt,c?.updatedAt,n,o,i,c?.metadata,c?.name):c,errors:u}},Rl=(e,t,n,r,o,i)=>async({id:s,metadata:a,name:c})=>{const u=JSON.stringify(a),l=nl(e,t,r,"UPDATE",i,!1,zu(Gu.UpdateConversation)),{data:d,errors:h}=await l({id:s,metadata:u,name:c});return{data:d?Nl(e,t,d?.id,d?.createdAt,d?.updatedAt,n,o,i,d?.metadata,d?.name):d,errors:h}};function Ml(e,t,n,r,o,i=!1){return i?(i,s,a)=>Pl(e,t,n,r,o,{...s,...a},i):(i,s)=>Pl(e,t,n,r,o,{...i,...s})}function Pl(e,t,n,r,o,i,s){return yu(async a=>{const{name:c}=n,u=Lu(t,n,"INDEX_QUERY",i,r),l=Uu(n,"INDEX_QUERY",i,t,r),d=Ku(e,o,i),h=n=>ku(e,c,n,t,d.authMode,d.authToken,!!s);try{const n=Bu(e,o,i?.headers),r=[{...d,query:u,variables:l},n];void 0!==s&&r.unshift(s);const p=wu(e.graphql(...r),a),f=await p;if(void 0!==f.data)return function(e,t,n,r,o){const{data:i,extensions:s}=n,[a]=Object.keys(i);if(i[a].items){const n=i[a].items.map(n=>Iu(e,t,n));return{data:r?n:o(n),nextToken:i[a].nextToken,extensions:s}}return{data:i[a],nextToken:i[a].nextToken,extensions:s}}(t,c,f,i?.selectionSet,h)}catch(p){const{data:e,errors:n}=p;if(null!=e&&0!==Object.keys(e).length&&n){const[n]=Object.keys(e);if(e[n]?.items){const r=e[n]?.items.map(e=>Iu(t,c,e));if(r)return{data:i?.selectionSet?r:h(r),nextToken:e[n]?.nextToken}}return{data:e[n],nextToken:e[n]?.nextToken}}return Fu(p)}})}function Ll(e,t,n,r,o){const{name:i}=n;return s=>{const a=Lu(t,n,r,s),c=Uu(n,r,s,t),u=Ku(e,o,s),l=Bu(e,o,s?.headers);return e.graphql({...u,query:a,variables:c},l).pipe(Ln(n=>{const[r]=Object.keys(n.data),o=n.data[r],a=Iu(t,i,o);if(null===a)return null;if(s?.selectionSet)return a;{const[n]=ku(e,i,[a],t,u.authMode,u.authToken);return n}}))}}function Ul(e,t,n){const r=Object.fromEntries(n.map(t=>[t,e[t]]));for(let o=0;o<t.length;o++)if(Object.keys(r).every(e=>r[e]===t[o][e]))return o;return-1}function jl(e,t){const{name:n}=t;return r=>new gn(o=>{const i=[],s=[];let a=(...e)=>s.push(...e);const c=e[n].onCreate(r).subscribe({next(e){a({item:e,type:"create"})},error(e){o.error({type:"onCreate",error:e})}}),u=e[n].onUpdate(r).subscribe({next(e){a({item:e,type:"update"})},error(e){o.error({type:"onUpdate",error:e})}}),l=e[n].onDelete(r).subscribe({next(e){a({item:e,type:"delete"})},error(e){o.error({type:"onDelete",error:e})}});function d(e){for(const t of e){const e=Ul(t.item,i,h);switch(t.type){case"create":e<0&&i.push(t.item);break;case"update":e>=0&&(i[e]=t.item);break;case"delete":e>=0&&i.splice(e,1);break;default:console.error("Unrecognized message in observeQuery.",t)}}o.next({items:i,isSynced:!0})}const h=function(e){const{primaryKeyFieldName:t,sortKeyFieldNames:n}=e.primaryKeyInfo;return[t,...n]}(t);return(async()=>{let t=!0,c=null;for(;!o.closed&&(t||c);){t=!1;const{data:a,errors:u,nextToken:l}=await e[n].list({...r,nextToken:c});c=l,i.push(...a);const d=0===s.length&&null==c;if(o.next({items:i,isSynced:d}),Array.isArray(u))for(const e of u)o.error(e)}s.length>0&&d(s),a=(...e)=>(d(e),i.length)})(),()=>{c.unsubscribe(),u.unsubscribe(),l.unsubscribe()}})}const Kl=e=>"key"===e.type&&e.properties?.name&&e.properties?.queryField&&e.properties?.fields.length>0,Bl=e=>{const t=e.attributes?.filter(Kl).map(e=>{const t=e.properties.queryField,[n,...r]=e.properties.fields;return{queryField:t,pk:n,sk:r}});return t||[]},Fl=(e,t)=>{const n=e.models[t].attributes?.find(e=>"model"===e.type),r={queries:["list","get","observeQuery"],mutations:["create","update","delete"],subscriptions:["onCreate","onUpdate","onDelete"]},o=[];if(!n)return Nu;if(n.properties)for(const[s,a]of Object.entries(n.properties))s in r&&(null===a?o.push(...r[s]):a instanceof Object&&o.push(...Object.keys(a)));o.includes("list")&&o.push("observeQuery");const i=o.map(e=>e.toUpperCase());return Object.fromEntries(Object.entries(Nu).filter(([e])=>!i.includes(e)))};function ql(e,t,n){return function(e){const t=e.cancel.bind(e);e.cancel=function(e,n){const r=new Set;let o=e;for(;o&&mu.has(o);){if(r.has(o))throw new Error("A cycle was detected in the modeled graphql cancellation chain. This is a bug. Please report it!");r.add(o),o=mu.get(o)}return t(o,n)}}(e),e.models=function(e,t,n){const r={},o=t.modelIntrospection;if(!o)return{};const i=["ONCREATE","ONUPDATE","ONDELETE"];for(const s of Object.values(o.models)){const{name:t}=s;r[t]={};const a=Fl(o,t);Object.entries(a).forEach(([a,{operationPrefix:c}])=>{const u=a;"LIST"===u?r[t][c]=ol(e,o,s,n):i.includes(u)?r[t][c]=Ll(e,o,s,u,n):r[t][c]="OBSERVEQUERY"===u?jl(r,s):nl(e,o,s,u,n)});const c=Bl(s);for(const i of c)r[t][i.queryField]=Ml(e,o,s,i,n)}return r}(e,t,n),e.enums=(e=>{const t=e.modelIntrospection;if(!t)return{};const n={};for(const[r,o]of Object.entries(t.enums))n[o.name]={values:()=>o.values};return n})(t),e.queries=function(e,t,n){return tl(e,t,"queries",n)}(e,t,n),e.mutations=function(e,t,n){return tl(e,t,"mutations",n)}(e,t,n),e.subscriptions=function(e,t,n){return tl(e,t,"subscriptions",n)}(e,t,n),e.conversations=function(e,t,n){const r=t?.modelIntrospection;if(!r?.conversations)return{};const o={};for(const{name:i,conversation:s,message:a,models:c,nonModels:u,enums:l}of Object.values(r.conversations)){const t=c[s.modelName],d=c[a.modelName];if(!t||!d)return{};const h={...r,models:{...r.models,...c},nonModels:{...r.nonModels,...u},enums:{...r.enums,...l}};o[i]={update:Rl(e,h,i,t,d,n),create:Ol(e,h,i,t,d,n),get:xl(e,h,i,t,d,n),delete:_l(e,h,i,t,d,n),list:Dl(e,h,i,t,d,n)}}return o}(e,t,n),e.generations=function(e,t,n){const r=t?.modelIntrospection;if(!r?.generations)return{};const o={};for(const i of Object.values(r.generations))o[i.name]=Qu(e,r,"query",i,!1,n,zu(Gu.Generation));return o}(e,t,n),e}const Vl=new class extends hu{getModuleName(){return"GraphQLAPI"}graphql(e,t,n){const r={category:ut.API,action:gt.GraphQl};if(function(e){return Vu in e}(t)){const{[Vu]:o,...i}=t;return super.graphql(e,i,n,{...r,...o})}return super.graphql(e,t,n,{...r})}isCancelError(e){return super.isCancelError(e)}cancel(e,t){return super.cancel(e,t)}};function Gl(e,t){const n=ru(this),r=n.endpoint,o=n.authMode,i=n.apiKey;if(e.authMode=e.authMode||o,e.apiKey=e.apiKey??i,e.authToken=e.authToken||n.authToken,r&&"apiKey"===e.authMode&&!e.apiKey)throw new Error("graphql() requires an explicit `apiKey` for a custom `endpoint` when `authMode = 'apiKey'`.");const s=t||n.headers;return Vl.graphql(n.amplify,{...e,endpoint:r},s)}function zl(e,t){return Vl.cancel(e,t)}function Wl(e){return Vl.isCancelError(e)}function Ql(e){return void 0!==e}const Jl=e=>{Me.listen("core",t=>{if("configure"!==t.payload.event)return;const n=t.payload.data.API?.GraphQL;Ql(n)&&ql(e,n,ru)})},Yl=new Proxy({},{get(){throw new Error("Client could not be generated. This is likely due to `Amplify.configure()` not being called prior to `generateClient()` or because the configuration passed to `Amplify.configure()` is missing GraphQL provider configuration.")}});function Hl(e){return function(e){const t={[Zc]:e.amplify,[Xc]:e.authMode,[$c]:e.authToken,[eu]:"apiKey"in e?e.apiKey:void 0,[nu]:"endpoint"in e?e.endpoint:void 0,[tu]:e.headers,graphql:Gl,cancel:zl,isCancelError:Wl,models:Yl,enums:Yl,queries:Yl,mutations:Yl,subscriptions:Yl},n=e.amplify.getConfig().API?.GraphQL;if(t[nu]){if(!t[Xc])throw new Error("generateClient() requires an explicit `authMode` when `endpoint` is provided.");if("apiKey"===t[Xc]&&!t[eu])throw new Error("generateClient() requires an explicit `apiKey` when `endpoint` is provided and `authMode = 'apiKey'`.")}return t[nu]||(Ql(n)?ql(t,n,ru):Jl(t)),t}({amplify:qn})}const Zl=(e,t)=>e?"identityPool"===e?"iam":e:t,Xl=e=>{if(Array.isArray(e))return e.map((e,t)=>{const n=JSON.stringify(e);if(void 0===n)throw new Error(`Event must be a valid JSON value. Received ${e} at index ${t}`);return n});const t=JSON.stringify(e);if(void 0===t)throw new Error(`Event must be a valid JSON value. Received ${e}`);return[t]},$l="AWSAppSyncEventsProvider";const ed=new class extends jc{constructor(){super({providerName:$l,wsProtocolName:"aws-appsync-event-ws",connectUri:""}),this.allowNoSubscriptions=!0}getProviderName(){return $l}async connect(e){return super.connect(e)}subscribe(e,t){return super.subscribe(e,t).pipe()}async publish(e,t){return super.publish(e,t)}closeIfNoActiveSubscription(){this._closeSocketIfRequired()}async _prepareSubscriptionPayload({options:e,subscriptionId:t,customUserAgentDetails:n,additionalCustomHeaders:r,libraryConfigHeaders:o,publish:i}){const{appSyncGraphqlEndpoint:s,authenticationType:a,query:c,apiKey:u,region:l,variables:d}=e,h={channel:c,events:void 0!==d?Xl(d):void 0},p=JSON.stringify(h),f={...await Lc({apiKey:u,appSyncGraphqlEndpoint:s,authenticationType:a,payload:p,canonicalUri:"",region:l,additionalCustomHeaders:r}),...o,...r,[Ie]:Yt(n)},g={id:t,channel:c,events:void 0!==d?Xl(d):void 0,authorization:{...f},payload:{events:void 0!==d?Xl(d):void 0,channel:c,extensions:{authorization:{...f}}},type:i?ac.EVENT_PUBLISH:ac.EVENT_SUBSCRIBE};return JSON.stringify(g)}_handleSubscriptionData(e){this.logger.debug(`subscription message from AWS AppSync Events: ${e.data}`);const{id:t="",event:n,type:r}=JSON.parse(String(e.data)),{observer:o=null,query:i="",variables:s={}}=this.subscriptionObserverMap.get(t)||{};if(this.logger.debug({id:t,observer:o,query:i,variables:s}),r===ac.DATA&&n){const e=JSON.parse(n);return o?o.next({id:t,type:r,event:e}):this.logger.debug(`observer not found for id: ${t}`),[!0,{id:t,type:r,payload:e}]}return[!1,{id:t,type:r,payload:n}]}_unsubscribeMessage(e){return{id:e,type:ac.EVENT_STOP}}_extractConnectionTimeout(e){const{connectionTimeoutMs:t=fc}=e;return t}_extractErrorCodeAndType(e){const{errors:[{errorType:t="",errorCode:n=0}={}]=[]}=e;return{errorCode:n,errorType:t}}},td=new Set;async function nd(e,t){const n=(()=>{const e=qn.getConfig(),t=e.API?.Events;if(!t)throw new Error("Amplify configuration is missing. Have you called Amplify.configure()?");const n=Zl(t.defaultAuthMode,"apiKey");return{appSyncGraphqlEndpoint:t.endpoint,region:t.region,authenticationType:n,apiKey:t.apiKey}})();n.authenticationType=Zl(t?.authMode,n.authenticationType),n.apiKey=t?.apiKey||n.apiKey,n.authToken=t?.authToken||n.authToken,await ed.connect(n);const r=sr();let o;td.add(r);return{subscribe:(t,i)=>{if(!td.has(r))throw new Error("Channel is closed");const s={...n,query:e};return s.authenticationType=Zl(i?.authMode,s.authenticationType),s.apiKey=i?.apiKey||s.apiKey,s.authToken=i?.authToken||s.authToken,o=ed.subscribe(s).subscribe(t),o},close:async()=>{o&&o.unsubscribe(),td.delete(r),setTimeout(()=>{0===td.size&&ed.closeIfNoActiveSubscription()},1e3)},publish:async(t,o)=>{if(!td.has(r))throw new Error("Channel is closed");const i={...n,query:e,variables:t};return i.authenticationType=Zl(o?.authMode,i.authenticationType),i.apiKey=o?.apiKey||i.apiKey,i.authToken=o?.authToken||i.authToken,ed.publish(i)}}}
/**
 * @wharfkit/wallet-plugin-cloudwallet v1.5.0
 * https://github.com/wharfkit/wallet-plugin-cloudwallet
 *
 * @license
 * Copyright (c) 2023 Greymass Inc. All Rights Reserved.
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * 1.  Redistribution of source code must retain the above copyright notice, this
 *     list of conditions and the following disclaimer.
 * 
 * 2.  Redistribution in binary form must reproduce the above copyright notice,
 *     this list of conditions and the following disclaimer in the documentation
 *     and/or other materials provided with the distribution.
 * 
 * 3.  Neither the name of the copyright holder nor the names of its contributors
 *     may be used to endorse or promote products derived from this software without
 *     specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
 * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE
 * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.
 */
function rd(e,t,n,r){var o,i=arguments.length,s=i<3?t:r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s}"function"==typeof SuppressedError&&SuppressedError;let od=class extends s{};rd([s.field(O)],od.prototype,"payer",void 0),rd([s.field(O)],od.prototype,"receiver",void 0),rd([s.field(D)],od.prototype,"bytes",void 0),od=rd([s.type("buyrambytes")],od);let id=class extends s{};function sd(e,t){if(!e.actions.every(e=>t.actions.some(t=>e.equals(t))))throw new Error("The modified transaction does not contain all the original actions.");const n=t.actions.filter(t=>!e.actions.some(e=>t.equals(e)));for(const r of n){if(r.authorization.find(t=>t.actor===e.actions[0].authorization[0].actor)){if(r.account.equals("eosio.token")&&r.name.equals("transfer")){const e=id.from(r.data);if(e.to.equals("txfee.wam")&&e.memo.startsWith("WAX fee for"))continue}if(r.account.equals("eosio")&&r.name.equals("buyrambytes")){if(od.from(r.data).receiver.equals(e.actions[0].authorization[0].actor))continue}throw new Error("The modified transaction contains one or more actions that are not allowed.")}}}function ad(e,t,n){const r=setInterval(()=>{t.closed&&(clearInterval(r),n(e("error.closed",{default:"The Cloud Wallet was closed before the request was completed"})))},500);return r}function cd(e,t,n){const r=new URL(e.origin).origin===t.origin,o=e.source===n;return!("object"!=typeof e.data||!r||!o)}function ud(e,t){const n=navigator.userAgent.toLowerCase();if(-1===n.search("chrome")&&n.search("safari")>=0)return!1;try{if(!t)return!1;const n=t.whitelist,{actions:r}=e.resolvedTransaction;return r.every(e=>n.find(t=>{if(e.account.equals(t.contract))return!(e.account.equals("eosio.token")&&e.name&&e.name.equals("transfer"))||t.recipients.includes(String(e.data.to))}))}catch(r){}return!1}async function ld(e,t,n,r=3e5){const o=new URL(t),i=await window.open(o,"WalletPluginCloudWalletPopup","height=800,width=600");if(!i)throw new Error(e("error.popup",{default:"Unable to open the popup window. Check your browser settings and try again."}));return new Promise((s,a)=>{const c=ad(e,i,a),u=e=>{if(!cd(e,o,i))return;i?.postMessage({feeFallback:!0,freeBandwidth:!0,startTime:Math.floor((new Date).getTime()),transaction:n.serializedTransaction,type:"TRANSACTION"},String(t));const r=e=>{if(cd(e,o,i))try{s(e.data)}catch(t){a(t)}finally{window.removeEventListener("message",u),window.removeEventListener("message",r),clearTimeout(l),clearInterval(c)}};window.addEventListener("message",r)},l=setTimeout(()=>{i.close(),window.removeEventListener("message",u),a(new Error(e("error.timeout",{default:"The request has timed out after {{timeout}} seconds. Please try again.",timeout:r/1e3})))},r);window.addEventListener("message",u)})}rd([s.field(O)],id.prototype,"from",void 0),rd([s.field(O)],id.prototype,"to",void 0),rd([s.field(_)],id.prototype,"quantity",void 0),rd([s.field("string")],id.prototype,"memo",void 0),id=rd([s.type("transfer")],id);var dd={en:{connecting:"Connecting to Cloud Wallet",error:{closed:"The Cloud Wallet was closed before the request was completed",endpoint:"Login Endpoint Error {{status}} - {{statusText}}",exception:"Signing exception occurred: {{exception}}",popup:"Unable to open the popup window. Check your browser settings and try again.",response:"The Cloud Wallet failed to respond.",timeout:"The request has timed out after {{timeout}} seconds. Please try again."},login:{popup:"Login with the Cloud Wallet popup window"},transact:{popup:"Sign with the Cloud Wallet popup window"}},ko:{connecting:"클라우드 지갑에 연결",error:{closed:"요청이 완료되기 전에 클라우드 지갑이 닫혔습니다.",endpoint:"로그인 엔드포인트 오류 {{status}} - {{statusText}}",exception:"서명 예외가 발생했습니다: {{exception}}",popup:"팝업 창을 열 수 없습니다. 브라우저 설정을 확인하고 다시 시도하십시오.",response:"클라우드 지갑이 응답하지 못했습니다.",timeout:"{{timeout}}초 후에 요청 시간이 초과되었습니다. 다시 시도하십시오."},login:{popup:"클라우드 지갑 팝업 창으로 로그인"},transact:{popup:"클라우드 지갑 팝업 창으로 서명"}},"zh-Hans":{connecting:"正在连接到云钱包",error:{closed:"云钱包在请求完成之前已关闭",endpoint:"登录端点错误 {{status}} - {{statusText}}",exception:"发生签名异常：{{exception}}",popup:"无法打开弹出窗口。请检查您的浏览器设置，然后重试。",response:"云钱包响应失败。",timeout:"请求在 {{timeout}} 秒后超时。请重试。"},login:{popup:"使用云钱包弹出窗口登录"},transact:{popup:"使用云钱包弹出窗口签名"}},"zh-Hant":{connecting:"正在連接到雲錢包",error:{closed:"雲錢包在請求完成之前已關閉",endpoint:"登錄端點錯誤 {{status}} - {{statusText}}",exception:"發生簽名異常：{{exception}}",popup:"無法打開彈出窗口。 請檢查您的瀏覽器設置，然後重試。",response:"雲錢包響應失敗",timeout:"請求在 {{timeout}} 秒後超時。請重試。"},login:{popup:"使用雲錢包彈出窗口登錄"},transact:{popup:"使用雲錢包彈出窗口簽名"}}};function hd(){if(!pd()||!yd()){if(/CriOS/.test(navigator.userAgent))return"googlechrome://";if(/FxiOS/.test(navigator.userAgent))return"firefox:://";if(pd()&&fd())return"brave://";if(pd()){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let t=window.location.href.split("#")[0]+"#";for(let n=0;n<8;n++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}return gd()&&/Firefox/i.test(navigator.userAgent)?"android-app://org.mozilla.firefox":gd()&&/Edg/.test(navigator.userAgent)?"android-app://com.microsoft.emmx":gd()&&(/OPR/.test(navigator.userAgent)||/Opera/.test(navigator.userAgent))?"android-app://com.opera.browser":gd()&&fd()?"android-app://com.brave.browser":gd()&&(/wv/.test(navigator.userAgent)||/Android/.test(navigator.userAgent)&&yd())?"android-app://webview":gd()&&/Chrome\/[.0-9]* Mobile/i.test(navigator.userAgent)?"android-app://com.android.chrome":window.location.href}}function pd(){return/iP(ad|od|hone)/i.test(navigator.userAgent)}function fd(){return navigator.brave&&"function"==typeof navigator.brave.isBrave}function gd(){return/Android/.test(navigator.userAgent)}function yd(){return!!window.ReactNativeWebView}class md{static generateTransactionMessage(e,t,n){return{id:Se(),type:"requesting",actions:e,namedParams:t,dapp:n}}static isValidTransactionMessage(e){return e&&"object"==typeof e&&"string"==typeof e.id&&"string"==typeof e.type&&["requesting","approved","rejected","error","ready","not-ready"].includes(e.type)}static isMatchingTransaction(e,t){return e.id===t}static processTransactionResult(e){return e?.signatures?e.signatures.map(e=>{try{return/^[A-Za-z0-9+/=]+$/.test(e)?atob(e):e}catch(t){return console.warn("Failed to decode signature:",t),e}}):[]}}class wd{constructor(e){Cs.configure({API:{GraphQL:{endpoint:e.graphQLRelayEndpoint,region:e.graphQLRelayRegion,defaultAuthMode:"lambda"},Events:{endpoint:e.eventRelayEndpoint,region:e.eventRelayRegion,defaultAuthMode:"lambda"}}})}}class vd{constructor(){this.client=Hl()}async publishToChannel(e,t,n){await this.client.graphql({query:"\n    mutation Publish2channel($data: AWSJSON!, $name: String!) {\n        publish2channel(data: $data, name: $name) {\n            data\n            name\n            __typename\n        }\n    }\n",variables:{name:e,data:JSON.stringify(t)},authToken:n})}async subscribeToChannel(e,t,n,r,o=18e4){try{const r=(await nd(e)).subscribe({next:e=>{this.handleMessage(e,t,n)},error:e=>{n(e)}}),i=setTimeout(()=>{r.unsubscribe(),n(new Error("Subscription timeout after "+o+"ms"))},o);return{unsubscribe:()=>{clearTimeout(i),r.unsubscribe()}}}catch(i){return n(i),{unsubscribe:()=>{}}}}}class bd extends vd{static parseAuthHeaders(e,t,n){if("string"==typeof t)try{t.startsWith("{")&&(t=JSON.parse(t))}catch(r){console.warn("Failed to parse token:",r)}return JSON.stringify({account:e,token:t,svc:n,mode:"dapp"})}handleMessage(e,t,n){md.isValidTransactionMessage(e)?t(e):n(new Error("Invalid transaction message received"))}generateChannelName(e,t){return`transact:${e}:${t||""}`}generateTransactionMessage(e,t,n){return md.generateTransactionMessage(e,t,n)}processTransactionResult(e){if("approved"!==e.type)throw new Error("Transaction not approved");return{signatures:md.processTransactionResult(e.result)}}}class Ad extends Error{constructor(e=""){super(e),this.name="ActivationFetchError"}}class Ed extends Error{constructor(e=""){super(e),this.name="ActivationExpiredError"}}class Sd extends Error{constructor(e=""){super(e),this.name="ActivationCancelledError"}}class Id extends Error{constructor(e=""){super(e),this.name="ActivationDeepLinkError"}}class Td extends Error{constructor(e=""){super(e),this.name="InvalidCodeError"}}class Cd{constructor(e){if(this.mobileAppConnectConfig=e,this.isCanceled=!1,this.connectedType=null,this.WAX_SCHEME_DEEPLINK="mycloudwallet",this.activationEndpoint="https://login-api.mycloudwallet.com",!e||!e.dappInfo)throw new Error("MobileAppConnect is required");this.mobileAppConnectConfig=e,this.dAppInfo=e.dappInfo,this.origin=location.origin,new wd({graphQLRelayEndpoint:"https://queue-relay.mycloudwallet.com/graphql",graphQLRelayRegion:"us-east-2",eventRelayEndpoint:"https://direct-connect-api.mycloudwallet.com/event",eventRelayRegion:"eu-east-2"}),this.transactionSyncHandler=new bd,this.uuid=Se();const t=localStorage.getItem("connectedType");"direct"!==t&&"remote"!==t&&"web"!==t||(this.connectedType=t)}getConnectedType(){return this.connectedType}async showAppConnectPrompt(e){const t=[];let n,r,o,i;const s=new Promise((e,t)=>{r=e,o=t});this.mobileAppConnectConfig.remote&&(n=await this.fetchActivationInfo(this.getActivationPayload(e)),t.unshift({type:"qr",data:n.qrCodeContent})),this.mobileAppConnectConfig.direct&&t.unshift({type:"button",data:{label:"Open in My Cloud Wallet",variant:"primary",onClick:async()=>{try{const t=await this.directConnect(e);r(t)}catch(t){o(t)}}}});const a=e.ui.prompt({title:"Connect with My Cloud Wallet!!!",body:"Connect My Cloud Wallet on your mobile device",elements:t});a.catch(e=>{console.info("User cancelled modal::",e.message),o(e),this.isCanceled=!0}),n&&(i=this.checkActivation(e,n));try{return i?await Promise.race([s,i]):await s}catch(c){throw console.log("showAppConnectPrompt::directConnectPromise::error",c),c instanceof Sd&&(console.log("currentPromptResponse",typeof a),this.isCanceled=!0,this.connectedType=null),c}}remoteTransact(e,t,n){if(!this.user?.account||!this.user?.token)throw new Error("User not authenticated");const r=this.transactionSyncHandler.generateChannelName(this.origin,this.user.account),o=this.transactionSyncHandler.generateTransactionMessage(e.request.getRawActions(),n,this.origin),i=bd.parseAuthHeaders(this.user.account,this.user.token,this.origin);return new Promise((e,t)=>{let n;const s=o;return console.log(`start listening on ${r} with transaction ID = ${s.id}...`),this.transactionSyncHandler.publishToChannel(r,o,i).catch(e=>{console.error("Failed to publish to channel:",e),t(e)}),n=this.transactionSyncHandler.subscribeToChannel(r,n=>{if(n.id===s.id)switch(n.type){case"requesting":console.log("tx requesting...");break;case"approved":try{const t=this.transactionSyncHandler.processTransactionResult(n);e(t)}catch(r){console.error("Failed to process transaction result:",r),t(r)}break;case"rejected":t(new Error("User rejected the transaction"));break;case"error":t(new Error(n.result));break;default:console.log(`Unknown status: ${JSON.stringify(n)}`)}},e=>{console.error("Subscription error:",e),t(e)},i),{unsubscribe:()=>{n?.unsubscribe()}}})}async signTransaction(e,t,n){if(!this.connectedType||"web"===this.connectedType)throw new Error("Activation_NotActivated!!!");return"direct"===this.connectedType?await this.directTransact(e,t,n):this.remoteTransact(e,t,n)}async checkActivation(e,t){try{const n=await this.checkIfActivated(t,this.origin);if(n)return this.user=n,this.connectedType="remote",e.ui.onLoginComplete(),this.user}catch(n){throw n}}async fetchActivationInfo({origin:e,dAppName:t,logourl:n,schema:r,description:o}){try{if(!this.mobileAppConnectConfig.remote)throw new Error("mobileAppConnectConfig remote is required");const i=await this.mobileAppConnectConfig.remote.getDappSingleUsedToken(),s=await fetch(`${this.activationEndpoint}/v1/wcw/dapp/code`,{method:"POST",headers:{"Content-Type":"application/json","X-dapp-sdk-sut":i.toString(),"X-dapp-sdk-client-id":this.mobileAppConnectConfig.remote.dappClientId.toString()},body:JSON.stringify({dapp:e,dAppName:t,logourl:n,schema:r,description:o,origin:e})});if(!s.ok)throw new Error(`Network response was not ok: ${s.status}`);return await s.json()}catch(i){throw console.error("Fetch error:",i),new Ad}}async checkIfActivated(e,t){return new Promise((n,r)=>{const o=setInterval(async()=>{const i=Math.floor(Date.now()/1e3);(this.user||this.isCanceled)&&clearInterval(o),i>e.expire&&(console.log("Current time is greater than expiration. Stopping pulling checkActivation.",i,e.expire),clearInterval(o),r(new Ed));try{const i=await fetch(`${this.activationEndpoint}/v1/wcw/dapp/code/check?dapp=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.code})});if(422===i.status)return void r(new Td);if(!i.ok)throw new Error(`Network response was not ok: ${i.status}`);const s=await i.json();202===i.status?console.log("Continuing pulling checkActivation"):200===i.status&&(console.log("Stopping pulling checkActivation"),clearInterval(o),n(s))}catch(s){console.error("Error checking activation:",s),clearInterval(o),r(s)}},5e3)})}getActivationPayload(e){return{origin:this.origin,dAppName:`${this.dAppInfo.name||e.appName}`,logourl:this.dAppInfo.logoUrl,schema:this.dAppInfo.schema,description:this.dAppInfo.description}}openDeepLinkWithFallback(e){return new Promise((t,n)=>{const r=setTimeout(()=>{n(new Id("App likely not installed, fallback triggered."))},4e3),o=()=>{clearTimeout(r),t()};window.addEventListener("pagehide",o,{once:!0}),window.addEventListener("blur",o,{once:!0}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&o()},{once:!0}),window.location.href=e})}async directConnect(e){const t=btoa(hd()||""),n=encodeURIComponent("1234567890");this.uuid=Se();const r=new URLSearchParams({schema:this.dAppInfo.schema||"none",dapp:this.dAppInfo.name||e.appName||"",origin:this.origin,logourl:this.dAppInfo.logoUrl||"",description:this.dAppInfo.description||"",antelope:"antelope-1",callbackHttp:t,uuid:this.uuid,deviceHash:n}),o=e.arbitrary.nonce;if(o){const e=btoa(o);r.set("n",e)}const i=`${this.WAX_SCHEME_DEEPLINK}://connect?${r.toString()}`;try{await this.openDeepLinkWithFallback(i)}catch(s){throw console.error("Failed to open deeplink:",s),s}return new Promise(async(e,t)=>{const n=setTimeout(()=>{this.isCanceled=!0,i(),t(new Error("Connection timeout"))},18e4);let r,o;const i=()=>{clearTimeout(n),clearInterval(o),r?.unsubscribe?.()},s=async()=>{try{const n=await nd(`/device-connect/${this.uuid}`,{authToken:this.uuid});r=n.subscribe({next:r=>{if("data"===r?.type&&r?.event?.accountName)return this.user={account:r.event.accountName,keys:[],isTemp:!1,createData:{},token:"",proof:r.event.proof},this.connectedType="direct",localStorage.setItem("connectedType",this.connectedType),i(),e(this.user),void n.close();if(r?.event?.error){const e="ConnectRejected"===r.event.error?"User rejected the connection":"Direct connection error";return i(),t(new Sd(e)),void n.close()}return i(),t(new Error("Invalid account")),void n.close()},error:e=>{console.error("Subscription error:",e),i(),t(e),n.close()}})}catch(n){i(),t(n)}};o=setInterval(()=>{document.hasFocus()&&s()},500)})}async directTransact(e,t,n){if(!this.connectedType||"remote"===this.connectedType)throw new Error("Invalid connection type, expect direct connection");const r=Array.from(e.serializedTransaction),i=btoa(JSON.stringify(r)),s=btoa(hd()||""),a=encodeURIComponent("1234567890"),c=Se(),u=new URLSearchParams({transaction:i,schema:this.dAppInfo.schema||"none",callbackHttp:s,redirect:"true",deviceHash:a,uuid:c,broadcast:"false"}),l=`${this.WAX_SCHEME_DEEPLINK}://transact?${u.toString()}`;try{await this.openDeepLinkWithFallback(l)}catch(d){throw console.error("Failed to open deeplink:",d),d}return new Promise(async(t,n)=>{const r=setTimeout(()=>{a(),n(new Error("Transaction timeout"))},18e4);let i,s;const a=()=>{clearTimeout(r),clearInterval(s),i?.unsubscribe?.()},u=async()=>{try{const r=await nd(`/device-transact/${c}`,{authToken:c});i=r.subscribe({next:i=>{if("data"===i?.type&&i?.event?.signatures){const n={signatures:function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");for(;t.length%4!=0;)t+="=";try{const e=atob(t);return JSON.parse(e)}catch(d){throw console.error("Failed to decode signature from wallet:",d),new Error("Invalid signature format")}}(i.event.signatures)};if(i.event.serializedTransaction){const t=o.decode({data:i.event.serializedTransaction,type:x});t.equals(e.transaction)||sd(e.transaction,t)}return t(n),void r.close()}if(i?.event?.error){const e="TransactionDeclined"===i.event.error?"User rejected the transaction":i.event.error;return a(),n(new Error(e)),void r.close()}return a(),n(new Error("Transaction unknown error")),void r.close()},error:e=>{alert("subscription error::"+e?.message),console.error("Subscription error:",e),a(),n(e),r.close()}})}catch(r){return a(),void n(r)}};s=setInterval(()=>{document.hasFocus()&&u()},350)})}async cleanup(){this.connectedType=null,this.user=void 0,this.isCanceled=!1,localStorage.removeItem("connectedType"),await async function(){await ed.close()}()}}class kd extends d{constructor(e){super(),this.id="cloudwallet",this.translations=dd,this.config={requiresChainSelect:!1,requiresPermissionSelect:!1,supportedChains:["1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4"]},this.metadata=h.from({name:"Cloud Wallet",description:"",logo:"data:image/png;base64,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",homepage:"https://www.mycloudwallet.com",download:"https://www.mycloudwallet.com"}),this.url="https://www.mycloudwallet.com",this.autoUrl="https://idm-api.mycloudwallet.com/v1/accounts/auto-accept",this.loginTimeout=3e5,this.allowTemp=!1,this.mobileAppConnect=null,this.options=e,e?.supportedChains&&(this.config.supportedChains=e.supportedChains),e?.url&&(this.url=e.url),e?.autoUrl&&(this.autoUrl=e.autoUrl),e?.loginTimeout&&(this.loginTimeout=e.loginTimeout),e?.allowTemp&&(this.allowTemp=e.allowTemp),e?.mobileAppConnectConfig&&(this.mobileAppConnect=new Cd(e.mobileAppConnectConfig))}login(e){let t;return t=gd()||navigator.userAgent.includes("iPhone")||navigator.userAgent.includes("iPad")?this.showLoginPrompt(e):this.waxLogin(e),C(t,e=>{throw console.log("[login]canceled",e),e})}async showLoginPrompt(e){let t,n;const r=new Promise((e,r)=>{t=e,n=r});let o,i;const s=new Promise((e,t)=>{o=e,i=t}),a=[];this.mobileAppConnect instanceof Cd&&a.push({type:"button",data:{label:"Open My Cloud Wallet app",variant:"primary",onClick:async()=>{try{if(!(this.mobileAppConnect instanceof Cd))throw new Error("Mobile App Connect is not initialized");if(!e.chain)throw new Error("A chain must be selected to login with.");const n=await this.mobileAppConnect.directConnect(e),r=n?.proof?.data?.signature,o=r&&k.from({chainId:c.from(e?.chain?.id),scope:O.from(e.appName||""),expiration:N.from((new Date).getTime()/1e3+3600),signer:y.from({actor:`${n?.account}`,permission:"active"}),signature:l.from(r)});this.data.identityProof=o,this.data.proof=n?.proof,this.data.isTempAccount=n?.isTemp,this.data.whitelist=n?.whitelistedContracts,t({chain:e.chain.id,permissionLevel:y.from({actor:`${n?.account}`,permission:"active"}),identityProof:o})}catch(r){n(r)}}}}),a.push({type:"button",data:{label:"Login with web",variant:"primary",onClick:async()=>{try{const t=await this.waxLogin(e);o(t)}catch(t){i(t)}}}});return e.ui.prompt({title:"Connect to My Cloud Wallet",body:"Connect My Cloud Wallet on your mobile device",elements:a}).catch(e=>{console.info("User cancelled modal::",e.message),n(e)}),await Promise.race([r,s])}async waxLogin(e){if(!e.chain)throw new Error("A chain must be selected to login with.");const t=e.ui.getTranslate(this.id);let n;const r=new URLSearchParams,o=e.arbitrary.nonce;if(o){const e=btoa(o);r.set("n",e)}r.set("returnTemp",this.allowTemp.toString());try{const e=new URL("/login",this.autoUrl);e.search=r.toString(),n=await async function(e,t){const n=new URL(t),r=await fetch(String(n),{credentials:"include",method:"get",headers:{"X-Referer-Url":location.origin}});if(!r.ok)throw new Error(e("error.endpoint",{default:"Login Endpoint Error {{status}} - {{statusText}}",status:r.status,statusText:r.statusText}));return await r.json()}(t,e.toString())}catch(a){const e=new URL("/cloud-wallet/login",this.url);e.search=r.toString(),n=await async function(e,t,n=3e5){const r=new URL(t),o=await window.open(r,"WalletPluginCloudWalletPopup","height=800,width=600");if(!o)throw new Error(e("error.popup",{default:"Unable to open the popup window. Check your browser settings and try again."}));return new Promise((t,i)=>{const s=ad(e,o,i),c=e=>{if(cd(e,r,o))try{t(e.data)}catch(a){i(a)}finally{window.removeEventListener("message",c),clearTimeout(u),clearInterval(s)}},u=setTimeout(()=>{o.close(),window.removeEventListener("message",c),i(new Error(e("error.timeout",{default:"The request has timed out after {{timeout}} seconds. Please try again.",timeout:n/1e3})))},n);window.addEventListener("message",c)})}(t,e.toString())}if(!n)throw new Error(t("login.error.response",{default:"Cloud Wallet failed to respond"}));if(!n.verified)throw new Error(t("error.closed",{default:"Cloud Wallet closed before the login was completed"}));this.data.whitelist=n.whitelistedContracts,this.data.isTempAccount=n.isTemp,this.data.proof=n?.proof,console.log("waxLogin::response proof",n?.proof);const i=n?.proof?.data?.signature,s=i&&k.from({chainId:c.from(e?.chain?.id),scope:O.from(e.appName||""),expiration:N.from((new Date).getTime()/1e3+3600),signer:y.from({actor:n.userAccount,permission:"active"}),signature:l.from(n?.proof?.data?.signature)});return this.data.identityProof=s,new Promise(t=>{if(!e.chain)throw new Error("A chain must be selected to login with.");localStorage.setItem("connectedType","web"),t({chain:e.chain.id,permissionLevel:y.from({actor:n.userAccount,permission:"active"}),identityProof:s})})}sign(e,t){let n;const r=localStorage.getItem("connectedType");return this.mobileAppConnect instanceof Cd&&("direct"===r||"remote"===r)?(console.log("mobileSign"),n=this.mobileSign(e,t)):(console.log("waxSign"),n=this.waxSign(e,t)),C(n,e=>{throw e})}async mobileSign(e,t){if(!t.ui)throw new Error("A UserInterface must be defined to sign transactions.");if(!(this.mobileAppConnect instanceof Cd))throw new Error("MobileAppConnect is not initialized");let n;const r=new Promise((e,t)=>{n=t});t.ui.getTranslate(this.id);const o=e.transaction.expiration.toDate(),i=new Date,s=Math.floor(o.getTime()-i.getTime());console.log("timeout",s);let a=C(new Promise(()=>{}));ud(e,this.data)||(a=t.ui.prompt({title:"Sign",body:"Please complete the transaction using the Cloud Wallet app.",optional:!0,elements:[{type:"countdown",data:o.toISOString()}]}),a.catch(e=>{clearTimeout(c),n(e)}));const c=setTimeout(()=>{if(!t.ui)throw new Error("No UI defined");a.cancel("The request expired, please try again.")},s),u=this.mobileAppConnect.signTransaction(e,t,{});return Promise.race([r,u])}async waxSign(e,t){if(!t.ui)throw new Error("A UserInterface must be defined to sign transactions.");const n=t.ui.getTranslate(this.id),r=e.transaction.expiration.toDate(),i=new Date,s=Math.floor(r.getTime()-i.getTime()),a=this.getWalletResponse(e,t,n,s);let l=C(new Promise(()=>{}));ud(e,this.data)||(l=t.ui.prompt({title:"Sign",body:"Please complete the transaction using the Cloud Wallet popup window.",optional:!0,elements:[{type:"countdown",data:r.toISOString()}]}),l.catch(()=>clearTimeout(d)));const d=setTimeout(()=>{if(!t.ui)throw new Error("No UI defined");l.cancel("The request expired, please try again.")},s),h=await Promise.race([a,l]).finally(()=>{clearTimeout(d),l.cancel()});if("serializedTransaction"in h){const n={signatures:h.signatures};if(h.serializedTransaction){const r=o.decode({data:h.serializedTransaction,type:x});if(!r.equals(e.transaction)){sd(e.transaction,r);const i=await u.create({transaction:r},t.esrOptions);n.resolved=new g(i,t.permissionLevel,x.from(r),o.objectify(x.from(r)),c.from(t.chain.id))}}return new Promise(e=>e(n))}throw new Error("The Cloud Wallet failed to respond")}async getWalletResponse(e,t,n,r=3e5){let o;if(!t.ui)throw new Error("The Cloud Wallet requires a UI to sign transactions.");if(ud(e,this.data))try{o=await async function(e,t,n){const r=new URL(t),o=new AbortController;setTimeout(()=>o.abort(),5e3);const i=await fetch(r,{body:JSON.stringify({feeFallback:!0,freeBandwidth:!0,transaction:n.serializedTransaction}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST",signal:o.signal});if(!i.ok)throw new Error(e("error.endpoint",{default:"Login Endpoint Error {{status}} - {{statusText}}",status:i.status,statusText:i.statusText}));const s=await i.json();if(s.processed&&s.processed.except)throw new Error(e("error.exception",{default:"Signing exception occurred: {{exception}}",exception:JSON.stringify(s)}));return s}(n,`${this.autoUrl}/signing`,e)}catch(i){o=await ld(n,`${this.url}/cloud-wallet/signing/`,e,r)}else o=await ld(n,`${this.url}/cloud-wallet/signing/`,e,r);if(!o)throw new Error(n("login.error.response",{default:"Cloud Wallet failed to respond"}));if(!o.verified)throw new Error(n("error.closed",{default:"The Cloud Wallet was closed before the request was completed"}));return this.data.whitelist=o.whitelistedContracts,o}async logout(e){this.mobileAppConnect&&await this.mobileAppConnect.cleanup()}}class Nd extends d{constructor(){super(),this.id="wombat",this.translations={},this.config={requiresChainSelect:!0,requiresPermissionSelect:!1},this.metadata=h.from({name:"Wombat",description:"",logo:"data:image/png;base64,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",homepage:"https://www.wombat.app/",download:"https://www.wombat.app/the-app"})}async loadScatterProtocol(){let e;if("undefined"!=typeof window&&(e=await M(()=>import("./protocol-scatter.m-DczvepMa.js"),__vite__mapDeps([0,1,2]))),!e)throw new Error("Scatter protocol is not available in this environment");return e}async login(e){return(await this.loadScatterProtocol()).handleLogin(e)}async logout(e){return(await this.loadScatterProtocol()).handleLogout(e)}async sign(e,t){return(await this.loadScatterProtocol()).handleSignatureRequest(e,t)}}export{we as W,M as _,kd as a,Nd as b};
