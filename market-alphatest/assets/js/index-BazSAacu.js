function e(){return be||(be=1,Te.exports=(je||(je=1,function(e){function t(e,t){var a=e.length;e.push(t);e:for(;0<a;){var s=a-1>>>1,i=e[s];if(!(0<n(i,t)))break e;e[s]=t,e[a]=i,a=s}}function a(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var s=0,i=e.length,r=i>>>1;s<r;){var l=2*(s+1)-1,o=e[l],c=l+1,d=e[c];if(0>n(o,a))c<i&&0>n(d,o)?(e[s]=d,e[c]=a,s=c):(e[s]=o,e[l]=a,s=l);else{if(!(c<i&&0>n(d,a)))break e;e[s]=d,e[c]=a,s=c}}}return t}function n(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}function i(e){for(var n=a(f);null!==n;){if(null===n.callback)s(f);else{if(!(n.startTime<=e))break;s(f),n.sortIndex=n.expirationTime,t(p,n)}n=a(f)}}function r(e){if(b=!1,i(e),!j)if(null!==a(p))j=!0,S||(S=!0,m());else{var t=a(f);null!==t&&c(r,t.startTime-e)}}function l(){return!(!N&&e.unstable_now()-T<A)}function o(){if(N=!1,S){var t=e.unstable_now();T=t;var n=!0;try{e:{j=!1,b&&(b=!1,k(C),C=-1),y=!0;var o=v;try{t:{for(i(t),g=a(p);null!==g&&!(g.expirationTime>t&&l());){var d=g.callback;if("function"==typeof d){g.callback=null,v=g.priorityLevel;var u=d(g.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof u){g.callback=u,i(t),n=!0;break t}g===a(p)&&s(p),i(t)}else s(p);g=a(p)}if(null!==g)n=!0;else{var h=a(f);null!==h&&c(r,h.startTime-t),n=!1}}break e}finally{g=null,v=o,y=!1}n=void 0}}finally{n?m():S=!1}}}function c(t,a){C=w(function(){t(e.unstable_now())},a)}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var d=performance;e.unstable_now=function(){return d.now()}}else{var u=Date,h=u.now();e.unstable_now=function(){return u.now()-h}}var m,p=[],f=[],x=1,g=null,v=3,y=!1,j=!1,b=!1,N=!1,w="function"==typeof setTimeout?setTimeout:null,k="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null,S=!1,C=-1,A=5,T=-1;if("function"==typeof _)m=function(){_(o)};else if("undefined"!=typeof MessageChannel){var P=new MessageChannel,E=P.port2;P.port1.onmessage=o,m=function(){E.postMessage(null)}}else m=function(){w(o,0)};e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(e){switch(v){case 1:case 2:case 3:var t=3;break;default:t=v}var a=v;v=t;try{return e()}finally{v=a}},e.unstable_requestPaint=function(){N=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=v;v=e;try{return t()}finally{v=a}},e.unstable_scheduleCallback=function(s,n,i){var l=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?l+i:l,s){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return s={id:x++,callback:n,priorityLevel:s,startTime:i,expirationTime:o=i+o,sortIndex:-1},i>l?(s.sortIndex=i,t(f,s),null===a(p)&&s===a(f)&&(b?(k(C),C=-1):b=!0,c(r,i-l))):(s.sortIndex=o,t(p,s),j||y||(j=!0,S||(S=!0,m()))),s},e.unstable_shouldYield=l,e.unstable_wrapCallback=function(e){var t=v;return function(){var a=v;v=t;try{return e.apply(this,arguments)}finally{v=a}}}}(Pe)),Pe)),Te.exports}function t(){function t(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function s(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function n(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function i(e){if(s(e)!==e)throw Error(t(188))}function r(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=r(e)))return t;e=e.sibling}return null}function l(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=El&&e[El]||e["@@iterator"])?e:null}function o(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===Il?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case vl:return"Fragment";case jl:return"Profiler";case yl:return"StrictMode";case _l:return"Suspense";case Sl:return"SuspenseList";case Tl:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case gl:return"Portal";case wl:return(e.displayName||"Context")+".Provider";case Nl:return(e._context.displayName||"Context")+".Consumer";case kl:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Cl:return null!==(t=e.displayName||null)?t:o(e.type)||"Memo";case Al:t=e._payload,e=e._init;try{return o(e(t))}catch(a){}}return null}function c(e){return{current:e}}function d(e){0>Wl||(e.current=Rl[Wl],Rl[Wl]=null,Wl--)}function u(e,t){Wl++,Rl[Wl]=e.current,e.current=t}function h(e,t){switch(u(Ul,t),u(Dl,e),u(Ol,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?or(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=cr(t=or(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}d(Ol),u(Ol,e)}function m(){d(Ol),d(Dl),d(Ul)}function p(e){null!==e.memoizedState&&u(Bl,e);var t=Ol.current,a=cr(t,e.type);t!==a&&(u(Dl,e),u(Ol,a))}function f(e){Dl.current===e&&(d(Ol),d(Dl)),Bl.current===e&&(d(Bl),jh._currentValue=Ml)}function x(e){if("function"==typeof to&&ao(e),no&&"function"==typeof no.setStrictMode)try{no.setStrictMode(so,e)}catch(t){}}function g(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function v(e,t,a){var s=e.pendingLanes;if(0===s)return 0;var n=0,i=e.suspendedLanes,r=e.pingedLanes;e=e.warmLanes;var l=134217727&s;return 0!==l?0!==(s=l&~i)?n=g(s):0!==(r&=l)?n=g(r):a||0!==(a=l&~e)&&(n=g(a)):0!==(l=s&~i)?n=g(l):0!==r?n=g(r):a||0!==(a=s&~e)&&(n=g(a)),0===n?0:0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(a=t&-t)||32===i&&4194048&a)?t:n}function y(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function j(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function b(){var e=oo;return!(4194048&(oo<<=1))&&(oo=256),e}function N(){var e=co;return!(62914560&(co<<=1))&&(co=4194304),e}function w(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function k(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function _(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-io(t);e.entangledLanes|=t,e.entanglements[s]=1073741824|e.entanglements[s]|4194090&a}function S(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var s=31-io(a),n=1<<s;n&t|e[s]&t&&(e[s]|=t),a&=~n}}function C(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function A(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function T(){var e=Ll.p;return 0!==e?e:void 0===(e=window.event)?32:Yr(e.type)}function P(e){delete e[ho],delete e[mo],delete e[fo],delete e[xo],delete e[go]}function E(e){var t=e[ho];if(t)return t;for(var a=e.parentNode;a;){if(t=a[po]||a[ho]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=gr(e);null!==e;){if(a=e[ho])return a;e=gr(e)}return t}a=(e=a).parentNode}return null}function I(e){if(e=e[ho]||e[po]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function F(e){var a=e.tag;if(5===a||26===a||27===a||6===a)return e.stateNode;throw Error(t(33))}function $(e){var t=e[vo];return t||(t=e[vo]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function L(e){e[yo]=!0}function M(e,t){O(e,t),O(e+"Capture",t)}function O(e,t){for(bo[e]=t,e=0;e<t.length;e++)jo.add(t[e])}function D(e,t,a){if(n=t,zl.call(ko,n)||!zl.call(wo,n)&&(No.test(n)?ko[n]=!0:(wo[n]=!0,0)))if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var s=t.toLowerCase().slice(0,5);if("data-"!==s&&"aria-"!==s)return void e.removeAttribute(t)}e.setAttribute(t,""+a)}var n}function U(e,t,a){if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+a)}}function B(e,t,a,s){if(null===s)e.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(a)}e.setAttributeNS(t,a,""+s)}}function z(e){if(void 0===cl)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);cl=t&&t[1]||"",dl=-1<a.stack.indexOf("\n    at")?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+cl+e+dl}function X(e,t){if(!e||_o)return"";_o=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(n){var s=n}Reflect.construct(e,[],a)}else{try{a.call()}catch(i){s=i}e.call(a.prototype)}}else{try{throw Error()}catch(r){s=r}(a=e())&&"function"==typeof a.catch&&a.catch(function(){})}}catch(l){if(l&&s&&"string"==typeof l.stack)return[l.stack,s.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=s.DetermineComponentFrameRoot(),r=i[0],l=i[1];if(r&&l){var o=r.split("\n"),c=l.split("\n");for(n=s=0;s<o.length&&!o[s].includes("DetermineComponentFrameRoot");)s++;for(;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;if(s===o.length||n===c.length)for(s=o.length-1,n=c.length-1;1<=s&&0<=n&&o[s]!==c[n];)n--;for(;1<=s&&0<=n;s--,n--)if(o[s]!==c[n]){if(1!==s||1!==n)do{if(s--,0>--n||o[s]!==c[n]){var d="\n"+o[s].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=s&&0<=n);break}}}finally{_o=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?z(a):""}function H(e){switch(e.tag){case 26:case 27:case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 15:return X(e.type,!1);case 11:return X(e.type.render,!1);case 1:return X(e.type,!0);case 31:return z("Activity");default:return""}}function q(e){try{var t="";do{t+=H(e),e=e.return}while(e);return t}catch(a){return"\nError generating stack: "+a.message+"\n"+a.stack}}function J(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==a&&"function"==typeof a.get&&"function"==typeof a.set){var n=a.get,i=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){s=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return s},setValue:function(e){s=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),s="";return e&&(s=V(e)?e.checked?"true":"false":e.value),(e=s)!==a&&(t.setValue(e),!0)}function Y(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Q(e){return e.replace(So,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function Z(e,t,a,s,n,i,r,l){e.name="",null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r?e.type=r:e.removeAttribute("type"),null!=t?"number"===r?(0===t&&""===e.value||e.value!=t)&&(e.value=""+J(t)):e.value!==""+J(t)&&(e.value=""+J(t)):"submit"!==r&&"reset"!==r||e.removeAttribute("value"),null!=t?te(e,r,J(t)):null!=a?te(e,r,J(a)):null!=s&&e.removeAttribute("value"),null==n&&null!=i&&(e.defaultChecked=!!i),null!=n&&(e.checked=n&&"function"!=typeof n&&"symbol"!=typeof n),null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l?e.name=""+J(l):e.removeAttribute("name")}function ee(e,t,a,s,n,i,r,l){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=a){if(("submit"===i||"reset"===i)&&null==t)return;a=null!=a?""+J(a):"",t=null!=t?""+J(t):a,l||t===e.value||(e.value=t),e.defaultValue=t}s="function"!=typeof(s=null!=s?s:n)&&"symbol"!=typeof s&&!!s,e.checked=l?e.checked:!!s,e.defaultChecked=!!s,null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r&&(e.name=r)}function te(e,t,a){"number"===t&&Y(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function ae(e,t,a,s){if(e=e.options,t){t={};for(var n=0;n<a.length;n++)t["$"+a[n]]=!0;for(a=0;a<e.length;a++)n=t.hasOwnProperty("$"+e[a].value),e[a].selected!==n&&(e[a].selected=n),n&&s&&(e[a].defaultSelected=!0)}else{for(a=""+J(a),t=null,n=0;n<e.length;n++){if(e[n].value===a)return e[n].selected=!0,void(s&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function se(e,t,a){null==t||((t=""+J(t))!==e.value&&(e.value=t),null!=a)?e.defaultValue=null!=a?""+J(a):"":e.defaultValue!==t&&(e.defaultValue=t)}function ne(e,a,s,n){if(null==a){if(null!=n){if(null!=s)throw Error(t(92));if(Fl(n)){if(1<n.length)throw Error(t(93));n=n[0]}s=n}null==s&&(s=""),a=s}s=J(a),e.defaultValue=s,(n=e.textContent)===s&&""!==n&&null!==n&&(e.value=n)}function ie(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}function re(e,t,a){var s=0===t.indexOf("--");null==a||"boolean"==typeof a||""===a?s?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":s?e.setProperty(t,a):"number"!=typeof a||0===a||Co.has(t)?"float"===t?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function le(e,a,s){if(null!=a&&"object"!=typeof a)throw Error(t(62));if(e=e.style,null!=s){for(var n in s)!s.hasOwnProperty(n)||null!=a&&a.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var i in a)n=a[i],a.hasOwnProperty(i)&&s[i]!==n&&re(e,i,n)}else for(var r in a)a.hasOwnProperty(r)&&re(e,r,a[r])}function oe(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function ce(e){return To.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function de(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function ue(e){var a=I(e);if(a&&(e=a.stateNode)){var s=e[mo]||null;e:switch(e=a.stateNode,a.type){case"input":if(Z(e,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name),a=s.name,"radio"===s.type&&null!=a){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll('input[name="'+Q(""+a)+'"][type="radio"]'),a=0;a<s.length;a++){var n=s[a];if(n!==e&&n.form===e.form){var i=n[mo]||null;if(!i)throw Error(t(90));Z(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(a=0;a<s.length;a++)(n=s[a]).form===e.form&&K(n)}break e;case"textarea":se(e,s.value,s.defaultValue);break e;case"select":null!=(a=s.value)&&ae(e,!!s.multiple,a,!1)}}}function he(e,t,a){if(Fo)return e(t,a);Fo=!0;try{return e(t)}finally{if(Fo=!1,(null!==Eo||null!==Io)&&(ri(),Eo&&(t=Eo,e=Io,Io=Eo=null,ue(t),e)))for(t=0;t<e.length;t++)ue(e[t])}}function me(e,a){var s=e.stateNode;if(null===s)return null;var n=s[mo]||null;if(null===n)return null;s=n[a];e:switch(a){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(s&&"function"!=typeof s)throw Error(t(231,a,typeof s));return s}function pe(){if(Bo)return Bo;var e,t,a=Uo,s=a.length,n="value"in Do?Do.value:Do.textContent,i=n.length;for(e=0;e<s&&a[e]===n[e];e++);var r=s-e;for(t=1;t<=r&&a[s-t]===n[i-t];t++);return Bo=n.slice(e,1<t?1-t:void 0)}function fe(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function xe(){return!0}function ge(){return!1}function ve(e){function t(t,a,s,n,i){for(var r in this._reactName=t,this._targetInst=s,this.type=a,this.nativeEvent=n,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(n):n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?xe:ge,this.isPropagationStopped=ge,this}return pl(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=xe)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=xe)},persist:function(){},isPersistent:xe}),t}function ye(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ac[e])&&!!t[e]}function je(){return ye}function be(e,t){switch(e){case"keyup":return-1!==cc.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function we(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}function ke(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!gc[e.type]:"textarea"===t}function _e(e,t,a,s){Eo?Io?Io.push(s):Io=[s]:Eo=s,0<(t=Qi(t,"onChange")).length&&(a=new Xo("onChange","change",null,a,s),e.push({event:a,listeners:t}))}function Se(e){Hi(e,0)}function Ce(e){if(K(F(e)))return e}function Te(e,t){if("change"===e)return t}function Pe(){vc&&(vc.detachEvent("onpropertychange",Ee),yc=vc=null)}function Ee(e){if("value"===e.propertyName&&Ce(yc)){var t=[];_e(t,yc,e,de(e)),he(Se,t)}}function Ie(e,t,a){"focusin"===e?(Pe(),yc=a,(vc=t).attachEvent("onpropertychange",Ee)):"focusout"===e&&Pe()}function Fe(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Ce(yc)}function $e(e,t){if("click"===e)return Ce(t)}function Le(e,t){if("input"===e||"change"===e)return Ce(t)}function Me(e,t){if(kc(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var a=Object.keys(e),s=Object.keys(t);if(a.length!==s.length)return!1;for(s=0;s<a.length;s++){var n=a[s];if(!zl.call(t,n)||!kc(e[n],t[n]))return!1}return!0}function Re(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function We(e,t){var a,s=Re(e);for(e=0;s;){if(3===s.nodeType){if(a=e+s.textContent.length,e<=t&&a>=t)return{node:s,offset:t-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Re(s)}}function Oe(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?Oe(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function De(e){for(var t=Y((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var a="string"==typeof t.contentWindow.location.href}catch(s){a=!1}if(!a)break;t=Y((e=t.contentWindow).document)}return t}function Ue(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Be(e,t,a){var s=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;Tc||null==Sc||Sc!==Y(s)||("selectionStart"in(s=Sc)&&Ue(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},Ac&&Me(Ac,s)||(Ac=s,0<(s=Qi(Cc,"onSelect")).length&&(t=new Xo("onSelect","select",null,t,a),e.push({event:t,listeners:s}),t.target=Sc)))}function ze(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}function Xe(e){if(Ec[e])return Ec[e];if(!Pc[e])return e;var t,a=Pc[e];for(t in a)if(a.hasOwnProperty(t)&&t in Ic)return Ec[e]=a[t];return e}function He(e,t){Dc.set(e,t),M(t,[e])}function qe(e,t){if("object"==typeof e&&null!==e){var a=Bc.get(e);return void 0!==a?a:(t={value:e,source:t,stack:q(t)},Bc.set(e,t),t)}return{value:e,source:t,stack:q(t)}}function Je(){for(var e=Xc,t=Hc=Xc=0;t<e;){var a=zc[t];zc[t++]=null;var s=zc[t];zc[t++]=null;var n=zc[t];zc[t++]=null;var i=zc[t];if(zc[t++]=null,null!==s&&null!==n){var r=s.pending;null===r?n.next=n:(n.next=r.next,r.next=n),s.pending=n}0!==i&&Ye(a,n,i)}}function Ve(e,t,a,s){zc[Xc++]=e,zc[Xc++]=t,zc[Xc++]=a,zc[Xc++]=s,Hc|=s,e.lanes|=s,null!==(e=e.alternate)&&(e.lanes|=s)}function Ge(e,t,a,s){return Ve(e,t,a,s),Qe(e)}function Ke(e,t){return Ve(e,null,null,t),Qe(e)}function Ye(e,t,a){e.lanes|=a;var s=e.alternate;null!==s&&(s.lanes|=a);for(var n=!1,i=e.return;null!==i;)i.childLanes|=a,null!==(s=i.alternate)&&(s.childLanes|=a),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(n=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,n&&null!==t&&(n=31-io(a),null===(s=(e=i.hiddenUpdates)[n])?e[n]=[t]:s.push(t),t.lane=536870912|a),i):null}function Qe(e){if(50<Xu)throw Xu=0,Hu=null,Error(t(185));for(var a=e.return;null!==a;)a=(e=a).return;return 3===e.tag?e.stateNode:null}function Ze(e,t,a,s){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function et(e,t,a,s){return new Ze(e,t,a,s)}function tt(e){return!(!(e=e.prototype)||!e.isReactComponent)}function at(e,t){var a=e.alternate;return null===a?((a=et(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=65011712&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function st(e,t){e.flags&=65011714;var a=e.alternate;return null===a?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function nt(e,a,s,n,i,r){var l=0;if(n=e,"function"==typeof e)tt(e)&&(l=1);else if("string"==typeof e)l=function(e,t,a){if(1===a||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,s,Ol.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case Tl:return(e=et(31,s,a,i)).elementType=Tl,e.lanes=r,e;case vl:return it(s.children,i,r,a);case yl:l=8,i|=24;break;case jl:return(e=et(12,s,a,2|i)).elementType=jl,e.lanes=r,e;case _l:return(e=et(13,s,a,i)).elementType=_l,e.lanes=r,e;case Sl:return(e=et(19,s,a,i)).elementType=Sl,e.lanes=r,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case bl:case wl:l=10;break e;case Nl:l=9;break e;case kl:l=11;break e;case Cl:l=14;break e;case Al:l=16,n=null;break e}l=29,s=Error(t(130,null===e?"null":typeof e,"")),n=null}return(a=et(l,s,a,i)).elementType=e,a.type=n,a.lanes=r,a}function it(e,t,a,s){return(e=et(7,e,s,t)).lanes=a,e}function rt(e,t,a){return(e=et(6,e,null,t)).lanes=a,e}function lt(e,t,a){return(t=et(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ot(e,t){Jc[Vc++]=Kc,Jc[Vc++]=Gc,Gc=e,Kc=t}function ct(e,t,a){Yc[Qc++]=ed,Yc[Qc++]=td,Yc[Qc++]=Zc,Zc=e;var s=ed;e=td;var n=32-io(s)-1;s&=~(1<<n),a+=1;var i=32-io(t)+n;if(30<i){var r=n-n%5;i=(s&(1<<r)-1).toString(32),s>>=r,n-=r,ed=1<<32-io(t)+n|a<<n|s,td=i+e}else ed=1<<i|a<<n|s,td=e}function dt(e){null!==e.return&&(ot(e,1),ct(e,1,0))}function ut(e){for(;e===Gc;)Gc=Jc[--Vc],Jc[Vc]=null,Kc=Jc[--Vc],Jc[Vc]=null;for(;e===Zc;)Zc=Yc[--Qc],Yc[Qc]=null,td=Yc[--Qc],Yc[Qc]=null,ed=Yc[--Qc],Yc[Qc]=null}function ht(e){throw vt(qe(Error(t(418,"")),e)),ld}function mt(e){var t=e.stateNode,a=e.type,s=e.memoizedProps;switch(t[ho]=e,t[mo]=s,a){case"dialog":qi("cancel",t),qi("close",t);break;case"iframe":case"object":case"embed":qi("load",t);break;case"video":case"audio":for(a=0;a<eh.length;a++)qi(eh[a],t);break;case"source":qi("error",t);break;case"img":case"image":case"link":qi("error",t),qi("load",t);break;case"details":qi("toggle",t);break;case"input":qi("invalid",t),ee(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),G(t);break;case"select":qi("invalid",t);break;case"textarea":qi("invalid",t),ne(t,s.value,s.defaultValue,s.children),G(t)}"string"!=typeof(a=s.children)&&"number"!=typeof a&&"bigint"!=typeof a||t.textContent===""+a||!0===s.suppressHydrationWarning||ar(t.textContent,a)?(null!=s.popover&&(qi("beforetoggle",t),qi("toggle",t)),null!=s.onScroll&&qi("scroll",t),null!=s.onScrollEnd&&qi("scrollend",t),null!=s.onClick&&(t.onclick=sr),t=!0):t=!1,t||ht(e)}function pt(e){for(ad=e.return;ad;)switch(ad.tag){case 5:case 13:return void(rd=!1);case 27:case 3:return void(rd=!0);default:ad=ad.return}}function ft(e){if(e!==ad)return!1;if(!nd)return pt(e),nd=!0,!1;var a,s=e.tag;if((a=3!==s&&27!==s)&&((a=5===s)&&(a=!("form"!==(a=e.type)&&"button"!==a)||dr(e.type,e.memoizedProps)),a=!a),a&&sd&&ht(e),pt(e),13===s){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(t(317));e:{for(e=e.nextSibling,s=0;e;){if(8===e.nodeType)if("/$"===(a=e.data)){if(0===s){sd=xr(e.nextSibling);break e}s--}else"$"!==a&&"$!"!==a&&"$?"!==a||s++;e=e.nextSibling}sd=null}}else 27===s?(s=sd,hr(e.type)?(e=hh,hh=null,sd=e):sd=s):sd=ad?xr(e.stateNode.nextSibling):null;return!0}function xt(){sd=ad=null,nd=!1}function gt(){var e=id;return null!==e&&(null===Eu?Eu=e:Eu.push.apply(Eu,e),id=null),e}function vt(e){null===id?id=[e]:id.push(e)}function yt(e,t,a){u(od,t._currentValue),t._currentValue=a}function jt(e){e._currentValue=od.current,d(od)}function bt(e,t,a){for(;null!==e;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==s&&(s.childLanes|=t)):null!==s&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===a)break;e=e.return}}function Nt(e,a,s,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var r=i.dependencies;if(null!==r){var l=i.child;r=r.firstContext;e:for(;null!==r;){var o=r;r=i;for(var c=0;c<a.length;c++)if(o.context===a[c]){r.lanes|=s,null!==(o=r.alternate)&&(o.lanes|=s),bt(r.return,s,e),n||(l=null);break e}r=o.next}}else if(18===i.tag){if(null===(l=i.return))throw Error(t(341));l.lanes|=s,null!==(r=l.alternate)&&(r.lanes|=s),bt(l,s,e),l=null}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===e){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}}function wt(e,a,s,n){e=null;for(var i=a,r=!1;null!==i;){if(!r)if(524288&i.flags)r=!0;else if(262144&i.flags)break;if(10===i.tag){var l=i.alternate;if(null===l)throw Error(t(387));if(null!==(l=l.memoizedProps)){var o=i.type;kc(i.pendingProps.value,l.value)||(null!==e?e.push(o):e=[o])}}else if(i===Bl.current){if(null===(l=i.alternate))throw Error(t(387));l.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(jh):e=[jh])}i=i.return}null!==e&&Nt(a,e,s,n),a.flags|=262144}function kt(e){for(e=e.firstContext;null!==e;){if(!kc(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function _t(e){cd=e,dd=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function St(e){return At(cd,e)}function Ct(e,t){return null===cd&&_t(e),At(e,t)}function At(e,a){var s=a._currentValue;if(a={context:a,memoizedValue:s,next:null},null===dd){if(null===e)throw Error(t(308));dd=a,e.dependencies={lanes:0,firstContext:a},e.flags|=524288}else dd=dd.next=a;return s}function Tt(){return{controller:new ud,data:new Map,refCount:0}}function Pt(e){e.refCount--,0===e.refCount&&hd(md,function(){e.controller.abort()})}function Et(){if(0===--xd&&null!==fd){null!==vd&&(vd.status="fulfilled");var e=fd;fd=null,gd=0,vd=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function It(){var e=jd.current;return null!==e?e:fu.pooledCache}function Ft(e,t){u(jd,null===t?jd.current:t.pool)}function $t(){var e=It();return null===e?null:{parent:pd._currentValue,pool:e}}function Lt(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Mt(){}function Rt(e,a,s){switch(void 0===(s=e[s])?e.push(a):s!==a&&(a.then(Mt,Mt),a=s),a.status){case"fulfilled":return a.value;case"rejected":throw Ot(e=a.reason),e;default:if("string"==typeof a.status)a.then(Mt,Mt);else{if(null!==(e=fu)&&100<e.shellSuspendCounter)throw Error(t(482));(e=a).status="pending",e.then(function(e){if("pending"===a.status){var t=a;t.status="fulfilled",t.value=e}},function(e){if("pending"===a.status){var t=a;t.status="rejected",t.reason=e}})}switch(a.status){case"fulfilled":return a.value;case"rejected":throw Ot(e=a.reason),e}throw _d=a,bd}}function Wt(){if(null===_d)throw Error(t(459));var e=_d;return _d=null,e}function Ot(e){if(e===bd||e===wd)throw Error(t(483))}function Dt(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ut(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Bt(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function zt(e,t,a){var s=e.updateQueue;if(null===s)return null;if(s=s.shared,2&pu){var n=s.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),s.pending=t,t=Qe(e),Ye(e,null,a),t}return Ve(e,s,t,a),Qe(e)}function Xt(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&a)){var s=t.lanes;a|=s&=e.pendingLanes,t.lanes=a,S(e,a)}}function Ht(e,t){var a=e.updateQueue,s=e.alternate;if(null!==s&&a===(s=s.updateQueue)){var n=null,i=null;if(null!==(a=a.firstBaseUpdate)){do{var r={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};null===i?n=i=r:i=i.next=r,a=a.next}while(null!==a);null===i?n=i=t:i=i.next=t}else n=i=t;return a={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:s.shared,callbacks:s.callbacks},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function qt(){if(Cd){if(null!==vd)throw vd}}function Jt(e,t,a,s){Cd=!1;var n=e.updateQueue;Sd=!1;var i=n.firstBaseUpdate,r=n.lastBaseUpdate,l=n.shared.pending;if(null!==l){n.shared.pending=null;var o=l,c=o.next;o.next=null,null===r?i=c:r.next=c,r=o;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==r&&(null===l?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=o))}if(null!==i){var u=n.baseState;for(r=0,d=c=o=null,l=i;;){var h=-536870913&l.lane,m=h!==l.lane;if(m?(gu&h)===h:(s&h)===h){0!==h&&h===gd&&(Cd=!0),null!==d&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var p=e,f=l;h=t;var x=a;switch(f.tag){case 1:if("function"==typeof(p=f.payload)){u=p.call(x,u,h);break e}u=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(h="function"==typeof(p=f.payload)?p.call(x,u,h):p))break e;u=pl({},u,h);break e;case 2:Sd=!0}}null!==(h=l.callback)&&(e.flags|=64,m&&(e.flags|=8192),null===(m=n.callbacks)?n.callbacks=[h]:m.push(h))}else m={lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(c=d=m,o=u):d=d.next=m,r|=h;if(null===(l=l.next)){if(null===(l=n.shared.pending))break;l=(m=l).next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}null===d&&(o=u),n.baseState=o,n.firstBaseUpdate=c,n.lastBaseUpdate=d,null===i&&(n.shared.lanes=0),_u|=r,e.lanes=r,e.memoizedState=u}}function Vt(e,a){if("function"!=typeof e)throw Error(t(191,e));e.call(a)}function Gt(e,t){var a=e.callbacks;if(null!==a)for(e.callbacks=null,e=0;e<a.length;e++)Vt(a[e],t)}function Kt(e,t){u(Td,e=wu),u(Ad,t),wu=e|t.baseLanes}function Yt(){u(Td,wu),u(Ad,Ad.current)}function Qt(){wu=Td.current,d(Ad),d(Td)}function Zt(){throw Error(t(321))}function ea(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!kc(e[a],t[a]))return!1;return!0}function ta(e,t,a,s,n,i){return Pd=i,Ed=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$l.H=null===e||null===e.memoizedState?Bd:zd,Md=!1,i=a(s,n),Md=!1,Ld&&(i=sa(t,a,s,n)),aa(e),i}function aa(e){$l.H=Ud;var a=null!==Id&&null!==Id.next;if(Pd=0,Fd=Id=Ed=null,$d=!1,Wd=0,Od=null,a)throw Error(t(300));null===e||tu||null!==(e=e.dependencies)&&kt(e)&&(tu=!0)}function sa(e,a,s,n){Ed=e;var i=0;do{if(Ld&&(Od=null),Wd=0,Ld=!1,25<=i)throw Error(t(301));if(i+=1,Fd=Id=null,null!=e.updateQueue){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,null!=r.memoCache&&(r.memoCache.index=0)}$l.H=Xd,r=a(s,n)}while(Ld);return r}function na(){var e=$l.H,t=e.useState()[0];return t="function"==typeof t.then?da(t):t,e=e.useState()[0],(null!==Id?Id.memoizedState:null)!==e&&(Ed.flags|=1024),t}function ia(){var e=0!==Rd;return Rd=0,e}function ra(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function la(e){if($d){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}$d=!1}Pd=0,Fd=Id=Ed=null,Ld=!1,Wd=Rd=0,Od=null}function oa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Fd?Ed.memoizedState=Fd=e:Fd=Fd.next=e,Fd}function ca(){if(null===Id){var e=Ed.alternate;e=null!==e?e.memoizedState:null}else e=Id.next;var a=null===Fd?Ed.memoizedState:Fd.next;if(null!==a)Fd=a,Id=e;else{if(null===e){if(null===Ed.alternate)throw Error(t(467));throw Error(t(310))}e={memoizedState:(Id=e).memoizedState,baseState:Id.baseState,baseQueue:Id.baseQueue,queue:Id.queue,next:null},null===Fd?Ed.memoizedState=Fd=e:Fd=Fd.next=e}return Fd}function da(e){var t=Wd;return Wd+=1,null===Od&&(Od=[]),e=Rt(Od,e,t),t=Ed,null===(null===Fd?t.memoizedState:Fd.next)&&(t=t.alternate,$l.H=null===t||null===t.memoizedState?Bd:zd),e}function ua(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return da(e);if(e.$$typeof===wl)return St(e)}throw Error(t(438,String(e)))}function ha(e){var t=null,a=Ed.updateQueue;if(null!==a&&(t=a.memoCache),null==t){var s=Ed.alternate;null!==s&&(null!==(s=s.updateQueue)&&(null!=(s=s.memoCache)&&(t={data:s.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===a&&(a={lastEffect:null,events:null,stores:null,memoCache:null},Ed.updateQueue=a),a.memoCache=t,void 0===(a=t.data[t.index]))for(a=t.data[t.index]=Array(e),s=0;s<e;s++)a[s]=Pl;return t.index++,a}function ma(e,t){return"function"==typeof t?t(e):t}function pa(e){return fa(ca(),Id,e)}function fa(e,a,s){var n=e.queue;if(null===n)throw Error(t(311));n.lastRenderedReducer=s;var i=e.baseQueue,r=n.pending;if(null!==r){if(null!==i){var l=i.next;i.next=r.next,r.next=l}a.baseQueue=i=r,n.pending=null}if(r=e.baseState,null===i)e.memoizedState=r;else{var o=l=null,c=null,d=a=i.next,u=!1;do{var h=-536870913&d.lane;if(h!==d.lane?(gu&h)===h:(Pd&h)===h){var m=d.revertLane;if(0===m)null!==c&&(c=c.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),h===gd&&(u=!0);else{if((Pd&m)===m){d=d.next,m===gd&&(u=!0);continue}h={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=h,l=r):c=c.next=h,Ed.lanes|=m,_u|=m}h=d.action,Md&&s(r,h),r=d.hasEagerState?d.eagerState:s(r,h)}else m={lane:h,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===c?(o=c=m,l=r):c=c.next=m,Ed.lanes|=h,_u|=h;d=d.next}while(null!==d&&d!==a);if(null===c?l=r:c.next=o,!kc(r,e.memoizedState)&&(tu=!0,u&&null!==(s=vd)))throw s;e.memoizedState=r,e.baseState=l,e.baseQueue=c,n.lastRenderedState=r}return null===i&&(n.lanes=0),[e.memoizedState,n.dispatch]}function xa(e){var a=ca(),s=a.queue;if(null===s)throw Error(t(311));s.lastRenderedReducer=e;var n=s.dispatch,i=s.pending,r=a.memoizedState;if(null!==i){s.pending=null;var l=i=i.next;do{r=e(r,l.action),l=l.next}while(l!==i);kc(r,a.memoizedState)||(tu=!0),a.memoizedState=r,null===a.baseQueue&&(a.baseState=r),s.lastRenderedState=r}return[r,n]}function ga(e,a,s){var n=Ed,i=ca(),r=nd;if(r){if(void 0===s)throw Error(t(407));s=s()}else s=a();var l=!kc((Id||i).memoizedState,s);if(l&&(i.memoizedState=s,tu=!0),i=i.queue,Da(2048,8,ja.bind(null,n,i,e),[e]),i.getSnapshot!==a||l||null!==Fd&&1&Fd.memoizedState.tag){if(n.flags|=2048,Ra(9,{destroy:void 0,resource:void 0},ya.bind(null,n,i,s,a),null),null===fu)throw Error(t(349));r||124&Pd||va(n,a,s)}return s}function va(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=Ed.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ed.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function ya(e,t,a,s){t.value=a,t.getSnapshot=s,ba(t)&&Na(e)}function ja(e,t,a){return a(function(){ba(t)&&Na(e)})}function ba(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!kc(e,a)}catch(s){return!0}}function Na(e){var t=Ke(e,2);null!==t&&ti(t,e,2)}function wa(e){var t=oa();if("function"==typeof e){var a=e;if(e=a(),Md){x(!0);try{a()}finally{x(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:e},t}function ka(e,t,a,s){return e.baseState=a,fa(e,Id,"function"==typeof s?s:ma)}function _a(e,a,s,n,i){if(us(e))throw Error(t(485));if(null!==(e=a.action)){var r={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){r.listeners.push(e)}};null!==$l.T?s(!0):r.isTransition=!1,n(r),null===(s=a.pending)?(r.next=a.pending=r,Sa(a,r)):(r.next=s.next,a.pending=s.next=r)}}function Sa(e,t){var a=t.action,s=t.payload,n=e.state;if(t.isTransition){var i=$l.T,r={};$l.T=r;try{var l=a(n,s),o=$l.S;null!==o&&o(r,l),Ca(e,t,l)}catch(c){Ta(e,t,c)}finally{$l.T=i}}else try{Ca(e,t,i=a(n,s))}catch(d){Ta(e,t,d)}}function Ca(e,t,a){null!==a&&"object"==typeof a&&"function"==typeof a.then?a.then(function(a){Aa(e,t,a)},function(a){return Ta(e,t,a)}):Aa(e,t,a)}function Aa(e,t,a){t.status="fulfilled",t.value=a,Pa(t),e.state=a,null!==(t=e.pending)&&((a=t.next)===t?e.pending=null:(a=a.next,t.next=a,Sa(e,a)))}function Ta(e,t,a){var s=e.pending;if(e.pending=null,null!==s){s=s.next;do{t.status="rejected",t.reason=a,Pa(t),t=t.next}while(t!==s)}e.action=null}function Pa(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Ea(e,t){return t}function Ia(e,t){if(nd){var a=fu.formState;if(null!==a){e:{var s=Ed;if(nd){if(sd){t:{for(var n=sd,i=rd;8!==n.nodeType;){if(!i){n=null;break t}if(null===(n=xr(n.nextSibling))){n=null;break t}}n="F!"===(i=n.data)||"F"===i?n:null}if(n){sd=xr(n.nextSibling),s="F!"===n.data;break e}}ht(s)}s=!1}s&&(t=a[0])}}return(a=oa()).memoizedState=a.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:t},a.queue=s,a=os.bind(null,Ed,s),s.dispatch=a,s=wa(!1),i=ds.bind(null,Ed,!1,s.queue),n={state:t,dispatch:null,action:e,pending:null},(s=oa()).queue=n,a=_a.bind(null,Ed,n,i,a),n.dispatch=a,s.memoizedState=e,[t,a,!1]}function Fa(e){return $a(ca(),Id,e)}function $a(e,t,a){if(t=fa(e,t,Ea)[0],e=pa(ma)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var s=da(t)}catch(r){if(r===bd)throw wd;throw r}else s=t;var n=(t=ca()).queue,i=n.dispatch;return a!==t.memoizedState&&(Ed.flags|=2048,Ra(9,{destroy:void 0,resource:void 0},La.bind(null,n,a),null)),[s,i,e]}function La(e,t){e.action=t}function Ma(e){var t=ca(),a=Id;if(null!==a)return $a(t,a,e);ca(),t=t.memoizedState;var s=(a=ca()).queue.dispatch;return a.memoizedState=e,[t,s,!1]}function Ra(e,t,a,s){return e={tag:e,create:a,deps:s,inst:t,next:null},null===(t=Ed.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ed.updateQueue=t),null===(a=t.lastEffect)?t.lastEffect=e.next=e:(s=a.next,a.next=e,e.next=s,t.lastEffect=e),e}function Wa(){return ca().memoizedState}function Oa(e,t,a,s){var n=oa();s=void 0===s?null:s,Ed.flags|=e,n.memoizedState=Ra(1|t,{destroy:void 0,resource:void 0},a,s)}function Da(e,t,a,s){var n=ca();s=void 0===s?null:s;var i=n.memoizedState.inst;null!==Id&&null!==s&&ea(s,Id.memoizedState.deps)?n.memoizedState=Ra(t,i,a,s):(Ed.flags|=e,n.memoizedState=Ra(1|t,i,a,s))}function Ua(e,t){Oa(8390656,8,e,t)}function Ba(e,t){Da(2048,8,e,t)}function za(e,t){return Da(4,2,e,t)}function Xa(e,t){return Da(4,4,e,t)}function Ha(e,t){if("function"==typeof t){e=e();var a=t(e);return function(){"function"==typeof a?a():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function qa(e,t,a){a=null!=a?a.concat([e]):null,Da(4,4,Ha.bind(null,t,e),a)}function Ja(){}function Va(e,t){var a=ca();t=void 0===t?null:t;var s=a.memoizedState;return null!==t&&ea(t,s[1])?s[0]:(a.memoizedState=[e,t],e)}function Ga(e,t){var a=ca();t=void 0===t?null:t;var s=a.memoizedState;if(null!==t&&ea(t,s[1]))return s[0];if(s=e(),Md){x(!0);try{e()}finally{x(!1)}}return a.memoizedState=[s,t],s}function Ka(e,t,a){return void 0===a||1073741824&Pd?e.memoizedState=t:(e.memoizedState=a,e=ei(),Ed.lanes|=e,_u|=e,a)}function Ya(e,t,a,s){return kc(a,t)?a:null!==Ad.current?(e=Ka(e,a,s),kc(e,t)||(tu=!0),e):42&Pd?(e=ei(),Ed.lanes|=e,_u|=e,t):(tu=!0,e.memoizedState=a)}function Qa(e,t,a,s,n){var i=Ll.p;Ll.p=0!==i&&8>i?i:8;var r,l,o,c=$l.T,d={};$l.T=d,ds(e,!1,t,a);try{var u=n(),h=$l.S;if(null!==h&&h(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then)cs(e,t,(r=s,l=[],o={status:"pending",value:null,reason:null,then:function(e){l.push(e)}},u.then(function(){o.status="fulfilled",o.value=r;for(var e=0;e<l.length;e++)(0,l[e])(r)},function(e){for(o.status="rejected",o.reason=e,e=0;e<l.length;e++)(0,l[e])(void 0)}),o),Zn());else cs(e,t,s,Zn())}catch(m){cs(e,t,{then:function(){},status:"rejected",reason:m},Zn())}finally{Ll.p=i,$l.T=c}}function Za(){}function es(e,a,s,n){if(5!==e.tag)throw Error(t(476));var i=ts(e).queue;Qa(e,i,a,Ml,null===s?Za:function(){return as(e),s(n)})}function ts(e){var t=e.memoizedState;if(null!==t)return t;var a={};return(t={memoizedState:Ml,baseState:Ml,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:Ml},next:null}).next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:a},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function as(e){cs(e,ts(e).next.queue,{},Zn())}function ss(){return St(jh)}function ns(){return ca().memoizedState}function is(){return ca().memoizedState}function rs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var a=Zn(),s=zt(t,e=Bt(a),a);return null!==s&&(ti(s,t,a),Xt(s,t,a)),t={cache:Tt()},void(e.payload=t)}t=t.return}}function ls(e,t,a){var s=Zn();a={lane:s,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},us(e)?hs(t,a):null!==(a=Ge(e,t,a,s))&&(ti(a,e,s),ms(a,t,s))}function os(e,t,a){cs(e,t,a,Zn())}function cs(e,t,a,s){var n={lane:s,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(us(e))hs(t,n);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var r=t.lastRenderedState,l=i(r,a);if(n.hasEagerState=!0,n.eagerState=l,kc(l,r))return Ve(e,t,n,0),null===fu&&Je(),!1}catch(o){}if(null!==(a=Ge(e,t,n,s)))return ti(a,e,s),ms(a,t,s),!0}return!1}function ds(e,a,s,n){if(n={lane:2,revertLane:Bi(),action:n,hasEagerState:!1,eagerState:null,next:null},us(e)){if(a)throw Error(t(479))}else null!==(a=Ge(e,s,n,2))&&ti(a,e,2)}function us(e){var t=e.alternate;return e===Ed||null!==t&&t===Ed}function hs(e,t){Ld=$d=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function ms(e,t,a){if(4194048&a){var s=t.lanes;a|=s&=e.pendingLanes,t.lanes=a,S(e,a)}}function ps(e){var t=qd;return qd+=1,null===Hd&&(Hd=[]),Rt(Hd,e,t)}function fs(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function xs(e,a){if(a.$$typeof===fl)throw Error(t(525));throw e=Object.prototype.toString.call(a),Error(t(31,"[object Object]"===e?"object with keys {"+Object.keys(a).join(", ")+"}":e))}function gs(e){return(0,e._init)(e._payload)}function vs(e){function a(t,a){if(e){var s=t.deletions;null===s?(t.deletions=[a],t.flags|=16):s.push(a)}}function s(t,s){if(!e)return null;for(;null!==s;)a(t,s),s=s.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=at(e,t)).index=0,e.sibling=null,e}function r(t,a,s){return t.index=s,e?null!==(s=t.alternate)?(s=s.index)<a?(t.flags|=67108866,a):s:(t.flags|=67108866,a):(t.flags|=1048576,a)}function o(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,a,s){return null===t||6!==t.tag?((t=rt(a,e.mode,s)).return=e,t):((t=i(t,a)).return=e,t)}function d(e,t,a,s){var n=a.type;return n===vl?h(e,t,a.props.children,s,a.key):null!==t&&(t.elementType===n||"object"==typeof n&&null!==n&&n.$$typeof===Al&&gs(n)===t.type)?(fs(t=i(t,a.props),a),t.return=e,t):(fs(t=nt(a.type,a.key,a.props,null,e.mode,s),a),t.return=e,t)}function u(e,t,a,s){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=lt(a,e.mode,s)).return=e,t):((t=i(t,a.children||[])).return=e,t)}function h(e,t,a,s,n){return null===t||7!==t.tag?((t=it(a,e.mode,s,n)).return=e,t):((t=i(t,a)).return=e,t)}function m(e,t,a){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=rt(""+t,e.mode,a)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case xl:return fs(a=nt(t.type,t.key,t.props,null,e.mode,a),t),a.return=e,a;case gl:return(t=lt(t,e.mode,a)).return=e,t;case Al:return m(e,t=(0,t._init)(t._payload),a)}if(Fl(t)||l(t))return(t=it(t,e.mode,a,null)).return=e,t;if("function"==typeof t.then)return m(e,ps(t),a);if(t.$$typeof===wl)return m(e,Ct(e,t),a);xs(e,t)}return null}function p(e,t,a,s){var n=null!==t?t.key:null;if("string"==typeof a&&""!==a||"number"==typeof a||"bigint"==typeof a)return null!==n?null:c(e,t,""+a,s);if("object"==typeof a&&null!==a){switch(a.$$typeof){case xl:return a.key===n?d(e,t,a,s):null;case gl:return a.key===n?u(e,t,a,s):null;case Al:return p(e,t,a=(n=a._init)(a._payload),s)}if(Fl(a)||l(a))return null!==n?null:h(e,t,a,s,null);if("function"==typeof a.then)return p(e,t,ps(a),s);if(a.$$typeof===wl)return p(e,t,Ct(e,a),s);xs(e,a)}return null}function f(e,t,a,s,n){if("string"==typeof s&&""!==s||"number"==typeof s||"bigint"==typeof s)return c(t,e=e.get(a)||null,""+s,n);if("object"==typeof s&&null!==s){switch(s.$$typeof){case xl:return d(t,e=e.get(null===s.key?a:s.key)||null,s,n);case gl:return u(t,e=e.get(null===s.key?a:s.key)||null,s,n);case Al:return f(e,t,a,s=(0,s._init)(s._payload),n)}if(Fl(s)||l(s))return h(t,e=e.get(a)||null,s,n,null);if("function"==typeof s.then)return f(e,t,a,ps(s),n);if(s.$$typeof===wl)return f(e,t,a,Ct(t,s),n);xs(t,s)}return null}function x(c,d,u,h){if("object"==typeof u&&null!==u&&u.type===vl&&null===u.key&&(u=u.props.children),"object"==typeof u&&null!==u){switch(u.$$typeof){case xl:e:{for(var g=u.key;null!==d;){if(d.key===g){if((g=u.type)===vl){if(7===d.tag){s(c,d.sibling),(h=i(d,u.props.children)).return=c,c=h;break e}}else if(d.elementType===g||"object"==typeof g&&null!==g&&g.$$typeof===Al&&gs(g)===d.type){s(c,d.sibling),fs(h=i(d,u.props),u),h.return=c,c=h;break e}s(c,d);break}a(c,d),d=d.sibling}u.type===vl?((h=it(u.props.children,c.mode,h,u.key)).return=c,c=h):(fs(h=nt(u.type,u.key,u.props,null,c.mode,h),u),h.return=c,c=h)}return o(c);case gl:e:{for(g=u.key;null!==d;){if(d.key===g){if(4===d.tag&&d.stateNode.containerInfo===u.containerInfo&&d.stateNode.implementation===u.implementation){s(c,d.sibling),(h=i(d,u.children||[])).return=c,c=h;break e}s(c,d);break}a(c,d),d=d.sibling}(h=lt(u,c.mode,h)).return=c,c=h}return o(c);case Al:return x(c,d,u=(g=u._init)(u._payload),h)}if(Fl(u))return function(t,i,l,o){for(var c=null,d=null,u=i,h=i=0,x=null;null!==u&&h<l.length;h++){u.index>h?(x=u,u=null):x=u.sibling;var g=p(t,u,l[h],o);if(null===g){null===u&&(u=x);break}e&&u&&null===g.alternate&&a(t,u),i=r(g,i,h),null===d?c=g:d.sibling=g,d=g,u=x}if(h===l.length)return s(t,u),nd&&ot(t,h),c;if(null===u){for(;h<l.length;h++)null!==(u=m(t,l[h],o))&&(i=r(u,i,h),null===d?c=u:d.sibling=u,d=u);return nd&&ot(t,h),c}for(u=n(u);h<l.length;h++)null!==(x=f(u,t,h,l[h],o))&&(e&&null!==x.alternate&&u.delete(null===x.key?h:x.key),i=r(x,i,h),null===d?c=x:d.sibling=x,d=x);return e&&u.forEach(function(e){return a(t,e)}),nd&&ot(t,h),c}(c,d,u,h);if(l(u)){if("function"!=typeof(g=l(u)))throw Error(t(150));return function(i,l,o,c){if(null==o)throw Error(t(151));for(var d=null,u=null,h=l,x=l=0,g=null,v=o.next();null!==h&&!v.done;x++,v=o.next()){h.index>x?(g=h,h=null):g=h.sibling;var y=p(i,h,v.value,c);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&a(i,h),l=r(y,l,x),null===u?d=y:u.sibling=y,u=y,h=g}if(v.done)return s(i,h),nd&&ot(i,x),d;if(null===h){for(;!v.done;x++,v=o.next())null!==(v=m(i,v.value,c))&&(l=r(v,l,x),null===u?d=v:u.sibling=v,u=v);return nd&&ot(i,x),d}for(h=n(h);!v.done;x++,v=o.next())null!==(v=f(h,i,x,v.value,c))&&(e&&null!==v.alternate&&h.delete(null===v.key?x:v.key),l=r(v,l,x),null===u?d=v:u.sibling=v,u=v);return e&&h.forEach(function(e){return a(i,e)}),nd&&ot(i,x),d}(c,d,u=g.call(u),h)}if("function"==typeof u.then)return x(c,d,ps(u),h);if(u.$$typeof===wl)return x(c,d,Ct(c,u),h);xs(c,u)}return"string"==typeof u&&""!==u||"number"==typeof u||"bigint"==typeof u?(u=""+u,null!==d&&6===d.tag?(s(c,d.sibling),(h=i(d,u)).return=c,c=h):(s(c,d),(h=rt(u,c.mode,h)).return=c,c=h),o(c)):s(c,d)}return function(e,t,a,s){try{qd=0;var n=x(e,t,a,s);return Hd=null,n}catch(r){if(r===bd||r===wd)throw r;var i=et(29,r,null,e.mode);return i.lanes=s,i.return=e,i}}}function ys(e){var t=e.alternate;u(Yd,1&Yd.current),u(Gd,e),null===Kd&&(null===t||null!==Ad.current||null!==t.memoizedState)&&(Kd=e)}function js(e){if(22===e.tag){if(u(Yd,Yd.current),u(Gd,e),null===Kd){var t=e.alternate;null!==t&&null!==t.memoizedState&&(Kd=e)}}else bs()}function bs(){u(Yd,Yd.current),u(Gd,Gd.current)}function Ns(e){d(Gd),Kd===e&&(Kd=null),d(Yd)}function ws(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||"$?"===a.data||fr(a)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function ks(e,t,a,s){a=null==(a=a(s,t=e.memoizedState))?t:pl({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}function _s(e,t,a,s,n,i,r){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(s,i,r):!t.prototype||!t.prototype.isPureReactComponent||(!Me(a,s)||!Me(n,i))}function Ss(e,t,a,s){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,s),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,s),t.state!==e&&Qd.enqueueReplaceState(t,t.state,null)}function Cs(e,t){var a=t;if("ref"in t)for(var s in a={},t)"ref"!==s&&(a[s]=t[s]);if(e=e.defaultProps)for(var n in a===t&&(a=pl({},a)),e)void 0===a[n]&&(a[n]=e[n]);return a}function As(e){Zd(e)}function Ts(e){console.error(e)}function Ps(e){Zd(e)}function Es(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function Is(e,t,a){try{(0,e.onCaughtError)(a.value,{componentStack:a.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function Fs(e,t,a){return(a=Bt(a)).tag=3,a.payload={element:null},a.callback=function(){Es(e,t)},a}function $s(e){return(e=Bt(e)).tag=3,e}function Ls(e,t,a,s){var n=a.type.getDerivedStateFromError;if("function"==typeof n){var i=s.value;e.payload=function(){return n(i)},e.callback=function(){Is(t,a,s)}}var r=a.stateNode;null!==r&&"function"==typeof r.componentDidCatch&&(e.callback=function(){Is(t,a,s),"function"!=typeof n&&(null===Mu?Mu=new Set([this]):Mu.add(this));var e=s.stack;this.componentDidCatch(s.value,{componentStack:null!==e?e:""})})}function Ms(e,t,a,s){t.child=null===e?Vd(t,null,a,s):Jd(t,e.child,a,s)}function Rs(e,t,a,s,n){a=a.render;var i=t.ref;if("ref"in s){var r={};for(var l in s)"ref"!==l&&(r[l]=s[l])}else r=s;return _t(t),s=ta(e,t,a,r,i,n),l=ia(),null===e||tu?(nd&&l&&dt(t),t.flags|=1,Ms(e,t,s,n),t.child):(ra(e,t,n),an(e,t,n))}function Ws(e,t,a,s,n){if(null===e){var i=a.type;return"function"!=typeof i||tt(i)||void 0!==i.defaultProps||null!==a.compare?((e=nt(a.type,null,s,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Os(e,t,i,s,n))}if(i=e.child,!sn(e,n)){var r=i.memoizedProps;if((a=null!==(a=a.compare)?a:Me)(r,s)&&e.ref===t.ref)return an(e,t,n)}return t.flags|=1,(e=at(i,s)).ref=t.ref,e.return=t,t.child=e}function Os(e,t,a,s,n){if(null!==e){var i=e.memoizedProps;if(Me(i,s)&&e.ref===t.ref){if(tu=!1,t.pendingProps=s=i,!sn(e,n))return t.lanes=e.lanes,an(e,t,n);131072&e.flags&&(tu=!0)}}return zs(e,t,a,s,n)}function Ds(e,t,a){var s=t.pendingProps,n=s.children,i=null!==e?e.memoizedState:null;if("hidden"===s.mode){if(128&t.flags){if(s=null!==i?i.baseLanes|a:a,null!==e){for(n=t.child=e.child,i=0;null!==n;)i=i|n.lanes|n.childLanes,n=n.sibling;t.childLanes=i&~s}else t.childLanes=0,t.child=null;return Us(e,t,s,a)}if(!(536870912&a))return t.lanes=t.childLanes=536870912,Us(e,t,null!==i?i.baseLanes|a:a,a);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Ft(0,null!==i?i.cachePool:null),null!==i?Kt(t,i):Yt(),js(t)}else null!==i?(Ft(0,i.cachePool),Kt(t,i),bs(),t.memoizedState=null):(null!==e&&Ft(0,null),Yt(),bs());return Ms(e,t,n,a),t.child}function Us(e,t,a,s){var n=It();return n=null===n?null:{parent:pd._currentValue,pool:n},t.memoizedState={baseLanes:a,cachePool:n},null!==e&&Ft(0,null),Yt(),js(t),null!==e&&wt(e,t,s,!0),null}function Bs(e,a){var s=a.ref;if(null===s)null!==e&&null!==e.ref&&(a.flags|=4194816);else{if("function"!=typeof s&&"object"!=typeof s)throw Error(t(284));null!==e&&e.ref===s||(a.flags|=4194816)}}function zs(e,t,a,s,n){return _t(t),a=ta(e,t,a,s,void 0,n),s=ia(),null===e||tu?(nd&&s&&dt(t),t.flags|=1,Ms(e,t,a,n),t.child):(ra(e,t,n),an(e,t,n))}function Xs(e,t,a,s,n,i){return _t(t),t.updateQueue=null,a=sa(t,s,a,n),aa(e),s=ia(),null===e||tu?(nd&&s&&dt(t),t.flags|=1,Ms(e,t,a,i),t.child):(ra(e,t,i),an(e,t,i))}function Hs(e,t,a,s,n){if(_t(t),null===t.stateNode){var i=qc,r=a.contextType;"object"==typeof r&&null!==r&&(i=St(r)),i=new a(s,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=Qd,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=s,i.state=t.memoizedState,i.refs={},Dt(t),r=a.contextType,i.context="object"==typeof r&&null!==r?St(r):qc,i.state=t.memoizedState,"function"==typeof(r=a.getDerivedStateFromProps)&&(ks(t,a,r,s),i.state=t.memoizedState),"function"==typeof a.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(r=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),r!==i.state&&Qd.enqueueReplaceState(i,i.state,null),Jt(t,s,i,n),qt(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),s=!0}else if(null===e){i=t.stateNode;var l=t.memoizedProps,o=Cs(a,l);i.props=o;var c=i.context,d=a.contextType;r=qc,"object"==typeof d&&null!==d&&(r=St(d));var u=a.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l||c!==r)&&Ss(t,i,s,r),Sd=!1;var h=t.memoizedState;i.state=h,Jt(t,s,i,n),qt(),c=t.memoizedState,l||h!==c||Sd?("function"==typeof u&&(ks(t,a,u,s),c=t.memoizedState),(o=Sd||_s(t,a,o,s,h,c,r))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=c),i.props=s,i.state=c,i.context=r,s=o):("function"==typeof i.componentDidMount&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,Ut(e,t),d=Cs(a,r=t.memoizedProps),i.props=d,u=t.pendingProps,h=i.context,c=a.contextType,o=qc,"object"==typeof c&&null!==c&&(o=St(c)),(c="function"==typeof(l=a.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(r!==u||h!==o)&&Ss(t,i,s,o),Sd=!1,h=t.memoizedState,i.state=h,Jt(t,s,i,n),qt();var m=t.memoizedState;r!==u||h!==m||Sd||null!==e&&null!==e.dependencies&&kt(e.dependencies)?("function"==typeof l&&(ks(t,a,l,s),m=t.memoizedState),(d=Sd||_s(t,a,d,s,h,m,o)||null!==e&&null!==e.dependencies&&kt(e.dependencies))?(c||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(s,m,o),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(s,m,o)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=m),i.props=s,i.state=m,i.context=o,s=d):("function"!=typeof i.componentDidUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||r===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),s=!1)}return i=s,Bs(e,t),s=!!(128&t.flags),i||s?(i=t.stateNode,a=s&&"function"!=typeof a.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&s?(t.child=Jd(t,e.child,null,n),t.child=Jd(t,null,a,n)):Ms(e,t,a,n),t.memoizedState=i.state,e=t.child):e=an(e,t,n),e}function qs(e,t,a,s){return xt(),t.flags|=256,Ms(e,t,a,s),t.child}function Js(e){return{baseLanes:e,cachePool:$t()}}function Vs(e,t,a){return e=null!==e?e.childLanes&~a:0,t&&(e|=Au),e}function Gs(e,a,s){var n,i=a.pendingProps,r=!1,l=!!(128&a.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&!!(2&Yd.current)),n&&(r=!0,a.flags&=-129),n=!!(32&a.flags),a.flags&=-33,null===e){if(nd){if(r?ys(a):bs(),nd){var o,c=sd;if(o=c){e:{for(o=c,c=rd;8!==o.nodeType;){if(!c){c=null;break e}if(null===(o=xr(o.nextSibling))){c=null;break e}}c=o}null!==c?(a.memoizedState={dehydrated:c,treeContext:null!==Zc?{id:ed,overflow:td}:null,retryLane:536870912,hydrationErrors:null},(o=et(18,null,null,0)).stateNode=c,o.return=a,a.child=o,ad=a,sd=null,o=!0):o=!1}o||ht(a)}if(null!==(c=a.memoizedState)&&null!==(c=c.dehydrated))return fr(c)?a.lanes=32:a.lanes=536870912,null;Ns(a)}return c=i.children,i=i.fallback,r?(bs(),c=Ys({mode:"hidden",children:c},r=a.mode),i=it(i,r,s,null),c.return=a,i.return=a,c.sibling=i,a.child=c,(r=a.child).memoizedState=Js(s),r.childLanes=Vs(e,n,s),a.memoizedState=au,i):(ys(a),Ks(a,c))}if(null!==(o=e.memoizedState)&&null!==(c=o.dehydrated)){if(l)256&a.flags?(ys(a),a.flags&=-257,a=Qs(e,a,s)):null!==a.memoizedState?(bs(),a.child=e.child,a.flags|=128,a=null):(bs(),r=i.fallback,c=a.mode,i=Ys({mode:"visible",children:i.children},c),(r=it(r,c,s,null)).flags|=2,i.return=a,r.return=a,i.sibling=r,a.child=i,Jd(a,e.child,null,s),(i=a.child).memoizedState=Js(s),i.childLanes=Vs(e,n,s),a.memoizedState=au,a=r);else if(ys(a),fr(c)){if(n=c.nextSibling&&c.nextSibling.dataset)var d=n.dgst;n=d,(i=Error(t(419))).stack="",i.digest=n,vt({value:i,source:null,stack:null}),a=Qs(e,a,s)}else if(tu||wt(e,a,s,!1),n=0!==(s&e.childLanes),tu||n){if(null!==(n=fu)&&(0!==(i=0!==((i=42&(i=s&-s)?1:C(i))&(n.suspendedLanes|s))?0:i)&&i!==o.retryLane))throw o.retryLane=i,Ke(e,i),ti(n,e,i),eu;"$?"===c.data||hi(),a=Qs(e,a,s)}else"$?"===c.data?(a.flags|=192,a.child=e.child,a=null):(e=o.treeContext,sd=xr(c.nextSibling),ad=a,nd=!0,id=null,rd=!1,null!==e&&(Yc[Qc++]=ed,Yc[Qc++]=td,Yc[Qc++]=Zc,ed=e.id,td=e.overflow,Zc=a),(a=Ks(a,i.children)).flags|=4096);return a}return r?(bs(),r=i.fallback,c=a.mode,d=(o=e.child).sibling,(i=at(o,{mode:"hidden",children:i.children})).subtreeFlags=65011712&o.subtreeFlags,null!==d?r=at(d,r):(r=it(r,c,s,null)).flags|=2,r.return=a,i.return=a,i.sibling=r,a.child=i,i=r,r=a.child,null===(c=e.child.memoizedState)?c=Js(s):(null!==(o=c.cachePool)?(d=pd._currentValue,o=o.parent!==d?{parent:d,pool:d}:o):o=$t(),c={baseLanes:c.baseLanes|s,cachePool:o}),r.memoizedState=c,r.childLanes=Vs(e,n,s),a.memoizedState=au,i):(ys(a),e=(s=e.child).sibling,(s=at(s,{mode:"visible",children:i.children})).return=a,s.sibling=null,null!==e&&(null===(n=a.deletions)?(a.deletions=[e],a.flags|=16):n.push(e)),a.child=s,a.memoizedState=null,s)}function Ks(e,t){return(t=Ys({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Ys(e,t){return(e=et(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function Qs(e,t,a){return Jd(t,e.child,null,a),(e=Ks(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Zs(e,t,a){e.lanes|=t;var s=e.alternate;null!==s&&(s.lanes|=t),bt(e.return,t,a)}function en(e,t,a,s,n){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:a,tailMode:n}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=a,i.tailMode=n)}function tn(e,t,a){var s=t.pendingProps,n=s.revealOrder,i=s.tail;if(Ms(e,t,s.children,a),2&(s=Yd.current))s=1&s|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Zs(e,a,t);else if(19===e.tag)Zs(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(u(Yd,s),n){case"forwards":for(a=t.child,n=null;null!==a;)null!==(e=a.alternate)&&null===ws(e)&&(n=a),a=a.sibling;null===(a=n)?(n=t.child,t.child=null):(n=a.sibling,a.sibling=null),en(t,!1,n,a,i);break;case"backwards":for(a=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ws(e)){t.child=n;break}e=n.sibling,n.sibling=a,a=n,n=e}en(t,!0,a,null,i);break;case"together":en(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function an(e,a,s){if(null!==e&&(a.dependencies=e.dependencies),_u|=a.lanes,0===(s&a.childLanes)){if(null===e)return null;if(wt(e,a,s,!1),0===(s&a.childLanes))return null}if(null!==e&&a.child!==e.child)throw Error(t(153));if(null!==a.child){for(s=at(e=a.child,e.pendingProps),a.child=s,s.return=a;null!==e.sibling;)e=e.sibling,(s=s.sibling=at(e,e.pendingProps)).return=a;s.sibling=null}return a.child}function sn(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!kt(e))}function nn(e,a,s){if(null!==e)if(e.memoizedProps!==a.pendingProps)tu=!0;else{if(!(sn(e,s)||128&a.flags))return tu=!1,function(e,t,a){switch(t.tag){case 3:h(t,t.stateNode.containerInfo),yt(0,pd,e.memoizedState.cache),xt();break;case 27:case 5:p(t);break;case 4:h(t,t.stateNode.containerInfo);break;case 10:yt(0,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(null!==s)return null!==s.dehydrated?(ys(t),t.flags|=128,null):0!==(a&t.child.childLanes)?Gs(e,t,a):(ys(t),null!==(e=an(e,t,a))?e.sibling:null);ys(t);break;case 19:var n=!!(128&e.flags);if((s=0!==(a&t.childLanes))||(wt(e,t,a,!1),s=0!==(a&t.childLanes)),n){if(s)return tn(e,t,a);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),u(Yd,Yd.current),s)break;return null;case 22:case 23:return t.lanes=0,Ds(e,t,a);case 24:yt(0,pd,e.memoizedState.cache)}return an(e,t,a)}(e,a,s);tu=!!(131072&e.flags)}else tu=!1,nd&&1048576&a.flags&&ct(a,Kc,a.index);switch(a.lanes=0,a.tag){case 16:e:{e=a.pendingProps;var n=a.elementType,i=n._init;if(n=i(n._payload),a.type=n,"function"!=typeof n){if(null!=n){if((i=n.$$typeof)===kl){a.tag=11,a=Rs(null,a,n,e,s);break e}if(i===Cl){a.tag=14,a=Ws(null,a,n,e,s);break e}}throw a=o(n)||n,Error(t(306,a,""))}tt(n)?(e=Cs(n,e),a.tag=1,a=Hs(null,a,n,e,s)):(a.tag=0,a=zs(null,a,n,e,s))}return a;case 0:return zs(e,a,a.type,a.pendingProps,s);case 1:return Hs(e,a,n=a.type,i=Cs(n,a.pendingProps),s);case 3:e:{if(h(a,a.stateNode.containerInfo),null===e)throw Error(t(387));n=a.pendingProps;var r=a.memoizedState;i=r.element,Ut(e,a),Jt(a,n,null,s);var l=a.memoizedState;if(n=l.cache,yt(0,pd,n),n!==r.cache&&Nt(a,[pd],s,!0),qt(),n=l.element,r.isDehydrated){if(r={element:n,isDehydrated:!1,cache:l.cache},a.updateQueue.baseState=r,a.memoizedState=r,256&a.flags){a=qs(e,a,n,s);break e}if(n!==i){vt(i=qe(Error(t(424)),a)),a=qs(e,a,n,s);break e}if(9===(e=a.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(sd=xr(e.firstChild),ad=a,nd=!0,id=null,rd=!0,s=Vd(a,null,n,s),a.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(xt(),n===i){a=an(e,a,s);break e}Ms(e,a,n,s)}a=a.child}return a;case 26:return Bs(e,a),null===e?(s=Nr(a.type,null,a.pendingProps,null))?a.memoizedState=s:nd||(s=a.type,e=a.pendingProps,(n=lr(Ul.current).createElement(s))[ho]=a,n[mo]=e,rr(n,s,e),L(n),a.stateNode=n):a.memoizedState=Nr(a.type,e.memoizedProps,a.pendingProps,e.memoizedState),null;case 27:return p(a),null===e&&nd&&(n=a.stateNode=vr(a.type,a.pendingProps,Ul.current),ad=a,rd=!0,i=sd,hr(a.type)?(hh=i,sd=xr(n.firstChild)):sd=i),Ms(e,a,a.pendingProps.children,s),Bs(e,a),null===e&&(a.flags|=4194304),a.child;case 5:return null===e&&nd&&((i=n=sd)&&(null!==(n=function(e,t,a,s){for(;1===e.nodeType;){var n=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(s){if(!e[yo])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==n.rel||e.getAttribute("href")!==(null==n.href||""===n.href?null:n.href)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin)||e.getAttribute("title")!==(null==n.title?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==n.src?null:n.src)||e.getAttribute("type")!==(null==n.type?null:n.type)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==n.name?null:""+n.name;if("hidden"===n.type&&e.getAttribute("name")===i)return e}if(null===(e=xr(e.nextSibling)))break}return null}(n,a.type,a.pendingProps,rd))?(a.stateNode=n,ad=a,sd=xr(n.firstChild),rd=!1,i=!0):i=!1),i||ht(a)),p(a),i=a.type,r=a.pendingProps,l=null!==e?e.memoizedProps:null,n=r.children,dr(i,r)?n=null:null!==l&&dr(i,l)&&(a.flags|=32),null!==a.memoizedState&&(i=ta(e,a,na,null,null,s),jh._currentValue=i),Bs(e,a),Ms(e,a,n,s),a.child;case 6:return null===e&&nd&&((e=s=sd)&&(null!==(s=function(e,t,a){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!a)return null;if(null===(e=xr(e.nextSibling)))return null}return e}(s,a.pendingProps,rd))?(a.stateNode=s,ad=a,sd=null,e=!0):e=!1),e||ht(a)),null;case 13:return Gs(e,a,s);case 4:return h(a,a.stateNode.containerInfo),n=a.pendingProps,null===e?a.child=Jd(a,null,n,s):Ms(e,a,n,s),a.child;case 11:return Rs(e,a,a.type,a.pendingProps,s);case 7:return Ms(e,a,a.pendingProps,s),a.child;case 8:case 12:return Ms(e,a,a.pendingProps.children,s),a.child;case 10:return n=a.pendingProps,yt(0,a.type,n.value),Ms(e,a,n.children,s),a.child;case 9:return i=a.type._context,n=a.pendingProps.children,_t(a),n=n(i=St(i)),a.flags|=1,Ms(e,a,n,s),a.child;case 14:return Ws(e,a,a.type,a.pendingProps,s);case 15:return Os(e,a,a.type,a.pendingProps,s);case 19:return tn(e,a,s);case 31:return n=a.pendingProps,s=a.mode,n={mode:n.mode,children:n.children},null===e?((s=Ys(n,s)).ref=a.ref,a.child=s,s.return=a,a=s):((s=at(e.child,n)).ref=a.ref,a.child=s,s.return=a,a=s),a;case 22:return Ds(e,a,s);case 24:return _t(a),n=St(pd),null===e?(null===(i=It())&&(i=fu,r=Tt(),i.pooledCache=r,r.refCount++,null!==r&&(i.pooledCacheLanes|=s),i=r),a.memoizedState={parent:n,cache:i},Dt(a),yt(0,pd,i)):(0!==(e.lanes&s)&&(Ut(e,a),Jt(a,null,null,s),qt()),i=e.memoizedState,r=a.memoizedState,i.parent!==n?(i={parent:n,cache:n},a.memoizedState=i,0===a.lanes&&(a.memoizedState=a.updateQueue.baseState=i),yt(0,pd,n)):(n=r.cache,yt(0,pd,n),n!==i.cache&&Nt(a,[pd],s,!0))),Ms(e,a,a.pendingProps.children,s),a.child;case 29:throw a.pendingProps}throw Error(t(156,a.tag))}function rn(e){e.flags|=4}function ln(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!$r(t)){if(null!==(t=Gd.current)&&((4194048&gu)===gu?null!==Kd:(62914560&gu)!==gu&&!(536870912&gu)||t!==Kd))throw _d=kd,Nd;e.flags|=8192}}function on(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?N():536870912,e.lanes|=t,Tu|=t)}function cn(e,t){if(!nd)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var s=null;null!==a;)null!==a.alternate&&(s=a),a=a.sibling;null===s?t||null===e.tail?e.tail=null:e.tail.sibling=null:s.sibling=null}}function dn(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,s=0;if(t)for(var n=e.child;null!==n;)a|=n.lanes|n.childLanes,s|=65011712&n.subtreeFlags,s|=65011712&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)a|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=a,t}function un(e,a,s){var n=a.pendingProps;switch(ut(a),a.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return dn(a),null;case 3:return s=a.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),a.memoizedState.cache!==n&&(a.flags|=2048),jt(pd),m(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),null!==e&&null!==e.child||(ft(a)?rn(a):null===e||e.memoizedState.isDehydrated&&!(256&a.flags)||(a.flags|=1024,gt())),dn(a),null;case 26:return s=a.memoizedState,null===e?(rn(a),null!==s?(dn(a),ln(a,s)):(dn(a),a.flags&=-16777217)):s?s!==e.memoizedState?(rn(a),dn(a),ln(a,s)):(dn(a),a.flags&=-16777217):(e.memoizedProps!==n&&rn(a),dn(a),a.flags&=-16777217),null;case 27:f(a),s=Ul.current;var i=a.type;if(null!==e&&null!=a.stateNode)e.memoizedProps!==n&&rn(a);else{if(!n){if(null===a.stateNode)throw Error(t(166));return dn(a),null}e=Ol.current,ft(a)?mt(a):(e=vr(i,n,s),a.stateNode=e,rn(a))}return dn(a),null;case 5:if(f(a),s=a.type,null!==e&&null!=a.stateNode)e.memoizedProps!==n&&rn(a);else{if(!n){if(null===a.stateNode)throw Error(t(166));return dn(a),null}if(e=Ol.current,ft(a))mt(a);else{switch(i=lr(Ul.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",s);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;default:switch(s){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",s);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",s);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof n.is?i.createElement("select",{is:n.is}):i.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e="string"==typeof n.is?i.createElement(s,{is:n.is}):i.createElement(s)}}e[ho]=a,e[mo]=n;e:for(i=a.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;null===i.sibling;){if(null===i.return||i.return===a)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}a.stateNode=e;e:switch(rr(e,s,n),s){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&rn(a)}}return dn(a),a.flags&=-16777217,null;case 6:if(e&&null!=a.stateNode)e.memoizedProps!==n&&rn(a);else{if("string"!=typeof n&&null===a.stateNode)throw Error(t(166));if(e=Ul.current,ft(a)){if(e=a.stateNode,s=a.memoizedProps,n=null,null!==(i=ad))switch(i.tag){case 27:case 5:n=i.memoizedProps}e[ho]=a,(e=!!(e.nodeValue===s||null!==n&&!0===n.suppressHydrationWarning||ar(e.nodeValue,s)))||ht(a)}else(e=lr(e).createTextNode(n))[ho]=a,a.stateNode=e}return dn(a),null;case 13:if(n=a.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=ft(a),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(t(318));if(!(i=null!==(i=a.memoizedState)?i.dehydrated:null))throw Error(t(317));i[ho]=a}else xt(),!(128&a.flags)&&(a.memoizedState=null),a.flags|=4;dn(a),i=!1}else i=gt(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&a.flags?(Ns(a),a):(Ns(a),null)}if(Ns(a),128&a.flags)return a.lanes=s,a;if(s=null!==n,e=null!==e&&null!==e.memoizedState,s){i=null,null!==(n=a.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(i=n.alternate.memoizedState.cachePool.pool);var r=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(r=n.memoizedState.cachePool.pool),r!==i&&(n.flags|=2048)}return s!==e&&s&&(a.child.flags|=8192),on(a,a.updateQueue),dn(a),null;case 4:return m(),null===e&&Vi(a.stateNode.containerInfo),dn(a),null;case 10:return jt(a.type),dn(a),null;case 19:if(d(Yd),null===(i=a.memoizedState))return dn(a),null;if(n=!!(128&a.flags),null===(r=i.rendering))if(n)cn(i,!1);else{if(0!==ku||null!==e&&128&e.flags)for(e=a.child;null!==e;){if(null!==(r=ws(e))){for(a.flags|=128,cn(i,!1),e=r.updateQueue,a.updateQueue=e,on(a,e),a.subtreeFlags=0,e=s,s=a.child;null!==s;)st(s,e),s=s.sibling;return u(Yd,1&Yd.current|2),a.child}e=e.sibling}null!==i.tail&&Vl()>$u&&(a.flags|=128,n=!0,cn(i,!1),a.lanes=4194304)}else{if(!n)if(null!==(e=ws(r))){if(a.flags|=128,n=!0,e=e.updateQueue,a.updateQueue=e,on(a,e),cn(i,!0),null===i.tail&&"hidden"===i.tailMode&&!r.alternate&&!nd)return dn(a),null}else 2*Vl()-i.renderingStartTime>$u&&536870912!==s&&(a.flags|=128,n=!0,cn(i,!1),a.lanes=4194304);i.isBackwards?(r.sibling=a.child,a.child=r):(null!==(e=i.last)?e.sibling=r:a.child=r,i.last=r)}return null!==i.tail?(a=i.tail,i.rendering=a,i.tail=a.sibling,i.renderingStartTime=Vl(),a.sibling=null,e=Yd.current,u(Yd,n?1&e|2:1&e),a):(dn(a),null);case 22:case 23:return Ns(a),Qt(),n=null!==a.memoizedState,null!==e?null!==e.memoizedState!==n&&(a.flags|=8192):n&&(a.flags|=8192),n?!!(536870912&s)&&!(128&a.flags)&&(dn(a),6&a.subtreeFlags&&(a.flags|=8192)):dn(a),null!==(s=a.updateQueue)&&on(a,s.retryQueue),s=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(s=e.memoizedState.cachePool.pool),n=null,null!==a.memoizedState&&null!==a.memoizedState.cachePool&&(n=a.memoizedState.cachePool.pool),n!==s&&(a.flags|=2048),null!==e&&d(jd),null;case 24:return s=null,null!==e&&(s=e.memoizedState.cache),a.memoizedState.cache!==s&&(a.flags|=2048),jt(pd),dn(a),null;case 25:case 30:return null}throw Error(t(156,a.tag))}function hn(e,a){switch(ut(a),a.tag){case 1:return 65536&(e=a.flags)?(a.flags=-65537&e|128,a):null;case 3:return jt(pd),m(),65536&(e=a.flags)&&!(128&e)?(a.flags=-65537&e|128,a):null;case 26:case 27:case 5:return f(a),null;case 13:if(Ns(a),null!==(e=a.memoizedState)&&null!==e.dehydrated){if(null===a.alternate)throw Error(t(340));xt()}return 65536&(e=a.flags)?(a.flags=-65537&e|128,a):null;case 19:return d(Yd),null;case 4:return m(),null;case 10:return jt(a.type),null;case 22:case 23:return Ns(a),Qt(),null!==e&&d(jd),65536&(e=a.flags)?(a.flags=-65537&e|128,a):null;case 24:return jt(pd),null;default:return null}}function mn(e,t){switch(ut(t),t.tag){case 3:jt(pd),m();break;case 26:case 27:case 5:f(t);break;case 4:m();break;case 13:Ns(t);break;case 19:d(Yd);break;case 10:jt(t.type);break;case 22:case 23:Ns(t),Qt(),null!==e&&d(jd);break;case 24:jt(pd)}}function pn(e,t){try{var a=t.updateQueue,s=null!==a?a.lastEffect:null;if(null!==s){var n=s.next;a=n;do{if((a.tag&e)===e){s=void 0;var i=a.create,r=a.inst;s=i(),r.destroy=s}a=a.next}while(a!==n)}}catch(l){Ti(t,t.return,l)}}function fn(e,t,a){try{var s=t.updateQueue,n=null!==s?s.lastEffect:null;if(null!==n){var i=n.next;s=i;do{if((s.tag&e)===e){var r=s.inst,l=r.destroy;if(void 0!==l){r.destroy=void 0,n=t;var o=a,c=l;try{c()}catch(d){Ti(n,o,d)}}}s=s.next}while(s!==i)}}catch(d){Ti(t,t.return,d)}}function xn(e){var t=e.updateQueue;if(null!==t){var a=e.stateNode;try{Gt(t,a)}catch(s){Ti(e,e.return,s)}}}function gn(e,t,a){a.props=Cs(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(s){Ti(e,t,s)}}function vn(e,t){try{var a=e.ref;if(null!==a){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;default:s=e.stateNode}"function"==typeof a?e.refCleanup=a(s):a.current=s}}catch(n){Ti(e,t,n)}}function yn(e,t){var a=e.ref,s=e.refCleanup;if(null!==a)if("function"==typeof s)try{s()}catch(n){Ti(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof a)try{a(null)}catch(i){Ti(e,t,i)}else a.current=null}function jn(e){var t=e.type,a=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&s.focus();break e;case"img":a.src?s.src=a.src:a.srcSet&&(s.srcset=a.srcSet)}}catch(n){Ti(e,e.return,n)}}function bn(e,a,s){try{var n=e.stateNode;!function(e,a,s,n){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,r=null,l=null,o=null,c=null,d=null,u=null;for(p in s){var h=s[p];if(s.hasOwnProperty(p)&&null!=h)switch(p){case"checked":case"value":break;case"defaultValue":c=h;default:n.hasOwnProperty(p)||nr(e,a,p,null,n,h)}}for(var m in n){var p=n[m];if(h=s[m],n.hasOwnProperty(m)&&(null!=p||null!=h))switch(m){case"type":r=p;break;case"name":i=p;break;case"checked":d=p;break;case"defaultChecked":u=p;break;case"value":l=p;break;case"defaultValue":o=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(t(137,a));break;default:p!==h&&nr(e,a,m,p,n,h)}}return void Z(e,l,o,c,d,u,r,i);case"select":for(r in p=l=o=m=null,s)if(c=s[r],s.hasOwnProperty(r)&&null!=c)switch(r){case"value":break;case"multiple":p=c;default:n.hasOwnProperty(r)||nr(e,a,r,null,n,c)}for(i in n)if(r=n[i],c=s[i],n.hasOwnProperty(i)&&(null!=r||null!=c))switch(i){case"value":m=r;break;case"defaultValue":o=r;break;case"multiple":l=r;default:r!==c&&nr(e,a,i,r,n,c)}return a=o,s=l,n=p,void(null!=m?ae(e,!!s,m,!1):!!n!=!!s&&(null!=a?ae(e,!!s,a,!0):ae(e,!!s,s?[]:"",!1)));case"textarea":for(o in p=m=null,s)if(i=s[o],s.hasOwnProperty(o)&&null!=i&&!n.hasOwnProperty(o))switch(o){case"value":case"children":break;default:nr(e,a,o,null,n,i)}for(l in n)if(i=n[l],r=s[l],n.hasOwnProperty(l)&&(null!=i||null!=r))switch(l){case"value":m=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(t(91));break;default:i!==r&&nr(e,a,l,i,n,r)}return void se(e,m,p);case"option":for(var f in s)if(m=s[f],s.hasOwnProperty(f)&&null!=m&&!n.hasOwnProperty(f))if("selected"===f)e.selected=!1;else nr(e,a,f,null,n,m);for(c in n)if(m=n[c],p=s[c],n.hasOwnProperty(c)&&m!==p&&(null!=m||null!=p))if("selected"===c)e.selected=m&&"function"!=typeof m&&"symbol"!=typeof m;else nr(e,a,c,m,n,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var x in s)m=s[x],s.hasOwnProperty(x)&&null!=m&&!n.hasOwnProperty(x)&&nr(e,a,x,null,n,m);for(d in n)if(m=n[d],p=s[d],n.hasOwnProperty(d)&&m!==p&&(null!=m||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(t(137,a));break;default:nr(e,a,d,m,n,p)}return;default:if(oe(a)){for(var g in s)m=s[g],s.hasOwnProperty(g)&&void 0!==m&&!n.hasOwnProperty(g)&&ir(e,a,g,void 0,n,m);for(u in n)m=n[u],p=s[u],!n.hasOwnProperty(u)||m===p||void 0===m&&void 0===p||ir(e,a,u,m,n,p);return}}for(var v in s)m=s[v],s.hasOwnProperty(v)&&null!=m&&!n.hasOwnProperty(v)&&nr(e,a,v,null,n,m);for(h in n)m=n[h],p=s[h],!n.hasOwnProperty(h)||m===p||null==m&&null==p||nr(e,a,h,m,n,p)}(n,e.type,s,a),n[mo]=a}catch(i){Ti(e,e.return,i)}}function Nn(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&hr(e.type)||4===e.tag}function wn(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Nn(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&hr(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function kn(e,t,a){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?(9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).insertBefore(e,t):((t=9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).appendChild(e),null!=(a=a._reactRootContainer)||null!==t.onclick||(t.onclick=sr));else if(4!==s&&(27===s&&hr(e.type)&&(a=e.stateNode,t=null),null!==(e=e.child)))for(kn(e,t,a),e=e.sibling;null!==e;)kn(e,t,a),e=e.sibling}function _n(e,t,a){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==s&&(27===s&&hr(e.type)&&(a=e.stateNode),null!==(e=e.child)))for(_n(e,t,a),e=e.sibling;null!==e;)_n(e,t,a),e=e.sibling}function Sn(e){var t=e.stateNode,a=e.memoizedProps;try{for(var s=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);rr(t,s,a),t[ho]=e,t[mo]=a}catch(i){Ti(e,e.return,i)}}function Cn(e,t,a){var s=a.flags;switch(a.tag){case 0:case 11:case 15:Rn(e,a),4&s&&pn(5,a);break;case 1:if(Rn(e,a),4&s)if(e=a.stateNode,null===t)try{e.componentDidMount()}catch(r){Ti(a,a.return,r)}else{var n=Cs(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){Ti(a,a.return,l)}}64&s&&xn(a),512&s&&vn(a,a.return);break;case 3:if(Rn(e,a),64&s&&null!==(e=a.updateQueue)){if(t=null,null!==a.child)switch(a.child.tag){case 27:case 5:case 1:t=a.child.stateNode}try{Gt(e,t)}catch(r){Ti(a,a.return,r)}}break;case 27:null===t&&4&s&&Sn(a);case 26:case 5:Rn(e,a),null===t&&4&s&&jn(a),512&s&&vn(a,a.return);break;case 12:Rn(e,a);break;case 13:Rn(e,a),4&s&&En(e,a),64&s&&(null!==(e=a.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var a=e.ownerDocument;if("$?"!==e.data||"complete"===a.readyState)t();else{var s=function(){t(),a.removeEventListener("DOMContentLoaded",s)};a.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}(e,a=Fi.bind(null,a))));break;case 22:if(!(s=null!==a.memoizedState||su)){t=null!==t&&null!==t.memoizedState||nu,n=su;var i=nu;su=s,(nu=t)&&!i?On(e,a,!!(8772&a.subtreeFlags)):Rn(e,a),su=n,nu=i}break;case 30:break;default:Rn(e,a)}}function An(e){var t=e.alternate;null!==t&&(e.alternate=null,An(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&P(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Tn(e,t,a){for(a=a.child;null!==a;)Pn(e,t,a),a=a.sibling}function Pn(e,t,a){if(no&&"function"==typeof no.onCommitFiberUnmount)try{no.onCommitFiberUnmount(so,a)}catch(i){}switch(a.tag){case 26:nu||yn(a,t),Tn(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode).parentNode.removeChild(a);break;case 27:nu||yn(a,t);var s=ou,n=cu;hr(a.type)&&(ou=a.stateNode,cu=!1),Tn(e,t,a),yr(a.stateNode),ou=s,cu=n;break;case 5:nu||yn(a,t);case 6:if(s=ou,n=cu,ou=null,Tn(e,t,a),cu=n,null!==(ou=s))if(cu)try{(9===ou.nodeType?ou.body:"HTML"===ou.nodeName?ou.ownerDocument.body:ou).removeChild(a.stateNode)}catch(r){Ti(a,t,r)}else try{ou.removeChild(a.stateNode)}catch(r){Ti(a,t,r)}break;case 18:null!==ou&&(cu?(mr(9===(e=ou).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,a.stateNode),rl(e)):mr(ou,a.stateNode));break;case 4:s=ou,n=cu,ou=a.stateNode.containerInfo,cu=!0,Tn(e,t,a),ou=s,cu=n;break;case 0:case 11:case 14:case 15:nu||fn(2,a,t),nu||fn(4,a,t),Tn(e,t,a);break;case 1:nu||(yn(a,t),"function"==typeof(s=a.stateNode).componentWillUnmount&&gn(a,t,s)),Tn(e,t,a);break;case 21:Tn(e,t,a);break;case 22:nu=(s=nu)||null!==a.memoizedState,Tn(e,t,a),nu=s;break;default:Tn(e,t,a)}}function En(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{rl(e)}catch(a){Ti(t,t.return,a)}}function In(e,a){var s=function(e){switch(e.tag){case 13:case 19:var a=e.stateNode;return null===a&&(a=e.stateNode=new ru),a;case 22:return null===(a=(e=e.stateNode)._retryCache)&&(a=e._retryCache=new ru),a;default:throw Error(t(435,e.tag))}}(e);a.forEach(function(t){var a=$i.bind(null,e,t);s.has(t)||(s.add(t),t.then(a,a))})}function Fn(e,a){var s=a.deletions;if(null!==s)for(var n=0;n<s.length;n++){var i=s[n],r=e,l=a,o=l;e:for(;null!==o;){switch(o.tag){case 27:if(hr(o.type)){ou=o.stateNode,cu=!1;break e}break;case 5:ou=o.stateNode,cu=!1;break e;case 3:case 4:ou=o.stateNode.containerInfo,cu=!0;break e}o=o.return}if(null===ou)throw Error(t(160));Pn(r,l,i),ou=null,cu=!1,null!==(r=i.alternate)&&(r.return=null),i.return=null}if(13878&a.subtreeFlags)for(a=a.child;null!==a;)$n(a,e),a=a.sibling}function $n(e,a){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Fn(a,e),Ln(e),4&n&&(fn(3,e,e.return),pn(3,e),fn(5,e,e.return));break;case 1:Fn(a,e),Ln(e),512&n&&(nu||null===s||yn(s,s.return)),64&n&&su&&(null!==(e=e.updateQueue)&&(null!==(n=e.callbacks)&&(s=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===s?n:s.concat(n))));break;case 26:var i=du;if(Fn(a,e),Ln(e),512&n&&(nu||null===s||yn(s,s.return)),4&n){var r=null!==s?s.memoizedState:null;if(n=e.memoizedState,null===s)if(null===n)if(null===e.stateNode){e:{n=e.type,s=e.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":(!(r=i.getElementsByTagName("title")[0])||r[yo]||r[ho]||"http://www.w3.org/2000/svg"===r.namespaceURI||r.hasAttribute("itemprop"))&&(r=i.createElement(n),i.head.insertBefore(r,i.querySelector("head > title"))),rr(r,n,s),r[ho]=e,L(r),n=r;break e;case"link":var l=Ir("link","href",i).get(n+(s.href||""));if(l)for(var o=0;o<l.length;o++)if((r=l[o]).getAttribute("href")===(null==s.href||""===s.href?null:s.href)&&r.getAttribute("rel")===(null==s.rel?null:s.rel)&&r.getAttribute("title")===(null==s.title?null:s.title)&&r.getAttribute("crossorigin")===(null==s.crossOrigin?null:s.crossOrigin)){l.splice(o,1);break t}rr(r=i.createElement(n),n,s),i.head.appendChild(r);break;case"meta":if(l=Ir("meta","content",i).get(n+(s.content||"")))for(o=0;o<l.length;o++)if((r=l[o]).getAttribute("content")===(null==s.content?null:""+s.content)&&r.getAttribute("name")===(null==s.name?null:s.name)&&r.getAttribute("property")===(null==s.property?null:s.property)&&r.getAttribute("http-equiv")===(null==s.httpEquiv?null:s.httpEquiv)&&r.getAttribute("charset")===(null==s.charSet?null:s.charSet)){l.splice(o,1);break t}rr(r=i.createElement(n),n,s),i.head.appendChild(r);break;default:throw Error(t(468,n))}r[ho]=e,L(r),n=r}e.stateNode=n}else Fr(i,e.type,e.stateNode);else e.stateNode=Ar(i,n,e.memoizedProps);else r!==n?(null===r?null!==s.stateNode&&(s=s.stateNode).parentNode.removeChild(s):r.count--,null===n?Fr(i,e.type,e.stateNode):Ar(i,n,e.memoizedProps)):null===n&&null!==e.stateNode&&bn(e,e.memoizedProps,s.memoizedProps)}break;case 27:Fn(a,e),Ln(e),512&n&&(nu||null===s||yn(s,s.return)),null!==s&&4&n&&bn(e,e.memoizedProps,s.memoizedProps);break;case 5:if(Fn(a,e),Ln(e),512&n&&(nu||null===s||yn(s,s.return)),32&e.flags){i=e.stateNode;try{ie(i,"")}catch(p){Ti(e,e.return,p)}}4&n&&null!=e.stateNode&&bn(e,i=e.memoizedProps,null!==s?s.memoizedProps:i),1024&n&&(iu=!0);break;case 6:if(Fn(a,e),Ln(e),4&n){if(null===e.stateNode)throw Error(t(162));n=e.memoizedProps,s=e.stateNode;try{s.nodeValue=n}catch(p){Ti(e,e.return,p)}}break;case 3:if(gh=null,i=du,du=jr(a.containerInfo),Fn(a,e),du=i,Ln(e),4&n&&null!==s&&s.memoizedState.isDehydrated)try{rl(a.containerInfo)}catch(p){Ti(e,e.return,p)}iu&&(iu=!1,Mn(e));break;case 4:n=du,du=jr(e.stateNode.containerInfo),Fn(a,e),Ln(e),du=n;break;case 12:default:Fn(a,e),Ln(e);break;case 13:Fn(a,e),Ln(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==s&&null!==s.memoizedState)&&(Fu=Vl()),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,In(e,n)));break;case 22:i=null!==e.memoizedState;var c=null!==s&&null!==s.memoizedState,d=su,u=nu;if(su=d||i,nu=u||c,Fn(a,e),nu=u,su=d,Ln(e),8192&n)e:for(a=e.stateNode,a._visibility=i?-2&a._visibility:1|a._visibility,i&&(null===s||c||su||nu||Wn(e)),s=null,a=e;;){if(5===a.tag||26===a.tag){if(null===s){c=s=a;try{if(r=c.stateNode,i)"function"==typeof(l=r.style).setProperty?l.setProperty("display","none","important"):l.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,m=null!=h&&h.hasOwnProperty("display")?h.display:null;o.style.display=null==m||"boolean"==typeof m?"":(""+m).trim()}}catch(p){Ti(c,c.return,p)}}}else if(6===a.tag){if(null===s){c=a;try{c.stateNode.nodeValue=i?"":c.memoizedProps}catch(p){Ti(c,c.return,p)}}}else if((22!==a.tag&&23!==a.tag||null===a.memoizedState||a===e)&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===e)break e;for(;null===a.sibling;){if(null===a.return||a.return===e)break e;s===a&&(s=null),a=a.return}s===a&&(s=null),a.sibling.return=a.return,a=a.sibling}4&n&&(null!==(n=e.updateQueue)&&(null!==(s=n.retryQueue)&&(n.retryQueue=null,In(e,s))));break;case 19:Fn(a,e),Ln(e),4&n&&(null!==(n=e.updateQueue)&&(e.updateQueue=null,In(e,n)));case 30:case 21:}}function Ln(e){var a=e.flags;if(2&a){try{for(var s,n=e.return;null!==n;){if(Nn(n)){s=n;break}n=n.return}if(null==s)throw Error(t(160));switch(s.tag){case 27:var i=s.stateNode;_n(e,wn(e),i);break;case 5:var r=s.stateNode;32&s.flags&&(ie(r,""),s.flags&=-33),_n(e,wn(e),r);break;case 3:case 4:var l=s.stateNode.containerInfo;kn(e,wn(e),l);break;default:throw Error(t(161))}}catch(o){Ti(e,e.return,o)}e.flags&=-3}4096&a&&(e.flags&=-4097)}function Mn(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Mn(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Rn(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Cn(e,t.alternate,t),t=t.sibling}function Wn(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:fn(4,t,t.return),Wn(t);break;case 1:yn(t,t.return);var a=t.stateNode;"function"==typeof a.componentWillUnmount&&gn(t,t.return,a),Wn(t);break;case 27:yr(t.stateNode);case 26:case 5:yn(t,t.return),Wn(t);break;case 22:null===t.memoizedState&&Wn(t);break;default:Wn(t)}e=e.sibling}}function On(e,t,a){for(a=a&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var s=t.alternate,n=e,i=t,r=i.flags;switch(i.tag){case 0:case 11:case 15:On(n,i,a),pn(4,i);break;case 1:if(On(n,i,a),"function"==typeof(n=(s=i).stateNode).componentDidMount)try{n.componentDidMount()}catch(c){Ti(s,s.return,c)}if(null!==(n=(s=i).updateQueue)){var l=s.stateNode;try{var o=n.shared.hiddenCallbacks;if(null!==o)for(n.shared.hiddenCallbacks=null,n=0;n<o.length;n++)Vt(o[n],l)}catch(c){Ti(s,s.return,c)}}a&&64&r&&xn(i),vn(i,i.return);break;case 27:Sn(i);case 26:case 5:On(n,i,a),a&&null===s&&4&r&&jn(i),vn(i,i.return);break;case 12:On(n,i,a);break;case 13:On(n,i,a),a&&4&r&&En(n,i);break;case 22:null===i.memoizedState&&On(n,i,a),vn(i,i.return);break;case 30:break;default:On(n,i,a)}t=t.sibling}}function Dn(e,t){var a=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==a&&(null!=e&&e.refCount++,null!=a&&Pt(a))}function Un(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Pt(e))}function Bn(e,t,a,s){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)zn(e,t,a,s),t=t.sibling}function zn(e,t,a,s){var n=t.flags;switch(t.tag){case 0:case 11:case 15:Bn(e,t,a,s),2048&n&&pn(9,t);break;case 1:case 13:default:Bn(e,t,a,s);break;case 3:Bn(e,t,a,s),2048&n&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Pt(e)));break;case 12:if(2048&n){Bn(e,t,a,s),e=t.stateNode;try{var i=t.memoizedProps,r=i.id,l=i.onPostCommit;"function"==typeof l&&l(r,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(o){Ti(t,t.return,o)}}else Bn(e,t,a,s);break;case 23:break;case 22:i=t.stateNode,r=t.alternate,null!==t.memoizedState?2&i._visibility?Bn(e,t,a,s):Hn(e,t):2&i._visibility?Bn(e,t,a,s):(i._visibility|=2,Xn(e,t,a,s,!!(10256&t.subtreeFlags))),2048&n&&Dn(r,t);break;case 24:Bn(e,t,a,s),2048&n&&Un(t.alternate,t)}}function Xn(e,t,a,s,n){for(n=n&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,r=t,l=a,o=s,c=r.flags;switch(r.tag){case 0:case 11:case 15:Xn(i,r,l,o,n),pn(8,r);break;case 23:break;case 22:var d=r.stateNode;null!==r.memoizedState?2&d._visibility?Xn(i,r,l,o,n):Hn(i,r):(d._visibility|=2,Xn(i,r,l,o,n)),n&&2048&c&&Dn(r.alternate,r);break;case 24:Xn(i,r,l,o,n),n&&2048&c&&Un(r.alternate,r);break;default:Xn(i,r,l,o,n)}t=t.sibling}}function Hn(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var a=e,s=t,n=s.flags;switch(s.tag){case 22:Hn(a,s),2048&n&&Dn(s.alternate,s);break;case 24:Hn(a,s),2048&n&&Un(s.alternate,s);break;default:Hn(a,s)}t=t.sibling}}function qn(e){if(e.subtreeFlags&uu)for(e=e.child;null!==e;)Jn(e),e=e.sibling}function Jn(e){switch(e.tag){case 26:qn(e),e.flags&uu&&null!==e.memoizedState&&function(e,a,s){if(null===vh)throw Error(t(475));var n=vh;if(!("stylesheet"!==a.type||"string"==typeof s.media&&!1===matchMedia(s.media).matches||4&a.state.loading)){if(null===a.instance){var i=wr(s.href),r=e.querySelector(kr(i));if(r)return null!==(e=r._p)&&"object"==typeof e&&"function"==typeof e.then&&(n.count++,n=Mr.bind(n),e.then(n,n)),a.state.loading|=4,a.instance=r,void L(r);r=e.ownerDocument||e,s=_r(s),(i=mh.get(i))&&Pr(s,i),L(r=r.createElement("link"));var l=r;l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),rr(r,"link",s),a.instance=r}null===n.stylesheets&&(n.stylesheets=new Map),n.stylesheets.set(a,e),(e=a.state.preload)&&!(3&a.state.loading)&&(n.count++,a=Mr.bind(n),e.addEventListener("load",a),e.addEventListener("error",a))}}(du,e.memoizedState,e.memoizedProps);break;case 5:default:qn(e);break;case 3:case 4:var a=du;du=jr(e.stateNode.containerInfo),qn(e),du=a;break;case 22:null===e.memoizedState&&(null!==(a=e.alternate)&&null!==a.memoizedState?(a=uu,uu=16777216,qn(e),uu=a):qn(e))}}function Vn(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Gn(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var a=0;a<t.length;a++){var s=t[a];lu=s,Qn(s,e)}Vn(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Kn(e),e=e.sibling}function Kn(e){switch(e.tag){case 0:case 11:case 15:Gn(e),2048&e.flags&&fn(9,e,e.return);break;case 3:case 12:default:Gn(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Yn(e)):Gn(e)}}function Yn(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var a=0;a<t.length;a++){var s=t[a];lu=s,Qn(s,e)}Vn(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:fn(8,t,t.return),Yn(t);break;case 22:2&(a=t.stateNode)._visibility&&(a._visibility&=-3,Yn(t));break;default:Yn(t)}e=e.sibling}}function Qn(e,t){for(;null!==lu;){var a=lu;switch(a.tag){case 0:case 11:case 15:fn(8,a,t);break;case 23:case 22:if(null!==a.memoizedState&&null!==a.memoizedState.cachePool){var s=a.memoizedState.cachePool.pool;null!=s&&s.refCount++}break;case 24:Pt(a.memoizedState.cache)}if(null!==(s=a.child))s.return=a,lu=s;else e:for(a=e;null!==lu;){var n=(s=lu).sibling,i=s.return;if(An(s),s===a){lu=null;break e}if(null!==n){n.return=i,lu=n;break e}lu=i}}}function Zn(){if(2&pu&&0!==gu)return gu&-gu;if(null!==$l.T){return 0!==gd?gd:Bi()}return T()}function ei(){0===Au&&(Au=536870912&gu&&!nd?536870912:b());var e=Gd.current;return null!==e&&(e.flags|=32),Au}function ti(e,t,a){(e!==fu||2!==vu&&9!==vu)&&null===e.cancelPendingCommit||(oi(e,0),ii(e,gu,Au,!1)),k(e,a),2&pu&&e===fu||(e===fu&&(!(2&pu)&&(Su|=a),4===ku&&ii(e,gu,Au,!1)),Li(e))}function ai(e,a,s){if(6&pu)throw Error(t(327));for(var n=!s&&!(124&a)&&0===(a&e.expiredLanes)||y(e,a),i=n?function(e,a){var s=pu;pu|=2;var n=di(),i=ui();fu!==e||gu!==a?(Lu=null,$u=Vl()+500,oi(e,a)):bu=y(e,a);e:for(;;)try{if(0!==vu&&null!==xu){a=xu;var r=yu;t:switch(vu){case 1:vu=0,yu=null,vi(e,a,r,1);break;case 2:case 9:if(Lt(r)){vu=0,yu=null,gi(a);break}a=function(){2!==vu&&9!==vu||fu!==e||(vu=7),Li(e)},r.then(a,a);break e;case 3:vu=7;break e;case 4:vu=5;break e;case 7:Lt(r)?(vu=0,yu=null,gi(a)):(vu=0,yu=null,vi(e,a,r,7));break;case 5:var l=null;switch(xu.tag){case 26:l=xu.memoizedState;case 5:case 27:var o=xu;if(!l||$r(l)){vu=0,yu=null;var c=o.sibling;if(null!==c)xu=c;else{var d=o.return;null!==d?(xu=d,yi(d)):xu=null}break t}}vu=0,yu=null,vi(e,a,r,5);break;case 6:vu=0,yu=null,vi(e,a,r,6);break;case 8:li(),ku=6;break e;default:throw Error(t(462))}}fi();break}catch(u){ci(e,u)}return dd=cd=null,$l.H=n,$l.A=i,pu=s,null!==xu?0:(fu=null,gu=0,Je(),ku)}(e,a):mi(e,a,!0),r=n;;){if(0===i){bu&&!n&&ii(e,a,0,!1);break}if(s=e.current.alternate,!r||ni(s)){if(2===i){if(r=a,e.errorRecoveryDisabledLanes&r)var l=0;else l=0!==(l=-536870913&e.pendingLanes)?l:536870912&l?536870912:0;if(0!==l){a=l;e:{var o=e;i=Pu;var c=o.current.memoizedState.isDehydrated;if(c&&(oi(o,l).flags|=256),2!==(l=mi(o,l,!1))){if(Nu&&!c){o.errorRecoveryDisabledLanes|=r,Su|=r,i=4;break e}r=Eu,Eu=i,null!==r&&(null===Eu?Eu=r:Eu.push.apply(Eu,r))}i=l}if(r=!1,2!==i)continue}}if(1===i){oi(e,0),ii(e,a,0,!0);break}e:{switch(n=e,r=i){case 0:case 1:throw Error(t(345));case 4:if((4194048&a)!==a)break;case 6:ii(n,a,Au,!ju);break e;case 2:Eu=null;break;case 3:case 5:break;default:throw Error(t(329))}if((62914560&a)===a&&10<(i=Fu+300-Vl())){if(ii(n,a,Au,!ju),0!==v(n,0,!0))break e;n.timeoutHandle=oh(si.bind(null,n,s,Eu,Lu,Iu,a,Au,Su,Tu,ju,r,2,-0,0),i)}else si(n,s,Eu,Lu,Iu,a,Au,Su,Tu,ju,r,0,-0,0)}break}i=mi(e,a,!1),r=!1}Li(e)}function si(e,a,s,n,i,r,l,o,c,d,u,h,m,p){if(e.timeoutHandle=-1,(8192&(h=a.subtreeFlags)||!(16785408&~h))&&(vh={stylesheets:null,count:0,unsuspend:Lr},Jn(a),null!==(h=function(){if(null===vh)throw Error(t(475));var e=vh;return e.stylesheets&&0===e.count&&Rr(e,e.stylesheets),0<e.count?function(t){var a=setTimeout(function(){if(e.stylesheets&&Rr(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(a)}}:null}())))return e.cancelPendingCommit=h(bi.bind(null,e,a,r,s,n,i,l,o,c,u,1,m,p)),void ii(e,r,l,!d);bi(e,a,r,s,n,i,l,o,c)}function ni(e){for(var t=e;;){var a=t.tag;if((0===a||11===a||15===a)&&16384&t.flags&&(null!==(a=t.updateQueue)&&null!==(a=a.stores)))for(var s=0;s<a.length;s++){var n=a[s],i=n.getSnapshot;n=n.value;try{if(!kc(i(),n))return!1}catch(r){return!1}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ii(e,t,a,s){t&=~Cu,t&=~Su,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var n=t;0<n;){var i=31-io(n),r=1<<i;s[i]=-1,n&=~r}0!==a&&_(e,a,t)}function ri(){return!!(6&pu)||(Mi(0),!1)}function li(){if(null!==xu){if(0===vu)var e=xu.return;else dd=cd=null,la(e=xu),Hd=null,qd=0,e=xu;for(;null!==e;)mn(e.alternate,e),e=e.return;xu=null}}function oi(e,t){var a=e.timeoutHandle;-1!==a&&(e.timeoutHandle=-1,ch(a)),null!==(a=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,a()),li(),fu=e,xu=a=at(e.current,null),gu=t,vu=0,yu=null,ju=!1,bu=y(e,t),Nu=!1,Tu=Au=Cu=Su=_u=ku=0,Eu=Pu=null,Iu=!1,8&t&&(t|=32&t);var s=e.entangledLanes;if(0!==s)for(e=e.entanglements,s&=t;0<s;){var n=31-io(s),i=1<<n;t|=e[n],s&=~i}return wu=t,Je(),a}function ci(e,t){Ed=null,$l.H=Ud,t===bd||t===wd?(t=Wt(),vu=3):t===Nd?(t=Wt(),vu=4):vu=t===eu?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,yu=t,null===xu&&(ku=1,Es(e,qe(t,e.current)))}function di(){var e=$l.H;return $l.H=Ud,null===e?Ud:e}function ui(){var e=$l.A;return $l.A=hu,e}function hi(){ku=4,ju||(4194048&gu)!==gu&&null!==Gd.current||(bu=!0),!(134217727&_u)&&!(134217727&Su)||null===fu||ii(fu,gu,Au,!1)}function mi(e,t,a){var s=pu;pu|=2;var n=di(),i=ui();fu===e&&gu===t||(Lu=null,oi(e,t)),t=!1;var r=ku;e:for(;;)try{if(0!==vu&&null!==xu){var l=xu,o=yu;switch(vu){case 8:li(),r=6;break e;case 3:case 2:case 9:case 6:null===Gd.current&&(t=!0);var c=vu;if(vu=0,yu=null,vi(e,l,o,c),a&&bu){r=0;break e}break;default:c=vu,vu=0,yu=null,vi(e,l,o,c)}}pi(),r=ku;break}catch(d){ci(e,d)}return t&&e.shellSuspendCounter++,dd=cd=null,pu=s,$l.H=n,$l.A=i,null===xu&&(fu=null,gu=0,Je()),r}function pi(){for(;null!==xu;)xi(xu)}function fi(){for(;null!==xu&&!ql();)xi(xu)}function xi(e){var t=nn(e.alternate,e,wu);e.memoizedProps=e.pendingProps,null===t?yi(e):xu=t}function gi(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Xs(a,t,t.pendingProps,t.type,void 0,gu);break;case 11:t=Xs(a,t,t.pendingProps,t.type.render,t.ref,gu);break;case 5:la(t);default:mn(a,t),t=nn(a,t=xu=st(t,wu),wu)}e.memoizedProps=e.pendingProps,null===t?yi(e):xu=t}function vi(e,a,s,n){dd=cd=null,la(a),Hd=null,qd=0;var i=a.return;try{if(function(e,a,s,n,i){if(s.flags|=32768,null!==n&&"object"==typeof n&&"function"==typeof n.then){if(null!==(a=s.alternate)&&wt(a,s,i,!0),null!==(s=Gd.current)){switch(s.tag){case 13:return null===Kd?hi():null===s.alternate&&0===ku&&(ku=3),s.flags&=-257,s.flags|=65536,s.lanes=i,n===kd?s.flags|=16384:(null===(a=s.updateQueue)?s.updateQueue=new Set([n]):a.add(n),Pi(e,n,i)),!1;case 22:return s.flags|=65536,n===kd?s.flags|=16384:(null===(a=s.updateQueue)?(a={transitions:null,markerInstances:null,retryQueue:new Set([n])},s.updateQueue=a):null===(s=a.retryQueue)?a.retryQueue=new Set([n]):s.add(n),Pi(e,n,i)),!1}throw Error(t(435,s.tag))}return Pi(e,n,i),hi(),!1}if(nd)return null!==(a=Gd.current)?(!(65536&a.flags)&&(a.flags|=256),a.flags|=65536,a.lanes=i,n!==ld&&vt(qe(e=Error(t(422),{cause:n}),s))):(n!==ld&&vt(qe(a=Error(t(423),{cause:n}),s)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,n=qe(n,s),Ht(e,i=Fs(e.stateNode,n,i)),4!==ku&&(ku=2)),!1;var r=Error(t(520),{cause:n});if(r=qe(r,s),null===Pu?Pu=[r]:Pu.push(r),4!==ku&&(ku=2),null===a)return!0;n=qe(n,s),s=a;do{switch(s.tag){case 3:return s.flags|=65536,e=i&-i,s.lanes|=e,Ht(s,e=Fs(s.stateNode,n,e)),!1;case 1:if(a=s.type,r=s.stateNode,!(128&s.flags||"function"!=typeof a.getDerivedStateFromError&&(null===r||"function"!=typeof r.componentDidCatch||null!==Mu&&Mu.has(r))))return s.flags|=65536,i&=-i,s.lanes|=i,Ls(i=$s(i),e,s,n),Ht(s,i),!1}s=s.return}while(null!==s);return!1}(e,i,a,s,gu))return ku=1,Es(e,qe(s,e.current)),void(xu=null)}catch(r){if(null!==i)throw xu=i,r;return ku=1,Es(e,qe(s,e.current)),void(xu=null)}32768&a.flags?(nd||1===n?e=!0:bu||536870912&gu?e=!1:(ju=e=!0,(2===n||9===n||3===n||6===n)&&(null!==(n=Gd.current)&&13===n.tag&&(n.flags|=16384))),ji(a,e)):yi(a)}function yi(e){var t=e;do{if(32768&t.flags)return void ji(t,ju);e=t.return;var a=un(t.alternate,t,wu);if(null!==a)return void(xu=a);if(null!==(t=t.sibling))return void(xu=t);xu=t=e}while(null!==t);0===ku&&(ku=5)}function ji(e,t){do{var a=hn(e.alternate,e);if(null!==a)return a.flags&=32767,void(xu=a);if(null!==(a=e.return)&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&null!==(e=e.sibling))return void(xu=e);xu=e=a}while(null!==e);ku=6,xu=null}function bi(e,a,s,n,i,r,l,o,c){e.cancelPendingCommit=null;do{Si()}while(0!==Ru);if(6&pu)throw Error(t(327));if(null!==a){if(a===e.current)throw Error(t(177));if(r=a.lanes|a.childLanes,function(e,t,a,s,n,i){var r=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var l=e.entanglements,o=e.expirationTimes,c=e.hiddenUpdates;for(a=r&~a;0<a;){var d=31-io(a),u=1<<d;l[d]=0,o[d]=-1;var h=c[d];if(null!==h)for(c[d]=null,d=0;d<h.length;d++){var m=h[d];null!==m&&(m.lane&=-536870913)}a&=~u}0!==s&&_(e,s,0),0!==i&&0===n&&0!==e.tag&&(e.suspendedLanes|=i&~(r&~t))}(e,s,r|=Hc,l,o,c),e===fu&&(xu=fu=null,gu=0),Ou=a,Wu=e,Du=s,Uu=r,Bu=i,zu=n,10256&a.subtreeFlags||10256&a.flags?(e.callbackNode=null,e.callbackPriority=0,Xl(Ql,function(){return Ci(),null})):(e.callbackNode=null,e.callbackPriority=0),n=!!(13878&a.flags),13878&a.subtreeFlags||n){n=$l.T,$l.T=null,i=Ll.p,Ll.p=2,l=pu,pu|=4;try{!function(e,a){if(e=e.containerInfo,ih=bh,Ue(e=De(e))){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(n&&0!==n.rangeCount){s=n.anchorNode;var i=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{s.nodeType,r.nodeType}catch(x){s=null;break e}var l=0,o=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var p;h!==s||0!==i&&3!==h.nodeType||(o=l+i),h!==r||0!==n&&3!==h.nodeType||(c=l+n),3===h.nodeType&&(l+=h.nodeValue.length),null!==(p=h.firstChild);)m=h,h=p;for(;;){if(h===e)break t;if(m===s&&++d===i&&(o=l),m===r&&++u===n&&(c=l),null!==(p=h.nextSibling))break;m=(h=m).parentNode}h=p}s=-1===o||-1===c?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(rh={focusedElem:e,selectionRange:s},bh=!1,lu=a;null!==lu;)if(e=(a=lu).child,1024&a.subtreeFlags&&null!==e)e.return=a,lu=e;else for(;null!==lu;){switch(r=(a=lu).alternate,e=a.flags,a.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==r){e=void 0,s=a,i=r.memoizedProps,r=r.memoizedState,n=s.stateNode;try{var f=Cs(s.type,i,(s.elementType,s.type));e=n.getSnapshotBeforeUpdate(f,r),n.__reactInternalSnapshotBeforeUpdate=e}catch(g){Ti(s,s.return,g)}}break;case 3:if(1024&e)if(9===(s=(e=a.stateNode.containerInfo).nodeType))pr(e);else if(1===s)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":pr(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(t(163))}if(null!==(e=a.sibling)){e.return=a.return,lu=e;break}lu=a.return}}(e,a)}finally{pu=l,Ll.p=i,$l.T=n}}Ru=1,Ni(),wi(),ki()}}function Ni(){if(1===Ru){Ru=0;var e=Wu,t=Ou,a=!!(13878&t.flags);if(13878&t.subtreeFlags||a){a=$l.T,$l.T=null;var s=Ll.p;Ll.p=2;var n=pu;pu|=4;try{$n(t,e);var i=rh,r=De(e.containerInfo),l=i.focusedElem,o=i.selectionRange;if(r!==l&&l&&l.ownerDocument&&Oe(l.ownerDocument.documentElement,l)){if(null!==o&&Ue(l)){var c=o.start,d=o.end;if(void 0===d&&(d=c),"selectionStart"in l)l.selectionStart=c,l.selectionEnd=Math.min(d,l.value.length);else{var u=l.ownerDocument||document,h=u&&u.defaultView||window;if(h.getSelection){var m=h.getSelection(),p=l.textContent.length,f=Math.min(o.start,p),x=void 0===o.end?f:Math.min(o.end,p);!m.extend&&f>x&&(r=x,x=f,f=r);var g=We(l,f),v=We(l,x);if(g&&v&&(1!==m.rangeCount||m.anchorNode!==g.node||m.anchorOffset!==g.offset||m.focusNode!==v.node||m.focusOffset!==v.offset)){var y=u.createRange();y.setStart(g.node,g.offset),m.removeAllRanges(),f>x?(m.addRange(y),m.extend(v.node,v.offset)):(y.setEnd(v.node,v.offset),m.addRange(y))}}}}for(u=[],m=l;m=m.parentNode;)1===m.nodeType&&u.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"==typeof l.focus&&l.focus(),l=0;l<u.length;l++){var j=u[l];j.element.scrollLeft=j.left,j.element.scrollTop=j.top}}bh=!!ih,rh=ih=null}finally{pu=n,Ll.p=s,$l.T=a}}e.current=t,Ru=2}}function wi(){if(2===Ru){Ru=0;var e=Wu,t=Ou,a=!!(8772&t.flags);if(8772&t.subtreeFlags||a){a=$l.T,$l.T=null;var s=Ll.p;Ll.p=2;var n=pu;pu|=4;try{Cn(e,t.alternate,t)}finally{pu=n,Ll.p=s,$l.T=a}}Ru=3}}function ki(){if(4===Ru||3===Ru){Ru=0,Jl();var e=Wu,t=Ou,a=Du,s=zu;10256&t.subtreeFlags||10256&t.flags?Ru=5:(Ru=0,Ou=Wu=null,_i(e,e.pendingLanes));var n=e.pendingLanes;if(0===n&&(Mu=null),A(a),t=t.stateNode,no&&"function"==typeof no.onCommitFiberRoot)try{no.onCommitFiberRoot(so,t,void 0,!(128&~t.current.flags))}catch(o){}if(null!==s){t=$l.T,n=Ll.p,Ll.p=2,$l.T=null;try{for(var i=e.onRecoverableError,r=0;r<s.length;r++){var l=s[r];i(l.value,{componentStack:l.stack})}}finally{$l.T=t,Ll.p=n}}3&Du&&Si(),Li(e),n=e.pendingLanes,4194090&a&&42&n?e===Hu?Xu++:(Xu=0,Hu=e):Xu=0,Mi(0)}}function _i(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Pt(t)))}function Si(){return Ni(),wi(),ki(),Ci()}function Ci(){if(5!==Ru)return!1;var e=Wu,a=Uu;Uu=0;var s=A(Du),n=$l.T,i=Ll.p;try{Ll.p=32>s?32:s,$l.T=null,s=Bu,Bu=null;var r=Wu,l=Du;if(Ru=0,Ou=Wu=null,Du=0,6&pu)throw Error(t(331));var o=pu;if(pu|=4,Kn(r.current),zn(r,r.current,l,s),pu=o,Mi(0,!1),no&&"function"==typeof no.onPostCommitFiberRoot)try{no.onPostCommitFiberRoot(so,r)}catch(c){}return!0}finally{Ll.p=i,$l.T=n,_i(e,a)}}function Ai(e,t,a){t=qe(a,t),null!==(e=zt(e,t=Fs(e.stateNode,t,2),2))&&(k(e,2),Li(e))}function Ti(e,t,a){if(3===e.tag)Ai(e,e,a);else for(;null!==t;){if(3===t.tag){Ai(t,e,a);break}if(1===t.tag){var s=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof s.componentDidCatch&&(null===Mu||!Mu.has(s))){e=qe(a,e),null!==(s=zt(t,a=$s(2),2))&&(Ls(a,s,t,e),k(s,2),Li(s));break}}t=t.return}}function Pi(e,t,a){var s=e.pingCache;if(null===s){s=e.pingCache=new mu;var n=new Set;s.set(t,n)}else void 0===(n=s.get(t))&&(n=new Set,s.set(t,n));n.has(a)||(Nu=!0,n.add(a),e=Ei.bind(null,e,t,a),t.then(e,e))}function Ei(e,t,a){var s=e.pingCache;null!==s&&s.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,fu===e&&(gu&a)===a&&(4===ku||3===ku&&(62914560&gu)===gu&&300>Vl()-Fu?!(2&pu)&&oi(e,0):Cu|=a,Tu===gu&&(Tu=0)),Li(e)}function Ii(e,t){0===t&&(t=N()),null!==(e=Ke(e,t))&&(k(e,t),Li(e))}function Fi(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),Ii(e,a)}function $i(e,a){var s=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(s=i.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode._retryCache;break;default:throw Error(t(314))}null!==n&&n.delete(a),Ii(e,s)}function Li(e){e!==Ju&&null===e.next&&(null===Ju?qu=Ju=e:Ju=Ju.next=e),Gu=!0,Vu||(Vu=!0,uh(function(){6&pu?Xl(Kl,Ri):Wi()}))}function Mi(e){if(!Ku&&Gu){Ku=!0;do{for(var t=!1,a=qu;null!==a;){if(0!==e){var s=a.pendingLanes;if(0===s)var n=0;else{var i=a.suspendedLanes,r=a.pingedLanes;n=(1<<31-io(42|e)+1)-1,n=201326741&(n&=s&~(i&~r))?201326741&n|1:n?2|n:0}0!==n&&(t=!0,Ui(a,n))}else n=gu,!(3&(n=v(a,a===fu?n:0,null!==a.cancelPendingCommit||-1!==a.timeoutHandle)))||y(a,n)||(t=!0,Ui(a,n));a=a.next}}while(t);Ku=!1}}function Ri(){Wi()}function Wi(){Gu=Vu=!1;var e=0;0!==Yu&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==lh&&(lh=e,!0);return lh=null,!1}()&&(e=Yu),Yu=0);for(var t=Vl(),a=null,s=qu;null!==s;){var n=s.next,i=Oi(s,t);0===i?(s.next=null,null===a?qu=n:a.next=n,null===n&&(Ju=a)):(a=s,(0!==e||3&i)&&(Gu=!0)),s=n}Mi(e)}function Oi(e,t){for(var a=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var r=31-io(i),l=1<<r,o=n[r];-1===o?0!==(l&a)&&0===(l&s)||(n[r]=j(l,t)):o<=t&&(e.expiredLanes|=l),i&=~l}if(a=gu,a=v(e,e===(t=fu)?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),s=e.callbackNode,0===a||e===t&&(2===vu||9===vu)||null!==e.cancelPendingCommit)return null!==s&&null!==s&&Hl(s),e.callbackNode=null,e.callbackPriority=0;if(!(3&a)||y(e,a)){if((t=a&-a)===e.callbackPriority)return t;switch(null!==s&&Hl(s),A(a)){case 2:case 8:a=Yl;break;case 32:default:a=Ql;break;case 268435456:a=eo}return s=Di.bind(null,e),a=Xl(a,s),e.callbackPriority=t,e.callbackNode=a,t}return null!==s&&null!==s&&Hl(s),e.callbackPriority=2,e.callbackNode=null,2}function Di(e,t){if(0!==Ru&&5!==Ru)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(Si()&&e.callbackNode!==a)return null;var s=gu;return 0===(s=v(e,e===fu?s:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(ai(e,s,t),Oi(e,Vl()),null!=e.callbackNode&&e.callbackNode===a?Di.bind(null,e):null)}function Ui(e,t){if(Si())return null;ai(e,t,!0)}function Bi(){return 0===Yu&&(Yu=b()),Yu}function zi(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:ce(""+e)}function Xi(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}function Hi(e,t){t=!!(4&t);for(var a=0;a<e.length;a++){var s=e[a],n=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var r=s.length-1;0<=r;r--){var l=s[r],o=l.instance,c=l.currentTarget;if(l=l.listener,o!==i&&n.isPropagationStopped())break e;i=l,n.currentTarget=c;try{i(n)}catch(d){Zd(d)}n.currentTarget=null,i=o}else for(r=0;r<s.length;r++){if(o=(l=s[r]).instance,c=l.currentTarget,l=l.listener,o!==i&&n.isPropagationStopped())break e;i=l,n.currentTarget=c;try{i(n)}catch(d){Zd(d)}n.currentTarget=null,i=o}}}}function qi(e,t){var a=t[fo];void 0===a&&(a=t[fo]=new Set);var s=e+"__bubble";a.has(s)||(Gi(t,e,2,!1),a.add(s))}function Ji(e,t,a){var s=0;t&&(s|=4),Gi(a,e,s,t)}function Vi(e){if(!e[ah]){e[ah]=!0,jo.forEach(function(t){"selectionchange"!==t&&(th.has(t)||Ji(t,!1,e),Ji(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[ah]||(t[ah]=!0,Ji("selectionchange",!1,t))}}function Gi(e,t,a,s){switch(Yr(t)){case 2:var n=qr;break;case 8:n=Jr;break;default:n=Vr}a=n.bind(null,t,a,e),n=void 0,!Lo||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),s?void 0!==n?e.addEventListener(t,a,{capture:!0,passive:n}):e.addEventListener(t,a,!0):void 0!==n?e.addEventListener(t,a,{passive:n}):e.addEventListener(t,a,!1)}function Ki(e,t,a,n,i){var r=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var l=n.tag;if(3===l||4===l){var o=n.stateNode.containerInfo;if(o===i)break;if(4===l)for(l=n.return;null!==l;){var c=l.tag;if((3===c||4===c)&&l.stateNode.containerInfo===i)return;l=l.return}for(;null!==o;){if(null===(l=E(o)))return;if(5===(c=l.tag)||6===c||26===c||27===c){n=r=l;continue e}o=o.parentNode}}n=n.return}he(function(){var n=r,i=de(a),l=[];e:{var o=Dc.get(e);if(void 0!==o){var c=Xo,d=e;switch(e){case"keypress":if(0===fe(a))break e;case"keydown":case"keyup":c=sc;break;case"focusin":d="focus",c=Ko;break;case"focusout":d="blur",c=Ko;break;case"beforeblur":case"afterblur":c=Ko;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=Vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=Go;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=ic;break;case Fc:case $c:case Lc:c=Yo;break;case Oc:c=rc;break;case"scroll":case"scrollend":c=qo;break;case"wheel":c=lc;break;case"copy":case"cut":case"paste":c=Qo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=nc;break;case"toggle":case"beforetoggle":c=oc}var u=!!(4&t),h=!u&&("scroll"===e||"scrollend"===e),m=u?null!==o?o+"Capture":null:o;u=[];for(var p,f=n;null!==f;){var x=f;if(p=x.stateNode,5!==(x=x.tag)&&26!==x&&27!==x||null===p||null===m||null!=(x=me(f,m))&&u.push(Yi(f,x,p)),h)break;f=f.return}0<u.length&&(o=new c(o,d,null,a,i),l.push({event:o,listeners:u}))}}if(!(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||a===Po||!(d=a.relatedTarget||a.fromElement)||!E(d)&&!d[po])&&(c||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,c?(c=n,null!==(d=(d=a.relatedTarget||a.toElement)?E(d):null)&&(h=s(d),u=d.tag,d!==h||5!==u&&27!==u&&6!==u)&&(d=null)):(c=null,d=n),c!==d)){if(u=Vo,x="onMouseLeave",m="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=nc,x="onPointerLeave",m="onPointerEnter",f="pointer"),h=null==c?o:F(c),p=null==d?o:F(d),(o=new u(x,f+"leave",c,a,i)).target=h,o.relatedTarget=p,x=null,E(i)===n&&((u=new u(m,f+"enter",d,a,i)).target=p,u.relatedTarget=h,x=u),h=x,c&&d)e:{for(m=d,f=0,p=u=c;p;p=Zi(p))f++;for(p=0,x=m;x;x=Zi(x))p++;for(;0<f-p;)u=Zi(u),f--;for(;0<p-f;)m=Zi(m),p--;for(;f--;){if(u===m||null!==m&&u===m.alternate)break e;u=Zi(u),m=Zi(m)}u=null}else u=null;null!==c&&er(l,o,c,u,!1),null!==d&&null!==h&&er(l,h,d,u,!0)}if("select"===(c=(o=n?F(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===c&&"file"===o.type)var g=Te;else if(ke(o))if(jc)g=Le;else{g=Fe;var v=Ie}else!(c=o.nodeName)||"input"!==c.toLowerCase()||"checkbox"!==o.type&&"radio"!==o.type?n&&oe(n.elementType)&&(g=Te):g=$e;switch(g&&(g=g(e,n))?_e(l,g,a,i):(v&&v(e,o,n),"focusout"===e&&n&&"number"===o.type&&null!=n.memoizedProps.value&&te(o,"number",o.value)),v=n?F(n):window,e){case"focusin":(ke(v)||"true"===v.contentEditable)&&(Sc=v,Cc=n,Ac=null);break;case"focusout":Ac=Cc=Sc=null;break;case"mousedown":Tc=!0;break;case"contextmenu":case"mouseup":case"dragend":Tc=!1,Be(l,a,i);break;case"selectionchange":if(_c)break;case"keydown":case"keyup":Be(l,a,i)}var y;if(dc)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else xc?be(e,a)&&(j="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(j="onCompositionStart");j&&(mc&&"ko"!==a.locale&&(xc||"onCompositionStart"!==j?"onCompositionEnd"===j&&xc&&(y=pe()):(Uo="value"in(Do=i)?Do.value:Do.textContent,xc=!0)),0<(v=Qi(n,j)).length&&(j=new Zo(j,e,null,a,i),l.push({event:j,listeners:v}),y?j.data=y:null!==(y=we(a))&&(j.data=y))),(y=hc?function(e,t){switch(e){case"compositionend":return we(t);case"keypress":return 32!==t.which?null:(fc=!0,pc);case"textInput":return(e=t.data)===pc&&fc?null:e;default:return null}}(e,a):function(e,t){if(xc)return"compositionend"===e||!dc&&be(e,t)?(e=pe(),Bo=Uo=Do=null,xc=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return mc&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(j=Qi(n,"onBeforeInput")).length&&(v=new Zo("onBeforeInput","beforeinput",null,a,i),l.push({event:v,listeners:j}),v.data=y)),function(e,t,a,s,n){if("submit"===t&&a&&a.stateNode===n){var i=zi((n[mo]||null).action),r=s.submitter;r&&null!==(t=(t=r[mo]||null)?zi(t.formAction):r.getAttribute("formAction"))&&(i=t,r=null);var l=new Xo("action","action",null,s,n);e.push({event:l,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(0!==Yu){var e=r?Xi(n,r):new FormData(n);es(a,{pending:!0,data:e,method:n.method,action:i},null,e)}}else"function"==typeof i&&(l.preventDefault(),e=r?Xi(n,r):new FormData(n),es(a,{pending:!0,data:e,method:n.method,action:i},i,e))},currentTarget:n}]})}}(l,e,n,a,i)}Hi(l,t)})}function Yi(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Qi(e,t){for(var a=t+"Capture",s=[];null!==e;){var n=e,i=n.stateNode;if(5!==(n=n.tag)&&26!==n&&27!==n||null===i||(null!=(n=me(e,a))&&s.unshift(Yi(e,n,i)),null!=(n=me(e,t))&&s.push(Yi(e,n,i))),3===e.tag)return s;e=e.return}return[]}function Zi(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function er(e,t,a,s,n){for(var i=t._reactName,r=[];null!==a&&a!==s;){var l=a,o=l.alternate,c=l.stateNode;if(l=l.tag,null!==o&&o===s)break;5!==l&&26!==l&&27!==l||null===c||(o=c,n?null!=(c=me(a,i))&&r.unshift(Yi(a,c,o)):n||null!=(c=me(a,i))&&r.push(Yi(a,c,o))),a=a.return}0!==r.length&&e.push({event:t,listeners:r})}function tr(e){return("string"==typeof e?e:""+e).replace(sh,"\n").replace(nh,"")}function ar(e,t){return t=tr(t),tr(e)===t}function sr(){}function nr(e,a,s,n,i,r){switch(s){case"children":"string"==typeof n?"body"===a||"textarea"===a&&""===n||ie(e,n):("number"==typeof n||"bigint"==typeof n)&&"body"!==a&&ie(e,""+n);break;case"className":U(e,"class",n);break;case"tabIndex":U(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":U(e,s,n);break;case"style":le(e,n,r);break;case"data":if("object"!==a){U(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==a||"href"!==s)){e.removeAttribute(s);break}if(null==n||"function"==typeof n||"symbol"==typeof n||"boolean"==typeof n){e.removeAttribute(s);break}n=ce(""+n),e.setAttribute(s,n);break;case"action":case"formAction":if("function"==typeof n){e.setAttribute(s,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof r&&("formAction"===s?("input"!==a&&nr(e,a,"name",i.name,i,null),nr(e,a,"formEncType",i.formEncType,i,null),nr(e,a,"formMethod",i.formMethod,i,null),nr(e,a,"formTarget",i.formTarget,i,null)):(nr(e,a,"encType",i.encType,i,null),nr(e,a,"method",i.method,i,null),nr(e,a,"target",i.target,i,null))),null==n||"symbol"==typeof n||"boolean"==typeof n){e.removeAttribute(s);break}n=ce(""+n),e.setAttribute(s,n);break;case"onClick":null!=n&&(e.onclick=sr);break;case"onScroll":null!=n&&qi("scroll",e);break;case"onScrollEnd":null!=n&&qi("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!=typeof n||!("__html"in n))throw Error(t(61));if(null!=(s=n.__html)){if(null!=i.children)throw Error(t(60));e.innerHTML=s}}break;case"multiple":e.multiple=n&&"function"!=typeof n&&"symbol"!=typeof n;break;case"muted":e.muted=n&&"function"!=typeof n&&"symbol"!=typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"==typeof n||"boolean"==typeof n||"symbol"==typeof n){e.removeAttribute("xlink:href");break}s=ce(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(s,""+n):e.removeAttribute(s);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(s,""):e.removeAttribute(s);break;case"capture":case"download":!0===n?e.setAttribute(s,""):!1!==n&&null!=n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(s,n):e.removeAttribute(s);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!=typeof n&&"symbol"!=typeof n&&!isNaN(n)&&1<=n?e.setAttribute(s,n):e.removeAttribute(s);break;case"rowSpan":case"start":null==n||"function"==typeof n||"symbol"==typeof n||isNaN(n)?e.removeAttribute(s):e.setAttribute(s,n);break;case"popover":qi("beforetoggle",e),qi("toggle",e),D(e,"popover",n);break;case"xlinkActuate":B(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":B(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":B(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":B(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":B(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":B(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":B(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":B(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":B(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":D(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<s.length)||"o"!==s[0]&&"O"!==s[0]||"n"!==s[1]&&"N"!==s[1])&&D(e,s=Ao.get(s)||s,n)}}function ir(e,a,s,n,i,r){switch(s){case"style":le(e,n,r);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!=typeof n||!("__html"in n))throw Error(t(61));if(null!=(s=n.__html)){if(null!=i.children)throw Error(t(60));e.innerHTML=s}}break;case"children":"string"==typeof n?ie(e,n):("number"==typeof n||"bigint"==typeof n)&&ie(e,""+n);break;case"onScroll":null!=n&&qi("scroll",e);break;case"onScrollEnd":null!=n&&qi("scrollend",e);break;case"onClick":null!=n&&(e.onclick=sr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:bo.hasOwnProperty(s)||("o"!==s[0]||"n"!==s[1]||(i=s.endsWith("Capture"),a=s.slice(2,i?s.length-7:void 0),"function"==typeof(r=null!=(r=e[mo]||null)?r[s]:null)&&e.removeEventListener(a,r,i),"function"!=typeof n)?s in e?e[s]=n:!0===n?e.setAttribute(s,""):D(e,s,n):("function"!=typeof r&&null!==r&&(s in e?e[s]=null:e.hasAttribute(s)&&e.removeAttribute(s)),e.addEventListener(a,n,i)))}}function rr(e,a,s){switch(a){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qi("error",e),qi("load",e);var n,i=!1,r=!1;for(n in s)if(s.hasOwnProperty(n)){var l=s[n];if(null!=l)switch(n){case"src":i=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(t(137,a));default:nr(e,a,n,l,s,null)}}return r&&nr(e,a,"srcSet",s.srcSet,s,null),void(i&&nr(e,a,"src",s.src,s,null));case"input":qi("invalid",e);var o=n=l=r=null,c=null,d=null;for(i in s)if(s.hasOwnProperty(i)){var u=s[i];if(null!=u)switch(i){case"name":r=u;break;case"type":l=u;break;case"checked":c=u;break;case"defaultChecked":d=u;break;case"value":n=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(t(137,a));break;default:nr(e,a,i,u,s,null)}}return ee(e,n,o,c,d,l,r,!1),void G(e);case"select":for(r in qi("invalid",e),i=l=n=null,s)if(s.hasOwnProperty(r)&&null!=(o=s[r]))switch(r){case"value":n=o;break;case"defaultValue":l=o;break;case"multiple":i=o;default:nr(e,a,r,o,s,null)}return a=n,s=l,e.multiple=!!i,void(null!=a?ae(e,!!i,a,!1):null!=s&&ae(e,!!i,s,!0));case"textarea":for(l in qi("invalid",e),n=r=i=null,s)if(s.hasOwnProperty(l)&&null!=(o=s[l]))switch(l){case"value":i=o;break;case"defaultValue":r=o;break;case"children":n=o;break;case"dangerouslySetInnerHTML":if(null!=o)throw Error(t(91));break;default:nr(e,a,l,o,s,null)}return ne(e,i,r,n),void G(e);case"option":for(c in s)if(s.hasOwnProperty(c)&&null!=(i=s[c]))if("selected"===c)e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i;else nr(e,a,c,i,s,null);return;case"dialog":qi("beforetoggle",e),qi("toggle",e),qi("cancel",e),qi("close",e);break;case"iframe":case"object":qi("load",e);break;case"video":case"audio":for(i=0;i<eh.length;i++)qi(eh[i],e);break;case"image":qi("error",e),qi("load",e);break;case"details":qi("toggle",e);break;case"embed":case"source":case"link":qi("error",e),qi("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in s)if(s.hasOwnProperty(d)&&null!=(i=s[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(t(137,a));default:nr(e,a,d,i,s,null)}return;default:if(oe(a)){for(u in s)s.hasOwnProperty(u)&&(void 0!==(i=s[u])&&ir(e,a,u,i,s,void 0));return}}for(o in s)s.hasOwnProperty(o)&&(null!=(i=s[o])&&nr(e,a,o,i,s,null))}function lr(e){return 9===e.nodeType?e:e.ownerDocument}function or(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cr(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function dr(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}function ur(e){setTimeout(function(){throw e})}function hr(e){return"head"===e}function mr(e,t){var a=t,s=0,n=0;do{var i=a.nextSibling;if(e.removeChild(a),i&&8===i.nodeType)if("/$"===(a=i.data)){if(0<s&&8>s){a=s;var r=e.ownerDocument;if(1&a&&yr(r.documentElement),2&a&&yr(r.body),4&a)for(yr(a=r.head),r=a.firstChild;r;){var l=r.nextSibling,o=r.nodeName;r[yo]||"SCRIPT"===o||"STYLE"===o||"LINK"===o&&"stylesheet"===r.rel.toLowerCase()||a.removeChild(r),r=l}}if(0===n)return e.removeChild(i),void rl(t);n--}else"$"===a||"$?"===a||"$!"===a?n++:s=a.charCodeAt(0)-48;else s=0;a=i}while(a);rl(t)}function pr(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":pr(a),P(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===a.rel.toLowerCase())continue}e.removeChild(a)}}function fr(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function xr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}function gr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a){if(0===t)return e;t--}else"/$"===a&&t++}e=e.previousSibling}return null}function vr(e,a,s){switch(a=lr(s),e){case"html":if(!(e=a.documentElement))throw Error(t(452));return e;case"head":if(!(e=a.head))throw Error(t(453));return e;case"body":if(!(e=a.body))throw Error(t(454));return e;default:throw Error(t(451))}}function yr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);P(e)}function jr(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}function br(e,t,a){var s=xh;if(s&&"string"==typeof t&&t){var n=Q(t);n='link[rel="'+e+'"][href="'+n+'"]',"string"==typeof a&&(n+='[crossorigin="'+a+'"]'),ph.has(n)||(ph.add(n),e={rel:e,crossOrigin:a,href:t},null===s.querySelector(n)&&(rr(t=s.createElement("link"),"link",e),L(t),s.head.appendChild(t)))}}function Nr(e,a,s,n){var i,r,l,o,c=(c=Ul.current)?jr(c):null;if(!c)throw Error(t(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof s.precedence&&"string"==typeof s.href?(a=wr(s.href),(n=(s=$(c).hoistableStyles).get(a))||(n={type:"style",instance:null,count:0,state:null},s.set(a,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===s.rel&&"string"==typeof s.href&&"string"==typeof s.precedence){e=wr(s.href);var d=$(c).hoistableStyles,u=d.get(e);if(u||(c=c.ownerDocument||c,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=c.querySelector(kr(e)))&&!d._p&&(u.instance=d,u.state.loading=5),mh.has(e)||(s={rel:"preload",as:"style",href:s.href,crossOrigin:s.crossOrigin,integrity:s.integrity,media:s.media,hrefLang:s.hrefLang,referrerPolicy:s.referrerPolicy},mh.set(e,s),d||(i=c,r=e,l=s,o=u.state,i.querySelector('link[rel="preload"][as="style"]['+r+"]")?o.loading=1:(r=i.createElement("link"),o.preload=r,r.addEventListener("load",function(){return o.loading|=1}),r.addEventListener("error",function(){return o.loading|=2}),rr(r,"link",l),L(r),i.head.appendChild(r))))),a&&null===n)throw Error(t(528,""));return u}if(a&&null!==n)throw Error(t(529,""));return null;case"script":return a=s.async,"string"==typeof(s=s.src)&&a&&"function"!=typeof a&&"symbol"!=typeof a?(a=Sr(s),(n=(s=$(c).hoistableScripts).get(a))||(n={type:"script",instance:null,count:0,state:null},s.set(a,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(t(444,e))}}function wr(e){return'href="'+Q(e)+'"'}function kr(e){return'link[rel="stylesheet"]['+e+"]"}function _r(e){return pl({},e,{"data-precedence":e.precedence,precedence:null})}function Sr(e){return'[src="'+Q(e)+'"]'}function Cr(e){return"script[async]"+e}function Ar(e,a,s){if(a.count++,null===a.instance)switch(a.type){case"style":var n=e.querySelector('style[data-href~="'+Q(s.href)+'"]');if(n)return a.instance=n,L(n),n;var i=pl({},s,{"data-href":s.href,"data-precedence":s.precedence,href:null,precedence:null});return L(n=(e.ownerDocument||e).createElement("style")),rr(n,"style",i),Tr(n,s.precedence,e),a.instance=n;case"stylesheet":i=wr(s.href);var r=e.querySelector(kr(i));if(r)return a.state.loading|=4,a.instance=r,L(r),r;n=_r(s),(i=mh.get(i))&&Pr(n,i),L(r=(e.ownerDocument||e).createElement("link"));var l=r;return l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),rr(r,"link",n),a.state.loading|=4,Tr(r,s.precedence,e),a.instance=r;case"script":return r=Sr(s.src),(i=e.querySelector(Cr(r)))?(a.instance=i,L(i),i):(n=s,(i=mh.get(r))&&Er(n=pl({},s),i),L(i=(e=e.ownerDocument||e).createElement("script")),rr(i,"link",n),e.head.appendChild(i),a.instance=i);case"void":return null;default:throw Error(t(443,a.type))}else"stylesheet"===a.type&&!(4&a.state.loading)&&(n=a.instance,a.state.loading|=4,Tr(n,s.precedence,e));return a.instance}function Tr(e,t,a){for(var s=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=s.length?s[s.length-1]:null,i=n,r=0;r<s.length;r++){var l=s[r];if(l.dataset.precedence===t)i=l;else if(i!==n)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===a.nodeType?a.head:a).insertBefore(e,t.firstChild)}function Pr(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Er(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}function Ir(e,t,a){if(null===gh){var s=new Map,n=gh=new Map;n.set(a,s)}else(s=(n=gh).get(a))||(s=new Map,n.set(a,s));if(s.has(e))return s;for(s.set(e,null),a=a.getElementsByTagName(e),n=0;n<a.length;n++){var i=a[n];if(!(i[yo]||i[ho]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var r=i.getAttribute(t)||"";r=e+r;var l=s.get(r);l?l.push(i):s.set(r,[i])}}return s}function Fr(e,t,a){(e=e.ownerDocument||e).head.insertBefore(a,"title"===t?e.querySelector("head > title"):null)}function $r(e){return!!("stylesheet"!==e.type||3&e.state.loading)}function Lr(){}function Mr(){if(this.count--,0===this.count)if(this.stylesheets)Rr(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}function Rr(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,yh=new Map,t.forEach(Wr,e),yh=null,Mr.call(e))}function Wr(e,t){if(!(4&t.state.loading)){var a=yh.get(e);if(a)var s=a.get(null);else{a=new Map,yh.set(e,a);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<n.length;i++){var r=n[i];"LINK"!==r.nodeName&&"not all"===r.getAttribute("media")||(a.set(r.dataset.precedence,r),s=r)}s&&a.set(null,s)}r=(n=t.instance).getAttribute("data-precedence"),(i=a.get(r)||s)===s&&a.set(null,n),a.set(r,n),this.count++,s=Mr.bind(this),n.addEventListener("load",s),n.addEventListener("error",s),i?i.parentNode.insertBefore(n,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(n,e.firstChild),t.state.loading|=4}}function Or(e,t,a,s,n,i,r,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=w(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w(0),this.hiddenUpdates=w(null),this.identifierPrefix=s,this.onUncaughtError=n,this.onCaughtError=i,this.onRecoverableError=r,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function Dr(e,t,a,s,n,i,r,l,o,c,d,u){return e=new Or(e,t,a,r,l,o,c,u),t=1,!0===i&&(t|=24),i=et(3,null,null,t),e.current=i,i.stateNode=e,(t=Tt()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:s,isDehydrated:a,cache:t},Dt(i),e}function Ur(e){return e?e=qc:qc}function Br(e,t,a,s,n,i){n=Ur(n),null===s.context?s.context=n:s.pendingContext=n,(s=Bt(t)).payload={element:a},null!==(i=void 0===i?null:i)&&(s.callback=i),null!==(a=zt(e,s,t))&&(ti(a,0,t),Xt(a,e,t))}function zr(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function Xr(e,t){zr(e,t),(e=e.alternate)&&zr(e,t)}function Hr(e){if(13===e.tag){var t=Ke(e,67108864);null!==t&&ti(t,0,67108864),Xr(e,67108864)}}function qr(e,t,a,s){var n=$l.T;$l.T=null;var i=Ll.p;try{Ll.p=2,Vr(e,t,a,s)}finally{Ll.p=i,$l.T=n}}function Jr(e,t,a,s){var n=$l.T;$l.T=null;var i=Ll.p;try{Ll.p=8,Vr(e,t,a,s)}finally{Ll.p=i,$l.T=n}}function Vr(e,t,a,s){if(bh){var n=Gr(s);if(null===n)Ki(e,t,s,Nh,a),Qr(e,s);else if(function(e,t,a,s,n){switch(t){case"focusin":return kh=Zr(kh,e,t,a,s,n),!0;case"dragenter":return _h=Zr(_h,e,t,a,s,n),!0;case"mouseover":return Sh=Zr(Sh,e,t,a,s,n),!0;case"pointerover":var i=n.pointerId;return Ch.set(i,Zr(Ch.get(i)||null,e,t,a,s,n)),!0;case"gotpointercapture":return i=n.pointerId,Ah.set(i,Zr(Ah.get(i)||null,e,t,a,s,n)),!0}return!1}(n,e,t,a,s))s.stopPropagation();else if(Qr(e,s),4&t&&-1<Ph.indexOf(e)){for(;null!==n;){var i=I(n);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var r=g(i.pendingLanes);if(0!==r){var l=i;for(l.pendingLanes|=2,l.entangledLanes|=2;r;){var o=1<<31-io(r);l.entanglements[1]|=o,r&=~o}Li(i),!(6&pu)&&($u=Vl()+500,Mi(0))}}break;case 13:null!==(l=Ke(i,2))&&ti(l,0,2),ri(),Xr(i,2)}if(null===(i=Gr(s))&&Ki(e,t,s,Nh,a),i===n)break;n=i}null!==n&&s.stopPropagation()}else Ki(e,t,s,null,a)}}function Gr(e){return Kr(e=de(e))}function Kr(e){if(Nh=null,null!==(e=E(e))){var t=s(e);if(null===t)e=null;else{var a=t.tag;if(13===a){if(null!==(e=n(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Nh=e,null}function Yr(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Gl()){case Kl:return 2;case Yl:return 8;case Ql:case Zl:return 32;case eo:return 268435456;default:return 32}default:return 32}}function Qr(e,t){switch(e){case"focusin":case"focusout":kh=null;break;case"dragenter":case"dragleave":_h=null;break;case"mouseover":case"mouseout":Sh=null;break;case"pointerover":case"pointerout":Ch.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ah.delete(t.pointerId)}}function Zr(e,t,a,s,n,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:a,eventSystemFlags:s,nativeEvent:i,targetContainers:[n]},null!==t&&(null!==(t=I(t))&&Hr(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function el(e){var t=E(e.target);if(null!==t){var a=s(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=n(a)))return e.blockedOn=t,void function(e,t){var a=Ll.p;try{return Ll.p=e,t()}finally{Ll.p=a}}(e.priority,function(){if(13===a.tag){var e=Zn();e=C(e);var t=Ke(a,e);null!==t&&ti(t,0,e),Xr(a,e)}})}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function tl(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=Gr(e.nativeEvent);if(null!==a)return null!==(t=I(a))&&Hr(t),e.blockedOn=a,!1;var s=new(a=e.nativeEvent).constructor(a.type,a);Po=s,a.target.dispatchEvent(s),Po=null,t.shift()}return!0}function al(e,t,a){tl(e)&&a.delete(t)}function sl(){wh=!1,null!==kh&&tl(kh)&&(kh=null),null!==_h&&tl(_h)&&(_h=null),null!==Sh&&tl(Sh)&&(Sh=null),Ch.forEach(al),Ah.forEach(al)}function nl(e,t){e.blockedOn===t&&(e.blockedOn=null,wh||(wh=!0,ul.unstable_scheduleCallback(ul.unstable_NormalPriority,sl)))}function il(e){Eh!==e&&(Eh=e,ul.unstable_scheduleCallback(ul.unstable_NormalPriority,function(){Eh===e&&(Eh=null);for(var t=0;t<e.length;t+=3){var a=e[t],s=e[t+1],n=e[t+2];if("function"!=typeof s){if(null===Kr(s||a))continue;break}var i=I(a);null!==i&&(e.splice(t,3),t-=3,es(i,{pending:!0,data:n,method:a.method,action:s},s,n))}}))}function rl(e){function t(t){return nl(t,e)}null!==kh&&nl(kh,e),null!==_h&&nl(_h,e),null!==Sh&&nl(Sh,e),Ch.forEach(t),Ah.forEach(t);for(var a=0;a<Th.length;a++){var s=Th[a];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Th.length&&null===(a=Th[0]).blockedOn;)el(a),null===a.blockedOn&&Th.shift();if(null!=(a=(e.ownerDocument||e).$$reactFormReplay))for(s=0;s<a.length;s+=3){var n=a[s],i=a[s+1],r=n[mo]||null;if("function"==typeof i)r||il(a);else if(r){var l=null;if(i&&i.hasAttribute("formAction")){if(n=i,r=i[mo]||null)l=r.formAction;else if(null!==Kr(n))continue}else l=r.action;"function"==typeof l?a[s+1]=l:(a.splice(s,3),s-=3),il(a)}}}function ll(e){this._internalRoot=e}function ol(e){this._internalRoot=e}if(Ne)return Ae;Ne=1;var cl,dl,ul=e(),hl=R(),ml=W(),pl=Object.assign,fl=Symbol.for("react.element"),xl=Symbol.for("react.transitional.element"),gl=Symbol.for("react.portal"),vl=Symbol.for("react.fragment"),yl=Symbol.for("react.strict_mode"),jl=Symbol.for("react.profiler"),bl=Symbol.for("react.provider"),Nl=Symbol.for("react.consumer"),wl=Symbol.for("react.context"),kl=Symbol.for("react.forward_ref"),_l=Symbol.for("react.suspense"),Sl=Symbol.for("react.suspense_list"),Cl=Symbol.for("react.memo"),Al=Symbol.for("react.lazy"),Tl=Symbol.for("react.activity"),Pl=Symbol.for("react.memo_cache_sentinel"),El=Symbol.iterator,Il=Symbol.for("react.client.reference"),Fl=Array.isArray,$l=hl.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ll=ml.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ml={pending:!1,data:null,method:null,action:null},Rl=[],Wl=-1,Ol=c(null),Dl=c(null),Ul=c(null),Bl=c(null),zl=Object.prototype.hasOwnProperty,Xl=ul.unstable_scheduleCallback,Hl=ul.unstable_cancelCallback,ql=ul.unstable_shouldYield,Jl=ul.unstable_requestPaint,Vl=ul.unstable_now,Gl=ul.unstable_getCurrentPriorityLevel,Kl=ul.unstable_ImmediatePriority,Yl=ul.unstable_UserBlockingPriority,Ql=ul.unstable_NormalPriority,Zl=ul.unstable_LowPriority,eo=ul.unstable_IdlePriority,to=ul.log,ao=ul.unstable_setDisableYieldValue,so=null,no=null,io=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(ro(e)/lo|0)|0},ro=Math.log,lo=Math.LN2,oo=256,co=4194304,uo=Math.random().toString(36).slice(2),ho="__reactFiber$"+uo,mo="__reactProps$"+uo,po="__reactContainer$"+uo,fo="__reactEvents$"+uo,xo="__reactListeners$"+uo,go="__reactHandles$"+uo,vo="__reactResources$"+uo,yo="__reactMarker$"+uo,jo=new Set,bo={},No=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wo={},ko={},_o=!1,So=/[\n"\\]/g,Co=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" ")),Ao=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),To=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i,Po=null,Eo=null,Io=null,Fo=!1,$o=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Lo=!1;if($o)try{var Mo={};Object.defineProperty(Mo,"passive",{get:function(){Lo=!0}}),window.addEventListener("test",Mo,Mo),window.removeEventListener("test",Mo,Mo)}catch(Lh){Lo=!1}var Ro,Wo,Oo,Do=null,Uo=null,Bo=null,zo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xo=ve(zo),Ho=pl({},zo,{view:0,detail:0}),qo=ve(Ho),Jo=pl({},Ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:je,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Oo&&(Oo&&"mousemove"===e.type?(Ro=e.screenX-Oo.screenX,Wo=e.screenY-Oo.screenY):Wo=Ro=0,Oo=e),Ro)},movementY:function(e){return"movementY"in e?e.movementY:Wo}}),Vo=ve(Jo),Go=ve(pl({},Jo,{dataTransfer:0})),Ko=ve(pl({},Ho,{relatedTarget:0})),Yo=ve(pl({},zo,{animationName:0,elapsedTime:0,pseudoElement:0})),Qo=ve(pl({},zo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),Zo=ve(pl({},zo,{data:0})),ec={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ac={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},sc=ve(pl({},Ho,{key:function(e){if(e.key){var t=ec[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=fe(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?tc[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:je,charCode:function(e){return"keypress"===e.type?fe(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?fe(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),nc=ve(pl({},Jo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),ic=ve(pl({},Ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:je})),rc=ve(pl({},zo,{propertyName:0,elapsedTime:0,pseudoElement:0})),lc=ve(pl({},Jo,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),oc=ve(pl({},zo,{newState:0,oldState:0})),cc=[9,13,27,32],dc=$o&&"CompositionEvent"in window,uc=null;$o&&"documentMode"in document&&(uc=document.documentMode);var hc=$o&&"TextEvent"in window&&!uc,mc=$o&&(!dc||uc&&8<uc&&11>=uc),pc=String.fromCharCode(32),fc=!1,xc=!1,gc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},vc=null,yc=null,jc=!1;if($o){var bc;if($o){var Nc="oninput"in document;if(!Nc){var wc=document.createElement("div");wc.setAttribute("oninput","return;"),Nc="function"==typeof wc.oninput}bc=Nc}else bc=!1;jc=bc&&(!document.documentMode||9<document.documentMode)}var kc="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},_c=$o&&"documentMode"in document&&11>=document.documentMode,Sc=null,Cc=null,Ac=null,Tc=!1,Pc={animationend:ze("Animation","AnimationEnd"),animationiteration:ze("Animation","AnimationIteration"),animationstart:ze("Animation","AnimationStart"),transitionrun:ze("Transition","TransitionRun"),transitionstart:ze("Transition","TransitionStart"),transitioncancel:ze("Transition","TransitionCancel"),transitionend:ze("Transition","TransitionEnd")},Ec={},Ic={};$o&&(Ic=document.createElement("div").style,"AnimationEvent"in window||(delete Pc.animationend.animation,delete Pc.animationiteration.animation,delete Pc.animationstart.animation),"TransitionEvent"in window||delete Pc.transitionend.transition);var Fc=Xe("animationend"),$c=Xe("animationiteration"),Lc=Xe("animationstart"),Mc=Xe("transitionrun"),Rc=Xe("transitionstart"),Wc=Xe("transitioncancel"),Oc=Xe("transitionend"),Dc=new Map,Uc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Uc.push("scrollEnd");var Bc=new WeakMap,zc=[],Xc=0,Hc=0,qc={},Jc=[],Vc=0,Gc=null,Kc=0,Yc=[],Qc=0,Zc=null,ed=1,td="",ad=null,sd=null,nd=!1,id=null,rd=!1,ld=Error(t(519)),od=c(null),cd=null,dd=null,ud="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},hd=ul.unstable_scheduleCallback,md=ul.unstable_NormalPriority,pd={$$typeof:wl,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},fd=null,xd=0,gd=0,vd=null,yd=$l.S;$l.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===fd){var a=fd=[];xd=0,gd=Bi(),vd={status:"pending",value:void 0,then:function(e){a.push(e)}}}xd++,t.then(Et,Et)}(0,t),null!==yd&&yd(e,t)};for(var jd=c(null),bd=Error(t(460)),Nd=Error(t(474)),wd=Error(t(542)),kd={then:function(){}},_d=null,Sd=!1,Cd=!1,Ad=c(null),Td=c(0),Pd=0,Ed=null,Id=null,Fd=null,$d=!1,Ld=!1,Md=!1,Rd=0,Wd=0,Od=null,Dd=0,Ud={readContext:St,use:ua,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useLayoutEffect:Zt,useInsertionEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useSyncExternalStore:Zt,useId:Zt,useHostTransitionStatus:Zt,useFormState:Zt,useActionState:Zt,useOptimistic:Zt,useMemoCache:Zt,useCacheRefresh:Zt},Bd={readContext:St,use:ua,useCallback:function(e,t){return oa().memoizedState=[e,void 0===t?null:t],e},useContext:St,useEffect:Ua,useImperativeHandle:function(e,t,a){a=null!=a?a.concat([e]):null,Oa(4194308,4,Ha.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Oa(4194308,4,e,t)},useInsertionEffect:function(e,t){Oa(4,2,e,t)},useMemo:function(e,t){var a=oa();t=void 0===t?null:t;var s=e();if(Md){x(!0);try{e()}finally{x(!1)}}return a.memoizedState=[s,t],s},useReducer:function(e,t,a){var s=oa();if(void 0!==a){var n=a(t);if(Md){x(!0);try{a(t)}finally{x(!1)}}}else n=t;return s.memoizedState=s.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},s.queue=e,e=e.dispatch=ls.bind(null,Ed,e),[s.memoizedState,e]},useRef:function(e){return e={current:e},oa().memoizedState=e},useState:function(e){var t=(e=wa(e)).queue,a=os.bind(null,Ed,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:Ja,useDeferredValue:function(e,t){return Ka(oa(),e,t)},useTransition:function(){var e=wa(!1);return e=Qa.bind(null,Ed,e.queue,!0,!1),oa().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,a,s){var n=Ed,i=oa();if(nd){if(void 0===s)throw Error(t(407));s=s()}else{if(s=a(),null===fu)throw Error(t(349));124&gu||va(n,a,s)}i.memoizedState=s;var r={value:s,getSnapshot:a};return i.queue=r,Ua(ja.bind(null,n,r,e),[e]),n.flags|=2048,Ra(9,{destroy:void 0,resource:void 0},ya.bind(null,n,r,s,a),null),s},useId:function(){var e=oa(),t=fu.identifierPrefix;if(nd){var a=td;t="\xab"+t+"R"+(a=(ed&~(1<<32-io(ed)-1)).toString(32)+a),0<(a=Rd++)&&(t+="H"+a.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(a=Dd++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:ss,useFormState:Ia,useActionState:Ia,useOptimistic:function(e){var t=oa();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=ds.bind(null,Ed,!0,a),a.dispatch=t,[e,t]},useMemoCache:ha,useCacheRefresh:function(){return oa().memoizedState=rs.bind(null,Ed)}},zd={readContext:St,use:ua,useCallback:Va,useContext:St,useEffect:Ba,useImperativeHandle:qa,useInsertionEffect:za,useLayoutEffect:Xa,useMemo:Ga,useReducer:pa,useRef:Wa,useState:function(){return pa(ma)},useDebugValue:Ja,useDeferredValue:function(e,t){return Ya(ca(),Id.memoizedState,e,t)},useTransition:function(){var e=pa(ma)[0],t=ca().memoizedState;return["boolean"==typeof e?e:da(e),t]},useSyncExternalStore:ga,useId:ns,useHostTransitionStatus:ss,useFormState:Fa,useActionState:Fa,useOptimistic:function(e,t){return ka(ca(),0,e,t)},useMemoCache:ha,useCacheRefresh:is},Xd={readContext:St,use:ua,useCallback:Va,useContext:St,useEffect:Ba,useImperativeHandle:qa,useInsertionEffect:za,useLayoutEffect:Xa,useMemo:Ga,useReducer:xa,useRef:Wa,useState:function(){return xa(ma)},useDebugValue:Ja,useDeferredValue:function(e,t){var a=ca();return null===Id?Ka(a,e,t):Ya(a,Id.memoizedState,e,t)},useTransition:function(){var e=xa(ma)[0],t=ca().memoizedState;return["boolean"==typeof e?e:da(e),t]},useSyncExternalStore:ga,useId:ns,useHostTransitionStatus:ss,useFormState:Ma,useActionState:Ma,useOptimistic:function(e,t){var a=ca();return null!==Id?ka(a,0,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:ha,useCacheRefresh:is},Hd=null,qd=0,Jd=vs(!0),Vd=vs(!1),Gd=c(null),Kd=null,Yd=c(0),Qd={enqueueSetState:function(e,t,a){e=e._reactInternals;var s=Zn(),n=Bt(s);n.payload=t,null!=a&&(n.callback=a),null!==(t=zt(e,n,s))&&(ti(t,0,s),Xt(t,e,s))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var s=Zn(),n=Bt(s);n.tag=1,n.payload=t,null!=a&&(n.callback=a),null!==(t=zt(e,n,s))&&(ti(t,0,s),Xt(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Zn(),s=Bt(a);s.tag=2,null!=t&&(s.callback=t),null!==(t=zt(e,s,a))&&(ti(t,0,a),Xt(t,e,a))}},Zd="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},eu=Error(t(461)),tu=!1,au={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},su=!1,nu=!1,iu=!1,ru="function"==typeof WeakSet?WeakSet:Set,lu=null,ou=null,cu=!1,du=null,uu=8192,hu={getCacheForType:function(e){var t=St(pd),a=t.data.get(e);return void 0===a&&(a=e(),t.data.set(e,a)),a}},mu="function"==typeof WeakMap?WeakMap:Map,pu=0,fu=null,xu=null,gu=0,vu=0,yu=null,ju=!1,bu=!1,Nu=!1,wu=0,ku=0,_u=0,Su=0,Cu=0,Au=0,Tu=0,Pu=null,Eu=null,Iu=!1,Fu=0,$u=1/0,Lu=null,Mu=null,Ru=0,Wu=null,Ou=null,Du=0,Uu=0,Bu=null,zu=null,Xu=0,Hu=null,qu=null,Ju=null,Vu=!1,Gu=!1,Ku=!1,Yu=0,Qu=0;Qu<Uc.length;Qu++){var Zu=Uc[Qu];He(Zu.toLowerCase(),"on"+(Zu[0].toUpperCase()+Zu.slice(1)))}He(Fc,"onAnimationEnd"),He($c,"onAnimationIteration"),He(Lc,"onAnimationStart"),He("dblclick","onDoubleClick"),He("focusin","onFocus"),He("focusout","onBlur"),He(Mc,"onTransitionRun"),He(Rc,"onTransitionStart"),He(Wc,"onTransitionCancel"),He(Oc,"onTransitionEnd"),O("onMouseEnter",["mouseout","mouseover"]),O("onMouseLeave",["mouseout","mouseover"]),O("onPointerEnter",["pointerout","pointerover"]),O("onPointerLeave",["pointerout","pointerover"]),M("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),M("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),M("onBeforeInput",["compositionend","keypress","textInput","paste"]),M("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),M("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),M("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var eh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),th=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(eh)),ah="_reactListening"+Math.random().toString(36).slice(2),sh=/\r\n?/g,nh=/\u0000|\uFFFD/g,ih=null,rh=null,lh=null,oh="function"==typeof setTimeout?setTimeout:void 0,ch="function"==typeof clearTimeout?clearTimeout:void 0,dh="function"==typeof Promise?Promise:void 0,uh="function"==typeof queueMicrotask?queueMicrotask:void 0!==dh?function(e){return dh.resolve(null).then(e).catch(ur)}:oh,hh=null,mh=new Map,ph=new Set,fh=Ll.d;Ll.d={f:function(){var e=fh.f(),t=ri();return e||t},r:function(e){var t=I(e);null!==t&&5===t.tag&&"form"===t.type?as(t):fh.r(e)},D:function(e){fh.D(e),br("dns-prefetch",e,null)},C:function(e,t){fh.C(e,t),br("preconnect",e,t)},L:function(e,t,a){fh.L(e,t,a);var s=xh;if(s&&e&&t){var n='link[rel="preload"][as="'+Q(t)+'"]';"image"===t&&a&&a.imageSrcSet?(n+='[imagesrcset="'+Q(a.imageSrcSet)+'"]',"string"==typeof a.imageSizes&&(n+='[imagesizes="'+Q(a.imageSizes)+'"]')):n+='[href="'+Q(e)+'"]';var i=n;switch(t){case"style":i=wr(e);break;case"script":i=Sr(e)}mh.has(i)||(e=pl({rel:"preload",href:"image"===t&&a&&a.imageSrcSet?void 0:e,as:t},a),mh.set(i,e),null!==s.querySelector(n)||"style"===t&&s.querySelector(kr(i))||"script"===t&&s.querySelector(Cr(i))||(rr(t=s.createElement("link"),"link",e),L(t),s.head.appendChild(t)))}},m:function(e,t){fh.m(e,t);var a=xh;if(a&&e){var s=t&&"string"==typeof t.as?t.as:"script",n='link[rel="modulepreload"][as="'+Q(s)+'"][href="'+Q(e)+'"]',i=n;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=Sr(e)}if(!mh.has(i)&&(e=pl({rel:"modulepreload",href:e},t),mh.set(i,e),null===a.querySelector(n))){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Cr(i)))return}rr(s=a.createElement("link"),"link",e),L(s),a.head.appendChild(s)}}},X:function(e,t){fh.X(e,t);var a=xh;if(a&&e){var s=$(a).hoistableScripts,n=Sr(e),i=s.get(n);i||((i=a.querySelector(Cr(n)))||(e=pl({src:e,async:!0},t),(t=mh.get(n))&&Er(e,t),L(i=a.createElement("script")),rr(i,"link",e),a.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},s.set(n,i))}},S:function(e,t,a){fh.S(e,t,a);var s=xh;if(s&&e){var n=$(s).hoistableStyles,i=wr(e);t=t||"default";var r=n.get(i);if(!r){var l={loading:0,preload:null};if(r=s.querySelector(kr(i)))l.loading=5;else{e=pl({rel:"stylesheet",href:e,"data-precedence":t},a),(a=mh.get(i))&&Pr(e,a);var o=r=s.createElement("link");L(o),rr(o,"link",e),o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),o.addEventListener("load",function(){l.loading|=1}),o.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Tr(r,t,s)}r={type:"stylesheet",instance:r,count:1,state:l},n.set(i,r)}}},M:function(e,t){fh.M(e,t);var a=xh;if(a&&e){var s=$(a).hoistableScripts,n=Sr(e),i=s.get(n);i||((i=a.querySelector(Cr(n)))||(e=pl({src:e,async:!0,type:"module"},t),(t=mh.get(n))&&Er(e,t),L(i=a.createElement("script")),rr(i,"link",e),a.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},s.set(n,i))}}};var xh="undefined"==typeof document?null:document,gh=null,vh=null,yh=null,jh={$$typeof:wl,Provider:null,Consumer:null,_currentValue:Ml,_currentValue2:Ml,_threadCount:0},bh=!0,Nh=null,wh=!1,kh=null,_h=null,Sh=null,Ch=new Map,Ah=new Map,Th=[],Ph="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" "),Eh=null;ol.prototype.render=ll.prototype.render=function(e){var a=this._internalRoot;if(null===a)throw Error(t(409));Br(a.current,Zn(),e,a,null,null)},ol.prototype.unmount=ll.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;Br(e.current,2,null,e,null,null),ri(),t[po]=null}},ol.prototype.unstable_scheduleHydration=function(e){if(e){var t=T();e={blockedOn:null,target:e,priority:t};for(var a=0;a<Th.length&&0!==t&&t<Th[a].priority;a++);Th.splice(a,0,e),0===a&&el(e)}};var Ih=hl.version;if("19.1.1"!==Ih)throw Error(t(527,Ih,"19.1.1"));Ll.findDOMNode=function(e){var a=e._reactInternals;if(void 0===a){if("function"==typeof e.render)throw Error(t(188));throw e=Object.keys(e).join(","),Error(t(268,e))}return e=function(e){var a=e.alternate;if(!a){if(null===(a=s(e)))throw Error(t(188));return a!==e?null:e}for(var n=e,r=a;;){var l=n.return;if(null===l)break;var o=l.alternate;if(null===o){if(null!==(r=l.return)){n=r;continue}break}if(l.child===o.child){for(o=l.child;o;){if(o===n)return i(l),e;if(o===r)return i(l),a;o=o.sibling}throw Error(t(188))}if(n.return!==r.return)n=l,r=o;else{for(var c=!1,d=l.child;d;){if(d===n){c=!0,n=l,r=o;break}if(d===r){c=!0,r=l,n=o;break}d=d.sibling}if(!c){for(d=o.child;d;){if(d===n){c=!0,n=o,r=l;break}if(d===r){c=!0,r=o,n=l;break}d=d.sibling}if(!c)throw Error(t(189))}}if(n.alternate!==r)throw Error(t(190))}if(3!==n.tag)throw Error(t(188));return n.stateNode.current===n?e:a}(a),e=null===(e=null!==e?r(e):null)?null:e.stateNode};var Fh={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:$l,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{so=$h.inject(Fh),no=$h}catch(Mh){}}return Ae.createRoot=function(e,s){if(!a(e))throw Error(t(299));var n=!1,i="",r=As,l=Ts,o=Ps;return null!=s&&(!0===s.unstable_strictMode&&(n=!0),void 0!==s.identifierPrefix&&(i=s.identifierPrefix),void 0!==s.onUncaughtError&&(r=s.onUncaughtError),void 0!==s.onCaughtError&&(l=s.onCaughtError),void 0!==s.onRecoverableError&&(o=s.onRecoverableError),void 0!==s.unstable_transitionCallbacks&&s.unstable_transitionCallbacks),s=Dr(e,1,!1,null,0,n,i,r,l,o,0,null),e[po]=s.current,Vi(e),new ll(s)},Ae.hydrateRoot=function(e,s,n){if(!a(e))throw Error(t(299));var i=!1,r="",l=As,o=Ts,c=Ps,d=null;return null!=n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(l=n.onUncaughtError),void 0!==n.onCaughtError&&(o=n.onCaughtError),void 0!==n.onRecoverableError&&(c=n.onRecoverableError),void 0!==n.unstable_transitionCallbacks&&n.unstable_transitionCallbacks,void 0!==n.formState&&(d=n.formState)),(s=Dr(e,1,!0,s,0,i,r,l,o,c,0,d)).context=Ur(null),n=s.current,(r=Bt(i=C(i=Zn()))).callback=null,zt(n,r,i),n=i,s.current.lanes=n,k(s,n),Li(s),e[po]=s.current,Vi(e),new ol(s)},Ae.version="19.1.1",Ae}function a(e,t=8,a=0){const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"0";if(0===s)return a>0?"0."+"0".repeat(a):"0";if(Math.abs(s)<Math.pow(10,-t))return s.toExponential(2);let n=s.toFixed(t);if(n.includes(".")&&(n=n.replace(/\.?0+$/,"")),a>0){const e=n.indexOf(".");if(-1===e)n+="."+"0".repeat(a);else{const t=n.length-e-1;t<a&&(n+="0".repeat(a-t))}}return n}function s(e,t){var a;void 0===t&&(t="0");var s=0,c=-1;"-"==e[0]&&(o(e=e.substring(1))||(s++,c=1,e.length)),"-"==t[0]&&(o(t=t.substring(1))||(s++,c=2,t.length)),e=i(e),t=i(t),e=(a=r(i(e),i(t)))[0],t=a[1],1==s&&(1===c?e=n(e):2===c&&(t=n(t)));var d=l(e,t);return s?2==s?"-"+i(d):e.length<d.length?i(d.substring(1)):"-"+i(n(d)):i(d)}function n(e){if(o(e))return e;for(var t="",a=e.length,s=e.split(".")[1],n=s?s.length:0,i=0;i<a;i++)e[i]>="0"&&e[i]<="9"?t+=9-parseInt(e[i]):t+=e[i];return l(t,n>0?"0."+new Array(n).join("0")+"1":"1")}function i(e){var t=e.split(".");for(t[0]||(t[0]="0");"0"==t[0][0]&&t[0].length>1;)t[0]=t[0].substring(1);return t[0]+(t[1]?"."+t[1]:"")}function r(e,t){var a=e.split("."),s=t.split("."),n=a[0].length,i=s[0].length;return n>i?s[0]=new Array(Math.abs(n-i)+1).join("0")+(s[0]?s[0]:""):a[0]=new Array(Math.abs(n-i)+1).join("0")+(a[0]?a[0]:""),n=a[1]?a[1].length:0,i=s[1]?s[1].length:0,(n||i)&&(n>i?s[1]=(s[1]?s[1]:"")+new Array(Math.abs(n-i)+1).join("0"):a[1]=(a[1]?a[1]:"")+new Array(Math.abs(n-i)+1).join("0")),[e=a[0]+(a[1]?"."+a[1]:""),t=s[0]+(s[1]?"."+s[1]:"")]}function l(e,t){var a;e=(a=r(e,t))[0],t=a[1];for(var s="",n=0,i=e.length-1;i>=0;i--)if("."!==e[i]){var l=parseInt(e[i])+parseInt(t[i])+n;s=l%10+s,n=Math.floor(l/10)}else s="."+s;return n?n.toString()+s:s}function o(e){return/^0[0]*[.]{0,1}[0]*$/.test(e)}function c(e){return"number"!=typeof e&&"bigint"!=typeof e||(e=e.toString()),"-"==e[0]?e.substring(1):e}function d(e,t,a){if(void 0===t&&(t=0),void 0===a&&(a=kt.HALF_EVEN),a===kt.UNNECESSARY)throw new Error("UNNECESSARY Rounding Mode has not yet been implemented");"number"!=typeof e&&"bigint"!=typeof e||(e=e.toString());var s=!1;"-"===e[0]&&(s=!0,e=e.substring(1));var n=e.split("."),i=n[0],r=n[1];if(t<0){if(t=-t,i.length<=t)return"0";var l=i.substr(0,i.length-t);return(s?"-":"")+(l=d(e=l+"."+i.substr(i.length-t)+r,0,a))+new Array(t+1).join("0")}if(0==t)return i.length,u(n[1],i,s,a)&&(i=h(i)),(s&&parseInt(i)?"-":"")+i;if(!n[1])return(s?"-":"")+i+"."+new Array(t+1).join("0");if(n[1].length<t)return(s?"-":"")+i+"."+n[1]+new Array(t-n[1].length+1).join("0");r=n[1].substring(0,t);var o=n[1].substring(t);return o&&u(o,r,s,a)&&(r=h(r)).length>t?(s?"-":"")+h(i,parseInt(r[0]))+"."+r.substring(1):(s&&(parseInt(i)||parseInt(r))?"-":"")+i+"."+r}function u(e,t,a,s){if(!e||e===new Array(e.length+1).join("0"))return!1;if(s===kt.DOWN||!a&&s===kt.FLOOR||a&&s===kt.CEILING)return!1;if(s===kt.UP||a&&s===kt.FLOOR||!a&&s===kt.CEILING)return!0;var n="5"+new Array(e.length).join("0");if(e>n)return!0;if(e<n)return!1;switch(s){case kt.HALF_DOWN:return!1;case kt.HALF_UP:return!0;case kt.HALF_EVEN:default:return parseInt(t[t.length-1])%2==1}}function h(e,t){void 0===t&&(t=0),t||(t=1),"number"==typeof e&&e.toString();for(var a="",s=e.length-1;s>=0;s--){var n=parseInt(e[s])+t;10==n?(t=1,n=0):t=0,a+=n}return t&&(a+=t),a.split("").reverse().join("")}function m(e){var t="-"===e[0];for(t&&(e=e.substr(1));"0"==e[0];)e=e.substr(1);if(-1!=e.indexOf("."))for(;"0"==e[e.length-1];)e=e.substr(0,e.length-1);return""==e||"."==e?e="0":"."==e[e.length-1]&&(e=e.substr(0,e.length-1)),"."==e[0]&&(e="0"+e),t&&"0"!=e&&(e="-"+e),e}function p(e,t){e=e.toString(),t=t.toString();var a=0;"-"==e[0]&&(a++,e=e.substr(1)),"-"==t[0]&&(a++,t=t.substr(1)),e=m(e),t=m(t);var s=0,n=0;-1!=e.indexOf(".")&&(s=e.length-e.indexOf(".")-1),-1!=t.indexOf(".")&&(n=t.length-t.indexOf(".")-1);var i=s+n;if(e=m(e.replace(".","")),t=m(t.replace(".","")),e.length<t.length){var r=e;e=t,t=r}if("0"==t)return"0";for(var l,o,c=t.length,d=0,u=[],h=c-1,p="",f=0;f<c;f++)u[f]=e.length-1;for(f=0;f<2*e.length;f++){for(var x=0,g=t.length-1;g>=h&&g>=0;g--)u[g]>-1&&u[g]<e.length&&(x+=parseInt(e[u[g]--])*parseInt(t[g]));x+=d,d=Math.floor(x/10),p=x%10+p,h--}return p=m((l=p,0==(o=i)?l:(l=o>=l.length?new Array(o-l.length+1).join("0")+l:l).substr(0,l.length-o)+"."+l.substr(l.length-o,o))),1==a&&(p="-"+p),p}function f(e,t,a,n){if(void 0===a&&(a=8),void 0===n&&(n=kt.HALF_EVEN),0==t)throw new Error("Cannot divide by 0");if(e=e.toString(),t=t.toString(),e=e.replace(/(\.\d*?[1-9])0+$/g,"$1").replace(/\.0+$/,""),t=t.replace(/(\.\d*?[1-9])0+$/g,"$1").replace(/\.0+$/,""),0==e)return"0";var r=0;"-"==t[0]&&(t=t.substring(1),r++),"-"==e[0]&&(e=e.substring(1),r++);var l=t.indexOf(".")>0?t.length-t.indexOf(".")-1:-1;if(t=i(t.replace(".","")),l>=0){var o=e.indexOf(".")>0?e.length-e.indexOf(".")-1:-1;if(-1==o)e=i(e+new Array(l+1).join("0"));else if(l>o)e=i((e=e.replace(".",""))+new Array(l-o+1).join("0"));else if(l<o){var c=(e=e.replace(".","")).length-o+l;e=i(e.substring(0,c)+"."+e.substring(c))}else l==o&&(e=i(e.replace(".","")))}var u=0,h=t.length,m="",p=e.indexOf(".")>-1&&e.indexOf(".")<h?e.substring(0,h+1):e.substring(0,h);if(e=e.indexOf(".")>-1&&e.indexOf(".")<h?e.substring(h+1):e.substring(h),p.indexOf(".")>-1){var f=p.length-p.indexOf(".")-1;h>(p=p.replace(".","")).length&&(f+=h-p.length,p+=new Array(h-p.length+1).join("0")),u=f,m="0."+new Array(f).join("0")}for(a+=2;u<=a;){for(var x=0;parseInt(p)>=parseInt(t);)p=s(p,"-"+t),x++;m+=x,e?("."==e[0]&&(m+=".",u++,e=e.substring(1)),p+=e.substring(0,1),e=e.substring(1)):(u||(m+="."),u++,p+="0")}return(1==r?"-":"")+i(d(m,a-2,n))}function x(e,t){return s(e=e.toString(),t=g(t=t.toString()))}function g(e){return e="-"==e[0]?e.substr(1):"-"+e}function v(e,t){if(0==t)throw new Error("Cannot divide by 0");e=e.toString(),t=t.toString(),y(e),y(t);var a="";return"-"==e[0]&&(a="-",e=e.substr(1)),"-"==t[0]&&(t=t.substr(1)),a+x(e,p(t,d(f(e,t),0,kt.FLOOR)))}function y(e){if(-1!=e.indexOf("."))throw new Error("Modulus of non-integers not supported")}function j(e,t){var a,s,n=!1;if(a=[e,t].map(function(e){return m(e)}),e=a[0],t=a[1],"-"==e[0]&&"-"!=t[0])return-1;if("-"!=e[0]&&"-"==t[0])return 1;if("-"==e[0]&&"-"==t[0]&&(e=e.substr(1),t=t.substr(1),n=!0),e=(s=r(e,t))[0],t=s[1],0==e.localeCompare(t))return 0;for(var i=0;i<e.length;i++)if(e[i]!=t[i])return e[i]>t[i]?n?-1:1:n?1:-1;return 0}function b(e,t){let a=e.div(t);const s=new se(0),n=new se(1);return e.mod(t).gt(s)&&a.gt(n)&&(a=a.sub(n)),ae.from(a)}function N(e){return new St(String(e))}function w({isOpen:e,onClose:t,nft:a}){const{session:s,isConnected:n,account:i}=Fe(),{settings:r}=at(),{showSuccess:l,showError:o}=xt(),[c,d]=O.useState("wax"),[u,h]=O.useState(""),[m,p]=O.useState(""),[f,x]=O.useState([]),[g,v]=O.useState([]),[y,j]=O.useState(!1),[b,N]=O.useState(!1),[w,k]=O.useState(!1);O.useEffect(()=>{e&&n&&(async()=>{if(i)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/assets?owner=${i}&collection_name=pixeljourney&limit=1`),t=await e.json();k(t.data&&t.data.length>0)}catch(e){console.error("Error checking Pixal holder status:",e)}})()},[e,n,i]),O.useEffect(()=>{e&&"nft"===c&&(async()=>{if(i&&"nft"===c){N(!0);try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/assets?owner=${i}&limit=100`),t=await e.json(),a=t.data?.map(e=>{const t=e.data?.img||e.data?.image,a=e.data?.video;let s="https://pixeljourney.xyz/img/toppixals/10.webp",n=null;return a&&"string"==typeof a&&(n=a.startsWith("http")?a:`${qe.IPFS.GATEWAYS[0]}${a}`),t&&"string"==typeof t&&(s=t.startsWith("http")?t:`${qe.IPFS.GATEWAYS[0]}${t}`),{asset_id:e.asset_id||"",name:e.name||`${e.collection?.collection_name||"Unknown"} #${e.asset_id||"N/A"}`,image:s,video:n,collection:e.collection?.collection_name||"Unknown",template_mint:void 0,max_supply:e.template?.max_supply||void 0}})||[];x(a)}catch(e){console.error("Error loading user NFTs:",e)}finally{N(!1)}}})()},[e,c,i]);return e&&a?Se.jsx("div",{className:"modal-backdrop",onClick:t,children:Se.jsxs("div",{className:"modal-content send-offer-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h3",{children:["Send Offer for ",a.name]}),Se.jsx("button",{className:"modal-close",onClick:t,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"target-nft-preview",children:[Se.jsx(Qt,{imageUrl:a.image,alt:a.name,enableAnimations:r.enableAnimatedNFTs}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h4",{children:a.name}),Se.jsxs("p",{children:["Collection: ","string"==typeof a.collection?a.collection:a.collection?.collection_name||a.collection?.name||"Unknown"]}),a.price&&Se.jsxs("p",{children:["Listed Price: ",a.price," WAX"]})]})]}),Se.jsxs("div",{className:"offer-type-selection",children:[Se.jsx("h4",{children:"Choose Offer Type"}),Se.jsxs("div",{className:"offer-type-buttons",children:[Se.jsxs("button",{className:"offer-type-btn "+("wax"===c?"active":""),onClick:()=>d("wax"),children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("path",{d:"M12 6v6l4 2"})]}),"WAX Offer"]}),Se.jsxs("button",{className:"offer-type-btn "+("nft"===c?"active":""),onClick:()=>d("nft"),children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),Se.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),Se.jsx("polyline",{points:"21,15 16,10 5,21"})]}),"NFT Trade"]})]})]}),"wax"===c&&Se.jsx("div",{className:"wax-offer-form",children:Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"waxAmount",children:"WAX Amount"}),Se.jsx("input",{id:"waxAmount",type:"number",step:"0.0001",min:"0",value:u,onChange:e=>h(e.target.value),placeholder:"Enter WAX amount",className:"form-input"})]})}),"nft"===c&&Se.jsxs("div",{className:"nft-trade-form",children:[Se.jsx("h4",{children:"Select NFTs to Trade"}),b?Se.jsxs("div",{className:"loading-inventory",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading your NFTs..."})]}):Se.jsx("div",{className:"user-nfts-grid",children:f.map(e=>Se.jsxs("div",{className:"user-nft-item "+(g.includes(e.asset_id)?"selected":""),onClick:()=>{return t=e.asset_id,void v(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[Se.jsx(Qt,{imageUrl:e.image,videoUrl:e.video,alt:e.name,enableAnimations:r.enableAnimatedNFTs}),Se.jsxs("div",{className:"nft-details",children:[Se.jsx("p",{className:"nft-name",children:e.name}),Se.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"})]}),g.includes(e.asset_id)&&Se.jsx("div",{className:"selection-indicator",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("polyline",{points:"20,6 9,17 4,12"})})})]},e.asset_id))})]}),w&&Se.jsxs("div",{className:"custom-memo-section",children:[Se.jsxs("div",{className:"pixal-holder-badge",children:[Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("polygon",{points:"12,2 15.09,8.26 22,9 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9 8.91,8.26"})}),"Pixal PFP Holder"]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"customMemo",children:"Custom Memo (Optional)"}),Se.jsx("textarea",{id:"customMemo",value:m,onChange:e=>p(e.target.value),placeholder:"Add a custom message to your offer...",className:"form-textarea",rows:3})]})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"btn-secondary",onClick:t,children:"Cancel"}),Se.jsx("button",{className:"btn-primary",onClick:()=>{"wax"===c?(async()=>{if(i&&a&&u&&s){j(!0);try{const e=m||"Trade Offer sent via PxMarket - market.pixeljourney.xyz",n=[{account:"eosio.token",name:"transfer",authorization:[{actor:i,permission:"active"}],data:{from:i,to:"atomicmarket",quantity:`${parseFloat(u).toFixed(8)} WAX`,memo:"deposit"}},{account:"atomicmarket",name:"createbuyo",authorization:[{actor:i,permission:"active"}],data:{buyer:i,recipient:a.owner||a.seller,price:`${parseFloat(u).toFixed(8)} WAX`,asset_ids:[a.asset_id],memo:e,maker_marketplace:"market.pxj"}}];await s.transact({actions:n}),l("WAX offer sent successfully!"),t()}catch(e){console.error("Error sending WAX offer:",e),o("Failed to send WAX offer. Please try again.")}finally{j(!1)}}})():(async()=>{if(i&&a&&0!==g.length&&s){j(!0);try{const e=m||"NFT Trade Offer sent via PxMarket - market.pixeljourney.xyz",n=[{account:"atomicassets",name:"createoffer",authorization:[{actor:i,permission:"active"}],data:{sender:i,recipient:a.owner||a.seller,sender_asset_ids:g,recipient_asset_ids:[a.asset_id],memo:e}}];await s.transact({actions:n}),l("NFT trade offer sent successfully!"),t()}catch(e){console.error("Error sending NFT offer:",e),o("Failed to send NFT offer. Please try again.")}finally{j(!1)}}})()},disabled:y||!n||"wax"===c&&!u||"nft"===c&&0===g.length,children:y?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"spinner-small"}),"Sending..."]}):`Send ${"wax"===c?"WAX":"NFT"} Offer`})]})]})}):null}function k(e){const t=document.createElement("div");return t.innerHTML=e,_(t),t.innerHTML}function _(e){const t=Array.from(e.children);for(const a of t){const e=a.tagName.toLowerCase();if(!ia.includes(e)){const e=document.createTextNode(a.textContent||"");a.parentNode?.replaceChild(e,a);continue}const t=ra[e]||[],s=Array.from(a.attributes);for(const n of s)t.includes(n.name)||a.removeAttribute(n.name);_(a)}}function S(e){return k(function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}(e).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"))}function C(e){if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://"))return e;if(e.startsWith("data:")||e.startsWith("blob:"))return e;if(e.startsWith("ipfs://")){return A(e.replace("ipfs://",""))}if(e.includes("/ipfs/")){return A(e.split("/ipfs/")[1])}return e.startsWith("Qm")&&e.length>40||e.length>40&&/^[a-zA-Z0-9]+$/.test(e),A(e)}function A(e){const t=qe.IPFS.GATEWAYS;return`${t[Math.floor(Math.random()*t.length)]}${e.replace(/^\/?(ipfs\/)?/,"")}`}function T(e){return ns[e]||null}function P(e){return{platinum:{icon:"\ud83d\udc8e",label:"Platinum",className:"tier-platinum",color:"#e5e4e2"},partner:{icon:"\ud83e\udd1d",label:"Partner",className:"tier-partner",color:"#667eea"},gold:{icon:"\ud83e\udd47",label:"Gold",className:"tier-gold",color:"#ffd700"},silver:{icon:"\ud83e\udd48",label:"Silver",className:"tier-silver",color:"#c0c0c0"},bronze:{icon:"\ud83e\udd49",label:"Bronze",className:"tier-bronze",color:"#cd7f32"}}[e]}function E(e,t){return e?e*parseFloat(t.weight)/1e15:0}function I(e,t){if(t<=0)return 0;const a=parseFloat(e.max_price.split(" ")[0]),s=parseFloat(e.min_price.split(" ")[0]);let n=0,i=parseFloat(e.utilization),r=parseFloat(i)+parseFloat(t);i<parseFloat(e.adjusted_utilization)&&(n+=(t=>{let n=s;const i=e.exponent-1;return i<=0?a:(n+=(a-s)*Math.pow(parseFloat(t)/e.weight,i),n)})(parseFloat(e.adjusted_utilization))*Math.min(parseFloat(t),parseFloat(e.adjusted_utilization)-parseFloat(i))/parseFloat(e.weight),i=parseFloat(e.adjusted_utilization)),i<r&&(n+=((t,n)=>{const i=(a-s)/parseFloat(e.exponent),r=t/parseFloat(e.weight),l=n/parseFloat(e.weight);return s*l-s*r+i*(Math.pow(l,parseFloat(e.exponent))-Math.pow(r,parseFloat(e.exponent)))})(i,r));return n<1e-8?n<1e-8?1e-8.toFixed(8):n.toPrecision(1).replace(/e-9/,"0.00000000"):n.toFixed(8)}function F(e,t,a,s){const n=E(e,a),i=E(t,s);return{cpuAmount:n,netAmount:i,cpuFee:I(a,n),netFee:I(s,i)}}function $(){return D.useEffect(()=>{st.trackEvent("app_initialized",{timestamp:Date.now(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}}),vt.initialize().then(()=>{De.info("Accessibility service ready","App"),st.trackEvent("accessibility_service_ready",{preferences:vt.getPreferences()})}).catch(e=>{De.error("Failed to initialize accessibility service","App",e),st.reportError(e,"accessibility_init_error")}),Nt.initialize().then(e=>{e?(De.info("Push notification service initialized successfully","App"),st.trackEvent("push_service_ready",{supported:Nt.getPermissionState().supported})):De.warn("Push notification service initialization failed","App")}).catch(e=>{De.error("Push notification service initialization error","App",e),st.reportError(e,"push_service_init_error")}),Je.preloadConfiguration().then(()=>{De.info("Marketplace configuration preloaded successfully","App"),st.trackEvent("marketplace_config_preloaded",{timestamp:Date.now()})}).catch(e=>{De.warn("Failed to preload marketplace configuration","App",{error:e}),st.reportError(e,"marketplace_config_preload_error")})},[]),Se.jsx(pn,{children:Se.jsx(Oa,{children:Se.jsx(ws,{children:Se.jsx(tt,{children:Se.jsxs(ft,{children:[Se.jsx(q,{basename:"/market-alphatest",children:Se.jsx(bn,{})}),Se.jsx(xn,{}),Se.jsx(un,{}),Se.jsx(hn,{}),Se.jsx(mn,{}),Se.jsx(rs,{}),Se.jsx(vn,{}),Se.jsx(yn,{}),Se.jsx(jn,{})]})})})})})}var L=Object.defineProperty,M=(e,t,a)=>((e,t,a)=>t in e?L(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);import{r as R,b as W,c as O,R as D,L as U,u as B,d as z,e as X,f as H,B as q,h as J,i as V,j as G}from"./vendor-18oYYS7b.js";import{_ as K,W as Y,a as Q,b as Z}from"./wallets-4z7hQ1Rq.js";import{t as ee,F as te,u as ae,v as se,b as ne,s as ie,w as re,x as le,U as oe,T as ce,y as de,z as ue,D as he,E as me,N as pe,r as fe,G as xe,H as ge}from"./wharfkit-CLpwvJ3D.js";!function(){function e(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const a of t)if("childList"===a.type)for(const t of a.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}}();var ve,ye,je,be,Ne,we,ke={exports:{}},_e={},Se=(ye||(ye=1,ke.exports=function(){function e(e,a,s){var n=null;if(void 0!==s&&(n=""+s),void 0!==a.key&&(n=""+a.key),"key"in a)for(var i in s={},a)"key"!==i&&(s[i]=a[i]);else s=a;return a=s.ref,{$$typeof:t,type:e,key:n,ref:void 0!==a?a:null,props:s}}if(ve)return _e;ve=1;var t=Symbol.for("react.transitional.element"),a=Symbol.for("react.fragment");return _e.Fragment=a,_e.jsx=e,_e.jsxs=e,_e}()),ke.exports),Ce={exports:{}},Ae={},Te={exports:{}},Pe={},Ee=(we||(we=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),Ce.exports=t()),Ce.exports);const Ie=O.createContext(void 0),Fe=()=>{const e=O.useContext(Ie);if(void 0===e)throw new Error("useWallet must be used within a WalletProvider");return e},$e=class e{static getMessage(t){return e.MESSAGES[t]}static createMessage(e,t,a){return{title:e,message:t,action:a}}static formatError(t,a){if(t instanceof Error){const a=t.message.toLowerCase(),s=t.name.toLowerCase();return a.includes("network")||a.includes("fetch")||a.includes("connection")?e.MESSAGES.NETWORK_ERROR:a.includes("timeout")||a.includes("aborted")||s.includes("timeout")?e.MESSAGES.TIMEOUT_ERROR:a.includes("rejected")||a.includes("cancelled")?e.MESSAGES.TRANSACTION_REJECTED:a.includes("insufficient")?e.MESSAGES.INSUFFICIENT_BALANCE:a.includes("not found")?e.MESSAGES.NFT_NOT_FOUND:"chunkloaderror"===s?e.MESSAGES.LOAD_FAILED:a.includes("api")||a.includes("http")||a.includes("server")?e.MESSAGES.API_ERROR:"localhost"===window.location.hostname?e.createMessage(`Error: ${t.name}`,t.message,"Retry"):e.createMessage("Error","An error occurred while processing your request.","Retry")}return a||e.MESSAGES.UNKNOWN_ERROR}static logError(e,t,a){K(async()=>{const{log:e}=await Promise.resolve().then(()=>Ue);return{log:e}},void 0).then(({log:s})=>{const n=t instanceof Error?t:new Error(String(t));s.error(`Error in ${e}`,e,n,a)}).catch(()=>{console.error(`Error in ${e}:`,t,a)})}};M($e,"MESSAGES",{NETWORK_ERROR:{title:"Connection Error",message:"Unable to connect to the server. Please check your internet connection and try again.",action:"Retry"},TIMEOUT_ERROR:{title:"Request Timeout",message:"The request took too long to complete. Please try again.",action:"Retry"},API_ERROR:{title:"Service Unavailable",message:"The service is temporarily unavailable. Please try again in a moment.",action:"Retry"},LOAD_FAILED:{title:"Loading Failed",message:"Failed to load data. Please refresh the page or try again later.",action:"Refresh"},WALLET_CONNECTION_FAILED:{title:"Wallet Connection Failed",message:"Unable to connect to your wallet. Please ensure your wallet is unlocked and try again.",action:"Retry"},WALLET_DISCONNECTED:{title:"Wallet Disconnected",message:"Your wallet has been disconnected. Please reconnect to continue.",action:"Connect Wallet"},INSUFFICIENT_BALANCE:{title:"Insufficient Balance",message:"You do not have enough balance to complete this transaction.",action:"Add Funds"},TRANSACTION_FAILED:{title:"Transaction Failed",message:"The transaction could not be completed. Please try again.",action:"Retry"},TRANSACTION_REJECTED:{title:"Transaction Rejected",message:"The transaction was rejected. Please try again if this was unintentional.",action:"Retry"},INVALID_INPUT:{title:"Invalid Input",message:"Please check your input and try again.",action:"Correct Input"},REQUIRED_FIELD:{title:"Required Field Missing",message:"Please fill in all required fields.",action:"Complete Form"},NFT_NOT_FOUND:{title:"NFT Not Found",message:"The requested NFT could not be found or may no longer be available.",action:"Go Back"},COLLECTION_NOT_FOUND:{title:"Collection Not Found",message:"The requested collection could not be found or may not exist.",action:"Browse Collections"},PURCHASE_FAILED:{title:"Purchase Failed",message:"Unable to complete the purchase. The item may no longer be available.",action:"Refresh Listings"},LISTING_FAILED:{title:"Listing Failed",message:"Unable to list your NFT. Please check your wallet and try again.",action:"Retry"},UNKNOWN_ERROR:{title:"Something Went Wrong",message:"An unexpected error occurred. Please try again or contact support if the problem persists.",action:"Retry"}});let Le=$e;const Me=function(e,t=!0){const s="string"==typeof e?parseFloat(e.replace(" WAX","")):e;if(isNaN(s))return t?"0 WAX":"0";let n;return n=a(s,s>=1e3||s>=1?4:s>=.01?6:8,0),t?`${n} WAX`:n},Re=a,We={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"};const Oe=new class{constructor(){M(this,"logLevel",We.INFO),M(this,"isDevelopment",!1),M(this,"logs",[]),M(this,"maxLogs",1e3),this.logLevel=this.isDevelopment?We.DEBUG:We.WARN}createLogEntry(e,t,a,s,n){return{timestamp:(new Date).toISOString(),level:e,message:t,context:a,data:s,error:n}}shouldLog(e){return e>=this.logLevel}storeLog(e){this.logs.push(e),this.logs.length>this.maxLogs&&this.logs.shift()}formatMessage(e){const t=e.level.toUpperCase(),a=e.context?`[${e.context}]`:"";return`${e.timestamp} ${t} ${a} ${e.message}`}debug(e,t,a){if(!this.shouldLog(We.DEBUG))return;const s=this.createLogEntry(We.DEBUG,e,t,a);this.storeLog(s),this.isDevelopment&&console.debug(this.formatMessage(s),a||"")}info(e,t,a){if(!this.shouldLog(We.INFO))return;const s=this.createLogEntry(We.INFO,e,t,a);this.storeLog(s),this.isDevelopment&&console.info(this.formatMessage(s),a||"")}warn(e,t,a){if(!this.shouldLog(We.WARN))return;const s=this.createLogEntry(We.WARN,e,t,a);this.storeLog(s),console.warn(this.formatMessage(s),a||"")}error(e,t,a,s){if(!this.shouldLog(We.ERROR))return;const n=this.createLogEntry(We.ERROR,e,t,s,a);this.storeLog(n),console.error(this.formatMessage(n),a||"",s||""),!this.isDevelopment&&a&&this.reportError(a,{message:e,context:t,data:s})}async reportError(e,t){try{const a=[this.sendToErrorReportingAPI(e,t),this.sendToLocalStorage(e,t),this.sendToConsole(e,t)];await Promise.allSettled(a)}catch(a){console.error("Failed to report error:",a),console.error("Original error:",e)}}async sendToErrorReportingAPI(e,t){try{const a={message:e.message,stack:e.stack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,userId:this.getUserId(),sessionId:this.getSessionId(),buildVersion:this.getBuildVersion(),environment:this.getEnvironment(),metadata:t},s=await fetch("/api/errors/report",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify(a)});if(!s.ok)throw new Error(`Error reporting failed: ${s.status} ${s.statusText}`);console.log("Error successfully reported to server")}catch{await this.sendToFallbackErrorService(e,t)}}async sendToFallbackErrorService(e,t){try{const a={error:{message:e.message,stack:e.stack,timestamp:(new Date).toISOString()},context:{...t,userAgent:navigator.userAgent,url:window.location.href}};"undefined"!=typeof window&&window.Sentry&&window.Sentry.captureException(e,{extra:a.context,level:"error"})}catch(a){console.warn("Fallback error reporting also failed:",a)}}async sendToLocalStorage(e,t){try{const s="error_reports",n=50,i={message:e.message,stack:e.stack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,metadata:t};let r=[];const l=localStorage.getItem(s);if(l)try{r=JSON.parse(l)}catch(a){console.warn("Failed to parse stored errors:",a)}r.unshift(i),r=r.slice(0,n),localStorage.setItem(s,JSON.stringify(r))}catch(s){console.warn("Failed to store error in localStorage:",s)}}sendToConsole(e,t){console.group(`%cERROR: ${e.message}`,"color: #ff4444; font-weight: bold; background: #ffe6e6; padding: 2px 4px; border-radius: 3px;"),t&&console.log("Metadata:",t),e.stack&&console.log("Stack:",e.stack),console.log("Timestamp:",(new Date).toISOString()),console.groupEnd()}getUserId(){return localStorage.getItem("user_id")||sessionStorage.getItem("user_id")||"anonymous"}getSessionId(){let e=sessionStorage.getItem("session_id");return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("session_id",e)),e}getAuthToken(){return localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")||""}getBuildVersion(){return"unknown"}getEnvironment(){return"production"}getLogs(e){return void 0!==e?this.logs.filter(t=>t.level>=e):[...this.logs]}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}},De={debug:(e,t,a)=>Oe.debug(e,t,a),info:(e,t,a)=>Oe.info(e,t,a),warn:(e,t,a)=>Oe.warn(e,t,a),error:(e,t,a,s)=>Oe.error(e,t,a,s)},Ue=Object.freeze(Object.defineProperty({__proto__:null,LogLevel:We,log:De,logger:Oe},Symbol.toStringTag,{value:"Module"})),Be=["Citrine","Tourmaline","Emerald","Garnet","Peridot","Jade","Sapphire","Turquoise","Pigeon Blood Ruby","Blue Rock","Black Rock","Rock"],ze=["friedfactory","pixeljourney"],Xe=["alien.worlds","prospectorsc","token.nefty"],He="781515",qe={ATOMIC_ASSETS:["https://atomic.wax.eosrio.io","https://wax-atomic.alcor.exchange","https://atomic-wax-mainnet.wecan.dev","https://wax.eosusa.io","https://wax-atomic-api.eosphere.io","https://atomic.3dkrender.com","https://aa-wax-public1.neftyblocks.com","https://atomic-wax.tacocrypto.io"],WAX_CHAIN:{EOSRIO:"https://wax.eosrio.io",WAXSWEDEN:"https://api.waxsweden.org",GREYMASS:"https://wax.greymass.com",EOSPHERE:"https://wax.eosphere.io",ALOHAEOS:"https://api.wax.alohaeos.com",PINK:"https://wax.pink.gg",CRYPTOLIONS:"https://wax.cryptolions.io",FALLBACK_ENDPOINTS:["https://wax.eosphere.io","https://wax.eosrio.io","https://api.wax.alohaeos.com","https://wax.pink.gg","https://api.waxsweden.org","https://wax.greymass.com","https://wax.cryptolions.io"],HYPERION_ENDPOINTS:["https://wax-hyperion.eosdetroit.io","https://wax.eosrio.io","https://api.waxsweden.org"],HIVEBP:"https://wax-api.hivebp.io",LIGHT_API:"https://wax.light-api.net"},SPECIALIZED:{ALCOR:"https://alcor.exchange/api/v2",DAPPLICA:"https://aa.dapplica.io",NEFTY:"https://api.neftyblocks.com"},IPFS:{GATEWAYS:["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://dweb.link/ipfs/"]},AVATAR:{DICEBEAR:"https://api.dicebear.com/7.x/identicon/svg"},HYPERION:["https://wax-hyperion.eosdetroit.io","https://wax.eosrio.io","https://api.waxsweden.org"],COINGECKO_API:"https://api.coingecko.com/api/v3/simple/price",EXCHANGE_RATE_API:"https://api.exchangerate-api.com/v4/latest/USD",SOCIAL:{TWITTER_INTENT:"https://twitter.com/intent/tweet",FACEBOOK_SHARE:"https://www.facebook.com/sharer/sharer.php",REDDIT_SUBMIT:"https://reddit.com/submit",TELEGRAM_SHARE:"https://t.me/share/url",DISCORD:"https://discord.gg/pixeljourney",ATOMICHUB_EXPLORER:"https://wax.atomichub.io/explorer",BLOKS_EXPLORER:"https://wax.bloks.io"},PIXEL_JOURNEY:{MAIN_SITE:"https://pixeljourney.xyz",DOCS:"https://docs.pixeljourney.xyz",LOGO:"/logo.png",DEFAULT_IMAGE:"https://pixeljourney.xyz/img/toppixals/10.webp",LEADERBOARD:"https://lb.pixeljourney.xyz/",CRAFTING_DOCS:"https://docs.pixeljourney.xyz/season-1/recycling-and-crafting"},DICEBEAR_API:"https://api.dicebear.com/7.x/identicon/svg",GOOGLE_FONTS:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap",WAX_WALLET:"https://wallet.wax.io"};class Je{static isValidWaxRock(e){return"none"!==e&&Be.includes(e)}static getWaxRockTypes(){return Be}static async getPartnerCollections(){const e=Date.now();if(this.configCache.partnerCollections&&this.configCache.lastFetch&&e-this.configCache.lastFetch<this.CACHE_DURATION)return this.configCache.partnerCollections;try{const{apiService:t}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),a=await t.getPartnerCollections();return this.configCache.partnerCollections=a,this.configCache.lastFetch=e,a}catch(t){return De.warn("Failed to fetch partner collections from API, using fallback","MarketplaceConfig",{error:t}),[...ze]}}static getPartnerCollectionsSync(){return this.configCache.partnerCollections||ze}static async getTokenContracts(){const e=Date.now();if(this.configCache.tokenContracts&&this.configCache.lastFetch&&e-this.configCache.lastFetch<this.CACHE_DURATION)return this.configCache.tokenContracts;try{const{apiService:t}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),a=await t.getTokenContracts();return this.configCache.tokenContracts=a,this.configCache.lastFetch=e,a}catch(t){return De.warn("Failed to fetch token contracts from API, using fallback","MarketplaceConfig",{error:t}),[...Xe]}}static getTokenContractsSync(){return this.configCache.tokenContracts||Xe}static getPixalTemplateId(){return He}static isPixalPFP(e){return e===He}static generateFiltersFromAssets(e){const t=new Set,a=new Map;t.add("All Items"),e.forEach(e=>{if(e.traits&&"object"==typeof e.traits&&null!==e.traits&&Object.keys(e.traits).forEach(t=>{const s=e.traits[t];if(s&&"none"!==s&&""!==s){const e=`${t}: ${s}`;a.set(e,(a.get(e)||0)+1)}}),e.data&&"object"==typeof e.data&&null!==e.data&&Object.keys(e.data).forEach(t=>{const s=e.data[t];if(s&&"none"!==s&&""!==s){const e=`${t}: ${s}`;a.set(e,(a.get(e)||0)+1)}}),e.collection){const t=`Collection: ${e.collection}`;a.set(t,(a.get(t)||0)+1)}if(e.schema){const t=`Schema: ${e.schema}`;a.set(t,(a.get(t)||0)+1)}});const s=Math.max(2,Math.floor(.05*e.length));return a.forEach((e,a)=>{e>=s&&t.add(a)}),Array.from(t).sort()}static async preloadConfiguration(){try{await Promise.all([this.getPartnerCollections(),this.getTokenContracts()])}catch(e){De.warn("Failed to preload marketplace configuration","MarketplaceConfig",{error:e})}}static clearCache(){this.configCache={}}}M(Je,"configCache",{}),M(Je,"CACHE_DURATION",3e5);const Ve=Object.freeze(Object.defineProperty({__proto__:null,API_ENDPOINTS:qe,MarketplaceConfigService:Je,PARTNER_COLLECTIONS:ze,PIXAL_TEMPLATE_ID:He,TOKEN_CONTRACTS:Xe,WAXROCK_TYPES:Be},Symbol.toStringTag,{value:"Module"}));const Ge=new class{constructor(){M(this,"exchangeRates",{}),M(this,"cryptoRates",{bitcoin:{usd:0},ethereum:{usd:0}}),M(this,"lastFetchTime",0),M(this,"CACHE_DURATION",6e5),M(this,"EXCHANGE_API",qe.EXCHANGE_RATE_API),M(this,"CRYPTO_API",qe.COINGECKO_API),M(this,"FALLBACK_RATES",{USD:1,EUR:.85,DKK:6.3,AED:3.67,INR:83.12,RUB:74.5,CNY:7.1,JPY:110}),M(this,"FALLBACK_CRYPTO",{bitcoin:{usd:115e3},ethereum:{usd:4e3}})}async getExchangeRates(){const e=Date.now();if(Object.keys(this.exchangeRates).length>0&&e-this.lastFetchTime<this.CACHE_DURATION)return this.exchangeRates;try{const a=await fetch(this.EXCHANGE_API,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const s=await a.json();this.exchangeRates={USD:1,EUR:s.rates?.EUR||this.FALLBACK_RATES.EUR,DKK:s.rates?.DKK||this.FALLBACK_RATES.DKK,AED:s.rates?.AED||this.FALLBACK_RATES.AED,INR:s.rates?.INR||this.FALLBACK_RATES.INR,RUB:s.rates?.RUB||this.FALLBACK_RATES.RUB,CNY:s.rates?.CNY||this.FALLBACK_RATES.CNY,JPY:s.rates?.JPY||this.FALLBACK_RATES.JPY};try{const e=await fetch(this.CRYPTO_API,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){const t=await e.json();this.cryptoRates={bitcoin:{usd:t.bitcoin?.usd||this.FALLBACK_CRYPTO.bitcoin.usd},ethereum:{usd:t.ethereum?.usd||this.FALLBACK_CRYPTO.ethereum.usd}}}}catch(t){Le.logError("CurrencyService.getCryptoRates",t),this.cryptoRates=this.FALLBACK_CRYPTO}return this.lastFetchTime=e,this.exchangeRates}catch(a){return Le.logError("CurrencyService.getExchangeRates",a,{api:this.EXCHANGE_API}),this.exchangeRates=this.FALLBACK_RATES,this.cryptoRates=this.FALLBACK_CRYPTO,this.lastFetchTime=e,this.exchangeRates}}async convertUSDToCurrency(e,t){if(e<=0)return"0.00";if("BTC"===t){await this.getExchangeRates();const t=e/this.cryptoRates.bitcoin.usd;return t>=.001?t.toFixed(6):t.toExponential(2)}if("ETH"===t){await this.getExchangeRates();const t=e/this.cryptoRates.ethereum.usd;return t>=.001?t.toFixed(6):t.toExponential(2)}const a=(await this.getExchangeRates())[t];if(!a)return"0.00";const s=e*a;return"JPY"===t?Math.round(s).toString():s.toFixed(2)}async convertWaxToCurrency(e,t){try{const{priceService:a}=await K(async()=>{const{priceService:e}=await Promise.resolve().then(()=>Ye);return{priceService:e}},void 0),s=await a.convertWaxToUSDAsync(e),n=parseFloat(s.replace(/[$,]/g,""));if("USD"===t)return s;const i=await this.convertUSDToCurrency(n,t);return this.formatCurrencyAmount(i,t)}catch(a){return Le.logError("CurrencyService.convertWaxToCurrency",a,{waxAmount:e,targetCurrency:t}),"0.00"}}formatCurrencyAmount(e,t){switch(t){case"USD":return`$${e}`;case"EUR":return`\u20ac${e}`;case"DKK":return`${e} kr`;case"AED":return`${e} \u062f.\u0625`;case"INR":return`\u20b9${e}`;case"RUB":return`${e} \u20bd`;case"CNY":case"JPY":return`\xa5${e}`;case"BTC":return`\u20bf${e}`;case"ETH":return`\u039e${e}`;default:return`${e} ${t}`}}getCurrencySymbol(e){return{USD:"$",EUR:"\u20ac",DKK:"kr",AED:"\u062f.\u0625",INR:"\u20b9",RUB:"\u20bd",CNY:"\xa5",JPY:"\xa5",BTC:"\u20bf",ETH:"\u039e"}[e]||e}};const Ke=new class{constructor(){M(this,"waxPriceUSD",.02),M(this,"wpixalPriceUSD",2e-5),M(this,"wpixalPriceWAX",.001),M(this,"pxjPriceUSD",1e-4),M(this,"lastFetchTime",0),M(this,"CACHE_DURATION",3e5),M(this,"COINGECKO_WAX_API","https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),M(this,"GECKOTERMINAL_WPIXAL_API","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:7845"),M(this,"GECKOTERMINAL_PXJ_POOLS",["https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:1195","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:1657","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:6560"]),M(this,"FALLBACK_WAX_PRICE",.02),M(this,"FALLBACK_WPIXAL_PRICE",2e-5),M(this,"FALLBACK_PXJ_PRICE",1e-4)}async fetchPrices(){const e=Date.now();if(!(e-this.lastFetchTime<this.CACHE_DURATION&&this.waxPriceUSD>0&&this.wpixalPriceUSD>0))try{const[a,s,...n]=await Promise.all([fetch(this.COINGECKO_WAX_API).catch(()=>null),fetch(this.GECKOTERMINAL_WPIXAL_API).catch(()=>null),...this.GECKOTERMINAL_PXJ_POOLS.map(e=>fetch(e).catch(()=>null))]);let i=null;if(a&&a.ok)try{const e=await a.json();i=e.wax?.usd}catch(t){De.warn("Failed to parse WAX price data:","PriceService.fetchPrices",{error:t})}let r=null;if(s&&s.ok)try{const e=await s.json();r=e.data?.attributes?.quote_token_price_usd,r&&(r=parseFloat(r))}catch(t){De.warn("Failed to parse WPIXAL price data:","PriceService.fetchPrices",{error:t})}let l=null;for(const e of n)if(e&&e.ok)try{const t=await e.json(),a=t.data?.attributes?.quote_token_price_usd;if(a){l=parseFloat(a);break}}catch(t){De.warn("Failed to parse PXJ price data from pool:","PriceService.fetchPrices",{error:t})}this.waxPriceUSD=i||this.FALLBACK_WAX_PRICE,this.wpixalPriceUSD=r||this.FALLBACK_WPIXAL_PRICE,this.pxjPriceUSD=l||this.FALLBACK_PXJ_PRICE,this.waxPriceUSD>0?this.wpixalPriceWAX=this.wpixalPriceUSD/this.waxPriceUSD:this.wpixalPriceWAX=.001,this.lastFetchTime=e}catch(t){Le.logError("PriceService.fetchPrices",t,{waxApi:this.COINGECKO_WAX_API,wpixalApi:this.GECKOTERMINAL_WPIXAL_API,pxjPools:this.GECKOTERMINAL_PXJ_POOLS,fallbackWaxPrice:this.FALLBACK_WAX_PRICE,fallbackWpixalPrice:this.FALLBACK_WPIXAL_PRICE,fallbackPxjPrice:this.FALLBACK_PXJ_PRICE}),this.waxPriceUSD=this.FALLBACK_WAX_PRICE,this.wpixalPriceUSD=this.FALLBACK_WPIXAL_PRICE,this.pxjPriceUSD=this.FALLBACK_PXJ_PRICE,this.wpixalPriceWAX=this.FALLBACK_WPIXAL_PRICE/this.FALLBACK_WAX_PRICE,this.lastFetchTime=e}}async getWaxPriceUSD(){return await this.fetchPrices(),this.waxPriceUSD}async getWpixalPriceWAX(){return await this.fetchPrices(),this.wpixalPriceWAX}async getWpixalPriceUSD(){return await this.fetchPrices(),this.wpixalPriceUSD}async getPxjPriceUSD(){return await this.fetchPrices(),this.pxjPriceUSD}convertWaxToUSD(e){const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t)||this.waxPriceUSD<=0)return"$0.00";const a=t*this.waxPriceUSD;return`$${Re(a,2)}`}async convertWaxToUSDAsync(e){return await this.getWaxPriceUSD(),this.convertWaxToUSD(e)}async convertWaxToCurrencyAsync(e,t="USD"){return"USD"===t?this.convertWaxToUSDAsync(e):Ge.convertWaxToCurrency(e,t)}async convertWpixalToWAX(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"0.0000 WAX";const a=await this.getWpixalPriceWAX();return Me(t*a)}catch(t){return Le.logError("PriceService.convertWpixalToWAX",t,{wpixalAmount:e}),"0.0000 WAX"}}async convertWpixalToUSD(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"$0.00";const a=await this.getWpixalPriceUSD();return`$${Re(t*a,2)}`}catch(t){return Le.logError("PriceService.convertWpixalToUSD",t,{wpixalAmount:e}),"$0.00"}}async convertPxjToUSD(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"$0.00";const a=await this.getPxjPriceUSD();return`$${Re(t*a,6)}`}catch(t){return Le.logError("PriceService.convertPxjToUSD",t,{pxjAmount:e}),"$0.00"}}async convertPxjToWAX(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"0.0000 WAX";const a=await this.getPxjPriceUSD(),s=await this.getWaxPriceUSD();return Me(t*a/s)}catch(t){return Le.logError("PriceService.convertPxjToWAX",t,{pxjAmount:e}),"0.0000 WAX"}}async convertWaxWithDisplaySettings(e){try{const t=localStorage.getItem("selectedCurrency")||"USD";if(!JSON.parse(localStorage.getItem("showPricesInUSD")||"true")){const t=parseFloat(e.replace(/[^0-9.]/g,""));return Me(t)}return this.convertWaxToCurrencyAsync(e,t)}catch(t){return Le.logError("PriceService.convertWaxWithDisplaySettings",t,{waxAmount:e}),this.convertWaxToUSDAsync(e)}}},Ye=Object.freeze(Object.defineProperty({__proto__:null,priceService:Ke},Symbol.toStringTag,{value:"Module"}));const Qe=new class{isStorageAvailable(e){try{const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch{return!1}}get isLocalStorageAvailable(){return"undefined"!=typeof window&&this.isStorageAvailable(localStorage)}get isSessionStorageAvailable(){return"undefined"!=typeof window&&this.isStorageAvailable(sessionStorage)}getItem(e,t=!1){try{const a=t?sessionStorage:localStorage;if(t&&this.isSessionStorageAvailable)return a.getItem(e);if(!t&&this.isLocalStorageAvailable)return a.getItem(e);const s=t?localStorage:sessionStorage;return(t?this.isLocalStorageAvailable:this.isSessionStorageAvailable)?(Oe.warn(`Primary storage unavailable, using fallback for key: ${e}`),s.getItem(e)):(Oe.warn(`No storage available for key: ${e}`),null)}catch(a){return Oe.error("StorageService.getItem failed","StorageService",a,{key:e,useSessionStorage:t}),null}}setItem(e,t,a=!1){try{const s=a?sessionStorage:localStorage;if(a&&this.isSessionStorageAvailable)return s.setItem(e,t),!0;if(!a&&this.isLocalStorageAvailable)return s.setItem(e,t),!0;const n=a?localStorage:sessionStorage;return(a?this.isLocalStorageAvailable:this.isSessionStorageAvailable)?(Oe.warn(`Primary storage unavailable, using fallback for key: ${e}`),n.setItem(e,t),!0):(Oe.warn(`No storage available for key: ${e}`),!1)}catch(s){return Oe.error("StorageService.setItem failed","StorageService",s,{key:e,useSessionStorage:a}),!1}}removeItem(e,t=!1){try{const a=t?sessionStorage:localStorage;if(t&&this.isSessionStorageAvailable)return a.removeItem(e),!0;if(!t&&this.isLocalStorageAvailable)return a.removeItem(e),!0;let s=!1;return this.isLocalStorageAvailable&&(localStorage.removeItem(e),s=!0),this.isSessionStorageAvailable&&(sessionStorage.removeItem(e),s=!0),s||Oe.warn(`No storage available to remove key: ${e}`),s}catch(a){return Oe.error("StorageService.removeItem failed","StorageService",a,{key:e,useSessionStorage:t}),!1}}clear(e=!1){try{const t=e?sessionStorage:localStorage;return e&&this.isSessionStorageAvailable||!e&&this.isLocalStorageAvailable?(t.clear(),!0):(Oe.warn("No storage available to clear"),!1)}catch(t){return Oe.error("StorageService.clear failed","StorageService",t,{useSessionStorage:e}),!1}}getJSON(e,t,a=!1){try{const s=this.getItem(e,a);return null===s?t:JSON.parse(s)}catch(s){return Oe.error("StorageService.getJSON failed","StorageService",s,{key:e,useSessionStorage:a}),t}}setJSON(e,t,a=!1){try{const s=JSON.stringify(t);return this.setItem(e,s,a)}catch(s){return Oe.error("StorageService.setJSON failed","StorageService",s,{key:e,useSessionStorage:a}),!1}}getStorageStats(){const e=e=>{try{let t=0;for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t+=e[a].length+a.length);return{used:t,total:5242880}}catch{return{used:0,total:0}}};return{localStorage:{available:this.isLocalStorageAvailable,...e(this.isLocalStorageAvailable?localStorage:{})},sessionStorage:{available:this.isSessionStorageAvailable,...e(this.isSessionStorageAvailable?sessionStorage:{})}}}isQuotaExceeded(){const e=this.getStorageStats(),t=e.localStorage.used/e.localStorage.total,a=e.sessionStorage.used/e.sessionStorage.total;return t>.9||a>.9}cleanup(e=[]){let t=0;try{const a=[{storage:localStorage,available:this.isLocalStorageAvailable},{storage:sessionStorage,available:this.isSessionStorageAvailable}];for(const{storage:s,available:n}of a){if(!n)continue;const a=[];for(let t=0;t<s.length;t++){const n=s.key(t);if(n)for(const t of e)if(n.includes(t)){a.push(n);break}}for(const e of a)s.removeItem(e),t++}}catch(a){Oe.error("StorageService.cleanup failed","StorageService",a,{keyPatterns:e})}return t}};const Ze=new class{constructor(){M(this,"storageKey","pixal-marketplace-cart"),M(this,"cart",[]),M(this,"listeners",[]),this.loadCart()}loadCart(){try{this.cart=Qe.getJSON(this.storageKey,[])}catch(e){Le.logError("CartService.loadCart",e),this.cart=[]}}saveCart(){try{Qe.setJSON(this.storageKey,this.cart)||Le.logError("CartService.saveCart",new Error("Failed to save cart to storage"),{storageKey:this.storageKey,cartSize:this.cart.length}),this.notifyListeners()}catch(e){Le.logError("CartService.saveCart",e,{storageKey:this.storageKey,cartSize:this.cart.length})}}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.listeners.forEach(e=>e([...this.cart]))}addToCart(e){if(-1!==this.cart.findIndex(t=>t.nft.asset_id===e.asset_id))return!1;const t={nft:e,addedAt:Date.now(),isAvailable:!0,sale_id:e.sale_id};return this.cart.push(t),this.saveCart(),!0}removeFromCart(e){const t=this.cart.length;return this.cart=this.cart.filter(t=>t.nft.asset_id!==e),this.cart.length!==t&&(this.saveCart(),!0)}isInCart(e){return this.cart.some(t=>t.nft.asset_id===e)}getCart(){return[...this.cart]}getCartCount(){return this.cart.length}clearCart(){this.cart=[],this.saveCart()}cleanupUnavailableItems(){const e=this.cart.length;this.cart=this.cart.filter(e=>!1!==e.isAvailable),this.cart.length!==e&&this.saveCart()}async calculateTotals(){const e=this.cart.filter(e=>!1!==e.isAvailable);let t=0;e.forEach(e=>{if(e.nft.price){const a=parseFloat(e.nft.price.replace(" WAX",""));isNaN(a)||(t+=a)}});const a=`${t.toFixed(4)} WAX`;return{totalWAX:a,totalUSD:await Ke.convertWaxToUSDAsync(a),itemCount:e.length}}async checkAvailability(){if(0===this.cart.length)return;const{apiService:e}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0);try{const t=this.cart.map(e=>e.sale_id).filter(Boolean);if(0===t.length)return;const a=`${e.atomicMarketAPI}/atomicmarket/v1/sales?ids=${t.join(",")}&state=1&limit=${t.length}`,s=await e.fetchWithRetry(a),n=await s.json(),i=new Set(n.success&&n.data?n.data.map(e=>e.sale_id):[]);for(const e of this.cart)e.isAvailable=!!e.sale_id&&i.has(e.sale_id)}catch(t){Le.logError("CartService.checkAvailability",t,{cartSize:this.cart.length});for(const e of this.cart)e.isAvailable=!1}this.saveCart()}toggleSelection(e){const t=this.cart.find(t=>t.nft.asset_id===e);t&&(t.selected=!t.selected,this.saveCart())}selectAll(){this.cart.forEach(e=>{!1!==e.isAvailable&&(e.selected=!0)}),this.saveCart()}deselectAll(){this.cart.forEach(e=>{e.selected=!1}),this.saveCart()}getSelectedItems(){return this.cart.filter(e=>!0===e.selected)}getSelectedCount(){return this.cart.filter(e=>!0===e.selected).length}removeSelectedItems(){this.cart=this.cart.filter(e=>!0!==e.selected),this.saveCart()}isSelected(e){const t=this.cart.find(t=>t.nft.asset_id===e);return!0===t?.selected}},et=O.createContext(void 0),tt=({children:e})=>{const[t,a]=O.useState(()=>({showOtherCollections:JSON.parse(localStorage.getItem("showOtherCollections")||"true"),showWhitelistedOnly:JSON.parse(localStorage.getItem("showWhitelistedOnly")||"true"),enableAnimatedNFTs:JSON.parse(localStorage.getItem("enableAnimatedNFTs")||"true"),showExplicitContent:JSON.parse(localStorage.getItem("showExplicitContent")||"false"),blockNSFW:JSON.parse(localStorage.getItem("blockNSFW")||"false"),blockAI:JSON.parse(localStorage.getItem("blockAI")||"false"),showChatButton:JSON.parse(localStorage.getItem("showChatButton")||"true"),autoPlayVideos:JSON.parse(localStorage.getItem("autoPlayVideos")||"false"),muteVideos:JSON.parse(localStorage.getItem("muteVideos")||"true"),showVideoControls:JSON.parse(localStorage.getItem("showVideoControls")||"true"),showPricesInUSD:JSON.parse(localStorage.getItem("showPricesInUSD")||"true"),selectedCurrency:localStorage.getItem("selectedCurrency")||"USD",showRarityRankings:JSON.parse(localStorage.getItem("showRarityRankings")||"true")})),s={settings:t,updateSetting:(e,t)=>{a(a=>{const s={...a,[e]:t};return"string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)),s})}};return Se.jsx(et.Provider,{value:s,children:e})},at=()=>{const e=O.useContext(et);if(void 0===e)throw new Error("useDisplaySettings must be used within a DisplaySettingsProvider");return e};const st=new class{constructor(){M(this,"sessionId"),M(this,"userId"),M(this,"session"),M(this,"performanceMetrics",[]),M(this,"apiMetrics",[]),M(this,"errorReports",[]),M(this,"isEnabled",!0),M(this,"batchSize",50),M(this,"flushInterval",3e4),M(this,"maxStoredMetrics",1e3),M(this,"pendingBatches",[]),M(this,"batchTimeout",null),this.sessionId=this.generateSessionId(),this.session={sessionId:this.sessionId,startTime:Date.now(),lastActivity:Date.now(),pageViews:0,events:[]},this.initializeMonitoring(),this.startPerformanceObserver(),this.setupErrorHandlers(),this.startFlushTimer()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}initializeMonitoring(){"undefined"!=typeof window&&window.performance&&(window.addEventListener("load",()=>{setTimeout(()=>{this.trackPageLoadPerformance()},0)}),document.addEventListener("visibilitychange",()=>{this.trackEvent("page_visibility_change",{hidden:document.hidden})}),this.setupUserInteractionTracking())}startPerformanceObserver(){if("undefined"!=typeof window&&"PerformanceObserver"in window)try{new PerformanceObserver(e=>{for(const t of e.getEntries())"navigation"===t.entryType&&this.trackNavigationTiming(t)}).observe({entryTypes:["navigation"]});new PerformanceObserver(e=>{for(const t of e.getEntries())"resource"===t.entryType&&this.trackResourceTiming(t)}).observe({entryTypes:["resource"]});new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformanceMetric("largest_contentful_paint",t.startTime)}).observe({entryTypes:["largest-contentful-paint"]});new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformanceMetric("first_input_delay",t.processingStart-t.startTime)}).observe({entryTypes:["first-input"]})}catch(e){De.warn("Performance Observer not fully supported","MonitoringService.startPerformanceObserver",{error:e})}}setupErrorHandlers(){"undefined"!=typeof window&&(window.addEventListener("error",e=>{this.reportError(e.error||new Error(e.message),"global_error",{filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{this.reportError(e.reason instanceof Error?e.reason:new Error(String(e.reason)),"unhandled_promise_rejection")}))}setupUserInteractionTracking(){"undefined"!=typeof window&&(document.addEventListener("click",e=>{const t=e.target;t.matches('button, a, [role="button"], .clickable')&&this.trackEvent("user_click",{element:t.tagName.toLowerCase(),className:t.className,id:t.id,text:t.textContent?.slice(0,50)})}),document.addEventListener("submit",e=>{const t=e.target;this.trackEvent("form_submit",{formId:t.id,formClass:t.className,action:t.action})}))}startFlushTimer(){setInterval(()=>{this.flushMetrics()},this.flushInterval)}setUserId(e){this.userId=e,this.session.userId=e}trackEvent(e,t={}){if(!this.isEnabled)return;const a={event:e,properties:t,timestamp:Date.now(),userId:this.userId,sessionId:this.sessionId};this.session.events.push(a),this.session.lastActivity=Date.now(),this.addToBatch("events",a),this.session.events.length>this.maxStoredMetrics&&(this.session.events=this.session.events.slice(-this.maxStoredMetrics/2))}trackPerformanceMetric(e,t,a){if(!this.isEnabled)return;const s={name:e,value:t,timestamp:Date.now(),context:a};this.performanceMetrics.push(s),this.addToBatch("performance",s),this.performanceMetrics.length>this.maxStoredMetrics&&(this.performanceMetrics=this.performanceMetrics.slice(-this.maxStoredMetrics/2))}trackAPICall(e,t,a,s,n,i){if(!this.isEnabled)return;const r={endpoint:e,method:t,duration:a,status:s,timestamp:Date.now(),success:n,retryCount:i};this.apiMetrics.push(r),this.addToBatch("api",r),a>5e3&&this.trackPerformanceMetric("slow_api_call",a,{endpoint:e,method:t,status:s}),this.apiMetrics.length>this.maxStoredMetrics&&(this.apiMetrics=this.apiMetrics.slice(-this.maxStoredMetrics/2))}reportError(e,t,a){if(!this.isEnabled)return;De.error(`${t}: ${e.message}`,"monitoringService.reportError",e,{...a});const s={error:e,context:t,additionalInfo:a,timestamp:Date.now(),userId:this.userId,sessionId:this.sessionId,userAgent:navigator.userAgent,url:window.location.href,stackTrace:e.stack};this.errorReports.push(s),this.trackEvent("error_occurred",{context:t,errorName:e.name,errorMessage:e.message,...a}),this.errorReports.length>this.maxStoredMetrics&&(this.errorReports=this.errorReports.slice(-this.maxStoredMetrics/2))}trackPageLoadPerformance(){if(!window.performance||!window.performance.timing)return;const e=window.performance.timing,t=window.performance.navigation,a=e.loadEventEnd-e.navigationStart,s=e.domContentLoadedEventEnd-e.navigationStart,n=e.responseStart-e.navigationStart,i=e.domInteractive-e.navigationStart;this.trackPerformanceMetric("page_load_time",a),this.trackPerformanceMetric("dom_content_loaded_time",s),this.trackPerformanceMetric("first_byte_time",n),this.trackPerformanceMetric("dom_interactive_time",i),this.trackEvent("page_load",{pageLoadTime:a,domContentLoadedTime:s,firstByteTime:n,domInteractiveTime:i,navigationType:t.type,redirectCount:t.redirectCount})}trackNavigationTiming(e){this.trackPerformanceMetric("dns_lookup_time",e.domainLookupEnd-e.domainLookupStart),this.trackPerformanceMetric("tcp_connect_time",e.connectEnd-e.connectStart),this.trackPerformanceMetric("request_response_time",e.responseEnd-e.requestStart),this.trackPerformanceMetric("dom_processing_time",e.domComplete-e.domContentLoadedEventStart)}trackResourceTiming(e){(e.name.includes(".js")||e.name.includes(".css")||e.name.includes("api"))&&this.trackPerformanceMetric("resource_load_time",e.duration,{resource:e.name,type:e.initiatorType,size:e.transferSize})}getSessionSummary(){return{...this.session,events:[...this.session.events]}}getPerformanceMetrics(){return[...this.performanceMetrics]}getAPIMetrics(){return[...this.apiMetrics]}getErrorReports(){return[...this.errorReports]}async flushMetrics(){if(!this.isEnabled)return;const e={session:this.getSessionSummary(),performance:this.getPerformanceMetrics(),api:this.getAPIMetrics(),errors:this.getErrorReports(),timestamp:Date.now()};try{const t=JSON.parse(localStorage.getItem("monitoring_data")||"[]");t.push(e);const a=t.slice(-10);localStorage.setItem("monitoring_data",JSON.stringify(a))}catch(t){De.warn("Failed to store monitoring data","MonitoringService.flushMetrics",{error:t})}this.performanceMetrics=[],this.apiMetrics=[],this.errorReports=[],this.session.events=[]}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}isMonitoringEnabled(){return this.isEnabled}setBatchSize(e){this.batchSize=Math.max(10,Math.min(e,200))}addToBatch(e,t){if(!this.isEnabled)return;let a=this.pendingBatches.find(t=>t.type===e);a||(a={type:e,data:[],timestamp:Date.now()},this.pendingBatches.push(a)),a.data.push(t),a.data.length>=this.batchSize&&(this.processBatch(a),this.pendingBatches=this.pendingBatches.filter(e=>e!==a)),this.scheduleBatchProcessing()}scheduleBatchProcessing(){this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.processAllPendingBatches()},5e3)}async processBatch(e){try{const t={...e,batchId:this.generateBatchId(),processedAt:Date.now()},a=JSON.parse(localStorage.getItem("monitoring_batches")||"[]");a.push(t);const s=a.slice(-20);localStorage.setItem("monitoring_batches",JSON.stringify(s))}catch(t){console.warn("Failed to process batch:",t)}}async processAllPendingBatches(){const e=[...this.pendingBatches];this.pendingBatches=[];for(const t of e)await this.processBatch(t);this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null)}generateBatchId(){return`batch_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setFlushInterval(e){this.flushInterval=Math.max(5e3,Math.min(e,3e5))}async exportData(){const e={session:this.getSessionSummary(),performance:this.getPerformanceMetrics(),api:this.getAPIMetrics(),errors:this.getErrorReports()};return JSON.stringify(e,null,2)}clearAllData(){this.performanceMetrics=[],this.apiMetrics=[],this.errorReports=[],this.session.events=[],localStorage.removeItem("monitoring_data")}};class nt{constructor(e={}){M(this,"cache",new Map),M(this,"config"),M(this,"cleanupTimer",null),this.config={defaultTTL:3e5,maxSize:1e3,cleanupInterval:6e4,...e},this.startCleanup()}startCleanup(){this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}cleanup(){const e=Date.now(),t=[];for(const[a,s]of this.cache.entries())e-s.timestamp>s.ttl&&t.push(a);if(t.forEach(e=>this.cache.delete(e)),this.cache.size>this.config.maxSize){Array.from(this.cache.entries()).sort(([,e],[,t])=>e.timestamp-t.timestamp).slice(0,this.cache.size-this.config.maxSize).forEach(([e])=>this.cache.delete(e))}}set(e,t,a){const s={data:t,timestamp:Date.now(),ttl:a||this.config.defaultTTL};this.cache.set(e,s)}get(e){const t=this.cache.get(e);if(!t)return null;return Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data}has(e){const t=this.cache.get(e);if(!t)return!1;return!(Date.now()-t.timestamp>t.ttl)||(this.cache.delete(e),!1)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}async getOrFetch(e,t,a){const s=this.get(e);if(null!==s)return s;const n=await t();return this.set(e,n,a),n}setMany(e){e.forEach(({key:e,data:t,ttl:a})=>{this.set(e,t,a)})}getMany(e){return e.map(e=>({key:e,data:this.get(e)}))}getStats(){const e=Date.now();let t=0,a=0;for(const s of this.cache.values())e-s.timestamp>s.ttl?a++:t++;return{totalEntries:this.cache.size,validEntries:t,expiredEntries:a,hitRate:t/(t+a)||0}}destroy(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null),this.clear()}}const it=new nt({defaultTTL:3e5,maxSize:1e3,cleanupInterval:6e4}),rt=new nt({defaultTTL:6e5,maxSize:500,cleanupInterval:12e4}),lt=new nt({defaultTTL:18e5,maxSize:200,cleanupInterval:3e5}),ot=new nt({defaultTTL:12e4,maxSize:100,cleanupInterval:3e4});const ct=new class{constructor(){M(this,"endpointGroups",new Map),M(this,"HEALTH_CHECK_TIMEOUT",5e3),M(this,"MAX_CONSECUTIVE_FAILURES",3),M(this,"HEALTH_CHECK_INTERVAL",3e5),M(this,"healthCheckTimers",new Map),this.initializeEndpointGroups(),this.startHealthChecks()}initializeEndpointGroups(){this.endpointGroups.set("atomic",{name:"atomic",currentIndex:0,fallbackStrategy:"priority",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://atomic.wax.eosrio.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax-atomic.alcor.exchange",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://atomic-wax-mainnet.wecan.dev",priority:3,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax.eosusa.io",priority:4,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3}]}),this.endpointGroups.set("waxChain",{name:"waxChain",currentIndex:0,fallbackStrategy:"priority",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://wax.eosphere.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax.eosrio.io",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://api.wax.alohaeos.com",priority:3,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3}]}),this.endpointGroups.set("hyperion",{name:"hyperion",currentIndex:0,fallbackStrategy:"fastest",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://wax.eosrio.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:2},{url:"https://api.wax.alohaeos.com",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:2}]})}getBestEndpoint(e){const t=this.endpointGroups.get(e);if(!t)return null;const a=t.endpoints.filter(e=>"healthy"===e.healthStatus);if(0===a.length){const e=t.endpoints.filter(e=>"degraded"===e.healthStatus);return e.length>0?this.selectEndpoint(e,t.fallbackStrategy):t.endpoints[0]?.url||null}return this.selectEndpoint(a,t.fallbackStrategy)}selectEndpoint(e,t){switch(t){case"priority":return e.sort((e,t)=>e.priority-t.priority)[0].url;case"fastest":return e.sort((e,t)=>e.averageResponseTime-t.averageResponseTime)[0].url;default:return e[Math.floor(Math.random()*e.length)].url}}reportFailure(e,t){const a=this.endpointGroups.get(e);if(!a)return;const s=a.endpoints.find(e=>e.url===t);s&&(s.consecutiveFailures++,s.consecutiveFailures>=this.MAX_CONSECUTIVE_FAILURES?s.healthStatus="unhealthy":s.consecutiveFailures>=1&&(s.healthStatus="degraded"))}reportSuccess(e,t,a){const s=this.endpointGroups.get(e);if(!s)return;const n=s.endpoints.find(e=>e.url===t);n&&(n.consecutiveFailures=0,n.healthStatus="healthy",0===n.averageResponseTime?n.averageResponseTime=a:n.averageResponseTime=.8*n.averageResponseTime+.2*a)}getEndpoints(e){const t=this.endpointGroups.get(e);return t?t.endpoints.map(e=>e.url):[]}getCurrentIndex(e){const t=this.endpointGroups.get(e);return t?t.currentIndex:0}setCurrentIndex(e,t){const a=this.endpointGroups.get(e);a&&t>=0&&t<a.endpoints.length&&(a.currentIndex=t)}startHealthChecks(){for(const[e,t]of this.endpointGroups){const a=setInterval(()=>{this.performHealthCheck(e)},t.healthCheckInterval);this.healthCheckTimers.set(e,a)}}async performHealthCheck(e){const t=this.endpointGroups.get(e);if(!t)return;const a=t.endpoints.map(async t=>{try{const a=Date.now(),s=new AbortController,n=setTimeout(()=>s.abort(),this.HEALTH_CHECK_TIMEOUT),i=await fetch(`${t.url}/health`,{method:"GET",signal:s.signal,headers:{Accept:"application/json"}});clearTimeout(n);const r=Date.now()-a;t.lastHealthCheck=Date.now(),i.ok?this.reportSuccess(e,t.url,r):this.reportFailure(e,t.url)}catch{t.lastHealthCheck=Date.now(),this.reportFailure(e,t.url)}});await Promise.allSettled(a)}getHealthStatus(){const e={};for(const[t,a]of this.endpointGroups)e[t]={healthy:a.endpoints.filter(e=>"healthy"===e.healthStatus).length,degraded:a.endpoints.filter(e=>"degraded"===e.healthStatus).length,unhealthy:a.endpoints.filter(e=>"unhealthy"===e.healthStatus).length};return e}destroy(){for(const e of this.healthCheckTimers.values())clearInterval(e);this.healthCheckTimers.clear()}};const dt=new class{constructor(){M(this,"atomicEndpoints",[...qe.ATOMIC_ASSETS]),M(this,"hiveBPAPI",qe.WAX_CHAIN.HIVEBP),M(this,"waxLightAPI",qe.WAX_CHAIN.LIGHT_API),M(this,"alcorAPI",qe.SPECIALIZED.ALCOR),M(this,"waxChainEndpoints",[...qe.WAX_CHAIN.FALLBACK_ENDPOINTS]),M(this,"hyperionEndpoints",qe.WAX_CHAIN.HYPERION_ENDPOINTS),M(this,"currentEndpointIndex",0),M(this,"currentWaxChainIndex",0),M(this,"currentHyperionIndex",0),M(this,"adaptiveLimits",new Map),M(this,"DEFAULT_CACHE_TTL",3e5),M(this,"approvedCollections",["pixeljourney","friedfactory"]),M(this,"circuitBreakerState",new Map),M(this,"CIRCUIT_BREAKER_THRESHOLD",5),M(this,"CIRCUIT_BREAKER_TIMEOUT",6e4),M(this,"MAX_TIMEOUT",3e4),M(this,"endpointHealth",new Map),M(this,"HEALTH_CHECK_INTERVAL",3e5),M(this,"MAX_CONSECUTIVE_FAILURES",3),M(this,"healthCheckIntervalId",null),M(this,"healthConfigs",new Map),M(this,"eosNationEndpoints",{atomicEndpoints:[],waxChainEndpoints:[],hyperionEndpoints:[],lastUpdated:0}),M(this,"EOS_NATION_UPDATE_INTERVAL",36e5),M(this,"COLLECTION_WHITELIST",["alien.worlds","defiminingio","pixeljourney","crptomuffins","kogsofficial","mlb.topps","gpk.topps","warsaken","pocketsizedp","taco","pantheon","cbreakgaming","akufishheads","battleminers","twitchytides","novopangeaio","fadedmonsuta","bcbrawlers","nftopiafrens","drwawncompany","talesofcrypt","official.wax","music.worlds","gkniftyheads","dungeonitems","outlawtroops","byronartset1","prospectorsg","street.hero","crewtoonswax"]),this.currentEndpointIndex=0,this.currentWaxChainIndex=0,this.currentHyperionIndex=0,this.initializeHealthConfigs()}get waxChainAPI(){return ct.getBestEndpoint("waxChain")||this.waxChainEndpoints[this.currentWaxChainIndex]}get atomicMarketAPI(){return this.atomicEndpoints[this.currentEndpointIndex]}get atomicAssetsAPI(){return this.atomicEndpoints[this.currentEndpointIndex]}getCurrentAtomicEndpoint(){const e=ct.getBestEndpoint("atomic");if(e)return e;const t=this.getHealthyEndpoints(this.atomicEndpoints);if(t.length>0){const e=t[0];return this.currentEndpointIndex=this.atomicEndpoints.indexOf(e),e}return this.atomicEndpoints[this.currentEndpointIndex]||this.atomicEndpoints[0]}getFromCache(e){return e.startsWith("asset_")?rt.get(e):e.startsWith("collection_")?lt.get(e):e.startsWith("user_")?ot.get(e):it.get(e)}setCache(e,t,a=this.DEFAULT_CACHE_TTL){e.startsWith("asset_")?rt.set(e,t,a):e.startsWith("collection_")?lt.set(e,t,a):e.startsWith("user_")?ot.set(e,t,a):it.set(e,t,a)}reportEndpointHealth(e,t,a){try{const s=new URL(e),n=`${s.protocol}//${s.host}`;let i="atomic";(e.includes("wax.eosphere.io")||e.includes("wax.eosrio.io")||e.includes("api.wax.alohaeos.com"))&&(i=e.includes("/v2/history")||e.includes("/v1/history")?"hyperion":"waxChain"),t&&void 0!==a?ct.reportSuccess(i,n,a):t||ct.reportFailure(i,n)}catch(s){Oe.warn("Failed to report endpoint health:","ApiService.reportEndpointHealth",s)}}getCacheStats(){const e=rt.getStats(),t=lt.getStats(),a=ot.getStats(),s=it.getStats();return{totalEntries:e.totalEntries+t.totalEntries+a.totalEntries+s.totalEntries,validEntries:e.validEntries+t.validEntries+a.validEntries+s.validEntries,expiredEntries:e.expiredEntries+t.expiredEntries+a.expiredEntries+s.expiredEntries,hitRate:(e.hitRate+t.hitRate+a.hitRate+s.hitRate)/4}}clearCache(){rt.clear(),lt.clear(),ot.clear(),it.clear()}async warmupCache(e){try{const t=[],a=this.approvedCollections.slice(0,5);for(const e of a)t.push(this.getCollectionStats(e).catch(t=>Le.logError("ApiService.warmupCache.collectionStats",t,{collection:e})));t.push(this.getMarketStats().catch(e=>Le.logError("ApiService.warmupCache.marketStats",e))),e&&t.push(this.getUserInventoryOverview(e).catch(t=>Le.logError("ApiService.warmupCache.userInventory",t,{account:e}))),await Promise.allSettled(t)}catch(t){Le.logError("ApiService.warmupCache",t)}}async prefetchData(e){try{const t=[];if("marketplace"===e.currentPage&&t.push(this.getPxApprovedListings(100,100).catch(e=>Le.logError("ApiService.prefetch.marketplaceAssets",e))),"inventory"===e.currentPage&&e.userAccount&&t.push(this.getUserInventoryOptimized(e.userAccount,{page:2}).catch(t=>Le.logError("ApiService.prefetch.userInventory",t,{account:e.userAccount}))),e.recentCollections)for(const a of e.recentCollections.slice(0,3))t.push(this.getCollectionStats(a).catch(e=>Le.logError("ApiService.prefetch.recentCollection",e,{collection:a})));setTimeout(()=>{Promise.allSettled(t)},1e3)}catch(t){Le.logError("ApiService.prefetchData",t)}}invalidateCache(e){rt.clear(),lt.clear(),ot.clear(),it.clear()}getAdaptiveLimit(e,t){const a=new URL(e).hostname,s=this.adaptiveLimits.get(a);return s?Math.min(t,s,100):Math.min(t,100)}updateAdaptiveLimit(e,t,a){const s=new URL(e).hostname;if(a){if(t<100){const e=this.adaptiveLimits.get(s)||t,a=Math.min(Math.floor(1.1*e),100);this.adaptiveLimits.set(s,a)}}else{const e=Math.max(Math.floor(.7*t),20);this.adaptiveLimits.set(s,e)}}async fetchAlcorAPI(e,t=3,a){let s=null;const n=Date.now(),i=a?.method||"GET";for(let l=0;l<t;l++)try{const r=await fetch(e,{method:i,headers:{Accept:"application/json","Content-Type":"application/json",...a?.headers},mode:"cors",signal:a?.signal,...a}),o=Date.now()-n;if(r.ok)return st.trackAPICall(e,i,o,r.status,!0,l),r;s=new Error(`HTTP ${r.status}: ${r.statusText}`),l<t-1?await new Promise(e=>setTimeout(e,1e3*(l+1))):st.trackAPICall(e,i,o,r.status,!1,l)}catch(r){const a=Date.now()-n;if(s=r,l===t-1&&(st.trackAPICall(e,i,a,0,!1,l),st.reportError(s,"alcor_api_error",{url:e,method:i,retries:l+1})),r instanceof Error&&"AbortError"===r.name)throw st.reportError(r,"alcor_api_abort",{url:e,method:i}),r;l<t-1&&await new Promise(e=>setTimeout(e,1e3*(l+1)))}throw s||new Error("Failed to fetch from Alcor Exchange API")}initializeHealthConfigs(){this.healthConfigs.clear(),this.getValidatedEndpoints("atomic").forEach(e=>{this.healthConfigs.set(e,{path:"/atomicassets/v1/collections?limit=1",validator:e=>{const t=e;return Array.isArray(t.data)&&!0===t.success}})}),this.getValidatedEndpoints("waxChain").forEach(e=>{this.healthConfigs.set(e,{path:"/v1/chain/get_info",validator:e=>{const t=e;return"number"==typeof t.head_block_num&&t.head_block_num>0}})}),this.getValidatedEndpoints("hyperion").forEach(e=>{this.healthConfigs.set(e,{path:"/v2/health",validator:e=>{const t=e;return t.health&&"object"==typeof t.health&&"OK"===t.health.status||"OK"===t.health}})}),Oe.info(`[Health Config] Initialized configurations for ${this.healthConfigs.size} endpoints`)}getCircuitBreakerKey(e){try{return new URL(e).hostname}catch{return e}}isCircuitBreakerOpen(e){const t=this.circuitBreakerState.get(e);return!!t&&("open"===t.state&&(!(Date.now()-t.lastFailure>this.CIRCUIT_BREAKER_TIMEOUT)||(t.state="half-open",!1)))}recordCircuitBreakerFailure(e){const t=this.circuitBreakerState.get(e)||{failures:0,lastFailure:0,state:"closed"};t.failures++,t.lastFailure=Date.now(),t.failures>=this.CIRCUIT_BREAKER_THRESHOLD&&(t.state="open"),this.circuitBreakerState.set(e,t)}recordCircuitBreakerSuccess(e){const t=this.circuitBreakerState.get(e);t&&(t.failures=0,t.state="closed",this.circuitBreakerState.set(e,t))}updateEndpointHealth(e,t,a){let s=this.endpointHealth.get(e);s||(s={isHealthy:!0,lastCheck:Date.now(),consecutiveFailures:0,responseTime:0},this.endpointHealth.set(e,s)),s.lastCheck=Date.now(),t?(s.consecutiveFailures=0,s.isHealthy=!0,s.responseTime=a):(s.consecutiveFailures++,s.consecutiveFailures>=this.MAX_CONSECUTIVE_FAILURES&&(s.isHealthy=!1)),this.endpointHealth.set(e,s)}isEndpointHealthy(e){const t=this.endpointHealth.get(e);if(!t)return!0;return!(Date.now()-t.lastCheck>2*this.HEALTH_CHECK_INTERVAL)&&t.isHealthy}async performHealthCheck(e){const t=this.getCircuitBreakerKey(e),a=this.healthConfigs.get(e)||{path:"",fallback:!0},s=a.path?`${e}${a.path}`:e;try{const n=Date.now(),i=await fetch(s,{method:a.path?"GET":"HEAD",signal:AbortSignal.timeout(1e4),headers:{Accept:"application/json"}});let r=i.ok;const l=Date.now()-n;if(i.ok&&a.validator){const s=await i.json();r=a.validator(s);const n=this.endpointHealth.get(t);(!r||n&&n.consecutiveFailures>0)&&Oe.info(`[HealthCheck] ${e}:`,"ApiService.performHealthCheck",{healthy:r,duration:`${l}ms`})}this.updateEndpointHealth(t,r,l),r||Oe.warn(`[HealthCheck] ${e} failed validation`)}catch(n){Oe.error(`[HealthCheck] ${e} error:`,"ApiService.performHealthCheck",n),this.updateEndpointHealth(t,!1,0)}}startHealthChecks(){this.healthCheckIntervalId&&(clearInterval(this.healthCheckIntervalId),this.healthCheckIntervalId=null),this.healthCheckIntervalId=setInterval(()=>{Oe.info("[HealthCheck] Starting periodic health check cycle..."),this.getValidatedEndpoints("atomic").forEach(e=>{this.performHealthCheck(e)}),this.getValidatedEndpoints("waxChain").forEach(e=>{this.performHealthCheck(e)}),this.getValidatedEndpoints("hyperion").forEach(e=>{this.performHealthCheck(e)}),Oe.info("[HealthCheck] Completed periodic health check cycle")},this.HEALTH_CHECK_INTERVAL),this.updateEosNationEndpoints()}stopHealthChecks(){this.healthCheckIntervalId&&(clearInterval(this.healthCheckIntervalId),this.healthCheckIntervalId=null,Oe.info("[HealthCheck] Health check interval stopped"))}enableHealthChecks(){Oe.info("[HealthCheck] Enabling health checks..."),this.startHealthChecks()}async updateEosNationEndpoints(){try{const e=Date.now();if(e-this.eosNationEndpoints.lastUpdated<this.EOS_NATION_UPDATE_INTERVAL)return;Oe.info("[EOS Nation] Fetching latest endpoint data...");const t=await fetch("https://validate.eosnation.io/wax/reports/endpoints.json",{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.json();if(!a||"object"!=typeof a)throw new Error("Invalid JSON response from EOS Nation API");if(!a.report||"object"!=typeof a.report)throw Oe.warn("[EOS Nation] No report data found in response:",a),new Error("Invalid response format from EOS Nation API");const s=a.report,n=this.parseEosNationEndpoints(s.atomic_https||[]),i=this.parseEosNationEndpoints(s.api_https2||[]),r=this.parseEosNationEndpoints(s.hyperion_https||[]);Oe.info("[EOS Nation] Raw endpoint counts:","ApiService.updateEosNationEndpoints",{atomic_https:Array.isArray(s.atomic_https)?s.atomic_https.length:"not array",api_https2:Array.isArray(s.api_https2)?s.api_https2.length:"not array",hyperion_https:Array.isArray(s.hyperion_https)?s.hyperion_https.length:"not array"}),this.eosNationEndpoints={atomicEndpoints:n,waxChainEndpoints:i,hyperionEndpoints:r,lastUpdated:e},Oe.info(`[EOS Nation] Updated endpoints: ${n.length} atomic, ${i.length} wax chain, ${r.length} hyperion`),this.initializeHealthConfigs(),setTimeout(()=>this.updateEosNationEndpoints(),this.EOS_NATION_UPDATE_INTERVAL)}catch(e){Oe.error("[EOS Nation] Failed to update endpoint data:","ApiService.updateEosNationEndpoints",e),setTimeout(()=>this.updateEosNationEndpoints(),6e5)}}parseEosNationEndpoints(e){return Array.isArray(e)?e.map(e=>{try{let t;if("string"==typeof e)t=e;else if("object"==typeof e&&null!==e){const a=e;t=a.url||a.endpoint||a.api_url||String(e)}else t=String(e);const a=t.trim().match(/https?:\/\/[^\s]+/);return a?a[0]:null}catch(t){return Oe.warn("[EOS Nation] Failed to parse endpoint","ApiService.updateEosNationEndpoints",t),null}}).filter(e=>null!==e).filter(e=>{try{return new URL(e),!0}catch{return!1}}):(Oe.warn("[EOS Nation] Expected array of endpoints, got:",typeof e),[])}getValidatedEndpoints(e){const t="atomic"===e?this.atomicEndpoints:"waxChain"===e?this.waxChainEndpoints:this.hyperionEndpoints,a="atomic"===e?this.eosNationEndpoints.atomicEndpoints:"waxChain"===e?this.eosNationEndpoints.waxChainEndpoints:this.eosNationEndpoints.hyperionEndpoints,s=[...new Set([...a,...t])];return Oe.info(`[Endpoint Selection] ${e}: ${s.length} total (${a.length} from EOS Nation, ${t.length} static)`),s}getHealthyEndpoints(e){return e.filter(e=>{const t=this.getCircuitBreakerKey(e);return this.isEndpointHealthy(t)&&!this.isCircuitBreakerOpen(t)})}classifyError(e,t){if(t){if(429===t)return"rate-limit";if(408===t||502===t||503===t||504===t)return"retryable";if(t>=400&&t<500)return"non-retryable";if(t>=500)return"retryable"}const a=e.message.toLowerCase();return a.includes("rate limit")||a.includes("429")||a.includes("too many requests")?"rate-limit":a.includes("timeout")||a.includes("network")||a.includes("connection")||a.includes("fetch")||a.includes("enotfound")||a.includes("econnreset")||a.includes("econnrefused")||a.includes("socket hang up")||"AbortError"===e.name?"retryable":a.includes("400")||a.includes("401")||a.includes("403")||a.includes("404")||a.includes("unauthorized")||a.includes("forbidden")||a.includes("not found")||a.includes("bad request")?"non-retryable":"retryable"}calculateDelay(e,t,a=!0){let s;if(s="rate-limit"===t?Math.min(1e3*Math.pow(2,e),this.MAX_TIMEOUT):Math.min(1e3*(e+1),5e3),a){const e=.1*s;s+=2*(Math.random()-.5)*e}return Math.max(s,100)}async fetchWithRetry(e,t=3,a){const s=this.getCircuitBreakerKey(e);let n=null;const i=Date.now();if(this.isCircuitBreakerOpen(s))throw new Error(`Circuit breaker is open for ${s}. Service temporarily unavailable.`);const r=a?.signal?void 0:15e3,l=new AbortController;let o;r&&!a?.signal&&(o=setTimeout(()=>l.abort(),r));const c={method:a?.method||"GET",headers:{Accept:"application/json","Content-Type":"application/json","User-Agent":"PxMarket/2.0",...a?.headers},mode:"cors",signal:a?.signal||l.signal,...a};try{if(e.includes("wax-api.hivebp.io")){for(let a=0;a<t;a++)try{const r=await fetch(e,c);if(r.ok){this.recordCircuitBreakerSuccess(s);const t=Date.now()-i;return this.reportEndpointHealth(e,!0,t),r}const l=this.classifyError(new Error(`HTTP ${r.status}`),r.status);if(n=new Error(`HTTP ${r.status}: ${r.statusText}`),"non-retryable"===l||a===t-1)break;const o=this.calculateDelay(a,l);await new Promise(e=>setTimeout(e,o))}catch(d){const e=d,s=this.classifyError(e);if(n=e,"non-retryable"===s||a===t-1)break;const i=this.calculateDelay(a,s);await new Promise(e=>setTimeout(e,i))}throw this.recordCircuitBreakerFailure(s),n||new Error("Failed to fetch from HiveBP API")}if(this.waxChainEndpoints.some(t=>e.includes(t))){const a=this.getHealthyEndpoints(this.waxChainEndpoints),s=a.length>0?a:this.waxChainEndpoints;for(let i=0;i<s.length;i++){const a=s[i];this.currentWaxChainIndex=this.waxChainEndpoints.indexOf(a);const r=e.replace(/https:\/\/[^/]+/,a),l=this.getCircuitBreakerKey(r);if(this.isCircuitBreakerOpen(l))continue;let o=!1;for(let e=0;e<t;e++)try{const a=await fetch(r,c);if(a.ok)return this.recordCircuitBreakerSuccess(l),o=!0,a;const s=this.classifyError(new Error(`HTTP ${a.status}`),a.status);if(n=new Error(`HTTP ${a.status}: ${a.statusText}`),400===a.status||"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}catch(d){const a=d,s=this.classifyError(a);if(n=a,"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}o||this.recordCircuitBreakerFailure(l)}throw n||new Error("All WAX Chain endpoints failed")}const a=this.getHealthyEndpoints(this.atomicEndpoints),r=a.length>0?a:this.atomicEndpoints;for(let s=0;s<r.length;s++){const a=r[s];this.currentEndpointIndex=this.atomicEndpoints.indexOf(a);const l=e.replace(/https:\/\/[^/]+/,a),o=this.getCircuitBreakerKey(l);if(this.isCircuitBreakerOpen(o))continue;let u=!1;for(let e=0;e<t;e++)try{const a=await fetch(l,c);if(a.ok){this.recordCircuitBreakerSuccess(o),u=!0;const e=Date.now()-i;return this.reportEndpointHealth(l,!0,e),a}const s=this.classifyError(new Error(`HTTP ${a.status}`),a.status);if(n=new Error(`HTTP ${a.status}: ${a.statusText}`),400===a.status||"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}catch(d){const a=d,s=this.classifyError(a);if(n=a,"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}u||this.recordCircuitBreakerFailure(o)}throw n||new Error("All endpoints failed")}finally{o&&clearTimeout(o)}}formatSaleData(e){const t=e.assets[0];return{sale_id:e.sale_id,asset_id:t?.asset_id||"",name:t?.name||`${t?.collection?.collection_name||"Unknown"} #${t?.asset_id||"N/A"}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:e.price?this.formatPrice(e.price):"0 WAX",seller:e.seller,collection:t?.collection?.collection_name||"Unknown",schema:t?.schema?.schema_name||"Unknown",template_mint:t?.template_mint?parseInt(t.template_mint.toString()):void 0,max_supply:t?.template?.max_supply||void 0,traits:t?.data?Object.fromEntries(Object.entries(t.data).filter(([,e])=>null!=e)):{}}}getAssetImage(e){const t=e?.data?.img||e?.template?.immutable_data?.img;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?`${qe.IPFS.GATEWAYS[0]}${t}`:t:qe.PIXEL_JOURNEY.DEFAULT_IMAGE}getAssetVideo(e){const t=e?.data?.video||e?.template?.immutable_data?.video;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?`${qe.IPFS.GATEWAYS[0]}${t}`:t:""}formatPrice(e){if(!e||!e.amount)return"0 WAX";const t=parseFloat(e.amount)/Math.pow(10,e.token_precision||8);return"WAX"!==e.token_symbol&&e.token_symbol?`${Re(t)} ${e.token_symbol}`:Me(t)}async getCheapestPixals(e=50,t=1){const a=this.atomicMarketAPI,s=this.getAdaptiveLimit(a,e);try{const e=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&sort=price&order=asc&limit=${s}&page=${t}`,n=await this.fetchWithRetry(e),i=await n.json();if(i.success&&i.data)return this.updateAdaptiveLimit(a,s,!0),i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(n){throw this.updateAdaptiveLimit(a,s,!1),Le.logError("ApiService.getCheapestPixals",n,{limit:e,adaptiveLimit:s,page:t}),n}}async getWaxRockPixals(e=50,t=1){const a=this.atomicMarketAPI,s=this.getAdaptiveLimit(a,e);try{const{MarketplaceConfigService:e}=await K(async()=>{const{MarketplaceConfigService:e}=await Promise.resolve().then(()=>Ve);return{MarketplaceConfigService:e}},void 0),i=e.getWaxRockTypes();let r=[];for(const t of i)try{const e=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&immutable_data.WaxRock=${encodeURIComponent(t)}&sort=price&order=asc&limit=50&page=1`,s=await this.fetchWithRetry(e),n=await s.json();n.success&&n.data&&r.push(...n.data)}catch(n){Oe.warn(`Failed to fetch ${t} WaxRocks:`,"ApiService.getWaxRockPixals",n)}if(0===r.length){const s=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&sort=price&order=asc&limit=100&page=${t}`,n=await this.fetchWithRetry(s),l=await n.json();l.success&&l.data&&(r=l.data.filter(t=>{if(!t.assets||!t.assets[0])return!1;const a=t.assets[0],s=a.data?.WaxRock||a.template?.immutable_data?.WaxRock;if(s&&"string"==typeof s)return"none"!==s&&e.isValidWaxRock(s);const n=i.map(e=>e.toLowerCase());return!!a.data&&Object.values(a.data).some(e=>{if("string"==typeof e){const t=e.toLowerCase();return"none"!==t&&n.includes(t)}return!1})}))}const l=r.filter((e,t,a)=>t===a.findIndex(t=>t.sale_id===e.sale_id));l.sort((e,t)=>parseFloat(e.listing_price||"0")-parseFloat(t.listing_price||"0"));const o=(t-1)*s,c=l.slice(o,o+s);return this.updateAdaptiveLimit(a,s,!0),c.map(e=>this.formatSaleData(e))}catch(n){throw this.updateAdaptiveLimit(a,s,!1),Le.logError("ApiService.getWaxRockPixals",n,{limit:e,adaptiveLimit:s,page:t}),n}}async getPixelIngredients(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=ingredients&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getPixelIngredients",a,{limit:e,page:t}),a}}async getBundleListings(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=bundles&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getBundleListings",a,{limit:e,page:t}),a}}async getFriedFactoryNFTs(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=friedfactory&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getFriedFactoryNFTs",a,{limit:e,page:t}),a}}async getCryptoMuffinsNFTs(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=crptomuffins&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getCryptoMuffinsNFTs",a,{limit:e,page:t}),a}}async getAkufishheadsNFTs(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=akufishheads&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getAkufishheadsNFTs",a,{limit:e,page:t}),a}}async getPartnerListings(e=16,t=1){try{const a=Math.min(e,50),s=Je.getPartnerCollectionsSync().join(","),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=${s}&sort=created&order=desc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getPartnerListings",a,{limit:e,page:t}),a}}async getPxApprovedListings(e=16,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&sort=created&order=desc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getPxApprovedListings",a,{limit:e,page:t}),a}}async getAHVerifiedListings(e=16,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&verified=true&sort=created&order=desc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw Le.logError("ApiService.getAHVerifiedListings",a,{limit:e,page:t}),a}}async getAllWaxListings(e=16,t=1){const a=this.atomicMarketAPI,s=this.getAdaptiveLimit(a,e);try{const e=`${a}/atomicmarket/v1/sales?state=1&sort=created&order=desc&limit=${s}&page=${t}`,n=await this.fetchWithRetry(e),i=await n.json();if(i.success&&i.data)return this.updateAdaptiveLimit(a,s,!0),i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(n){throw this.updateAdaptiveLimit(a,s,!1),Le.logError("ApiService.getAllWaxListings",n,{limit:e,adaptiveLimit:s,page:t}),n}}async getRecentSales(e=50){try{const t=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&limit=${e}&order=desc&sort=updated`,a=await this.fetchWithRetry(t),s=await a.json();if(s.success&&s.data)return s.data;throw new Error("Invalid API response")}catch(t){return Le.logError("ApiService.getRecentSales",t,{limit:e}),[]}}async getSales(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="updated",collection_name:i,schema_name:r,template_id:l,asset_id:o,seller:c,buyer:d,state:u="1,3",symbol:h="WAX",min_price:m,max_price:p,before:f,after:x}=e;let g=`${this.atomicMarketAPI}/atomicmarket/v1/sales?page=${t}&limit=${a}&order=${s}&sort=${n}&state=${u}&symbol=${h}`;i&&(g+=`&collection_name=${i}`),r&&(g+=`&schema_name=${r}`),l&&(g+=`&template_id=${l}`),o&&(g+=`&asset_id=${o}`),c&&(g+=`&seller=${c}`),d&&(g+=`&buyer=${d}`),m&&(g+=`&min_price=${m}`),p&&(g+=`&max_price=${p}`),f&&(g+=`&before=${f}`),x&&(g+=`&after=${x}`);const v=await this.fetchWithRetry(g),y=await v.json();return{success:y.success||!1,data:y.data||[],query_total:y.query_total}}catch(t){return Le.logError("ApiService.getSales",t,e),{success:!1,data:[]}}}async getCollections(e={}){try{const{limit:t=20,page:a=1,whitelistOnly:s=!0,author:n,match:i,order:r="desc",sort:l="created",singleCollection:o}=e,c=new URLSearchParams;if(o)c.append("collection_name",o),c.append("limit","1");else{if(s){const e=this.COLLECTION_WHITELIST.slice(0,Math.min(t,20)).map(async e=>{try{const t=await this.fetchWithRetry(`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}`),a=await t.json();return a.success&&a.data?a.data:null}catch{return null}}),a=await Promise.all(e);return a.filter(e=>null!==e)}c.append("limit",Math.min(t,100).toString()),c.append("page",a.toString()),n&&c.append("author",n),i&&c.append("match",i)}c.append("order",r),c.append("sort",l);const d=`${this.atomicAssetsAPI}/atomicassets/v1/collections?${c.toString()}`,u=await this.fetchWithRetry(d),h=await u.json();if(h.success&&h.data)return h.data;throw new Error("Invalid API response")}catch(t){return Le.logError("ApiService.getCollections",t,e),[{collection_name:"pixeljourney",name:"Pixel Journey",img:"",author:"pixeljourney",allow_notify:!0,authorized_accounts:[],notify_accounts:[],market_fee:0,created_at_time:"",created_at_block:""},{collection_name:"friedfactory",name:"Fried Factory",img:"",author:"friedfactory",allow_notify:!0,authorized_accounts:[],notify_accounts:[],market_fee:0,created_at_time:"",created_at_block:""}]}}async getMarketStats(){try{const e=`${this.atomicAssetsAPI}/atomicmarket/v1/stats/graph`,t=await this.fetchWithRetry(e),a=await t.json();return a.success&&a.data&&a.data.length>0?a.data[a.data.length-1]:null}catch(e){return Le.logError("ApiService.getMarketStats",e),null}}async getCollectionDetails(e){const t=`collection-${e}`;if(this.isCircuitBreakerOpen(t))return null;try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data:null}catch(a){return this.recordCircuitBreakerFailure(t),this.isCircuitBreakerOpen(t)||Le.logError("ApiService.getCollectionDetails",a,{collectionName:e}),null}}async getCollectionSchemas(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/schemas?collection_name=${e}&limit=${t}&order=desc&sort=created`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return Le.logError("ApiService.getCollectionAssets",a,{collectionName:e,limit:t}),[]}}async getCollectionTemplates(e,t,a=50){try{let s=`${this.atomicAssetsAPI}/atomicassets/v1/templates?collection_name=${e}&limit=${a}&order=desc&sort=created`;t&&(s+=`&schema_name=${t}`);const n=await this.fetchWithRetry(s),i=await n.json();return i.success&&i.data?i.data:[]}catch(s){return Le.logError("ApiService.getCollectionTemplates",s,{collectionName:e,schemaName:t,limit:a}),[]}}async getCollectionAssets(e,t,a,s=50){try{let n=`${this.getCurrentAtomicEndpoint()}/atomicmarket/v1/assets?collection_name=${e}&burned=false&limit=${s}&order=desc&sort=asset_id`;t&&(n+=`&schema_name=${t}`),a&&(n+=`&template_id=${a}`);const i=await this.fetchWithRetry(n),r=await i.json();return r.success&&r.data?r.data:[]}catch(n){return Le.logError("ApiService.getCollectionAssets",n,{collectionName:e,schemaName:t,templateId:a,limit:s}),[]}}async getAssetDetails(e){try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/assets/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data:null}catch(t){return Le.logError("ApiService.getAssetDetails",t,{assetId:e}),null}}async getCollectionStats(e){try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}/stats`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data:null}catch(t){return Le.logError("ApiService.getCollectionSchemas",t,{collectionName:e}),null}}async getCollectionBurns(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/burns?collection_name=${e}&limit=${t}&order=desc&sort=created`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return Le.logError("ApiService.getCollectionBurns",a,{collectionName:e,limit:t}),[]}}async getCollectionTransfers(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/transfers?collection_name=${e}&limit=${t}&order=desc&sort=created`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return Le.logError("ApiService.getCollectionTransfers",a,{collectionName:e,limit:t}),[]}}async getCollectionVolumeGraph(e,t=30){try{const a=`${this.hiveBPAPI}/v3/sales-volume-graph/${t}/${e}`,s=await this.fetchWithRetry(a);return await s.json()}catch(a){return Oe.warn(`HiveBP volume graph not available for ${e}`,"API",a),null}}async getCollectionMarketCap(e){try{const t=`${this.hiveBPAPI}/v3/collection-marketcap/${e}`,a=await this.fetchWithRetry(t);return await a.json()}catch(t){return Oe.warn(`HiveBP market cap not available for ${e}`,"API",t),null}}async getSimilarCollections(e){try{const t=`${this.hiveBPAPI}/v3/similar-collections/${e}`,a=await this.fetchWithRetry(t);return await a.json()||[]}catch(t){return Oe.warn(`HiveBP similar collections not available for ${e}`,"API",t),[]}}async getCollectionAnalytics(e){try{const t=`${this.hiveBPAPI}/v3/collection-stats/${e}`,a=await this.fetchWithRetry(t);return await a.json()}catch(t){return Oe.warn(`HiveBP analytics not available for ${e}`,"API",t),null}}async getHiveBPMarketCap(e){try{const t=`${this.hiveBPAPI}/v3/marketcap/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s?.marketcap||null}catch(t){return Oe.warn(`HiveBP market cap not available for ${e}`,"API",t),null}}async getHiveBPVolumeDays(e,t=1){try{const a=`${this.hiveBPAPI}/v3/volume/${t}/${e}`,s=await this.fetchWithRetry(a),n=await s.json();return n?.volume||null}catch(a){return Oe.warn(`HiveBP volume data not available for ${e}`,"API",a),null}}async getHiveBPFloorPrice(e){try{const t=`${this.hiveBPAPI}/v3/floor/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s?.floor_price||null}catch(t){return Oe.warn(`HiveBP floor price not available for template ${e}`,"API",t),null}}async getEnhancedCollectionStats(e){try{const[a,s,n]=await Promise.all([this.getHiveBPMarketCap(e),this.getHiveBPVolumeDays(e,1),this.getHiveBPVolumeDays(e,7)]);let i=null;try{const t=await this.getCollectionTemplates(e,void 0,1);t.length>0&&(i=await this.getHiveBPFloorPrice(t[0].template_id))}catch(t){Oe.warn(`Could not fetch floor price for ${e}`,"API",t)}return{marketCap:a,volume24h:s,volume7d:n,floorPrice:i}}catch(t){return Le.logError("ApiService.getCollectionStats",t,{collectionName:e}),{marketCap:null,volume24h:null,volume7d:null,floorPrice:null}}}async getCollectionTopSales(e,t=20){try{const a=`${this.atomicAssetsAPI}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=${t}&order=desc&sort=price`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return Le.logError("ApiService.getCollectionTopSales",a,{collectionName:e,limit:t}),[]}}async getCollectionFloorPrice(e){try{const t=`${this.atomicAssetsAPI}/atomicmarket/v1/sales?collection_name=${e}&state=1&limit=1&order=asc&sort=price`,a=await this.fetchWithRetry(t),s=await a.json();if(s.success&&s.data&&s.data.length>0){return{floorPrice:parseFloat(s.data[0].listing_price)/1e8}}return{floorPrice:0}}catch(t){return Le.logError("ApiService.getCollectionFloorPrice",t,{collectionName:e}),{floorPrice:0}}}async getCollectionHolders(e,t=50,a=0){try{let s=`${this.atomicAssetsAPI}/atomicassets/v1/accounts?collection_name=${e}&limit=${t}&order=desc&sort=assets`;a>0&&(s+=`&page=${Math.floor(a/t)+1}`);const n=await this.fetchWithRetry(s),i=await n.json();return i.success&&i.data?i.data:[]}catch(s){return Le.logError("ApiService.getCollectionHolders",s,{collectionName:e,limit:t,offset:a}),[]}}async getNFTTradingStats(){try{const e=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&after=${Date.now()-864e5}&limit=1000`),t=await e.json();let a=0,s=0;t.success&&t.data&&(s=t.data.length,a=t.data.reduce((e,t)=>e+(t.price?parseFloat(t.price.amount)/Math.pow(10,t.price.token_precision):0),0));const n=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&limit=1`),i=await n.json(),r=i.success?parseInt(i.query_time):0;return{collection_name:"global",dailyVolume:Re(a),dailySales:s,totalTransactions:s,activeListings:r,averagePrice:s>0?Re(a/s):"0"}}catch(e){return Le.logError("ApiService.getNFTTradingStats",e),null}}async getTopCollectionsByVolume(e=10){try{const t=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/stats/collections?limit=${e}&sort=volume`),a=await t.json();return a.success&&a.data?a.data.map(e=>({collection_name:e.collection_name,volume_24h:e.volume?Me(parseFloat(e.volume)/1e8):"0 WAX",sales_24h:parseInt(e.sales||"0")||0,floor_price:e.floor_price?Me(parseFloat(e.floor_price)/1e8):"0 WAX",assets_count:e.assets||"0"})):[]}catch(t){return Le.logError("ApiService.getTopCollectionsByVolume",t,{limit:e}),[]}}async getRecentNFTTrades(e=20){try{const t=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&limit=${e}&sort=updated`),a=await t.json();return a.success&&a.data?a.data.map(e=>({sale_id:e.sale_id,collection_name:e.collection_name||e.assets[0]?.collection?.collection_name||"Unknown",asset_name:e.assets[0]?.name||`Asset #${e.assets[0]?.asset_id}`,price:e.price?Me(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision)):"0 WAX",buyer:e.buyer,seller:e.seller,timestamp:e.updated_at_time})):[]}catch(t){return Le.logError("ApiService.getNFTTradingStats",t,{limit:e}),[]}}async getUserInventory(e,t=1e3){try{const a=this.approvedCollections.join(","),s=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${a}&burned=false&limit=${t}&order=desc&sort=asset_id`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))}));throw new Error("Invalid API response")}catch(a){return Le.logError("ApiService.getUserInventory",a,{account:e}),[]}}async getUserInventoryPaginated(e,t=1,a=1e3){try{const s=this.approvedCollections.join(","),n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${s}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const s=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:s,hasMore:n,total:(t-1)*a+r.data.length+(n?1:0)}}throw new Error("Invalid API response")}catch(s){return Le.logError("ApiService.getUserInventoryPaginated",s,{account:e,page:t,limit:a}),{assets:[],hasMore:!1,total:0}}}async getUserInventoryAll(e,t=1,a=1e3){try{const s=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data){const s=i.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=i.data.length===a;return{assets:s,total:(t-1)*a+s.length+(n?1:0),hasMore:n,currentPage:t}}return{assets:[],total:0,hasMore:!1,currentPage:t}}catch(s){return Le.logError("ApiService.getUserInventoryAll",s,{account:e,page:t,limit:a}),{assets:[],total:0,hasMore:!1,currentPage:t}}}async getUserInventoryByCollection(e,t,a=1e3,s=0){try{const n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${t}&burned=false&limit=${a}&offset=${s}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const t=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:t,total:s+t.length+(n?1:0),hasMore:n}}return{assets:[],total:0,hasMore:!1}}catch(n){return Le.logError("ApiService.getUserInventoryByCollection",n,{account:e,collectionName:t,limit:a,offset:s}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryBySchema(e,t,a,s=1e3,n=0){try{const i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${t}&schema_name=${a}&burned=false&limit=${s}&offset=${n}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),l=await r.json();if(l.success&&l.data){const t=l.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),a=l.data.length===s;return{assets:t,total:n+t.length+(a?1:0),hasMore:a}}return{assets:[],total:0,hasMore:!1}}catch(i){return Le.logError("ApiService.getUserInventoryBySchema",i,{account:e,collectionName:t,schemaName:a,limit:s,offset:n}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryOverview(e){try{const t=`${qe.WAX_CHAIN.EOSRIO}/v1/chain/get_table_rows`,a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"atomicassets",scope:e,table:"assets",limit:1e3,reverse:!1})}),s=await a.json(),n=new Map;let i=0;s.rows&&s.rows.forEach(e=>{if(!e.collection_name)return;i++;const t=e.collection_name,a=e.schema_name||"unknown";n.has(t)||n.set(t,{count:0,schemas:new Map});const s=n.get(t);s.count++,s.schemas.set(a,(s.schemas.get(a)||0)+1)});const r=Array.from(n.entries()).map(([e,t])=>({name:e,count:t.count,schema_counts:Object.fromEntries(t.schemas)})).sort((e,t)=>t.count-e.count);return{totalAssets:i,collections:r,topCollections:r.slice(0,10)}}catch(t){Le.logError("ApiService.getUserInventoryOverview",t,{account:e});try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&page=1&limit=1`,a=await this.fetchWithRetry(t),s=await a.json();return{totalAssets:s.success&&s.query_total||0,collections:[],topCollections:[]}}catch(a){return Le.logError("ApiService.getUserInventoryOverview.fallback",a,{account:e}),{totalAssets:0,collections:[],topCollections:[]}}}}async getUserInventoryOptimized(e,t={}){const{page:a=1,limit:s=1e3,collectionName:n,schemaName:i,useCache:r=!0,cacheTTL:l=3e5}=t,o=`inventory_${e}_${a}_${s}_${n||"all"}_${i||"all"}`;if(r){const e=this.getFromCache(o);if(e)return e}try{let t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${s}&page=${a}&order=desc&sort=asset_id`;n&&"all"!==n&&(t+=`&collection_name=${n}`),i&&(t+=`&schema_name=${i}`);const c=await this.fetchWithRetry(t),d=await c.json();if(d.success&&d.data){const t=d.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=d.data.length===s,i={assets:t,total:d.query_total||(a-1)*s+t.length+(n?1:0),hasMore:n,currentPage:a};return r&&this.setCache(o,i,l),i}return{assets:[],total:0,hasMore:!1,currentPage:a}}catch(c){return Le.logError("ApiService.getUserInventoryOptimized",c,{account:e,page:a,limit:s,collectionName:n,schemaName:i}),{assets:[],total:0,hasMore:!1,currentPage:a}}}async getUserInventoryBatch(e,t={}){const{batchSize:a=1e3,maxBatches:s=20,delayMs:n=500,collectionName:i,onProgress:r,maxRetries:l=3,onError:o}=t,c=[],d=[];let u=1,h=!0,m=0;for(;h&&u<=s&&m<3;){let t=!1,f=null;for(let x=0;x<=l;x++)try{if(x>0){const e=n*Math.pow(1.5,m),t=Math.min(1e3*Math.pow(2,x-1)+e,1e4);await new Promise(e=>setTimeout(e,t))}const l=await this.getUserInventoryOptimized(e,{page:u,limit:a,collectionName:i,useCache:!1});c.push(...l.assets),h=l.hasMore,t=!0,m=0,r&&r({current:u,total:Math.min(s,Math.ceil(l.total/a)),assets:[...c],errors:[...d]});break}catch(p){f=p;const t=x<l;if(o&&o(f,u,t),Le.logError(`ApiService.getUserInventoryBatch.batch${u}.attempt${x+1}`,f,{account:e,batchSize:a,currentBatch:u,retryAttempt:x}),!t){const t=`Batch ${u} failed after ${l+1} attempts: ${f.message}`;if(d.push(t),m++,this.isCriticalError(f))return Le.logError("ApiService.getUserInventoryBatch.criticalError",f,{account:e,currentBatch:u,errorType:"critical"}),{assets:c,errors:[...d,"Critical error encountered, stopping batch processing"],partialSuccess:c.length>0}}}if(u++,h&&u<=s&&t){const e=n*Math.pow(1.2,Math.min(m,3));await new Promise(t=>setTimeout(t,e))}}if(m>=3){const t=`Stopped processing due to ${m} consecutive batch failures`;d.push(t),Le.logError("ApiService.getUserInventoryBatch.tooManyFailures",new Error(t),{account:e,currentBatch:u,consecutiveFailures:m})}return{assets:c,errors:d,partialSuccess:c.length>0&&(d.length>0||m>0)}}isCriticalError(e){const t=e.message.toLowerCase();return t.includes("unauthorized")||t.includes("forbidden")||t.includes("invalid account")||t.includes("network error")||t.includes("dns")||t.includes("connection refused")}async executeBatchOperation(e,t,a={}){const{batchSize:s=100,maxRetries:n=3,delayMs:i=500,onProgress:r,onError:l,stopOnCriticalError:o=!0}=a,c=[],d=[],u=this.chunkArray(e,s);let h=0;for(let p=0;p<u.length;p++){const e=u[p];let a=!1,s=null;for(let i=0;i<=n;i++)try{if(i>0){const e=Math.min(1e3*Math.pow(2,i-1),1e4);await new Promise(t=>setTimeout(t,e))}const s=await t(e,p);c.push(...s),a=!0,h=0,r&&r({completed:p+1,total:u.length,errors:[...d]});break}catch(m){s=m;const t=i<n;if(l&&l(s,p,t),Le.logError(`ApiService.executeBatchOperation.batch${p}.attempt${i+1}`,s,{batchIndex:p,retryAttempt:i,batchSize:e.length}),!t){const e=`Batch ${p} failed after ${n+1} attempts: ${s.message}`;if(d.push(e),h++,o&&this.isCriticalError(s))return Le.logError("ApiService.executeBatchOperation.criticalError",s,{batchIndex:p,errorType:"critical"}),{results:c,errors:[...d,"Critical error encountered, stopping batch processing"],partialSuccess:c.length>0}}}if(h>=3){const e=`Stopped processing due to ${h} consecutive batch failures`;d.push(e),Le.logError("ApiService.executeBatchOperation.tooManyFailures",new Error(e),{batchIndex:p,consecutiveFailures:h});break}if(p<u.length-1&&a){const e=i*Math.pow(1.2,Math.min(h,3));await new Promise(t=>setTimeout(t,e))}}return{results:c,errors:d,partialSuccess:c.length>0&&d.length>0}}chunkArray(e,t){const a=[];for(let s=0;s<e.length;s+=t)a.push(e.slice(s,s+t));return a}async getUserInventoryWithFilter(e,t=1,a=1e3,s){try{let n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`;s&&"all"!==s&&(n+=`&collection_name=${s}`);const i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const s=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:s,total:(t-1)*a+s.length+(n?1:0),hasMore:n,currentPage:t}}return{assets:[],total:0,hasMore:!1,currentPage:t}}catch(n){return Le.logError("ApiService.getUserInventoryWithFilter",n,{account:e,page:t,limit:a,collectionName:s}),{assets:[],total:0,hasMore:!1,currentPage:t}}}async getUserInventoryEnhanced(e,t={}){const{page:a=1,limit:s=1e3,order:n="desc",sort:i="transferred",burned:r=!1,...l}=t;try{const t=new URLSearchParams({owner:e,burned:r.toString(),limit:s.toString(),page:a.toString(),order:n,sort:i});Object.entries(l).forEach(([e,a])=>{null!=a&&""!==a&&t.append(e,a.toString())});const o=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?${t.toString()}`,c=await this.fetchWithRetry(o),d=await c.json();if(d.success&&d.data){const t=d.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=[...new Set(t.map(e=>e.collection))].filter(e=>"Unknown"!==e),i=[...new Set(t.map(e=>e.schema))].filter(e=>"Unknown"!==e),r=d.data.length===s;return{assets:t,total:(a-1)*s+t.length+(r?1:0),hasMore:r,currentPage:a,collections:n,schemas:i}}return{assets:[],total:0,hasMore:!1,currentPage:a,collections:[],schemas:[]}}catch(o){return Le.logError("ApiService.getUserInventoryEnhanced",o,{account:e,options:t}),{assets:[],total:0,hasMore:!1,currentPage:a,collections:[],schemas:[]}}}async getUserInventoryByTemplate(e,t,a=1e3,s=0){try{const n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&template_id=${t}&burned=false&limit=${a}&offset=${s}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const t=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:t,total:s+t.length+(n?1:0),hasMore:n}}return{assets:[],total:0,hasMore:!1}}catch(n){return Le.logError("ApiService.getUserInventoryByTemplate",n,{account:e,templateId:t,limit:a,offset:s}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryWaxRocks(e,t=1e3,a=0){try{const{MarketplaceConfigService:s}=await K(async()=>{const{MarketplaceConfigService:e}=await Promise.resolve().then(()=>Ve);return{MarketplaceConfigService:e}},void 0),n=s.getPixalTemplateId(),i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&template_id=${n}&burned=false&limit=${t}&offset=${a}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),l=await r.json();if(l.success&&l.data){const a=l.data.filter(e=>{const t=e.data?.WaxRock||e.template?.immutable_data?.WaxRock;return!(!t||"string"!=typeof t)&&("none"!==t&&s.isValidWaxRock(t))}).map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""])),data:t.data})),n=l.data.length===t;return{assets:a,total:a.length,hasMore:n}}return{assets:[],total:0,hasMore:!1}}catch(s){return Le.logError("ApiService.getUserInventoryWaxRocks",s,{account:e,limit:t,offset:a}),{assets:[],total:0,hasMore:!1}}}async getWaxChainInfo(){try{const e=await this.fetchWithRetry(`${this.waxChainAPI}/v1/chain/get_info`);if(e.ok)return await e.json();throw new Error("Failed to fetch chain info")}catch(e){return Le.logError("ApiService.getWaxChainInfo",e),this.currentWaxChainIndex<this.waxChainEndpoints.length-1?(this.currentWaxChainIndex++,this.getWaxChainInfo()):(this.currentWaxChainIndex=0,null)}}async getWaxAccountInfo(e){for(let a=0;a<this.waxChainEndpoints.length;a++){const s=this.waxChainEndpoints[a];try{const t=await fetch(`${s}/v1/chain/get_account`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify({account_name:e})});if(t.ok){const e=await t.json();return this.currentWaxChainIndex=a,e}Oe.warn(`Endpoint ${s} returned status ${t.status}: ${t.statusText}`,"API")}catch(t){Le.logError("ApiService.getWaxAccountInfo",t,{endpoint:s,accountName:e})}}return Le.logError("ApiService.getWaxAccountInfo",new Error("All WAX chain endpoints failed for get_account"),{accountName:e}),null}async getWaxCurrencyBalance(e,t="eosio.token",a="WAX"){Oe.debug(`Attempting to fetch currency balance for: ${e}`,"API");for(let n=0;n<this.waxChainEndpoints.length;n++){const i=this.waxChainEndpoints[n];Oe.debug(`Trying endpoint ${n+1}/${this.waxChainEndpoints.length}: ${i}`,"API");try{const s=await fetch(`${i}/v1/chain/get_currency_balance`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify({code:t,account:e,symbol:a})});if(s.ok){const e=await s.json();return Oe.debug(`Successfully fetched currency balance from ${i}`,"API"),this.currentWaxChainIndex=n,e.map(e=>({balance:e,contract:t,symbol:e.split(" ")[1]||a}))}Oe.warn(`Endpoint ${i} returned status ${s.status}: ${s.statusText}`,"API")}catch(s){Le.logError("ApiService.getWaxCurrencyBalance",s,{endpoint:i,accountName:e,contract:t,symbol:a})}}return Le.logError("ApiService.getWaxCurrencyBalance",new Error("All WAX chain endpoints failed for get_currency_balance"),{accountName:e,contract:t,symbol:a}),[]}async getLightApiBalances(e){try{const t=`${this.waxLightAPI}/api/balances/wax/${e}`,a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(t){return Le.logError("ApiService.getLightApiBalances",t,{accountName:e}),null}}async getLightApiAccountInfo(e){try{const t=`${this.waxLightAPI}/api/account/wax/${e}`,a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(t){return Le.logError("ApiService.getLightApiAccountInfo",t,{accountName:e}),null}}async getAlcorTokenPrice(e,t){let a=null;try{const s=`${e.toLowerCase()}-${t}`,n=`${this.alcorAPI}/tokens/${s}`,i=new AbortController;a=setTimeout(()=>{i.abort()},8e3);const r=await this.fetchAlcorAPI(n,2,{signal:i.signal});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return await r.json()}catch(s){return s instanceof Error&&"AbortError"===s.name?(Oe.warn(`Alcor API request timeout for ${e}`,"API"),null):(Oe.warn(`Error fetching Alcor token price for ${e}`,"API",s),"wax"===e.toLowerCase()?{symbol:"WAX",contract:"eosio.token",id:"wax-eosio.token",system_price:.05,usd_price:.05,decimals:8}:null)}finally{a&&clearTimeout(a)}}async getAlcorMarkets(){try{const e=`${this.alcorAPI}/pairs`,t=await this.fetchAlcorAPI(e);return await t.json()}catch(e){return Le.logError("ApiService.getAlcorMarkets",e),[]}}async getMarketplaceConfig(){try{return{partnerCollections:["friedfactory","pixeljourney"],tokenContracts:["alien.worlds","prospectorsc","token.nefty"],supportedTokens:[{contract:"eosio.token",symbol:"WAX",precision:8},{contract:"alien.worlds",symbol:"TLM",precision:4},{contract:"prospectorsc",symbol:"PGL",precision:4},{contract:"token.nefty",symbol:"NEFTY",precision:8}]}}catch(e){return Le.logError("ApiService.getMarketplaceConfig",e),{partnerCollections:["friedfactory","pixeljourney"],tokenContracts:["alien.worlds","prospectorsc","token.nefty"],supportedTokens:[{contract:"eosio.token",symbol:"WAX",precision:8}]}}}async getPartnerCollections(){try{return(await this.getMarketplaceConfig()).partnerCollections}catch(e){return Le.logError("ApiService.getPartnerCollections",e),["friedfactory","pixeljourney"]}}async getTokenContracts(){try{return(await this.getMarketplaceConfig()).tokenContracts}catch(e){return Le.logError("ApiService.getTokenContracts",e),["alien.worlds","prospectorsc","token.nefty"]}}async getAlcorSwapQuote(e){try{const t=`${this.alcorAPI}/swap/quote`,a=await this.fetchAlcorAPI(t,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await a.json()}catch(t){return Le.logError("ApiService.getAlcorSwapQuote",t,{params:e}),null}}async getPXJPrice(){try{const e=await this.getAlcorTokenPrice("PXJ","pixeljourney");return e?.system_price||0}catch(e){return Le.logError("ApiService.getPXJPrice",e),0}}async calculatePortfolioValue(e){let t=0;for(const s of e)try{const e=await this.getAlcorTokenPrice(s.currency,s.contract);if(e){const a=parseFloat(s.amount),n=parseInt(s.decimals);t+=a/Math.pow(10,n)*e.usd_price}}catch(a){Oe.warn(`Could not get price for ${s.currency}`,"API",a)}return t}async getMarketplaceNFTs(e){try{const{page:t=1,limit:a=100,asset_id:s,state:n=1}=e;let i=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?state=${n}&page=${t}&limit=${a}&order=desc&sort=created`;s&&(i+=`&asset_id=${s}`);const r=await this.fetchWithRetry(i),l=await r.json();return l.success&&l.data?{success:!0,data:l.data.map(e=>({sale_id:e.sale_id,asset_id:e.assets[0]?.asset_id||"",price:e.price?`${(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)).toFixed(8)} ${e.price.token_symbol}`:"0 WAX",seller:e.seller,created_at_time:e.created_at_time}))}:{success:!0,data:[]}}catch(t){return Le.logError("ApiService.getMarketplaceNFTs",t,{params:e}),{success:!1,data:[]}}}async getAssetOffers(e){try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/buyoffers?asset_id=${e}&state=0&page=1&limit=100&order=desc&sort=price`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data.map(e=>({id:e.buyoffer_id,buyer:e.buyer,price:e.price.amount,symbol:e.price.token_symbol,timestamp:e.created_at_time,memo:e.memo||""})):[]}catch(t){return Le.logError("ApiService.getAssetOffers",t,{assetId:e}),[]}}async getAssetsBatch(e){if(!e.length)return{success:!0,data:[],errors:[]};try{const a=this.chunkArray(e,100),s=[],n=[];for(const e of a)try{const t=e.join(","),a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets`,i=await this.fetchWithRetry(a,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,limit:"1000"})}),r=await i.json();r.success&&r.data?s.push(...r.data):n.push(`Failed to fetch assets batch: ${e.join(", ")}`)}catch(t){Le.logError("ApiService.getAssetsBatch",t,{chunk:e}),n.push(`Error fetching assets: ${e.join(", ")}`)}return{success:0===n.length,data:s,errors:n}}catch(t){return Le.logError("ApiService.getAssetsBatch",t,{assetIds:e}),{success:!1,data:[],errors:[`Failed to process asset batch: ${t}`]}}}async getTemplatesBatch(e){if(!e.length)return{success:!0,data:[],errors:[]};try{const a=this.chunkArray(e,100),s=[],n=[];for(const e of a)try{const t=e.join(","),a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/templates`,i=await this.fetchWithRetry(a,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,limit:"1000"})}),r=await i.json();r.success&&r.data?s.push(...r.data):n.push(`Failed to fetch templates batch: ${e.join(", ")}`)}catch(t){Le.logError("ApiService.getTemplatesBatch",t,{chunk:e}),n.push(`Error fetching templates: ${e.join(", ")}`)}return{success:0===n.length,data:s,errors:n}}catch(t){return Le.logError("ApiService.getTemplatesBatch",t,{templateIds:e}),{success:!1,data:[],errors:[`Failed to process template batch: ${t}`]}}}async getAssetCountsBatch(e,t){if(!e.length)return{success:!0,data:{},errors:[]};try{const s={},n=[],i=this.chunkArray(e,50);for(const e of i)try{const a=e.map(async e=>{try{const a={template_id:e,limit:1};t&&(a.owner=t);const s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets`,n=new URLSearchParams;Object.entries(a).forEach(([e,t])=>{null!=t&&n.append(e,String(t))});const i=await this.fetchWithRetry(`${s}?${n}`),r=await i.json();return r.success?{templateId:e,count:parseInt(r.query_total||"0")}:{templateId:e,count:0,error:"API returned unsuccessful response"}}catch(a){return{templateId:e,count:0,error:String(a)}}});(await Promise.all(a)).forEach(e=>{e.error&&n.push(`Error fetching count for template ${e.templateId}: ${e.error}`),s[e.templateId]=e.count}),i.indexOf(e)<i.length-1&&await new Promise(e=>setTimeout(e,100))}catch(a){Le.logError("ApiService.getAssetCountsBatch chunk",a,{chunk:e}),e.forEach(e=>{s[e]=0,n.push(`Error processing template ${e}: ${a}`)})}return{success:0===n.length,data:s,errors:n}}catch(a){return Le.logError("ApiService.getAssetCountsBatch",a,{templateIds:e}),{success:!1,data:{},errors:[`Failed to process asset counts batch: ${a}`]}}}async getOffers(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="created",state:i="0",collection_name:r,schema_name:l,template_id:o,asset_id:c,buyer:d,seller:u,min_price:h,max_price:m,symbol:p="WAX"}=e;let f=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/buyoffers?page=${t}&limit=${a}&order=${s}&sort=${n}&state=${i}&symbol=${p}`;r&&(f+=`&collection_name=${r}`),l&&(f+=`&schema_name=${l}`),o&&(f+=`&template_id=${o}`),c&&(f+=`&asset_id=${c}`),d&&(f+=`&buyer=${d}`),u&&(f+=`&seller=${u}`),h&&(f+=`&min_price=${h}`),m&&(f+=`&max_price=${m}`);const x=await this.fetchWithRetry(f),g=await x.json();return{success:g.success||!1,data:g.data||[],query_total:g.query_total}}catch(t){return Le.logError("ApiService.getOffers",t,e),{success:!1,data:[]}}}async getPrices(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="created",collection_name:i,schema_name:r,template_id:l,symbol:o="WAX"}=e;let c=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/prices?page=${t}&limit=${a}&order=${s}&sort=${n}&symbol=${o}`;i&&(c+=`&collection_name=${i}`),r&&(c+=`&schema_name=${r}`),l&&(c+=`&template_id=${l}`);const d=await this.fetchWithRetry(c),u=await d.json();return{success:u.success||!1,data:u.data||[],query_total:u.query_total}}catch(t){return Le.logError("ApiService.getPrices",t,e),{success:!1,data:[]}}}async getTransfers(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="created",collection_name:i,schema_name:r,template_id:l,asset_id:o,sender:c,recipient_name:d}=e;let u=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/transfers?page=${t}&limit=${a}&order=${s}&sort=${n}`;i&&(u+=`&collection_name=${i}`),r&&(u+=`&schema_name=${r}`),l&&(u+=`&template_id=${l}`),o&&(u+=`&asset_id=${o}`),c&&(u+=`&sender_name=${c}`),d&&(u+=`&recipient_name=${d}`);const h=await this.fetchWithRetry(u),m=await h.json();return{success:m.success||!1,data:m.data||[],query_total:m.query_total}}catch(t){return Le.logError("ApiService.getTransfers",t,e),{success:!1,data:[]}}}async getCollectionMarketStats(e={}){try{const{collection_name:t,symbol:a="WAX"}=e;let s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/collections?symbol=${a}`;t&&(s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/collections/${t}?symbol=${a}`);const n=await this.fetchWithRetry(s),i=await n.json();return{success:i.success||!1,data:i.data||{}}}catch(t){return Le.logError("ApiService.getCollectionMarketStats",t,e),{success:!1,data:{symbol:"",market_contract:"",sales:"0",volume:"0",suggested_median:"0",suggested_average:"0"}}}}async getTemplateStats(e,t,a="WAX"){try{const s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/templates/${e}/${t}?symbol=${a}`,n=await this.fetchWithRetry(s),i=await n.json();return{success:i.success||!1,data:i.data||{}}}catch(s){return Le.logError("ApiService.getTemplateStats",s,{collectionName:e,templateId:t,symbol:a}),{success:!1,data:{template_id:"",collection_name:"",assets:"0",burned:"0",sales:"0",volume:"0",suggested_median:"0",suggested_average:"0"}}}}async getHyperionTransactionHistory(e,t=100,a=0){Oe.debug("\ud83d\udd0d Fetching Hyperion transaction history for:","API",{account:e});try{const s=`${this.hyperionEndpoints[this.currentHyperionIndex]}/v2/history/get_actions`,n=new URLSearchParams({account:e,limit:Math.min(t,1e3).toString(),skip:a.toString(),sort:"desc"});Oe.debug("\ud83d\udce1 Hyperion API URL:","API",{url:`${s}?${n}`});const i=await this.fetchWithRetry(`${s}?${n}`),r=await i.json();if(!r.actions||!Array.isArray(r.actions))return Oe.warn("No actions found in Hyperion response","API"),[];Oe.debug(`\ud83d\udcca Found ${r.actions.length} Hyperion actions`,"API");const l=r.actions.map(t=>{const a=t.act.data;let s="unknown";return s="eosio.token"===t.act.account&&"transfer"===t.act.name?a.from===e?"token_send":"token_receive":"atomicassets"===t.act.account&&"transfer"===t.act.name?"nft_transfer":"atomicmarket"===t.act.account&&"purchasesale"===t.act.name?"nft_purchase":"atomicmarket"===t.act.account&&"announcesale"===t.act.name?"nft_listing":"atomicmarket"===t.act.account&&"cancelsale"===t.act.name?"nft_cancel_listing":`${t.act.account}_${t.act.name}`,{transaction_id:t.trx_id,block_time:t.timestamp,action_name:t.act.name,contract:t.act.account,from:a.from,to:a.to,quantity:a.quantity,memo:a.memo,asset_ids:a.asset_ids,collection_name:a.collection_name,type:s,status:"completed"}});return Oe.debug(`\u2705 Processed ${l.length} Hyperion transactions`,"API"),l}catch(s){return Oe.error("\u274c Hyperion API error","API",s),this.currentHyperionIndex<this.hyperionEndpoints.length-1?(this.currentHyperionIndex++,Oe.debug(`\ud83d\udd04 Switching to Hyperion endpoint ${this.currentHyperionIndex+1}`,"API"),this.getHyperionTransactionHistory(e,t,a)):(this.currentHyperionIndex=0,Le.logError("ApiService.getHyperionTransactionHistory",s,{account:e,limit:t,skip:a}),[])}}async getAccountTransfers(e,t,a,s=50,n=0){try{const i=`${this.hyperionEndpoints[this.currentHyperionIndex]}/v2/history/get_actions`,r=new URLSearchParams({account:e,limit:Math.min(s,100).toString(),sort:"desc",skip:n.toString(),"transfer.to":e});Oe.debug("\ud83d\udd0d Fetching account transfers from Hyperion:","API",{account:e,contract:t,symbol:a,url:`${i}?${r}`});const l=await this.fetchWithRetry(`${i}?${r}`),o=await l.json();if(!o.actions||!Array.isArray(o.actions))return Oe.warn("No actions found in Hyperion response for transfers","API"),[];Oe.debug(`\ud83d\udcca Found ${o.actions.length} Hyperion transfer actions`,"API");const c=o.actions.filter(s=>{const n=s.act;return n?.account===t&&"transfer"===n?.name&&(n?.data?.to===e||n?.data?.from===e)&&(n?.data?.quantity?.includes(a)||n?.data?.symbol===a)}).slice(0,s).map(e=>{const t=e.act.data;return{from:t.from,to:t.to,quantity:t.quantity,memo:t.memo||"",timestamp:e.timestamp,transaction_id:e.trx_id,block_num:e.block_num}});return Oe.debug(`\u2705 Processed ${c.length} transfers for account ${e}`,"API"),c}catch(i){return Le.logError("ApiService.getAccountTransfers",i,{account:e,contract:t,symbol:a,limit:s,offset:n}),Oe.warn("Falling back to legacy WAX chain API","API"),this.fetchTransfersFromWaxChainAPI(e,t,a,s,n)}}async fetchTransfersFromWaxChainAPI(e,t,a,s=50,n=0){try{const i=await fetch(`${this.waxChainAPI}/v1/history/get_actions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:e,pos:-1,offset:n,filter:`${t}:transfer`})});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const r=(await i.json()).actions||[];return r.filter(s=>{const n=s.action_trace?.act;return"transfer"===n?.name&&n?.account===t&&(n?.data?.to===e||n?.data?.from===e)&&n?.data?.quantity?.includes(a)}).slice(0,s).map(e=>{const t=e.action_trace.act.data;return{from:t.from,to:t.to,quantity:t.quantity,memo:t.memo||"",timestamp:e.block_time,transaction_id:e.action_trace.trx_id,block_num:e.block_num}})}catch(i){return Le.logError("ApiService.fetchTransfersFromWaxChainAPI",i,{account:e,contract:t,symbol:a,limit:s,offset:n}),[]}}async getUserTransactions(e,t=500){Oe.debug("\ud83d\udd0d getUserTransactions called for account:","API",{account:e,limit:t});try{const s=[];try{Oe.debug("\ud83d\ude80 Fetching Hyperion transaction history...","API");const a=await this.getHyperionTransactionHistory(e,Math.min(t,200));Oe.debug("\ud83d\ude80 Hyperion transactions:","API",{count:a.length});const n=a.map(e=>({transaction_id:e.transaction_id,block_time:e.block_time,action_name:e.action_name,asset_id:e.asset_ids?.[0],asset_name:e.asset_ids?.[0]?`Asset #${e.asset_ids[0]}`:void 0,collection_name:e.collection_name,price:e.quantity,from:e.from,to:e.to,type:e.type,status:e.status,memo:e.memo}));s.push(...n),Oe.debug("\u2705 Added Hyperion transactions","API",{count:n.length})}catch(a){Oe.warn("Failed to fetch Hyperion transactions","API",a)}try{const a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?account=${e}&state=3&page=1&limit=${Math.min(t,200)}&order=desc&sort=updated`;Oe.debug("\ud83d\udcca Fetching marketplace transactions from:","API",{url:a});const n=await this.fetchWithRetry(a),i=await n.json();if(Oe.debug("\ud83d\udcca Marketplace response:","API",{success:i.success,dataLength:i.data?.length}),i.success&&i.data){const t=i.data.map(t=>{const a=parseFloat(t.price.amount)/Math.pow(10,t.price.token_precision||8),s="WAX"===t.price.token_symbol?Me(a):`${Re(a)} ${t.price.token_symbol}`;return{transaction_id:t.sale_id,block_time:t.updated_at_time,action_name:t.buyer===e?"purchase":"sale",asset_id:t.assets[0]?.asset_id,asset_name:t.assets[0]?.name||`Asset #${t.assets[0]?.asset_id}`,collection_name:t.assets[0]?.collection?.collection_name,price:s,from:t.buyer===e?t.seller:e,to:t.buyer===e?e:t.buyer,type:t.buyer===e?"purchase":"sale",status:"completed"}});s.push(...t)}}catch(a){Oe.warn("Failed to fetch marketplace transactions","API",a)}try{const a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/transfers?account=${e}&page=1&limit=${Math.min(t,200)}&order=desc&sort=created`;Oe.debug("\ud83d\udd04 Fetching NFT transfers from:","API",{url:a});const n=await this.fetchWithRetry(a),i=await n.json();if(Oe.debug("\ud83d\udd04 NFT transfers response:","API",{success:i.success,dataLength:i.data?.length}),i.success&&i.data){const e=i.data.filter(e=>e.sender!==e.recipient).map(e=>{const t=e.assets?.[0];return{transaction_id:e.tx_id||`transfer_${e.transfer_id}`,block_time:e.created_at_time,action_name:"transfer",asset_id:t?.asset_id,asset_name:t?.name||`Asset #${t?.asset_id}`,collection_name:t?.collection?.collection_name,price:void 0,from:e.sender,to:e.recipient,type:"transfer",status:"completed",memo:e.memo||void 0}});s.push(...e)}}catch(a){Oe.warn("Failed to fetch NFT transfers","API",a)}try{Oe.debug("\ud83d\udcb0 Fetching token transfers for account:","API",{account:e});const a=await this.getAccountTransfers(e,"eosio.token","WAX",Math.min(t,100));Oe.debug("\ud83d\udcb0 Token transfers response:","API",{count:a.length});const n=a.map(t=>({transaction_id:t.transaction_id,block_time:t.timestamp,action_name:"token_transfer",asset_id:void 0,asset_name:"WAX Token",collection_name:"WAX",price:t.quantity,from:t.from,to:t.to,type:t.from===e?"token_send":"token_receive",status:"completed",memo:t.memo}));s.push(...n)}catch(a){Oe.warn("Failed to fetch token transfers","API",a)}Oe.debug("\ud83d\udccb Total transactions found:","API",{count:s.length});const n=new Map;s.forEach(e=>{const t=n.get(e.transaction_id);if(t){const a={...t,...e,asset_id:e.asset_id||t.asset_id,asset_name:e.asset_name||t.asset_name,collection_name:e.collection_name||t.collection_name,price:e.price||t.price,from:e.from||t.from,to:e.to||t.to,memo:e.memo||t.memo};n.set(e.transaction_id,a)}else n.set(e.transaction_id,e)});const i=Array.from(n.values()).sort((e,t)=>new Date(t.block_time).getTime()-new Date(e.block_time).getTime()).slice(0,t);return Oe.debug("\u2705 Returning unique transactions","API",{unique:i.length,total:s.length}),i}catch(a){return Le.logError("ApiService.getUserTransactions",a,{account:e,limit:t}),[]}}async getUserStats(e){try{let a="2023-01-01";try{const t=await this.getWaxAccountInfo(e);if(t?.created){a=new Date(t.created).toISOString().split("T")[0]}}catch(t){Oe.warn("Failed to fetch account creation date","API",{account:e,error:t})}const s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&page=1&limit=1`,n=await this.fetchWithRetry(s),i=await n.json(),r=i.success&&(i.query_total||i.data?.length)||0,l=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?seller=${e}&state=3&page=1&limit=100&order=desc&sort=updated`,o=await this.fetchWithRetry(l),c=await o.json();let d=0,u=0;const h=new Set;c.success&&c.data&&(d=c.data.length,c.data.forEach(e=>{u+=parseFloat(e.price.amount)||0,e.assets[0]?.collection?.collection_name&&h.add(e.assets[0].collection.collection_name)}));const m=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?buyer=${e}&state=3&page=1&limit=100&order=desc&sort=updated`,p=await this.fetchWithRetry(m),f=await p.json();let x=0,g=0;return f.success&&f.data&&(x=f.data.length,f.data.forEach(e=>{g+=parseFloat(e.price.amount)||0,e.assets[0]?.collection?.collection_name&&h.add(e.assets[0].collection.collection_name)})),{totalAssets:r,totalPurchases:x,totalSales:d,totalSpent:Me(g),totalEarned:Me(u),collections:Array.from(h),favoriteCollections:Array.from(h).slice(0,3),joinDate:a,nftsOwned:r,nftsListed:0}}catch(a){return Le.logError("ApiService.getUserStats",a,{account:e}),{totalAssets:0,totalPurchases:0,totalSales:0,totalSpent:"0.0000 WAX",totalEarned:"0.0000 WAX",collections:[],favoriteCollections:[],joinDate:"2023-01-01",nftsOwned:0,nftsListed:0}}}async getCollectionPriceHistory(e,t="7d"){try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=100&order=desc&sort=updated`,a=await this.fetchWithRetry(t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=await a.json();return s.data.map(e=>({timestamp:new Date(e.updated_at_time).getTime(),price:parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision),volume:1}))}catch(a){return Le.logError("ApiService.getCollectionPriceHistory",a,{collectionName:e,timeframe:t}),this.fetchPriceHistoryFromAlcor(e,t)}}async fetchPriceHistoryFromAlcor(e,t){try{const a=await fetch(`${this.alcorAPI}/markets/1/charts?resolution=1D&limit=100`);if(a.ok){const e=await a.json();if(e&&Array.isArray(e)){const a="24h"===t?1:"7d"===t?7:"30d"===t?30:90;return e.slice(-a).map(e=>({timestamp:1e3*e.time,price:parseFloat(e.close||e.price||"1"),volume:parseFloat(e.volume||"0")}))}}const s=await this.getCollectionMarketStats({collection_name:e});if(s.success&&s.data){const e=parseFloat(s.data.suggested_average||"1"),a=Date.now(),n="24h"===t?1:"7d"===t?7:"30d"===t?30:90,i=[];for(let t=n;t>=0;t--){const r=a-24*t*60*60*1e3,l=e*(.9+.2*Math.random()),o=parseFloat(s.data.volume||"0")/n;i.push({timestamp:r,price:l,volume:o})}return i}return[]}catch(a){return Le.logError("ApiService.fetchPriceHistoryFromAlcor",a,{collectionName:e,timeframe:t}),[]}}async getAuctionBids(e){try{return[]}catch(t){return Le.logError("ApiService.getAuctionBids",t,{auctionId:e}),[]}}async getAuctions(e={}){const{state:t=1,limit:a=36,offset:s=0,sort:n="created",order:i="desc",hide_empty_auctions:r=!0,search:l,collection_name:o,collection_blacklist:c="flinttffunko,onlyfanzgaly,farmerpetsco,fantaspeop",seller_blacklist:d="dximg.wam,xpvrs.wam,5rrrc.wam,nnmnmnmnn.gm",symbol:u="WAX"}=e;try{let e=`${this.atomicMarketAPI}/atomicmarket/v1/auctions?limit=${a}&offset=${s}&sort=${n}&order=${i}&symbol=${u}`;void 0!==t&&(e+=`&state=${t}`),r&&(e+="&hide_empty_auctions=true"),l&&(e+=`&search=${encodeURIComponent(l)}`),o&&(e+=`&collection_name=${encodeURIComponent(o)}`),c&&(e+=`&collection_blacklist=${encodeURIComponent(c)}`),d&&(e+=`&seller_blacklist=${encodeURIComponent(d)}`);const h=await this.fetchWithRetry(e);if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const m=await h.json();if(!m.success||!m.data)throw new Error("Invalid API response structure");return{data:m.data.map(e=>{const t=e.assets?.[0],a=t?.name||t?.data?.name||t?.template?.immutable_data?.name||`${t?.collection?.collection_name||"Unknown"} #${t?.asset_id}`,s=e.price?.amount||"0",n=e.price?.token_symbol||"WAX",i=e.price?.token_precision||8,r="0"!==s?`${(parseFloat(s)/Math.pow(10,i)).toFixed(i)} ${n}`:"0 WAX";return{auction_id:e.auction_id,asset_id:t?.asset_id||"",seller:e.seller,price:r,end_time:e.end_time,collection_name:t?.collection?.collection_name||"Unknown",template_id:t?.template?.template_id||"",asset_name:a,image:t?this.getAssetImage(t):"https://pixeljourney.xyz/img/toppixals/10.webp",video:t&&this.getAssetVideo(t)||"",current_bid:r,bidder:e.buyer||null,created_at_time:e.created_at_time}}),success:!0}}catch(h){return Le.logError("ApiService.getAuctions",h,{state:t,limit:a,offset:s,sort:n,order:i}),{data:[],success:!1,error:h}}}async getAuction(e){try{const t=`${this.atomicMarketAPI}/atomicmarket/v1/auctions/${e}`,a=await this.fetchWithRetry(t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=await a.json();if(!s.success||!s.data)throw new Error("Invalid API response structure");const n=s.data;return{data:{auction_id:n.auction_id,asset_id:n.assets?.[0]?.asset_id||"",seller:n.seller,price:n.price?.amount||"0",end_time:n.end_time,collection_name:n.assets?.[0]?.collection?.collection_name||"Unknown",template_id:n.assets?.[0]?.template?.template_id||"",asset_name:n.assets?.[0]?.name||n.assets?.[0]?.data?.name||`Asset #${n.assets?.[0]?.asset_id}`,image:n.assets?.[0]?this.getAssetImage(n.assets[0]):"",video:n.assets?.[0]?this.getAssetVideo(n.assets[0]):"",current_bid:n.price?.amount||"0",bidder:n.buyer||null},success:!0}}catch(t){return Le.logError("ApiService.getAuction",t,{auctionId:e}),{data:null,success:!1,error:t}}}async getUSDPrice(e){try{const{priceService:t}=await K(async()=>{const{priceService:e}=await Promise.resolve().then(()=>Ye);return{priceService:e}},void 0);return await t.convertWaxToUSDAsync(e.toString())}catch(t){return Le.logError("ApiService.getUSDPrice",t,{waxAmount:e}),"$0.00"}}async waxRpcCall(e,t){for(let s=0;s<this.waxChainEndpoints.length;s++){const n=this.waxChainEndpoints[s],i=`${n}${e}`;try{const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify(t)});if(e.ok)return this.currentWaxChainIndex=s,await e.json();Oe.warn("WAX RPC endpoint returned error status","API",{endpoint:n,status:e.status,statusText:e.statusText})}catch(a){Le.logError("ApiService.waxRpcCall",a,{endpoint:n,body:t})}}throw new Error(`All WAX RPC endpoints failed for ${e}`)}async getPowerupState(){return this.waxRpcCall("/v1/chain/get_table_rows",{json:!0,code:"eosio",scope:"eosio",table:"powup.state",limit:1})}async getChainInfo(){return this.waxRpcCall("/v1/chain/get_info",{})}async getRWAXTransfers(e={}){try{const{limit:t=20,page:a=1,order:s="desc"}=e,[n,i]=await Promise.all([this.getTransfers({recipient_name:"rwax",collection_name:"pixeljourney",limit:Math.ceil(t/2),page:a,order:s,sort:"created"}),this.getTransfers({sender:"rwax",collection_name:"pixeljourney",limit:Math.ceil(t/2),page:a,order:s,sort:"created"})]),r=[...n.data.map(e=>({...e,type:"tokenization"})),...i.data.map(e=>({...e,type:"redemption"}))],l=new Map;r.forEach(e=>{const t=`${e.transfer_id}-${e.txid}`;if(l.has(t)){const a=l.get(t),s=e.assets.length>a.assets.length,n=Object.keys(e).length>Object.keys(a).length;(s||n)&&l.set(t,e)}else l.set(t,e)});const o=Array.from(l.values());o.sort((e,t)=>{const a=new Date(e.created_at_time).getTime(),n=new Date(t.created_at_time).getTime();return"desc"===s?n-a:a-n});return{success:!0,data:o.slice(0,t),query_total:(n.query_total||0)+(i.query_total||0)}}catch(t){return Le.logError("ApiService.getRWAXTransfers",t,e),{success:!1,data:[]}}}},ut=Object.freeze(Object.defineProperty({__proto__:null,apiService:dt},Symbol.toStringTag,{value:"Module"}));const ht=new class{constructor(){M(this,"badgeCache",new Map),M(this,"CACHE_DURATION",3e5),M(this,"BADGE_DEFINITIONS",{"pixal-pfp":{id:"pixal-pfp",name:"Pixal PFP",description:"Owns a Pixal PFP NFT (Template 781515)",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"Own Template 781515"},"pixal-collector-5":{id:"pixal-collector-5",name:"Pixal Collector I",description:"Owns 5+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"5+ Pixal PFPs",tier:1},"pixal-collector-25":{id:"pixal-collector-25",name:"Pixal Collector II",description:"Owns 25+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"25+ Pixal PFPs",tier:2,rarity:"rare"},"pixal-collector-50":{id:"pixal-collector-50",name:"Pixal Collector III",description:"Owns 50+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"50+ Pixal PFPs",tier:3,rarity:"epic"},"pixal-collector-100":{id:"pixal-collector-100",name:"Pixal Collector IV",description:"Owns 100+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"100+ Pixal PFPs",tier:4,rarity:"epic"},"pixal-collector-250":{id:"pixal-collector-250",name:"Pixal Collector V",description:"Owns 250+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"250+ Pixal PFPs",tier:5,rarity:"legendary"},waxrock:{id:"waxrock",name:"WaxRock",description:"Owns WaxRock Pixal NFT",icon:"\ud83e\udea8",color:"#f59e0b",borderColor:"rgba(245, 158, 11, 0.3)",type:"ownership",requirements:"Own WaxRock NFTs"},"waxrock-collector-3":{id:"waxrock-collector-3",name:"WaxRock Collector I",description:"Owns 3+ WaxRock trait Pixals",icon:"\ud83e\udea8",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"3+ WaxRock trait Pixals",tier:1},"waxrock-collector-6":{id:"waxrock-collector-6",name:"WaxRock Collector II",description:"Owns 6+ WaxRock trait Pixals",icon:"\ud83e\udea8",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"6+ WaxRock trait Pixals",tier:2,rarity:"rare"},"waxrock-collector-10":{id:"waxrock-collector-10",name:"WaxRock Collector III",description:"Owns 10+ WaxRock trait Pixals",icon:"\ud83e\udea8",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"10+ WaxRock trait Pixals",tier:3,rarity:"epic"},ingredients:{id:"ingredients",name:"Ingredients",description:"Owns Pixel Journey Ingredients",icon:"\ud83e\uddea",color:"#22c55e",borderColor:"rgba(34, 197, 94, 0.3)",type:"ownership",requirements:"Own Ingredient NFTs"},"pxj-whale":{id:"pxj-whale",name:"PXJ Whale",description:"Holds 50,000,000+ PXJ tokens",icon:"\ud83d\udc0b",color:"#3b82f6",borderColor:"rgba(59, 130, 246, 0.3)",type:"holdings",requirements:"50,000,000+ PXJ",rarity:"legendary"},"pxj-holder":{id:"pxj-holder",name:"PXJ Holder",description:"Holds 100,000+ PXJ tokens",icon:"\ud83d\udc8e",color:"#8b5cf6",borderColor:"rgba(139, 92, 246, 0.3)",type:"holdings",requirements:"100,000+ PXJ"},"pxj-shrimp":{id:"pxj-shrimp",name:"PXJ Shrimp",description:"Holds 10,000+ PXJ tokens",icon:"\ud83e\udd90",color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)",type:"holdings",requirements:"10,000+ PXJ"},"wpixal-holder":{id:"wpixal-holder",name:"WPIXAL Holder",description:"Owns WPIXAL tokens",icon:"\ud83e\ude99",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"holdings",requirements:"Own WPIXAL tokens"},"king-holder":{id:"king-holder",name:"KING Holder",description:"Holds KING tokens",icon:"\ud83d\udc51",color:"#fbbf24",borderColor:"rgba(251, 191, 36, 0.3)",type:"holdings",requirements:"Hold KING tokens"},"journey-collector":{id:"journey-collector",name:"Journey Collector",description:"Owns 50+ Journey assets",icon:"\ud83c\udf92",color:"#ec4899",borderColor:"rgba(236, 72, 153, 0.3)",type:"ownership",requirements:"50+ Journey Assets"},"journey-enthusiast":{id:"journey-enthusiast",name:"Journey Enthusiast",description:"Owns 10+ Journey assets",icon:"\u2b50",color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)",type:"ownership",requirements:"10+ Journey Assets"},"early-adopter":{id:"early-adopter",name:"Early Adopter",description:"One of the first Journey participants",icon:"\ud83d\ude80",color:"#06b6d4",borderColor:"rgba(6, 182, 212, 0.3)",type:"special",requirements:"Early participation",rarity:"legendary"},"active-trader":{id:"active-trader",name:"Active Trader",description:"Completed 100+ transactions",icon:"\ud83d\udcc8",color:"#10b981",borderColor:"rgba(16, 185, 129, 0.3)",type:"trading",requirements:"100+ Transactions",rarity:"rare"},"volume-trader":{id:"volume-trader",name:"Volume Trader",description:"Traded 10,000+ WAX in volume",icon:"\ud83d\udcb0",color:"#f59e0b",borderColor:"rgba(245, 158, 11, 0.3)",type:"trading",requirements:"10,000+ WAX Volume",rarity:"epic"},"community-member":{id:"community-member",name:"Community Member",description:"Active community participant",icon:"\ud83d\udc65",color:"#8b5cf6",borderColor:"rgba(139, 92, 246, 0.3)",type:"social",requirements:"Community Engagement",rarity:"common"},"diamond-hands":{id:"diamond-hands",name:"Diamond Hands",description:"Held assets for 6+ months",icon:"\ud83d\udc8e",color:"#3b82f6",borderColor:"rgba(59, 130, 246, 0.3)",type:"achievement",requirements:"6+ Months Holding",rarity:"epic"},"master-collector":{id:"master-collector",name:"Master Collector",description:"Owns 500+ Journey assets",icon:"\ud83c\udfc6",color:"#dc2626",borderColor:"rgba(220, 38, 38, 0.3)",type:"ownership",requirements:"500+ Journey Assets",rarity:"legendary"}})}async checkUserBadges(e,t=!1){if(!t){const t=this.badgeCache.get(e);if(t&&Date.now()<t.expiresAt)return t.result}try{const[t,a,s]=await Promise.all([dt.getUserInventory(e),this.getPXJBalance(e),this.getTradingStats(e)]),n=[];let i=0,r=!1,l=!1,o=!1;const c=s.volume,d=s.transactions,u=s.accountAge;if(t&&t.length>0){i=t.filter(e=>"pixeljourney"===e.collection).length;const e=t.filter(e=>"781515"===e.template_id).length;r=e>0,r&&n.push(this.BADGE_DEFINITIONS["pixal-pfp"]),e>=250?n.push({...this.BADGE_DEFINITIONS["pixal-collector-250"],unlockedAt:new Date}):e>=100?n.push({...this.BADGE_DEFINITIONS["pixal-collector-100"],unlockedAt:new Date,progress:{current:e,required:250,percentage:Math.round(e/250*100)}}):e>=50?n.push({...this.BADGE_DEFINITIONS["pixal-collector-50"],unlockedAt:new Date,progress:{current:e,required:100,percentage:Math.round(e/100*100)}}):e>=25?n.push({...this.BADGE_DEFINITIONS["pixal-collector-25"],unlockedAt:new Date,progress:{current:e,required:50,percentage:Math.round(e/50*100)}}):e>=5&&n.push({...this.BADGE_DEFINITIONS["pixal-collector-5"],unlockedAt:new Date,progress:{current:e,required:25,percentage:Math.round(e/25*100)}});const a=t.filter(e=>{if(e.template_id===Je.getPixalTemplateId()){const t=e.traits?.WaxRock;if("string"==typeof t&&"none"!==t)return Je.isValidWaxRock(t);if(e.data){const t=Object.values(e.traits||{}).find(e=>"string"==typeof e&&Je.isValidWaxRock(e));return t&&"none"!==t}}return!1}).length;l=a>0,l&&n.push(this.BADGE_DEFINITIONS.waxrock),a>=10?n.push({...this.BADGE_DEFINITIONS["waxrock-collector-10"],unlockedAt:new Date}):a>=6?n.push({...this.BADGE_DEFINITIONS["waxrock-collector-6"],unlockedAt:new Date,progress:{current:a,required:10,percentage:Math.round(a/10*100)}}):a>=3&&n.push({...this.BADGE_DEFINITIONS["waxrock-collector-3"],unlockedAt:new Date,progress:{current:a,required:6,percentage:Math.round(a/6*100)}}),o=t.some(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema),o&&n.push(this.BADGE_DEFINITIONS.ingredients),i>=500?n.push({...this.BADGE_DEFINITIONS["master-collector"],unlockedAt:new Date}):i>=50?n.push({...this.BADGE_DEFINITIONS["journey-collector"],unlockedAt:new Date,progress:i<500?{current:i,required:500,percentage:Math.round(i/500*100)}:void 0}):i>=10&&n.push({...this.BADGE_DEFINITIONS["journey-enthusiast"],unlockedAt:new Date,progress:{current:i,required:50,percentage:Math.round(i/50*100)}})}a>=5e7?n.push({...this.BADGE_DEFINITIONS["pxj-whale"],unlockedAt:new Date}):a>=1e5?n.push({...this.BADGE_DEFINITIONS["pxj-holder"],unlockedAt:new Date,progress:a<5e7?{current:a,required:5e7,percentage:Math.round(a/5e7*100)}:void 0}):a>=1e4&&n.push({...this.BADGE_DEFINITIONS["pxj-shrimp"],unlockedAt:new Date,progress:a<1e5?{current:a,required:1e5,percentage:Math.round(a/1e5*100)}:void 0});const[h,m]=await Promise.all([this.getTokenBalance(e,"pixeljourney","WPIXAL"),this.getTokenBalance(e,"alpha.waxfun","KING")]);h>0&&n.push({...this.BADGE_DEFINITIONS["wpixal-holder"],unlockedAt:new Date}),m>0&&n.push({...this.BADGE_DEFINITIONS["king-holder"],unlockedAt:new Date}),d>=100&&n.push({...this.BADGE_DEFINITIONS["active-trader"],unlockedAt:new Date}),c>=1e4&&n.push({...this.BADGE_DEFINITIONS["volume-trader"],unlockedAt:new Date}),u>=180&&n.push({...this.BADGE_DEFINITIONS["diamond-hands"],unlockedAt:new Date});new Set(n.map(e=>e.type)).size>=3&&n.push({...this.BADGE_DEFINITIONS["community-member"],unlockedAt:new Date});await this.checkEarlyAdopterStatus(e)&&n.push(this.BADGE_DEFINITIONS["early-adopter"]);const p={badges:n,pxjBalance:a,journeyAssets:i,pixalPfpOwned:r,waxrockOwned:l,ingredientsOwned:o,tradingVolume:c,totalTransactions:d,accountAge:u};return this.badgeCache.set(e,{result:p,timestamp:Date.now(),expiresAt:Date.now()+this.CACHE_DURATION}),p}catch(a){return Le.logError("BadgeService.checkUserBadges",a,{userAccount:e}),{badges:[],pxjBalance:0,journeyAssets:0,pixalPfpOwned:!1,waxrockOwned:!1,ingredientsOwned:!1,tradingVolume:0,totalTransactions:0,accountAge:0}}}async getPXJBalance(e){try{const t=await dt.fetchWithRetry(`${qe.WAX_CHAIN.EOSRIO}/v2/state/get_tokens?account=${e}`),a=await t.json();if(a.tokens){const e=a.tokens.find(e=>"PXJ"===e.symbol&&"pixeljourney"===e.contract);return e?parseFloat(e.amount):0}return 0}catch(t){return Le.logError("BadgeService.getPXJBalance",t,{userAccount:e}),0}}async getTradingStats(e){try{return{volume:5e4*Math.random(),transactions:Math.floor(200*Math.random()),accountAge:Math.floor(365*Math.random())}}catch(t){return Le.logError("BadgeService.getTradingStats",t,{userAccount:e}),{volume:0,transactions:0,accountAge:0}}}async getTokenBalance(e,t,a){try{const s=await dt.fetchWithRetry(`${qe.WAX_CHAIN.GREYMASS}/get_table_rows`,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:t,scope:e,table:"accounts",limit:100})}),n=await s.json();if(n.rows&&n.rows.length>0){const e=n.rows.find(e=>e.balance&&e.balance.includes(a));if(e){const t=e.balance.split(" ")[0];return parseFloat(t)||0}}return 0}catch(s){return Le.logError("BadgeService.getTokenBalance",s,{userAccount:e,contract:t,symbol:a}),0}}async checkEarlyAdopterStatus(e){try{const t=await dt.fetchWithRetry(`${qe.WAX_CHAIN.EOSRIO}/v2/history/get_actions?account=${e}&limit=1&sort=asc`),a=await t.json();if(a.actions&&a.actions.length>0){const e=a.actions[0],t=new Date(e.timestamp);return t<new Date("2023-01-01")}return!1}catch(t){return Le.logError("BadgeService.checkEarlyAdopterStatus",t,{userAccount:e}),!1}}getBadgeDefinition(e){return this.BADGE_DEFINITIONS[e]}getAllBadgeDefinitions(){return Object.values(this.BADGE_DEFINITIONS)}async hasUserBadge(e,t){return(await this.checkUserBadges(e)).badges.some(e=>e.id===t)}async getUserBadgeStats(e){const t=await this.checkUserBadges(e);return this.getBadgeStatistics(t.badges)}getBadgeStatistics(e){const t={},a={},s=e.filter(e=>e.unlockedAt).sort((e,t)=>new Date(t.unlockedAt).getTime()-new Date(e.unlockedAt).getTime()).slice(0,5),n=e.filter(e=>e.progress);return e.forEach(e=>{t[e.type]=(t[e.type]||0)+1,e.rarity&&(a[e.rarity]=(a[e.rarity]||0)+1)}),{totalBadges:e.length,badgesByType:t,badgesByRarity:a,recentBadges:s,progressBadges:n}}clearBadgeCache(e){e?this.badgeCache.delete(e):this.badgeCache.clear()}getBadgeProgress(e,t){const a=this.badgeCache.get(e);if(!a)return null;const s=a.result.badges.find(e=>e.id===t);return s?.progress?{badgeId:t,current:s.progress.current,required:s.progress.required,percentage:s.progress.percentage}:null}async getAllBadgeDefinitionsWithProgress(e){const t=await this.checkUserBadges(e),a=new Set(t.badges.map(e=>e.id));return Object.values(this.BADGE_DEFINITIONS).map(e=>{const s=t.badges.find(t=>t.id===e.id);return{...e,earned:a.has(e.id),progress:s?.progress,unlockedAt:s?.unlockedAt}})}};const mt=new class{constructor(){M(this,"balanceCache",new Map),M(this,"CACHE_DURATION",3e4)}async getWaxBalance(e,t=!1){if(!e)return"0.0000 WAX";const a=`wax_${e}`,s=this.balanceCache.get(a),n=Date.now();if(!t&&s&&n-s.lastUpdated<this.CACHE_DURATION)return s.balance;try{const t=await dt.getLightApiBalances(e);if(t&&t.balances){const e=t.balances.find(e=>"WAX"===e.currency&&"eosio.token"===e.contract);if(e){const t=`${e.amount} ${e.currency}`;return this.balanceCache.set(a,{balance:t,lastUpdated:n}),t}}}catch(i){De.warn("Light API balance fetch failed, falling back to currency balance API","BalanceService",{error:i})}try{const t=await dt.getWaxCurrencyBalance(e,"eosio.token","WAX");if(t&&t.length>0){const e=t[0].balance;return this.balanceCache.set(a,{balance:e,lastUpdated:n}),e}}catch(i){De.error("Failed to fetch WAX balance","BalanceService",i)}return"0.0000 WAX"}clearCache(e){e?this.balanceCache.delete(`wax_${e}`):this.balanceCache.clear()}isCached(e){const t=this.balanceCache.get(`wax_${e}`);if(!t)return!1;return Date.now()-t.lastUpdated<this.CACHE_DURATION}},pt=O.createContext(void 0),ft=({children:e})=>{const[t,a]=O.useState([]),s=D.useRef(null),[n,i]=O.useState(null),[r,l]=O.useState(()=>{const e=localStorage.getItem("notification-sound-enabled");return null===e||JSON.parse(e)}),[o]=O.useState(5);O.useEffect(()=>{localStorage.setItem("notification-sound-enabled",JSON.stringify(r))},[r]);const c=e=>{const t=Date.now().toString()+Math.random().toString(36).substr(2,9),s={...e,id:t,duration:e.duration??5e3};a(e=>{const t=[...e,s];return t.length>o?t.slice(-o):t}),s.duration&&s.duration>0&&setTimeout(()=>{d(t)},s.duration)},d=e=>{a(t=>t.filter(t=>t.id!==e))},u=e=>{s.current&&(s.current(e),s.current=null),i(null)},h={notifications:t,addNotification:c,removeNotification:d,clearAllNotifications:()=>{a([])},showSuccess:(e,t,a)=>{c({type:"success",message:e,title:t,duration:a})},showError:(e,t,a)=>{De.warn("User error notification displayed","NotificationContext.showError",{message:e,title:t,duration:a}),c({type:"error",message:e,title:t,duration:a})},showWarning:(e,t,a)=>{De.info("User warning notification displayed","NotificationContext.showWarning",{message:e,title:t,duration:a}),c({type:"warning",message:e,title:t,duration:a})},showInfo:(e,t,a)=>{c({type:"info",message:e,title:t,duration:a})},confirm:(e,t,a="Confirm",n="Cancel")=>new Promise(r=>{i({title:e,message:t,confirmText:a,cancelText:n}),s.current=r}),confirmDialog:n,resolveConfirm:u,soundEnabled:r,toggleSound:()=>{l(e=>!e)}};return Se.jsxs(pt.Provider,{value:h,children:[e,n&&Se.jsx("div",{className:"modal-overlay",children:Se.jsxs("div",{className:"modal-content confirm-dialog",children:[Se.jsx("div",{className:"modal-header",children:Se.jsx("h3",{children:n.title||"Confirm Action"})}),Se.jsx("div",{className:"modal-body",children:Se.jsx("p",{children:n.message})}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"btn-secondary",onClick:()=>u(!1),children:n.cancelText}),Se.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:n.confirmText})]})]})})]})},xt=()=>{const e=O.useContext(pt);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e},gt=({isOpen:e,onClose:t})=>{const{isConnected:a,login:s,purchaseNFT:n,batchPurchaseNFTs:i}=Fe(),{showError:r,showSuccess:l,showWarning:o}=xt(),[c,d]=O.useState([]),[u,h]=O.useState({totalWAX:"0.0000 WAX",totalUSD:"$0.00",itemCount:0}),[m,p]=O.useState(!1),[f,x]=O.useState(new Set),[g,v]=O.useState(20),[y,j]=O.useState(!0),b=O.useCallback(async()=>{p(!0);try{await Ze.checkAvailability();const t=Ze.getCart();d(t),x(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)));try{const e=await Ze.calculateTotals();h(e)}catch(e){De.error("Failed to calculate totals","ShoppingCart",e),r("Calculation Error","Unable to calculate cart totals. Some prices may be outdated.")}}catch(t){De.error("Failed to load cart data","ShoppingCart",t),r("Cart Error","Unable to load cart data. Please try refreshing the page.")}finally{p(!1)}},[r]);O.useEffect(()=>{e&&b();const t=e=>{d(e),Ze.calculateTotals().then(e=>{h(e)}).catch(e=>{De.error("Failed to calculate totals in cart change handler","ShoppingCart",e)})};return Ze.addListener(t),()=>Ze.removeListener(t)},[e,b]);const N=e=>{Ze.removeFromCart(e),x(t=>{const a=new Set(t);return a.delete(e),a})},w=c.filter(e=>!1!==e.isAvailable),k=c.filter(e=>!1===e.isAvailable);if(!e)return null;return Se.jsx("div",{className:"modal-backdrop",onClick:e=>{e.target===e.currentTarget&&t()},role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",children:Se.jsxs("div",{className:"modal-content shopping-cart-modal",children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h2",{className:"modal-title",id:"cart-title",children:["Shopping Cart (",u.itemCount," ",1===u.itemCount?"item":"items",")"]}),Se.jsx("button",{className:"modal-close",onClick:t,"aria-label":"Close shopping cart",type:"button",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsx("div",{className:"modal-body cart-body",children:m?Se.jsxs("div",{className:"cart-loading",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Checking item availability..."})]}):0===c.length?Se.jsxs("div",{className:"cart-empty",children:[Se.jsx("div",{className:"empty-cart-icon",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"9",cy:"21",r:"1"}),Se.jsx("circle",{cx:"20",cy:"21",r:"1"}),Se.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})}),Se.jsx("h3",{children:"Your cart is empty"}),Se.jsx("p",{children:"Add some NFTs from the marketplace to get started!"})]}):Se.jsxs(Se.Fragment,{children:[Se.jsxs("div",{className:"cart-controls",children:[Se.jsxs("div",{className:"cart-actions-left",children:[Se.jsx("button",{className:"btn-select-all",onClick:()=>{const e=c.filter(e=>!1!==e.isAvailable);e.filter(e=>e.selected).length===e.length&&e.length>0?Ze.deselectAll():Ze.selectAll();const t=Ze.getCart();d(t),x(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)))},"aria-label":f.size===w.length&&w.length>0?`Deselect all ${w.length} items`:`Select all ${w.length} items`,type:"button",children:f.size===w.length&&w.length>0?"Deselect All":"Select All"}),k.length>0&&Se.jsxs("button",{className:"btn-cleanup",onClick:()=>{Ze.cleanupUnavailableItems()},"aria-label":`Remove ${k.length} unavailable items from cart`,type:"button",children:["Remove Unavailable (",k.length,")"]})]}),Se.jsx("button",{className:"btn-clear-cart",onClick:()=>{confirm("Are you sure you want to clear your entire cart?")&&(Ze.clearCart(),x(new Set))},"aria-label":"Clear all items from cart",type:"button",children:"Clear Cart"})]}),w.length>1&&Se.jsxs("div",{className:"batch-settings",role:"group","aria-labelledby":"batch-settings-label",children:[Se.jsxs("div",{className:"batch-toggle",children:[Se.jsxs("label",{children:[Se.jsx("input",{type:"checkbox",checked:y,onChange:e=>j(e.target.checked),"aria-describedby":"batch-purchase-description"}),Se.jsx("span",{id:"batch-settings-label",children:"Use batch purchasing"})]}),Se.jsx("div",{id:"batch-purchase-description",className:"sr-only",children:"Batch purchasing allows you to buy multiple items in a single transaction, which is faster and more efficient."})]}),y&&Se.jsxs("div",{className:"batch-controls",children:[Se.jsx("label",{htmlFor:"items-per-tx",children:"Items per transaction:"}),Se.jsxs("div",{className:"batch-slider",children:[Se.jsx("input",{id:"items-per-tx",type:"range",min:"1",max:"50",value:g,onChange:e=>v(parseInt(e.target.value))}),Se.jsx("span",{className:"batch-value",children:g})]}),Se.jsx("div",{className:"batch-info",children:f.size>g&&Se.jsxs("small",{children:["Will create ",Math.ceil(f.size/g)," transaction",Math.ceil(f.size/g)>1?"s":""]})})]})]}),w.length>0&&Se.jsxs("div",{className:"cart-section",children:[Se.jsx("h3",{className:"section-title",children:"Available Items"}),Se.jsx("div",{className:"cart-items",children:w.map(e=>Se.jsxs("div",{className:"cart-item",children:[Se.jsx("div",{className:"item-checkbox",children:Se.jsx("input",{type:"checkbox",checked:f.has(e.nft.asset_id),onChange:()=>(e=>{Ze.toggleSelection(e);const t=Ze.getCart();d(t),x(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)))})(e.nft.asset_id),"aria-label":`Select ${e.nft.name} for purchase`,id:`item-${e.nft.asset_id}`})}),Se.jsx("div",{className:"item-image",children:e.nft.video?Se.jsx("video",{src:e.nft.video,className:"cart-item-media",muted:!0,onError:t=>{const a=document.createElement("img");a.src=e.nft.image,a.className="cart-item-media",a.alt=e.nft.name,t.currentTarget.parentNode?.replaceChild(a,t.currentTarget)}}):Se.jsx("img",{src:e.nft.image,alt:`${e.nft.name} from ${e.nft.collection}`,className:"cart-item-media"})}),Se.jsxs("div",{className:"item-details",children:[Se.jsx("h4",{className:"item-name",children:e.nft.name}),Se.jsx("p",{className:"item-collection",children:e.nft.collection}),Se.jsx("div",{className:"item-price","aria-label":`Price: ${e.nft.price}`,children:Se.jsx("span",{className:"price-wax",children:e.nft.price})})]}),Se.jsx("button",{className:"btn-remove",onClick:()=>N(e.nft.asset_id),title:"Remove from cart","aria-label":`Remove ${e.nft.name} from cart`,type:"button",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[Se.jsx("polyline",{points:"3,6 5,6 21,6"}),Se.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]})})]},e.nft.asset_id))})]}),k.length>0&&Se.jsxs("div",{className:"cart-section",children:[Se.jsxs("h3",{className:"section-title unavailable-title",children:["Unavailable Items (",k.length,")"]}),Se.jsx("div",{className:"cart-items unavailable-items",children:k.map(e=>Se.jsxs("div",{className:"cart-item unavailable",children:[Se.jsxs("div",{className:"item-image",children:[Se.jsx("img",{src:e.nft.image,alt:e.nft.name,className:"cart-item-media"}),Se.jsx("div",{className:"unavailable-overlay",children:"Unavailable"})]}),Se.jsxs("div",{className:"item-details",children:[Se.jsx("h4",{className:"item-name",children:e.nft.name}),Se.jsx("p",{className:"item-collection",children:e.nft.collection}),Se.jsx("div",{className:"item-price",children:Se.jsx("span",{className:"price-wax",children:e.nft.price})})]}),Se.jsx("button",{className:"btn-remove",onClick:()=>N(e.nft.asset_id),title:"Remove from cart",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("polyline",{points:"3,6 5,6 21,6"}),Se.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]})})]},e.nft.asset_id))})]})]})}),c.length>0&&Se.jsxs("div",{className:"modal-footer cart-footer",children:[Se.jsx("div",{className:"cart-totals",children:Se.jsxs("div",{className:"total-line",children:[Se.jsxs("span",{className:"total-label",children:["Total (",f.size," selected):"]}),Se.jsxs("div",{className:"total-prices",children:[Se.jsx("span",{className:"total-wax",children:u.totalWAX}),Se.jsx("span",{className:"total-usd",children:u.totalUSD})]})]})}),Se.jsxs("div",{className:"cart-actions",children:[Se.jsx("button",{className:"btn-secondary",onClick:t,type:"button","aria-label":"Continue shopping and close cart",children:"Continue Shopping"}),Se.jsxs("button",{className:"btn-primary",onClick:async()=>{const e=Ze.getSelectedItems().filter(e=>!1!==e.isAvailable);if(0===e.length)return void r("Please select items to purchase","No Items Selected");if(!a)try{await s()}catch(d){return De.error("Login failed","ShoppingCart",d),void r("Login Failed","Please connect your wallet to purchase NFTs")}let t=0;const c=[];if(y&&e.length>1){const a=[];for(let t=0;t<e.length;t+=g)a.push(e.slice(t,t+g));for(let e=0;e<a.length;e++){const s=a[e],n=s.filter(e=>e.nft.sale_id&&e.nft.price).map(e=>({saleId:e.nft.sale_id,price:e.nft.price.replace(" WAX","")}));if(0!==n.length)try{await i(n),s.forEach(e=>{e.nft.sale_id&&(Ze.removeFromCart(e.nft.asset_id),x(t=>{const a=new Set(t);return a.delete(e.nft.asset_id),a}),t++)}),e<a.length-1&&await new Promise(e=>setTimeout(e,2e3))}catch(d){De.error("Batch purchase failed","ShoppingCart",d),r("Batch Purchase Failed",`Failed to purchase batch of ${s.length} items`),s.forEach(e=>{c.push(`${e.nft.name} (batch failed: ${d instanceof Error?d.message:"Unknown error"})`)})}else s.forEach(e=>{e.nft.sale_id||c.push(`${e.nft.name} (not for sale)`)})}}else for(const a of e)try{if(!a.nft.sale_id||!a.nft.price){c.push(`${a.nft.name} (not for sale)`);continue}await n(a.nft.sale_id,a.nft.price.replace(" WAX","")),t++,Ze.removeFromCart(a.nft.asset_id),x(e=>{const t=new Set(e);return t.delete(a.nft.asset_id),t}),e.length>1&&await new Promise(e=>setTimeout(e,1e3))}catch(d){De.error(`Purchase failed for ${a.nft.name}`,"ShoppingCart",d),r("Purchase Failed",`Failed to purchase ${a.nft.name}`),c.push(`${a.nft.name} (${d instanceof Error?d.message:"Unknown error"})`)}t>0&&0===c.length?l(`Successfully purchased ${t} item${1!==t?"s":""}!`,"Purchase Complete"):t>0&&c.length>0?o(`Partially completed: ${t} successful, ${c.length} failed. Failed items: ${c.join(", ")}`,"Purchase Partially Complete",8e3):r(`All purchases failed. Items: ${c.join(", ")}`,"Purchase Failed")},disabled:0===f.size,type:"button","aria-label":`Buy ${f.size} selected items`,"aria-describedby":"cart-totals",children:["Buy Selected (",f.size,")"]})]})]})]})})};const vt=new class{constructor(){M(this,"preferences"),M(this,"focusStack",[]),M(this,"trapFocusElements",[]),M(this,"isInitialized",!1),M(this,"mediaQueryListeners",[]),M(this,"keyboardNavigationActive",!1),this.preferences=this.getDefaultPreferences(),this.detectSystemPreferences()}getDefaultPreferences(){return{reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0}}async initialize(){if(!this.isInitialized)try{this.loadPreferences(),this.setupMediaQueryListeners(),this.setupKeyboardNavigation(),this.applyAccessibilitySettings(),this.setupFocusManagement(),this.isInitialized=!0,st.trackEvent("accessibility_service_initialized",{preferences:this.preferences,systemPreferences:this.detectSystemPreferences()}),Oe.info("Accessibility service initialized","ACCESSIBILITY")}catch(e){Oe.error("Failed to initialize accessibility service","ACCESSIBILITY",e),st.reportError(e,"accessibility_init_error")}}detectSystemPreferences(){const e={};return window.matchMedia&&(e.reducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e.highContrast=window.matchMedia("(prefers-contrast: high)").matches),e.screenReader=this.detectScreenReader(),e}detectScreenReader(){return navigator.userAgent.includes("NVDA")||navigator.userAgent.includes("JAWS")||navigator.userAgent.includes("VoiceOver")||void 0!==window.speechSynthesis}setupMediaQueryListeners(){if(!window.matchMedia)return;const e=window.matchMedia("(prefers-reduced-motion: reduce)");e.addEventListener("change",e=>{this.updatePreference("reducedMotion",e.matches)}),this.mediaQueryListeners.push(e);const t=window.matchMedia("(prefers-contrast: high)");t.addEventListener("change",e=>{this.updatePreference("highContrast",e.matches)}),this.mediaQueryListeners.push(t)}setupKeyboardNavigation(){document.addEventListener("keydown",e=>{"Tab"===e.key&&(this.keyboardNavigationActive=!0,document.body.classList.add("a11y-keyboard-navigation"))}),document.addEventListener("mousedown",()=>{this.keyboardNavigationActive=!1,document.body.classList.remove("a11y-keyboard-navigation")})}setupFocusManagement(){document.addEventListener("focusin",e=>{const t=e.target;t&&this.keyboardNavigationActive&&this.announceToScreenReader(`Focused on ${this.getElementDescription(t)}`)})}applyAccessibilitySettings(){const e=document.documentElement;this.preferences.reducedMotion?e.classList.add("a11y-reduce-motion"):e.classList.remove("a11y-reduce-motion"),this.preferences.highContrast?e.classList.add("a11y-high-contrast"):e.classList.remove("a11y-high-contrast"),this.preferences.largeText?e.classList.add("a11y-large-text"):e.classList.remove("a11y-large-text"),this.preferences.screenReader?e.classList.add("a11y-screen-reader-active"):e.classList.remove("a11y-screen-reader-active")}updatePreference(e,t){this.preferences[e]=t,this.applyAccessibilitySettings(),this.savePreferences(),st.trackEvent("accessibility_preference_changed",{preference:e,value:t,allPreferences:this.preferences})}getPreferences(){return{...this.preferences}}setAriaLabel(e,t){e.setAttribute("aria-label",t)}setAriaDescribedBy(e,t){e.setAttribute("aria-describedby",t)}setAriaExpanded(e,t){e.setAttribute("aria-expanded",t.toString())}setAriaSelected(e,t){e.setAttribute("aria-selected",t.toString())}setAriaChecked(e,t){e.setAttribute("aria-checked",t.toString())}setAriaHidden(e,t){e.setAttribute("aria-hidden",t.toString())}focusElement(e,t){try{e.focus(t),this.focusStack.push(e)}catch(a){Oe.warn("Failed to focus element","ACCESSIBILITY",a)}}restoreFocus(){const e=this.focusStack.pop();e&&document.contains(e)&&this.focusElement(e)}trapFocus(e){const t=this.getFocusableElements(e);t.forEach((e,t)=>{this.trapFocusElements.push({element:e,tabIndex:t,originalTabIndex:e.tabIndex})}),t.length>0&&this.focusElement(t[0]);e.addEventListener("keydown",e=>{if("Tab"===e.key){const a=t[0],s=t[t.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),this.focusElement(s)):document.activeElement===s&&(e.preventDefault(),this.focusElement(a))}"Escape"===e.key&&this.releaseFocusTrap()}),e.setAttribute("data-focus-trap-active","true")}releaseFocusTrap(){this.trapFocusElements.forEach(({element:e,originalTabIndex:t})=>{void 0!==t&&(e.tabIndex=t)}),this.trapFocusElements=[],document.querySelectorAll("[data-focus-trap-active]").forEach(e=>{e.removeAttribute("data-focus-trap-active")}),this.restoreFocus()}getFocusableElements(e){const t=["button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","a[href]",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(", ");return Array.from(e.querySelectorAll(t)).filter(e=>{const t=e;return null!==t.offsetParent&&!t.hasAttribute("aria-hidden")})}announceToScreenReader(e,t="polite"){const a=document.createElement("div");a.setAttribute("aria-live",t),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=e,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},1e3)}getElementDescription(e){const t=e.getAttribute("aria-label");if(t)return t;const a=e.textContent?.trim();if(a)return a;if("IMG"===e.tagName){const t=e.alt;if(t)return t}const s=e.getAttribute("title");if(s)return s;return`${e.getAttribute("role")||e.tagName.toLowerCase()} element`}registerKeyboardShortcut(e,t,a){document.addEventListener("keydown",s=>{this.matchesShortcut(s,e)&&(s.preventDefault(),t(s),st.trackEvent("keyboard_shortcut_used",{shortcut:e,description:a}))})}matchesShortcut(e,t){const a=t.toLowerCase().split("+"),s=a.pop(),n={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey};for(const i of a)if(!n[i])return!1;return e.key.toLowerCase()===s}calculateLuminance(e,t,a){const[s,n,i]=[e,t,a].map(e=>e/255),[r,l,o]=[s,n,i].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*r+.7152*l+.0722*o}calculateContrastRatio(e,t){const a=this.hexToRgb(e),s=this.hexToRgb(t);if(!a||!s)return 1;const n=this.calculateLuminance(a.r,a.g,a.b),i=this.calculateLuminance(s.r,s.g,s.b);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}checkColorContrast(e,t){return this.calculateContrastRatio(e,t)}hexToRgb(e){return 3===(e=e.replace("#","")).length&&(e=e.split("").map(e=>e+e).join("")),6===e.length&&/^[0-9A-Fa-f]{6}$/.test(e)?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16)}:null}meetsContrastRequirements(e,t,a="AA",s="normal"){return this.calculateContrastRatio(e,t)>={AA:{normal:4.5,large:3},AAA:{normal:7,large:4.5}}[a][s]}suggestAccessibleColors(e,t,a="AA"){const s=[],n=this.hexToRgb(e),i=this.hexToRgb(t);if(!n||!i)return s;return[-60,-40,-20,20,40,60,80,100].forEach(n=>{const i=this.adjustBrightness(e,n),r=this.calculateContrastRatio(i,t);this.meetsContrastRequirements(i,t,a)&&s.push({foreground:i,background:t,ratio:r})}),s.sort((e,t)=>t.ratio-e.ratio).slice(0,5)}adjustBrightness(e,t){const a=this.hexToRgb(e);if(!a)return e;const s=t/100,n=e=>s>0?Math.min(255,e+(255-e)*s):Math.max(0,e+e*s),i=Math.round(n(a.r)),r=Math.round(n(a.g)),l=Math.round(n(a.b));return`#${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}savePreferences(){try{localStorage.setItem("accessibility_preferences",JSON.stringify(this.preferences))}catch(e){Oe.warn("Failed to save accessibility preferences","ACCESSIBILITY",e)}}loadPreferences(){try{const e=localStorage.getItem("accessibility_preferences");if(e){const t=JSON.parse(e);this.preferences={...this.preferences,...t}}}catch(e){Oe.warn("Failed to load accessibility preferences","ACCESSIBILITY",e)}}destroy(){this.mediaQueryListeners.forEach(e=>{e.removeEventListener("change",()=>{})}),this.mediaQueryListeners=[],this.releaseFocusTrap(),this.focusStack=[]}},yt=({isOpen:e,onClose:t})=>{const[a,s]=O.useState({reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0}),[n,i]=O.useState(!1);O.useEffect(()=>{if(e){const e=vt.getPreferences();s(e),vt.announceToScreenReader("Accessibility settings dialog opened");const t=document.querySelector(".accessibility-modal button");t&&vt.focusElement(t)}},[e]);const r=async(e,t)=>{i(!0);try{const n={...a,[e]:t};s(n),vt.updatePreference(e,t);const i={reducedMotion:"Reduced motion",highContrast:"High contrast",largeText:"Large text",screenReader:"Screen reader optimizations",keyboardNavigation:"Keyboard navigation"};vt.announceToScreenReader(`${i[e]} ${t?"enabled":"disabled"}`,"assertive"),st.trackEvent("accessibility_preference_changed",{preference:e,value:t,source:"settings_modal"})}catch(n){console.error("Failed to update accessibility preference:",n),st.reportError(n,"accessibility_preference_update_error"),s(a=>({...a,[e]:!t})),vt.announceToScreenReader("Failed to update preference. Please try again.","assertive")}finally{i(!1)}},l=()=>{vt.announceToScreenReader("Accessibility settings dialog closed"),vt.restoreFocus(),t()};return e?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"accessibility-modal-backdrop",onClick:l,"aria-hidden":"true"}),Se.jsx("div",{className:"accessibility-modal "+(n?"loading":""),role:"dialog","aria-modal":"true","aria-labelledby":"accessibility-settings-title","aria-describedby":"accessibility-settings-description",onKeyDown:e=>{"Escape"===e.key&&l()},children:Se.jsxs("div",{className:"accessibility-modal-content",children:[Se.jsxs("div",{className:"accessibility-modal-header",children:[Se.jsx("h2",{id:"accessibility-settings-title",className:"accessibility-modal-title",children:"Accessibility Settings"}),Se.jsx("button",{onClick:l,className:"accessibility-modal-close","aria-label":"Close accessibility settings",children:Se.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se.jsx("p",{id:"accessibility-settings-description",className:"accessibility-modal-description",children:"Customize your accessibility preferences to improve your experience with the application."}),Se.jsxs("div",{className:"accessibility-settings-list",children:[Se.jsxs("div",{className:"accessibility-setting-item",children:[Se.jsxs("div",{className:"accessibility-setting-info",children:[Se.jsx("label",{className:"accessibility-setting-label",children:"Reduced Motion"}),Se.jsx("p",{className:"accessibility-setting-description",children:"Minimize animations and transitions for a calmer experience."})]}),Se.jsx("button",{onClick:()=>r("reducedMotion",!a.reducedMotion),className:"accessibility-toggle "+(a.reducedMotion?"active":""),role:"switch","aria-checked":a.reducedMotion,disabled:n,children:Se.jsx("span",{className:"accessibility-toggle-thumb"})})]}),Se.jsxs("div",{className:"accessibility-setting-item",children:[Se.jsxs("div",{className:"accessibility-setting-info",children:[Se.jsx("label",{className:"accessibility-setting-label",children:"High Contrast"}),Se.jsx("p",{className:"accessibility-setting-description",children:"Increase color contrast for better visibility"})]}),Se.jsx("button",{onClick:()=>r("highContrast",!a.highContrast),className:"accessibility-toggle "+(a.highContrast?"active":""),role:"switch","aria-checked":a.highContrast,disabled:n,children:Se.jsx("span",{className:"accessibility-toggle-thumb"})})]}),Se.jsxs("div",{className:"accessibility-setting-item",children:[Se.jsxs("div",{className:"accessibility-setting-info",children:[Se.jsx("label",{className:"accessibility-setting-label",children:"Large Text"}),Se.jsx("p",{className:"accessibility-setting-description",children:"Increase text size throughout the application"})]}),Se.jsx("button",{onClick:()=>r("largeText",!a.largeText),className:"accessibility-toggle "+(a.largeText?"active":""),role:"switch","aria-checked":a.largeText,disabled:n,children:Se.jsx("span",{className:"accessibility-toggle-thumb"})})]}),Se.jsxs("div",{className:"accessibility-setting-item",children:[Se.jsxs("div",{className:"accessibility-setting-info",children:[Se.jsx("label",{className:"accessibility-setting-label",children:"Screen Reader Optimizations"}),Se.jsx("p",{className:"accessibility-setting-description",children:"Optimize interface for screen reader users"})]}),Se.jsx("button",{onClick:()=>r("screenReader",!a.screenReader),className:"accessibility-toggle "+(a.screenReader?"active":""),role:"switch","aria-checked":a.screenReader,disabled:n,children:Se.jsx("span",{className:"accessibility-toggle-thumb"})})]}),Se.jsxs("div",{className:"accessibility-setting-item",children:[Se.jsxs("div",{className:"accessibility-setting-info",children:[Se.jsx("label",{className:"accessibility-setting-label",children:"Enhanced Keyboard Navigation"}),Se.jsx("p",{className:"accessibility-setting-description",children:"Show focus indicators and enable keyboard shortcuts"})]}),Se.jsx("button",{onClick:()=>r("keyboardNavigation",!a.keyboardNavigation),className:"accessibility-toggle "+(a.keyboardNavigation?"active":""),role:"switch","aria-checked":a.keyboardNavigation,disabled:n,children:Se.jsx("span",{className:"accessibility-toggle-thumb"})})]})]}),Se.jsxs("div",{className:"accessibility-modal-actions",children:[Se.jsx("button",{onClick:()=>{const e={reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0};s(e),Object.entries(e).forEach(([e,t])=>{vt.updatePreference(e,t)}),vt.announceToScreenReader("Accessibility settings reset to defaults","assertive"),st.trackEvent("accessibility_settings_reset",{source:"settings_modal"})},disabled:n,className:"accessibility-modal-reset",children:"Reset to Defaults"}),Se.jsxs("div",{className:"accessibility-modal-buttons",children:[Se.jsx("button",{onClick:l,disabled:n,className:"accessibility-modal-cancel",children:"Cancel"}),Se.jsx("button",{onClick:l,disabled:n,className:"accessibility-modal-done",children:n?"Saving...":"Done"})]})]}),Se.jsxs("div",{className:"accessibility-shortcuts",children:[Se.jsx("h3",{className:"accessibility-shortcuts-title",children:"Keyboard Shortcuts"}),Se.jsxs("div",{className:"accessibility-shortcuts-list",children:[Se.jsxs("div",{className:"accessibility-shortcut",children:[Se.jsx("span",{children:"Close modal"}),Se.jsx("kbd",{className:"accessibility-kbd",children:"Esc"})]}),Se.jsxs("div",{className:"accessibility-shortcut",children:[Se.jsx("span",{children:"Navigate settings"}),Se.jsx("kbd",{className:"accessibility-kbd",children:"Tab"})]}),Se.jsxs("div",{className:"accessibility-shortcut",children:[Se.jsx("span",{children:"Toggle setting"}),Se.jsx("kbd",{className:"accessibility-kbd",children:"Space"})]}),Se.jsxs("div",{className:"accessibility-shortcut",children:[Se.jsx("span",{children:"Activate buttons"}),Se.jsx("kbd",{className:"accessibility-kbd",children:"Enter"})]})]})]})]})})]}):null},jt=({currentPage:e})=>{const{isConnected:t,isLoading:a,login:s,logout:n,account:i}=Fe(),[r,l]=O.useState(!1),[o,c]=O.useState(!1),[d,u]=O.useState(0),[h,m]=O.useState(!1),[p,f]=O.useState(!1),[x,g]=O.useState(!1),[v,y]=O.useState(()=>{if(i){const e=localStorage.getItem(`userSettings_${i}`);if(e){const t=JSON.parse(e);return void 0===t.darkMode||t.darkMode}}const e=localStorage.getItem("darkMode");return!e||JSON.parse(e)}),{settings:j,updateSetting:b}=at(),[N,w]=O.useState("0.0000"),[k,_]=O.useState([]),[S,C]=O.useState(0),[A,T]=O.useState(!1),[P,E]=O.useState(!1),[I,F]=O.useState(!1),$=O.useRef(null),L=O.useRef(null);O.useEffect(()=>{const e=()=>{c(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),O.useEffect(()=>{if(document.documentElement.setAttribute("data-theme",v?"dark":"light"),localStorage.setItem("darkMode",JSON.stringify(v)),i){const e=localStorage.getItem(`userSettings_${i}`);if(e){const t={...JSON.parse(e),darkMode:v};localStorage.setItem(`userSettings_${i}`,JSON.stringify(t))}}},[v,i]);const M=()=>{const e=!v;if(y(e),i){const t=localStorage.getItem(`userSettings_${i}`);if(t){const a={...JSON.parse(t),darkMode:e};localStorage.setItem(`userSettings_${i}`,JSON.stringify(a))}else{const t={emailNotifications:!0,priceAlerts:!0,marketingEmails:!1,darkMode:e,language:"en",currency:"WAX"};localStorage.setItem(`userSettings_${i}`,JSON.stringify(t))}}};O.useEffect(()=>{const e=()=>{u(Ze.getCartCount())};return e(),Ze.addListener(e),()=>Ze.removeListener(e)},[]);const R=()=>{l(!r)},W=()=>{l(!1)},D=()=>{f(!1)},B=O.useCallback(async(e=!1)=>{if(i&&t)try{const t=await mt.getWaxBalance(i,e);w(t),C(Date.now())}catch(a){De.error("Failed to fetch WAX balance","Navigation",a)}},[i,t]),z=O.useCallback(async()=>{if(i&&t)try{const e=await ht.checkUserBadges(i);_(e.badges)}catch(e){De.error("Failed to check user badges","Navigation",e)}},[i,t]);return O.useEffect(()=>{const e=e=>{$.current&&!$.current.contains(e.target)&&D(),L.current&&!L.current.contains(e.target)&&E(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),O.useEffect(()=>{t&&i?(B(),z()):(w("0.0000"),_([]))},[t,i,B,z]),Se.jsxs(Se.Fragment,{children:[Se.jsx("a",{href:"#main-content",className:"a11y-skip-link",children:"Skip to main content"}),Se.jsx("a",{href:"#navigation",className:"a11y-skip-link",children:"Skip to navigation"}),Se.jsx("nav",{className:"navbar "+(o?"scrolled":""),role:"navigation","aria-label":"Main navigation",id:"navigation",children:Se.jsxs("div",{className:"navbar-container",children:[Se.jsxs(U,{to:"/marketplace",className:"navbar-logo","aria-label":"PxMarket - Go to marketplace home",children:[Se.jsx("img",{src:"https://pixeljourney.xyz/img/logo.png",alt:"PxMarket logo",className:"logo-image"}),Se.jsx("span",{className:"logo-text",children:"PxMarket"})]}),Se.jsxs("div",{className:"navbar-nav",role:"menubar","aria-label":"Main menu",children:[Se.jsx(U,{to:"/rwax",className:"nav-link "+("rwax"===e?"active":""),role:"menuitem","aria-current":"rwax"===e?"page":void 0,children:"RWAX"}),Se.jsx(U,{to:"/collections",className:"nav-link "+("collections"===e?"active":""),role:"menuitem","aria-current":"collections"===e?"page":void 0,children:"Collections"}),Se.jsxs("div",{className:"nav-dropdown",ref:L,children:[Se.jsxs("button",{className:"nav-link dropdown-toggle "+(P?"active":""),onClick:()=>E(!P),"aria-expanded":P,"aria-haspopup":"true",children:["More",Se.jsx("svg",{className:"dropdown-arrow",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),P&&Se.jsxs("div",{className:"dropdown-menu",role:"menu",children:[Se.jsxs("div",{className:"dropdown-section",children:[Se.jsx("h4",{className:"dropdown-section-title",children:"Marketplace"}),Se.jsx(U,{to:"/auctions",className:"dropdown-item "+("auctions"===e?"active":""),role:"menuitem",onClick:()=>E(!1),children:"Auctions"}),Se.jsx(U,{to:"/activity",className:"dropdown-item "+("activity"===e?"active":""),role:"menuitem",onClick:()=>E(!1),children:"Activity"})]}),Se.jsxs("div",{className:"dropdown-section",children:[Se.jsx("h4",{className:"dropdown-section-title",children:"Tools & Features"}),Se.jsx(U,{to:"/pxcrafting",className:"dropdown-item "+("pxcrafting"===e?"active":""),role:"menuitem",onClick:()=>E(!1),children:"PxCraft"}),Se.jsx(U,{to:"/pxswap",className:"dropdown-item "+("pxswap"===e?"active":""),role:"menuitem",onClick:()=>E(!1),children:"PxSwap"}),Se.jsx(U,{to:"/journeymap",className:"dropdown-item "+("journeymap"===e?"active":""),role:"menuitem",onClick:()=>E(!1),children:"JourneyMap"}),Se.jsx(U,{to:"/staking",className:"dropdown-item "+("pxstaking"===e?"active":""),role:"menuitem",onClick:()=>E(!1),children:"PxStaking"})]}),Se.jsxs("div",{className:"dropdown-section social-section",children:[Se.jsx("h4",{className:"dropdown-section-title",children:"Community"}),Se.jsxs("a",{href:"http://discord.gg/pixel-journey-1130670500776005734",target:"_blank",rel:"noopener noreferrer",className:"dropdown-item nav-social-link",role:"menuitem",children:[Se.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})}),"Join Discord"]}),Se.jsxs("a",{href:"https://x.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"dropdown-item nav-social-link",role:"menuitem",children:[Se.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"Follow on X"]})]})]})]}),Se.jsx(U,{to:"/learn",className:"nav-link "+("learn"===e?"active":""),role:"menuitem","aria-current":"learn"===e?"page":void 0,children:"Learn"}),Se.jsx(U,{to:"/rewards",className:"nav-link "+("rewards"===e?"active":""),role:"menuitem","aria-current":"rewards"===e?"page":void 0,children:"Rewards"})]}),Se.jsxs("div",{className:"navbar-actions",children:[Se.jsx("button",{onClick:()=>g(!0),className:"accessibility-btn","aria-label":"Open accessibility settings",title:"Accessibility Settings",children:Se.jsx("svg",{className:"accessibility-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})})}),t&&d>0&&Se.jsxs("button",{onClick:()=>m(!0),className:"cart-btn","aria-label":`Open Shopping Cart (${d} items)`,"aria-describedby":"cart-count",children:[Se.jsxs("svg",{className:"cart-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[Se.jsx("circle",{cx:"9",cy:"21",r:"1"}),Se.jsx("circle",{cx:"20",cy:"21",r:"1"}),Se.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),Se.jsx("span",{className:"cart-badge",id:"cart-count","aria-label":`${d} items in cart`,children:d}),Se.jsx("span",{className:"cart-text",children:"Cart"})]}),Se.jsxs("div",{className:"wallet-container",ref:$,children:[Se.jsx("button",{className:"wallet-btn "+(t?"connected":""),onClick:t?()=>{if(f(!p),!p&&t&&i){Date.now()-S>3e4&&B()}}:s,disabled:a,"aria-label":t?`Wallet connected: ${i}. Click to open wallet menu`:"Connect wallet","aria-expanded":t&&p,"aria-haspopup":"menu",children:a?Se.jsx("span",{className:"loading-spinner",children:"\u27f3"}):t?Se.jsxs(Se.Fragment,{children:[Se.jsx("svg",{className:"wallet-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),i||"Connected"]}):"Connect"}),t&&p&&Se.jsxs("div",{className:"wallet-dropdown",role:"menu","aria-label":"Wallet menu",onKeyDown:e=>{"Escape"===e.key&&(D(),vt.announceToScreenReader("Wallet menu closed"))},children:[Se.jsx("div",{className:"wallet-dropdown-header",role:"group","aria-label":"Wallet information",children:Se.jsx("div",{className:"wallet-account","aria-label":`Wallet account: ${i}`,children:i})}),Se.jsxs(U,{to:"/inventory",className:"wallet-inventory-btn","aria-label":"Open Inventory",onClick:()=>f(!1),role:"menuitem",children:[Se.jsxs("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[Se.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),Se.jsx("path",{d:"M9 9h6v6H9z"})]}),Se.jsx("span",{children:"My Inventory"})]}),Se.jsxs(U,{to:"/profile",className:"wallet-inventory-btn","aria-label":"View Profile",onClick:()=>f(!1),role:"menuitem",children:[Se.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Se.jsx("span",{children:"My Profile"})]}),Se.jsxs(U,{to:"/watchlist",className:"wallet-inventory-btn","aria-label":"View Watchlist",onClick:()=>f(!1),role:"menuitem",children:[Se.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),Se.jsx("span",{children:"My Watchlist"})]}),Se.jsxs("div",{className:"wallet-balance",role:"group","aria-label":"Wallet balance information",children:[Se.jsx("span",{className:"balance-label",children:"WAX Balance:"}),Se.jsx("span",{className:"nav-balance-amount","aria-label":`Balance: ${N} WAX`,children:N})]}),Se.jsxs("div",{className:"wallet-badges",role:"group","aria-label":"User badges",children:[Se.jsxs("div",{className:"badges-header",onClick:()=>F(!I),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0"},children:[Se.jsx("span",{className:"badges-label",children:"PxBadges:"}),Se.jsx("span",{style:{fontSize:"12px",color:"#888"},children:I?"\u25bc":"\u25b6"})]}),I?Se.jsx("div",{className:"badges-expanded",style:{display:"flex",flexDirection:"column",gap:"8px"},children:ht.getAllBadgeDefinitions().map(e=>{const t=k.some(t=>t.id===e.id);return Se.jsxs("div",{className:"badge-item "+(t?"earned":"unearned"),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",borderRadius:"6px",background:t?`${e.color}15`:"rgba(128, 128, 128, 0.05)",border:`1px solid ${t?e.borderColor:"rgba(128, 128, 128, 0.1)"}`},children:[Se.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[Se.jsx("span",{style:{fontSize:"16px",opacity:t?1:.5},children:e.icon}),Se.jsxs("div",{children:[Se.jsxs("div",{style:{fontSize:"12px",fontWeight:"500",color:t?e.color:"#666"},children:[e.name," ",t&&"\u2713"]}),Se.jsx("div",{style:{fontSize:"10px",color:"#888"},children:e.requirements})]})]}),!t&&Se.jsx("button",{onClick:()=>{"pxj-whale"===e.id||"pxj-holder"===e.id?window.open("https://waxonedge.app/swap/WAX_eosio.token/PXJ_pixeljourney","_blank"):"pixal-pfp"===e.id?window.location.href="/marketplace?collection=pixeljourney&template=781515":"waxrock"===e.id?window.location.href="/marketplace?category=waxrock":"ingredients"===e.id?window.location.href="/marketplace?category=ingredients":window.location.href="/marketplace?collection=pixeljourney"},style:{fontSize:"10px",padding:"4px 8px",background:e.color,color:"white",border:"none",borderRadius:"4px",cursor:"pointer",transition:"opacity 0.2s"},onMouseEnter:e=>e.target.style.opacity="0.8",onMouseLeave:e=>e.target.style.opacity="1",children:"Buy"})]},e.id)})}):Se.jsxs("div",{className:"badges-collapsed",style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[ht.getAllBadgeDefinitions().filter(e=>k.some(t=>t.id===e.id)).map(e=>Se.jsx("span",{className:"badge-icon earned",style:{fontSize:"16px",padding:"4px",borderRadius:"4px",background:`${e.color}20`,color:e.color,border:`1px solid ${e.borderColor}`,cursor:"pointer"},title:`${e.name}: ${e.description} \u2713 Earned`,children:e.icon},e.id)),0===k.length&&Se.jsx("span",{style:{fontSize:"12px",color:"#888",fontStyle:"italic"},children:"No badges earned yet"})]})]}),Se.jsx("div",{className:"wallet-settings",children:Se.jsx("div",{className:"settings-menu",children:Se.jsxs("div",{className:"settings-section",children:[Se.jsxs("div",{className:"settings-header",onClick:()=>T(!A),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0"},children:[Se.jsx("h4",{children:"Display Options"}),Se.jsx("span",{style:{fontSize:"12px",color:"#888"},children:A?"\u25bc":"\u25b6"})]}),A?Se.jsxs("div",{className:"filter-options",children:[Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.showOtherCollections,onChange:e=>b("showOtherCollections",e.target.checked)}),Se.jsx("span",{children:"Show other collections"})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.showWhitelistedOnly,onChange:e=>b("showWhitelistedOnly",e.target.checked)}),Se.jsx("span",{children:"Displays only whitelisted collections in overviews"})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.enableAnimatedNFTs,onChange:e=>b("enableAnimatedNFTs",e.target.checked)}),Se.jsx("span",{children:"Enables animated NFTs to play in overviews"})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.showExplicitContent,onChange:e=>b("showExplicitContent",e.target.checked)}),Se.jsx("span",{children:"Enables explicit content to be shown in overviews"})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.showChatButton,onChange:e=>b("showChatButton",e.target.checked)}),Se.jsx("span",{children:"Show chat button"})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.blockNSFW,onChange:e=>b("blockNSFW",e.target.checked)}),Se.jsx("span",{children:"Blocks NSFW collections from the platform"})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.blockAI,onChange:e=>b("blockAI",e.target.checked)}),Se.jsx("span",{children:"Blocks AI collections from the platform"})]}),Se.jsxs("div",{className:"theme-toggle-option",children:[Se.jsx("span",{children:"Dark Mode"}),Se.jsx("button",{className:"theme-toggle "+(v?"active":""),onClick:M,children:Se.jsxs("div",{className:"toggle-slider",children:[Se.jsxs("svg",{className:"sun-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"5"}),Se.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),Se.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),Se.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),Se.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),Se.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),Se.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),Se.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),Se.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),Se.jsx("svg",{className:"moon-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})]})})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.showPricesInUSD,onChange:e=>b("showPricesInUSD",e.target.checked)}),Se.jsx("span",{children:"Show Prices in USD"})]}),Se.jsxs("div",{className:"currency-selection",children:[Se.jsx("label",{children:"Currency Comparison:"}),Se.jsxs("select",{value:j.selectedCurrency,onChange:e=>b("selectedCurrency",e.target.value),className:"currency-select",children:[Se.jsx("option",{value:"USD",children:"USD - US Dollar"}),Se.jsx("option",{value:"EUR",children:"EUR - Euro"}),Se.jsx("option",{value:"DKK",children:"DKK - Danish Krone"}),Se.jsx("option",{value:"AED",children:"AED - UAE Dirham"}),Se.jsx("option",{value:"INR",children:"INR - Indian Rupee"}),Se.jsx("option",{value:"RUB",children:"RUB - Russian Ruble"}),Se.jsx("option",{value:"CNY",children:"CNY - Chinese Yuan"}),Se.jsx("option",{value:"JPY",children:"JPY - Japanese Yen"}),Se.jsx("option",{value:"BTC",children:"BTC - Bitcoin"}),Se.jsx("option",{value:"ETH",children:"ETH - Ethereum"})]})]}),Se.jsxs("label",{className:"filter-option",children:[Se.jsx("input",{type:"checkbox",checked:j.showRarityRankings,onChange:e=>b("showRarityRankings",e.target.checked)}),Se.jsx("span",{children:"Show Rarity Rankings"})]})]}):Se.jsxs("div",{className:"theme-toggle-option",style:{marginTop:"8px"},children:[Se.jsx("span",{children:"Dark Mode"}),Se.jsx("button",{className:"theme-toggle "+(v?"active":""),onClick:M,children:Se.jsxs("div",{className:"toggle-slider",children:[Se.jsxs("svg",{className:"sun-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"5"}),Se.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),Se.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),Se.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),Se.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),Se.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),Se.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),Se.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),Se.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),Se.jsx("svg",{className:"moon-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})]})})]})]})})}),Se.jsxs("button",{className:"logout-btn",onClick:n,role:"menuitem","aria-label":"Logout from wallet",children:[Se.jsx("span",{className:"logout-icon","aria-hidden":"true",children:"\ud83d\udeaa"}),"Logout"]})]})]}),Se.jsx("button",{onClick:R,className:"mobile-menu-btn "+(r?"active":""),"aria-label":r?"Close Menu":"Open Menu","aria-expanded":r,"aria-controls":"mobile-menu",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),R(),vt.announceToScreenReader(r?"Mobile menu closed":"Mobile menu opened"))},children:Se.jsxs("div",{className:"hamburger","aria-hidden":"true",children:[Se.jsx("span",{}),Se.jsx("span",{}),Se.jsx("span",{})]})})]})]})}),Se.jsxs("div",{className:"mobile-menu "+(r?"open":""),id:"mobile-menu",role:"navigation","aria-expanded":r,"aria-label":"Mobile navigation menu",onKeyDown:e=>{"Escape"===e.key&&(W(),vt.announceToScreenReader("Mobile menu closed"))},children:[Se.jsxs("nav",{className:"mobile-nav-links",role:"navigation","aria-label":"Mobile menu links",children:[Se.jsxs("div",{className:"mobile-nav-section",children:[Se.jsx("h3",{className:"mobile-nav-section-title",children:"Main"}),Se.jsxs("div",{className:"mobile-nav-grid",children:[Se.jsx(U,{to:"/",onClick:W,className:"mobile-nav-link "+("marketplace"===e||""===e?"active":""),children:"Marketplace"}),Se.jsx(U,{to:"/rwax",onClick:W,className:"mobile-nav-link "+("rwax"===e?"active":""),children:"RWAX"}),Se.jsx(U,{to:"/collections",onClick:W,className:"mobile-nav-link "+("collections"===e?"active":""),children:"Collections"}),Se.jsx(U,{to:"/learn",onClick:W,className:"mobile-nav-link "+("learn"===e?"active":""),children:"Learn"}),Se.jsx(U,{to:"/rewards",onClick:W,className:"mobile-nav-link "+("rewards"===e?"active":""),children:"Rewards"})]})]}),Se.jsxs("div",{className:"mobile-nav-section",children:[Se.jsx("h3",{className:"mobile-nav-section-title",children:"Trading & Tools"}),Se.jsxs("div",{className:"mobile-nav-grid",children:[Se.jsx(U,{to:"/auctions",onClick:W,className:"mobile-nav-link "+("auctions"===e?"active":""),children:"Auctions"}),Se.jsx(U,{to:"/activity",onClick:W,className:"mobile-nav-link "+("activity"===e?"active":""),children:"Activity"}),Se.jsx(U,{to:"/pxcrafting",onClick:W,className:"mobile-nav-link "+("pxcrafting"===e?"active":""),children:"PxCraft"}),Se.jsx(U,{to:"/pxswap",onClick:W,className:"mobile-nav-link "+("pxswap"===e?"active":""),children:"PxSwap"}),Se.jsx(U,{to:"/journeymap",onClick:W,className:"mobile-nav-link "+("journeymap"===e?"active":""),children:"JourneyMap"}),Se.jsx(U,{to:"/staking",onClick:W,className:"mobile-nav-link "+("pxstaking"===e?"active":""),children:"PxStaking"})]})]}),Se.jsxs("div",{className:"mobile-nav-section",children:[Se.jsx("h3",{className:"mobile-nav-section-title",children:"Community"}),Se.jsxs("div",{className:"mobile-social-section",children:[Se.jsxs("a",{href:"http://discord.gg/pixel-journey-1130670500776005734",target:"_blank",rel:"noopener noreferrer",className:"mobile-social-link",onClick:W,children:[Se.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})}),"Discord"]}),Se.jsxs("a",{href:"https://x.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"mobile-social-link",onClick:W,children:[Se.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X (Twitter)"]})]})]})]}),Se.jsxs("div",{className:"mobile-menu-actions",children:[t&&d>0&&Se.jsxs("button",{onClick:()=>{m(!0),W()},className:"mobile-cart-btn","aria-label":`Open Shopping Cart (${d} items)`,children:[Se.jsxs("svg",{className:"cart-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[Se.jsx("circle",{cx:"9",cy:"21",r:"1"}),Se.jsx("circle",{cx:"20",cy:"21",r:"1"}),Se.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),"Shopping Cart (",d,")"]}),t&&Se.jsxs(Se.Fragment,{children:[Se.jsxs(U,{to:"/inventory",onClick:W,className:"mobile-inventory-btn",children:[Se.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"My Inventory"]}),Se.jsxs(U,{to:"/profile",onClick:W,className:"mobile-inventory-btn",children:[Se.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"My Profile"]}),Se.jsxs(U,{to:"/watchlist",onClick:W,className:"mobile-inventory-btn",children:[Se.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),"My Watchlist"]})]}),Se.jsx("div",{className:"mobile-auth-section",children:t?Se.jsxs("button",{onClick:()=>{n(),W(),vt.announceToScreenReader("Logged out successfully")},className:"mobile-auth-btn logout-btn",children:[Se.jsx("svg",{className:"auth-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]}):Se.jsxs("button",{onClick:()=>{s(),W(),vt.announceToScreenReader("Login initiated")},className:"mobile-auth-btn login-btn",children:[Se.jsx("svg",{className:"auth-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Login"]})})]})]}),r&&Se.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[998]",onClick:W}),Se.jsx(gt,{isOpen:h,onClose:()=>m(!1)}),Se.jsx(yt,{isOpen:x,onClose:()=>g(!1)})]})},bt=()=>Se.jsxs("div",{className:"landing-page",children:[Se.jsx("div",{className:"hero-section",children:Se.jsxs("div",{className:"hero-content",children:[Se.jsxs("h1",{className:"hero-title",children:["Welcome to ",Se.jsx("span",{className:"brand-highlight",children:"PxMarket"})]}),Se.jsx("p",{className:"hero-subtitle",children:"by Pixel Journey"}),Se.jsx("p",{className:"hero-description",children:"Discover, trade, and collect unique digital assets in the ultimate NFT marketplace experience."})]})}),Se.jsx("div",{className:"cta-section",children:Se.jsxs("div",{className:"cta-container",children:[Se.jsxs("div",{className:"cta-card marketplace-card",children:[Se.jsx("div",{className:"cta-icon",children:"\ud83c\udfea"}),Se.jsx("h2",{className:"cta-title",children:"Explore Marketplace"}),Se.jsx("p",{className:"cta-description",children:"Browse thousands of unique NFTs, discover rare collectibles, and find your next digital (pixel?!) treasure."}),Se.jsx(U,{to:"/marketplace",className:"cta-button primary",children:"Enter Marketplace"})]}),Se.jsxs("div",{className:"cta-card rwax-card",children:[Se.jsx("div",{className:"cta-icon",children:"\ud83c\udfad"}),Se.jsx("h2",{className:"cta-title",children:"Get Your Pixal PFP via R-WAX"}),Se.jsx("p",{className:"cta-description",children:"Pick up your unique pixel-perfect Pixal Profile Picture using WPIXAL on the R-WAX Markets and join the Pixel Journey community!"}),Se.jsx(U,{to:"/rwax",className:"cta-button secondary",children:"Browse RWAX Pixals"})]})]})}),Se.jsx("div",{className:"features-section",children:Se.jsxs("div",{className:"features-container",children:[Se.jsxs("div",{className:"feature-item",children:[Se.jsx("div",{className:"feature-icon",children:"\u26a1"}),Se.jsx("h3",{children:"Lightning Fast"}),Se.jsx("p",{children:"Instant transactions on the WAX blockchain"})]}),Se.jsxs("div",{className:"feature-item",children:[Se.jsx("div",{className:"feature-icon",children:"\ud83d\udd12"}),Se.jsx("h3",{children:"Secure Trading"}),Se.jsx("p",{children:"Safe and transparent blockchain transactions"})]}),Se.jsxs("div",{className:"feature-item",children:[Se.jsx("div",{className:"feature-icon",children:"\ud83c\udf1f"}),Se.jsx("h3",{children:"Premium Quality"}),Se.jsx("p",{children:"Curated collection of high-quality digital assets"})]})]})})]});const Nt=new class{constructor(){M(this,"serviceWorkerRegistration",null),M(this,"pushSubscription",null),M(this,"vapidPublicKey",""),M(this,"isInitialized",!1),M(this,"permissionState",{permission:"default",supported:!1,serviceWorkerReady:!1,subscribed:!1}),this.checkSupport()}checkSupport(){this.permissionState.supported="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,this.permissionState.supported&&(this.permissionState.permission=Notification.permission)}async initialize(){if(this.isInitialized)return!0;try{return this.permissionState.supported?(await this.registerServiceWorker(),await this.checkExistingSubscription(),this.isInitialized=!0,st.trackEvent("push_notification_service_initialized",{supported:this.permissionState.supported,permission:this.permissionState.permission,subscribed:this.permissionState.subscribed}),!0):(De.warn("Push notifications not supported in this browser"),!1)}catch(e){return De.error("Failed to initialize push notification service","PushNotificationService.initialize",e),st.reportError(e,"push_notification_init_error"),!1}}async registerServiceWorker(){try{const e="localhost"===location.hostname||"127.0.0.1"===location.hostname||"http:"===location.protocol?"/sw-dev.js":"/sw.js";this.serviceWorkerRegistration=await navigator.serviceWorker.register(e,{scope:"/"}),await navigator.serviceWorker.ready,this.permissionState.serviceWorkerReady=!0,De.info(`Service Worker registered successfully: ${e}`),navigator.serviceWorker.addEventListener("message",this.handleServiceWorkerMessage.bind(this))}catch(e){throw De.error("Failed to register service worker","PushNotificationService.registerServiceWorker",e),e}}handleServiceWorkerMessage(e){const{type:t,data:a}=e.data||{};switch(t){case"NOTIFICATION_CLICKED":st.trackEvent("notification_clicked",a);break;case"NOTIFICATION_CLOSED":st.trackEvent("notification_closed",a);break;default:De.debug("Unknown service worker message:",t)}}async checkExistingSubscription(){if(this.serviceWorkerRegistration)try{this.pushSubscription=await this.serviceWorkerRegistration.pushManager.getSubscription(),this.permissionState.subscribed=!!this.pushSubscription,this.pushSubscription&&(De.info("Existing push subscription found"),await this.validateSubscription())}catch(e){De.error("Failed to check existing subscription","PushNotificationService.checkExistingSubscription",e)}}async requestPermission(){if(!this.permissionState.supported)throw new Error("Push notifications not supported");try{const e=await Notification.requestPermission();return this.permissionState.permission=e,st.trackEvent("notification_permission_requested",{permission:e,previousPermission:this.permissionState.permission}),e}catch(e){throw Le.logError("PushNotificationService.requestPermission",e),st.reportError(e,"notification_permission_error"),e}}async subscribe(e){if(this.isInitialized||await this.initialize(),!this.serviceWorkerRegistration)throw new Error("Service worker not registered");if("granted"!==this.permissionState.permission){if("granted"!==await this.requestPermission())throw new Error("Notification permission denied")}try{this.pushSubscription&&await this.unsubscribe();const t={userVisibleOnly:!0,applicationServerKey:this.vapidPublicKey?this.urlBase64ToUint8Array(this.vapidPublicKey):void 0};this.pushSubscription=await this.serviceWorkerRegistration.pushManager.subscribe(t),this.permissionState.subscribed=!0;const a={endpoint:this.pushSubscription.endpoint,keys:{p256dh:this.arrayBufferToBase64(this.pushSubscription.getKey("p256dh")),auth:this.arrayBufferToBase64(this.pushSubscription.getKey("auth"))},userId:e,subscriptionTime:Date.now()};return localStorage.setItem("push_subscription",JSON.stringify(a)),await this.sendSubscriptionToServer(a),st.trackEvent("push_notification_subscribed",{userId:e,endpoint:this.pushSubscription.endpoint}),De.info("Push notification subscription successful"),this.pushSubscription}catch(t){throw De.error("Failed to subscribe to push notifications","PushNotificationService.subscribe",t),st.reportError(t,"push_subscription_error",{userId:e}),t}}async unsubscribe(){if(!this.pushSubscription)return!0;try{const e=await this.pushSubscription.unsubscribe();return e&&(this.pushSubscription=null,this.permissionState.subscribed=!1,localStorage.removeItem("push_subscription"),await this.removeSubscriptionFromServer(),st.trackEvent("push_notification_unsubscribed"),De.info("Push notification unsubscribed successfully")),e}catch(e){return Le.logError("PushNotificationService.unsubscribe",e),st.reportError(e,"push_unsubscription_error"),!1}}async showLocalNotification(e){if(!this.permissionState.supported||"granted"!==this.permissionState.permission)throw new Error("Notifications not available");try{const t={body:e.body,icon:e.icon||"/logo.png",badge:e.badge||"/logo.png",tag:e.tag,data:e.data,requireInteraction:e.requireInteraction||!1,silent:e.silent||!1},a=new Notification(e.title,t);a.onclick=()=>{st.trackEvent("local_notification_clicked",{tag:e.tag,title:e.title}),a.close()},a.onclose=()=>{st.trackEvent("local_notification_closed",{tag:e.tag,title:e.title})},st.trackEvent("local_notification_shown",{tag:e.tag,title:e.title})}catch(t){throw De.error("Failed to show local notification","PushNotificationService.showLocalNotification",t),st.reportError(t,"local_notification_error",{title:e.title}),t}}urlBase64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(t),s=new Uint8Array(a.length);for(let n=0;n<a.length;++n)s[n]=a.charCodeAt(n);return s}arrayBufferToBase64(e){const t=new Uint8Array(e);let a="";for(let s=0;s<t.byteLength;s++)a+=String.fromCharCode(t[s]);return window.btoa(a)}getAuthToken(){return localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")||""}getNotificationPreferences(){const e=localStorage.getItem("notification_preferences");if(e)try{return JSON.parse(e)}catch(t){De.warn("Failed to parse notification preferences:","pushNotificationService.getNotificationPreferences",t)}return{priceAlerts:!0,auctionUpdates:!0,newListings:!1,marketTrends:!1,systemNotifications:!0}}async validateSubscription(){if(!this.pushSubscription)return!1;try{const e={endpoint:this.pushSubscription.endpoint,keys:{p256dh:this.arrayBufferToBase64(this.pushSubscription.getKey("p256dh")),auth:this.arrayBufferToBase64(this.pushSubscription.getKey("auth"))}},t=await fetch("/api/push/validate-subscription",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({subscription:e})});if(!t.ok)throw new Error(`Validation failed: ${t.status} ${t.statusText}`);return!0===(await t.json()).valid}catch(e){return De.warn("Subscription validation failed:","pushNotificationService.validateSubscription",e),!1}}async sendSubscriptionToServer(e){try{const t=await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({...e,userAgent:navigator.userAgent,timestamp:Date.now(),preferences:this.getNotificationPreferences()})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(`Failed to save subscription: ${t.status} ${t.statusText} - ${e.message||"Unknown error"}`)}const a=await t.json();De.info("Subscription successfully saved to server:",a.subscriptionId),localStorage.setItem("push_subscription_id",a.subscriptionId)}catch(t){throw De.error("Failed to send subscription to server:","pushNotificationService.sendSubscriptionToServer",t,{endpoint:e.endpoint,userId:e.userId}),t}}async removeSubscriptionFromServer(){try{const e=localStorage.getItem("push_subscription_id"),t=localStorage.getItem("push_subscription");if(!e&&!t)return void De.info("No subscription to remove from server");const a=await fetch("/api/push/unsubscribe",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({subscriptionId:e,endpoint:this.pushSubscription?.endpoint,timestamp:Date.now()})});if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(`Failed to remove subscription: ${a.status} ${a.statusText} - ${e.message||"Unknown error"}`)}localStorage.removeItem("push_subscription_id"),De.info("Subscription successfully removed from server")}catch(e){De.error("Failed to remove subscription from server:","pushNotificationService.removeSubscriptionFromServer",e)}}getPermissionState(){return{...this.permissionState}}isSubscribed(){return this.permissionState.subscribed}getSubscription(){return this.pushSubscription}setVapidKey(e){this.vapidPublicKey=e}async testNotification(){await this.showLocalNotification({title:"PxMarket Test Notification",body:"Push notifications are working correctly!",tag:"test-notification",data:{test:!0}})}async sendPriceAlert(e,t,a){await this.showLocalNotification({title:"Price Alert",body:`${e} is now ${t} (target: ${a})`,tag:"price-alert",icon:"/logo.png",requireInteraction:!0,data:{type:"price_alert",assetName:e,currentPrice:t,targetPrice:a}})}async sendTransactionNotification(e,t,a){await this.showLocalNotification({title:"success"===e?"Transaction Successful":"Transaction Failed",body:t,tag:`transaction-${e}`,icon:"/logo.png",data:{type:"transaction",status:e,transactionId:a}})}};const wt=new class{constructor(){M(this,"watchlist",[]),M(this,"priceAlerts",{}),M(this,"notifications",{browser:!0,email:!1,sound:!0}),M(this,"listeners",[]),M(this,"priceCheckInterval",null),M(this,"STORAGE_KEY","pixeljourney_watchlist"),M(this,"ALERTS_KEY","pixeljourney_price_alerts"),M(this,"NOTIFICATIONS_KEY","pixeljourney_notifications"),M(this,"priceCache",{}),M(this,"CACHE_DURATION",12e4),M(this,"endpointFailures",{}),M(this,"MAX_FAILURES",3),M(this,"FAILURE_WINDOW",3e5),M(this,"DISABLE_DURATION",9e5),this.loadFromStorage(),this.startPriceMonitoring(),this.requestNotificationPermission()}loadFromStorage(){try{this.watchlist=Qe.getJSON(this.STORAGE_KEY,[]),this.priceAlerts=Qe.getJSON(this.ALERTS_KEY,{}),this.notifications=Qe.getJSON(this.NOTIFICATIONS_KEY,{browser:!0,email:!1,sound:!0})}catch(e){Le.logError("WatchlistService.loadFromStorage",e,{storageKeys:[this.STORAGE_KEY,this.ALERTS_KEY,this.NOTIFICATIONS_KEY]})}}saveToStorage(){try{Qe.setJSON(this.STORAGE_KEY,this.watchlist)&&Qe.setJSON(this.ALERTS_KEY,this.priceAlerts)&&Qe.setJSON(this.NOTIFICATIONS_KEY,this.notifications)||Le.logError("WatchlistService.saveToStorage",new Error("Failed to save to storage"),{watchlistSize:this.watchlist.length,alertsCount:Object.keys(this.priceAlerts).length}),this.notifyListeners()}catch(e){Le.logError("WatchlistService.saveToStorage",e,{watchlistSize:this.watchlist.length,alertsCount:Object.keys(this.priceAlerts).length})}}async requestNotificationPermission(){"Notification"in window&&"default"===Notification.permission&&await Notification.requestPermission()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.listeners.forEach(e=>e([...this.watchlist]))}async addToWatchlist(e){if(-1!==this.watchlist.findIndex(t=>t.nft.asset_id===e.asset_id))return!1;const t={nft:e,alertType:"any",addedAt:Date.now(),lastPrice:e.price?parseFloat(e.price):0};return this.watchlist.push(t),this.saveToStorage(),this.notifyListeners(),!0}async removeFromWatchlist(e){this.watchlist=this.watchlist.filter(t=>t.nft.asset_id!==e),delete this.priceAlerts[e],this.saveToStorage(),this.notifyListeners()}async getWatchlist(){return[...this.watchlist]}isInWatchlist(e){return this.watchlist.some(t=>t.nft.asset_id===e)}async setPriceAlert(e,t){this.priceAlerts[e]={...t,lastTriggered:void 0},this.saveToStorage()}async removePriceAlert(e){delete this.priceAlerts[e],this.saveToStorage()}getPriceAlert(e){return this.priceAlerts[e]}updateNotificationSettings(e){this.notifications={...this.notifications,...e},this.saveToStorage()}getNotificationSettings(){return{...this.notifications}}isEndpointDisabled(e){const t=this.endpointFailures[e];return!(!t||!t.disabled)&&(!(Date.now()-t.lastFailure>this.DISABLE_DURATION)||(t.disabled=!1,t.count=0,!1))}recordEndpointFailure(e){const t=Date.now(),a=this.endpointFailures[e]||{count:0,lastFailure:0,disabled:!1};t-a.lastFailure>this.FAILURE_WINDOW&&(a.count=0),a.count++,a.lastFailure=t,a.count>=this.MAX_FAILURES&&(a.disabled=!0,De.warn(`Endpoint ${e} disabled due to ${a.count} failures`,"WatchlistService.recordEndpointFailure")),this.endpointFailures[e]=a}recordEndpointSuccess(e){const t=this.endpointFailures[e];t&&(t.count=0,t.disabled=!1)}notifyEndpointsDisabled(){const e=localStorage.getItem("watchlist_endpoints_disabled_notification"),t=Date.now();e&&t-parseInt(e)<9e5||(localStorage.setItem("watchlist_endpoints_disabled_notification",t.toString()),window.dispatchEvent(new CustomEvent("watchlistEndpointsDisabled",{detail:{message:"Price monitoring temporarily disabled due to API issues. Will retry automatically.",disabledEndpoints:Object.keys(this.endpointFailures).filter(e=>this.endpointFailures[e].disabled),retryTime:Math.max(...Object.values(this.endpointFailures).map(e=>e.lastFailure+this.DISABLE_DURATION))}})))}getEndpointStatus(){const e={};for(const[t,a]of Object.entries(this.endpointFailures))e[t]={healthy:!a.disabled,failures:a.count,disabledUntil:a.disabled?a.lastFailure+this.DISABLE_DURATION:void 0};return e}startPriceMonitoring(){this.priceCheckInterval=setInterval(()=>{this.checkPriceAlerts()},18e4),setTimeout(()=>{this.checkPriceAlerts()},6e4)}stopPriceMonitoring(){this.priceCheckInterval&&(clearInterval(this.priceCheckInterval),this.priceCheckInterval=null)}async checkPriceAlerts(){if(0===this.watchlist.length)return;if(["atomichub","neftyblocks"].every(e=>this.isEndpointDisabled(e)))return De.warn("All price endpoints are disabled, skipping price check","WatchlistService.checkPrices"),void this.notifyEndpointsDisabled();try{const e=Object.values(this.endpointFailures).filter(e=>e.disabled).length,t=e>0?2:3,a=[];for(let s=0;s<this.watchlist.length;s+=t)a.push(this.watchlist.slice(s,s+t));for(let s=0;s<a.length;s++){const t=a[s];s>0&&await new Promise(e=>setTimeout(e,2e3));const n=t.map(async e=>{try{const t=await this.fetchCurrentPrice(e),a=e.lastPrice>0?(t-e.lastPrice)/e.lastPrice*100:0;e.lastPrice=t,e.priceChange=a;const s=this.priceAlerts[e.nft.asset_id];return s&&s.enabled&&t>0&&await this.checkAlertCondition(e,s,t),e}catch(t){return Le.logError("WatchlistService.checkPriceAlerts.priceCheck",t,{assetId:e.nft.asset_id,nftName:e.nft.name}),e}});if(await Promise.allSettled(n),a.indexOf(t)<a.length-1){const t=e>0?2e3:1e3;await new Promise(e=>setTimeout(e,t))}}this.saveToStorage()}catch(e){Le.logError("WatchlistService.checkPriceAlerts",e,{watchlistSize:this.watchlist.length,disabledEndpoints:Object.keys(this.endpointFailures).filter(e=>this.endpointFailures[e].disabled)})}}async fetchCurrentPrice(e){const t=e.nft.asset_id,a=Date.now(),s=this.priceCache[t];if(s&&a-s.timestamp<this.CACHE_DURATION)return s.price;const n=await this.getCurrentPrice(t);return this.priceCache[t]={price:n,timestamp:a},n}async getCurrentPrice(e){try{const a=["atomichub","neftyblocks"];for(const s of a)if(!this.isEndpointDisabled(s))try{let t=0;switch(s){case"atomichub":t=await this.fetchAtomicHubPrice(e);break;case"neftyblocks":t=await this.fetchNeftyBlocksPrice(e)}if(t>0)return this.recordEndpointSuccess(s),t}catch(t){this.recordEndpointFailure(s),De.warn(`Failed to fetch price from ${s}:`,"WatchlistService.getCurrentPrice",{endpoint:s,error:t})}return De.warn("All price endpoints failed, using template floor price fallback","WatchlistService.getCurrentPrice"),await this.fetchTemplateFloorPrice(e)}catch(t){Le.logError("WatchlistService.getCurrentPrice",t,{assetId:e});const a=this.watchlist.find(t=>t.nft.asset_id===e);return a?.lastPrice||0}}async fetchAtomicHubPrice(e){const t="atomichub";try{const{apiService:a}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),s=`${a.atomicMarketAPI}/atomicmarket/v1/sales?state=1&asset_id=${e}&limit=1`,n=await a.fetchWithRetry(s),i=await n.json();if(i.success&&i.data&&i.data.length>0){const e=i.data[0];if(e.price&&e.price.amount)return this.recordEndpointSuccess(t),parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}return 0}catch(a){return this.recordEndpointFailure(t),Le.logError("WatchlistService.fetchAtomicHubPrice",a,{assetId:e,endpoint:t,failureCount:this.endpointFailures[t]?.count||0}),0}}async fetchNeftyBlocksPrice(e){const t="neftyblocks";try{const{apiService:a}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),s=`https://aa-wax-public1.neftyblocks.com/atomicmarket/v1/sales?state=1&asset_id=${e}&limit=1`,n=await a.fetchWithRetry(s),i=await n.json();if(i.success&&i.data&&i.data.length>0){const e=i.data[0];if(e.price&&e.price.amount)return this.recordEndpointSuccess(t),parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}return 0}catch(a){return this.recordEndpointFailure(t),Le.logError("WatchlistService.fetchNeftyBlocksPrice",a,{assetId:e,endpoint:t,failureCount:this.endpointFailures[t]?.count||0}),0}}async fetchTemplateFloorPrice(e){try{const{apiService:t}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),a=`${t.atomicAssetsAPI}/atomicassets/v1/assets/${e}`,s=await t.fetchWithRetry(a),n=await s.json();if(n.success&&n.data&&n.data.template){const e=n.data.template.template_id,a=`${t.atomicMarketAPI}/atomicmarket/v1/sales?state=1&template_id=${e}&sort=price&order=asc&limit=1`,s=await t.fetchWithRetry(a),i=await s.json();if(i.success&&i.data&&i.data.length>0){const e=i.data[0];if(e.price&&e.price.amount)return parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}}return 0}catch{return 0}}async checkAlertCondition(e,t,a){const s=Date.now();if(t.lastTriggered&&s-t.lastTriggered<36e5)return;let n=!1,i="";switch(t.alertType){case"below":a<=t.targetPrice&&(n=!0,i=`${e.nft.name} price dropped to ${a.toFixed(2)} WAX (target: ${t.targetPrice} WAX)`);break;case"above":a>=t.targetPrice&&(n=!0,i=`${e.nft.name} price rose to ${a.toFixed(2)} WAX (target: ${t.targetPrice} WAX)`);break;case"any":{const t=Math.abs(e.priceChange||0);if(t>=5){n=!0;const s=(e.priceChange||0)>0?"increased":"decreased";i=`${e.nft.name} price ${s} by ${t.toFixed(1)}% to ${a.toFixed(2)} WAX`}break}}n&&(await this.triggerAlert(e,i),t.lastTriggered=s)}async triggerAlert(e,t){this.notifications.browser&&"Notification"in window&&"granted"===Notification.permission&&new Notification("Price Alert - Pixel Journey",{body:t,icon:e.nft.image||"/logo.png",tag:`price-alert-${e.nft.asset_id}`,requireInteraction:!0}),this.notifications.sound&&this.playNotificationSound();try{await Nt.sendPriceAlert(e.nft.name,`${e.lastPrice} WAX`,t)}catch(a){De.warn("Failed to send push notification for price alert:","WatchlistService.sendPriceAlert",{error:a})}window.dispatchEvent(new CustomEvent("priceAlert",{detail:{item:e,message:t}}))}playNotificationSound(){try{const e=new Audio("/notification.mp3");e.volume=.3,e.play().catch(e=>{De.debug("Could not play notification sound:","WatchlistService.playNotificationSound",{error:e})})}catch(e){De.debug("Notification sound not available:","WatchlistService.playNotificationSound",{error:e})}}getWatchlistStats(){const e=this.watchlist.length,t=Object.keys(this.priceAlerts).filter(e=>this.priceAlerts[e].enabled).length,a=this.watchlist.map(e=>e.priceChange||0).filter(e=>0!==e);return{totalItems:e,activeAlerts:t,averagePriceChange:a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0}}clearWatchlist(){this.watchlist=[],this.priceAlerts={},this.saveToStorage()}subscribe(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}exportWatchlist(){return JSON.stringify({watchlist:this.watchlist,priceAlerts:this.priceAlerts,exportedAt:Date.now()},null,2)}importWatchlist(e){try{const t=JSON.parse(e);return!(!t.watchlist||!Array.isArray(t.watchlist))&&(this.watchlist=t.watchlist,this.priceAlerts=t.priceAlerts||{},this.saveToStorage(),!0)}catch(t){return Le.logError("WatchlistService.importWatchlist",t,{dataLength:e.length}),!1}}};var kt,_t;(_t=kt||(kt={}))[_t.CEILING=0]="CEILING",_t[_t.DOWN=1]="DOWN",_t[_t.FLOOR=2]="FLOOR",_t[_t.HALF_DOWN=3]="HALF_DOWN",_t[_t.HALF_EVEN=4]="HALF_EVEN",_t[_t.HALF_UP=5]="HALF_UP",_t[_t.UNNECESSARY=6]="UNNECESSARY",_t[_t.UP=7]="UP";var St=function(){function e(t){void 0===t&&(t="0"),this.value=e.validate(t)}return e.validate=function(e){if(e){if(e=e.toString(),isNaN(e))throw Error("Parameter is not a number: "+e);"+"==e[0]&&(e=e.substring(1))}else e="0";if(e.startsWith(".")?e="0"+e:e.startsWith("-.")&&(e="-0"+e.substr(1)),/e/i.test(e)){var t=e.split(/[eE]/),a=t[0],s=t[1],n="";"-"==(a=i(a))[0]&&(n="-",a=a.substring(1)),a.indexOf(".")>=0?(s=parseInt(s)+a.indexOf("."),a=a.replace(".","")):s=parseInt(s)+a.length,e=a.length<s?n+a+new Array(s-a.length+1).join("0"):a.length>=s&&s>0?n+i(a.substring(0,s))+(a.length>s?"."+a.substring(s):""):n+"0."+new Array(1-s).join("0")+a}return e},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t){this.value=e.validate(t)},e.getPrettyValue=function(t,a,s){void 0===a&&(a=3),void 0===s&&(s=",");var n="-"==(t=e.validate(t)).charAt(0);n&&(t=t.substring(1));for(var i=t.indexOf("."),r="",l=i=i>0?i:t.length;l>0;)l<a?(a=l,l=0):l-=a,r=t.substring(l,l+a)+(l<i-a&&l>=0?s:"")+r;return(n?"-":"")+r+t.substring(i)},e.prototype.getPrettyValue=function(t,a){return void 0===t&&(t=3),void 0===a&&(a=","),e.getPrettyValue(this.value,t,a)},e.round=function(t,a,s){if(void 0===a&&(a=0),void 0===s&&(s=kt.HALF_EVEN),t=e.validate(t),isNaN(a))throw Error("Precision is not a number: "+a);return d(t,a,s)},e.prototype.round=function(t,a){if(void 0===t&&(t=0),void 0===a&&(a=kt.HALF_EVEN),isNaN(t))throw Error("Precision is not a number: "+t);return new e(d(this.value,t,a))},e.abs=function(t){return c(t=e.validate(t))},e.prototype.abs=function(){return new e(c(this.value))},e.floor=function(t){return-1===(t=e.validate(t)).indexOf(".")?t:e.round(t,0,kt.FLOOR)},e.prototype.floor=function(){return-1===this.value.indexOf(".")?new e(this.value):new e(this.value).round(0,kt.FLOOR)},e.ceil=function(t){return-1===(t=e.validate(t)).indexOf(".")?t:e.round(t,0,kt.CEILING)},e.prototype.ceil=function(){return-1===this.value.indexOf(".")?new e(this.value):new e(this.value).round(0,kt.CEILING)},e.add=function(t,a){return s(t=e.validate(t),a=e.validate(a))},e.prototype.add=function(t){return new e(s(this.value,t.getValue()))},e.subtract=function(t,a){return x(t=e.validate(t),a=e.validate(a))},e.prototype.subtract=function(t){return new e(x(this.value,t.getValue()))},e.multiply=function(t,a){return p(t=e.validate(t),a=e.validate(a))},e.prototype.multiply=function(t){return new e(p(this.value,t.getValue()))},e.divide=function(t,a,s,n){return f(t=e.validate(t),a=e.validate(a),s,n)},e.prototype.divide=function(t,a,s){return new e(f(this.value,t.getValue(),a,s))},e.modulus=function(t,a){return v(t=e.validate(t),a=e.validate(a))},e.prototype.modulus=function(t){return new e(v(this.value,t.getValue()))},e.compareTo=function(t,a){return j(t=e.validate(t),a=e.validate(a))},e.prototype.compareTo=function(e){return j(this.value,e.getValue())},e.negate=function(t){return g(t=e.validate(t))},e.prototype.negate=function(){return new e(g(this.value))},e.stripTrailingZero=function(t){return m(t=e.validate(t))},e.prototype.stripTrailingZero=function(){return new e(m(this.value))},e.RoundingModes=kt,e}();class Ct extends ne{constructor(){super(...arguments),this.default_block_cpu_limit=oe.from(2e5),this.default_block_net_limit=oe.from(1048576e3)}get allocated(){return 1-Number(this.weight_ratio.dividing(this.target_weight_ratio))/100}get reserved(){return this.utilization.dividing(this.weight)}get symbol(){return this.min_price.symbol}utilization_increase(e){const t=N(e),a=N(this.weight),s=N(Math.pow(10,15));return ae.from(t.multiply(a).divide(s,15).ceil().getValue())}price_function(e){const{weight:t}=this;let a=this.min_price.value;const s=Number(this.exponent)-1;if(s<=0)return this.max_price.value;{const n=N(e).divide(N(t),18);a+=(this.max_price.value-this.min_price.value)*Math.pow(Number(n.getValue()),s)}return a}price_integral_delta(e,t){const a=ie.fromUnits(this.max_price.units.subtracting(this.min_price.units),this.symbol).value/this.exponent.value,s=Number(e.dividing(this.weight)),n=Number(t.dividing(this.weight));return this.min_price.value*n-this.min_price.value*s+a*Math.pow(n,this.exponent.value)-a*Math.pow(s,this.exponent.value)}fee(e,t){const{utilization:a,weight:s}=this;let n=re.from(a);const i=n.adding(e);let r=0;if(n.lt(t)){const a=Math.min(Number(e),Number(t.subtracting(n)));r+=Number(N(this.price_function(t)*a).divide(N(s)).getValue()),n=t}return n.lt(i)&&(r+=this.price_integral_delta(n,i)),r}determine_adjusted_utilization(e){const{decay_secs:t,utilization:a,utilization_timestamp:s}=this;let{adjusted_utilization:n}=this;if(a.lt(n)){const i=e&&e.timestamp?e.timestamp:new Date,r=ce.from(i).toMilliseconds()/1e3,l=n.subtracting(a).toNumber();let o=l*Math.exp(-(r-s.toMilliseconds())/Number(t));o=Math.min(Math.max(o,0),l),n=a.adding(o)}return n}}le([ne.field("uint8")],Ct.prototype,"version",void 0),le([ne.field("int64")],Ct.prototype,"weight",void 0),le([ne.field("int64")],Ct.prototype,"weight_ratio",void 0),le([ne.field("int64")],Ct.prototype,"assumed_stake_weight",void 0),le([ne.field("int64")],Ct.prototype,"initial_weight_ratio",void 0),le([ne.field("int64")],Ct.prototype,"target_weight_ratio",void 0),le([ne.field("time_point_sec")],Ct.prototype,"initial_timestamp",void 0),le([ne.field("time_point_sec")],Ct.prototype,"target_timestamp",void 0),le([ne.field("float64")],Ct.prototype,"exponent",void 0),le([ne.field("uint32")],Ct.prototype,"decay_secs",void 0),le([ne.field("asset")],Ct.prototype,"min_price",void 0),le([ne.field("asset")],Ct.prototype,"max_price",void 0),le([ne.field("int64")],Ct.prototype,"utilization",void 0),le([ne.field("int64")],Ct.prototype,"adjusted_utilization",void 0),le([ne.field("time_point_sec")],Ct.prototype,"utilization_timestamp",void 0);let At=class extends Ct{constructor(){super(...arguments),this.per_day=e=>this.us_per_day(e),this.frac=(e,t)=>this.frac_by_us(e,t),this.frac_by_ms=(e,t)=>this.frac_by_us(e,1e3*t),this.price_per=(e,t=1e3,a)=>this.price_per_us(e,t,a),this.price_per_ms=(e,t=1,a)=>this.price_per_us(e,1e3*t,a)}ms_per_day(e){return this.us_per_day(e)/1e3}us_per_day(e){const t=e&&e.virtual_block_cpu_limit?e.virtual_block_cpu_limit:this.default_block_cpu_limit;return 2*Number(t)*60*60*24}weight_to_us(e,t){return ae.from(ae.from(t).multiplying(re.from(e)).dividing(Wt,"ceil"))}us_to_weight(e,t){return re.from(t).multiplying(Wt).dividing(e,"floor")}frac_by_us(e,t){const a=N(this.us_to_weight(e.cpu,t)),s=N(this.weight),n=N(Math.pow(10,15)),i=a.divide(s,15).multiply(n);return re.from(i.getValue())}price_per_us(e,t=1e3,a){const s=ae.from(this.frac(e,t)),n=this.utilization_increase(s),i=this.determine_adjusted_utilization(a),r=this.fee(n,i),l=Math.pow(10,this.max_price.symbol.precision),o=r*l,c=Math.ceil(o)/l,d=ie.fromFloat(r,this.symbol);if(o<1)throw new Error(`Price (${String(d)}) for requested CPU amount (${t}us) below required precision, increase requested amount.`);if(a&&a.min_payment&&a.min_payment.units.gt(d.units))throw new Error(`Price (${String(d)}) for requested CPU amount (${t}us) below minimum required payment (${String(a.min_payment)}), increase requested CPU amount.`);return c}};At=le([ne.type("powerupstateresourcecpu")],At);let Tt=class extends Ct{constructor(){super(...arguments),this.per_day=e=>this.bytes_per_day(e),this.frac=(e,t)=>this.frac_by_bytes(e,t),this.frac_by_kb=(e,t)=>this.frac_by_bytes(e,1e3*t),this.price_per=(e,t=1e3,a)=>this.price_per_byte(e,t,a),this.price_per_kb=(e,t=1,a)=>this.price_per_byte(e,1e3*t,a)}kb_per_day(e){return this.bytes_per_day(e)/1e3}bytes_per_day(e){const t=e&&e.virtual_block_net_limit?e.virtual_block_net_limit:this.default_block_net_limit;return 2*Number(t)*60*60*24}weight_to_bytes(e,t){return ae.from(ae.from(t).multiplying(re.from(e)).dividing(Wt,"ceil"))}bytes_to_weight(e,t){return re.from(t).multiplying(Wt).dividing(re.from(e),"floor")}frac_by_bytes(e,t){const a=N(this.bytes_to_weight(e.net,t)),s=N(this.weight),n=N(Math.pow(10,15)),i=a.divide(s,15).multiply(n);return re.from(i.getValue())}price_per_byte(e,t=1e3,a){const s=ae.from(this.frac(e,t)),n=this.utilization_increase(s),i=this.determine_adjusted_utilization(a),r=this.fee(n,i),l=Math.pow(10,this.max_price.symbol.precision);return Math.ceil(r*l)/l}};Tt=le([ne.type("powerupstateresourcenet")],Tt);let Pt=class extends ne{};le([ne.field("uint8")],Pt.prototype,"version",void 0),le([ne.field(Tt)],Pt.prototype,"net",void 0),le([ne.field(At)],Pt.prototype,"cpu",void 0),le([ne.field("uint32")],Pt.prototype,"powerup_days",void 0),le([ne.field("asset")],Pt.prototype,"min_powerup_fee",void 0),Pt=le([ne.type("powerupstate")],Pt);class Et{constructor(e){this.parent=e}async get_state(){return(await this.parent.api.v1.chain.get_table_rows({code:"eosio",scope:"",table:"powup.state",type:Pt})).rows[0]}}let It=class extends ne{};le([ne.field("asset")],It.prototype,"balance",void 0),le([ne.field("float64")],It.prototype,"weight",void 0),It=le([ne.type("connector")],It);let Ft=class extends ne{};le([ne.field("asset")],Ft.prototype,"supply",void 0),le([ne.field(It)],Ft.prototype,"base",void 0),le([ne.field(It)],Ft.prototype,"quote",void 0),Ft=le([ne.type("exchange_state")],Ft);let $t=class extends Ft{price_per(e){const t=this.base.balance.units,a=this.quote.balance.units;return ie.fromUnits(this.get_input(t,a,re.from(e)),this.quote.balance.symbol)}price_per_kb(e){return this.price_per(1e3*e)}get_input(e,t,a){return t.multiplying(a).dividing(e.subtracting(a),"ceil")}};$t=le([ne.type("ramstate")],$t);class Lt{constructor(e){this.parent=e}async get_state(){return(await this.parent.api.v1.chain.get_table_rows({code:"eosio",scope:"eosio",table:"rammarket",type:$t})).rows[0]}}let Mt=class extends ne{get reserved(){return Number(this.total_lent.units)/Number(this.total_lendable.units)}get symbol(){return this.total_lent.symbol}get precision(){return this.total_lent.symbol.precision}get value(){const e=N(this.total_lent.units),t=N(this.total_unlent.units),a=N(this.total_rex.units);return Number(e.add(t).divide(a,18).getValue())}exchange(e){const t=N(e.units),a=N(this.total_lendable.units),s=N(this.total_rex.units),n=t.multiply(a).divide(s,this.precision);return ie.fromUnits(Number(n.getValue()),this.symbol)}cpu_price_per_ms(e,t=1){return this.cpu_price_per_us(e,1e3*t)}cpu_price_per_us(e,t=1e3){return this.price_per(e,t,e.cpu)}net_price_per_kb(e,t=1){return this.net_price_per_byte(e,1e3*t)}net_price_per_byte(e,t=1e3){return this.price_per(e,t,e.net)}price_per(e,t=1e3,a=e.cpu){const s=ie.fromUnits(1e4,this.symbol),n=Number(s.units)/(this.total_rent.value/this.total_unlent.value)*(Number(a)/Wt);return Number(s.units)/n*t/Math.pow(10,this.precision)}};le([ne.field("uint8")],Mt.prototype,"version",void 0),le([ne.field("asset")],Mt.prototype,"total_lent",void 0),le([ne.field("asset")],Mt.prototype,"total_unlent",void 0),le([ne.field("asset")],Mt.prototype,"total_rent",void 0),le([ne.field("asset")],Mt.prototype,"total_lendable",void 0),le([ne.field("asset")],Mt.prototype,"total_rex",void 0),le([ne.field("asset")],Mt.prototype,"namebid_proceeds",void 0),le([ne.field("uint64")],Mt.prototype,"loan_num",void 0),Mt=le([ne.type("rexstate")],Mt);class Rt{constructor(e){this.parent=e}async get_state(){return(await this.parent.api.v1.chain.get_table_rows({code:"eosio",scope:"eosio",table:"rexpool",type:Mt})).rows[0]}}const Wt=new se(1e8);class Ot{constructor(e){if(this.sampleAccount="greymassfuel",this.symbol="4,EOS",this.v1={powerup:new Et(this),ram:new Lt(this),rex:new Rt(this)},e.sampleAccount&&(this.sampleAccount=e.sampleAccount),e.symbol&&(this.symbol=e.symbol),e.api)this.api=e.api;else{if(!e.url)throw new Error("Missing url or api client");this.api=new ee({provider:new te(e.url,e)})}}async getSampledUsage(){const e=await this.api.v1.chain.get_account(this.sampleAccount),t=ae.from(e.cpu_limit.max.value.mul(Wt)),a=ae.from(e.net_limit.max.value.mul(Wt)),s=ae.from(e.cpu_weight.value),n=ae.from(e.net_weight.value);return{account:e,cpu:b(t.value,s.value),net:b(a.value,n.value)}}}Ot.__className="Resources";let Dt=class extends ne{};le([ne.field(pe)],Dt.prototype,"payer",void 0),le([ne.field(pe)],Dt.prototype,"receiver",void 0),le([ne.field(fe)],Dt.prototype,"days",void 0),le([ne.field(re)],Dt.prototype,"net_frac",void 0),le([ne.field(re)],Dt.prototype,"cpu_frac",void 0),le([ne.field(ie)],Dt.prototype,"max_payment",void 0),Dt=le([ne.type("powerup")],Dt);let Ut=class extends ne{};le([ne.field(pe)],Ut.prototype,"payer",void 0),le([ne.field(pe)],Ut.prototype,"receiver",void 0),le([ne.field(fe)],Ut.prototype,"bytes",void 0),Ut=le([ne.type("buyrambytes")],Ut);var Bt,zt,Xt={en:{checking:"Checking transaction",fee:{title:"Accept Transaction Fee?",body:"Additional resources ({{resource}}) are required for your account to perform this transaction. Would you like to automatically purchase these resources from the network and proceed?",cost:"Cost of {{resource}}"},resolving:"Resolving transaction"},ko:{checking:"\uac70\ub798 \ud655\uc778",fee:{title:"\uac70\ub798 \uc218\uc218\ub8cc\ub97c \uc218\ub77d\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",body:"\uacc4\uc815\uc5d0\uc11c \uc774 \uac70\ub798\ub97c \uc218\ud589\ud558\ub824\uba74 \ucd94\uac00 \ub9ac\uc18c\uc2a4({{resource}})\uac00 \ud544\uc694\ud569\ub2c8\ub2e4. \ub124\ud2b8\uc6cc\ud06c\uc5d0\uc11c \uc774\ub7ec\ud55c \ub9ac\uc18c\uc2a4\ub97c \uc790\ub3d9\uc73c\ub85c \uad6c\ub9e4\ud558\uace0 \uacc4\uc18d \uc9c4\ud589\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",cost:"{{resource}}\uc758 \ube44\uc6a9"},resolving:"\ud2b8\ub79c\uc7ad\uc158 \ud574\uacb0"},"zh-Hans":{checking:"\u6b63\u5728\u68c0\u67e5\u4ea4\u6613",fee:{title:"\u63a5\u53d7\u4ea4\u6613\u8d39\u7528\uff1f",body:"\u60a8\u7684\u5e10\u6237\u9700\u8981\u5176\u4ed6\u8d44\u6e90 \uff08{{resource}}\uff09 \u624d\u80fd\u6267\u884c\u6b64\u4ea4\u6613\u3002\u662f\u5426\u8981\u81ea\u52a8\u4ece\u7f51\u7edc\u8d2d\u4e70\u8fd9\u4e9b\u8d44\u6e90\u5e76\u7ee7\u7eed\uff1f",cost:"{{resource}} \u7684\u6210\u672c"},resolving:"\u6b63\u5728\u89e3\u6790\u4ea4\u6613"},"zh-Hant":{checking:"\u6b63\u5728\u6aa2\u67e5\u4ea4\u6613",fee:{title:"\u63a5\u53d7\u4ea4\u6613\u8cbb\u7528\uff1f",body:"\u60a8\u7684\u5e33\u6236\u9700\u8981\u5176\u4ed6\u8cc7\u6e90 \uff08{{resource}}\uff09 \u624d\u80fd\u57f7\u884c\u6b64\u4ea4\u6613\u3002\u662f\u5426\u8981\u81ea\u52d5\u5f9e\u7db2\u8def\u8cfc\u8cb7\u9019\u4e9b\u8cc7\u6e90\u4e26\u7e7c\u7e8c\uff1f",cost:"{{resource}} \u7684\u6210\u672c"},resolving:"\u6b63\u5728\u89e3\u6790\u4ea4\u6613"}};(zt=Bt||(Bt={}))[zt.BuyRAM=0]="BuyRAM",zt[zt.PowerUp=1]="PowerUp";const Ht={aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906:{features:[Bt.BuyRAM,Bt.PowerUp],sampleAccount:"eosio.reserv",symbol:ie.Symbol.from("4,EOS")},"73e4385a2708e6d7048834fbc1079f2fabb17b3c125b146af438971e90716c4d":{features:[Bt.BuyRAM,Bt.PowerUp],sampleAccount:"eosio.reserv",symbol:ie.Symbol.from("4,EOS")},"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4":{features:[Bt.BuyRAM,Bt.PowerUp],sampleAccount:"boost.wax",symbol:ie.Symbol.from("8,WAX")}},qt=1.5;class Jt extends de{constructor(){super(...arguments),this.id="transact-plugin-autocorrect",this.translations=Xt,this.sample=null,this.price=null,this.resources=[],this.iterations=0}register(e){if(!e.ui)throw new Error("The TransactPluginAutoCorrect plugin requires a UI to be present.");e.addHook(ue.beforeSign,async(e,t)=>this.run(e,t))}async run(e,t){if(!t.ui)return{request:e};this.price=null,this.resources=[],this.iterations=0;const a=t.ui.getTranslate(this.id),s=t.ui.prompt({title:a("checking",{default:"Checking transaction"}),body:"",elements:[]}).catch(t=>{if(t)throw t;return{request:e}}),n=await t.client.v1.chain.get_account(t.permissionLevel.actor),i=this.correct(e,t,n),r=await Promise.race([s,i]);if(r===e&&!this.price)return{request:e};const l=Array.from(new Set(this.resources)).join("/");return t.ui.prompt({title:a("fee.title",{default:"Accept Transaction Fee?"}),body:a("fee.body",{default:"Additional resources ({{resource}}) are required for your account to perform this transaction. Would you like to automatically purchase these resources from the network and proceed?",resource:l}),elements:[{type:"asset",data:{label:a("fee.cost",{default:"Cost of {{resource}}",resource:l}),value:this.price}},{type:"accept"}]}).then(()=>({request:r})).catch(t=>{if(t)throw t;return{request:e}})}async correct(e,t,a){if(this.iterations++,this.iterations>3)throw new Error("Too many iterations. Please report this bug if you see it.");const s=Ht[String(t.chain.id)];if(!s||!t.ui)return e;const n=new Ot({api:t.client,sampleAccount:s.sampleAccount}),i=await t.resolve(e);return t.client.v1.chain.compute_transaction(i.transaction).then(r=>{const l=function(e){return e.error?e.error:e.processed.except?e.processed.except:null}(r);if(l&&l.stack&&"object"==typeof l.stack[0])switch(l.name){case"tx_net_usage_exceeded":{const{net_usage:e}=l.stack[0].data,r=e*qt;if(s.features.includes(Bt.PowerUp))return this.powerup(t,i,a,n,0,r);break}case"tx_cpu_usage_exceeded":{const{billed:e,billable:r}=l.stack[0].data,o=(e-r)*qt;if(s.features.includes(Bt.PowerUp))return this.powerup(t,i,a,n,o,0);break}case"ram_usage_exceeded":{const{available:e,needs:r}=l.stack[0].data,o=(r-e)*qt;if(s.features.includes(Bt.BuyRAM))return this.buyram(t,i,a,n,o);break}}return e}).catch(r=>{if(r.error)switch(r.error.name){case"tx_net_usage_exceeded":{const[,e]=r.error.details[0].message.match(/transaction net usage is too high: (\d+) > (\d+)/),l=Number(e)*qt;if(s.features.includes(Bt.PowerUp))return this.powerup(t,i,a,n,0,l);break}case"tx_cpu_usage_exceeded":{const[,e]=r.error.details[0].message.match(/billed CPU time \((\d+) us\) is greater than the maximum billable CPU time for the transaction/),l=Number(e)*qt;if(s.features.includes(Bt.PowerUp))return this.powerup(t,i,a,n,l,0);break}case"ram_usage_exceeded":{const[,,e,l]=r.error.details[0].message.match(/account (\w.+) has insufficient ram; needs (\d+) bytes has (\d+) bytes/),o=(Number(e)-Number(l))*qt+2;if(s.features.includes(Bt.BuyRAM))return this.buyram(t,i,a,n,o);break}default:console.log("unknown error",r)}return e})}async buyram(e,t,a,s,n){const i=Ht[String(e.chain.id)],r=await s.v1.ram.get_state();this.sample||(this.sample=await s.getSampledUsage());const l=ie.from(r.price_per(n).value,i.symbol);this.price?this.price.units.add(l.units):this.price=l,this.resources.push("RAM");const o=he.from({account:"eosio",name:"buyrambytes",authorization:[t.signer],data:Ut.from({payer:t.signer.actor,receiver:t.signer.actor,bytes:n})}),c=me(t.request,o);return this.correct(c,e,a)}async powerup(e,t,a,s,n,i){const r=Ht[String(e.chain.id)],l=await s.v1.powerup.get_state();this.sample||(this.sample=await s.getSampledUsage()),n<2500&&(n=2500),i<1e4&&(i=1e4);const o=ie.from(Number(l.cpu.price_per(this.sample,n))+Number(l.net.price_per(this.sample,i))*qt,r.symbol);this.price?this.price.units.add(o.units):this.price=o,this.resources.push("CPU","NET");const c=he.from({account:"eosio",name:"powerup",authorization:[t.signer],data:Dt.from({payer:t.signer.actor,receiver:t.signer.actor,days:1,net_frac:l.net.frac(this.sample,i),cpu_frac:l.cpu.frac(this.sample,n),max_payment:o})});let d=me(t.request,c);const u=410;if(Number(a.ram_quota)-Number(a.ram_usage)<u){const n=Ht[String(e.chain.id)],i=await s.v1.ram.get_state();this.sample||(this.sample=await s.getSampledUsage());const r=he.from({account:"eosio",name:"buyrambytes",authorization:[t.signer],data:Ut.from({payer:t.signer.actor,receiver:t.signer.actor,bytes:u})});a.ram_quota.add(u),d=me(d,r);const l=ie.from(i.price_per(u).value,n.symbol);this.price.units.add(l.units),this.resources.push("RAM")}return this.correct(d,e,a)}}const Vt=new class{constructor(){M(this,"transactions",new Map),M(this,"listeners",new Set),M(this,"retryTimeouts",new Map)}async executeTransaction(e,t,a={}){const s=this.generateTransactionId(),n=Kt.getAccountName();if(!n)throw new Error("Wallet not connected");const i={id:s,type:e,status:"pending",timestamp:Date.now(),account:n,actions:t,metadata:a.metadata,retryCount:0,maxRetries:a.maxRetries??3};this.transactions.set(s,i),this.emitEvent("transaction_started",i);try{this.updateTransactionStatus(s,"processing");const r=await this.performTransaction(t,a.timeout);if(i.transactionId=r.transactionId,i.blockNum=r.blockNum,i.cpuUsage=r.cpuUsage,i.netUsage=r.netUsage,r.success)return a.skipConfirmation||(this.updateTransactionStatus(s,"confirming"),await this.waitForConfirmation(r.transactionId)),this.updateTransactionStatus(s,"success"),De.info("Transaction successful","TransactionService",{transactionId:r.transactionId,type:e,account:n}),r;throw new Error(r.error||"Transaction failed")}catch(r){const t=r instanceof Error?r.message:"Unknown error";return i.error=t,De.error("Transaction failed","TransactionService",r instanceof Error?r:new Error(t),{transactionId:s,type:e,account:n}),i.maxRetries>0&&i.retryCount<i.maxRetries?this.retryTransaction(s,a):(this.updateTransactionStatus(s,"failed"),{success:!1,error:t})}}async retryTransaction(e,t){const a=this.transactions.get(e);if(!a)throw new Error("Transaction not found");a.retryCount=(a.retryCount||0)+1,this.emitEvent("transaction_retry",a);const s=t.retryDelay??2e3*a.retryCount;await new Promise(t=>{const a=setTimeout(t,s);this.retryTimeouts.set(e,a)}),this.retryTimeouts.delete(e);const n=this.generateTransactionId(),i={...a,id:n,status:"pending",timestamp:Date.now(),error:void 0,transactionId:void 0,blockNum:void 0,cpuUsage:void 0,netUsage:void 0};this.transactions.set(n,i),this.emitEvent("transaction_started",i);try{this.updateTransactionStatus(n,"processing");const e=await this.performTransaction(a.actions,t.timeout);if(i.transactionId=e.transactionId,i.blockNum=e.blockNum,i.cpuUsage=e.cpuUsage,i.netUsage=e.netUsage,e.success)return t.skipConfirmation||(this.updateTransactionStatus(n,"confirming"),await this.waitForConfirmation(e.transactionId)),this.updateTransactionStatus(n,"success"),De.info("Transaction retry successful","TransactionService",{transactionId:e.transactionId,type:a.type,account:a.account,retryCount:a.retryCount}),e;throw new Error(e.error||"Transaction failed")}catch(r){const s=r instanceof Error?r.message:"Unknown error";return i.error=s,De.error("Transaction retry failed","TransactionService",r instanceof Error?r:new Error(s),{transactionId:n,type:a.type,account:a.account,retryCount:a.retryCount}),a.maxRetries>0&&a.retryCount<a.maxRetries?this.retryTransaction(e,t):(this.updateTransactionStatus(n,"failed"),{success:!1,error:s})}}cancelTransaction(e){const t=this.transactions.get(e);if(!t||"pending"!==t.status)return!1;const a=this.retryTimeouts.get(e);return a&&(clearTimeout(a),this.retryTimeouts.delete(e)),this.updateTransactionStatus(e,"cancelled"),!0}getTransaction(e){return this.transactions.get(e)}getTransactionsByAccount(e){return Array.from(this.transactions.values()).filter(t=>t.account===e).sort((e,t)=>t.timestamp-e.timestamp)}getTransactionsByType(e){return Array.from(this.transactions.values()).filter(t=>t.type===e).sort((e,t)=>t.timestamp-e.timestamp)}getPendingTransactions(){return Array.from(this.transactions.values()).filter(e=>["pending","processing","confirming"].includes(e.status)).sort((e,t)=>t.timestamp-e.timestamp)}clearOldTransactions(){const e=Array.from(this.transactions.values()).sort((e,t)=>t.timestamp-e.timestamp);if(e.length>100){e.slice(100).forEach(e=>this.transactions.delete(e.id))}}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}clearListeners(){this.listeners.clear()}generateTransactionId(){return`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}updateTransactionStatus(e,t){const a=this.transactions.get(e);a&&(a.status=t,this.emitEvent(`transaction_${t}`,a))}emitEvent(e,t){const a={type:e,transaction:t,timestamp:Date.now()};this.listeners.forEach(e=>{try{e(a)}catch(t){De.error("Transaction listener error","TransactionService",t instanceof Error?t:new Error(String(t)))}})}async performTransaction(e,t){try{const t=await Kt.transact(e);if(t&&"object"==typeof t){const e=t;return{success:!0,transactionId:e.transaction_id||e.id,blockNum:e.block_num,cpuUsage:e.cpu_usage_us,netUsage:e.net_usage_words}}return{success:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Transaction failed"}}}async waitForConfirmation(e){await new Promise(e=>setTimeout(e,3e3))}};class Gt{constructor(){M(this,"sessionKit",null),M(this,"currentSession",null),M(this,"listeners",[]),this.initializeSessionKit(),this.restoreSession()}initializeSessionKit(){try{const e={appName:"PxMarket2",chains:[{id:"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4",url:qe.WAX_CHAIN.GREYMASS}],ui:new xe,walletPlugins:[new Y,new Q,new Z]},t={transactPlugins:[new Jt]};this.sessionKit=new ge(e,t)}catch(e){Le.logError("WharfKitService.initialize",e)}}async restoreSession(){if(this.sessionKit)try{const e=await this.sessionKit.restore();e&&(this.currentSession=e,this.notifyListeners())}catch(e){Le.logError("WharfKitService.restoreSession",e)}}async login(){if(!this.sessionKit)return Le.logError("WharfKitService.login",new Error("SessionKit not initialized")),null;try{const e=await this.sessionKit.login();if(e.session)return this.currentSession=e.session,this.notifyListeners(),this.currentSession}catch(e){throw Le.logError("WharfKitService.login",e),e}return null}async logout(){if(this.sessionKit&&this.currentSession)try{await this.sessionKit.logout(this.currentSession),this.currentSession=null,this.notifyListeners()}catch(e){throw Le.logError("WharfKitService.logout",e),e}}isLoggedIn(){return null!==this.currentSession}getSession(){return this.currentSession}getActor(){return this.currentSession?.actor?.toString()||null}getAccountName(){return this.currentSession?.actor?.toString()||null}getPermission(){return this.currentSession?.permission?.toString()||"active"}static safeGetActor(e){return e?.actor?.toString()||""}static safeGetPermission(e){return e?.permission?.toString()||"active"}async transact(e){if(!this.currentSession)throw new Error("No active session. Please login first.");try{Oe.debug("Sending transaction with actions","WHARFKIT",{actionsCount:e.length});const t=await this.currentSession.transact({actions:e},{broadcast:!0,expireSeconds:120});return Oe.info("Transaction successful","WHARFKIT",{result:t}),t}catch(t){throw Le.logError("WharfKitService.transact",t,{actions:e}),t}}async purchaseNFT(e,t){if(!this.currentSession)throw new Error("Please login to purchase NFTs");const a=[{account:"eosio.token",name:"transfer",authorization:[{actor:this.currentSession?.actor?.toString()||"",permission:"active"}],data:{from:this.currentSession?.actor?.toString()||"",to:"atomicmarket",quantity:`${parseFloat(t).toFixed(8)} WAX`,memo:"deposit"}},{account:"atomicmarket",name:"purchasesale",authorization:[{actor:this.currentSession?.actor?.toString()||"",permission:"active"}],data:{buyer:this.currentSession?.actor?.toString()||"",sale_id:e,intended_delphi_median:0,taker_marketplace:"market.pxj"}}];return Oe.debug("Crafting transaction actions","WHARFKIT",{actionsCount:a.length}),this.transact(a)}async batchPurchaseNFTs(e){if(!this.currentSession)throw new Error("Please login to purchase NFTs");if(0===e.length)throw new Error("No items to purchase");const t=[],a=e.reduce((e,t)=>e+parseFloat(t.price),0);return t.push({account:"eosio.token",name:"transfer",authorization:[{actor:this.currentSession.actor.toString(),permission:"active"}],data:{from:this.currentSession.actor.toString(),to:"atomicmarket",quantity:`${a.toFixed(8)} WAX`,memo:"deposit"}}),e.forEach(e=>{t.push({account:"atomicmarket",name:"purchasesale",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{buyer:this.currentSession?.actor.toString()||"",sale_id:e.saleId,intended_delphi_median:0,taker_marketplace:"market.pxj"}})}),this.transact(t)}async transferTokens(e,t,a="PXJ",s=""){if(!this.currentSession)throw new Error("Please login to transfer tokens");const n=((e,t,a,s="WAX",n="")=>{let i;switch(s){case"WAX":default:i="eosio.token";break;case"RWAX":i="token.rwax";break;case"PXJ":i="pixeljourney"}return[{account:i,name:"transfer",authorization:[{actor:e,permission:"active"}],data:{from:e,to:t,quantity:`${a} ${s}`,memo:n}}]})(this.currentSession?.actor?.toString()||"",e,t,a,s);return Oe.debug("Token transfer transaction actions","WHARFKIT",{actionsCount:n.length,to:e,amount:t,currency:a,memo:s}),this.transact(n)}async bulkTransferNFT(e,t,a=""){if(!this.currentSession)throw new Error("Please login to transfer NFTs");if(!t||0===t.length)throw new Error("No assets to transfer");const s=t.map(t=>({account:"atomicassets",name:"transfer",authorization:[{actor:this.currentSession?.actor?.toString()||"",permission:"active"}],data:{from:this.currentSession?.actor?.toString()||"",to:e,asset_ids:[t],memo:a}}));return Oe.debug("Bulk NFT transfer transaction actions","WHARFKIT",{actionsCount:s.length,recipient:e,assetIds:t.length,memo:a}),this.transact(s)}async executeCraftingTransaction(e){if(!this.currentSession)throw new Error("No active session");const t=[],a=this.currentSession?.actor?.toString()||"",s={craft_green:1832,craft_orange:1833,craft_purple:1834,craft_amber:1835,craft_chartreuse:1836,craft_violet:1837,craft_teal:1838,craft_vermillion:1839,craft_magenta:1841}[e.recipe];if(!s)throw new Error(`Unknown recipe: ${e.recipe}`);const n=e.pxjCost;t.push({account:"nft.hive",name:"boost",authorization:[{actor:a,permission:"active"}],data:{booster:a}});for(let i=0;i<e.quantity;i++){const r=[];for(const t of e.ingredientAssets){const a=t.assetIds.length/e.quantity,s=i*a,n=s+a;r.push(...t.assetIds.slice(s,n))}r.length>0&&t.push({account:"atomicassets",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"nfthivecraft",asset_ids:r,memo:"craft"}}),n>0&&t.push({account:"pixeljourney",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"nfthivecraft",quantity:`${n.toFixed(8)} PXJ`,memo:"craft"}}),t.push({account:"nfthivecraft",name:"craft",authorization:[{actor:a,permission:"active"}],data:{craft_id:s,user_name:a,collection_name:"pixeljourney",timestamp:Date.now().toString(),asset_ids:r,tokens:[`${n.toFixed(8)} PXJ`]}})}return this.transact(t)}subscribe(e){return this.listeners.push(e),e(this.getWalletContext()),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}notifyListeners(){const e=this.getWalletContext();this.listeners.forEach(t=>t(e))}getWalletContext(){return{isConnected:this.isLoggedIn(),account:this.getAccountName(),session:this.currentSession,login:this.login.bind(this),logout:this.logout.bind(this),transact:this.transact.bind(this),purchaseNFT:this.purchaseNFT.bind(this),batchPurchaseNFTs:this.batchPurchaseNFTs.bind(this),executeCraftingTransaction:this.executeCraftingTransaction.bind(this),isLoading:!1,executeTransaction:this.executeTransaction.bind(this),getTransaction:void 0,cancelTransaction:void 0,getTransactionHistory:void 0,transferNFT:void 0,bulkTransferNFT:this.bulkTransferNFT.bind(this),transferTokens:this.transferTokens.bind(this)}}async executeTransaction(e,t){if(!this.currentSession)throw new Error("No active session. Please login first.");try{let a=[];switch(e){case"nft_purchase":if(!t.saleId||!t.price)throw new Error("Missing saleId or price for NFT purchase");a=((e,t,a,s="WAX",n="atomicmarket")=>{const i=[],r="WAX"===s?"eosio.token":"token.rwax";return i.push({account:r,name:"transfer",authorization:[{actor:e,permission:"active"}],data:{from:e,to:n,quantity:`${a} ${s}`,memo:"deposit"}}),i.push({account:n,name:"purchasesale",authorization:[{actor:e,permission:"active"}],data:{buyer:e,sale_id:t,intended_delphi_median:0,taker_marketplace:"market.pxj"}}),i})(this.currentSession?.actor?.toString()||"",t.saleId,t.price);break;case"crafting":{const e=await this.executeCraftingTransaction(t);return e&&"object"==typeof e&&"transaction_id"in e?e.transaction_id:"crafting_completed"}default:throw new Error(`Transaction type '${e}' not supported yet`)}const s=await Vt.executeTransaction(e,a);if(s.success&&s.transactionId)return s.transactionId;throw new Error(s.error||"Transaction failed")}catch(a){throw Oe.error("Transaction execution failed","WharfKitService.executeTransaction",a instanceof Error?a:new Error(String(a)),{type:e,data:t}),a}}getAPIClient(){return new ee({url:qe.WAX_CHAIN.GREYMASS})}}const Kt=new Gt,Yt=Object.freeze(Object.defineProperty({__proto__:null,WharfKitService:Gt,wharfKitService:Kt},Symbol.toStringTag,{value:"Module"})),Qt=D.memo(({imageUrl:e,videoUrl:t,alt:a,className:s="",controls:n=!0,muted:i=!0,loop:r=!1,autoPlay:l=!1,loading:o="lazy",enableAnimations:c=!0})=>{const d=e=>e?"string"!=typeof e?null:e.startsWith("http")?e:e.startsWith("Qm")?`${qe.IPFS.GATEWAYS[0]}${e}`:e:null,u=d(t),h=d(e),m=()=>`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#f3f4f6"/>\n      <text x="100" y="90" text-anchor="middle" font-family="Arial" font-size="14" fill="#6b7280">NFT</text>\n      <text x="100" y="110" text-anchor="middle" font-family="Arial" font-size="12" fill="#9ca3af">No Image</text>\n      <text x="100" y="130" text-anchor="middle" font-family="Arial" font-size="10" fill="#d1d5db">Available</text>\n    </svg>')}`,p=h||m();return u&&c?Se.jsxs("video",{className:s,controls:n,muted:i,loop:r,autoPlay:l,poster:h||void 0,onError:e=>{const t=e.target,n=document.createElement("img");n.src=p,n.alt=a,n.className=s,n.loading=o,t.parentNode?.replaceChild(n,t)},children:[Se.jsx("source",{src:u,type:"video/mp4"}),Se.jsx("source",{src:u,type:"video/webm"}),"Your browser does not support the video tag."]}):u&&!c?Se.jsx("img",{src:p,alt:a,className:s,loading:o,onError:e=>{const t=e.target,a=m();t.src!==a&&(t.src=a)}}):Se.jsx("img",{src:p,alt:a,className:s,loading:o,onError:e=>{const t=e.target,a=m();t.src!==a&&(t.src=a)}})});Qt.displayName="MediaRenderer";const Zt=new class{constructor(){M(this,"defaultConfig",{width:1200,height:630,backgroundColor:"#1a1a2e",textColor:"#ffffff",accentColor:"#ffd700"})}generateAchievementShareImage(e,t,a,s,n={}){const{width:i,height:r,textColor:l,accentColor:o}={...this.defaultConfig,...n},c=e.filter(e=>e.unlockedAt).sort((e,t)=>{const a={legendary:4,epic:3,rare:2,common:1};return(a[t.rarity||"common"]||1)-(a[e.rarity||"common"]||1)}).slice(0,3),d=`\n      <svg width="${i}" height="${r}" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#16213e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />\n          </linearGradient>\n          <linearGradient id="titleGradient" x1="0%" y1="0%" x2="100%" y2="0%">\n            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n        \n        \x3c!-- Background --\x3e\n        <rect width="100%" height="100%" fill="url(#bgGradient)"/>\n        \n        \x3c!-- Header --\x3e\n        <text x="${i/2}" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="48" font-weight="bold" fill="url(#titleGradient)" text-anchor="middle">\n          ${s}'s Achievements\n        </text>\n        \n        \x3c!-- Stats Section --\x3e\n        <g transform="translate(${i/2-300}, 150)">\n          \x3c!-- Total Badges --\x3e\n          <rect x="0" y="0" width="180" height="120" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="90" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="${o}" text-anchor="middle">${t}</text>\n          <text x="90" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Total</text>\n          <text x="90" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Badges</text>\n          \n          \x3c!-- Legendary Badges --\x3e\n          <rect x="210" y="0" width="180" height="120" rx="15" fill="rgba(255,140,0,0.2)" stroke="#ff8c00" stroke-width="2"/>\n          <text x="300" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="#ff8c00" text-anchor="middle">${a}</text>\n          <text x="300" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Legendary</text>\n          <text x="300" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Badges</text>\n          \n          \x3c!-- Progress --\x3e\n          <rect x="420" y="0" width="180" height="120" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="510" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="${o}" text-anchor="middle">${e.filter(e=>e.progress&&!e.unlockedAt).length}</text>\n          <text x="510" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">In</text>\n          <text x="510" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Progress</text>\n        </g>\n        \n        \x3c!-- Top Badges Section --\x3e\n        ${c.length>0?`\n        <text x="${i/2}" y="350" font-family="system-ui" font-size="24" font-weight="600" fill="${l}" text-anchor="middle">\n          Featured Achievements\n        </text>\n        \n        <g transform="translate(${i/2-150*c.length}, 380)">\n          ${c.map((e,t)=>{const a=300*t,s="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="280" height="180" rx="15" fill="rgba(255,255,255,0.1)" stroke="${s}" stroke-width="2"/>\n              <text x="140" y="30" font-family="system-ui" font-size="32" text-anchor="middle">${e.icon}</text>\n              <text x="140" y="70" font-family="system-ui" font-size="18" font-weight="600" fill="${s}" text-anchor="middle">${e.name}</text>\n              <text x="140" y="100" font-family="system-ui" font-size="14" fill="#b0b0b0" text-anchor="middle">${e.rarity?.toUpperCase()||"COMMON"}</text>\n              ${e.tier?`<text x="140" y="130" font-family="system-ui" font-size="12" fill="#888" text-anchor="middle">Tier ${e.tier}</text>`:""}\n              <text x="140" y="160" font-family="system-ui" font-size="10" fill="#666" text-anchor="middle">${e.unlockedAt?new Date(e.unlockedAt).toLocaleDateString():""}</text>\n            </g>\n            `}).join("")}\n        </g>\n        `:""}\n        \n        \x3c!-- Footer --\x3e\n        <text x="${i/2}" y="${r-40}" font-family="system-ui" font-size="18" fill="#888" text-anchor="middle">\n          Pixel Journey Ecosystem \u2022 PxMarket\n        </text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(d)}`}generateInventoryShareImage(e,t,a,s={}){const{width:n,height:i,textColor:r,accentColor:l}={...this.defaultConfig,...s},o=e.sort((e,t)=>{const a={legendary:4,epic:3,rare:2,common:1};return(a[t.rarity]||1)-(a[e.rarity]||1)}).slice(0,6),c=`\n      <svg width="${n}" height="${i}" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#16213e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />\n          </linearGradient>\n          <linearGradient id="titleGradient" x1="0%" y1="0%" x2="100%" y2="0%">\n            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n        \n        \x3c!-- Background --\x3e\n        <rect width="100%" height="100%" fill="url(#bgGradient)"/>\n        \n        \x3c!-- Header --\x3e\n        <text x="${n/2}" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="48" font-weight="bold" fill="url(#titleGradient)" text-anchor="middle">\n          ${a}'s Collection\n        </text>\n        \n        \x3c!-- Stats --\x3e\n        <g transform="translate(${n/2-200}, 130)">\n          <rect x="0" y="0" width="180" height="100" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="90" y="35" font-family="system-ui" font-size="32" font-weight="bold" fill="${l}" text-anchor="middle">${e.length}</text>\n          <text x="90" y="60" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Selected</text>\n          <text x="90" y="80" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Items</text>\n          \n          <rect x="220" y="0" width="180" height="100" rx="15" fill="rgba(0,212,255,0.2)" stroke="#00d4ff" stroke-width="2"/>\n          <text x="310" y="35" font-family="system-ui" font-size="24" font-weight="bold" fill="#00d4ff" text-anchor="middle">${t}</text>\n          <text x="310" y="60" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Total</text>\n          <text x="310" y="80" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Value</text>\n        </g>\n        \n        \x3c!-- Items Grid --\x3e\n        ${o.length>0?`\n        <text x="${n/2}" y="290" font-family="system-ui" font-size="24" font-weight="600" fill="${r}" text-anchor="middle">\n          Featured Items\n        </text>\n        \n        <g transform="translate(${n/2-120*Math.min(o.length,3)}, 320)">\n          ${o.slice(0,3).map((e,t)=>{const a=240*t,s="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="220" height="160" rx="15" fill="rgba(255,255,255,0.1)" stroke="${s}" stroke-width="2"/>\n              <rect x="10" y="10" width="60" height="60" rx="8" fill="rgba(0,0,0,0.3)" stroke="${s}" stroke-width="1"/>\n              <text x="40" y="50" font-family="system-ui" font-size="24" text-anchor="middle">\ud83c\udfa8</text>\n              <text x="90" y="30" font-family="system-ui" font-size="16" font-weight="600" fill="${r}">${e.name.length>15?e.name.substring(0,15)+"...":e.name}</text>\n              <text x="90" y="50" font-family="system-ui" font-size="14" fill="#b0b0b0">${e.collection}</text>\n              <text x="90" y="70" font-family="system-ui" font-size="12" fill="${s}">${e.rarity.toUpperCase()}</text>\n              ${e.quantity>1?`<text x="200" y="30" font-family="system-ui" font-size="14" fill="${l}" text-anchor="end">x${e.quantity}</text>`:""}\n            </g>\n            `}).join("")}\n        </g>\n        \n        ${o.length>3?`\n        <g transform="translate(${n/2-120*Math.min(o.length-3,3)}, 500)">\n          ${o.slice(3,6).map((e,t)=>{const a=240*t,s="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="220" height="100" rx="15" fill="rgba(255,255,255,0.1)" stroke="${s}" stroke-width="2"/>\n              <rect x="10" y="10" width="40" height="40" rx="6" fill="rgba(0,0,0,0.3)" stroke="${s}" stroke-width="1"/>\n              <text x="30" y="35" font-family="system-ui" font-size="16" text-anchor="middle">\ud83c\udfa8</text>\n              <text x="65" y="25" font-family="system-ui" font-size="14" font-weight="600" fill="${r}">${e.name.length>12?e.name.substring(0,12)+"...":e.name}</text>\n              <text x="65" y="45" font-family="system-ui" font-size="12" fill="${s}">${e.rarity.toUpperCase()}</text>\n              ${e.quantity>1?`<text x="200" y="25" font-family="system-ui" font-size="12" fill="${l}" text-anchor="end">x${e.quantity}</text>`:""}\n            </g>\n            `}).join("")}\n        </g>\n        `:""}\n        `:""}\n        \n        \x3c!-- Footer --\x3e\n        <text x="${n/2}" y="${i-40}" font-family="system-ui" font-size="18" fill="#888" text-anchor="middle">\n          Pixel Journey Ecosystem \u2022 PxMarket\n        </text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(c)}`}downloadImage(e,t){const a=document.createElement("a");a.download=t,a.href=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}async convertToPNG(e,t=1200,a=630){return new Promise((s,n)=>{const i=new Image;i.onload=()=>{const e=document.createElement("canvas");e.width=t,e.height=a;const r=e.getContext("2d");r?(r.drawImage(i,0,0,t,a),s(e.toDataURL("image/png"))):n(new Error("Could not get canvas context"))},i.onerror=n,i.src=e})}},ea=(e,t,a,s,n)=>Zt.generateAchievementShareImage(e,t,a,s,n),ta=(e,t,a,s)=>Zt.generateInventoryShareImage(e,t,a,s),aa=(e,t)=>Zt.downloadImage(e,t),sa=({isOpen:e,onClose:t,title:a,description:s,imageUrl:n,shareUrl:i,defaultShareText:r,type:l="nft",badges:o,totalBadges:c,legendaryCount:d,username:u,selectedItems:h,totalValue:m})=>{const[p,f]=O.useState(!1),[x,g]=O.useState(""),[v,y]=O.useState(!1),{showSuccess:j}=xt(),b=()=>{let e=[];switch(l){case"nft":e=[`\ud83c\udfa8 Check out this amazing NFT: ${a}! \u2728`,`\ud83d\udd25 Discovered this incredible ${a} NFT! \ud83d\ude80`,`\u2728 Look at this stunning ${a}! NFT art at its finest \ud83c\udfad`,`\ud83c\udf1f Found a gem! ${a} is absolutely beautiful \ud83d\udc8e`,`\ud83c\udfaf This ${a} NFT caught my eye! Amazing artwork \ud83c\udfa8`,`\ud83d\udcab Showcasing ${a} - a true masterpiece! \ud83d\uddbc\ufe0f`,`\ud83d\ude80 Blown away by this ${a} NFT! \u2b50`,`\ud83c\udfaa Step right up and see ${a}! Fantastic NFT art \ud83c\udf8a`];break;case"collection":e=[`\ud83c\udfdb\ufe0f Explore the amazing ${a} collection! \ud83c\udfa8`,`\ud83d\udd25 This ${a} collection is absolutely fire! \ud83d\ude80`,`\u2728 Dive into the world of ${a}! Incredible NFT collection \ud83c\udf1f`,`\ud83d\udc8e Discovered this gem of a collection: ${a}! \ud83c\udfad`,`\ud83c\udfaf ${a} collection has some amazing pieces! \ud83d\uddbc\ufe0f`,`\ud83c\udf08 The ${a} collection is a work of art! \u2728`,`\ud83d\ude80 Check out the stunning ${a} collection! \u2b50`,`\ud83c\udfaa Welcome to ${a} - an NFT wonderland! \ud83c\udf8a`];break;case"template":e=[`\ud83c\udfa8 Check out this ${a} template! Perfect for collectors \u2728`,`\ud83d\udd25 This ${a} template is incredible! \ud83d\ude80`,`\u2728 Found an amazing ${a} template! \ud83c\udfad`,`\ud83c\udf1f ${a} template - a collector's dream! \ud83d\udc8e`,`\ud83c\udfaf This ${a} template caught my attention! \ud83c\udfa8`,`\ud83d\udcab Showcasing the ${a} template! \ud83d\uddbc\ufe0f`,`\ud83d\ude80 Amazing ${a} template available! \u2b50`,`\ud83c\udfaa Don't miss this ${a} template! \ud83c\udf8a`];break;case"achievement":e=["\ud83c\udfc6 Just unlocked some amazing achievements! \ud83c\udf89","\ud83d\udd25 Check out my gaming achievements! \ud83d\ude80","\u2728 Proud of my latest achievements! \ud83c\udfad","\ud83c\udf1f Achievement unlocked! Gaming milestones reached \ud83d\udc8e","\ud83c\udfaf Showcasing my gaming achievements! \ud83c\udfa8","\ud83d\udcab Level up! New achievements earned! \ud83d\uddbc\ufe0f","\ud83d\ude80 Gaming achievements on display! \u2b50","\ud83c\udfaa Celebrating my gaming milestones! \ud83c\udf8a"];break;default:e=[r]}return e[Math.floor(Math.random()*e.length)]},[N,w]=O.useState(()=>r||b()),k=r||N,_=i||window.location.href;if(!e)return null;const S=async e=>{try{await navigator.clipboard.writeText(e),f(!0),setTimeout(()=>f(!1),2e3)}catch(t){De.error("Failed to copy to clipboard","ShareModal",t,{type:l,shareText:x})}};return Se.jsx("div",{className:"social-share-overlay",onClick:t,children:Se.jsxs("div",{className:"social-share-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"share-header",children:[Se.jsxs("h3",{children:["Share ","collection"===l?"Collection":"template"===l?"Template":"achievement"===l?"Achievement":"NFT"]}),Se.jsx("button",{className:"close-btn",onClick:t,children:Se.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se.jsxs("div",{className:"share-content",children:[n&&Se.jsxs("div",{className:"nft-preview share-modal-preview",children:[Se.jsx("img",{src:n,alt:a,className:"nft-image"}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h4",{children:a}),s&&Se.jsx("p",{children:s})]})]}),Se.jsxs("div",{className:"share-text-section",children:[Se.jsxs("div",{className:"share-text-header",children:[Se.jsx("label",{htmlFor:"share-text",children:"Customize your message:"}),!r&&Se.jsx("button",{className:"refresh-message-btn",onClick:()=>{r||w(b())},title:"Generate new random message",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),Se.jsx("textarea",{id:"share-text",value:x,onChange:e=>g(e.target.value),placeholder:k,className:"share-textarea",rows:3})]}),Se.jsxs("div",{className:"share-url-section",children:[Se.jsx("label",{children:"Share URL:"}),Se.jsxs("div",{className:"url-input-container",children:[Se.jsx("input",{type:"text",value:_,readOnly:!0,className:"url-input"}),Se.jsxs("button",{className:"copy-btn "+(p?"copied":""),onClick:()=>S(_),children:[p?Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):Se.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),Se.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),p?"Copied!":"Copy"]})]})]}),Se.jsxs("div",{className:"social-buttons",children:[Se.jsxs("button",{className:"social-btn twitter",onClick:()=>{const e="collection"===l?"NFTCollection,WAX,PixelJourney":"template"===l?"NFTTemplate,WAX,PixelJourney":"achievement"===l?"Achievement,Gaming,PixelJourney":"NFT,WAX,PixelJourney",t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(x||k)}&url=${encodeURIComponent(_)}&hashtags=${e}`;window.open(t,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),"Twitter"]}),Se.jsxs("button",{className:"social-btn facebook",onClick:()=>{const e=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(_)}`;window.open(e,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),Se.jsxs("button",{className:"social-btn reddit",onClick:()=>{const e=x||k,t=`https://reddit.com/submit?url=${encodeURIComponent(_)}&title=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),Se.jsxs("button",{className:"social-btn discord",onClick:()=>{S(`${x||k}\n${_}`),j("Share text copied to clipboard! You can now paste it in Discord.","Copied to Clipboard")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})}),"Discord"]}),Se.jsxs("button",{className:"social-btn telegram",onClick:()=>{const e=x||k,t=`https://t.me/share/url?url=${encodeURIComponent(_)}&text=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Telegram"]}),Se.jsxs("button",{className:"social-btn email",onClick:()=>{const e=`${x||k}\n\nView it here: ${_}`,t=`mailto:?subject=${encodeURIComponent(`Check out: ${a}`)}&body=${encodeURIComponent(e)}`;window.location.href=t},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]})]}),("achievement"===l||"inventory"===l)&&u&&Se.jsxs("div",{className:"share-image-section",children:[Se.jsx("h4",{children:"Generate Share Image"}),Se.jsxs("div",{className:"image-buttons",children:[Se.jsx("button",{className:"generate-btn svg",onClick:async()=>{if(u)try{let e,t;if(y(!0),"achievement"===l&&o&&void 0!==c&&void 0!==d)e=ea(o,c,d,u),t=`${u}-achievements-${Date.now()}.svg`;else{if("inventory"!==l||!h||!m)return;e=ta(h,m,u),t=`${u}-inventory-${Date.now()}.svg`}aa(e,t)}catch(e){De.error("Error generating share image","ShareModal",e,{type:l,username:u})}finally{y(!1)}},disabled:v,children:v?"Generating...":"Download SVG"}),Se.jsx("button",{className:"generate-btn png",onClick:async()=>{if(u)try{let e,t;if(y(!0),"achievement"===l&&o&&void 0!==c&&void 0!==d)e=ea(o,c,d,u),t=`${u}-achievements-${Date.now()}.png`;else{if("inventory"!==l||!h||!m)return;e=ta(h,m,u),t=`${u}-inventory-${Date.now()}.png`}const a=await((e,t,a)=>Zt.convertToPNG(e,t,a))(e);aa(a,t)}catch(e){De.error("Error generating PNG share image","ShareModal",e,{type:l,username:u})}finally{y(!1)}},disabled:v,children:v?"Generating...":"Download PNG"})]})]})]})]})})};const na=new class{constructor(){M(this,"CHAT_ACCOUNT","chat.pxj"),M(this,"PXJ_CONTRACT","pixeljourney"),M(this,"PXJ_SYMBOL","PXJ"),M(this,"BASE_COST_PIXAL_HOLDER",100),M(this,"BASE_COST_NON_HOLDER",1e4),M(this,"SPONSORED_COST_PIXAL_HOLDER",1e4),M(this,"SPONSORED_COST_NON_HOLDER",25e3),M(this,"MIN_MESSAGE_COST",100),M(this,"messageCache",new Map),M(this,"userRateLimit",new Map),M(this,"blacklistedAccounts",new Set),M(this,"moderationSettings",{blacklistedAccounts:[],bannedWords:["spam","scam","hack","phishing"],trustedDomains:["wax.io","atomichub.io","wax.bloks.io","pixeljourney.io"],maxMessageLength:240,minTimeBetweenMessages:5}),M(this,"userLastMessageTime",new Map)}async calculateMessageCost(e,t,a=!1){const s=e.length,n=await this.checkPixalPFPOwnership(t);if(a){const e=n?this.SPONSORED_COST_PIXAL_HOLDER:this.SPONSORED_COST_NON_HOLDER;return{baseCost:e,characterCost:0,totalCost:e,hasPixalPFP:n,discount:n?60:0,isSponsored:!0}}const i=n?this.BASE_COST_PIXAL_HOLDER:this.BASE_COST_NON_HOLDER;let r=1;s>50&&(r=1+(s-50)/50);const l=Math.floor(i*(r-1)),o=Math.max(this.MIN_MESSAGE_COST,i+l),c=n?5e4:o;return{baseCost:i,characterCost:l,totalCost:n?Math.min(o,c):o,hasPixalPFP:n,discount:n?99:0,isSponsored:!1}}async checkPixalPFPOwnership(e){try{const t=await dt.getUserInventory(e);if(!t||0===t.length)return!1;return t.some(e=>"781515"===e.template_id)}catch(t){return Le.logError("ChatService.checkPixalPFPOwnership",t,{userAccount:e}),!1}}async sendMessage(e,t,a,s=!1){this.validateMessageForSending(e,t);let n=(await this.calculateMessageCost(e,t)).totalCost,i=e;if(s){n=await this.checkPixalPFPOwnership(t)?this.SPONSORED_COST_PIXAL_HOLDER:this.SPONSORED_COST_NON_HOLDER,i=`::sponsored:: ${e}`}a&&(i=`::col:${a}:: ${i}`),this.userLastMessageTime.set(t,Date.now());const r={account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.CHAT_ACCOUNT,quantity:`${n.toFixed(8)} ${this.PXJ_SYMBOL}`,memo:i}};try{const e=await Kt.transact([r]);let a=null;if(e&&(a=e.transaction_id||e.id||e.processed?.id||e.processed?.transaction_id||e.response&&e.response.transaction_id||e.transaction&&e.transaction.id),a)return this.updateRateLimit(t),this.messageCache.clear(),a;throw De.warn("Unexpected transaction result format","ChatService.sendMessage",{result:e}),new Error("Transaction completed but transaction ID not found in response")}catch(l){throw l instanceof Error&&l.message.includes("transaction ID not found")&&De.warn("Transaction may have succeeded but response format was unexpected","ChatService.sendMessage",{error:l}),Le.logError("ChatService.sendMessage",l,{messageLength:e.length}),new Error(`Failed to send message: ${l instanceof Error?l.message:"Unknown error"}`)}}async getMessages(e={},t=50,a=0){const s=JSON.stringify({filters:e,limit:t,offset:a});if(this.messageCache.has(s))return this.messageCache.get(s);try{const n=await dt.getAccountTransfers(this.CHAT_ACCOUNT,this.PXJ_CONTRACT,this.PXJ_SYMBOL,t,a);if(!n||0===n.length)return[];const i=[];for(const t of n){const a=this.parseTransferToMessage(t);a&&this.applyFilters(a,e)&&!this.isMessageBlockedByModeration(a)&&i.push(a)}return i.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),this.messageCache.set(s,i),i}catch(n){return Le.logError("ChatService.loadMessages",n),[]}}parseTransferToMessage(e){try{const t=String(e.memo||""),a=e.from,s=e.quantity,n=e.timestamp,i=e.transaction_id;if(this.blacklistedAccounts.has(a))return null;let r,l=t,o=!1,c="normal";if(t.startsWith("::sponsored::")){const e=parseFloat(s.split(" ")[0]);e>=1e3?(o=!0,c="sponsored",l=t.replace("::sponsored::","").trim()):l=t.replace("::sponsored::","").trim()}const d=t.match(/::col:([^:]+)::/);d&&(r=d[1],l=l.replace(d[0],"").trim());return parseFloat(s.split(" ")[0])>=10&&(c="premium"),{id:`${i}_${a}`,sender:a,message:l,timestamp:n,pxjAmount:s,transactionId:i,isSponsored:o,collectionTag:r,messageType:c,characterCount:l.length}}catch(t){const a=t instanceof Error?t:new Error("Failed to parse transfer to message");return Le.logError("ChatService.parseTransferToMessage",a,{transfer:e?.transaction_id||"unknown"}),null}}applyFilters(e,t){if(t.collection&&e.collectionTag!==t.collection)return!1;if(t.minPxjAmount){if(parseFloat(e.pxjAmount.split(" ")[0])<t.minPxjAmount)return!1}if(t.maxPxjAmount){if(parseFloat(e.pxjAmount.split(" ")[0])>t.maxPxjAmount)return!1}return(!t.hideSpam||!this.isSpamMessage(e))&&!(t.showOnlySponsored&&!e.isSponsored)}isSpamMessage(e){const t=e.message.toLowerCase();return this.moderationSettings.bannedWords.some(e=>t.includes(e))}updateRateLimit(e){const t=Date.now(),a=this.userRateLimit.get(e)||[];a.push(t),this.userRateLimit.set(e,a)}blacklistAccount(e){this.blacklistedAccounts.add(e)}unblacklistAccount(e){this.blacklistedAccounts.delete(e)}clearCache(){this.messageCache.clear()}async getUserAvatar(e){try{const t=(await dt.getUserInventory(e)).filter(e=>"pixeljourney"===e.collection&&"Pixal"===e.schema);if(t&&t.length>0){const e=t[0];if(e.traits&&e.traits.img&&"string"==typeof e.traits.img)return`${qe.IPFS.GATEWAYS[0]}${e.traits.img.startsWith("Qm"),e.traits.img}`}return`${qe.AVATAR.DICEBEAR}?seed=${e}`}catch(t){const a=t instanceof Error?t:new Error("Failed to get user avatar");return Le.logError("ChatService.getUserAvatar",a,{userAccount:e}),`${qe.AVATAR.DICEBEAR}?seed=${e}`}}validateMessageForSending(e,t){if(this.moderationSettings.blacklistedAccounts.includes(t))throw new Error("Account is blacklisted from sending messages.");if(e.length>this.moderationSettings.maxMessageLength)throw new Error(`Message too long. Maximum ${this.moderationSettings.maxMessageLength} characters allowed.`);const a=e.toLowerCase();for(const n of this.moderationSettings.bannedWords)if(a.includes(n.toLowerCase()))throw new Error("Message contains prohibited content.");const s=this.userLastMessageTime.get(t);if(s){const e=(Date.now()-s)/1e3;if(e<this.moderationSettings.minTimeBetweenMessages)throw new Error(`Please wait ${this.moderationSettings.minTimeBetweenMessages-Math.floor(e)} more seconds before sending another message.`)}this.verifyLinksInMessage(e)}isMessageBlockedByModeration(e){if(this.moderationSettings.blacklistedAccounts.includes(e.sender))return!0;const t=e.message.toLowerCase();for(const a of this.moderationSettings.bannedWords)if(t.includes(a.toLowerCase()))return!0;return!1}verifyLinksInMessage(e){const t=e.match(/(https?:\/\/[^\s]+)/g);if(t)for(const s of t)try{const e=new URL(s).hostname.toLowerCase();if(!this.moderationSettings.trustedDomains.some(t=>e===t.toLowerCase()||e.endsWith("."+t.toLowerCase())))throw new Error(`Links to ${e} are not allowed. Only trusted domains are permitted.`)}catch(a){if(a instanceof Error&&a.message.includes("not allowed"))throw a;throw new Error("Invalid URL detected in message.")}}updateModerationSettings(e){this.moderationSettings={...this.moderationSettings,...e}}getModerationSettings(){return{...this.moderationSettings}}},ia=["strong","em","b","i","u","br","p","span"],ra={span:["class"],p:["class"]},la=({isOpen:e,onClose:t,nft:a})=>{const{account:s,session:n}=Fe(),{showSuccess:i,showError:r}=xt(),l=O.useRef(null),[o,c]=O.useState([]),[d,u]=O.useState(""),[h,m]=O.useState(!1),[p,f]=O.useState(!1),[x,g]=O.useState(null),[v,y]=O.useState(!1),j=`listing:${a.sale_id||a.asset_id}`,b=O.useCallback(()=>{l.current?.scrollIntoView({behavior:"smooth"})},[]),N=O.useCallback(async(e=!1)=>{if(e||!(o.length>0)){m(!0);try{const e=await na.getMessages({collection:j,hideSpam:!0},50);c(e)}catch(t){console.error("Error loading listing messages:",t),r("Failed to load messages")}finally{m(!1)}}},[j,o.length,r]),w=O.useCallback(async()=>{if(s&&d.trim())try{const e=await na.calculateMessageCost(d,s);g(e)}catch(e){console.error("Error calculating cost:",e)}else g(null)},[s,d]),k=async()=>{if(s&&d.trim()&&n)if(a.seller)if(a.seller!==Gt.safeGetActor(n)){f(!0);try{const e=`${j} :${a.seller}: ${d.trim()}`,t=await na.sendMessage(e,s);i("Message sent!",`Transaction: ${t.substring(0,8)}...`),u(""),g(null),setTimeout(()=>{N(!0)},2e3)}catch(e){console.error("Error sending message:",e);const t=e instanceof Error?e.message:"Unknown error";t.includes("transaction ID not found")?r("Message Status Unclear","Your message may have been sent successfully. Please check your transaction history or refresh the chat to confirm."):r("Failed to send message",t)}finally{f(!1)}}else r("You cannot message yourself");else r("Seller information not available");else r("Please connect your wallet to send messages")};return O.useEffect(()=>{e&&N()},[e,N]),O.useEffect(()=>{const e=setTimeout(w,300);return()=>clearTimeout(e)},[w]),O.useEffect(()=>{b()},[o,b]),O.useEffect(()=>{const a=e=>{"Escape"===e.key&&t()};if(e)return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[e,t]),e?Se.jsx("div",{className:"listing-chat-modal-backdrop",onClick:t,children:Se.jsxs("div",{className:"listing-chat-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"listing-chat-header",children:[Se.jsx("div",{className:"listing-chat-header-left",children:Se.jsxs("div",{className:"listing-info",children:[Se.jsx("img",{src:a.image||"/placeholder-nft.png",alt:a.name,className:"listing-nft-image"}),Se.jsxs("div",{className:"listing-details",children:[Se.jsx("h3",{className:"listing-title",children:a.name}),Se.jsxs("p",{className:"listing-seller",children:["Seller: ",a.seller]}),a.price&&Se.jsx("p",{className:"listing-price",children:a.price})]})]})}),Se.jsxs("div",{className:"listing-chat-header-right",children:[Se.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>N(!0),disabled:h,title:"Refresh messages",children:Se.jsx("span",{className:"chat_refresh-icon "+(h?"chat_refresh-icon--spinning":""),children:"\ud83d\udd04"})}),Se.jsx("button",{className:"chat_btn chat_btn--icon",onClick:t,title:"Close chat",children:"\u2715"})]})]}),Se.jsxs("div",{className:"listing-chat-messages",children:[h&&0===o.length?Se.jsx("div",{className:"chat_loading",children:"Loading messages..."}):0===o.length?Se.jsxs("div",{className:"chat_empty",children:[Se.jsx("p",{children:"No messages yet for this listing."}),Se.jsx("p",{children:"Be the first to start the conversation!"})]}):o.map(e=>Se.jsxs("div",{className:`chat_message chat_message--${e.messageType||"normal"}`,children:[Se.jsxs("div",{className:"chat_message-header",children:[Se.jsx("div",{className:"chat_message-avatar",children:Se.jsx("img",{src:`https://wax.atomichub.io/v1/accounts/${e.sender}/avatar`,alt:e.sender,className:"chat_avatar",onError:e=>{e.target.src="/default-avatar.png"}})}),Se.jsxs("div",{className:"chat_message-info",children:[Se.jsx("span",{className:"chat_sender",children:e.sender}),Se.jsx("span",{className:"chat_timestamp",children:new Date(e.timestamp).toLocaleString()}),e.pxjAmount&&Se.jsx("span",{className:"chat_amount",children:e.pxjAmount})]}),Se.jsx("div",{className:"chat_message-actions",children:e.transactionId&&Se.jsx("a",{href:`https://waxblock.io/transaction/${e.transactionId}`,target:"_blank",rel:"noopener noreferrer",className:"chat_tx-link",title:"View transaction",children:"\ud83d\udd17"})})]}),Se.jsx("div",{className:"chat_message-content",dangerouslySetInnerHTML:{__html:S(e.message)}})]},e.id)),Se.jsx("div",{ref:l})]}),Se.jsxs("div",{className:"listing-chat-input-section",children:[x&&Se.jsxs("div",{className:"chat_cost-info",children:[Se.jsxs("div",{className:"chat_cost-display",children:[Se.jsxs("span",{children:["Message Cost: ",Se.jsxs("span",{className:"chat_cost-amount",children:[(x.totalCost/1e4).toFixed(4)," PXJ"]})]}),Se.jsx("button",{className:"chat_info-btn",onClick:()=>y(!v),title:"View price breakdown",children:"\u2139\ufe0f"})]}),x.hasPixalPFP&&Se.jsxs("span",{className:"chat_discount",children:["Pixal PFP Discount: ",x.discount,"%"]}),Se.jsxs("span",{className:"chat_char-count",children:[d.length,"/240 chars"]}),v&&Se.jsx("div",{className:"chat_price-tooltip",children:Se.jsxs("div",{className:"chat_price-content",children:[Se.jsx("h4",{children:"Price Breakdown"}),Se.jsxs("div",{className:"price-factor",children:[Se.jsx("span",{children:"Base Cost:"}),Se.jsxs("span",{children:[(x.baseCost/1e4).toFixed(4)," PXJ"]})]}),Se.jsxs("div",{className:"price-factor",children:[Se.jsxs("span",{children:["Character Cost (",d.length," chars):"]}),Se.jsxs("span",{children:[((x.totalCost-x.baseCost)/1e4).toFixed(4)," PXJ"]})]}),x.hasPixalPFP&&Se.jsxs("div",{className:"price-factor discount",children:[Se.jsxs("span",{children:["Pixal PFP Discount (",x.discount,"%):"]}),Se.jsxs("span",{children:["-",((x.baseCost+(x.totalCost-x.baseCost))*(x.discount/100)/1e4).toFixed(4)," PXJ"]})]}),Se.jsxs("div",{className:"price-factor total",children:[Se.jsx("span",{children:"Total:"}),Se.jsxs("span",{children:[(x.totalCost/1e4).toFixed(4)," PXJ"]})]})]})})]}),Se.jsxs("div",{className:"listing-chat-input-wrapper",children:[Se.jsx("textarea",{className:"listing-chat-input",value:d,onChange:e=>u(e.target.value),placeholder:`Send a message about ${a.name}...`,maxLength:240,rows:3,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())}}),Se.jsx("button",{className:"listing-chat-send-btn",onClick:k,disabled:!d.trim()||p||!s,children:p?"\u23f3":"\ud83d\udce4"})]}),!s&&Se.jsx("div",{className:"listing-chat-connect-notice",children:"Please connect your wallet to send messages"})]})]})}):null},oa=e=>{const t=qe.IPFS.GATEWAYS;return`${t[Math.floor(Math.random()*t.length)]}${e}`},ca=e=>{if(!e)return;if(e.image&&"string"==typeof e.image)return e.image;let t;return e.data&&"object"==typeof e.data&&"img"in e.data&&(t=e.data.img),t||(t=e.template?.immutable_data?.img||e.img),t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?oa(t):t:void 0},da=e=>{if(!e)return null;if(e.video&&"string"==typeof e.video)return e.video;let t;return e.data&&"object"==typeof e.data&&"video"in e.data&&(t=e.data.video),t||(t=e.template?.immutable_data?.video||e.video),t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?oa(t):t:null},ua=e=>{if(!e)return;const t=e.immutable_data?.img||e.data?.img||e.img||e.template?.immutable_data?.img;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?oa(t):t:void 0},ha=e=>{if(!e)return null;const t=e.immutable_data?.video||e.data?.video||e.video||e.template?.immutable_data?.video;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?oa(t):t:null},ma=e=>{const t=e?.assets?.[0];return ca(t)},pa=e=>{const t=e?.assets?.[0];return da(t)},fa=({nft:e,isOpen:t,onClose:a,usdPrice:s})=>{const n=B(),{settings:i}=at(),[r,l]=O.useState("$0.00"),[o,c]=O.useState(!1),[d,u]=O.useState(!1),[h,m]=O.useState(!1),[p,f]=O.useState(!1),[x,g]=O.useState(!1),[v,y]=O.useState(null),{isConnected:j,purchaseNFT:b,login:N}=Fe(),{showSuccess:k,showError:_,showWarning:S}=xt(),[C,A]=O.useState(null),[T,P]=O.useState([]),[E,I]=O.useState([]);O.useEffect(()=>{(async()=>{try{const e=Kt.getSession();y(e?{...e,actor:Gt.safeGetActor(e)}:null)}catch(e){De.info("No active session","NFTDetailsModal",e)}})()},[]),O.useEffect(()=>{t&&e&&(F(),$(),L())},[t,e]);const F=async()=>{if(e?.collection)try{const t=await dt.getCollectionStats(e.collection);t&&A({floorPrice:t.floor_price||"0",volume24h:t.volume_24h||"0",totalSales:t.sales||"0",avgPrice:t.averagePrice||"0"})}catch(t){De.error("Error fetching collection stats","NFTDetailsModal",t)}},$=async()=>{if(e?.collection)try{const t=await dt.getSales({collection_name:e.collection,state:"3",limit:5,sort:"updated",order:"desc"});if(t.success&&t.data){const e=t.data.map(e=>({type:"sale",price:`${(parseFloat(e.price?.amount||"0")/Math.pow(10,e.price?.token_precision||8)).toFixed(4)} ${e.price?.token_symbol||"WAX"}`,time:new Date(1e3*parseInt(e.updated_at_time)).toLocaleString()}));P(e)}}catch(t){De.error("Error fetching recent activity","NFTDetailsModal",t)}},L=async()=>{if(e?.collection)try{const t=await dt.getCollectionPriceHistory(e.collection,"7d");I(t)}catch(t){De.error("Error fetching price history","NFTDetailsModal",t),I([])}};O.useEffect(()=>{e&&!s&&e.price&&Ke.convertWaxToUSDAsync(e.price).then(l)},[e,s]),O.useEffect(()=>{(async()=>{if(e){const t=Ze.getCart();c(t.some(t=>t.nft.asset_id===e.asset_id));const a=await wt.getWatchlist();u(a.some(t=>t.nft.asset_id===e.asset_id))}})()},[e]),O.useEffect(()=>{const t=()=>{if(e){const t=Ze.getCart();c(t.some(t=>t.nft.asset_id===e.asset_id))}};Ze.addListener(t);const a=wt.subscribe(async()=>{if(e){const t=await wt.getWatchlist();u(t.some(t=>t.nft.asset_id===e.asset_id))}});return()=>{Ze.removeListener(t),a()}},[e]);const M=()=>{e&&(a(),n(`/assets/${e.asset_id}`))};if(!t||!e)return null;return Se.jsxs("div",{className:"modal-backdrop",onClick:e=>{e.target===e.currentTarget&&a()},children:[Se.jsxs("div",{className:"modal-content nft-details-modal",children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{className:"modal-title",children:e.name}),Se.jsx("button",{className:"modal-close",onClick:a,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsx("div",{className:"modal-body",children:Se.jsx("div",{className:"nft-details-container",children:Se.jsxs("div",{className:"nft-details-top",children:[Se.jsx("div",{className:"nft-media-section",children:Se.jsxs("div",{className:"nft-media-container",children:[Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name,className:"nft-media",controls:!0,loop:!0,muted:!0,enableAnimations:i.enableAnimatedNFTs}),(e.template_mint||e.max_supply)&&Se.jsxs("div",{className:"mint-info",children:["Mint: ",void 0!==e.template_mint&&null!==e.template_mint?e.template_mint:"?"," / ","0"===e.max_supply||void 0===e.max_supply||null===e.max_supply?"\u221e":e.max_supply]})]})}),Se.jsxs("div",{className:"nft-info-section",children:[Se.jsxs("div",{className:"info-card",children:[Se.jsx("h3",{className:"info-title",children:"Basic Information"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Collection:"}),Se.jsx("span",{className:"info-value info-link",onClick:()=>{e&&(a(),n(`/collections/${e.collection}`))},title:"View collection on AtomicHub",children:e.collection})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Schema:"}),Se.jsx("span",{className:"info-value info-link",onClick:()=>{e&&window.open(`https://wax.atomichub.io/explorer/schema/wax-mainnet/${e.collection}/${e.schema}`,"_blank")},title:"View schema on AtomicHub",children:e.schema})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Asset ID:"}),Se.jsx("span",{className:"info-value info-link",onClick:M,title:"View asset on AtomicHub",children:e.asset_id})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Seller:"}),Se.jsx("span",{className:"info-value info-link",onClick:()=>{e&&e.seller&&(a(),n(`/user-profile-lookup?user=${encodeURIComponent(e.seller)}`))},title:"View seller profile",children:e.seller})]})]})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h3",{className:"info-title",children:"Price Information"}),Se.jsxs("div",{className:"price-display",children:[Se.jsx("div",{className:"price-main",children:e.price}),Se.jsx("div",{className:"price-usd",children:s||r})]})]}),e.traits&&Object.keys(e.traits).length>0&&Se.jsxs("div",{className:"info-card",children:[Se.jsx("h3",{className:"info-title",children:"Attributes"}),Se.jsx("div",{className:"attributes-grid",children:(R=e.traits,Object.entries(R).filter(([e,t])=>"img"!==e&&"video"!==e&&"name"!==e&&null!=t)).map(([e,t])=>Se.jsxs("div",{className:"attribute-item",children:[Se.jsx("div",{className:"attribute-label",children:e}),Se.jsx("div",{className:"attribute-value",children:String(t)})]},e))})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h3",{className:"info-title",children:"Statistics"}),Se.jsx("div",{className:"nft-statistics",children:Se.jsxs("div",{className:"stats-grid",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-label",children:"Floor Price"}),Se.jsx("span",{className:"stat-value",children:C?`${parseFloat(C.floorPrice).toFixed(4)} WAX`:"Loading..."})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-label",children:"24h Volume"}),Se.jsx("span",{className:"stat-value",children:C?`${parseFloat(C.volume24h).toFixed(2)} WAX`:"Loading..."})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-label",children:"Total Sales"}),Se.jsx("span",{className:"stat-value",children:C?C.totalSales:"Loading..."})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-label",children:"Avg Sale Price"}),Se.jsx("span",{className:"stat-value",children:C?`${parseFloat(C.avgPrice).toFixed(4)} WAX`:"Loading..."})]})]})})]})]}),Se.jsx("div",{className:"nft-details-bottom",children:Se.jsxs("div",{className:"info-card",children:[Se.jsx("h3",{className:"info-title",children:"Price History & Activity"}),Se.jsxs("div",{className:"nft-statistics",children:[Se.jsxs("div",{className:"price-history-section",children:[Se.jsx("h4",{className:"price-history-title",children:"Recent Price History"}),Se.jsx("div",{className:"price-history-chart",children:E.length>0?Se.jsxs("div",{className:"chart-placeholder",children:[Se.jsxs("svg",{viewBox:"0 0 400 120",className:"price-chart",children:[[0,1,2,3,4].map(e=>Se.jsx("line",{x1:"20",y1:20+20*e,x2:"380",y2:20+20*e,stroke:"var(--border-color)",strokeWidth:"1",opacity:"0.3"},`grid-${e}`)),E.length>1&&Se.jsx("polyline",{fill:"none",stroke:"var(--accent-color)",strokeWidth:"2",points:E.map((e,t)=>{const a=20+t/(E.length-1)*360,s=Math.max(...E.map(e=>e.price)),n=Math.min(...E.map(e=>e.price)),i=s-n||1;return`${a},${100-(e.price-n)/i*60}`}).join(" ")}),E.map((e,t)=>{const a=20+t/(E.length-1)*360,s=Math.max(...E.map(e=>e.price)),n=Math.min(...E.map(e=>e.price)),i=s-n||1,r=100-(e.price-n)/i*60;return Se.jsx("circle",{cx:a,cy:r,r:"3",fill:"var(--accent-color)"},t)})]}),Se.jsxs("div",{className:"chart-labels",children:[Se.jsx("span",{children:E.length>0?new Date(E[0].timestamp).toLocaleDateString():"7d ago"}),Se.jsx("span",{children:E.length>0?new Date(E[E.length-1].timestamp).toLocaleDateString():"Now"})]})]}):Se.jsx("div",{className:"chart-placeholder",children:Se.jsx("div",{className:"loading-chart",children:"Loading price history..."})})})]}),Se.jsxs("div",{className:"trading-activity",children:[Se.jsx("h4",{className:"activity-title",children:"Recent Activity"}),Se.jsx("div",{className:"activity-list",children:T.length>0?T.map((e,t)=>Se.jsxs("div",{className:"activity-item",children:[Se.jsx("span",{className:`activity-type ${e.type}`,children:"sale"===e.type?"Sale":"Listed"}),Se.jsx("span",{className:"activity-price",children:e.price}),Se.jsx("span",{className:"activity-time",children:e.time})]},t)):Se.jsxs("div",{className:"activity-item",children:[Se.jsx("span",{className:"activity-type",children:"Loading..."}),Se.jsx("span",{className:"activity-price",children:"-"}),Se.jsx("span",{className:"activity-time",children:"-"})]})})]})]})]})})]})})}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("div",{className:"modal-actions-left",children:e.sale_id?Se.jsxs(Se.Fragment,{children:[Se.jsxs("button",{className:"listing-btn-buy-now",onClick:async()=>{if(!j)try{await N()}catch(t){return void De.error("Login failed","NFTDetailsModal",t)}if(e.sale_id)if(e.sale_id&&e.price)try{const t=e.price.replace(" WAX","");await b(e.sale_id,t),k("Purchase successful!"),a()}catch(t){De.error("Purchase failed","NFTDetailsModal",t),_("Purchase failed. Please try again.")}else _("NFT is not available for purchase");else S("This NFT is not for sale")},title:`Buy now for ${e.price} WAX`,children:[Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:Se.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Buy Now"]}),Se.jsxs("button",{className:"btn-secondary",onClick:()=>f(!0),title:"Make Offer",children:[Se.jsx("svg",{viewBox:"0 -8 72 72",fill:"currentColor",style:{width:"24px",height:"24px",marginRight:"8px"},children:Se.jsx("path",{d:"M64,12.78v17s-3.63.71-4.38.81-3.08.85-4.78-.78C52.22,27.25,42.93,18,42.93,18a3.54,3.54,0,0,0-4.18-.21c-2.36,1.24-5.87,3.07-7.33,3.78a3.37,3.37,0,0,1-5.06-2.64,3.44,3.44,0,0,1,2.1-3c3.33-2,10.36-6,13.29-7.52,1.78-1,3.06-1,5.51,1C50.27,12,53,14.27,53,14.27a2.75,2.75,0,0,0,2.26.43C58.63,14,64,12.78,64,12.78ZM27,41.5a3,3,0,0,0-3.55-4.09,3.07,3.07,0,0,0-.64-3,3.13,3.13,0,0,0-3-.75,3.07,3.07,0,0,0-.65-3,3.38,3.38,0,0,0-4.72.13c-1.38,1.32-2.27,3.72-1,5.14s2.64.55,3.72.3c-.3,1.07-1.2,2.07-.09,3.47s2.64.55,3.72.3c-.3,1.07-1.16,2.16-.1,3.46s2.84.61,4,.25c-.45,1.15-1.41,2.39-.18,3.79s4.08.75,5.47-.58a3.32,3.32,0,0,0,.3-4.68A3.18,3.18,0,0,0,27,41.5Zm25.35-8.82L41.62,22a3.53,3.53,0,0,0-3.77-.68c-1.5.66-3.43,1.56-4.89,2.24a8.15,8.15,0,0,1-3.29,1.1,5.59,5.59,0,0,1-3-10.34C29,12.73,34.09,10,34.09,10a6.46,6.46,0,0,0-5-2C25.67,8,18.51,12.7,18.51,12.7a5.61,5.61,0,0,1-4.93.13L8,10.89v19.4s1.59.46,3,1a6.33,6.33,0,0,1,1.56-2.47,6.17,6.17,0,0,1,8.48-.06,5.4,5.4,0,0,1,1.34,2.37,5.49,5.49,0,0,1,2.29,1.4A5.4,5.4,0,0,1,26,34.94a5.47,5.47,0,0,1,3.71,4,5.38,5.38,0,0,1,2.39,1.43,5.65,5.65,0,0,1,1.48,4.89a0,0,0,0,1,0,0s.8.9,1.29,1.39a2.46,2.46,0,0,0,3.48-3.48s2,2.48,4.28,1c2-1.4,1.69-3.06.74-4a3.19,3.19,0,0,0,4.77.13,2.45,2.45,0,0,0,.13-3.3s1.33,1.81,4,.12c1.89-1.6,1-3.43,0-4.39Z"})}),"Make Offer"]}),Se.jsx("button",{className:"btn-secondary "+(o?"in-cart":""),onClick:()=>{if(o)Ze.removeFromCart(e.asset_id);else{Ze.addToCart(e)||S("Item is already in your cart!")}},title:o?"Remove from cart":"Add to cart",children:Se.jsxs("div",{className:"cart-icon-container",children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"cart-icon",children:[Se.jsx("circle",{cx:"9",cy:"21",r:"1"}),Se.jsx("circle",{cx:"20",cy:"21",r:"1"}),Se.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"cart-action-icon",children:o?Se.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}):Se.jsxs(Se.Fragment,{children:[Se.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),Se.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})]}):Se.jsxs("button",{className:"btn-disabled",disabled:!0,children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("line",{x1:"4.93",y1:"4.93",x2:"19.07",y2:"19.07"})]}),"Not Available"]})}),Se.jsxs("div",{className:"modal-actions-right",children:[Se.jsx("button",{className:"btn-icon btn-external",onClick:M,title:"View full asset details page",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),Se.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),e?.seller&&Se.jsx("button",{className:"btn-icon btn-message",onClick:()=>{g(!0)},title:"Send Direct Message (1000 PXJ)",disabled:!v||e.seller===v?.actor,children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),Se.jsx("button",{className:"btn-icon "+(d?"in-watchlist":""),onClick:async()=>{if(d)await wt.removeFromWatchlist(e.asset_id);else{await wt.addToWatchlist(e)||S("Item is already in your watchlist!")}},title:d?"Remove from watchlist":"Add to watchlist",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:d?Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:"currentColor"}):Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),Se.jsx("button",{className:"btn-icon",onClick:()=>m(!0),title:"Share",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),Se.jsx("polyline",{points:"16,6 12,2 8,6"}),Se.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})}),Se.jsx("button",{className:"btn-icon",onClick:a,title:"Close",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]})]}),h&&Se.jsx(sa,{isOpen:h,onClose:()=>m(!1),title:e?.name||"NFT",description:`Check out this amazing NFT: ${e?.name||"Unnamed NFT"}`,imageUrl:ca(e),shareUrl:`${window.location.origin}/assets/${e?.asset_id}`,defaultShareText:`Check out this NFT: ${e?.name||"Unnamed NFT"} on PxMarket! \ud83c\udfae\u2728 View it at market.pixeljourney.xyz`,type:"nft"}),Se.jsx(w,{isOpen:p,onClose:()=>f(!1),nft:e}),e&&Se.jsx(la,{isOpen:x,onClose:()=>g(!1),nft:e})]});var R},xa=({isOpen:e,onClose:t,initialNFTs:a=[]})=>{const[s,n]=O.useState(a),[i,r]=O.useState(""),[l,o]=O.useState([]),[c,d]=O.useState(!1),{showWarning:u}=xt(),[h,m]=O.useState({showPrice:!0,showRarity:!0,showAttributes:!0,showCollection:!0,showSeller:!0});O.useEffect(()=>{a.length>0&&n(a)},[a]);const p=e=>{if(!e)return"#666";switch(e.toLowerCase()){case"common":return"#9CA3AF";case"rare":return"#3B82F6";case"epic":return"#8B5CF6";case"legendary":return"#F59E0B";case"mythic":return"#EF4444";default:return"#666"}},f=(e,t)=>{if(!e.traits)return"N/A";return e.traits[t]||"N/A"};return e?Se.jsx("div",{className:"nft-comparison-overlay",children:Se.jsxs("div",{className:"nft-comparison-modal",children:[Se.jsxs("div",{className:"comparison-header",children:[Se.jsx("h2",{children:"NFT Comparison Tool"}),Se.jsx("button",{className:"close-btn",onClick:t,children:Se.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se.jsxs("div",{className:"comparison-content",children:[Se.jsxs("div",{className:"search-section",children:[Se.jsxs("div",{className:"search-input-container",children:[Se.jsx("input",{type:"text",placeholder:"Search NFTs to add to comparison...",value:i,onChange:e=>{r(e.target.value),(async e=>{if(e.trim()){d(!0);try{const[t,a,s]=await Promise.all([dt.getWaxRockPixals(20),dt.getFriedFactoryNFTs(20),dt.getCryptoMuffinsNFTs(20)]),n=[...t,...a,...s].filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.collection.toLowerCase().includes(e.toLowerCase()));o(n.slice(0,10))}catch(t){console.error("Error searching NFTs:",t),o([])}finally{d(!1)}}else o([])})(e.target.value)},className:"search-input"}),c&&Se.jsx("div",{className:"search-loading",children:"Searching..."})]}),l.length>0&&Se.jsx("div",{className:"search-results",children:l.map(e=>Se.jsxs("div",{className:"search-result-item",onClick:()=>(e=>{s.length>=4?u("You can compare up to 4 NFTs at once","Comparison Limit"):s.find(t=>t.asset_id===e.asset_id)?u("This NFT is already in the comparison","Duplicate NFT"):(n([...s,e]),r(""),o([]))})(e),children:[Se.jsx("img",{src:e.image,alt:e.name,className:"result-image"}),Se.jsxs("div",{className:"result-info",children:[Se.jsx("div",{className:"result-name",children:e.name}),Se.jsx("div",{className:"result-collection",children:e.collection}),Se.jsx("div",{className:"result-price",children:e.price})]})]},e.asset_id))})]}),Se.jsxs("div",{className:"metrics-toggle",children:[Se.jsx("h3",{children:"Show Comparison Metrics:"}),Se.jsx("div",{className:"toggle-buttons",children:Object.entries(h).map(([e,t])=>Se.jsx("button",{className:"toggle-btn "+(t?"active":""),onClick:()=>{return t=e,void m(e=>({...e,[t]:!e[t]}));var t},children:e.replace("show","").replace(/([A-Z])/g," $1").trim()},e))})]}),s.length>0?Se.jsx("div",{className:"comparison-table",children:Se.jsxs("div",{className:"comparison-grid",children:[Se.jsxs("div",{className:"comparison-row header-row",children:[Se.jsx("div",{className:"metric-label",children:"NFT"}),s.map(e=>Se.jsx("div",{className:"nft-column",children:Se.jsxs("div",{className:"nft-header",children:[Se.jsx("img",{src:e.image,alt:e.name,className:"nft-image"}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("div",{className:"nft-name",children:e.name}),Se.jsxs("div",{className:"nft-id",children:["#",e.asset_id]})]}),Se.jsx("button",{className:"remove-nft-btn",onClick:()=>{return t=e.asset_id,void n(s.filter(e=>e.asset_id!==t));var t},title:"Remove from comparison",children:"\xd7"})]})},e.asset_id))]}),h.showPrice&&Se.jsxs("div",{className:"comparison-row",children:[Se.jsx("div",{className:"metric-label",children:"Price"}),s.map(e=>Se.jsx("div",{className:"metric-value price",children:e.price},e.asset_id))]}),h.showRarity&&Se.jsxs("div",{className:"comparison-row",children:[Se.jsx("div",{className:"metric-label",children:"Rarity"}),s.map(e=>Se.jsx("div",{className:"metric-value rarity",children:Se.jsx("span",{className:"rarity-badge",style:{backgroundColor:p(String(e.traits?.rarity||"Unknown"))},children:e.traits?.rarity||"Unknown"})},e.asset_id))]}),h.showCollection&&Se.jsxs("div",{className:"comparison-row",children:[Se.jsx("div",{className:"metric-label",children:"Collection"}),s.map(e=>Se.jsx("div",{className:"metric-value",children:e.collection},e.asset_id))]}),h.showSeller&&Se.jsxs("div",{className:"comparison-row",children:[Se.jsx("div",{className:"metric-label",children:"Seller"}),s.map(e=>Se.jsx("div",{className:"metric-value",children:e.seller},e.asset_id))]}),h.showAttributes&&(()=>{const e=new Set;return s.forEach(t=>{t.traits&&Object.keys(t.traits).forEach(t=>{"rarity"!==t&&e.add(t)})}),Array.from(e)})().map(e=>Se.jsxs("div",{className:"comparison-row",children:[Se.jsx("div",{className:"metric-label",children:e}),s.map(t=>Se.jsx("div",{className:"metric-value",children:f(t,e)},t.asset_id))]},e))]})}):Se.jsxs("div",{className:"empty-comparison",children:[Se.jsx("div",{className:"empty-icon",children:"\ud83d\udcca"}),Se.jsx("h3",{children:"No NFTs to Compare"}),Se.jsx("p",{children:"Search and add NFTs above to start comparing their attributes, prices, and more."})]})]})]})}):null},ga=({nft:e,isOpen:t,onClose:a})=>{const[s,n]=O.useState(!1),[i,r]=O.useState(""),{showSuccess:l}=xt(),o=[`\ud83c\udfa8 Check out this amazing NFT: ${e.name} from ${e.collection}! \u2728`,`\ud83d\udd25 Discovered this incredible ${e.name} NFT! Part of the ${e.collection} collection \ud83d\ude80`,`\u2728 Look at this stunning ${e.name} from ${e.collection}! NFT art at its finest \ud83c\udfad`,`\ud83c\udf1f Found a gem! ${e.name} from the ${e.collection} collection is absolutely beautiful \ud83d\udc8e`,`\ud83c\udfaf This ${e.name} NFT caught my eye! Amazing work from ${e.collection} \ud83c\udfa8`,`\ud83d\udcab Showcasing ${e.name} - a masterpiece from ${e.collection}! \ud83d\uddbc\ufe0f`,`\ud83d\ude80 Blown away by this ${e.name} NFT! ${e.collection} never disappoints \u2b50`,`\ud83c\udfaa Step right up and see ${e.name}! Another fantastic piece from ${e.collection} \ud83c\udf8a`],c=()=>{const e=Math.floor(Math.random()*o.length);return o[e]},[d,u]=O.useState(()=>c());if(!t)return null;const h=window.location.pathname;let m=`${window.location.origin}/assets/${e.asset_id}`;h.includes("/listings/")&&(m=window.location.href);const p=async e=>{try{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)}catch(t){De.error("Failed to copy to clipboard","SocialShare.copyToClipboard",t)}};return Se.jsx("div",{className:"social-share-overlay",onClick:a,children:Se.jsxs("div",{className:"social-share-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"share-header",children:[Se.jsx("h3",{children:"Share NFT"}),Se.jsx("button",{className:"close-btn",onClick:a,children:Se.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se.jsxs("div",{className:"share-content",children:[Se.jsxs("div",{className:"nft-preview",children:[Se.jsx("img",{src:e.image,alt:e.name,className:"nft-image"}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h4",{children:e.name}),Se.jsx("p",{children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),Se.jsx("span",{className:"nft-price",children:e.price})]})]}),Se.jsxs("div",{className:"share-text-section",children:[Se.jsxs("div",{className:"share-text-header",children:[Se.jsx("label",{htmlFor:"share-text",children:"Customize your message:"}),Se.jsx("button",{className:"refresh-message-btn",onClick:()=>{u(c())},title:"Generate new random message",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),Se.jsx("textarea",{id:"share-text",value:i,onChange:e=>r(e.target.value),placeholder:d,className:"share-textarea",rows:3})]}),Se.jsxs("div",{className:"share-url-section",children:[Se.jsx("label",{children:"Share URL:"}),Se.jsxs("div",{className:"url-input-container",children:[Se.jsx("input",{type:"text",value:m,readOnly:!0,className:"url-input"}),Se.jsxs("button",{className:"copy-btn "+(s?"copied":""),onClick:()=>p(m),children:[s?Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):Se.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),Se.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),s?"Copied!":"Copy"]})]})]}),Se.jsxs("div",{className:"social-buttons",children:[Se.jsxs("button",{className:"social-btn twitter",onClick:()=>{const e=`https://twitter.com/intent/tweet?text=${encodeURIComponent(i||d)}&url=${encodeURIComponent(m)}&hashtags=NFT,WAX,PixelJourney`;window.open(e,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),"Twitter"]}),Se.jsxs("button",{className:"social-btn facebook",onClick:()=>{const e=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(m)}`;window.open(e,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),Se.jsxs("button",{className:"social-btn reddit",onClick:()=>{const e=i||d,t=`https://reddit.com/submit?url=${encodeURIComponent(m)}&title=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),Se.jsxs("button",{className:"social-btn discord",onClick:()=>{p(`${i||d}\n${m}`),l("Share text copied to clipboard! You can now paste it in Discord.","Copied to Clipboard")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})}),"Discord"]}),Se.jsxs("button",{className:"social-btn telegram",onClick:()=>{const e=i||d,t=`https://t.me/share/url?url=${encodeURIComponent(m)}&text=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Telegram"]}),Se.jsxs("button",{className:"social-btn email",onClick:()=>{const t=`Check out this NFT: ${e.name}`,a=`${i||d}\n\nView it here: ${m}`,s=`mailto:?subject=${encodeURIComponent(t)}&body=${encodeURIComponent(a)}`;window.location.href=s},children:[Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]})]})]})]})})},va=({title:e,message:t,onRetry:a,showRetry:s=!0,error:n,errorConfig:i,errorType:r,isRetrying:l=!1,retryCount:o=0,maxRetries:c=3})=>{let d;d=i||(r?Le.getMessage(r):n?Le.formatError(n):{title:e||"Oh no! Something went wrong",message:t||"We're having trouble loading the data right now. Please try again in a moment.",action:"Try Again"});const u=e||d.title,h=t||d.message,m=l?"Retrying...":d.action||"Try Again";return Se.jsx("div",{className:"error-message "+(l?"retrying":""),children:Se.jsxs("div",{className:"error-content",children:[Se.jsx("div",{className:"error-icon "+(l?"spinning":""),children:(()=>{if(l)return"\ud83d\udd04";switch(r){case"NETWORK_ERROR":return"\ud83d\udce1";case"TIMEOUT_ERROR":return"\u23f1\ufe0f";case"API_ERROR":return"\u26a0\ufe0f";case"LOAD_FAILED":return"\ud83d\udcc2";default:return"\ud83d\ude05"}})()}),Se.jsx("h3",{className:"error-title",children:u}),Se.jsx("p",{className:"error-text",children:h}),o>0&&!l&&Se.jsx("div",{className:"retry-status",children:Se.jsxs("span",{className:"retry-count",children:["Attempt ",o," of ",c]})}),s&&a&&Se.jsxs("button",{className:"error-retry-btn "+(l?"retrying":""),onClick:a,disabled:l||o>=c,children:[l&&Se.jsx("span",{className:"retry-spinner"}),m]}),o>=c&&Se.jsxs("div",{className:"max-retries-reached",children:[Se.jsx("p",{children:"Maximum retry attempts reached. Please refresh the page or try again later."}),Se.jsx("button",{className:"error-refresh-btn",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})})},ya="pixeljourney_search_history",ja=({searchTerm:e,onSearchChange:t,suggestions:a=[],placeholder:s="Search NFTs, collections, schemas...",showFilters:n=!1,onFilterChange:i,className:r=""})=>{const[l,o]=O.useState(!1),[c,d]=O.useState([]),[u,h]=O.useState({priceRange:{min:"",max:""},rarities:[],collections:[],schemas:[],sortBy:"relevance"}),[m,p]=O.useState(!1),f=O.useRef(null),x=O.useRef(null),[g,v]=O.useState(-1);O.useEffect(()=>{const e=localStorage.getItem(ya);if(e)try{d(JSON.parse(e))}catch(t){console.error("Failed to parse search history:",t)}},[]);const y=O.useCallback(e=>{if(!e.trim()||e.length<2)return;const t=[e,...c.filter(t=>t!==e)].slice(0,10);d(t),localStorage.setItem(ya,JSON.stringify(t))},[c]),j=O.useCallback(()=>{d([]),localStorage.removeItem(ya)},[]),b=O.useCallback(e=>{t(e),v(-1),e.length>=2?o(!0):o(!1)},[t]),N=O.useCallback(()=>{e.trim()&&(y(e.trim()),o(!1),f.current?.blur())},[e,y]),w=O.useCallback(e=>{b(e.text),y(e.text),o(!1)},[b,y]),k=O.useCallback(e=>{if(!l)return;const t=[...c.map(e=>({text:e,type:"history"})),...a];switch(e.key){case"ArrowDown":e.preventDefault(),v(e=>e<t.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),v(e=>e>-1?e-1:-1);break;case"Enter":e.preventDefault(),g>=0&&t[g]?w(t[g]):N();break;case"Escape":o(!1),v(-1),f.current?.blur()}},[l,c,a,g,w,N]),_=O.useCallback(e=>{const t={...u,...e};h(t),i?.(t)},[u,i]);O.useEffect(()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&f.current&&!f.current.contains(e.target)&&(o(!1),v(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const S=[...c.map(e=>({text:e,type:"history"})),...a];return Se.jsxs("div",{className:`advanced-search ${r}`,children:[Se.jsxs("div",{className:"search-container",children:[Se.jsxs("div",{className:"search-input-wrapper",children:[Se.jsx("svg",{className:"search-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Se.jsx("input",{ref:f,type:"text",value:e,onChange:e=>b(e.target.value),onKeyDown:k,onFocus:()=>{(e.length>=2||c.length>0)&&o(!0)},placeholder:s,className:"search-input","aria-label":"Search for NFTs, collections, or schemas","aria-describedby":l?"search-suggestions":void 0,"aria-expanded":l,"aria-autocomplete":"list",role:"combobox"}),e&&Se.jsx("button",{className:"clear-search",onClick:()=>{b(""),o(!1)},title:"Clear search","aria-label":"Clear search input",type:"button",children:Se.jsx("span",{"aria-hidden":"true",children:"\u2715"})}),n&&Se.jsx("button",{className:"filter-toggle "+(m?"active":""),onClick:()=>p(!m),title:"Advanced filters","aria-label":m?"Hide advanced filters":"Show advanced filters","aria-expanded":m,type:"button",children:Se.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]}),l&&S.length>0&&Se.jsxs("div",{ref:x,className:"search-suggestions",id:"search-suggestions",role:"listbox","aria-label":"Search suggestions",children:[c.length>0&&Se.jsxs("div",{className:"suggestions-section",children:[Se.jsxs("div",{className:"suggestions-header",children:[Se.jsx("span",{id:"recent-searches-label",children:"Recent searches"}),Se.jsx("button",{onClick:j,className:"clear-history","aria-label":"Clear search history",type:"button",children:"Clear"})]}),Se.jsx("div",{role:"group","aria-labelledby":"recent-searches-label",children:c.map((e,t)=>Se.jsxs("div",{className:"suggestion-item history "+(g===t?"selected":""),onClick:()=>w({text:e,type:"history"}),role:"option","aria-selected":g===t,tabIndex:-1,children:[Se.jsx("svg",{className:"suggestion-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Se.jsx("span",{children:e})]},`history-${t}`))})]}),a.length>0&&Se.jsxs("div",{className:"suggestions-section",children:[c.length>0&&Se.jsx("div",{className:"suggestions-divider"}),Se.jsx("div",{className:"suggestions-header",children:Se.jsx("span",{children:"Suggestions"})}),a.map((e,t)=>{const a=c.length+t;return Se.jsxs("div",{className:`suggestion-item ${e.type} ${g===a?"selected":""}`,onClick:()=>w(e),children:[Se.jsxs("svg",{className:"suggestion-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:["name"===e.type&&Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"}),"collection"===e.type&&Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}),"schema"===e.type&&Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]}),Se.jsx("span",{children:e.text}),e.count&&Se.jsx("span",{className:"suggestion-count",children:e.count})]},`suggestion-${t}`)})]})]})]}),n&&m&&Se.jsxs("div",{className:"advanced-filters",children:[Se.jsxs("div",{className:"filters-grid",children:[Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{className:"filter-label",children:"Price Range (WAX)"}),Se.jsxs("div",{className:"price-range",children:[Se.jsx("input",{type:"number",placeholder:"Min",value:u.priceRange.min,onChange:e=>_({priceRange:{...u.priceRange,min:e.target.value}}),className:"price-input"}),Se.jsx("span",{className:"price-separator",children:"to"}),Se.jsx("input",{type:"number",placeholder:"Max",value:u.priceRange.max,onChange:e=>_({priceRange:{...u.priceRange,max:e.target.value}}),className:"price-input"})]})]}),Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{className:"filter-label",children:"Sort By"}),Se.jsxs("select",{value:u.sortBy,onChange:e=>_({sortBy:e.target.value}),className:"filter-select",children:[Se.jsx("option",{value:"relevance",children:"Relevance"}),Se.jsx("option",{value:"price_asc",children:"Price: Low to High"}),Se.jsx("option",{value:"price_desc",children:"Price: High to Low"}),Se.jsx("option",{value:"name_asc",children:"Name: A to Z"}),Se.jsx("option",{value:"name_desc",children:"Name: Z to A"}),Se.jsx("option",{value:"newest",children:"Newest First"}),Se.jsx("option",{value:"oldest",children:"Oldest First"})]})]})]}),Se.jsx("div",{className:"filter-actions",children:Se.jsx("button",{onClick:()=>{const e={priceRange:{min:"",max:""},rarities:[],collections:[],schemas:[],sortBy:"relevance"};h(e),i?.(e)},className:"filter-reset",children:"Reset Filters"})})]})]})},ba=D.memo(()=>{const e=B(),{settings:t}=at(),{showSuccess:a,showError:s,showWarning:n}=xt(),[i,r]=O.useState([]),[l,o]=O.useState("idle"),[c,d]=O.useState(""),[u,h]=O.useState("pixals"),[m,p]=O.useState({}),[f,x]=O.useState(null),[g,v]=O.useState(!1),[y,j]=O.useState(new Set),[b,N]=O.useState(new Set),[k,_]=O.useState(1),[S,C]=O.useState(1),[A,T]=O.useState([]),[P,E]=O.useState(!1),[I,F]=O.useState({min:"",max:""}),[$,L]=O.useState(new Set),[M,R]=O.useState("price_asc"),[W,D]=O.useState({start:"",end:""}),[U,z]=O.useState([]),[X,H]=O.useState([]),[q,J]=O.useState([]),[V,G]=O.useState(new Set),[K,Y]=O.useState(new Map),[Q,Z]=O.useState(new Map),[ee,te]=O.useState(new Set),[ae,se]=O.useState(new Set),[ne,ie]=O.useState(!1),[re,le]=O.useState(!1),[oe,ce]=O.useState(null),[de,ue]=O.useState(!1),[he,me]=O.useState(null),[pe,fe]=O.useState(!1),[xe,ge]=O.useState(null),[ve,ye]=O.useState(!1),[je,be]=O.useState(new Set),[Ne,we]=O.useState(null),[ke,_e]=O.useState(!1),Ce=O.useCallback(e=>{be(t=>{const a=new Set(t);return a.has(e)?a.delete(e):(a.clear(),a.add(e)),a})},[]),Ae=O.useCallback(()=>{be(new Set)},[]),Te=O.useCallback((e,t,a)=>{const s=t||e,n=t?"video":"image";let i=s;s.startsWith("Qm")||s.startsWith("baf")?i=`https://ipfs.io/ipfs/${s}`:s.startsWith("/ipfs/")?i=`https://ipfs.io${s}`:s.startsWith("ipfs://")&&(i=s.replace("ipfs://","https://ipfs.io/ipfs/")),we({url:i,name:a,type:n}),_e(!0)},[]);O.useEffect(()=>{const e=()=>{Ae()};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[Ae]);const Pe=async(e,t=1)=>{1===t?(o("loading"),_(1),T([])):ie(!0);try{let a=[];const s=50;switch(e){case"pixals":default:a=await dt.getCheapestPixals(s,t);break;case"waxrocks":a=await dt.getWaxRockPixals(s,t);break;case"ingredients":a=await dt.getPixelIngredients(s,t);break;case"bundles":a=await dt.getBundleListings(s,t);break;case"friedfactory":a=await dt.getFriedFactoryNFTs(s,t);break;case"crptomuffins":a=await dt.getCryptoMuffinsNFTs(s,t);break;case"akufishheads":a=await dt.getAkufishheadsNFTs(s,t);break;case"partners":a=await dt.getPartnerListings(s,t);break;case"pxapproved":a=await dt.getPxApprovedListings(s,t);break;case"ah_verified":a=await dt.getAHVerifiedListings(s,t);break;case"all_wax":a=await dt.getAllWaxListings(s,t)}1===t?T(a):(T(e=>[...e,...a]),_(t)),a.length<s?C(t):C(t+1),o("success"),ie(!1)}catch(a){const e=a instanceof Error?a:new Error("Failed to load marketplace data");Le.logError("Marketplace.loadMarketplaceData",e,{category:u,page:t,limit:50}),o("error"),ie(!1)}},Ee=O.useCallback(async()=>{try{const e=(await dt.getCollectionSchemas("pixeljourney")).map(e=>e.schema_name);J(e)}catch(e){De.error("Failed to load available schemas","Marketplace",e),J([])}},[]);O.useEffect(()=>{Pe(u),Ee()},[u,Ee]);const Ie=O.useCallback(async e=>{const t={},a=e.filter(e=>e.price&&!m[e.asset_id]);if(0===a.length)return;for(let s=0;s<a.length;s+=10){const e=a.slice(s,s+10);(await Promise.allSettled(e.map(async e=>{const t=await Ke.convertWaxToUSDAsync(e.price);return{assetId:e.asset_id,price:t}}))).forEach(e=>{"fulfilled"===e.status&&e.value&&(t[e.value.assetId]=e.value.price)}),s+10<a.length&&await new Promise(e=>setTimeout(e,50))}p(e=>({...e,...t}))},[]);O.useEffect(()=>{i.length>0&&Ie(i)},[i,Ie]);const $e=O.useCallback(e=>{if(!e||e.length<2)return void z([]);const t=new Map,a=e.toLowerCase();A.forEach(e=>{if(e.name.toLowerCase().includes(a)){const a=`name:${e.name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.name,type:"name",count:1})}if(e.collection.toLowerCase().includes(a)){const a=`collection:${e.collection}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.collection,type:"collection",count:1})}});const s=Array.from(t.values()).sort((e,t)=>(t.count||0)-(e.count||0)).slice(0,8);z(s)},[A]),Me=O.useCallback(e=>{F(e.priceRange),R(e.sortBy)},[]);O.useEffect(()=>{$e(c)},[c,$e]),O.useEffect(()=>{const e=()=>{const e=Ze.getCart();j(new Set(e.map(e=>e.nft.asset_id)))};return e(),Ze.addListener(e),()=>Ze.removeListener(e)},[]),O.useEffect(()=>{(async()=>{const e=await wt.getWatchlist();se(new Set(e.map(e=>e.nft.asset_id)))})(),wt.addListener(e=>{se(new Set(e.map(e=>e.nft.asset_id)))})},[]);const Re=O.useCallback(()=>{k<S&&!ne&&Pe(u,k+1)},[u,k,S,ne]),We=()=>{E(!1)},Oe=O.useCallback(e=>{const t=new Set($);if(t.has(e))t.delete(e);else{t.add(e);const a=new Set(ee);a.add("schemas"),te(a)}L(t)},[$,ee]),Ue=O.useCallback(e=>{const t=new Set(V);if(t.has(e))t.delete(e);else{t.add(e);const a=new Set(ee);a.add("collections"),te(a)}G(t)},[V,ee]),Be=O.useCallback((e,t)=>{const a=new Map(K),s=a.get(e)||new Set,n=new Set(s);if(n.has(t)?n.delete(t):n.add(t),n.size>0){a.set(e,n);const t=new Set(ee);t.add("attributes"),te(t)}else a.delete(e);Y(a)},[K,ee]),ze=O.useCallback(e=>{const t=new Set(ee);t.has(e)?t.delete(e):t.add(e),te(t)},[ee]),Xe=O.useMemo(()=>{let e=[...A];if(c){const t=c.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.collection.toLowerCase().includes(t)||e.schema&&e.schema.toLowerCase().includes(t))}return(I.min||I.max)&&(e=e.filter(e=>{if(!e.price)return!1;const t=parseFloat(e.price),a=I.min?parseFloat(I.min):0,s=I.max?parseFloat(I.max):1/0;return t>=a&&t<=s})),$.size>0&&(e=e.filter(e=>e.schema&&$.has(e.schema))),V.size>0&&(e=e.filter(e=>V.has(e.collection))),K.size>0&&(e=e.filter(e=>{if(!e.data||!e.data.attributes||!Array.isArray(e.data.attributes))return!1;for(const[t,a]of K){const s=e.data.attributes.find(e=>e.key===t);if(!s||!a.has(s.value))return!1}return!0})),e.sort((e,t)=>{switch(M){case"price_asc":return parseFloat(e.price||"0")-parseFloat(t.price||"0");case"price_desc":return parseFloat(t.price||"0")-parseFloat(e.price||"0");case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"newest":return new Date(t.created_at_time||0).getTime()-new Date(e.created_at_time||0).getTime();case"oldest":return new Date(e.created_at_time||0).getTime()-new Date(t.created_at_time||0).getTime();default:return 0}}),e},[A,c,I,$,V,K,M]);O.useEffect(()=>{r(Xe)},[Xe]),O.useEffect(()=>{const e=new Map;let t=A;V.size>0&&(t=t.filter(e=>V.has(e.collection))),$.size>0&&(t=t.filter(e=>e.schema&&$.has(e.schema))),t.forEach(t=>{t.data&&t.data.attributes&&Array.isArray(t.data.attributes)&&t.data.attributes.forEach(t=>{e.has(t.key)||e.set(t.key,[]);const a=e.get(t.key);a.includes(t.value)||a.push(t.value)})}),e.forEach(e=>{e.sort()}),Z(e),Y(t=>{const a=new Map;return t.forEach((t,s)=>{if(e.has(s)){const n=e.get(s),i=new Set;t.forEach(e=>{n.includes(e)&&i.add(e)}),i.size>0&&a.set(s,i)}}),a})},[A,V,$]),O.useEffect(()=>{if(V.size>0){const e=[...new Set(A.filter(e=>V.has(e.collection)).map(e=>e.schema).filter(e=>e))].sort();J(e),L(t=>{const a=new Set;return t.forEach(t=>{e.includes(t)&&a.add(t)}),a})}else{const e=[...new Set(A.map(e=>e.schema).filter(e=>e))].sort();J(e)}},[A,V]);const He=O.useCallback(e=>{let t=[...e];return(I.min||I.max)&&(t=t.filter(e=>{if(!e.price)return!1;const t=parseFloat(e.price.replace(" WAX","")),a=I.min?parseFloat(I.min):0,s=I.max?parseFloat(I.max):1/0;return t>=a&&t<=s})),$.size>0&&(t=t.filter(e=>$.has(e.schema))),V.size>0&&(t=t.filter(e=>V.has(e.collection))),W.start||W.end,t.sort((e,t)=>{const a=e.price?parseFloat(e.price.replace(" WAX","")):0,s=t.price?parseFloat(t.price.replace(" WAX","")):0;switch(M){case"price_asc":return a-s;case"price_desc":return s-a;case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"date_newest":return 0-0;case"date_oldest":return 0-0;default:return 0}}),t},[I,$,V,M]);O.useEffect(()=>{const e=Array.from(new Set(A.map(e=>e.collection)));H(e)},[A]),O.useEffect(()=>{let e=A.filter(e=>e.name.toLowerCase().includes(c.toLowerCase())||("string"==typeof e.collection?e.collection.toLowerCase():"").includes(c.toLowerCase()));e=He(e),r(e)},[A,c,I,$,V,W,M,He]);const{purchaseNFT:qe}=Fe(),Je=O.useCallback(async e=>{try{if(!Kt.isLoggedIn())return void n("Please connect your wallet to purchase NFTs");if(De.debug("Purchasing NFT","Marketplace",{nft:e}),!e.sale_id||!e.price)return void s("Purchase Error","NFT is not available for purchase");await qe(e.sale_id,e.price.replace(" WAX","")),a(`Successfully purchased ${e.name}!`),Pe(u)}catch(t){De.error("Purchase failed","Marketplace",t instanceof Error?t:new Error(String(t))),s(`Purchase failed: ${t instanceof Error?t.message:"Unknown error"}`)}},[u,n,a,s,Pe]),Ve=O.useCallback(t=>{e(`/user-profile-lookup?user=${encodeURIComponent(t)}`)},[e]),Ge=O.useCallback(t=>{e(`/collections/${encodeURIComponent(t)}`)},[e]),Ye=O.useCallback(t=>{b.size>0?Qe(t.asset_id):t.sale_id?e(`/listings/${t.sale_id}`):e(`/assets/${t.asset_id}`)},[e,b.size]),Qe=O.useCallback(e=>{const t=new Set(b);t.has(e)?t.delete(e):t.add(e),N(t)},[b]),et=O.useCallback(()=>{b.size===i.length?N(new Set):N(new Set(i.map(e=>e.asset_id)))},[b,i]),tt=O.useCallback(()=>{i.filter(e=>b.has(e.asset_id)).forEach(e=>{y.has(e.asset_id)||Ze.addToCart(e)}),N(new Set)},[i,b,y]);return Se.jsxs("div",{className:"marketplace",children:[Se.jsxs("div",{className:"container",children:[Se.jsx("div",{className:"marketplace-header",children:Se.jsx("div",{className:"marketplace-header-content",children:Se.jsxs("div",{className:"marketplace-header-text",children:[Se.jsx("h1",{className:"marketplace-title",children:"Pixel Journey Marketplace"}),Se.jsx("p",{className:"marketplace-subtitle",children:"Discover, collect, and trade unique digital assets from the Pixel Journey ecosystem. This marketplace serves all WAX users, with full market access unlocked for Pixal PFP holders."})]})})}),Se.jsxs("div",{className:"marketplace-filters",children:[Se.jsx(ja,{searchTerm:c,onSearchChange:d,suggestions:U,placeholder:"Search items, collections...",showFilters:!0,onFilterChange:Me,className:"marketplace-search"}),Se.jsxs("div",{className:"marketplace-controls",children:[Se.jsxs("div",{className:"category-tabs-container",children:[Se.jsx("h3",{className:"category-section-title",children:"Listings"}),Se.jsx("div",{className:"category-tabs-wrapper",children:Se.jsxs("div",{className:"category-tabs",children:[Se.jsx("button",{className:"category-tab "+("pixals"===u?"active":""),onClick:()=>h("pixals"),"aria-label":"Filter by Pixals category","aria-pressed":"pixals"===u,children:"Pixals"}),Se.jsx("button",{className:"category-tab "+("waxrocks"===u?"active":""),onClick:()=>h("waxrocks"),"aria-label":"Filter by WaxRocks category","aria-pressed":"waxrocks"===u,children:"WaxRocks"}),Se.jsx("button",{className:"category-tab "+("ingredients"===u?"active":""),onClick:()=>h("ingredients"),"aria-label":"Filter by Ingredients category","aria-pressed":"ingredients"===u,children:"Ingredients"}),Se.jsx("button",{className:"category-tab "+("bundles"===u?"active":""),onClick:()=>h("bundles"),"aria-label":"Filter by Bundles category","aria-pressed":"bundles"===u,children:"\ud83d\udce6 Bundles"}),Se.jsxs("select",{className:"others-select",value:["friedfactory","crptomuffins","akufishheads","partners","pxapproved","ah_verified","all_wax"].includes(u)?u:"others",onChange:e=>{const t=e.target.value;"others"!==t&&h(t)},"aria-label":"Select additional marketplace categories",children:[Se.jsx("option",{value:"others",children:"Others"}),Se.jsxs("optgroup",{label:"Marketplace",children:[Se.jsx("option",{value:"pxapproved",children:"PxApproved"}),Se.jsx("option",{value:"ah_verified",children:"All AH Verified (Pixals holders+ only)"}),Se.jsx("option",{value:"all_wax",children:"All Wax Listings (Pixals holders+ only)"})]}),Se.jsxs("optgroup",{label:"Partners",children:[Se.jsx("option",{value:"friedfactory",children:"Fried Factory"}),Se.jsx("option",{value:"crptomuffins",children:"CryptoMuffins"}),Se.jsx("option",{value:"akufishheads",children:"Aku Fish Heads"})]})]})]})})]}),Se.jsxs("div",{className:"filter-sort-section",children:[Se.jsx("h3",{className:"filter-sort-title",children:"Filter & Sort"}),Se.jsxs("div",{className:"filter-sort-controls",children:[Se.jsxs("select",{className:"sort-dropdown",value:M,onChange:e=>R(e.target.value),children:[Se.jsx("option",{value:"price_asc",children:"Price: Low to High"}),Se.jsx("option",{value:"price_desc",children:"Price: High to Low"}),Se.jsx("option",{value:"name_asc",children:"Name: A to Z"}),Se.jsx("option",{value:"name_desc",children:"Name: Z to A"}),Se.jsx("option",{value:"date_newest",children:"Newest Listings"}),Se.jsx("option",{value:"date_oldest",children:"Oldest Listings"})]}),Se.jsx("button",{className:"filter-toggle-btn",onClick:()=>{E(!P)},title:"Advanced Filters",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]})]})]})]}),"loading"===l&&Se.jsx("div",{className:"loading-grid",children:Array.from({length:8}).map((e,t)=>Se.jsxs("div",{className:"nft-card loading",children:[Se.jsx("div",{className:"nft-image-placeholder"}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("div",{className:"loading-text"}),Se.jsx("div",{className:"loading-text short"})]})]},t))}),"error"===l&&Se.jsx(va,{errorType:"LOAD_FAILED",onRetry:()=>Pe(u),showRetry:!0}),b.size>0&&Se.jsxs("div",{className:"bulk-actions-bar",children:[Se.jsx("div",{className:"bulk-actions-info",children:Se.jsxs("span",{children:[b.size," item",1!==b.size?"s":""," selected"]})}),Se.jsxs("div",{className:"bulk-actions-buttons",children:[Se.jsx("button",{className:"bulk-btn bulk-cart",onClick:tt,"aria-label":`Add ${b.size} selected items to cart`,children:"Add Selected to Cart"}),Se.jsxs("button",{className:"bulk-btn bulk-compare",onClick:()=>le(!0),disabled:b.size<2||b.size>4,title:b.size<2?"Select 2-4 items to compare":b.size>4?"Maximum 4 items can be compared":"Compare selected items","aria-label":`Compare ${b.size} selected items`,children:["Compare (",b.size,")"]}),Se.jsx("button",{className:"bulk-btn bulk-clear",onClick:()=>N(new Set),"aria-label":"Clear all selected items",children:"Clear Selection"})]})]}),"success"===l&&i.length>0&&Se.jsxs("div",{className:"select-all-container",children:[Se.jsx("button",{className:"select-all-btn",onClick:et,"aria-label":b.size===i.length?`Deselect all ${i.length} items`:`Select all ${i.length} items`,children:b.size===i.length?"Deselect All":"Select All"}),k<S&&Se.jsx("button",{className:"load-more-btn load-more-top",onClick:Re,disabled:ne,"aria-label":ne?"Loading more items":"Load more marketplace items",children:ne?"Loading...":"Load More"})]}),"success"===l&&Se.jsx("div",{className:"nft-grid",children:i.map(e=>Se.jsxs("div",{className:"nft-card "+(b.has(e.asset_id)?"selected":""),children:[Se.jsx("div",{className:"nft-select-checkbox",children:Se.jsx("input",{type:"checkbox",checked:b.has(e.asset_id),onChange:()=>Qe(e.asset_id),className:"select-checkbox"})}),Se.jsxs("div",{className:"nft-image-container",children:[Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),className:"nft-image",alt:e.name,autoPlay:!0,loop:!0,enableAnimations:t.enableAnimatedNFTs}),Se.jsx("div",{className:"zoom-overlay",onClick:()=>Te(ca(e)||"",da(e)||"",e.name||`Asset #${e.asset_id}`),title:"Click to zoom",children:Se.jsxs("svg",{className:"zoom-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"11",cy:"11",r:"8"}),Se.jsx("path",{d:"m21 21-4.35-4.35"}),Se.jsx("path",{d:"M11 8v6M8 11h6"})]})}),(e.template_mint||void 0!==e.max_supply)&&Se.jsxs("div",{className:"mint-badge",children:[void 0!==e.template_mint&&null!==e.template_mint?e.template_mint:"?","/","0"===e.max_supply||void 0===e.max_supply||null===e.max_supply?"\u221e":e.max_supply]})]}),Se.jsxs("div",{className:"nft-info",children:[Se.jsxs("div",{className:"nft-header",children:[Se.jsx("h3",{className:"nft-name",children:Se.jsx("span",{className:"asset-link",onClick:()=>Ye(e),children:e.name})}),Se.jsx("p",{className:"nft-collection",children:Se.jsx("span",{className:"collection-link",onClick:()=>Ge(e.collection),children:e.collection})})]}),Se.jsxs("div",{className:"nft-price-container",children:[Se.jsxs("div",{className:"nft-prices-div",children:[Se.jsx("div",{className:"nft-price",children:e.price}),Se.jsx("div",{className:"nft-price-usd",children:m[e.asset_id]||"$0.00"})]}),e.seller&&Se.jsxs("p",{className:"nft-seller",children:["\ud83e\uddd1\u200d\ud83d\udcbc ",Se.jsx("span",{className:"seller-link",onClick:()=>Ve(e.seller),children:e.seller})]})]}),Se.jsxs("div",{className:"nft-actions",children:[Se.jsxs("div",{className:"nft-actions-row nft-actions-main",children:[Se.jsxs("button",{className:"btn-buy-now",onClick:()=>Je(e),title:"Buy now","aria-label":`Buy ${e.name} for ${e.price}`,type:"button",children:[Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:Se.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Buy Now"]}),Se.jsxs("button",{className:"details-btn",onClick:()=>{x(e),v(!0)},title:"View Details","aria-label":`View details for ${e.name}`,type:"button",children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[Se.jsx("circle",{cx:"11",cy:"11",r:"8"}),Se.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Info"]})]}),Se.jsxs("div",{className:"nft-actions-row nft-actions-icons",children:[Se.jsx("button",{className:"btn-cart "+(y.has(e.asset_id)?"in-cart":""),onClick:()=>{if(y.has(e.asset_id))Ze.removeFromCart(e.asset_id);else{Ze.addToCart(e)||n("Item is already in your cart!")}},title:y.has(e.asset_id)?"Remove from cart":"Add to cart","aria-label":y.has(e.asset_id)?`Remove ${e.name} from cart`:`Add ${e.name} to cart`,type:"button",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:y.has(e.asset_id)?Se.jsxs(Se.Fragment,{children:[Se.jsx("polyline",{points:"3,6 5,6 21,6"}),Se.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]}):Se.jsxs(Se.Fragment,{children:[Se.jsx("circle",{cx:"9",cy:"21",r:"1"}),Se.jsx("circle",{cx:"20",cy:"21",r:"1"}),Se.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})})}),Se.jsx("button",{className:"btn-make-offer",onClick:t=>{t.stopPropagation(),me(e),fe(!0)},title:"Make Offer",type:"button",children:Se.jsx("svg",{viewBox:"0 -8 72 72",fill:"currentColor",children:Se.jsx("path",{d:"M64,12.78v17s-3.63.71-4.38.81-3.08.85-4.78-.78C52.22,27.25,42.93,18,42.93,18a3.54,3.54,0,0,0-4.18-.21c-2.36,1.24-5.87,3.07-7.33,3.78a3.37,3.37,0,0,1-5.06-2.64,3.44,3.44,0,0,1,2.1-3c3.33-2,10.36-6,13.29-7.52,1.78-1,3.06-1,5.51,1C50.27,12,53,14.27,53,14.27a2.75,2.75,0,0,0,2.26.43C58.63,14,64,12.78,64,12.78ZM27,41.5a3,3,0,0,0-3.55-4.09,3.07,3.07,0,0,0-.64-3,3.13,3.13,0,0,0-3-.75,3.07,3.07,0,0,0-.65-3,3.38,3.38,0,0,0-4.72.13c-1.38,1.32-2.27,3.72-1,5.14s2.64.55,3.72.3c-.3,1.07-1.2,2.07-.09,3.47s2.64.55,3.72.3c-.3,1.07-1.16,2.16-.1,3.46s2.84.61,4,.25c-.45,1.15-1.41,2.39-.18,3.79s4.08.75,5.47-.58a3.32,3.32,0,0,0,.3-4.68A3.18,3.18,0,0,0,27,41.5Zm25.35-8.82L41.62,22a3.53,3.53,0,0,0-3.77-.68c-1.5.66-3.43,1.56-4.89,2.24a8.15,8.15,0,0,1-3.29,1.1,5.59,5.59,0,0,1-3-10.34C29,12.73,34.09,10,34.09,10a6.46,6.46,0,0,0-5-2C25.67,8,18.51,12.7,18.51,12.7a5.61,5.61,0,0,1-4.93.13L8,10.89v19.4s1.59.46,3,1a6.33,6.33,0,0,1,1.56-2.47,6.17,6.17,0,0,1,8.48-.06,5.4,5.4,0,0,1,1.34,2.37,5.49,5.49,0,0,1,2.29,1.4A5.4,5.4,0,0,1,26,34.94a5.47,5.47,0,0,1,3.71,4,5.38,5.38,0,0,1,2.39,1.43,5.65,5.65,0,0,1,1.48,4.89a0,0,0,0,1,0,0s.8.9,1.29,1.39a2.46,2.46,0,0,0,3.48-3.48s2,2.48,4.28,1c2-1.4,1.69-3.06.74-4a3.19,3.19,0,0,0,4.77.13,2.45,2.45,0,0,0,.13-3.3s1.33,1.81,4,.12c1.89-1.6,1-3.43,0-4.39Z"})})}),Se.jsx("button",{className:"btn-message",onClick:()=>(ge(e),void ye(!0)),title:"Send Direct Message (1000 PXJ)",disabled:!e.seller,children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),Se.jsxs("div",{className:"other-actions-dropdown",children:[Se.jsx("button",{className:"btn-other-actions",onClick:t=>{t.stopPropagation(),Ce(e.asset_id)},title:"More Actions",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"1"}),Se.jsx("circle",{cx:"19",cy:"12",r:"1"}),Se.jsx("circle",{cx:"5",cy:"12",r:"1"})]})}),Se.jsxs("div",{className:"other-actions-menu "+(je.has(e.asset_id)?"open":""),children:[Se.jsxs("button",{className:"other-actions-item",onClick:t=>{t.stopPropagation(),Ye(e),Ae()},children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),Se.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"View Full Listing"]}),Se.jsxs("button",{className:"other-actions-item",onClick:t=>{t.stopPropagation(),ce(e),ue(!0),Ae()},children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),Se.jsx("polyline",{points:"16,6 12,2 8,6"}),Se.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]}),"Share NFT"]}),Se.jsxs("button",{className:"other-actions-item "+(ae.has(e.asset_id)?"in-watchlist":""),onClick:async t=>{if(t.stopPropagation(),ae.has(e.asset_id))await wt.removeFromWatchlist(e.asset_id);else{await wt.addToWatchlist(e)||n("Item is already in your watchlist!")}Ae()},children:[Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:ae.has(e.asset_id)?Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:"currentColor"}):Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),ae.has(e.asset_id)?"Remove from Watchlist":"Add to Watchlist"]})]})]})]})]})]})]},e.asset_id))}),"success"===l&&0===i.length&&Se.jsxs("div",{className:"marketplace-empty",children:[Se.jsx("svg",{className:"empty-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),Se.jsx("h3",{children:"No items found"}),Se.jsx("p",{children:"Try adjusting your search or filter criteria"})]}),"success"===l&&k<S&&Se.jsxs("div",{className:"load-more-container",children:[Se.jsx("button",{className:"load-more-btn",onClick:()=>Pe(u,k+1),disabled:ne,children:ne?"Loading...":"Load More"}),Se.jsxs("div",{className:"pagination-info",children:["Showing ",i.length," items \u2022 Loaded ",k," of ",S>k?S+"+":S," pages"]})]}),"success"===l&&k>=S&&i.length>0&&Se.jsx("div",{className:"load-more-container",children:Se.jsxs("div",{className:"pagination-info",children:["Showing all ",i.length," items"]})})]}),P&&Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"filter-sidebar-overlay",onClick:We}),Se.jsxs("div",{className:"filter-sidebar",children:[Se.jsxs("div",{className:"filter-sidebar-header",children:[Se.jsx("h3",{children:"Advanced Filters"}),Se.jsx("button",{className:"close-sidebar-btn",onClick:We,children:Se.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsxs("div",{className:"filter-section-header",onClick:()=>ze("collections"),children:[Se.jsx("h4",{children:"Collections"}),Se.jsx("button",{className:"collapse-toggle",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ee.has("collections")?"collapsed":"",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ee.has("collections")&&Se.jsx("div",{className:"collection-checkboxes",children:X.slice(0,8).map(e=>Se.jsxs("div",{className:"collection-item",children:[Se.jsxs("label",{className:"collection-checkbox",children:[Se.jsx("input",{type:"checkbox",checked:V.has(e),onChange:()=>Ue(e)}),Se.jsx("span",{className:"checkmark"}),e]}),Se.jsx("a",{href:`/analytics/${encodeURIComponent(e)}`,className:"analytics-link",title:`View ${e} analytics`,onClick:e=>e.stopPropagation(),children:"\ud83d\udcca"})]},e))})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsxs("div",{className:"filter-section-header",onClick:()=>ze("schemas"),children:[Se.jsx("h4",{children:"Schema Type"}),Se.jsx("button",{className:"collapse-toggle",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ee.has("schemas")?"collapsed":"",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ee.has("schemas")&&Se.jsx("div",{className:"schema-checkboxes",children:q.length>0?q.map(e=>Se.jsxs("label",{className:"schema-checkbox",children:[Se.jsx("input",{type:"checkbox",checked:$.has(e),onChange:()=>Oe(e)}),Se.jsx("span",{className:"checkmark"}),e.charAt(0).toUpperCase()+e.slice(1)]},e)):Se.jsx("div",{className:"loading-schemas",children:"Loading schemas..."})})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsxs("div",{className:"filter-section-header",onClick:()=>ze("price"),children:[Se.jsx("h4",{children:"Price Range (WAX)"}),Se.jsx("button",{className:"collapse-toggle",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ee.has("price")?"collapsed":"",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ee.has("price")&&Se.jsxs("div",{className:"price-range-inputs",children:[Se.jsx("input",{type:"number",placeholder:"Min",value:I.min,onChange:e=>F(t=>({...t,min:e.target.value})),className:"price-input"}),Se.jsx("span",{children:"to"}),Se.jsx("input",{type:"number",placeholder:"Max",value:I.max,onChange:e=>F(t=>({...t,max:e.target.value})),className:"price-input"})]})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsxs("div",{className:"filter-section-header",onClick:()=>ze("attributes"),children:[Se.jsx("h4",{children:"Attribute Filters"}),Se.jsx("button",{className:"collapse-toggle",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ee.has("attributes")?"collapsed":"",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ee.has("attributes")&&Se.jsxs("div",{className:"attribute-filters",children:[Array.from(Q.entries()).map(([e,t])=>Se.jsxs("div",{className:"attribute-group",children:[Se.jsx("h5",{className:"attribute-type",children:e}),Se.jsx("div",{className:"attribute-values",children:t.map(t=>Se.jsxs("label",{className:"attribute-checkbox",children:[Se.jsx("input",{type:"checkbox",checked:K.get(e)?.has(t)||!1,onChange:()=>Be(e,t)}),Se.jsx("span",{className:"checkmark"}),t]},t))})]},e)),0===Q.size&&Se.jsx("div",{className:"no-attributes",children:"No attributes available"})]})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsx("h4",{children:"Date Range"}),Se.jsxs("div",{className:"date-range-inputs",children:[Se.jsx("input",{type:"date",value:W.start,onChange:e=>D(t=>({...t,start:e.target.value})),className:"date-input",placeholder:"Start Date"}),Se.jsx("span",{children:"to"}),Se.jsx("input",{type:"date",value:W.end,onChange:e=>D(t=>({...t,end:e.target.value})),className:"date-input",placeholder:"End Date"})]})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsx("h4",{children:"Sort By"}),Se.jsxs("select",{value:M,onChange:e=>R(e.target.value),className:"sort-select",children:[Se.jsx("option",{value:"price_asc",children:"Price: Low to High"}),Se.jsx("option",{value:"price_desc",children:"Price: High to Low"}),Se.jsx("option",{value:"name_asc",children:"Name: A to Z"}),Se.jsx("option",{value:"name_desc",children:"Name: Z to A"}),Se.jsx("option",{value:"date_newest",children:"Newest Listings"}),Se.jsx("option",{value:"date_oldest",children:"Oldest Listings"})]})]}),Se.jsxs("div",{className:"filter-actions",children:[Se.jsx("button",{className:"clear-filters-btn",onClick:()=>{F({min:"",max:""}),L(new Set),G(new Set),Y(new Map),D({start:"",end:""}),R("price_asc")},children:"Clear All"}),Se.jsx("button",{className:"apply-filters-btn",onClick:We,children:"Apply Filters"})]})]})]}),Se.jsx(fa,{nft:f,isOpen:g,onClose:()=>{v(!1),x(null)}}),Se.jsx(xa,{initialNFTs:i.filter(e=>b.has(e.asset_id)),isOpen:re,onClose:()=>le(!1)}),oe&&Se.jsx(ga,{nft:oe,isOpen:de,onClose:()=>{ue(!1),ce(null)}}),he&&Se.jsx(w,{nft:he,isOpen:pe,onClose:()=>{fe(!1),me(null)}}),xe&&Se.jsx(la,{nft:xe,isOpen:ve,onClose:()=>{ye(!1),ge(null)}}),ke&&Ne&&Se.jsx("div",{className:"image-zoom-modal",onClick:()=>_e(!1),children:Se.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsx("button",{className:"zoom-modal-close",onClick:()=>_e(!1),"aria-label":"Close zoom modal",children:"\xd7"}),"video"===Ne.type?Se.jsx("video",{src:Ne.url,className:"zoom-modal-video",controls:!0,autoPlay:!0,loop:!0,muted:!0}):Se.jsx("img",{src:Ne.url,alt:Ne.name,className:"zoom-modal-image"}),Se.jsx("div",{className:"zoom-modal-title",children:Ne.name})]})})]})}),Na=()=>Se.jsxs("div",{className:"rewards-container",children:[Se.jsxs("div",{className:"rewards-header",children:[Se.jsx("h1",{className:"rewards-title",children:"Trading Rewards"}),Se.jsx("p",{className:"rewards-subtitle",children:"Earn PXJ tokens and Pixel Ingredients for every trade you make on Pixel Market"})]}),Se.jsxs("div",{className:"rewards-content",children:[Se.jsxs("div",{className:"reward-card",children:[Se.jsx("div",{className:"reward-icon pxj-icon",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("path",{d:"M12 6v6l4 2"})]})}),Se.jsx("h3",{className:"reward-title",children:"PXJ Token Rewards"}),Se.jsx("p",{className:"reward-description",children:"Earn PXJ tokens based on your trading volume. The more you trade, the more you earn!"}),Se.jsxs("ul",{className:"reward-benefits",children:[Se.jsx("li",{children:"0.1% of trade value in PXJ tokens"}),Se.jsx("li",{children:"Bonus multipliers for high-volume traders"}),Se.jsx("li",{children:"Weekly bonus distributions"}),Se.jsx("li",{children:"Governance voting rights"})]})]}),Se.jsxs("div",{className:"reward-card",children:[Se.jsx("div",{className:"reward-icon ingredient-icon",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),Se.jsx("h3",{className:"reward-title",children:"Pixel Ingredients"}),Se.jsxs("p",{className:"reward-description",children:["Collect rare Pixel Ingredients that can be used for crafting and enhancing your NFTs. ",Se.jsx("strong",{children:"Available to Pixal PFP holders and Fried Factory trait holders only."})]}),Se.jsxs("ul",{className:"reward-benefits",children:[Se.jsx("li",{children:"Random ingredient drops with each trade"}),Se.jsx("li",{children:"Rare ingredients for large transactions"}),Se.jsx("li",{children:"Craft unique items and upgrades"}),Se.jsx("li",{children:"Trade ingredients with other players"})]})]}),Se.jsxs("div",{className:"reward-card full-width",children:[Se.jsx("div",{className:"reward-icon volume-icon",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M3 3v18h18"}),Se.jsx("path",{d:"M7 12l4-4 4 4 6-6"})]})}),Se.jsx("h3",{className:"reward-title",children:"Volume-Based Bonuses"}),Se.jsx("p",{className:"reward-description",children:"Unlock additional rewards and benefits as your trading volume increases."}),Se.jsxs("div",{className:"volume-tiers",children:[Se.jsxs("div",{className:"tier",children:[Se.jsx("h4",{children:"Bronze Trader"}),Se.jsx("p",{children:"1+ WAX volume"}),Se.jsx("span",{className:"tier-bonus",children:"1x rewards"})]}),Se.jsxs("div",{className:"tier",children:[Se.jsx("h4",{children:"Silver Trader"}),Se.jsx("p",{children:"100+ WAX volume"}),Se.jsx("span",{className:"tier-bonus",children:"1.5x rewards"})]}),Se.jsxs("div",{className:"tier",children:[Se.jsx("h4",{children:"Gold Trader"}),Se.jsx("p",{children:"1,000+ WAX volume"}),Se.jsx("span",{className:"tier-bonus",children:"2x rewards"})]}),Se.jsxs("div",{className:"tier",children:[Se.jsx("h4",{children:"Diamond Trader"}),Se.jsx("p",{children:"10,000+ WAX volume"}),Se.jsx("span",{className:"tier-bonus",children:"3x rewards"})]})]})]})]}),Se.jsxs("div",{className:"rewards-cta",children:[Se.jsx("h3",{children:"Start Trading Today!"}),Se.jsx("p",{children:"Connect your wallet and start earning rewards with every transaction."}),Se.jsxs(U,{to:"/marketplace",className:"cta-button",children:[Se.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),"Go to Marketplace"]})]})]}),wa=({nft:e,isOpen:t,onClose:a,onSuccess:s,bundleNfts:n=[]})=>{const[i,r]=O.useState(""),[l,o]=O.useState(!1),[c,d]=O.useState(""),[u,h]=O.useState(!1),{session:m}=Fe(),{showSuccess:p,showError:f}=xt(),x={symbol:"WAX",contract:"eosio.token",precision:8},g=()=>{u||(r(""),o(!1),d(""),a())};return t&&e?Se.jsx("div",{className:"modal-overlay",onClick:g,children:Se.jsxs("div",{className:"modal-content listing-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"List NFT for Sale"}),Se.jsx("button",{className:"modal-close",onClick:g,disabled:u,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"nft-preview enhanced-preview",children:[Se.jsx("div",{className:"nft-image",children:Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name||`Asset #${e.asset_id}`,className:"nft-media"})}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h3",{children:e.name}),Se.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),Se.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&Se.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]}),l&&n.length>0&&Se.jsxs("p",{className:"bundle-info",children:["+ ",n.length," additional NFT",n.length>1?"s":""]})]})]}),n.length>0&&Se.jsxs("div",{className:"bundle-section",children:[Se.jsx("div",{className:"bundle-toggle",children:Se.jsxs("label",{className:"checkbox-label",children:[Se.jsx("input",{type:"checkbox",checked:l,onChange:e=>o(e.target.checked),disabled:u}),Se.jsx("span",{className:"checkmark"}),"Create Bundle with ",n.length," additional NFT",n.length>1?"s":""]})}),l&&Se.jsxs("div",{className:"bundle-details",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"bundleName",children:"Bundle Name *"}),Se.jsx("input",{type:"text",id:"bundleName",value:c,onChange:e=>d(e.target.value),placeholder:"Enter bundle name",disabled:u,className:"bundle-name-input"})]}),Se.jsxs("div",{className:"bundle-preview",children:[Se.jsx("h4",{children:"Bundle Contents:"}),Se.jsxs("div",{className:"bundle-nfts",children:[Se.jsxs("div",{className:"bundle-nft-item main-nft",children:[Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name||`Asset #${e.asset_id}`,className:"bundle-nft-image"}),Se.jsx("span",{children:e.name})]}),n.slice(0,3).map(e=>Se.jsxs("div",{className:"bundle-nft-item",children:[Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name||`Asset #${e.asset_id}`,className:"bundle-nft-image"}),Se.jsx("span",{children:e.name})]},e.asset_id)),n.length>3&&Se.jsxs("div",{className:"bundle-more",children:["+",n.length-3," more"]})]})]})]})]}),Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!e||!m||!i)return void f("Please fill in all required fields");if(l&&!c.trim())return void f("Please enter a bundle name");const o=parseFloat(i);if(isNaN(o)||o<=0)f("Please enter a valid price");else{h(!0);try{const t=x,i=`${o.toFixed(t.precision)} ${t.symbol}`,c=l&&n.length>0?[e.asset_id,...n.map(e=>e.asset_id)]:[e.asset_id],d={account:"atomicmarket",name:"announcesale",authorization:[{actor:Gt.safeGetActor(m),permission:Gt.safeGetPermission(m)}],data:{seller:Gt.safeGetActor(m),asset_ids:c,listing_price:i,settlement_symbol:`${t.precision},${t.symbol}`,maker_marketplace:"market.pxj"}};if(await m.transact({actions:[d]})){p(`${l?"Bundle":"NFT"} listed successfully!`),s?.(),a(),r("")}}catch(d){De.error("Listing failed","ListingModal",d instanceof Error?d:new Error(String(d))),f(`Listing failed: ${d instanceof Error?d.message:"Unknown error"}`)}finally{h(!1)}}},className:"modal-form listing-form",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"price",children:"Price *"}),Se.jsxs("div",{className:"price-input-group",children:[Se.jsx("input",{type:"number",id:"price",value:i,onChange:e=>r(e.target.value),placeholder:"0.00",step:"0.0001",min:"0",required:!0,disabled:u,className:"price-input"}),Se.jsxs("div",{className:"currency-display",children:[Se.jsx("span",{className:"currency-symbol",children:x.symbol}),Se.jsx("span",{className:"currency-note",children:"(AtomicMarket only supports WAX)"})]})]})]}),Se.jsxs("div",{className:"listing-info",children:[Se.jsxs("p",{className:"info-text",children:[Se.jsx("strong",{children:"Marketplace:"})," AtomicMarket"]}),Se.jsxs("p",{className:"info-text",children:[Se.jsx("strong",{children:"Marketplace Fee:"})," 2%"]}),Se.jsxs("p",{className:"info-text",children:[Se.jsx("strong",{children:"Collection Fee:"})," Varies by collection"]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:g,disabled:u,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary",disabled:u||!i,children:u?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"spinner"}),"Listing..."]}):"List for Sale"})]})]})]})]})}):null},ka=({nft:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState(""),[r,l]=O.useState(""),[o,c]=O.useState(!1),{session:d,transferNFT:u}=Fe(),{showSuccess:h,showError:m}=xt(),p=e=>/^[a-z1-5]{12}$/.test(e),f=()=>{o||(i(""),l(""),a())};return t&&e?Se.jsx("div",{className:"modal-overlay",onClick:f,children:Se.jsxs("div",{className:"modal-content transfer-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Transfer NFT"}),Se.jsx("button",{className:"modal-close",onClick:f,disabled:o,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"nft-preview",children:[Se.jsx("div",{className:"nft-image",children:e.video?Se.jsx("video",{src:e.video.startsWith("http")?e.video:`https://ipfs.io/ipfs/${e.video}`,muted:!0,loop:!0,autoPlay:!0}):e.img?Se.jsx("img",{src:e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name}):Se.jsx("div",{className:"no-image",children:"No Image"})}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h3",{children:e.name}),Se.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),Se.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&Se.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]})]})]}),Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e&&d&&n.trim())if(p(n.trim())){c(!0);try{if(!u)throw new Error("NFT transfer service is not available");await u(e.asset_id,n.trim())&&(h("Transfer Successful","NFT transferred successfully!"),s?.(),a(),i(""),l(""))}catch(r){De.error("Transfer failed","TransferModal",r),m("Transfer Failed",r instanceof Error?r.message:"Unknown error occurred")}finally{c(!1)}}else m("Invalid Account Name","Please enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)");else m("Validation Error","Please fill in all required fields")},className:"modal-form transfer-form",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"recipient",children:"Recipient WAX Account *"}),Se.jsx("input",{type:"text",id:"recipient",value:n,onChange:e=>i(e.target.value.toLowerCase()),placeholder:"e.g. pixeljourney",maxLength:12,required:!0,disabled:o,className:"recipient-input"}),Se.jsx("small",{className:"input-help",children:"Enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),Se.jsx("input",{type:"text",id:"memo",value:r,onChange:e=>l(e.target.value),placeholder:"Optional transfer message",maxLength:256,disabled:o,className:"memo-input"})]}),Se.jsxs("div",{className:"transfer-warning",children:[Se.jsx("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),Se.jsxs("div",{className:"warning-text",children:[Se.jsx("strong",{children:"Warning:"})," This action cannot be undone. Make sure you trust the recipient and have entered the correct account name."]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:f,disabled:o,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary transfer-btn",disabled:o||!n.trim()||!p(n.trim()),children:o?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"spinner"}),"Transferring..."]}):"Transfer NFT"})]})]})]})]})}):null},_a=({nft:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState(""),[r,l]=O.useState(!1),[o,c]=O.useState("warning"),{session:d}=Fe(),{showError:u,showSuccess:h}=xt(),m="BURN",p=()=>{i(""),c("warning")},f=()=>{r||(p(),a())};return t&&e?Se.jsx("div",{className:"modal-overlay",onClick:f,children:Se.jsxs("div",{className:"modal-content burn-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"\ud83d\udd25 Burn NFT"}),Se.jsx("button",{className:"modal-close",onClick:f,disabled:r,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"nft-preview",children:[Se.jsx("div",{className:"nft-image",children:e.video?Se.jsx("video",{src:e.video.startsWith("http")?e.video:`https://ipfs.io/ipfs/${e.video}`,muted:!0,loop:!0,autoPlay:!0}):e.img?Se.jsx("img",{src:e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name}):Se.jsx("div",{className:"no-image",children:"No Image"})}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h3",{children:e.name}),Se.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),Se.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&Se.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]})]})]}),"warning"===o&&Se.jsxs("div",{className:"burn-warning-step",children:[Se.jsxs("div",{className:"danger-warning",children:[Se.jsx("div",{className:"warning-icon",children:"\ud83d\udea8"}),Se.jsxs("div",{className:"warning-content",children:[Se.jsx("h3",{children:"PERMANENT ACTION WARNING"}),Se.jsxs("ul",{className:"warning-list",children:[Se.jsxs("li",{children:["This action will ",Se.jsx("strong",{children:"permanently destroy"})," your NFT"]}),Se.jsxs("li",{children:["The NFT will be ",Se.jsx("strong",{children:"completely removed"})," from the blockchain"]}),Se.jsxs("li",{children:["This action ",Se.jsx("strong",{children:"cannot be undone or reversed"})]}),Se.jsxs("li",{children:["You will ",Se.jsx("strong",{children:"not receive any compensation"})]}),Se.jsxs("li",{children:["The NFT will ",Se.jsx("strong",{children:"disappear forever"})]})]})]})]}),Se.jsxs("div",{className:"burn-reasons",children:[Se.jsx("h4",{children:"Common reasons for burning NFTs:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Reducing supply to increase rarity"}),Se.jsx("li",{children:"Participating in burn-to-earn mechanics"}),Se.jsx("li",{children:"Collection cleanup or rebranding"}),Se.jsx("li",{children:"Accidental duplicate mints"})]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:f,children:"Cancel"}),Se.jsx("button",{type:"button",className:"btn-danger",onClick:()=>{c("confirm")},children:"I Understand, Proceed"})]})]}),"confirm"===o&&Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e&&d){if(Je.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&Je.isValidWaxRock(t))return void u(`This is a rare WaxRock Pixal PFP (${t}) and cannot be burned. WaxRock Pixals are protected from burning and recycling on our platform.`,"Protected NFT",8e3)}if(n.toUpperCase()===m){l(!0);try{const t={account:"atomicassets",name:"burnasset",authorization:[{actor:Gt.safeGetActor(d),permission:Gt.safeGetPermission(d)}],data:{asset_owner:Gt.safeGetActor(d),asset_id:e.asset_id}};await d.transact({actions:[t]})&&(h("NFT burned successfully!","Burn Complete"),s?.(),a(),p())}catch(i){De.error("Burn failed","BurnModal",i),u(`Burn failed: ${i instanceof Error?i.message:"Unknown error"}`,"Burn Failed")}finally{l(!1)}}else u(`Please type "${m}" to confirm`,"Confirmation Required")}else u("Session error. Please try again.","Connection Error")},className:"modal-form burn-confirm-step",children:[Se.jsxs("div",{className:"final-warning",children:[Se.jsx("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),Se.jsxs("p",{children:[Se.jsx("strong",{children:"FINAL WARNING:"})," You are about to permanently destroy this NFT. This action cannot be undone."]})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsxs("label",{htmlFor:"confirmText",children:["Type ",Se.jsxs("strong",{children:['"',m,'"']})," to confirm:"]}),Se.jsx("input",{type:"text",id:"confirmText",value:n,onChange:e=>i(e.target.value),placeholder:`Type "${m}" here`,required:!0,disabled:r,className:"confirm-input",autoComplete:"off"})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>c("warning"),disabled:r,children:"Back"}),Se.jsx("button",{type:"submit",className:"btn-danger burn-btn",disabled:r||n.toUpperCase()!==m,children:r?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"spinner"}),"Burning..."]}):"\ud83d\udd25 Burn NFT Forever"})]})]})]})]})}):null},Sa=({nfts:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState({}),[r,l]=O.useState(""),[o,c]=O.useState(!1),[d,u]=O.useState(0),[h,m]=O.useState({}),[p,f]=O.useState(!1),[x,g]=O.useState(!0),[v,y]=O.useState("name_asc"),{session:j}=Fe(),{showSuccess:b,showError:N}=xt(),w="WAX",k=8,_=(e,t)=>{i(a=>({...a,[e]:t}))},S=O.useCallback(async()=>{if(!e.length||!t)return;f(!0);const a={},s=async(e,t=3)=>{try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),s=await fetch(e,{signal:t.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(a),!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return await s.json()}catch(a){if(t>0&&a instanceof Error&&!a.name.includes("AbortError"))return De.warn(`Retrying API call (${3-t+1}/3)`,"BulkListingModal.fetchWithRetry",{error:a.message,url:e}),await new Promise(e=>setTimeout(e,1e3*(3-t+1))),s(e,t-1);throw a}};try{const t=e.reduce((e,t)=>{const a=t.collection.collection_name;return e[a]||(e[a]=[]),e[a].push(t),e},{}),l=Object.entries(t);let o=0;for(const[e,c]of l){try{const t=`${dt.atomicMarketAPI}/atomicmarket/v1/sales?state=3&collection_name=${e}&limit=100&order=desc&sort=updated`;let r=null;try{r=await s(t)}catch(n){De.error(`Primary API failed for ${e}, trying fallback:`,"BulkListingModal.fetchPriceSuggestions",n);try{const t=`${dt.atomicMarketAPI}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=50&order=desc`;r=await s(t,1)}catch(i){De.error(`Fallback API also failed for ${e}:`,"BulkListingModal.fetchPriceSuggestions",i),C(c,a);continue}}if((e=>"object"==typeof e&&null!==e&&"success"in e&&"data"in e&&Array.isArray(e.data))(r)&&r.success&&r.data.length>0){const e=r.data.filter(e=>e.price?.amount).map(e=>{const t=parseFloat(e.price.amount),a=e.price.token_precision||8;return t/Math.pow(10,a)}).filter(e=>e>0&&e<1e4);if(e.length>0){const t=e.sort((e,t)=>e-t),s=Math.floor(.25*t.length),n=Math.floor(.75*t.length),i=t[n]-t[s],r=t[s]-1.5*i,l=t[n]+1.5*i,d=t.filter(e=>e>=r&&e<=l);if(d.length>0){const e=Math.min(...d),t=d.reduce((e,t)=>e+t,0)/d.length,s=d[Math.floor(d.length/2)];let n,i;n=d.length>=10?Math.max(1.03*e,.98*s):Math.max(1.05*e,.95*t),i=d.length>=20?"high":d.length>=10?"medium":"low",c.forEach(s=>{a[s.asset_id]={floorPrice:e,averagePrice:t,suggestedPrice:n,confidence:i,sampleSize:d.length}}),o++}else C(c,a)}else C(c,a)}else C(c,a)}catch(r){De.error(`Failed to process collection ${e}:`,"BulkListingModal.fetchPriceSuggestions",r),C(c,a)}l.indexOf([e,c])<l.length-1&&await new Promise(e=>setTimeout(e,500))}0===o?N("Price Analysis","Unable to fetch current market data. Using default pricing suggestions."):o<l.length&&De.warn(`Price data available for ${o}/${l.length} collections`),m(a)}catch(r){De.error("Error fetching price suggestions:","BulkListingModal.fetchPriceSuggestions",r),N("Price Analysis Failed","Unable to analyze market prices. Please set prices manually."),e.forEach(e=>{a[e.asset_id]={floorPrice:1,averagePrice:2,suggestedPrice:1.5,confidence:"low",sampleSize:0}}),m(a)}finally{f(!1)}},[e,t,N]),C=(e,t)=>{e.forEach(e=>{t[e.asset_id]={floorPrice:1,averagePrice:2,suggestedPrice:1.5,confidence:"low",sampleSize:0}})};O.useEffect(()=>{t&&e.length>0&&S()},[t,e,S]);const A=O.useMemo(()=>{const t=[...e];switch(v){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));case"price_asc":return t.sort((e,t)=>parseFloat(n[e.asset_id]||"0")-parseFloat(n[t.asset_id]||"0"));case"price_desc":return t.sort((e,t)=>{const a=parseFloat(n[e.asset_id]||"0");return parseFloat(n[t.asset_id]||"0")-a});default:return t}},[e,v,n]);O.useEffect(()=>{x&&e.length>0&&S()},[x,e,S]);const T=()=>e.reduce((e,t)=>{const a=parseFloat(n[t.asset_id]||"0");return e+(isNaN(a)?0:a)},0);return t?Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal-content bulk-listing-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Bulk List NFTs"}),Se.jsx("button",{className:"modal-close",onClick:a,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"listing-summary",children:[Se.jsx("h3",{children:"Listing Summary"}),Se.jsxs("p",{children:["You are about to list ",Se.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})]}),Se.jsxs("p",{className:"total-value",children:["Total Value: ",Se.jsx("strong",{children:Me(T())})]})]}),Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!j||0===e.length)return void N("Validation Error","Please connect your wallet and select NFTs to list");const r=e.filter(e=>{const t=n[e.asset_id];return!t||isNaN(parseFloat(t))||parseFloat(t)<=0});if(r.length>0)N("Invalid Prices",`Please set valid prices for all NFTs. ${r.length} NFT(s) have invalid prices.`);else{c(!0),u(0);try{const t=e.map(e=>{const t=`${parseFloat(n[e.asset_id]).toFixed(k)} ${w}`;return{account:"atomicmarket",name:"announcesale",authorization:[{actor:Gt.safeGetActor(j),permission:Gt.safeGetPermission(j)}],data:{seller:Gt.safeGetActor(j),asset_ids:[e.asset_id],listing_price:t,settlement_symbol:`${k},${w}`,maker_marketplace:"market.pxj"}}}),r=5,o=[];for(let e=0;e<t.length;e+=r)o.push(t.slice(e,e+r));let c=0;for(const e of o){await j.transact({actions:e})&&(c++,u(c/o.length*100))}b("Listing Successful",`Successfully listed ${e.length} NFT(s) on the marketplace!`),s?.(),a(),i({}),l("")}catch(o){De.error("Bulk listing failed:","BulkListingModal.handleSubmit",o),N("Listing Failed",o instanceof Error?o.message:"Unknown error occurred")}finally{c(!1),u(0)}}},className:"listing-form",children:[Se.jsxs("div",{className:"smart-pricing-section",children:[Se.jsxs("div",{className:"pricing-header",children:[Se.jsx("h4",{children:"Smart Pricing Tools"}),Se.jsx("button",{type:"button",className:"toggle-suggestions",onClick:()=>g(!x),children:x?"\ud83d\udcca Hide Analysis":"\ud83d\udcca Show Analysis"})]}),x&&Se.jsx("div",{className:"price-analysis",children:p?Se.jsxs("div",{className:"loading-suggestions",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("span",{children:"Analyzing market data..."})]}):Se.jsxs("div",{className:"suggestion-controls",children:[Se.jsx("button",{type:"button",className:"btn-suggestion suggested",onClick:()=>{const t={};e.forEach(e=>{const a=h[e.asset_id];a&&(t[e.asset_id]=Re(a.suggestedPrice,4))}),i(t)},disabled:o||0===Object.keys(h).length,title:"Apply AI-recommended prices based on market analysis",children:"\ud83c\udfaf Apply Suggested Prices"}),Se.jsx("button",{type:"button",className:"btn-suggestion floor",onClick:()=>{const t={};e.forEach(e=>{const a=h[e.asset_id];a&&(t[e.asset_id]=Re(.99*a.floorPrice,4))}),i(t)},disabled:o||0===Object.keys(h).length,title:"Price 1% below current floor prices for quick sales",children:"\u26a1 Quick Sale (Floor -1%)"})]})}),Se.jsxs("div",{className:"bulk-price-controls",children:[Se.jsx("h5",{children:"Manual Bulk Pricing"}),Se.jsxs("div",{className:"bulk-input-group",children:[Se.jsx("input",{type:"number",value:r,onChange:e=>l(e.target.value),placeholder:"Set same price for all",step:"0.0001",min:"0",disabled:o}),Se.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{if(!r)return;const t={};e.forEach(e=>{t[e.asset_id]=r}),i(t)},disabled:!r||o,children:"Apply to All"})]})]})]}),Se.jsxs("div",{className:"nft-pricing-list",children:[Se.jsxs("div",{className:"pricing-header",children:[Se.jsx("h4",{children:"Individual Pricing"}),e.length>1&&Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"nft-sort",children:"Sort by:"}),Se.jsxs("select",{id:"nft-sort",className:"sort-select",value:v,onChange:e=>y(e.target.value),children:[Se.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),Se.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),Se.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),Se.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),Se.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),Se.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"}),Se.jsx("option",{value:"price_asc",children:"Price (Low-High)"}),Se.jsx("option",{value:"price_desc",children:"Price (High-Low)"})]})]})]}),Se.jsx("div",{className:"bulk-listing-pricing-list-container",children:A.map(e=>{const t=h[e.asset_id];return Se.jsxs("div",{className:"bulk-listing-nft-pricing-item",children:[Se.jsxs("div",{className:"bulk-listing-nft-info",children:[Se.jsx("div",{className:"bulk-listing-nft-image",children:Se.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}})}),Se.jsxs("div",{className:"bulk-listing-nft-details",children:[Se.jsx("span",{className:"bulk-listing-nft-name",children:e.name}),Se.jsx("span",{className:"bulk-listing-nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),e.mint_number&&Se.jsxs("span",{className:"bulk-listing-nft-mint",children:["#",e.mint_number]}),t&&Se.jsxs("div",{className:"bulk-listing-price-suggestions",children:[Se.jsxs("div",{className:"bulk-listing-suggestion-row",children:[Se.jsx("span",{className:"bulk-listing-suggestion-label",children:"Floor:"}),Se.jsx("span",{className:"bulk-listing-suggestion-value",children:Me(t.floorPrice)})]}),Se.jsxs("div",{className:"bulk-listing-suggestion-row",children:[Se.jsx("span",{className:"bulk-listing-suggestion-label",children:"Avg:"}),Se.jsx("span",{className:"bulk-listing-suggestion-value",children:Me(t.averagePrice)})]}),Se.jsxs("div",{className:"bulk-listing-suggestion-row",children:[Se.jsx("span",{className:"bulk-listing-suggestion-label",children:"Suggested:"}),Se.jsx("span",{className:`bulk-listing-suggestion-value confidence-${t.confidence}`,children:Me(t.suggestedPrice)}),Se.jsx("span",{className:"bulk-listing-confidence-badge",children:t.confidence})]}),Se.jsxs("div",{className:"bulk-listing-sample-size",children:["Based on ",t.sampleSize," recent sales"]})]})]})]}),Se.jsxs("div",{className:"bulk-listing-price-input-section",children:[Se.jsxs("div",{className:"bulk-listing-price-input",children:[Se.jsx("input",{type:"number",value:n[e.asset_id]||"",onChange:t=>_(e.asset_id,t.target.value),placeholder:"Price in WAX",step:"0.0001",min:"0",required:!0,disabled:o}),Se.jsx("span",{className:"currency-label",children:"WAX"})]}),t&&Se.jsxs("div",{className:"bulk-listing-quick-price-buttons",children:[Se.jsx("button",{type:"button",className:"bulk-listing-quick-price-btn suggested",onClick:()=>_(e.asset_id,Re(t.suggestedPrice,4)),disabled:o,title:"Use suggested price",children:"\ud83d\udca1"}),Se.jsx("button",{type:"button",className:"bulk-listing-quick-price-btn floor",onClick:()=>_(e.asset_id,Re(.99*t.floorPrice,4)),disabled:o,title:"Use floor price -1%",children:"\u26a1"})]})]})]},e.asset_id)})})]}),o&&Se.jsxs("div",{className:"listing-progress",children:[Se.jsx("div",{className:"progress-bar",children:Se.jsx("div",{className:"progress-fill",style:{width:`${d}%`}})}),Se.jsxs("p",{children:["Listing NFTs... ",Math.round(d),"% complete"]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:o,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary",disabled:o||0===T(),children:o?"Listing...":`List ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},Ca=({nfts:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState(""),[r,l]=O.useState(""),[o,c]=O.useState(!1),[d,u]=O.useState(0),[h,m]=O.useState("name_asc"),{session:p,bulkTransferNFT:f}=Fe(),{showError:x,showSuccess:g}=xt(),v=O.useMemo(()=>{const t=[...e];switch(h){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));default:return t}},[e,h]);return t?Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal-content bulk-transfer-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Bulk Transfer NFTs"}),Se.jsx("button",{className:"modal-close",onClick:a,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"transfer-summary",children:[Se.jsx("h3",{children:"Transfer Summary"}),Se.jsxs("p",{children:["You are about to transfer ",Se.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})]}),Se.jsxs("div",{className:"collection-breakdown",children:[Se.jsx("h4",{children:"Collection Breakdown"}),Object.entries(e.reduce((e,t)=>{const a=t.collection.collection_name;return e[a]=(e[a]||0)+1,e},{})).map(([e,t])=>Se.jsxs("div",{className:"collection-item",children:[Se.jsx("span",{className:"collection-name",children:e}),Se.jsxs("span",{className:"collection-count",children:[t," NFT",1!==t?"s":""]})]},e))]}),Se.jsxs("div",{className:"rarity-breakdown",children:[Se.jsx("h4",{children:"Rarity Distribution"}),Object.entries(e.reduce((e,t)=>{const a=t.template?.immutable_data?.rarity||t.data?.rarity||"Unknown";return e[a.toString()]=(e[a.toString()]||0)+1,e},{})).map(([e,t])=>Se.jsxs("div",{className:"rarity-item",children:[Se.jsx("span",{className:"rarity-name",children:e}),Se.jsx("span",{className:"rarity-count",children:t})]},e))]}),Se.jsxs("div",{className:"nft-preview-section",children:[Se.jsxs("div",{className:"preview-header",children:[Se.jsx("h4",{children:"NFT Preview"}),e.length>1&&Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"transfer-sort",children:"Sort by:"}),Se.jsxs("select",{id:"transfer-sort",className:"sort-select",value:h,onChange:e=>m(e.target.value),children:[Se.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),Se.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),Se.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),Se.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),Se.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),Se.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),Se.jsxs("div",{className:"nft-preview-list",children:[v.slice(0,5).map(e=>Se.jsxs("div",{className:"nft-preview-item",children:[Se.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),Se.jsx("div",{className:"nft-info-bulk",children:Se.jsxs("div",{className:"nft-details",children:[Se.jsx("span",{className:"nft-name",children:e.name}),Se.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),Se.jsxs("span",{className:"nft-mint",children:["#",e.mint_number||"N/A"]}),Se.jsxs("span",{className:"nft-id",children:["ID: ",e.asset_id]})]})})]},e.asset_id)),e.length>5&&Se.jsxs("div",{className:"nft-preview-more",children:["+",e.length-5," more NFTs"]})]})]})]}),Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!p||!n.trim()||0===e.length)return void x("Please fill in all required fields","Validation Error");const o=n.trim().toLowerCase();if(o.length<1||o.length>12)x("Account name must be between 1 and 12 characters","Validation Error");else if(/^[a-z1-5.]+$/.test(o)){c(!0),u(0);try{if(!f)throw De.error("bulkTransferNFT service not available","BulkTransferModal"),new Error("Bulk transfer service not available");const t=e.map(e=>e.asset_id);await f(o,t,r||"Bulk transfer from PxMarket"),u(100),g(`Successfully transferred ${e.length} NFT(s) to ${o}!`,"Transfer Complete"),s?.(),a(),i(""),l("")}catch(d){De.error("Bulk transfer failed","BulkTransferModal.handleSubmit",d,{nftCount:e.length,recipient:n}),x(`Transfer failed: ${d instanceof Error?d.message:"Unknown error"}`,"Transfer Failed")}finally{c(!1),u(0)}}else x("Account name can only contain lowercase letters, numbers 1-5, and dots","Validation Error")},className:"transfer-form",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"recipient",children:"Recipient Account *"}),Se.jsx("input",{type:"text",id:"recipient",value:n,onChange:e=>i(e.target.value),placeholder:"Enter WAX account name",required:!0,disabled:o,maxLength:12}),Se.jsx("small",{className:"form-help",children:"Enter a valid WAX account name (1-12 characters, lowercase letters, numbers 1-5, dots)"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),Se.jsx("input",{type:"text",id:"memo",value:r,onChange:e=>l(e.target.value),placeholder:"Optional transfer memo",disabled:o,maxLength:256})]}),o&&Se.jsxs("div",{className:"transfer-progress",children:[Se.jsx("div",{className:"progress-bar",children:Se.jsx("div",{className:"progress-fill",style:{width:`${d}%`}})}),Se.jsxs("p",{children:["Transferring... ",Math.round(d),"% complete"]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:o,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary",disabled:o||!n.trim(),children:o?"Transferring...":`Transfer ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},Aa=({nfts:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState(()=>e.map(e=>({nft:e,recipient:""}))),[r,l]=O.useState(""),[o,c]=O.useState(""),[d,u]=O.useState(!1),[h,m]=O.useState(0),[p,f]=O.useState(10),[x,g]=O.useState("name_asc"),{session:v}=Fe(),{showSuccess:y,showError:j}=xt(),b=O.useMemo(()=>{const e=[...n];switch(x){case"name_asc":return e.sort((e,t)=>(e.nft.name||"").localeCompare(t.nft.name||""));case"name_desc":return e.sort((e,t)=>(t.nft.name||"").localeCompare(e.nft.name||""));case"collection_asc":return e.sort((e,t)=>e.nft.collection.collection_name.localeCompare(t.nft.collection.collection_name));case"collection_desc":return e.sort((e,t)=>t.nft.collection.collection_name.localeCompare(e.nft.collection.collection_name));case"mint_asc":return e.sort((e,t)=>(e.nft.mint_number||0)-(t.nft.mint_number||0));case"mint_desc":return e.sort((e,t)=>(t.nft.mint_number||0)-(e.nft.mint_number||0));default:return e}},[n,x]);D.useEffect(()=>{i(e.map(e=>({nft:e,recipient:""})))},[e]);if(!t)return null;const N=n.filter(e=>e.recipient.trim()),w=N.length===n.length;return Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal-content distribute-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Distribute NFTs"}),Se.jsx("button",{className:"modal-close",onClick:a,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"distribute-summary",children:[Se.jsx("h3",{children:"Distribution Summary"}),Se.jsxs("p",{children:["You are about to distribute ",Se.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})," to individual recipients"]}),Se.jsxs("div",{className:"bulk-addresses-section",children:[Se.jsx("h4",{children:"Bulk Address Input"}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"bulk-addresses",children:"Comma-separated addresses (optional)"}),Se.jsx("textarea",{id:"bulk-addresses",className:"form-control",value:r,onChange:e=>(e=>{if(l(e),e.trim()){const t=e.split(",").map(e=>e.trim()).filter(e=>e);t.length>0&&i(e=>e.map((e,a)=>({...e,recipient:t[a%t.length]||""})))}})(e.target.value),placeholder:"pixeljourney,market.pxj,council.pxj",rows:3}),Se.jsxs("div",{className:"bulk-actions",children:[Se.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{if(!r.trim())return void j("No addresses provided","Please enter comma-separated addresses first");const e=r.split(",").map(e=>e.trim()).filter(e=>e);0!==e.length?i(t=>t.map(t=>({...t,recipient:e[Math.floor(Math.random()*e.length)]}))):j("Invalid addresses","Please provide valid comma-separated addresses")},disabled:!r.trim(),children:"\ud83c\udfb2 Randomize Distribution"}),Se.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{i(e=>e.map(e=>({...e,recipient:""}))),l("")},children:"\ud83d\uddd1\ufe0f Clear All"})]})]})]}),Se.jsxs("div",{className:"batch-config",children:[Se.jsx("h4",{children:"Transaction Settings"}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"batch-size",children:"NFTs per transaction (5-200)"}),Se.jsx("input",{type:"number",id:"batch-size",className:"form-control",value:p,onChange:e=>f(Math.max(5,Math.min(200,parseInt(e.target.value)||10))),min:5,max:200}),Se.jsx("small",{children:"Larger batches are more efficient but may fail if too large"})]})]})]}),Se.jsxs("div",{className:"distribution-list",children:[Se.jsxs("div",{className:"distribution-header",children:[Se.jsxs("h4",{children:["Individual Recipients (",N.length,"/",n.length," configured)"]}),e.length>1&&Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"distribute-sort",children:"Sort by:"}),Se.jsxs("select",{id:"distribute-sort",className:"sort-select",value:x,onChange:e=>g(e.target.value),children:[Se.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),Se.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),Se.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),Se.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),Se.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),Se.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),Se.jsx("div",{className:"distribution-items",children:b.map(({nft:e,recipient:t})=>Se.jsxs("div",{className:"distribution-item",children:[Se.jsxs("div",{className:"nft-preview",children:[Se.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("span",{className:"nft-name",children:e.name}),Se.jsx("span",{className:"nft-collection",children:e.collection.collection_name}),Se.jsxs("span",{className:"nft-mint",children:["#",e.mint_number||"N/A"]})]})]}),Se.jsx("div",{className:"recipient-input",children:Se.jsx("input",{type:"text",className:"form-control",value:t,onChange:t=>((e,t)=>{i(a=>a.map(a=>a.nft.asset_id===e?{...a,recipient:t}:a))})(e.asset_id,t.target.value),placeholder:"Recipient account name"})})]},e.asset_id))})]}),Se.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!v)return void j("Wallet Required","Please connect your wallet first");const t=n.filter(e=>!e.recipient.trim());if(t.length>0)j("Missing Recipients",`Please specify recipients for all ${t.length} NFT(s)`);else{u(!0),m(0);try{const e=n.length;let t=0;for(let a=0;a<n.length;a+=p){const s=n.slice(a,a+p),i=s.map(({nft:e,recipient:t})=>({account:"atomicassets",name:"transfer",authorization:[{actor:v.actor.toString(),permission:"active"}],data:{from:v.actor.toString(),to:t.trim(),asset_ids:[e.asset_id],memo:o||"Distributed via PxMarket"}})),r=await v.transact({actions:i},{expireSeconds:30});t+=s.length,m(t/e*100),De.info("Batch distribution completed","DistributeModal",{batchSize:s.length,completed:t,total:e,transactionId:r.transaction})}y("Distribution Complete",`Successfully distributed ${e} NFT${1!==e?"s":""}`),s?.(),a()}catch(i){De.error("Distribution failed","DistributeModal",i),j("Distribution Failed",i instanceof Error?i.message:"Unknown error occurred")}finally{u(!1),m(0)}}},className:"distribute-form",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"memo",children:"Memo (optional)"}),Se.jsx("input",{type:"text",id:"memo",className:"form-control",value:o,onChange:e=>c(e.target.value),placeholder:"Optional transfer memo",maxLength:256})]}),d&&Se.jsxs("div",{className:"progress-container",children:[Se.jsx("div",{className:"progress-bar",children:Se.jsx("div",{className:"progress-fill",style:{width:`${h}%`}})}),Se.jsxs("p",{children:["Distributing NFTs... ",Math.round(h),"%"]})]}),Se.jsxs("div",{className:"form-actions",children:[Se.jsx("button",{type:"button",className:"btn btn-secondary",onClick:a,disabled:d,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d||!w,children:d?"Distributing...":`Distribute ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})})},Ta=({nfts:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState(!1),[r,l]=O.useState(0),[o,c]=O.useState(""),{session:d}=Fe(),{showError:u,showSuccess:h,showWarning:m}=xt();return t?Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal-content bulk-burn-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Bulk Burn NFTs"}),Se.jsx("button",{className:"modal-close",onClick:a,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"burn-warning",children:[Se.jsx("div",{className:"warning-icon",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),Se.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),Se.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),Se.jsx("h3",{children:"\u26a0\ufe0f Warning: This action cannot be undone!"}),Se.jsxs("p",{children:["You are about to permanently burn ",Se.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]}),". This will completely destroy these assets and they cannot be recovered."]})]}),Se.jsxs("div",{className:"nfts-to-burn",children:[Se.jsx("h4",{children:"NFTs to be burned:"}),Se.jsx("div",{className:"burn-list-container",children:e.map(e=>Se.jsxs("div",{className:"burn-nft-item",children:[Se.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),Se.jsxs("div",{className:"nft-details",children:[Se.jsx("span",{className:"nft-name",children:e.name}),Se.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),e.mint_number&&Se.jsxs("span",{className:"nft-mint",children:["#",e.mint_number]}),Se.jsxs("span",{className:"nft-id",children:["ID: ",e.asset_id]})]})]},e.asset_id))})]}),Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!d||0===e.length)return void u("Please connect your wallet and select NFTs to burn","Wallet Required");const n=[],r=e.filter(e=>{if(Je.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&Je.isValidWaxRock(t))return n.push(e),!1}return!0});if(n.length>0){const e=n.map(e=>`${e.name} (${e.data?.WaxRock})`).join(", ");if(m(`${n.length} WaxRock Pixal PFP(s) were excluded from burning for protection: ${e}. WaxRock Pixals are protected from burning and recycling on our platform.`,"Protected NFTs Excluded",8e3),0===r.length)return void u("No NFTs remaining to burn after excluding WaxRock Pixals.","No Burnable NFTs")}if("BURN"===o){i(!0),l(0);try{const e=r.map(e=>({account:"atomicassets",name:"burnasset",authorization:[{actor:Gt.safeGetActor(d),permission:Gt.safeGetPermission(d)}],data:{asset_owner:Gt.safeGetActor(d),asset_id:e.asset_id}})),t=10,n=[];for(let a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));let i=0;for(const a of n){await d.transact({actions:a})&&(i++,l(i/n.length*100))}h(`Successfully burned ${r.length} NFT(s)!`,"Burn Complete"),s?.(),a(),c("")}catch(p){De.error("Bulk burn failed","BulkBurnModal.handleSubmit",p,{nftCount:r.length}),u(`Burn failed: ${p instanceof Error?p.message:"Unknown error"}`,"Burn Failed")}finally{i(!1),l(0)}}else u('Please type "BURN" to confirm this action',"Confirmation Required")},className:"burn-form",children:[Se.jsxs("div",{className:"confirmation-section",children:[Se.jsxs("label",{htmlFor:"confirmText",children:["Type ",Se.jsx("strong",{children:'"BURN"'})," to confirm this action:"]}),Se.jsx("input",{id:"confirmText",type:"text",value:o,onChange:e=>c(e.target.value.toUpperCase()),placeholder:"Type BURN to confirm",disabled:n,required:!0})]}),n&&Se.jsxs("div",{className:"burn-progress",children:[Se.jsx("div",{className:"progress-bar",children:Se.jsx("div",{className:"progress-fill",style:{width:`${r}%`}})}),Se.jsxs("p",{children:["Burning NFTs... ",Math.round(r),"% complete"]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:n,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-danger",disabled:n||"BURN"!==o,children:n?"Burning...":`\ud83d\udd25 Burn ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},Pa=[{id:781515,pxj:1,wuf:22,pxjUpgrade:0,name:"Pixal PFP",type:"pixals"},{id:820134,pxj:2.22,wuf:5,pxjUpgrade:0,name:"Pixel Ingredient Pack",type:"pixelpack"},{id:858568,pxj:142,wuf:142,pxjUpgrade:0,name:"Black (Primary)",type:"primary"},{id:858569,pxj:.42,wuf:1,pxjUpgrade:0,name:"Blue (Primary)",type:"primary"},{id:858570,pxj:.42,wuf:1,pxjUpgrade:0,name:"Red (Primary)",type:"primary"},{id:858571,pxj:.42,wuf:1,pxjUpgrade:0,name:"Yellow (Primary)",type:"primary"},{id:858572,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Green (Secondary)",type:"secondary"},{id:858573,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Orange (Secondary)",type:"secondary"},{id:858574,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Purple (Secondary)",type:"secondary"},{id:858575,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Amber (Tertiary)",type:"tertiary"},{id:858576,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Chartreuse (Tertiary)",type:"tertiary"},{id:858577,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Violet (Tertiary)",type:"tertiary"},{id:858578,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Teal (Tertiary)",type:"tertiary"},{id:858580,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Vermillion (Tertiary)",type:"tertiary"},{id:859273,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Magenta (Tertiary)",type:"tertiary"}],Ea=[{id:"craft_green",name:"Green (Secondary)",description:"Craft Green from Yellow + Blue + 25,000 PXJ",resultTemplateId:858572,ingredients:[{templateId:858571,quantity:1,name:"Yellow (Primary)"},{templateId:858569,quantity:1,name:"Blue (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_orange",name:"Orange (Secondary)",description:"Craft Orange from Red + Yellow + 25,000 PXJ",resultTemplateId:858573,ingredients:[{templateId:858570,quantity:1,name:"Red (Primary)"},{templateId:858571,quantity:1,name:"Yellow (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_purple",name:"Purple (Secondary)",description:"Craft Purple from Red + Blue + 25,000 PXJ",resultTemplateId:858574,ingredients:[{templateId:858570,quantity:1,name:"Red (Primary)"},{templateId:858569,quantity:1,name:"Blue (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_amber",name:"Amber (Tertiary)",description:"Craft Amber from Orange + Green + 150,000 PXJ",resultTemplateId:858575,ingredients:[{templateId:858573,quantity:1,name:"Orange (Secondary)"},{templateId:858572,quantity:1,name:"Green (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_chartreuse",name:"Chartreuse (Tertiary)",description:"Craft Chartreuse from Green + Purple + 150,000 PXJ",resultTemplateId:858576,ingredients:[{templateId:858572,quantity:1,name:"Green (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_violet",name:"Violet (Tertiary)",description:"Craft Violet from Purple + Orange + 150,000 PXJ",resultTemplateId:858577,ingredients:[{templateId:858574,quantity:1,name:"Purple (Secondary)"},{templateId:858573,quantity:1,name:"Orange (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_teal",name:"Teal (Tertiary)",description:"Craft Teal from Green + Purple + 150,000 PXJ",resultTemplateId:858578,ingredients:[{templateId:858572,quantity:1,name:"Green (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_vermillion",name:"Vermillion (Tertiary)",description:"Craft Vermillion from Orange + Purple + 150,000 PXJ",resultTemplateId:858580,ingredients:[{templateId:858573,quantity:1,name:"Orange (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_magenta",name:"Magenta (Tertiary)",description:"Craft Magenta from Purple + Orange + 150,000 PXJ",resultTemplateId:859273,ingredients:[{templateId:858574,quantity:1,name:"Purple (Secondary)"},{templateId:858573,quantity:1,name:"Orange (Secondary)"}],pxjCost:15e4,tier:"tertiary"}],Ia=e=>Pa.find(t=>t.id===e);const Fa=new class{constructor(){M(this,"cache",[]),M(this,"balanceCache",{pxj:0,wuf:0}),M(this,"lastFetch",0),M(this,"CACHE_DURATION",3e4),M(this,"virtualLibrary",new Map),M(this,"virtualLibraryTimestamp",new Map),M(this,"VIRTUAL_LIBRARY_CACHE_DURATION",3e5),M(this,"backgroundLoadingPromises",new Map),M(this,"isBackgroundLoading",new Set)}async fetchInventory(e){const t=Date.now();if(this.cache.length>0&&t-this.lastFetch<this.CACHE_DURATION)return this.cache;try{const a=await fetch(`${dt.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&burned=false&limit=1000&page=1&order=desc&sort=asset_id`);if(!a.ok)throw new Error(`Failed to fetch inventory: ${a.statusText}`);const s=(await a.json()).data||[],n=new Map;for(const e of s){const t=parseInt(e.template.template_id),a=Pa.find(e=>e.id===t);a&&["primary","secondary","tertiary"].includes(a.type)&&(n.has(t)||n.set(t,{templateId:t,name:a.name,assetIds:[],tier:a.type}),n.get(t).assetIds.push(e.asset_id))}return this.cache=Array.from(n.values()).map(e=>({...e,quantity:e.assetIds.length})),this.lastFetch=t,this.cache}catch(a){return Le.logError("InventoryService.fetchInventory",a,{account:e}),this.cache=[],[]}}async fetchBalances(e){try{let a=0,s=0;try{const t=await dt.getWaxCurrencyBalance(e,"pixeljourney","PXJ");t&&t.length>0&&(a=parseFloat(t[0].balance.split(" ")[0]))}catch(t){Le.logError("InventoryService.getPXJBalance",t,{account:e})}try{const t=await dt.getWaxCurrencyBalance(e,"wuffi","WUF");t&&t.length>0&&(s=parseFloat(t[0].balance.split(" ")[0]))}catch(t){Le.logError("InventoryService.getWUFBalance",t,{account:e})}return this.balanceCache={pxj:a,wuf:s},this.balanceCache}catch(t){Le.logError("InventoryService.fetchBalances",t,{account:e});const a={pxj:0,wuf:0};return this.balanceCache=a,a}}getIngredientQuantity(e){const t=this.cache.find(t=>t.templateId===e);return t?t.quantity:0}getIngredientAssetIds(e,t){const a=this.cache.find(t=>t.templateId===e);return!a||a.quantity<t?[]:a.assetIds.slice(0,t)}canCraftRecipe(e,t){for(const a of e){if(this.getIngredientQuantity(a.templateId)<a.quantity)return!1}return!(this.balanceCache.pxj<t)}getMaxCraftableQuantity(e,t){let a=1/0;for(const n of e){const e=this.getIngredientQuantity(n.templateId),t=n.quantity,s=Math.floor(e/t);a=Math.min(a,s)}const s=Math.floor(this.balanceCache.pxj/t);return Math.min(a,s)}updateInventoryAfterCraft(e,t){for(const a of e){const e=this.cache.find(e=>e.templateId===a.templateId);e&&(e.quantity=Math.max(0,e.quantity-a.quantity),e.assetIds=e.assetIds.slice(a.quantity))}this.balanceCache.pxj=Math.max(0,this.balanceCache.pxj-t)}async startBackgroundInventoryLoad(e){if(!e||this.isBackgroundLoading.has(e))return;const t=this.virtualLibraryTimestamp.get(e)||0;if(!(Date.now()-t<this.VIRTUAL_LIBRARY_CACHE_DURATION)){this.isBackgroundLoading.add(e);try{De.debug(`Starting background inventory load for ${e}`,"InventoryService.startBackgroundInventoryLoad");const t=this.loadFullInventoryInBackground(e);this.backgroundLoadingPromises.set(e,t),await t,De.info(`Background inventory load completed for ${e}`,"InventoryService.startBackgroundInventoryLoad")}catch(a){Le.logError("InventoryService.startBackgroundInventoryLoad",a,{account:e})}finally{this.isBackgroundLoading.delete(e),this.backgroundLoadingPromises.delete(e)}}}convertNFTAssetToInventoryNFT(e){return{asset_id:e.asset_id,name:e.name,img:e.image,video:e.video,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:e.max_supply||"0",immutable_data:{img:e.image,video:e.video}},data:{...e.traits,rarity:e.rarity},mint_number:e.template_mint}}async loadFullInventoryInBackground(e){const t=[];let a=1;let s=!0;for(;s;)try{const n=await dt.getUserInventoryWithFilter(e,a,100,"all");if(n&&n.assets&&n.assets.length>0){const e=n.assets.map(e=>this.convertNFTAssetToInventoryNFT(e));t.push(...e),s=n.hasMore,a++,await new Promise(e=>setTimeout(e,100))}else s=!1}catch(n){Le.logError("InventoryService.loadFullInventoryInBackground",n,{account:e,page:a}),s=!1}this.virtualLibrary.set(e,t),this.virtualLibraryTimestamp.set(e,Date.now()),De.info(`Loaded ${t.length} NFTs into virtual library for ${e}`,"InventoryService.loadFullInventoryInBackground")}async getInventoryPage(e,t,a=50){const s=this.virtualLibrary.get(e),n=this.virtualLibraryTimestamp.get(e)||0,i=Date.now();if(s&&i-n<this.VIRTUAL_LIBRARY_CACHE_DURATION){const e=(t-1)*a,n=e+a;return{data:s.slice(e,n),hasMore:n<s.length,totalCount:s.length}}try{const s=await dt.getUserInventoryWithFilter(e,t,a,"all");return{data:s?.assets?s.assets.map(e=>this.convertNFTAssetToInventoryNFT(e)):[],hasMore:s?.hasMore||!1,totalCount:s?.total||0}}catch(r){return Le.logError("InventoryService.getInventoryPage",r,{account:e,page:t,limit:a}),{data:[],hasMore:!1,totalCount:0}}}isBackgroundLoadingInProgress(e){return this.isBackgroundLoading.has(e)}getVirtualLibraryStats(e){return{itemCount:this.virtualLibrary.get(e)?.length||0,lastUpdate:this.virtualLibraryTimestamp.get(e)||null,isLoading:this.isBackgroundLoading.has(e)}}clearCache(){this.cache=[],this.balanceCache={pxj:0,wuf:0},this.lastFetch=0}clearVirtualLibrary(e){e?(this.virtualLibrary.delete(e),this.virtualLibraryTimestamp.delete(e),this.isBackgroundLoading.delete(e),this.backgroundLoadingPromises.delete(e)):(this.virtualLibrary.clear(),this.virtualLibraryTimestamp.clear(),this.isBackgroundLoading.clear(),this.backgroundLoadingPromises.clear())}getCachedInventory(){return this.cache}getCachedBalances(){return this.balanceCache}},$a=({isOpen:e,onClose:t,ingredient:a})=>{const{account:s,session:n,transferTokens:i,executeCraftingTransaction:r}=Fe();at();const{showError:l,showSuccess:o,showWarning:c}=xt(),[d,u]=O.useState("craft"),[h,m]=O.useState(null),[p,f]=O.useState([]),[x,g]=O.useState(!1),[v,y]=O.useState([]),[j,b]=O.useState({pxj:0,wuf:0}),[N,w]=O.useState(!1),[k,_]=O.useState(1),[S,C]=O.useState(0),[A,T]=O.useState("name_asc"),P=O.useCallback(async()=>{if(s){w(!0);try{const[e,t]=await Promise.all([Fa.fetchInventory(s),Fa.fetchBalances(s)]);y(e),b(t)}catch(e){console.error("Failed to load inventory:",e),l("Failed to load inventory data",e instanceof Error?e.message:"Unknown error")}finally{w(!1)}}else l("Wallet Required","Please connect your wallet first")},[s,l]);O.useEffect(()=>{e&&s&&P()},[e,s,P]);const E=e=>{const t=v.find(t=>t.templateId===e);return t?t.quantity:0},I=e=>{if(!e)return 0;let t=1/0;for(const s of e.ingredients){const e=E(s.templateId),a=s.quantity,n=Math.floor(e/a);t=Math.min(t,n)}const a=Math.floor(j.pxj/e.pxjCost);return Math.min(t,a)};O.useEffect(()=>{if(h){const e=I(h);C(e),_(Math.min(k,e))}},[h,v,j.pxj,I,k]);const F=O.useMemo(()=>{const e=[...v];switch(A){case"name_asc":return e.sort((e,t)=>e.name.localeCompare(t.name));case"name_desc":return e.sort((e,t)=>t.name.localeCompare(e.name));case"quantity_asc":return e.sort((e,t)=>e.quantity-t.quantity);case"quantity_desc":return e.sort((e,t)=>t.quantity-e.quantity);case"type_asc":return e.sort((e,t)=>{const a=Ia(e.templateId),s=Ia(t.templateId),n=a?.type||"Unknown",i=s?.type||"Unknown";return n.localeCompare(i)});case"type_desc":return e.sort((e,t)=>{const a=Ia(e.templateId),s=Ia(t.templateId),n=a?.type||"Unknown";return(s?.type||"Unknown").localeCompare(n)});default:return e}},[v,A]),$=(e,t=1)=>{for(const s of e.ingredients){if(E(s.templateId)<s.quantity*t)return!1}const a=e.pxjCost*t;return!(j.pxj<a)},L=async()=>{if(!a||!s||!n)return void l("Missing Requirements","Ingredient and wallet connection required for upgrading");const e="template"in a?a.template?.template_id:a.id,r=Ia("string"==typeof e?parseInt(e):e);if(r&&0!==r.pxjUpgrade)if(j.pxj<r.pxjUpgrade)l("Insufficient PXJ",`You need ${r.pxjUpgrade.toLocaleString()} PXJ to upgrade this ingredient`);else{g(!0);try{if(!i)return void l("Upgrade Error","Transfer service not available");await i("upgradepool",r.pxjUpgrade.toString(),"PXJ",`Upgrade ${r.name}`)&&(o("Upgrade Complete!",`Successfully upgraded ${r.name}`),P(),t())}catch(c){console.error("Upgrade failed:",c),l("Upgrade Failed",c instanceof Error?c.message:"Unknown error occurred")}finally{g(!1)}}else l("Cannot Upgrade","This ingredient cannot be upgraded")};return e?z.createPortal(Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"crafting-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Pixel Ingredient Crafting"}),Se.jsx("button",{className:"close-btn",onClick:t,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-tabs",children:[Se.jsx("button",{className:"tab-btn "+("craft"===d?"active":""),onClick:()=>u("craft"),children:"Craft New"}),Se.jsx("button",{className:"tab-btn "+("upgrade"===d?"active":""),onClick:()=>u("upgrade"),disabled:!a,children:"Upgrade Existing"})]}),Se.jsx("div",{className:"modal-content",children:"craft"===d?Se.jsxs("div",{className:"craft-tab",children:[Se.jsxs("div",{className:"craft-layout",children:[Se.jsxs("div",{className:"recipe-selection",children:[Se.jsx("h3",{children:"Select Recipe"}),Se.jsxs("div",{className:"recipe-categories",children:[Se.jsxs("div",{className:"recipe-category",children:[Se.jsx("h4",{children:"Secondary Ingredients"}),Ea.filter(e=>"secondary"===e.tier).map(e=>Se.jsxs("div",{className:`recipe-item ${h?.id===e.id?"selected":""} ${$(e)?"":"disabled"}`,onClick:()=>m(e),children:[Se.jsx("div",{className:"recipe-name",children:e.name}),Se.jsxs("div",{className:"recipe-cost",children:[e.pxjCost.toLocaleString()," PXJ"]}),Se.jsx("div",{className:"recipe-ingredients",children:e.ingredients.map((e,t)=>Se.jsxs("span",{className:E(e.templateId)>=e.quantity?"available":"unavailable",children:[e.name," (",E(e.templateId),"/",e.quantity,")"]},t))})]},e.id))]}),Se.jsxs("div",{className:"recipe-category",children:[Se.jsx("h4",{children:"Tertiary Ingredients"}),Ea.filter(e=>"tertiary"===e.tier).map(e=>Se.jsxs("div",{className:`recipe-item ${h?.id===e.id?"selected":""} ${$(e)?"":"disabled"}`,onClick:()=>m(e),children:[Se.jsx("div",{className:"recipe-name",children:e.name}),Se.jsxs("div",{className:"recipe-cost",children:[e.pxjCost.toLocaleString()," PXJ"]}),Se.jsx("div",{className:"recipe-ingredients",children:e.ingredients.map((e,t)=>Se.jsxs("span",{className:E(e.templateId)>=e.quantity?"available":"unavailable",children:[e.name," (",E(e.templateId),"/",e.quantity,")"]},t))})]},e.id))]})]})]}),Se.jsxs("div",{className:"craft-controls",children:[h&&Se.jsxs("div",{className:"selected-recipe",children:[Se.jsx("h3",{children:h.name}),Se.jsx("p",{children:h.description}),Se.jsxs("div",{className:"quantity-controls",children:[Se.jsx("label",{children:"Quantity:"}),Se.jsxs("div",{className:"quantity-input",children:[Se.jsx("button",{onClick:()=>_(Math.max(1,k-1)),disabled:k<=1,children:"-"}),Se.jsx("input",{type:"number",value:k,onChange:e=>_(Math.min(S,Math.max(1,parseInt(e.target.value)||1))),min:"1",max:S}),Se.jsx("button",{onClick:()=>_(Math.min(S,k+1)),disabled:k>=S,children:"+"})]}),Se.jsxs("span",{className:"max-craftable",children:["Max: ",S]})]}),Se.jsx("div",{className:"total-cost",children:Se.jsxs("strong",{children:["Total Cost: ",(h.pxjCost*k).toLocaleString()," PXJ"]})}),Se.jsx("button",{className:"add-to-queue-btn",onClick:()=>{if(!h||k<=0)return;if(!$(h,k))return void c("Insufficient Resources","You don't have enough ingredients or PXJ for this craft.");const e=p.findIndex(e=>e.recipe.id===h.id);if(e>=0){const t=[...p];t[e].quantity+=k,f(t)}else f([...p,{recipe:h,quantity:k}]);o("Added to Queue",`Added ${k}x ${h.name} to crafting queue`),_(1)},disabled:!$(h,k)||k<=0,children:"Add to Queue"})]}),Se.jsxs("div",{className:"inventory-section",children:[Se.jsxs("div",{className:"inventory-header",children:[Se.jsx("h3",{children:"Your Inventory"}),!N&&v.length>0&&Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"inventory-sort",children:"Sort by:"}),Se.jsxs("select",{id:"inventory-sort",className:"sort-select",value:A,onChange:e=>T(e.target.value),children:[Se.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),Se.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),Se.jsx("option",{value:"quantity_asc",children:"Quantity (Low-High)"}),Se.jsx("option",{value:"quantity_desc",children:"Quantity (High-Low)"}),Se.jsx("option",{value:"type_asc",children:"Type (A-Z)"}),Se.jsx("option",{value:"type_desc",children:"Type (Z-A)"})]})]})]}),N?Se.jsxs("div",{className:"loading-inventory",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("span",{children:"Loading inventory..."})]}):Se.jsx("div",{className:"inventory-grid",children:0===F.length?Se.jsx("div",{className:"no-inventory",children:Se.jsxs("div",{className:"empty-state",children:[Se.jsx("span",{children:"No ingredients found"}),Se.jsx("button",{className:"refresh-btn",onClick:P,disabled:N,children:"Refresh Inventory"})]})}):F.map(e=>{const t=Ia(e.templateId);return Se.jsxs("div",{className:"inventory-item",children:[Se.jsx("div",{className:"item-name",children:e.name}),Se.jsxs("div",{className:"item-quantity",children:["Qty: ",e.quantity]}),Se.jsx("div",{className:"item-tier",children:t?.type||"Unknown"})]},e.templateId)})})]})]})]}),Se.jsxs("div",{className:"crafting-queue",children:[Se.jsxs("div",{className:"queue-header",children:[Se.jsxs("h3",{children:["Crafting Queue (",p.length,")"]}),p.length>0&&Se.jsx("button",{className:"clear-queue-btn",onClick:()=>{f([])},children:"Clear All"})]}),p.length>0?Se.jsxs("div",{className:"queue-items",children:[p.map((e,t)=>Se.jsxs("div",{className:"queue-item",children:[Se.jsxs("div",{className:"queue-item-info",children:[Se.jsx("span",{className:"item-name",children:e.recipe.name}),Se.jsxs("span",{className:"item-quantity",children:["x",e.quantity]}),Se.jsxs("span",{className:"item-cost",children:[(e.recipe.pxjCost*e.quantity).toLocaleString()," PXJ"]})]}),Se.jsx("button",{className:"remove-item-btn",onClick:()=>{return t=e.recipe.id,void f(p.filter(e=>e.recipe.id!==t));var t},children:"Remove"})]},t)),Se.jsx("div",{className:"queue-total",children:Se.jsxs("strong",{children:["Total: ",p.reduce((e,t)=>e+t.recipe.pxjCost*t.quantity,0).toLocaleString()," PXJ"]})}),Se.jsx("button",{className:"execute-queue-btn",onClick:async()=>{if(0===p.length)return void c("Empty Queue","No items in crafting queue");if(!s||!n)return void l("Wallet Required","Please connect your wallet to craft ingredients");if(x)return;g(!0);let e=0;try{for(const t of p){const{recipe:s,quantity:n}=t,i=[];let c=!0;for(const e of s.ingredients){const t=e.quantity*n,a=Fa.getIngredientAssetIds(e.templateId,t);if(a.length<t){l("Insufficient Ingredients",`Not enough ${e.name} available`),c=!1;break}i.push({templateId:e.templateId,assetIds:a})}if(c)try{if(!r){l("Crafting Error","Crafting service not available");continue}const t={recipe:s.id,quantity:n,ingredientAssets:i,pxjCost:s.pxjCost};if(await r(t)){e++;const t=s.ingredients.map(e=>({templateId:e.templateId,quantity:e.quantity*n}));Fa.updateInventoryAfterCraft(t,s.pxjCost*n),o("Craft Successful!",`Successfully crafted ${n}x ${s.name}`)}else l("Craft Failed",`Failed to craft ${s.name}`)}catch(a){console.error("Craft error:",a),l("Craft Failed",a instanceof Error?a.message:"Unknown crafting error")}}e>0&&(o("Crafting Complete!",`Successfully crafted ${e} recipe(s)`),f([]),P(),t())}catch(i){console.error("Crafting failed:",i),l("Crafting Failed",i instanceof Error?i.message:"Unknown error occurred")}finally{g(!1)}},disabled:x,children:x?"Crafting...":"Craft All"})]}):Se.jsx("div",{className:"empty-queue",children:Se.jsx("p",{children:"No items in queue. Select a recipe and add it to start crafting."})})]})]}):Se.jsx("div",{className:"upgrade-tab",children:a?Se.jsx("div",{className:"upgrade-content",children:Se.jsxs("div",{className:"ingredient-info",children:[Se.jsxs("h3",{children:["Upgrade: ",a.name]}),Se.jsxs("p",{children:["Template ID: ","template"in a?a.template?.template_id:a.id]}),(()=>{const e="template"in a?a.template?.template_id:a.id,t=Ia("string"==typeof e?parseInt(e):e);return t?0===t.pxjUpgrade?Se.jsx("p",{className:"no-upgrade",children:"This ingredient cannot be upgraded."}):Se.jsxs("div",{className:"upgrade-details",children:[Se.jsx("div",{className:"upgrade-cost",children:Se.jsxs("strong",{children:["Upgrade Cost: ",t.pxjUpgrade.toLocaleString()," PXJ"]})}),Se.jsxs("div",{className:"balance-info",children:["Your PXJ Balance: ",j.pxj.toLocaleString()]}),Se.jsx("button",{className:"upgrade-btn",onClick:L,disabled:x||j.pxj<t.pxjUpgrade,children:x?"Upgrading...":"Upgrade Ingredient"})]}):Se.jsx("p",{children:"Template not found"})})()]})}):Se.jsx("div",{className:"no-ingredient",children:Se.jsx("p",{children:"No ingredient selected for upgrade. Please select an ingredient from your inventory."})})})}),Se.jsx("div",{className:"modal-footer",children:Se.jsx("div",{className:"resource-display",children:Se.jsx("div",{className:"pxj-balance",children:Se.jsxs("strong",{children:["PXJ Balance: ",j.pxj.toLocaleString()]})})})})]})}),document.body):null};const La=new class{constructor(){M(this,"atomicMarketContract","atomicmarket")}get atomicMarketAPI(){return dt.getCurrentAtomicEndpoint()}async placeBuyOffer(e,t,a,s=""){if(!e)throw new Error("Please connect your wallet first");const n=parseFloat(a);if(isNaN(n)||n<=0)throw new Error("Please enter a valid offer amount");try{const i=`${n.toFixed(8)} WAX`,r=await fetch(`${this.atomicMarketAPI}/atomicassets/v1/assets/${t}`);if(!r.ok)throw new Error("Failed to fetch asset details");const l=await r.json();if(!l.success||!l.data)throw new Error("Asset not found");const o=l.data.owner,c={account:this.atomicMarketContract,name:"announceoffer",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{buyer:Gt.safeGetActor(e),recipient:o,asset_ids:[t],price:i,memo:s||"Buy offer from PxMarket - market.pixeljourney.xyz",maker_marketplace:"market.pxj"}},d=await e.transact({actions:[c]});return{success:!0,transaction_id:d?.transaction_id||d?.id||"",message:`Buy offer of ${a} WAX placed successfully!`}}catch(i){throw Le.logError("OfferService.placeBuyOffer",i,{assetId:t,offerAmount:a,actor:e.actor}),new Error(`Failed to place buy offer: ${i instanceof Error?i.message:"Transaction failed or was rejected"}`)}}async getBuyOffersForAsset(e){try{const t=await fetch(`${this.atomicMarketAPI}/atomicmarket/v1/buyoffers?asset_id=${e}&state=0&sort=price&order=desc&limit=50`);if(!t.ok)throw new Error("Failed to fetch buy offers");const a=await t.json();return a.success&&a.data?a.data:[]}catch(t){return Le.logError("OfferService.getBuyOffersForAsset",t,{assetId:e}),[]}}async getUserBuyOffers(e,t){try{let a=`${this.atomicMarketAPI}/atomicmarket/v1/buyoffers?buyer=${e}&sort=created&order=desc&limit=100`;void 0!==t&&(a+=`&state=${t}`);const s=await fetch(a);if(!s.ok)throw new Error("Failed to fetch user buy offers");const n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return Le.logError("OfferService.getUserBuyOffers",a,{account:e,state:t}),[]}}async cancelBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"canceloffer",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{offer_id:t}},s=await e.transact({actions:[a]});return{success:!0,transaction_id:s?.transaction_id||s?.id||"",message:"Buy offer cancelled successfully!"}}catch(a){throw Le.logError("OfferService.cancelBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to cancel buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}async acceptBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"acceptoffer",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{offer_id:t}},s=await e.transact({actions:[a]});return{success:!0,transaction_id:s?.transaction_id||s?.id||"",message:"Buy offer accepted successfully!"}}catch(a){throw Le.logError("OfferService.acceptBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to accept buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}async declineBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"declineoffer",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{offer_id:t}},s=await e.transact({actions:[a]});return{success:!0,transaction_id:s?.transaction_id||s?.id||"",message:"Buy offer declined successfully!"}}catch(a){throw Le.logError("OfferService.declineBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to decline buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}formatPrice(e){return`${(parseFloat(e.amount)/Math.pow(10,e.token_precision)).toFixed(Math.min(4,e.token_precision))} ${e.token_symbol}`}getOfferStateText(e){switch(e){case 0:return"Pending";case 1:return"Invalid";case 2:return"Accepted";case 3:return"Declined";case 4:return"Cancelled";default:return"Unknown"}}},Ma=({isOpen:e,onClose:t,nft:a})=>{const{account:s,session:n}=Fe(),{settings:i}=at(),{showSuccess:r,showError:l}=xt(),[o,c]=O.useState([]),[d,u]=O.useState(!1),[h,m]=O.useState(null),p=O.useCallback(async()=>{if(a){u(!0);try{const e=await dt.getAssetOffers(a.asset_id);if(e&&e.length>0){const t=e.map(e=>({id:e.id,buyer:e.buyer,price:(parseFloat(e.price)/1e8).toFixed(8),symbol:e.token,timestamp:e.created,memo:e.memo})).sort((e,t)=>parseFloat(t.price)-parseFloat(e.price));c(t)}else c([])}catch(e){console.error("Failed to load offers:",e),c([])}finally{u(!1)}}},[a]);O.useEffect(()=>{e&&a&&p()},[e,a,p]);const f=e=>{const t=new Date,a=new Date(e),s=t.getTime()-a.getTime(),n=Math.floor(s/36e5),i=Math.floor(n/24);if(i>0)return`${i} day${i>1?"s":""} ago`;if(n>0)return`${n} hour${n>1?"s":""} ago`;{const e=Math.floor(s/6e4);return`${e} minute${e>1?"s":""} ago`}};return e&&a?Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"modal-content view-offers-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"View Offers"}),Se.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),Se.jsxs("div",{className:"offers-content",children:[Se.jsxs("div",{className:"view-offers-nft-info",children:[Se.jsx("div",{className:"nft-image",children:Se.jsx(Qt,{imageUrl:a.img,alt:a.name,enableAnimations:i.enableAnimatedNFTs})}),Se.jsxs("div",{className:"nft-details",children:[Se.jsx("h3",{children:a.name}),Se.jsxs("div",{className:"nft-id",children:["#",a.asset_id]}),Se.jsxs("div",{className:"collection-info",children:["string"==typeof a.collection?a.collection:a.collection?.name||a.collection?.collection_name||"Unknown"," \u2022 ",a.schema.schema_name]})]})]}),Se.jsxs("div",{className:"offers-section",children:[Se.jsxs("div",{className:"offers-header",children:[Se.jsxs("h3",{children:["Active Offers (",o.length,")"]}),Se.jsxs("button",{className:"refresh-btn",onClick:p,disabled:d,children:[d?"\ud83d\udd04":"\u21bb"," Refresh"]})]}),d?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading offers..."})]}):0===o.length?Se.jsxs("div",{className:"empty-offers",children:[Se.jsx("div",{className:"empty-icon",children:"\ud83d\udced"}),Se.jsx("h4",{children:"No Offers Yet"}),Se.jsx("p",{children:"This NFT hasn't received any offers yet. List it on the marketplace to attract buyers!"})]}):Se.jsx("div",{className:"offers-list",children:o.map((e,i)=>Se.jsxs("div",{className:"offer-card "+(0===i?"highest-offer":""),children:[Se.jsxs("div",{className:"offer-header",children:[Se.jsxs("div",{className:"buyer-info",children:[Se.jsx("strong",{children:e.buyer}),0===i&&Se.jsx("span",{className:"highest-badge",children:"\ud83c\udfc6 Highest"})]}),Se.jsx("div",{className:"offer-time",children:f(e.timestamp)})]}),Se.jsxs("div",{className:"offer-price",children:[Se.jsx("span",{className:"price-amount",children:parseFloat(e.price).toFixed(2)}),Se.jsx("span",{className:"price-symbol",children:e.symbol})]}),e.memo&&Se.jsx("div",{className:"offer-memo",children:Se.jsxs("em",{children:['"',e.memo,'"']})}),Se.jsx("div",{className:"offer-actions",children:Se.jsx("button",{className:"accept-btn",onClick:()=>(async e=>{if(!s||!n||!a)return void l("Please connect your wallet first","Wallet Required");if(window.confirm(`Accept offer of ${e.price} ${e.symbol} from ${e.buyer}?\n\nThis action cannot be undone.`)){m(e.id);try{if(!n)return void l("Wallet Not Connected","Please connect your wallet to accept offers.");await La.acceptBuyOffer(n,e.id),r("Offer Accepted!",`${e.price} ${e.symbol} will be transferred to your account.`),t()}catch(i){l("Failed to Accept Offer",i instanceof Error?i.message:"Failed to accept the offer. Please try again.")}finally{m(null)}}})(e),disabled:null!==h,children:h===e.id?"Accepting...":"Accept Offer"})})]},e.id))})]})]}),Se.jsx("div",{className:"modal-footer",children:Se.jsx("button",{className:"btn-secondary",onClick:t,children:"Close"})})]})}):null};class Ra{static async recyclePixal(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.BLEND_CONTRACT,name:"openbal",authorization:[{actor:t,permission:"active"}],data:{owner:t,token_symbol:"8,PXJ"}},{account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,quantity:this.RECYCLE_COST,memo:"deposit"}},{account:this.BLEND_CONTRACT,name:"announcedepo",authorization:[{actor:t,permission:"active"}],data:{owner:t,count:1}},{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"deposit"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.RECYCLE_BLEND_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async unpackPixelIngredientPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"unpack"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.PACK_RECIPE_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async unpackGenericPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"unpack"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.GENERIC_PACK_BLEND_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async getBlockInfo(){try{const t=[qe.WAX_CHAIN.EOSRIO,qe.WAX_CHAIN.WAXSWEDEN,qe.WAX_CHAIN.GREYMASS];for(const a of t)try{const e=await fetch(`${a}/v1/chain/get_info`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)continue;const t=await e.json(),s=t.head_block_id,n=65535&t.last_irreversible_block_num,i=s.match(/.{2}/g)?.slice(4,8)||["00","00","00","00"];return{ref_block_num:n,ref_block_prefix:parseInt(i.reverse().join(""),16)}}catch(e){Oe.warn("Failed to fetch block info from endpoint","NEFTY_BLEND",{endpoint:a,error:e});continue}throw new Error("All WAX endpoints failed")}catch(t){Le.logError("NeftyBlendService.getBlockInfo",t);const e=Date.now();return{ref_block_num:e/500&65535,ref_block_prefix:4294967295&e}}}static getExpirationTime(){return new Date((new Date).getTime()+18e5).toISOString().slice(0,-5)}static async executeRecycle(e,t){try{if(!t||!t.transact)throw new Error("Wallet not connected or does not support transactions");const a=await t.transact({actions:e.actions});return Oe.info("Recycle transaction successful","NEFTY_BLEND",{result:a}),!0}catch(a){throw Le.logError("NeftyBlendService.executeRecycle",a,{blendId:this.RECYCLE_BLEND_ID,recycleCost:this.RECYCLE_COST,actionsCount:e.actions.length,walletActor:t.actor}),a}}static async executeUnpack(e,t){try{if(!t||!t.transact)throw new Error("Wallet not connected or does not support transactions");const a=await t.transact({actions:e.actions});return Oe.info("Unpack transaction successful","NEFTY_BLEND",{result:a}),a}catch(a){throw Le.logError("NeftyBlendService.executeUnpack",a,{actionsCount:e.actions.length,walletActor:t.actor}),a}}static isPackNFT(e){if(!e||!e.template)return!1;const t=(e.template.name||"").toLowerCase(),a=["pack","container","box","chest"].some(e=>t.includes(e)),s=e.template?.template_id===this.PACK_TEMPLATE_ID;return a||s}static getPackType(e){return this.isPackNFT(e)?e.template?.template_id===this.PACK_TEMPLATE_ID?"pixel_ingredient":"generic":null}static async unpackPixelPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"neftyblocksp",asset_ids:[e],memo:"unbox"}}],transaction_extensions:[]}}static async unpackPixelPacksBulk(e,t){const a=[];for(let s=0;s<e.length;s+=20){const n=e.slice(s,s+20),i=await this.getBlockInfo(),r={expiration:this.getExpirationTime(),ref_block_num:i.ref_block_num,ref_block_prefix:i.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:n.map(e=>({account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"neftyblocksp",asset_ids:[e],memo:"unbox"}})),transaction_extensions:[]};a.push(r)}return a}static isPixelPack(e){return e.template?.template_id===this.PACK_TEMPLATE_ID}}M(Ra,"BLEND_CONTRACT","blend.nefty"),M(Ra,"ATOMIC_ASSETS_CONTRACT","atomicassets"),M(Ra,"PXJ_CONTRACT","pixeljourney"),M(Ra,"RECYCLE_BLEND_ID",37700),M(Ra,"RECYCLE_COST","12000.00000000 PXJ"),M(Ra,"PACK_TEMPLATE_ID","820134"),M(Ra,"PACK_RECIPE_ID",37701),M(Ra,"GENERIC_PACK_BLEND_ID",37702);const Wa=({isOpen:e,onClose:t,selectedNFTs:a,userAccount:s,walletSession:n,onUnpackComplete:i})=>{const[r,l]=O.useState(!1),{showError:o,showSuccess:c}=xt(),d=a.filter(e=>Ra.isPackNFT(e));if(!e)return null;const u=d.length>0;return Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"modal-content unpack-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Unpack NFT"}),Se.jsx("button",{className:"modal-close",onClick:t,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"unpack-nft-info",children:[Se.jsxs("h3",{children:["Selected Pack NFTs (",d.length,")"]}),d.map(e=>Se.jsxs("div",{className:"nft-item",children:[Se.jsx("div",{className:"nft-image",children:Se.jsx("img",{src:e.img,alt:e.name})}),Se.jsxs("div",{className:"nft-details",children:[Se.jsx("h4",{children:e.name}),Se.jsx("p",{className:"collection-name",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),Se.jsx("p",{className:"schema-name",children:e.schema.schema_name}),e.mint_number&&Se.jsxs("p",{className:"mint-number",children:["Mint #",e.mint_number]})]})]},e.asset_id))]}),u?Se.jsxs("div",{className:"unpack-info",children:[Se.jsxs("div",{className:"info-box",children:[Se.jsx("h4",{children:"\ud83d\udce6 Pack Contents"}),Se.jsxs("div",{className:"pack-contents",children:[Se.jsx("p",{children:"These packs contain random rewards that will be revealed upon unpacking."}),Se.jsx("p",{className:"warning",children:"\u26a0\ufe0f Unpacking will burn these packs permanently!"})]})]}),Se.jsx("button",{className:"unpack-btn",onClick:async()=>{if(!s||!n)return void o("Wallet not connected","Connection Required");if(0===d.length)return void o("No pack NFTs selected","No Packs Selected");l(!0);const e=[];try{for(const t of d){let a;a="pixel_ingredient"===Ra.getPackType(t)?await Ra.unpackPixelIngredientPack(t.asset_id,s):await Ra.unpackGenericPack(t.asset_id,s);const i=await Ra.executeUnpack(a,n);e.push({nft:t,transaction:i,success:!0})}c("Packs unpacked successfully!","Unpack Complete"),i()}catch(t){console.error("Error unpacking NFTs:",t),o("Failed to unpack NFTs. Please try again.","Unpack Failed")}finally{l(!1)}},disabled:r||!n,children:r?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"loading-spinner small"}),"Unpacking..."]}):`\ud83d\udce6 Unpack ${d.length} Pack${d.length>1?"s":""}`})]}):Se.jsx("div",{className:"cannot-unpack",children:Se.jsxs("div",{className:"info-box error",children:[Se.jsx("h4",{children:"\u274c Cannot Unpack"}),Se.jsx("p",{children:"No pack NFTs selected for unpacking."}),Se.jsx("p",{children:"Only packs, chests, boxes, and containers can be unpacked."})]})})]})]})})},Oa=({children:e})=>{const[t,a]=O.useState({isConnected:!1,account:null,session:null,login:async()=>null,logout:async()=>{},transact:async()=>null,purchaseNFT:async()=>null,batchPurchaseNFTs:async()=>null,executeCraftingTransaction:async()=>null,executeTransaction:async()=>{throw new Error("Wallet not connected")},isLoading:!0});return O.useEffect(()=>Kt.subscribe(e=>{a(e)}),[]),Se.jsx(Ie.Provider,{value:t,children:e})},Da=()=>{const e=O.useContext(Ie);if(void 0===e)throw new Error("useWallet must be used within a WalletProvider");return e},Ua=({nfts:e,isOpen:t,onClose:a,onSuccess:s})=>{const{showSuccess:n,showError:i}=xt(),r=Da(),[l,o]=O.useState(""),[c,d]=O.useState(0),[u,h]=O.useState(1),[m,p]=O.useState(0),[f,x]=O.useState(0),[g,v]=O.useState(""),[y,j]=O.useState(!1),[b,N]=O.useState("name_asc");O.useEffect(()=>{t&&(o(""),d(0),h(1),p(0),x(0),v(""),j(!1))},[t]);const w=O.useMemo(()=>{const t=[...e];switch(b){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));default:return t}},[e,b]),k=()=>7*c*24*3600+24*u*3600+3600*m+60*f,_=(e,t)=>{const a=Math.max(0,Math.min(t,S(e)));switch(e){case"weeks":d(a);break;case"days":h(a);break;case"hours":p(a);break;case"minutes":x(a)}},S=e=>{switch(e){case"weeks":return 4;case"days":return 30;case"hours":return 23;case"minutes":return 59;default:return 0}},C=()=>{const e=[];return c>0&&e.push(`${c}w`),u>0&&e.push(`${u}d`),m>0&&e.push(`${m}h`),f>0&&e.push(`${f}m`),e.length>0?e.join(" "):"0m"};return t?Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal-content bulk-auction-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Create Bulk Auction"}),Se.jsx("button",{className:"modal-close",onClick:a,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"selected-nfts-section",children:[Se.jsxs("div",{className:"selected-nfts-header",children:[Se.jsxs("h3",{children:["Selected NFTs (",e.length,")"]}),e.length>1&&Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"auction-sort",children:"Sort by:"}),Se.jsxs("select",{id:"auction-sort",className:"sort-select",value:b,onChange:e=>N(e.target.value),children:[Se.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),Se.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),Se.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),Se.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),Se.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),Se.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),Se.jsxs("div",{className:"selected-nfts-grid",children:[w.slice(0,6).map(e=>Se.jsxs("div",{className:"selected-nft-item",children:[Se.jsx("div",{className:"nft-image-container",children:Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name||`Asset #${e.asset_id}`,className:"nft-image"})}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("span",{className:"nft-name",children:e.name}),Se.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"})]})]},e.asset_id)),e.length>6&&Se.jsxs("div",{className:"more-nfts-indicator",children:["+",e.length-6," more"]})]})]}),Se.jsxs("div",{className:"auction-settings",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"startingPrice",children:"Starting Price (WAX)"}),Se.jsx("input",{type:"number",id:"startingPrice",value:l,onChange:e=>o(e.target.value),placeholder:"Enter starting price",min:"0",step:"0.01",disabled:y})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Auction Duration"}),Se.jsxs("div",{className:"duration-inputs",children:[Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Weeks"}),Se.jsx("input",{type:"number",className:"duration-input",value:c,onChange:e=>_("weeks",parseInt(e.target.value)||0),min:"0",max:S("weeks"),disabled:y})]}),Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Days"}),Se.jsx("input",{type:"number",className:"duration-input",value:u,onChange:e=>_("days",parseInt(e.target.value)||0),min:"0",max:S("days"),disabled:y})]}),Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Hours"}),Se.jsx("input",{type:"number",className:"duration-input",value:m,onChange:e=>_("hours",parseInt(e.target.value)||0),min:"0",max:S("hours"),disabled:y})]}),Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Minutes"}),Se.jsx("input",{type:"number",className:"duration-input",value:f,onChange:e=>_("minutes",parseInt(e.target.value)||0),min:"0",max:S("minutes"),disabled:y})]})]}),Se.jsxs("div",{className:"duration-summary",children:[Se.jsx("span",{className:"duration-display",children:C()}),Se.jsxs("span",{className:"duration-total",children:["(",k().toLocaleString(),"s)"]})]})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"auctionMemo",children:"Memo (Optional)"}),Se.jsx("textarea",{id:"auctionMemo",value:g,onChange:e=>v(e.target.value),placeholder:"Add a note about this auction batch...",rows:3,maxLength:256,disabled:y})]})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"cancel-btn",onClick:a,disabled:y,children:"Cancel"}),Se.jsx("button",{className:"create-btn",onClick:async()=>{if(!l||parseFloat(l)<=0)return void i("Invalid Price","Please enter a valid starting price");const t=k();if(t<3600)i("Invalid Duration","Auction duration must be at least 1 hour");else if(t>2592e3)i("Invalid Duration","Auction duration cannot exceed 30 days");else{j(!0);try{const i=`${parseFloat(l).toFixed(8)} WAX`,o=e.map(e=>({account:"atomicmarket",name:"announceauct",authorization:[{actor:r.account||"",permission:"active"}],data:{seller:r.account||"",asset_ids:[parseInt(e.asset_id)],starting_bid:i,duration:t,maker_marketplace:"market.pxj"}}));await r.transact(o);const c=C();n("Bulk Auction Created",`Successfully created auctions for ${e.length} NFT${1!==e.length?"s":""} with starting price ${l} WAX and duration ${c}. Remember to transfer your assets to the atomicmarket contract to activate the auctions.`),s(),a()}catch(o){console.error("Bulk auction creation failed:",o),i("Auction Creation Failed",o instanceof Error?o.message:"Failed to create bulk auctions. Please try again.")}finally{j(!1)}}},disabled:y||!l||parseFloat(l)<=0||k()<3600,children:y?"Creating...":`Create ${e.length} Auction${1!==e.length?"s":""}`})]})]})}):null};const Ba=new class{constructor(){M(this,"WAX_API_BASE","https://wax.eosrio.io/v1/chain"),M(this,"ATOMIC_API_BASE","https://wax-api.hivebp.io/api")}async getFeeTokens(){for(let t=1;t<=3;t++)try{const e=new AbortController,t=setTimeout(()=>e.abort(),1e4),a=await fetch(`${this.WAX_API_BASE}/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"rwax",scope:"rwax",table:"feetokens",json:!0,limit:100}),signal:e.signal});if(clearTimeout(t),!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const s=await a.json();if(!s.rows||!Array.isArray(s.rows))return De.error("Invalid fee tokens response structure:",s),[];const n=["honey-honeyhiveio","lswax-liquidstaked"],i=await this.fetchAlcorTokenRates(n),r=await Promise.all(s.rows.map(async e=>{const t=e.fee.match(/([0-9.]+)\s+([A-Z]+)/),a=t?t[2]:"UNKNOWN",s=t?t[1]:"0";let n;if("WAX"!==a)try{n=await this.calculateLiveWaxValue(a,s,i)}catch(r){if(De.warn(`Failed to get live WAX value for ${a}, using exchange rate fallback`,"RWaxService.getFeeTokens"),e.exchange_rate){const t=parseFloat(e.exchange_rate),a=parseFloat(s);isNaN(t)||isNaN(a)||(n=(a/t).toFixed(8))}}return{fee:e.fee,contract:e.contract,exchange_rate:e.exchange_rate,symbol:a,amount:s,wax_value:n}}));return De.info(`Successfully fetched ${r.length} fee tokens with live WAX conversions`),r}catch(e){if(De.error(`Attempt ${t} failed to fetch fee tokens:`,e instanceof Error?e.message:String(e)),3===t)throw new Error(`Failed to fetch fee tokens after 3 attempts: ${e}`);await new Promise(e=>setTimeout(e,1e3))}return[]}async fetchAlcorTokenRates(e){try{const t=`https://wax.alcor.exchange/api/v2/tokens/${e.join(",")}`,a=await fetch(t),s=await a.json(),n=new Map;return s.forEach(e=>{const t=`${e.symbol.toLowerCase()}-${e.contract}`;n.set(t,parseFloat(e.system_price)||0)}),n}catch(t){return De.error("Failed to fetch Alcor V2 rates:","RWaxService.fetchAlcorTokenRates",t),new Map}}async calculateLiveWaxValue(e,t,a){const s=parseFloat(t);if(isNaN(s))throw new Error(`Invalid amount: ${t}`);try{switch(e.toUpperCase()){case"WPIXAL":{const e=await Ke.getWpixalPriceWAX();return(s*e).toFixed(8)}case"PXJ":{const e=await Ke.getPxjPriceUSD(),t=await Ke.getWaxPriceUSD();if(t>0){return(s*e/t).toFixed(8)}throw new Error("WAX price is zero")}case"HONEY":{const e=a?.get("honey-honeyhiveio")||0;if(e>0){return(s*e).toFixed(8)}throw new Error("HONEY/WAX rate not available")}case"LSWAX":{const e=a?.get("lswax-liquidstaked")||0;if(e>0){return(s*e).toFixed(8)}return(1.1616*s).toFixed(8)}default:throw De.warn(`Unknown token symbol for live conversion: ${e}`,"RWaxService.calculateLiveWaxValue"),new Error(`Unsupported token: ${e}`)}}catch(n){throw De.error(`Failed to calculate live WAX value for ${e}:`,"RWaxService.calculateLiveWaxValue",n),n}}async getAssetPoolInfo(e){for(let a=1;a<=3;a++)try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),s=await fetch(`${this.WAX_API_BASE}/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"rwax",scope:"WPIXAL",table:"assetpools",json:!0,limit:1,lower_bound:e,upper_bound:e,key_type:"i64"}),signal:t.signal});if(clearTimeout(a),!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const n=await s.json();if(!n.rows||!Array.isArray(n.rows)||0===n.rows.length)return null;const i=n.rows[0];return{assetId:i.asset_id,issuedTokens:i.issued_tokens}}catch(t){if(De.error(`Attempt ${a} failed to fetch asset pool info for ${e}:`,t instanceof Error?t.message:String(t)),3===a)return De.error(`Failed to fetch asset pool info after 3 attempts: ${t}`),null;await new Promise(e=>setTimeout(e,1e3))}return null}async getTokenizedAssets(e=36,t=0,a="rarity_score_desc",s=""){let n=null;for(let r=1;r<=3;r++)try{const n=new URLSearchParams({term:"",owner:"rwax",collection:"pixeljourney",schema:"pixals",category:"",recent:"",order_by:a,limit:e.toString(),search_type:"inventory",offer_type:"sales",min_price:"0",max_price:"0",offset:t.toString(),verified:"all",favorites:"false",user:"pixeljourney",contract:"",attributes:s,only:"rwax",rwax_contract:"pixeljourney",rwax_symbol:"WPIXAL"}),i=`${this.ATOMIC_API_BASE}/assets?${n.toString()}`;De.info(`Fetching tokenized assets from: ${i}`,"RWaxService");const r=await fetch(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const l=await r.json();return De.debug("RWAX API Response received","RWaxService.getTokenizedAssets",{dataLength:Array.isArray(l)?l.length:"not array"}),Array.isArray(l)?l:[]}catch(i){if(n=i instanceof Error?i:new Error(String(i)),De.error(`Attempt ${r}/3 failed:`,"RWaxService.getTokenizedAssets",n),3===r){De.warn("API failed, returning test data with original structure","RWaxService.getTokenizedAssets");return[{assetId:1099932947523,name:"Pixal 09106",schema:"pixals",owner:"rwax",burned:!1,mint:9106,contract:"atomicassets",collection:{collectionName:"pixeljourney",displayName:"Pixel Journey",collectionImage:"QmVnrLdB1xQ9EMzgw5srW6u8WKQpTjmYz6fBi2g7ic8iob",verification:!0,blacklisted:!1},transferable:!0,burnable:!0,mutableData:[],immutableData:[{key:"Background",value:["string","Nefty Spot"]},{key:"Body",value:["string","Pink-Blue Overalls"]},{key:"Eyes",value:["string","Kawaii Green"]},{key:"Head",value:["string","Grey"]},{key:"img",value:["string","Qma9rcg1NHxhvG5CMDecS3bo14gpQSr6QFieUXsFPrG14T"]},{key:"name",value:["string","Pixal 09106"]}],rarityScore:419.80619503583694,attributesFloor:501,rwax:{symbol:"WPIXAL",contract:"pixeljourney",decimals:8,tokenName:"Wrapped Pixal",redeemAmount:1.09997216},image:"Qma9rcg1NHxhvG5CMDecS3bo14gpQSr6QFieUXsFPrG14T",template:{templateId:781515}},{assetId:1099931322703,name:"Pixal 06238",schema:"pixals",owner:"rwax",burned:!1,mint:6238,contract:"atomicassets",collection:{collectionName:"pixeljourney",displayName:"Pixel Journey",verification:!0,blacklisted:!1},transferable:!0,burnable:!0,mutableData:[],immutableData:[{key:"Background",value:["string","Blue Sky"]},{key:"Body",value:["string","Red Shirt"]},{key:"Eyes",value:["string","Brown"]},{key:"Head",value:["string","Black Hair"]},{key:"img",value:["string","QmTestImage2"]},{key:"name",value:["string","Pixal 06238"]}],rarityScore:350.5,attributesFloor:400,rwax:{symbol:"WPIXAL",contract:"pixeljourney",decimals:8,tokenName:"Wrapped Pixal",redeemAmount:1.25},image:"QmTestImage2",template:{templateId:781516}}].slice(t,t+e)}}throw n||new Error("Failed to fetch tokenized assets")}async getAssetWPIXALAmount(e){try{const t=`${this.WAX_API_BASE}/get_table_rows`,a={code:"pixeljourney",index_position:"primary",json:!0,key_type:"i64",limit:1,reverse:!1,lower_bound:e,upper_bound:e,scope:"pixeljourney",show_payer:!1,table:"assetpools",table_key:""},s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw new Error(`Failed to fetch WPIXAL amount: ${s.statusText}`);const n=await s.json();return n.rows&&n.rows.length>0?n.rows[0].issued_tokens:"0.00000000 WPIXAL"}catch(t){return De.error("Error fetching WPIXAL amount:","RWaxService.getAssetWPIXALAmount",t instanceof Error?t:new Error(String(t))),"0.00000000 WPIXAL"}}async getUserPixalAssets(e,t=36,a=0){let s=null;for(let i=1;i<=3;i++)try{const s=`https://wax.api.atomicassets.io/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&schema_name=pixals&limit=${t}&page=${Math.floor(a/t)+1}&order=desc&sort=asset_id`;De.info(`Fetching user assets from: ${s}`,"RWaxService");const n=await fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return i&&i.data&&Array.isArray(i.data)?i.data.map(e=>{let t="";const a=[e.data?.img,e.data?.image,e.immutable_data?.img,e.immutable_data?.image,e.template?.immutable_data?.img,e.template?.immutable_data?.image];for(const s of a)if(s&&"string"==typeof s){t=s;break}return t&&!t.startsWith("http")&&(t.startsWith("Qm")||t.startsWith("/ipfs/")?t=`https://ipfs.io/ipfs/${t.replace("/ipfs/","")}`:t.startsWith("ipfs://")&&(t=t.replace("ipfs://","https://ipfs.io/ipfs/"))),{assetId:parseInt(e.asset_id)||0,name:e.name||e.data?.name||e.immutable_data?.name||`Pixal #${e.asset_id}`,image:t,schema:e.schema?.schema_name||e.schema_name||"pixals",owner:e.owner||"",burned:e.burned||!1,mint:e.template_mint||0,contract:e.contract||"atomicassets",collection:{collectionName:e.collection?.collection_name||e.collection_name||"pixeljourney",displayName:e.collection?.name||e.collection?.collection_name||"Pixel Journey",verification:e.collection?.authorized_accounts?.length>0||!0,blacklisted:!1},transferable:!1!==e.transferable,burnable:!1!==e.burnable,mutableData:Array.isArray(e.mutable_data)?e.mutable_data:[],immutableData:Array.isArray(e.immutable_data)?e.immutable_data:[],template:{templateId:parseInt(e.template?.template_id||e.template_id||"0")}}}):(De.error("Invalid user assets API response structure:",i),[])}catch(n){if(s=n instanceof Error?n:new Error(String(n)),De.error(`Attempt ${i}/3 failed:`,"RWaxService.getUserPixalAssets",s),3===i)return De.error("All attempts failed, returning empty array","RWaxService.getUserPixalAssets"),[];await new Promise(e=>setTimeout(e,1e3*i))}return[]}async executeTokenization(e,t){try{const{wharfKitService:a}=await K(async()=>{const{wharfKitService:e}=await Promise.resolve().then(()=>Yt);return{wharfKitService:e}},void 0);if(!a.isLoggedIn())throw new Error("Wallet not connected");const s=a.getAccountName();if(!s)throw new Error("No account found");const n=[{account:"nft.hive",name:"boost",authorization:[{actor:s,permission:"active"}],data:{booster:s}},{account:t.contract,name:"transfer",authorization:[{actor:s,permission:"active"}],data:{from:s,to:"rwax",quantity:t.fee,memo:"payfee"}},{account:"atomicassets",name:"transfer",authorization:[{actor:s,permission:"active"}],data:{from:s,to:"rwax",asset_ids:e,memo:"deposit"}},{account:"rwax",name:"tokenizenfts",authorization:[{actor:s,permission:"active"}],data:{user:s,asset_ids:e,fee_currency:`8,${t.symbol}`}}],i=await a.transact(n);return De.info("Tokenization transaction executed successfully","RWaxService.executeTokenization",{result:i}),i}catch(a){throw De.error("Error executing tokenization:","RWaxService.executeTokenization",a instanceof Error?a:new Error(String(a))),a}}async executeRedemption(e,t,a){try{const{wharfKitService:s}=await K(async()=>{const{wharfKitService:e}=await Promise.resolve().then(()=>Yt);return{wharfKitService:e}},void 0);if(!s.isLoggedIn())throw new Error("Wallet not connected");const n=s.getAccountName();if(!n)throw new Error("No account found");const i=[{account:"nft.hive",name:"boost",authorization:[{actor:n,permission:"active"}],data:{booster:n}},{account:a.contract,name:"transfer",authorization:[{actor:n,permission:"active"}],data:{from:n,to:"rwax",quantity:a.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:n,permission:"active"}],data:{from:n,to:"rwax",quantity:t,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:n,permission:"active"}],data:{redeemer:n,contract:"pixeljourney",quantity:t,asset_id:e,fee_currency:`8,${a.symbol}`}}],r=await s.transact(i);return De.info("Redemption transaction executed successfully","RWaxService.executeRedemption",{result:r}),r}catch(s){throw De.error("Error executing redemption:","RWaxService.executeRedemption",s instanceof Error?s:new Error(String(s))),s}}},za=({isOpen:e,onClose:t,onSuccess:a,nft:s})=>{const[n,i]=O.useState([]),[r,l]=O.useState(null),[o,c]=O.useState(!1),{showError:d}=xt();O.useEffect(()=>{e&&u()},[e]);const u=async()=>{try{c(!0);const e=await Ba.getFeeTokens();i(e);const t=e.find(e=>"WAX"===e.symbol);t&&l(t)}catch(e){De.error("Failed to load fee tokens","TokenizeFeeModal.loadFeeTokens",e),d("Failed to load fee tokens")}finally{c(!1)}},h=()=>{l(null),t()};return e?z.createPortal(Se.jsx("div",{className:"modal-overlay",onClick:h,children:Se.jsxs("div",{className:"modal-content tokenize-fee-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"\ud83e\ude99 Tokenize into WPIXAL"}),Se.jsx("button",{className:"close-button",onClick:h,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[s&&Se.jsxs("div",{className:"tokenize-asset-preview",children:[Se.jsx("img",{src:C(s.img),alt:s.name,className:"tokenize-asset-image",onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),Se.jsx("h3",{children:s.name}),Se.jsx("p",{className:"tokenize-description",children:"This will tokenize your Pixal PFP into WPIXAL tokens on the RWAX platform."})]}),o?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading fee options..."})]}):Se.jsxs("div",{className:"fee-selection",children:[Se.jsx("h4",{children:"Select Fee Token:"}),Se.jsx("div",{className:"fee-options",children:n.map((e,t)=>Se.jsxs("div",{className:"fee-option "+(r===e?"selected":""),onClick:()=>l(e),children:[Se.jsxs("div",{className:"fee-info",children:[Se.jsx("span",{className:"fee-amount",children:e.fee}),Se.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&Se.jsxs("div",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"cancel-button",onClick:h,children:"Cancel"}),Se.jsx("button",{className:"confirm-button tokenize-confirm",onClick:async()=>{if(r&&s)try{c(!0),await Ba.executeTokenization([s.asset_id],r),a?.(),h()}catch(e){De.error("Failed to tokenize asset","TokenizeFeeModal.handleConfirm",e),d("Failed to tokenize asset")}finally{c(!1)}},disabled:!r||o,children:"Tokenize Asset"})]})]})}),document.body):null};const Xa=new class{constructor(){M(this,"MAX_BATCH_SIZE",10),M(this,"RETRY_ATTEMPTS",3),M(this,"RETRY_DELAY",1e3),M(this,"FARMS_CONTRACT","farms.waxdao"),M(this,"TOKEN_FARMS_CONTRACT","tf.waxdao"),M(this,"PXJ_CONTRACT","pixeljourney"),M(this,"WUF_CONTRACT","wuffi"),M(this,"PXJ_FARM_NAME","pxjfarm1")}async stakeNFTsPixelJourney(e,t,a="pixeljourney"){try{const s={account:this.FARMS_CONTRACT,name:"stakenfts",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{user:Gt.safeGetActor(e),farmname:a,assets_to_stake:t}},n=await this.executeTransactionWithRetry(e,[s]);return n.success&&Oe.info("NFTs Staked Successfully","StakingService",{user:Gt.safeGetActor(e),farm_name:a,asset_count:t.length,asset_ids:t,transaction_id:n.transaction_id}),n}catch(s){return Oe.error("stakeNFTsPixelJourney failed","StakingService",s,{asset_ids:t,farm_name:a}),{success:!1,error:s instanceof Error?s.message:"Unknown error",transaction_id:"",gas_used:0}}}async unstakeNFTsPixelJourney(e,t,a="pixeljourney"){try{const s={account:this.FARMS_CONTRACT,name:"unstake",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{user:Gt.safeGetActor(e),farmname:a,asset_ids:t}},n=await this.executeTransactionWithRetry(e,[s]);return n.success&&Oe.info("NFTs Unstaked Successfully","StakingService",{user:Gt.safeGetActor(e),farm_name:a,asset_count:t.length,asset_ids:t,transaction_id:n.transaction_id}),n}catch(s){return Oe.error("unstakeNFTsPixelJourney failed","StakingService",s,{asset_ids:t,farm_name:a}),{success:!1,error:s instanceof Error?s.message:"Unknown error",transaction_id:"",gas_used:0}}}async stakeNFTsBatch(e,t,a="pixeljourney"){const s={success:!0,successful_transactions:[],failed_transactions:[],total_gas_used:0};try{const i=this.createBatches(t,this.MAX_BATCH_SIZE);for(const t of i)try{const n=await this.processBatch(e,t,"stake",a);s.successful_transactions.push(...n.successful_transactions),s.failed_transactions.push(...n.failed_transactions),s.total_gas_used+=n.total_gas_used,i.indexOf(t)<i.length-1&&await this.delay(500)}catch(n){t.forEach(e=>{s.failed_transactions.push({asset_id:e,error:n instanceof Error?n.message:"Batch processing failed"})})}return s.success=0===s.failed_transactions.length,Oe.info("NFT Staking Batch Operation","StakingService",{total_assets:t.length,successful:s.successful_transactions.length,failed:s.failed_transactions.length,farm_name:a}),s}catch(n){return Oe.error("stakeNFTsBatch failed","StakingService",n,{asset_ids:t,farm_name:a}),{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:n instanceof Error?n.message:"Unknown error"})),total_gas_used:0}}}async unstakeNFTsBatch(e,t){const a={success:!0,successful_transactions:[],failed_transactions:[],total_gas_used:0};try{const n=this.createBatches(t,this.MAX_BATCH_SIZE);for(const t of n)try{const s=await this.processBatch(e,t,"unstake");a.successful_transactions.push(...s.successful_transactions),a.failed_transactions.push(...s.failed_transactions),a.total_gas_used+=s.total_gas_used,n.indexOf(t)<n.length-1&&await this.delay(500)}catch(s){t.forEach(e=>{a.failed_transactions.push({asset_id:e,error:s instanceof Error?s.message:"Batch processing failed"})})}return a.success=0===a.failed_transactions.length,Oe.info("NFT Unstaking Batch Operation","StakingService",{total_assets:t.length,successful:a.successful_transactions.length,failed:a.failed_transactions.length}),a}catch(s){return Oe.error("unstakeNFTsBatch failed","StakingService",s,{asset_ids:t}),{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:s instanceof Error?s.message:"Unknown error"})),total_gas_used:0}}}async claimAllRewards(e,t="pixeljourney"){try{const a=[{account:this.FARMS_CONTRACT,name:"claim",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{user:Gt.safeGetActor(e),farmname:t}}],s=await this.executeTransactionWithRetry(e,a);return s.success&&Oe.info("Rewards Claimed Successfully","StakingService",{user:Gt.safeGetActor(e),farm_name:t,transaction_id:s.transaction_id}),s}catch(a){return Oe.error("claimAllRewards failed","StakingService",a,{user:Gt.safeGetActor(e),farm_name:t}),{success:!1,error:a instanceof Error?a.message:"Failed to claim rewards"}}}async getStakingInfo(e,t="pixeljourney"){try{const a=await fetch(`${qe.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.FARMS_CONTRACT,scope:this.FARMS_CONTRACT,table:"stakers",lower_bound:e,upper_bound:e,limit:1e3})});if(!a.ok)throw new Error(`Failed to fetch staking info: ${a.statusText}`);const s=(await a.json()).rows.find(t=>t.user===e)||{},n=s.staked_assets||[],i=s.pending_rewards||[],r=n.map(e=>({asset_id:e,template_id:"0",farm_name:t,stake_time:Date.now()/1e3,rewards_per_hour:{pxj:0,wuf:0},multiplier:1}))||[],l=i.map(e=>({token:e.quantity.split(" ")[1],amount:parseFloat(e.quantity.split(" ")[0]),contract:e.contract,precision:4})),o=r.reduce((e,t)=>e+Object.values(t.rewards_per_hour).reduce((e,t)=>e+t,0)*t.multiplier,0),c=[{token:"PXJ",amount:r.reduce((e,t)=>e+24*(t.rewards_per_hour.pxj||0),0),contract:this.PXJ_CONTRACT,precision:4},{token:"WUF",amount:r.reduce((e,t)=>e+24*(t.rewards_per_hour.wuf||0),0),contract:this.WUF_CONTRACT,precision:4}];return{staked_nfts:r,pending_rewards:l,total_staking_power:o,estimated_daily_rewards:c}}catch(a){return Oe.error("getStakingInfo failed","StakingService",a,{account:e,farm_name:t}),{staked_nfts:[],pending_rewards:[],total_staking_power:0,estimated_daily_rewards:[]}}}async stakeTokens(e,t,a=this.PXJ_FARM_NAME){try{const s=[{account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{from:Gt.safeGetActor(e),to:this.TOKEN_FARMS_CONTRACT,quantity:t,memo:`stake:${a}`}}],n=await this.executeTransactionWithRetry(e,s);return n.success&&Oe.info("Token staked successfully","StakingService",{type:"token_stake",user:Gt.safeGetActor(e),amount:t,farm_name:a}),n}catch(s){return Oe.error("stakeTokens failed","StakingService",s,{user:Gt.safeGetActor(e),amount:t,farm_name:a}),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async unstakeTokens(e,t,a=this.PXJ_FARM_NAME){try{const s=[{account:this.TOKEN_FARMS_CONTRACT,name:"unstake",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{user:Gt.safeGetActor(e),farm_name:a,quantity:t}}],n=await this.executeTransactionWithRetry(e,s);return n.success&&Oe.info("Token unstaked successfully","StakingService",{type:"token_unstake",user:Gt.safeGetActor(e),amount:t,farm_name:a}),n}catch(s){return Oe.error("unstakeTokens failed","StakingService",s,{user:Gt.safeGetActor(e),amount:t,farm_name:a}),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async claimTokenFarmRewards(e,t=this.PXJ_FARM_NAME){try{const a=[{account:this.TOKEN_FARMS_CONTRACT,name:"getreward",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{user:Gt.safeGetActor(e),farm_name:t}}],s=await this.executeTransactionWithRetry(e,a);return s.success&&Oe.info("Token farm rewards claimed successfully","StakingService",{type:"token_claim_rewards",user:Gt.safeGetActor(e),farm_name:t}),s}catch(a){return Oe.error("claimTokenFarmRewards failed","StakingService",a,{user:Gt.safeGetActor(e),farm_name:t}),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async getTokenFarmInfo(e=this.PXJ_FARM_NAME){try{const t=await fetch(`${qe.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.TOKEN_FARMS_CONTRACT,scope:this.TOKEN_FARMS_CONTRACT,table:"farms",lower_bound:e,upper_bound:e,limit:1})});if(!t.ok)throw new Error(`Failed to fetch farm info: ${t.statusText}`);const a=(await t.json()).rows.find(t=>t.farm_name===e);return a?{farm_name:a.farm_name,creator:a.creator,time_created:a.time_created,staking_token:a.staking_token,incentive_count:a.incentive_count,total_staked:a.total_staked,vesting_time:a.vesting_time,last_update_time:a.last_update_time}:null}catch(t){return Oe.error("getTokenFarmInfo failed","StakingService",t,{farm_name:e}),null}}async getTokenStakingInfo(e,t=this.PXJ_FARM_NAME){try{const a=await fetch(`${qe.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.TOKEN_FARMS_CONTRACT,scope:t,table:"stakers",lower_bound:e,upper_bound:e,limit:1})});if(!a.ok)throw new Error(`Failed to fetch token staking info: ${a.statusText}`);const s=(await a.json()).rows.find(t=>t.user===e);if(!s)return null;const n=(s.pending_rewards||[]).map(e=>({token:e.quantity.split(" ")[1],amount:parseFloat(e.quantity.split(" ")[0]),contract:e.contract,precision:4}));return{farm_name:t,user:s.user,staked_amount:s.staked_amount,stake_time:s.stake_time,pending_rewards:n,vesting_time:s.vesting_time,last_claim_time:s.last_claim_time}}catch(a){return Oe.error("getTokenStakingInfo failed","StakingService",a,{account:e,farm_name:t}),null}}async calculateOptimalStakingStrategy(e,t="pixeljourney"){try{const a=await this.getStakingInfo(e,t),s=new Set(a.staked_nfts.map(e=>e.asset_id)),n=await fetch(`${dt.atomicAssetsAPI}/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&page=1&limit=1000&order=desc&sort=asset_id`);if(!n.ok)throw new Error("Failed to fetch available NFTs");const i=await n.json(),r=i.data?.filter(e=>!s.has(e.asset_id)).map(e=>({asset_id:e.asset_id,template_id:e.template.template_id,farm_name:t,stake_time:0,rewards_per_hour:this.calculateRewardsPerHour(e.template.template_id),multiplier:1}))||[],l=await this.getTemplateRewards(),o=r.map(e=>{const t=l[e.template_id]||{pxj:0,wuf:0},a=this.getRarityMultiplier(this.getTemplateRarity(e.template_id)),s=24*(t.pxj+t.wuf)*a;return{asset_id:e.asset_id,expected_daily_return:s,priority:this.calculateStakingPriority(this.getTemplateRarity(e.template_id),s)}}).sort((e,t)=>t.priority-e.priority),c=o.reduce((e,t)=>e+t.expected_daily_return,0);return{recommended_stakes:o,total_expected_daily_return:c,optimization_tips:this.generateOptimizationTips(o,r),available_nfts:r}}catch(a){return Oe.error("calculateOptimalStakingStrategy failed","StakingService",a,{account:e}),{recommended_stakes:[],total_expected_daily_return:0,optimization_tips:["Unable to calculate optimal strategy. Please try again later."],available_nfts:[]}}}async processBatch(e,t,a,s){const n=t.map(t=>"stake"===a?{account:this.FARMS_CONTRACT,name:"stake",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{owner:Gt.safeGetActor(e),asset_id:t,farm_name:s||"pixeljourney"}}:{account:this.FARMS_CONTRACT,name:"unstake",authorization:[{actor:Gt.safeGetActor(e),permission:Gt.safeGetPermission(e)}],data:{owner:Gt.safeGetActor(e),asset_id:t}});try{const a=await this.executeTransactionWithRetry(e,n);return a.success?{success:!0,successful_transactions:t,failed_transactions:[],total_gas_used:a.gas_used||0}:{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:a.error||"Transaction failed"})),total_gas_used:0}}catch(i){return{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:i instanceof Error?i.message:"Unknown error"})),total_gas_used:0}}}async executeTransactionWithRetry(e,t,a=1){try{const a=await e.transact({actions:t});return{success:!0,transaction_id:a?.transaction_id||a?.id||"",gas_used:a?.cpu_usage_us||a?.max_net_usage_words||0}}catch(s){return a<this.RETRY_ATTEMPTS?(await this.delay(this.RETRY_DELAY*a),this.executeTransactionWithRetry(e,t,a+1)):{success:!1,error:s instanceof Error?s.message:"Transaction failed"}}}createBatches(e,t){const a=[];for(let s=0;s<e.length;s+=t)a.push(e.slice(s,s+t));return a}delay(e){return new Promise(t=>setTimeout(t,e))}async getTemplateRewards(){try{const e=await fetch(`${qe.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.FARMS_CONTRACT,scope:this.FARMS_CONTRACT,table:"templrewards",limit:1e3})});if(!e.ok)throw new Error("Failed to fetch template rewards");const t=await e.json(),a={};return t.rows.forEach(e=>{const t={pxj:0,wuf:0};e.hourly_rewards&&Array.isArray(e.hourly_rewards)&&e.hourly_rewards.forEach(e=>{const a=parseFloat(e.quantity.split(" ")[0]),s=e.quantity.split(" ")[1];"PXJ"===s&&(t.pxj=a),"WUF"===s&&(t.wuf=a)}),a[e.template_id]=t}),a}catch{return{1001:{pxj:50,wuf:25},1002:{pxj:10,wuf:5},1003:{pxj:2,wuf:1},1004:{pxj:.5,wuf:.25},1005:{pxj:.1,wuf:.05}}}}getRarityMultiplier(e){switch(e.toLowerCase()){case"legendary":return 5;case"epic":return 3;case"rare":return 2;case"uncommon":return 1.5;default:return 1}}calculateStakingPriority(e,t){return 100*this.getRarityMultiplier(e)+10*t}generateOptimizationTips(e,t){const a=[],s=t.reduce((e,t)=>{const a=this.getTemplateRarity(t.template_id);return e[a]=(e[a]||0)+1,e},{});s.Legendary>0&&a.push("Prioritize staking Legendary ingredients for maximum rewards"),s.Epic>5&&a.push("Consider staking Epic ingredients in batches to optimize gas costs"),e.length>20&&a.push("Use batch staking to reduce transaction costs for large collections");return e.reduce((e,t)=>e+t.expected_daily_return,0)>100&&a.push("Your collection has high earning potential - consider staking all eligible NFTs"),0===a.length&&a.push("Stake your highest rarity NFTs first for optimal returns"),a}calculateRewardsPerHour(e){return{1001:{pxj:50,wuf:25},1002:{pxj:10,wuf:5},1003:{pxj:2,wuf:1},1004:{pxj:.5,wuf:.25},1005:{pxj:.1,wuf:.05}}[e]||{pxj:0,wuf:0}}getTemplateRarity(e){return{1001:"Legendary",1002:"Epic",1003:"Rare",1004:"Uncommon",1005:"Common"}[e]||"Common"}},Ha=D.memo(({imageUrl:e,videoUrl:t,alt:a,className:s="",loading:n="lazy",enableAnimations:i=!0,placeholder:r,onLoad:l,onError:o})=>{const[c,d]=O.useState(!1),[u,h]=O.useState(!1),[m,p]=O.useState("eager"===n),f=O.useRef(null),x=O.useRef(null),g=e=>e?"string"!=typeof e?null:e.startsWith("http")?e:e.startsWith("Qm")?`${qe.IPFS.GATEWAYS[0]}${e}`:e:null,v=g(t),y=g(e),j=()=>{if(r)return r;return`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#f8fafc"/>\n      <rect x="50" y="80" width="100" height="8" rx="4" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite"/>\n      </rect>\n      <rect x="60" y="100" width="80" height="6" rx="3" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>\n      </rect>\n      <rect x="70" y="120" width="60" height="6" rx="3" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" begin="0.6s" repeatCount="indefinite"/>\n      </rect>\n    </svg>')}`},b=()=>`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#fef2f2"/>\n      <circle cx="100" cy="80" r="20" fill="#fca5a5"/>\n      <text x="100" y="85" text-anchor="middle" font-family="Arial" font-size="16" fill="#dc2626">!</text>\n      <text x="100" y="120" text-anchor="middle" font-family="Arial" font-size="12" fill="#991b1b">Failed to load</text>\n    </svg>')}`;O.useEffect(()=>{if("eager"===n||m)return;const e=new IntersectionObserver(([t])=>{t.isIntersecting&&(p(!0),e.disconnect())},{rootMargin:"50px"}),t=f.current||x.current;return t&&e.observe(t),()=>e.disconnect()},[n,m]);const N=()=>{d(!0),h(!1),l?.()},w=()=>{h(!0),d(!1),o?.()};return m&&(c||u)?u?Se.jsx("img",{src:b(),alt:`Error loading ${a}`,className:s,style:{width:"100%",height:"100%",objectFit:"cover"}}):v&&i&&c?Se.jsxs("video",{ref:x,className:s,muted:!0,loop:!0,autoPlay:!0,poster:y||void 0,style:{width:"100%",height:"100%",objectFit:"cover",opacity:c?1:0,transition:"opacity 0.3s ease"},children:[Se.jsx("source",{src:v,type:"video/mp4"}),Se.jsx("source",{src:v,type:"video/webm"})]}):Se.jsx("img",{ref:f,src:y||b(),alt:a,className:s,style:{width:"100%",height:"100%",objectFit:"cover",opacity:c?1:0,transition:"opacity 0.3s ease"}}):Se.jsxs("div",{className:`progressive-image-container ${s}`,children:[Se.jsx("img",{ref:f,src:j(),alt:`Loading ${a}`,className:"progressive-image-placeholder",style:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(2px)",transition:"filter 0.3s ease"}}),m&&y&&Se.jsx("img",{src:y,alt:a,style:{display:"none"},onLoad:N,onError:w}),m&&v&&i&&Se.jsx("video",{ref:x,src:v,style:{display:"none"},onLoadedData:N,onError:w,muted:!0,loop:!0})]})});Ha.displayName="ProgressiveImage";const qa=O.memo(({nft:e,selectedNFTs:t,isSelected:a,settings:s,dropdownOpen:n,onNFTClick:i,onCollectionClick:r,onSchemaClick:l,onToggleSelection:o,onDropdownToggle:c,onListingOpen:d,onTransferOpen:u,onBurnOpen:h,onAuctionOpen:m,onRecyclePixal:p,onCraftingOpen:f,onViewOffers:x,onUnpackPixelPack:g,onStakeOpen:v,onTokenizePixal:y,onImageZoom:j})=>{const b=n===e.asset_id,N="pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name,w="pixeljourney"===e.collection.collection_name&&"ingredients"===e.schema.schema_name,k=Je.isValidWaxRock(e.data.WaxRock);return Se.jsxs("div",{className:`inventory-page-card ${t.size>0?"selectable":""} ${a?"selected":""}`,children:[Se.jsx("div",{className:"selection-checkbox",children:Se.jsx("input",{type:"checkbox",checked:a,onChange:()=>o(e.asset_id),onClick:e=>e.stopPropagation()})}),Se.jsxs("div",{className:"inventory-page-media",onClick:()=>{t.size>0?o(e.asset_id):i(e)},children:[Se.jsx(Ha,{imageUrl:ca(e),videoUrl:da(e),alt:e.name,className:"inventory-media",loading:"lazy",enableAnimations:s.enableAnimatedNFTs}),Se.jsx("div",{className:"zoom-overlay",onClick:t=>{t.stopPropagation(),j(ca(e)||"",da(e)||"",e.name||`Asset #${e.asset_id}`)},title:"Click to zoom",children:Se.jsxs("svg",{className:"zoom-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"11",cy:"11",r:"8"}),Se.jsx("path",{d:"m21 21-4.35-4.35"}),Se.jsx("path",{d:"M11 8v6M8 11h6"})]})}),e.mint_number&&Se.jsxs("div",{className:"mint-badge",children:["#",e.mint_number]})]}),Se.jsxs("div",{className:"inventory-page-info",children:[Se.jsx("h3",{className:"inventory-page-name",onClick:()=>{t.size>0?o(e.asset_id):i(e)},children:e.name}),Se.jsxs("div",{className:"inventory-page-details",children:[Se.jsx("span",{className:"inventory-page-collection",onClick:()=>r(e.collection.collection_name),children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),Se.jsx("span",{className:"inventory-page-schema",onClick:()=>l(e.schema.schema_name),children:e.schema.schema_name})]}),Se.jsxs("div",{className:"inventory-page-actions",children:[Se.jsxs("div",{className:"basic-actions",children:[Se.jsx("button",{className:"inv-action-btn list-btn",onClick:t=>{t.stopPropagation(),d(e)},title:"List for Sale","aria-label":`List ${e.name} for sale`,children:"\ud83d\udcb0"}),Se.jsx("button",{className:"inv-action-btn transfer-btn",onClick:t=>{t.stopPropagation(),u(e)},title:"Transfer","aria-label":`Transfer ${e.name} to another account`,children:"\ud83d\udce4"}),Se.jsx("button",{className:"inv-action-btn offers-btn",onClick:t=>{t.stopPropagation(),x(e)},"aria-label":`View offers for ${e.name}`,title:"View Offers",children:"\ud83d\udc41\ufe0f"})]}),Se.jsxs("div",{className:"more-actions-dropdown","data-dropdown-id":e.asset_id,children:[Se.jsx("button",{className:"more-actions-btn",onClick:t=>{t.stopPropagation(),c(e.asset_id)},title:"More Actions","aria-label":`More actions for ${e.name}`,"aria-expanded":b,children:"\u22ee"}),b&&Se.jsxs("div",{className:"inv-dropdown-menu",children:[Se.jsx("button",{className:"inv-dropdown-item auction-item",onClick:t=>{t.stopPropagation(),m(e)},"aria-label":`Create auction for ${e.name}`,children:"\ud83c\udfc6 Create Auction"}),!k&&Se.jsx("button",{className:"inv-dropdown-item burn-item",onClick:t=>{t.stopPropagation(),h(e)},"aria-label":`Burn ${e.name}`,children:"\ud83d\udd25 Burn"}),N&&!k&&Se.jsx("button",{className:"inv-dropdown-item recycle-item",onClick:t=>{t.stopPropagation(),p(e)},"aria-label":`Recycle ${e.name}`,children:"\u267b\ufe0f Recycle"}),N&&Se.jsx("button",{className:"inv-dropdown-item tokenize-item",onClick:t=>{t.stopPropagation(),y(e)},"aria-label":`Tokenize ${e.name} into WPIXAL`,children:"\ud83e\ude99 Tokenize into WPIXAL"}),(N||w)&&Se.jsxs("button",{className:"inv-dropdown-item craft-item",onClick:t=>{t.stopPropagation(),f(e)},"aria-label":`Use ${e.name} for crafting`,children:["\ud83d\udd28 ",w?"Craft with Ingredient":"Craft"]}),"pixeljourney"===e.collection.collection_name&&Se.jsx("button",{className:"inv-dropdown-item stake-item",onClick:t=>{t.stopPropagation(),v(e)},"aria-label":`Stake ${e.name}`,children:"\ud83e\udd69 Stake NFT"}),Ra.isPixelPack(e)&&Se.jsx("button",{className:"inv-dropdown-item unpack-item",onClick:t=>{t.stopPropagation(),g(e)},children:"\ud83d\udce6 Unpack"})]})]})]})]})]})}),Ja=O.memo(()=>{const e=B(),{settings:t}=at(),{showSuccess:a,showError:s,confirm:n}=xt(),[i,r]=O.useState([]),[l,o]=O.useState(!1),[c,d]=O.useState(!1),[u,h]=O.useState(!1),[m,p]=O.useState(!1),[f,x]=O.useState(!1),[g,v]=O.useState(!1),[y,j]=O.useState(!1),[b,N]=O.useState(!1),[w,k]=O.useState(!1),[_,S]=O.useState(!1),[C,A]=O.useState(!1),[T,P]=O.useState(!1),[E,I]=O.useState(null),[F,$]=O.useState(new Set),[L,M]=O.useState(!1),[R,W]=O.useState(null),[D,U]=O.useState(!1),[z,X]=O.useState(null),[H,q]=O.useState(!1),[J,V]=O.useState(null),[G,K]=O.useState(!1),[Y,Q]=O.useState(null),[Z,ee]=O.useState(null),[te,ae]=O.useState(!1),se=O.useCallback((e,t,a)=>{const s=t||e,n=t?"video":"image";let i=s;s.startsWith("Qm")||s.startsWith("baf")?i=`https://ipfs.io/ipfs/${s}`:s.startsWith("/ipfs/")?i=`https://ipfs.io${s}`:s.startsWith("ipfs://")&&(i=s.replace("ipfs://","https://ipfs.io/ipfs/")),ee({url:i,name:a,type:n}),ae(!0)},[]),[ne,ie]=O.useState(""),[re,le]=O.useState(""),[oe,ce]=O.useState([]),[de,ue]=O.useState("all"),[he,me]=O.useState("all"),[pe,fe]=O.useState("all"),[xe,ge]=O.useState(""),[ve,ye]=O.useState("transferred"),[je,be]=O.useState("desc"),[Ne]=O.useState(""),[we,ke]=O.useState([]),[_e,Ce]=O.useState([]),[Ae,Te]=O.useState(!1),[Pe,Ee]=O.useState({start:"",end:""}),[Ie,$e]=O.useState(1),[Le,Me]=O.useState(!1),[Re,We]=O.useState(!1),[Oe,Ue]=O.useState(!1),Be=1e3,[ze,Xe]=O.useState(1),{isConnected:He,account:qe,login:Ve,session:Ge}=Fe(),Ke=O.useCallback(async(e=1,t=!1)=>{if(qe)if(l||Re)De.debug("Skipping loadInventory - already loading","Inventory");else{1===e?(o(!0),$e(1)):We(!0);try{let a;De.debug("Loading inventory","Inventory",{filter:de,page:e,ITEMS_PER_PAGE:Be,sortBy:ve,sortOrder:je});const s={page:e,limit:Be,order:je,sort:ve.includes("_")?"asset_id":ve,search:re||void 0,template_id:xe||void 0};switch(Pe.start&&(s.after=new Date(Pe.start).getTime()/1e3),Pe.end&&(s.before=new Date(Pe.end).getTime()/1e3),de){case"pixals":case"waxrock":s.collection_name="pixeljourney",s.schema_name="pixals";break;case"ingredients":s.collection_name="pixeljourney",s.schema_name="ingredients";break;case"packs":s.collection_name="pixeljourney",s.schema_name="packs";break;default:"all"!==he&&(s.collection_name=he),"all"!==pe&&(s.schema_name=pe)}const n=await dt.getUserInventoryEnhanced(qe,s);a={data:n.assets||[],hasMore:n.hasMore,totalCount:n.total||0,collections:n.collections||[],schemas:n.schemas||[]},a.collections&&a.collections.length>0&&ke(e=>[...new Set([...e,...a.collections])].sort()),a.schemas&&a.schemas.length>0&&Ce(e=>[...new Set([...e,...a.schemas])].sort()),De.debug("Inventory Response","Inventory",{itemsReceived:a?.data?.length||0,totalAvailable:a?.totalCount||"unknown",hasMore:a?.hasMore});let i=a.data.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image||e.img,video:e.video||e.traits?.video||e.data?.video||void 0,collection:{name:e.collection||e.collection_name,collection_name:e.collection||e.collection_name},schema:{schema_name:e.schema||e.schema_name},template:{template_id:e.template_id||e.template?.template_id||"0",max_supply:e.max_supply||e.template?.max_supply||"0"},data:e.traits||e.data||{},mint_number:e.template_mint||e.mint_number}));if(1===e&&"all"===de){const e=[...new Set(i.map(e=>e.collection.collection_name).filter(e=>"string"==typeof e&&""!==e.trim()))].sort();ke(e)}t&&e>1?(r(e=>[...e,...i]),$e(e)):(r(i),$e(1)),Me(a.hasMore)}catch(a){De.error("Error loading inventory","Inventory",a);const s=a instanceof Error?a.message:"Unknown error occurred";1!==e||t?De.warn("Failed to load more inventory items","Inventory",{errorMessage:s}):(r([]),De.warn("Failed to load inventory","Inventory",{errorMessage:s})),Me(!1)}finally{o(!1),We(!1)}}},[qe,de,he,Be]);O.useEffect(()=>{He&&qe&&(De.debug("Inventory reload triggered","Inventory",{filter:de,selectedCollection:he,selectedSchema:pe,selectedTemplate:xe,sortBy:ve,sortOrder:je,searchTerm:ne,dateRange:Pe}),Ke(1,!1))},[He,qe,de,he,pe,xe,ve,je,ne,Pe]);const Ye=O.useCallback(()=>{Le&&!Re&&qe&&Ke(Ie+1,!0)},[Le,Re,Ie,qe,Ke]),Qe=O.useCallback(async()=>{if(!Le||Oe||!qe)return void De.debug("LoadAll skipped","Inventory",{hasMore:Le,loadingAll:Oe,account:qe});Ue(!0),De.debug("Starting loadAllItems with concurrent requests","Inventory",{currentInventoryLength:i.length,hasMore:Le,currentPage:Ie});let e=Ie+1,t=[],a=!0,s=0;try{for(;a&&s<50;){const n=[],l=[];for(let t=0;t<2&&a;t++){const a=e+t;l.push(a);const s=(async()=>{const e=1e3*(a-1);try{switch(de){case"pixals":return await dt.getUserInventoryBySchema(qe,"pixeljourney","pixals",1e3,e);case"ingredients":return await dt.getUserInventoryBySchema(qe,"pixeljourney","ingredients",1e3,e);case"waxrock":return await dt.getUserInventoryWaxRocks(qe,1e3,e);default:{const e="all"!==he?he:void 0;return await dt.getUserInventoryWithFilter(qe,a,1e3,e)}}}catch(t){return De.error("Error in individual request","Inventory",t instanceof Error?t:new Error(String(t))),{assets:[],total:0,hasMore:!1}}})();n.push(s)}De.debug("LoadAll Concurrent Batch","Inventory",{pages:l,currentItems:i.length+t.length});const o=await Promise.allSettled(n);s+=o.length;let c=!1;for(let e=0;e<o.length;e++){const s=o[e],n=l[e];if("fulfilled"===s.status){const e=s.value;if(De.debug("LoadAll Response","Inventory",{page:n,items:e?.assets?.length||0,hasMore:e?.hasMore,total:e?.total}),e&&e.assets&&e.assets.length>0){c=!0;let a=e.assets.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image,video:e.video||e.traits?.video||void 0,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:e.max_supply||"0"},data:e.traits||{},mint_number:e.template_mint}));"waxrock"===de&&(a=a.filter(e=>{const t=e.data.WaxRock;return"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name&&t&&"none"!==t})),t.push(...a)}e&&e.hasMore||(a=!1)}else De.error("LoadAll Request Failed","Inventory",new Error(`Page ${n}: ${s.reason}`))}c||(a=!1,De.debug("No more items found, stopping LoadAll","Inventory")),e+=2,t.length>0&&(r(e=>{const a=[...e,...t];return De.debug("Updated inventory","Inventory",{previousCount:e.length,newCount:a.length,addedCount:t.length}),a}),$e(e-1),t=[]),a&&await new Promise(e=>setTimeout(e,100))}De.debug("LoadAll Complete with concurrent requests","Inventory",{totalItems:i.length,totalRequests:s}),Me(!1)}catch(n){De.error("Error loading all items","Inventory",n);const e=n instanceof Error?n.message:"Unknown error occurred";De.warn("Failed to load all inventory items","Inventory",{errorMessage:e}),Me(!1)}finally{Ue(!1)}},[Le,Oe,qe,Ie,Be,de,he,i.length]);O.useEffect(()=>{const e=e=>{R&&!e.target.closest(".more-actions-dropdown")&&W(null)},t=()=>{if(R){const e=document.querySelector(`[data-dropdown-id="${R}"] .inv-dropdown-menu`);if(e){const t=e.getBoundingClientRect(),a=window.innerWidth;e.classList.remove("dropdown-left","dropdown-down"),t.right>a&&e.classList.add("dropdown-left"),t.top<0&&e.classList.add("dropdown-down")}}};return document.addEventListener("mousedown",e),R&&setTimeout(t,0),()=>document.removeEventListener("mousedown",e)},[R]);const Ze=t=>{e(`/assets/${t.asset_id}`)},et=t=>{e(`/marketplace?collection=${t}`)},tt=t=>{e(`/marketplace?schema=${t}`)},st=e=>{const t=new Set(F);t.has(e)?(t.delete(e),0===t.size&&M(!1)):(t.add(e),L||M(!0)),$(t)},nt=async()=>{if(0===F.size)return;if(!qe||!Ge)return void s("Wallet Required","Please connect your wallet first");const e=i.filter(e=>F.has(e.asset_id)).filter(e=>Ra.isPixelPack(e));if(0!==e.length)try{if(!(await n("Confirm Bulk Unpack",`Are you sure you want to unpack ${e.length} pixelpack(s)?\n\nThis action cannot be undone and will be processed in batches of 20.`,"Unpack All","Cancel")))return;const t=e.map(e=>e.asset_id),s=await Ra.unpackPixelPacksBulk(t,qe);for(let e=0;e<s.length;e++){const t=s[e];a(`Processing batch ${e+1} of ${s.length}...`,"Bulk Unpack"),await Ra.executeUnpack(t,Ge)}a("Bulk Unpack Successful",`Successfully unpacked ${e.length} pixelpack(s)!`),$(new Set),await Ke()}catch(t){De.error("Bulk unpack failed","Inventory",t),s("Bulk Unpack Failed",t instanceof Error?t.message:"Unknown error occurred")}else s("No pixelpack NFTs selected","Please select pixelpack items to unpack.")};O.useEffect(()=>{const e=setTimeout(()=>{le(ne)},300);return()=>clearTimeout(e)},[ne]);const it=O.useCallback(e=>{if(!e||e.length<2)return[];const t=new Map,a=e.toLowerCase();return i.forEach(e=>{if(e.name.toLowerCase().includes(a)){const a=`name:${e.name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.name,type:"name",count:1})}if(e.collection.collection_name.toLowerCase().includes(a)){const a=`collection:${e.collection.collection_name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.collection.collection_name,type:"collection",count:1})}if(e.schema.schema_name.toLowerCase().includes(a)){const a=`schema:${e.schema.schema_name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.schema.schema_name,type:"schema",count:1})}}),Array.from(t.values()).sort((e,t)=>(t.count||0)-(e.count||0)).slice(0,8)},[i]);O.useEffect(()=>{const e=it(ne);ce(e)},[ne,it]);const rt=O.useMemo(()=>i.filter(e=>{const t=""===re||e.name.toLowerCase().includes(re.toLowerCase())||e.collection.collection_name.toLowerCase().includes(re.toLowerCase())||e.schema.schema_name.toLowerCase().includes(re.toLowerCase()),a="all"===de||"pixals"===de&&"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name||"waxrock"===de&&"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name&&e.data?.WaxRock&&"none"!==e.data.WaxRock||"ingredients"===de&&"pixeljourney"===e.collection.collection_name&&"ingredients"===e.schema.schema_name||"packs"===de&&Ra.isPackNFT(e);return t&&a}).sort((e,t)=>{switch(ve){case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"collection_asc":return e.collection.collection_name.localeCompare(t.collection.collection_name);case"collection_desc":return t.collection.collection_name.localeCompare(e.collection.collection_name);case"mint_asc":return(e.mint_number||0)-(t.mint_number||0);case"mint_desc":return(t.mint_number||0)-(e.mint_number||0);default:return 0}}),[i,re,de,ve]),lt=rt.length;O.useEffect(()=>{const e=Math.ceil(lt/Be);Xe(Math.max(1,e))},[lt]);const ot=O.useMemo(()=>{const e=(Ie-1)*Be,t=e+Be;return rt.slice(e,t)},[rt,Ie,Be]),ct=O.useCallback(()=>{Ie<ze&&$e(e=>e+1)},[Ie,ze]),ut=O.useCallback(()=>{Ie>1&&$e(e=>e-1)},[Ie]);return O.useEffect(()=>{$e(1)},[de,he,re,ve]),He?Se.jsxs("div",{className:"inventory-container",children:[Se.jsxs("div",{className:"inventory-header",children:[Se.jsx("h1",{className:"inventory-title",children:"My NFT Inventory"}),Se.jsxs("div",{className:"inventory-action-buttons",children:[Se.jsx("button",{className:"btn inventory-action-btn craft-btn",onClick:()=>{U(!0)},title:"Open crafting interface",children:"\ud83d\udd28 Craft"}),Se.jsx("button",{className:"btn btn-success inventory-action-btn",onClick:async()=>{if(qe&&Ge)try{const e=await Xa.claimAllRewards(Ge,"pixeljourney");e.success?a("Rewards Claimed Successfully","All pending rewards have been claimed and transferred to your wallet!"):s("Claim Failed",e.error||"Failed to claim rewards")}catch(e){console.error("Claim rewards error:",e),s("Claim Failed",e instanceof Error?e.message:"An unexpected error occurred")}else s("Wallet Required","Please connect your wallet first")},title:"Claim all pending staking rewards",disabled:!qe||!Ge,children:"\ud83d\udcb0 Claim"})]})]}),Se.jsxs("div",{className:"inventory-page-filters",children:[Se.jsx(ja,{searchTerm:ne,onSearchChange:e=>{ie(e),$e(1)},suggestions:oe,placeholder:"Search NFTs by name, collection, or schema...",showFilters:!1,className:"inventory-search"}),Se.jsxs("div",{className:"inventory-controls",children:[Se.jsxs("div",{className:"inventory-filter-tabs",children:[Se.jsx("button",{className:"inventory-filter-tab "+("all"===de?"active":""),onClick:()=>{ue("all"),$e(1)},children:"All NFTs"}),Se.jsx("button",{className:"inventory-filter-tab "+("pixals"===de?"active":""),onClick:()=>{ue("pixals"),$e(1)},children:"Pixals"}),Se.jsx("button",{className:"inventory-filter-tab "+("waxrock"===de?"active":""),onClick:()=>{ue("waxrock"),$e(1)},children:"WaxRock"}),Se.jsx("button",{className:"inventory-filter-tab "+("ingredients"===de?"active":""),onClick:()=>{ue("ingredients"),$e(1)},children:"Ingredients"}),Se.jsx("button",{className:"inventory-filter-tab "+("packs"===de?"active":""),onClick:()=>{ue("packs"),$e(1)},children:"Packs"})]}),Se.jsxs("div",{className:"enhanced-filters",children:[Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{children:"Sort by:"}),Se.jsxs("select",{value:ve,onChange:e=>{ye(e.target.value),$e(1)},className:"sort-select",children:[Se.jsx("option",{value:"transferred",children:"Latest Received"}),Se.jsx("option",{value:"created",children:"Latest Created"}),Se.jsx("option",{value:"updated",children:"Recently Updated"}),Se.jsx("option",{value:"minted",children:"Latest Minted"}),Se.jsx("option",{value:"asset_id",children:"Asset ID"}),Se.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),Se.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),Se.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),Se.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),Se.jsx("option",{value:"mint_asc",children:"Mint Number (Low-High)"}),Se.jsx("option",{value:"mint_desc",children:"Mint Number (High-Low)"})]})]}),Se.jsxs("div",{className:"collection-filter-container",children:[Se.jsx("label",{children:"Collection:"}),Se.jsxs("select",{value:he,onChange:e=>{me(e.target.value),$e(1)},className:"collection-select",children:[Se.jsx("option",{value:"all",children:"All Collections"}),we.filter(e=>"string"==typeof e&&e.toLowerCase().includes(Ne.toLowerCase())).map(e=>Se.jsx("option",{value:e,children:e},e))]})]}),Se.jsxs("div",{className:"schema-filter-container",children:[Se.jsx("label",{children:"Schema:"}),Se.jsxs("select",{value:pe,onChange:e=>{fe(e.target.value),$e(1)},className:"schema-select",children:[Se.jsx("option",{value:"all",children:"All Schemas"}),_e.map(e=>Se.jsx("option",{value:e,children:e},e))]})]}),Se.jsxs("div",{className:"template-filter-container",children:[Se.jsx("label",{children:"Template ID:"}),Se.jsx("input",{type:"text",placeholder:"Enter template ID...",value:xe,onChange:e=>{ge(e.target.value),$e(1)},className:"template-input"})]}),Se.jsxs("button",{className:"advanced-filters-toggle "+(Ae?"active":""),onClick:()=>Te(!Ae),children:[Ae?"\u25bc":"\u25b6"," Advanced Filters"]})]}),Ae&&Se.jsxs("div",{className:"advanced-filters-panel",children:[Se.jsxs("div",{className:"date-range-filter",children:[Se.jsx("label",{children:"Date Range:"}),Se.jsxs("div",{className:"date-inputs",children:[Se.jsx("input",{type:"date",value:Pe.start,onChange:e=>{Ee(t=>({...t,start:e.target.value})),$e(1)},className:"date-input",placeholder:"Start date"}),Se.jsx("span",{children:"to"}),Se.jsx("input",{type:"date",value:Pe.end,onChange:e=>{Ee(t=>({...t,end:e.target.value})),$e(1)},className:"date-input",placeholder:"End date"})]})]}),Se.jsx("div",{className:"filter-actions",children:Se.jsx("button",{className:"clear-filters-btn",onClick:()=>{me("all"),fe("all"),ge(""),Ee({start:"",end:""}),ie(""),ye("transferred"),be("desc"),$e(1)},children:"Clear All Filters"})})]})]}),F.size>0&&Se.jsxs("div",{className:"bulk-actions-toolbar",children:[Se.jsxs("div",{className:"selection-info",children:[Se.jsxs("span",{children:[F.size," item",1!==F.size?"s":""," selected"]}),F.size>0&&Se.jsx("button",{className:"clear-selection",onClick:()=>{$(new Set)},children:"Clear"}),Se.jsx("button",{className:"select-all",onClick:()=>{const e=new Set(rt.map(e=>e.asset_id));if(e.size>0&&[...e].every(e=>F.has(e))){const t=new Set(F);e.forEach(e=>t.delete(e)),$(t)}else{const t=new Set([...F,...e]);$(t)}},children:(()=>{const e=new Set(rt.map(e=>e.asset_id));return e.size>0&&[...e].every(e=>F.has(e))?"Deselect All":"Select All"})()})]}),F.size>0&&Se.jsxs("div",{className:"bulk-actions",children:[Se.jsxs("button",{className:"bulk-btn list-btn",onClick:()=>{0!==F.size&&v(!0)},children:["\ud83d\udcb0 List (",F.size,")"]}),Se.jsxs("button",{className:"bulk-btn auction-btn",onClick:()=>{0!==F.size&&A(!0)},children:["\ud83c\udfc6 Auction (",F.size,")"]}),Se.jsxs("button",{className:"bulk-btn transfer-btn",onClick:()=>{0!==F.size&&j(!0)},children:["\ud83d\udce4 Transfer (",F.size,")"]}),Se.jsxs("button",{className:"bulk-btn distribute-btn",onClick:()=>{0!==F.size&&N(!0)},children:["\ud83c\udfaf Distribute (",F.size,")"]}),Se.jsxs("button",{className:"bulk-btn burn-btn",onClick:()=>{0!==F.size&&k(!0)},children:["\ud83d\udd25 Burn (",F.size,")"]}),Se.jsxs("button",{className:"bulk-btn stake-btn",onClick:async()=>{if(0===F.size)return;if(!qe||!Ge)return void s("Wallet Required","Please connect your wallet first");const e=i.filter(e=>F.has(e.asset_id)),t=e.filter(e=>"pixeljourney"===e.collection.collection_name);if(0!==t.length){if(t.length!==e.length){const a=e.length-t.length;console.log(`Skipping ${a} non-Pixel Journey NFTs, staking ${t.length} Pixel Journey NFTs`)}try{const e=t.map(e=>e.asset_id),n=await Xa.stakeNFTsPixelJourney(Ge,e,"pixeljourney");n.success?(a("NFTs Staked Successfully",`${t.length} NFT${t.length>1?"s have":" has"} been staked successfully!`),$(new Set),M(!1),await Ke()):s("Staking Failed",n.error||"Failed to stake NFTs")}catch(n){console.error("Bulk staking error:",n),s("Staking Failed",n instanceof Error?n.message:"An unexpected error occurred")}}else s("No Stakeable NFTs","Only Pixel Journey NFTs can be staked. Please select some Pixel Journey assets.")},children:["\ud83e\udd69 Stake (",F.size,")"]}),(()=>{const e=i.filter(e=>F.has(e.asset_id)).filter(e=>Ra.isPixelPack(e)).length;return Se.jsx(Se.Fragment,{children:e>0&&Se.jsxs("button",{className:"bulk-btn unpack-btn",onClick:nt,children:["\ud83d\udce6 Unpack Pixelpacks (",e,")"]})})})()]})]})]}),l&&Se.jsxs("div",{className:"loading-container",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading your NFTs..."})]}),!l&&Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"inventory-page-stats",children:Se.jsxs("p",{children:[lt," NFTs found"]})}),i.length>0?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"inventory-page-grid",children:ot.map(e=>Se.jsx(qa,{nft:e,selectedNFTs:F,isSelected:F.has(e.asset_id),settings:t,dropdownOpen:R,onNFTClick:Ze,onCollectionClick:et,onSchemaClick:tt,onToggleSelection:st,onDropdownToggle:e=>W(R===e?null:e),onListingOpen:e=>{I(e),h(!0)},onTransferOpen:e=>{I(e),p(!0)},onBurnOpen:e=>{I(e),x(!0)},onAuctionOpen:e=>{I(e),P(!0),W(null)},onRecyclePixal:e=>{(async e=>{if(qe&&Ge){if(Je.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&Je.isValidWaxRock(t))return void s("WaxRock Protection",`This is a rare WaxRock Pixal PFP (${t}) and cannot be recycled. WaxRock Pixals are protected from burning and recycling on our platform.`)}try{if(!(await n("Confirm Recycle",`Are you sure you want to recycle ${e.name}?\n\nThis will cost 12,000 PXJ tokens and cannot be undone.`,"Recycle","Cancel")))return;const t=await Ra.recyclePixal(e.asset_id,qe);await Ra.executeRecycle(t,Ge),a("Recycle Successful","Pixal recycled successfully!"),await Ke()}catch(t){De.error("Recycle failed","Inventory",t),s("Recycle Failed",t instanceof Error?t.message:"Unknown error occurred")}}else s("Wallet Required","Please connect your wallet first")})(e),W(null)},onImageZoom:se,onCraftingOpen:e=>{(e=>{X(e),U(!0)})(e),W(null)},onViewOffers:e=>{(e=>{V(e),q(!0)})(e),W(null)},onUnpackPixelPack:e=>{(async e=>{if(qe&&Ge)try{if(!(await n("Confirm Unpack",`Are you sure you want to unpack ${e.name}?\n\nThis action cannot be undone.`,"Unpack","Cancel")))return;const t=await Ra.unpackPixelPack(e.asset_id,qe);await Ra.executeUnpack(t,Ge),a("Unpack Successful","Pixelpack unpacked successfully!"),await Ke()}catch(t){De.error("Unpack failed","Inventory",t),s("Unpack Failed",t instanceof Error?t.message:"Unknown error occurred")}else s("Wallet Required","Please connect your wallet first")})(e),W(null)},onStakeOpen:e=>{(async e=>{if(qe&&Ge)if("pixeljourney"===e.collection.collection_name)try{if(!(await n("Confirm Staking",`Are you sure you want to stake ${e.name}?\n\nYour assets will remain in your inventory as the Pixel Journey uses non-custodial staking.`,"Stake NFT","Cancel")))return;const t=await Xa.stakeNFTsPixelJourney(Ge,[e.asset_id],"pixeljourney");t.success?(a("NFT Staked Successfully",`${e.name} has been staked successfully!`),await Ke()):s("Staking Failed",t.error||"Failed to stake NFT")}catch(t){console.error("Staking error:",t),s("Staking Failed",t instanceof Error?t.message:"An unexpected error occurred")}else s("Invalid Asset","Only Pixel Journey NFTs can be staked");else s("Wallet Required","Please connect your wallet first")})(e),W(null)},onTokenizePixal:e=>{(async e=>{qe&&Ge?Je.isPixalPFP(e.template.template_id)?(Q(e),K(!0)):s("Invalid NFT","Only Pixal PFPs can be tokenized into WPIXAL"):s("Wallet Required","Please connect your wallet first")})(e),W(null)}},e.asset_id))}),ze>1&&Se.jsxs("div",{className:"pagination-controls",children:[Se.jsx("button",{className:"pagination-btn",onClick:ut,disabled:1===Ie,children:"\u2190 Previous"}),Se.jsxs("div",{className:"pagination-info",children:[Se.jsxs("span",{children:["Page ",Ie," of ",ze]}),Se.jsxs("span",{className:"pagination-items",children:["(",lt," total items)"]})]}),Se.jsx("button",{className:"pagination-btn",onClick:ct,disabled:Ie===ze,children:"Next \u2192"})]})]}):Se.jsxs("div",{className:"empty-inventory",children:[Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"empty-icon",children:Se.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M9 1v6m6-6v6"})}),Se.jsx("h3",{children:"No NFTs Found"}),Se.jsxs("p",{children:["You don't have any ","all"===de?"Pixel Journey":de," NFTs yet."]}),Se.jsx("p",{children:"Visit the marketplace to start collecting!"}),("waxrock"===de||"pixals"===de||"ingredients"===de)&&Se.jsx("div",{className:"empty-inventory-cta",style:{marginTop:"20px"},children:Se.jsxs("button",{className:"cta-button",onClick:()=>{e(`/marketplace?category=${{waxrock:"waxrocks",pixals:"pixals",ingredients:"ingredients"}[de]}`)},style:{background:"linear-gradient(45deg, #4ecdc4, #45b7d1)",border:"none",padding:"12px 24px",borderRadius:"25px",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(78, 205, 196, 0.3)"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(78, 205, 196, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(78, 205, 196, 0.3)"},children:["\ud83d\uded2 Browse ","waxrock"===de?"WaxRock":de.charAt(0).toUpperCase()+de.slice(1)," Marketplace"]})})]}),i.length>0&&Se.jsx("div",{className:"load-more-container",children:Le?Se.jsxs(Se.Fragment,{children:[Se.jsx("button",{className:"load-more-btn",onClick:Ye,disabled:Re||Oe,children:Re?"Loading...":"Load More NFTs"}),Se.jsx("button",{className:"load-more-btn load-all-btn",onClick:Qe,disabled:Re||Oe,style:{marginLeft:"10px",backgroundColor:"var(--success-color)"},children:Oe?"Loading All...":"Load All NFTs"})]}):Se.jsxs("div",{className:"pagination-info",children:[Se.jsxs("p",{children:["\ud83d\udcc4 Page ",Ie," - All NFTs loaded (",i.length," total)"]}),Se.jsx("p",{style:{fontSize:"0.9em",color:"var(--text-secondary)",marginTop:"5px"},children:"No more items to load"})]})})]}),Se.jsx(fa,{nft:E?{sale_id:"",asset_id:E.asset_id,name:E.name,image:E.img,video:E.video,price:"Not for sale",seller:qe||"",collection:E.collection.collection_name,schema:E.schema.schema_name,template_mint:E.mint_number,max_supply:E.template.max_supply,traits:E.data}:null,isOpen:c,onClose:()=>d(!1)}),Se.jsx(wa,{nft:E,isOpen:u,onClose:()=>{h(!1),I(null)},onSuccess:()=>{Ke()}}),Se.jsx(ka,{nft:E,isOpen:m,onClose:()=>{p(!1),I(null)},onSuccess:()=>{Ke()}}),Se.jsx(_a,{nft:E,isOpen:f,onClose:()=>{x(!1),I(null)},onSuccess:()=>{Ke()}}),Se.jsx($a,{isOpen:D,onClose:()=>{U(!1),X(null)},ingredient:z}),Se.jsx(Ma,{nft:J,isOpen:H,onClose:()=>{q(!1),V(null)}}),Se.jsx(za,{nft:Y,isOpen:G,onClose:()=>{K(!1),Q(null)},onSuccess:()=>{K(!1),Q(null),Ke()}}),Se.jsx(Sa,{nfts:i.filter(e=>F.has(e.asset_id)),isOpen:g,onClose:()=>{v(!1)},onSuccess:()=>{$(new Set),M(!1),Ke()}}),Se.jsx(Ca,{nfts:i.filter(e=>F.has(e.asset_id)),isOpen:y,onClose:()=>{j(!1)},onSuccess:()=>{$(new Set),M(!1),Ke()}}),Se.jsx(Aa,{nfts:i.filter(e=>F.has(e.asset_id)),isOpen:b,onClose:()=>{N(!1)},onSuccess:()=>{$(new Set),M(!1),Ke()}}),Se.jsx(Ta,{nfts:i.filter(e=>F.has(e.asset_id)),isOpen:w,onClose:()=>{k(!1)},onSuccess:()=>{$(new Set),M(!1),Ke()}}),Se.jsx(Wa,{selectedNFTs:i.filter(e=>F.has(e.asset_id)),isOpen:_,onClose:()=>{S(!1)},userAccount:qe||"",walletSession:Ge,onUnpackComplete:()=>{$(new Set),M(!1),Ke(1,!1),a("Packs unpacked successfully!")}}),Se.jsx(Ua,{nfts:i.filter(e=>F.has(e.asset_id)),isOpen:C,onClose:()=>{A(!1)},onSuccess:()=>{$(new Set),M(!1),Ke()}}),E&&Se.jsx(Ua,{nfts:[E],isOpen:T,onClose:()=>{P(!1),I(null)},onSuccess:()=>{Ke()}}),te&&Z&&Se.jsx("div",{className:"image-zoom-modal",onClick:()=>ae(!1),children:Se.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsx("button",{className:"zoom-modal-close",onClick:()=>ae(!1),"aria-label":"Close zoom modal",children:"\xd7"}),"video"===Z.type?Se.jsx("video",{src:Z.url,className:"zoom-modal-video",controls:!0,autoPlay:!0,muted:!0,loop:!0,children:"Your browser does not support the video tag."}):Se.jsx("img",{src:Z.url,alt:Z.name,className:"zoom-modal-image"}),Se.jsx("div",{className:"zoom-modal-title",children:Z.name})]})})]}):Se.jsxs("div",{className:"inventory-page",children:[Se.jsxs("div",{className:"inventory-page-header",children:[Se.jsx("h1",{className:"inventory-page-title",children:"My NFT Inventory"}),Se.jsx("p",{className:"inventory-page-subtitle",children:"View and manage your Pixel Journey NFTs"})]}),Se.jsx("div",{className:"connect-wallet-prompt",children:Se.jsxs("div",{className:"connect-wallet-card",children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"wallet-icon",children:[Se.jsx("path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"}),Se.jsx("path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"}),Se.jsx("circle",{cx:"18",cy:"12",r:"2"})]}),Se.jsx("h3",{children:"Connect Your Wallet"}),Se.jsx("p",{children:"Connect your wallet to view your NFT inventory and manage your Pixel Journey assets."}),Se.jsx("button",{className:"btn-primary",onClick:Ve,children:"Connect Wallet"})]})})]})}),Va=D.memo(({text:e,maxLength:t=240,className:a=""})=>{const[s,n]=O.useState(!1);if(!e||e.length<=t)return Se.jsx("span",{className:a,children:e});const i=e.slice(0,t).trim();return Se.jsx("span",{className:a,children:s?Se.jsxs(Se.Fragment,{children:[e,Se.jsx("button",{className:"read-more-btn collapse-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),n(!1)},children:"read less"})]}):Se.jsxs(Se.Fragment,{children:[i,i.endsWith(".")?"":"...",Se.jsx("button",{className:"read-more-btn expand-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),n(!0)},children:"read more"})]})})});Va.displayName="TruncatedText";const Ga=new class{constructor(){M(this,"requestQueue",[]),M(this,"isProcessing",!1),M(this,"gatewayStats",new Map),M(this,"MIN_REQUEST_INTERVAL",200),M(this,"MAX_CONCURRENT_REQUESTS",3),M(this,"MAX_RETRIES",3),M(this,"GATEWAY_COOLDOWN",3e4),M(this,"REQUEST_TIMEOUT",1e4),M(this,"activeRequests",0),M(this,"lastRequestTime",0)}async requestImage(e){return new Promise((t,a)=>{const s={url:e,resolve:t,reject:a,retryCount:0,timestamp:Date.now()};this.requestQueue.push(s),this.processQueue()})}async processQueue(){if(!this.isProcessing&&0!==this.requestQueue.length){for(this.isProcessing=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){const e=this.requestQueue.shift();if(!e)break;if(Date.now()-e.timestamp>this.REQUEST_TIMEOUT){e.reject(new Error("Request timeout in queue"));continue}const t=Date.now()-this.lastRequestTime;if(t<this.MIN_REQUEST_INTERVAL){const e=this.MIN_REQUEST_INTERVAL-t;await this.delay(e)}this.lastRequestTime=Date.now(),this.activeRequests++,this.processRequest(e).finally(()=>{this.activeRequests--,setTimeout(()=>this.processQueue(),0)})}this.isProcessing=!1}}async processRequest(e){try{const t=this.selectBestGateway(e.url);if(!t)throw new Error("No available gateways");const a=await this.makeRequest(e.url,t);this.updateGatewayStats(t,!0),e.resolve(a)}catch(t){const a=this.extractGateway(e.url);if(a&&this.updateGatewayStats(a,!1),e.retryCount<this.MAX_RETRIES)e.retryCount++,Oe.warn(`Retrying IPFS request (${e.retryCount}/${this.MAX_RETRIES})`,"IPFSRateLimiter",{url:e.url,error:t instanceof Error?t.message:"Unknown error"}),await this.delay(1e3*e.retryCount),this.requestQueue.unshift(e);else{const a=t instanceof Error?t:new Error(String(t));Oe.error("IPFS request failed after all retries","IPFSRateLimiter",a,{url:e.url}),e.reject(a)}}}async makeRequest(e,t){const a=this.extractIPFSHash(e);if(!a)throw new Error("Invalid IPFS URL");const s=`${t}${a}`;return new Promise((e,t)=>{const a=new Image,n=setTimeout(()=>{a.onload=null,a.onerror=null,t(new Error("Request timeout"))},this.REQUEST_TIMEOUT);a.onload=()=>{clearTimeout(n),e(s)},a.onerror=e=>{clearTimeout(n),t(new Error(`Failed to load image: ${e}`))},a.src=s})}selectBestGateway(e){const t=Date.now(),a=["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://dweb.link/ipfs/","https://cf-ipfs.com/ipfs/"].filter(e=>{const a=this.gatewayStats.get(e);return!a||!(a.isBlocked&&t<a.blockUntil)&&(a.isBlocked&&t>=a.blockUntil&&(a.isBlocked=!1,a.errorCount=0),!0)});return 0===a.length?null:(a.sort((e,t)=>{const a=this.gatewayStats.get(e),s=this.gatewayStats.get(t);return(a?a.errorCount/Math.max(a.requestCount,1):0)-(s?s.errorCount/Math.max(s.requestCount,1):0)}),a[0])}updateGatewayStats(e,t){let a=this.gatewayStats.get(e);if(a||(a={lastRequest:0,requestCount:0,errorCount:0,isBlocked:!1,blockUntil:0},this.gatewayStats.set(e,a)),a.lastRequest=Date.now(),a.requestCount++,!t){a.errorCount++;const t=a.errorCount/a.requestCount;t>.5&&a.requestCount>=5&&(a.isBlocked=!0,a.blockUntil=Date.now()+this.GATEWAY_COOLDOWN,Oe.warn("Blocking gateway due to high error rate","IPFSRateLimiter",{gateway:e,errorRate:t,requestCount:a.requestCount,errorCount:a.errorCount}))}}extractIPFSHash(e){const t=e.match(/\/ipfs\/([a-zA-Z0-9]+)/);return t?t[1]:null}extractGateway(e){const t=e.match(/(https?:\/\/[^\/]+\/ipfs\/)/);return t?t[1]:null}delay(e){return new Promise(t=>setTimeout(t,e))}getStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,gatewayStats:Object.fromEntries(this.gatewayStats)}}reset(){this.requestQueue.forEach(e=>{e.reject(new Error("Rate limiter reset"))}),this.requestQueue=[],this.gatewayStats.clear(),this.activeRequests=0,this.isProcessing=!1}};const Ka=new class{constructor(){M(this,"imageCache",new Map),M(this,"loadingPromises",new Map),M(this,"MAX_CACHE_SIZE",500)}generateFallbackSVG(e={}){const{width:t=150,height:a=150,backgroundColor:s="#f3f4f6",textColor:n="#6b7280",text:i,type:r="generic"}=e,l=i||this.getDefaultText(r),o=.15*Math.min(t,a),c=`\n      <svg width="${t}" height="${a}" xmlns="http://www.w3.org/2000/svg">\n        <rect width="100%" height="100%" fill="${s}"/>\n        <g transform="translate(${t/2}, ${a/2})">\n          ${this.getIconForType(r,.3*Math.min(t,a),n)}\n          <text \n            x="0" \n            y="${1.5*o}" \n            font-family="system-ui, -apple-system, sans-serif" \n            font-size="${o}" \n            font-weight="500" \n            fill="${n}" \n            text-anchor="middle" \n            dominant-baseline="middle"\n          >\n            ${l}\n          </text>\n        </g>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(c)}`}getDefaultText(e){switch(e){case"nft":return"NFT";case"collection":return"Collection";case"avatar":return"Avatar";case"token":return"Token";default:return"Image"}}getIconForType(e,t,a){const s=t,n=Math.max(1,.08*s);switch(e){case"nft":return`\n          <rect \n            x="${-s/2}" \n            y="${-s/2}" \n            width="${s}" \n            height="${s}" \n            rx="${.1*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <circle \n            cx="0" \n            cy="${.15*-s}" \n            r="${.15*s}" \n            fill="${a}"\n          />\n        `;case"collection":return`\n          <rect \n            x="${-s/2}" \n            y="${-s/2}" \n            width="${.7*s}" \n            height="${.7*s}" \n            rx="${.05*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <rect \n            x="${-s/2+.15*s}" \n            y="${-s/2+.15*s}" \n            width="${.7*s}" \n            height="${.7*s}" \n            rx="${.05*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n        `;case"avatar":return`\n          <circle \n            cx="0" \n            cy="${.1*-s}" \n            r="${.25*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <path \n            d="M ${.35*-s} ${.3*s} Q 0 ${.1*s} ${.35*s} ${.3*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n        `;case"token":return`\n          <circle \n            cx="0" \n            cy="0" \n            r="${.4*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <text \n            x="0" \n            y="${.1*s}" \n            font-family="system-ui, -apple-system, sans-serif" \n            font-size="${.3*s}" \n            font-weight="bold" \n            fill="${a}" \n            text-anchor="middle" \n            dominant-baseline="middle"\n          >\n            $\n          </text>\n        `;default:return`\n          <rect \n            x="${-s/2}" \n            y="${-s/2}" \n            width="${s}" \n            height="${s}" \n            rx="${.1*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <path \n            d="M ${.2*-s} ${.1*-s} L ${.2*s} ${.1*-s} L 0 ${.2*s} Z" \n            fill="${a}"\n          />\n        `}}async loadImage(e,t={}){if(!e)return{success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0};const a=this.imageCache.get(e);if(a)return{success:!0,src:a,fallbackUsed:!1};const s=this.loadingPromises.get(e);if(s)return s;const n=this.performImageLoad(e,t);this.loadingPromises.set(e,n);try{return await n}finally{this.loadingPromises.delete(e)}}async performImageLoad(e,t){if(this.isIPFSUrl(e))try{const t=await(a=e,Ga.requestImage(a));return this.addToCache(e,t),{success:!0,src:t,fallbackUsed:!1}}catch(s){return Oe.warn(`IPFS rate-limited load failed: ${e}`,"ImageService",{error:s}),{success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0,error:s instanceof Error?s:new Error("IPFS load failed")}}var a;return new Promise(a=>{const s=new Image,n=setTimeout(()=>{s.onload=null,s.onerror=null,a({success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0,error:new Error("Image load timeout")})},1e4);s.onload=()=>{clearTimeout(n),this.addToCache(e,e),a({success:!0,src:e,fallbackUsed:!1})},s.onerror=s=>{clearTimeout(n);const i=this.generateFallbackSVG(t);Oe.warn(`Failed to load image: ${e}`,"ImageService",{error:s}),a({success:!1,src:i,fallbackUsed:!0,error:s instanceof Error?s:new Error("Image load failed")})},s.src=e})}addToCache(e,t){if(this.imageCache.size>=this.MAX_CACHE_SIZE){const e=this.imageCache.keys().next().value;e&&this.imageCache.delete(e)}this.imageCache.set(e,t)}async preloadImages(e,t={}){const a=e.map(e=>this.loadImage(e,t));return Promise.all(a)}getOptimizedImageUrl(e,t={}){return e?e.startsWith("data:")||e.startsWith("blob:")?e:e.includes("ipfs.io")||e.includes("ipfs://")?this.optimizeIPFSUrl(e):e:this.generateFallbackSVG(t)}isIPFSUrl(e){return e.includes("/ipfs/")||e.startsWith("ipfs://")||e.includes("gateway.pinata.cloud")}optimizeIPFSUrl(e){return this.isIPFSUrl(e),e}clearCache(){this.imageCache.clear(),this.loadingPromises.clear()}getCacheStats(){return{size:this.imageCache.size,maxSize:this.MAX_CACHE_SIZE,hitRate:0}}},Ya=({src:e,alt:t,className:a="",style:s={},width:n,height:i,type:r="generic",fallbackText:l,backgroundColor:o,textColor:c,onLoad:d,onError:u,loading:h="lazy",placeholder:m=!0})=>{const[p,f]=O.useState(""),[x,g]=O.useState(!0),[v,y]=O.useState(null),j=O.useRef(null),b=O.useRef(!1);O.useEffect(()=>{if(b.current)return;b.current=!0;(async()=>{g(!0);const t={width:n,height:i,type:r,text:l,backgroundColor:o,textColor:c};try{const a=await Ka.loadImage(e||"",t);f(a.src),y(a),d&&d(a),!a.success&&a.error&&u&&u(a.error)}catch(a){const e=Ka.generateFallbackSVG(t);f(e),y({success:!1,src:e,fallbackUsed:!0,error:a}),u&&u(a)}finally{g(!1),b.current=!1}})()},[e,n,i,r,l,o,c,d,u]);const N={...s,...n&&{width:n},...i&&{height:i}},w=`fallback-image ${a} ${x?"loading":""} ${v?.fallbackUsed?"fallback-used":""}`.trim();return Se.jsxs("div",{className:"fallback-image-container",style:{position:"relative",display:"inline-block"},children:[x&&m&&Se.jsx("div",{className:"image-placeholder",style:{position:"absolute",top:0,left:0,width:n||"100%",height:i||"100%",backgroundColor:o||"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",zIndex:1},children:Se.jsx("div",{className:"loading-spinner",style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),Se.jsx("img",{ref:j,src:p||"",alt:t,className:w,style:{...N,opacity:x?0:1,transition:"opacity 0.3s ease"},loading:h,onLoad:()=>{g(!1)},onError:()=>{if(v&&!v.fallbackUsed){const e={width:n,height:i,type:r,text:l,backgroundColor:o,textColor:c},t=Ka.generateFallbackSVG(e);f(t),y({success:!1,src:t,fallbackUsed:!0})}g(!1)}}),Se.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        .fallback-image {\n          display: block;\n          max-width: 100%;\n          height: auto;\n        }\n        \n        .fallback-image.loading {\n          opacity: 0;\n        }\n        \n        .fallback-image.fallback-used {\n          filter: grayscale(0.1);\n        }\n        \n        .image-placeholder {\n          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n          background-size: 200% 100%;\n          animation: shimmer 1.5s infinite;\n        }\n        \n        @keyframes shimmer {\n          0% { background-position: -200% 0; }\n          100% { background-position: 200% 0; }\n        }\n      "})]})},Qa=e=>Se.jsx(Ya,{...e,type:"nft"}),Za=e=>Se.jsx(Ya,{...e,type:"collection"}),es=e=>Se.jsx(Ya,{...e,type:"token"}),ts=[{id:"bronze",name:"Bronze",cost:5e6,costFormatted:"5M PXJ",icon:"\ud83e\udd49",description:"Perfect for new collections getting started",benefits:["Basic marketplace listing","Collection verification badge","Community Discord access","Monthly featured spot rotation"]},{id:"silver",name:"Silver",cost:15e6,costFormatted:"15M PXJ",icon:"\ud83e\udd48",description:"Enhanced visibility and analytics access",benefits:["All Bronze benefits","Priority marketplace placement","Weekly newsletter mentions","Custom collection banner","Analytics dashboard access"]},{id:"gold",name:"Gold",cost:3e7,costFormatted:"30M PXJ",icon:"\ud83e\udd47",description:"Premium promotion and exclusive events",benefits:["All Silver benefits","Homepage featured carousel","Social media promotion","Exclusive events participation","Direct community manager contact"]},{id:"platinum",name:"Platinum",cost:5e7,costFormatted:"50M PXJ",icon:"\ud83d\udc8e",description:"Ultimate tier with maximum benefits",benefits:["All Gold benefits","Permanent homepage presence","Dedicated marketing campaigns","WaxRock Council consideration","Platform governance participation","White-label marketplace options"]}],as=({isOpen:e,onClose:t})=>{const[a,s]=O.useState(""),[n,i]=O.useState(""),[r,l]=O.useState(!1),[o,c]=O.useState(null),[d,u]=O.useState(!1),{session:h,isConnected:m}=Fe(),{showSuccess:p,showError:f}=xt();D.useEffect(()=>{e&&m&&h&&x()},[e,m,h]);const x=async()=>{if(h){u(!0);try{const e=await dt.getWaxCurrencyBalance(Gt.safeGetActor(h),"token.pxj","PXJ"),t=e.length>0?parseFloat(e[0].balance.split(" ")[0]):0;c(t)}catch(e){De.error("Failed to fetch PXJ balance","CollectionTierModal",e),c(0)}finally{u(!1)}}},g=ts.find(e=>e.id===a);return e?Se.jsx("div",{className:"modal-backdrop",onClick:t,children:Se.jsxs("div",{className:"modal-content collection-tier-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{className:"modal-title",children:"Upgrade Collection Tier"}),Se.jsx("button",{className:"modal-close",onClick:t,children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsx("div",{className:"balance-section",children:Se.jsxs("div",{className:"balance-info",children:[Se.jsx("span",{className:"balance-label",children:"Your PXJ Balance:"}),Se.jsx("span",{className:"collection-balance-amount",children:d?Se.jsx("span",{className:"loading-text",children:"Loading..."}):Se.jsx("span",{className:null!==o&&o>0?"balance-positive":"balance-zero",children:null!==o?`${o.toLocaleString()} PXJ`:"Unable to load"})})]})}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"collectionName",children:"Collection Name:"}),Se.jsx("input",{type:"text",id:"collectionName",value:n,onChange:e=>i(e.target.value),placeholder:"Enter your collection name",className:"collection-input",disabled:r})]}),Se.jsxs("div",{className:"tier-selection",children:[Se.jsx("h3",{children:"Select Tier:"}),Se.jsx("div",{className:"tier-grid",children:ts.map(e=>{const t=(e=>null!==o&&o>=e.cost)(e),n=a===e.id;return Se.jsxs("div",{className:`tier-card ${n?"selected":""} ${t?"":"unaffordable"}`,onClick:()=>!r&&s(e.id),children:[Se.jsxs("div",{className:"tier-header",children:[Se.jsx("span",{className:"tier-icon",children:e.icon}),Se.jsxs("div",{className:"tier-info",children:[Se.jsx("h4",{className:"tier-name",children:e.name}),Se.jsx("div",{className:"tier-cost",children:e.costFormatted})]}),!t&&Se.jsx("div",{className:"insufficient-badge",children:"Insufficient Balance"})]}),Se.jsx("p",{className:"tier-description",children:e.description}),Se.jsxs("div",{className:"tier-benefits",children:[Se.jsx("h5",{children:"Benefits:"}),Se.jsx("ul",{children:e.benefits.map((e,t)=>Se.jsx("li",{children:e},t))})]})]},e.id)})})]}),g&&Se.jsxs("div",{className:"selected-tier-summary",children:[Se.jsx("h4",{children:"Upgrade Summary"}),Se.jsxs("div",{className:"summary-content",children:[Se.jsxs("div",{className:"summary-item",children:[Se.jsx("span",{children:"Collection:"}),Se.jsx("span",{children:n||"Not specified"})]}),Se.jsxs("div",{className:"summary-item",children:[Se.jsx("span",{children:"Tier:"}),Se.jsxs("span",{children:[g.icon," ",g.name]})]}),Se.jsxs("div",{className:"summary-item",children:[Se.jsx("span",{children:"Cost:"}),Se.jsx("span",{children:g.costFormatted})]}),Se.jsxs("div",{className:"summary-item",children:[Se.jsx("span",{children:"Remaining Balance:"}),Se.jsx("span",{children:null!==o?`${(o-g.cost).toLocaleString()} PXJ`:"Unknown"})]})]})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"btn-secondary",onClick:t,disabled:r,children:"Cancel"}),Se.jsx("button",{className:"btn-primary",onClick:async()=>{if(!a||!n.trim())return void f("Please select a tier and enter a collection name");if(!m||!h)return void f("Please connect your wallet to proceed with payment");const e=ts.find(e=>e.id===a);if(e)if(null!==o&&o<e.cost)f(`Insufficient PXJ balance. You need at least ${e.costFormatted} to upgrade to ${e.name} tier.`);else{l(!0);try{const a=`upgrade-collection:${n.toUpperCase()}:${e.id.toUpperCase()}`,r={account:"token.pxj",name:"transfer",authorization:[{actor:Gt.safeGetActor(h),permission:"active"}],data:{from:Gt.safeGetActor(h),to:"market.pxj",quantity:`${e.cost.toFixed(8)} PXJ`,memo:a}};await Kt.transact([r]),p(`Successfully upgraded ${n} to ${e.name} tier! Your upgrade will be processed by our team.`),t(),s(""),i("")}catch(r){De.error("Tier upgrade payment failed","CollectionTierModal",r instanceof Error?r:new Error(String(r))),f(`Payment failed: ${r instanceof Error?r.message:"Unknown error"}`)}finally{l(!1)}}else f("Invalid tier selected")},disabled:r||!a||!n.trim()||!m||g&&null!==o&&o<g.cost,children:r?Se.jsxs(Se.Fragment,{children:[Se.jsx("span",{className:"loading-spinner"}),"Processing..."]}):`Upgrade to ${g?.name||"Selected Tier"}`})]})]})}):null},ss=()=>{const[e,t]=O.useState([]),[a,s]=O.useState(!1),[n,i]=O.useState(null),[r,l]=O.useState(!1),[o,c]=O.useState(""),[d,u]=O.useState("name"),[h,m]=O.useState(12),[p,f]=O.useState(!1),[x,g]=O.useState(!1),[v,y]=O.useState(0),[j,b]=O.useState([{name:"Pixel Journey",collection:"pixeljourney",image:null,description:"The original Pixel Journey collection",tier:"platinum",verified:!0},{name:"Fried Factory",collection:"friedfactory",image:null,description:"3D NFT collection by @Friedfactory the 3D legend (and artist of our Journey Ingredients too)!",tier:"partner",verified:!0},{name:"Crypto Muffins",collection:"crptomuffins",image:null,description:"Delicious crypto-themed NFT collection by AKU!",tier:"gold",verified:!0},{name:"Aku Fish Heads",collection:"akufishheads",image:null,description:"Unique AKU-licious NFT collection",tier:"silver",verified:!0},{name:"Pantheon",collection:"pantheon",image:null,description:"Mythological NFT collection",tier:"bronze",verified:!0},{name:"Pocket People",collection:"pocketsizedp",image:null,description:"Pocket Sized PFPs by our first Partner, Kettleman!",tier:"partner",verified:!0},{name:"NIMAs Odyssey",collection:"nimasodyssey",image:null,description:"NIMAs Odyssey, a Discord RPG Driven NFT Mining Game",tier:"partner",verified:!0}]),N=O.useCallback(async()=>{try{b(e=>{const t=e.filter(e=>!e.image);return 0===t.length||Promise.all(t.map(async e=>{try{const t=await dt.getCollectionDetails(e.collection);return{...e,image:t?.img||null}}catch(t){return De.warn(`Failed to fetch image for ${e.collection}`,"Collections",t),e}})).then(e=>{b(t=>t.map(t=>e.find(e=>e.collection===t.collection)||t))}),e})}catch(e){De.error("Failed to fetch PxApproved project images","Collections",e)}},[]),w=async e=>{const a=[...e];for(let t=0;t<e.length;t+=5){const s=e.slice(t,t+5);(await Promise.allSettled(s.map(async(e,s)=>{const n=t+s;try{const[t,s]=await Promise.all([dt.getCollectionFloorPrice(e.collection_name),dt.getCollectionMarketStats({collection_name:e.collection_name})]);return{index:n,data:{...a[n],floor_price:t.floorPrice,volume:s.data?.volume,market_cap:s.data?.volume?(t.floorPrice*parseFloat(s.data.volume)).toFixed(2):void 0,assets:s.data?.sales,loading_market_data:!1}}}catch(i){return Le.logError("Collections.fetchMarketDataForCollections",i,{collection_name:e.collection_name}),{index:n,data:{...a[n],loading_market_data:!1}}}}))).forEach(e=>{"fulfilled"===e.status&&(a[e.value.index]=e.value.data)}),t+5<e.length&&await new Promise(e=>setTimeout(e,100))}t([...a])},k=async(e=50)=>{s(!0),i(null);try{const a=await dt.getCollections({limit:e,whitelistOnly:!0}),s=(a||[]).map(e=>({collection_name:e.collection_name,name:e.name,img:e.img,author:e.author,created_at_time:e.created_at_time,created_at_block:e.created_at_block,loading_market_data:!0}));t(s),y(a?.length||0),w(s)}catch(a){const t=a instanceof Error?a:new Error("Failed to fetch collections");i(t),Le.logError("Collections.fetchCollections",t,{limit:e})}finally{s(!1)}};O.useEffect(()=>{k(),N()},[N]);const _=e.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.collection_name.toLowerCase().includes(o.toLowerCase())||e.author.toLowerCase().includes(o.toLowerCase())).sort((e,t)=>{switch(d){case"name":return e.name.localeCompare(t.name);case"author":return e.author.localeCompare(t.author);case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();default:return 0}}),S=j.filter(e=>e.name.toLowerCase().includes(o.toLowerCase())||e.collection.toLowerCase().includes(o.toLowerCase())),C=_.slice(0,h),A=_.length>h||v>=50&&h>=_.length;return Se.jsxs("div",{className:"collections-container",children:[Se.jsxs("div",{className:"perk-tiers-section",children:[Se.jsxs("div",{className:"collections-header",children:[Se.jsx("h1",{children:"Collections"}),Se.jsx("p",{className:"collections-subtitle",children:"Discover amazing NFT collections on the WAX blockchain"})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h3",{children:"PxApproved Collections"}),Se.jsx("p",{children:"Only PxApproved collections are listed on our marketplace by default. This ensures quality and authenticity for our community."}),Se.jsxs("div",{className:"info-actions",children:[Se.jsxs("a",{href:"https://discord.gg/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"discord-link",children:[Se.jsx("svg",{className:"discord-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"})}),"Join Discord for More Info"]}),Se.jsx("button",{className:"payment-button",onClick:()=>l(!0),children:"Upgrade Collection Tier"}),Se.jsxs("button",{className:"toggle-tiers-button",onClick:()=>g(!x),children:[x?"Hide Tier Details":"Show Tier Details",Se.jsx("svg",{className:"toggle-icon "+(x?"rotated":""),viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})})]})]})]}),Se.jsx("p",{className:"tiers-description",children:"Elevate your collection's status on PxMarket with our tier system. Each tier unlocks exclusive benefits and promotional opportunities."}),x&&Se.jsxs("div",{className:"tiers-content",children:[Se.jsx("div",{className:"tiers-header",children:Se.jsx("h2",{children:"PxApproved Perk Tiers"})}),Se.jsxs("div",{className:"tiers-grid",children:[Se.jsxs("div",{className:"tier-card tier-bronze",children:[Se.jsxs("div",{className:"tier-header",children:[Se.jsx("span",{className:"tier-icon",children:"\ud83e\udd49"}),Se.jsx("h3",{children:"Bronze"}),Se.jsx("div",{className:"tier-cost",children:"5M PXJ"})]}),Se.jsxs("div",{className:"tier-benefits",children:[Se.jsx("h4",{children:"Benefits:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Basic marketplace listing"}),Se.jsx("li",{children:"Collection verification badge"}),Se.jsx("li",{children:"Community Discord access"}),Se.jsx("li",{children:"Monthly featured spot rotation"})]})]})]}),Se.jsxs("div",{className:"tier-card tier-silver",children:[Se.jsxs("div",{className:"tier-header",children:[Se.jsx("span",{className:"tier-icon",children:"\ud83e\udd48"}),Se.jsx("h3",{children:"Silver"}),Se.jsx("div",{className:"tier-cost",children:"15M PXJ"})]}),Se.jsxs("div",{className:"tier-benefits",children:[Se.jsx("h4",{children:"Benefits:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"All Bronze benefits"}),Se.jsx("li",{children:"Priority marketplace placement"}),Se.jsx("li",{children:"Weekly newsletter mentions"}),Se.jsx("li",{children:"Custom collection banner"}),Se.jsx("li",{children:"Analytics dashboard access"})]})]})]}),Se.jsxs("div",{className:"tier-card tier-gold",children:[Se.jsxs("div",{className:"tier-header",children:[Se.jsx("span",{className:"tier-icon",children:"\ud83e\udd47"}),Se.jsx("h3",{children:"Gold"}),Se.jsx("div",{className:"tier-cost",children:"30M PXJ"})]}),Se.jsxs("div",{className:"tier-benefits",children:[Se.jsx("h4",{children:"Benefits:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"All Silver benefits"}),Se.jsx("li",{children:"Homepage featured carousel"}),Se.jsx("li",{children:"Social media promotion"}),Se.jsx("li",{children:"Exclusive events participation"}),Se.jsx("li",{children:"Direct community manager contact"})]})]})]}),Se.jsxs("div",{className:"tier-card tier-partner",children:[Se.jsxs("div",{className:"tier-header",children:[Se.jsx("span",{className:"tier-icon",children:"\ud83e\udd1d"}),Se.jsx("h3",{children:"Partner"}),Se.jsx("div",{className:"tier-cost",children:"Special Agreement"})]}),Se.jsxs("div",{className:"tier-benefits",children:[Se.jsx("h4",{children:"Benefits:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"All Gold benefits"}),Se.jsx("li",{children:"Co-marketing opportunities"}),Se.jsx("li",{children:"Revenue sharing programs"}),Se.jsx("li",{children:"Joint event hosting"}),Se.jsx("li",{children:"Custom integration support"})]})]})]}),Se.jsxs("div",{className:"tier-card tier-platinum",children:[Se.jsxs("div",{className:"tier-header",children:[Se.jsx("span",{className:"tier-icon",children:"\ud83d\udc8e"}),Se.jsx("h3",{children:"Platinum"}),Se.jsx("div",{className:"tier-cost",children:"50M PXJ"})]}),Se.jsxs("div",{className:"tier-benefits",children:[Se.jsx("h4",{children:"Benefits:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"All Partner benefits"}),Se.jsx("li",{children:"Permanent homepage presence"}),Se.jsx("li",{children:"Dedicated marketing campaigns"}),Se.jsx("li",{children:"WaxRock Council consideration"}),Se.jsx("li",{children:"Platform governance participation"}),Se.jsx("li",{children:"White-label marketplace options"})]})]})]})]})]}),x&&Se.jsx("div",{className:"council-note",children:Se.jsxs("div",{className:"council-info",children:[Se.jsx("span",{className:"council-icon",children:"\ud83c\udfdb\ufe0f"}),Se.jsxs("div",{children:[Se.jsx("h4",{children:"WaxRock Council Authority"}),Se.jsx("p",{children:"The WaxRock Council reserves the right to grant special tier status to exceptional collections through community proposals and voting. Collections may also lobby for tier upgrades through formal governance processes."})]})]})}),x&&Se.jsxs("div",{className:"apply-section",children:[Se.jsx("h3",{children:"Ready to Upgrade Your Collection?"}),Se.jsx("p",{children:"Contact our team to discuss tier upgrades and promotional opportunities."}),Se.jsxs("div",{className:"apply-buttons",children:[Se.jsx("a",{href:"https://discord.gg/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"apply-btn discord-btn",children:"Apply via Discord"}),Se.jsx("button",{className:"apply-btn payment-btn",onClick:()=>l(!0),children:"Instant Tier Upgrade"})]})]})]}),Se.jsx(as,{isOpen:r,onClose:()=>l(!1)}),Se.jsxs("div",{className:"search-filter-section",children:[Se.jsxs("div",{className:"search-controls",children:[Se.jsxs("div",{className:"search-input-container",children:[Se.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("input",{type:"text",placeholder:"Search collections, authors, or names...",value:o,onChange:e=>c(e.target.value),className:"search-input"}),o&&Se.jsx("button",{onClick:()=>c(""),className:"clear-search","aria-label":"Clear search",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),Se.jsxs("select",{id:"sortBy",value:d,onChange:e=>u(e.target.value),className:"sort-select",children:[Se.jsx("option",{value:"name",children:"Name"}),Se.jsx("option",{value:"author",children:"Author"}),Se.jsx("option",{value:"created",children:"Created Date"})]})]})]}),o&&Se.jsx("div",{className:"search-results-info",children:Se.jsxs("p",{children:["Found ",_.length+S.length,' results for "',o,'"']})})]}),(!o||S.length>0)&&Se.jsxs("div",{className:"pxapproved-section",children:[Se.jsxs("h2",{children:["PxApproved ",o&&`(${S.length})`]}),Se.jsx("div",{className:"approved-projects-grid",children:S.map((e,t)=>Se.jsx(U,{to:`/collections/${e.collection}`,className:"project-card-link",children:Se.jsxs("div",{className:`project-card project-card-${e.tier}`,children:[Se.jsxs("div",{className:"project-tier-badge",children:[Se.jsx("span",{className:`tier-label tier-${e.tier}`,children:e.tier.toUpperCase()}),e.verified&&Se.jsx("span",{className:"verified-badge",children:"\u2713"})]}),Se.jsx("img",{src:e.image&&"string"==typeof e.image?e.image.startsWith("http")?e.image:`https://ipfs.io/ipfs/${e.image}`:"/img/placeholder-collection.svg",alt:e.name,className:"project-image",onError:e=>{e.currentTarget.src="/img/placeholder-collection.svg"}}),Se.jsxs("div",{className:"project-info",children:[Se.jsx("h3",{children:e.name}),Se.jsx("p",{className:"project-collection",children:e.collection}),Se.jsx(Va,{text:e.description,maxLength:240,className:"project-description"})]})]})},t))})]}),Se.jsxs("div",{className:"all-collections-section",children:[Se.jsxs("h2",{children:["More Collections on WAX ",o&&`(${_.length})`]}),n?Se.jsx(va,{errorType:"COLLECTION_NOT_FOUND",onRetry:()=>k(),showRetry:!0}):a?Se.jsxs("div",{className:"loading-spinner",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading collections..."})]}):Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"collections-grid",children:C.length>0?C.map(e=>Se.jsxs(U,{to:`/collections/${e.collection_name}`,className:"collection-card",children:[Se.jsx(Za,{src:e.img?e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`:void 0,alt:e.collection_name,width:150,height:150,fallbackText:e.collection_name,className:"collection-image"}),Se.jsxs("div",{className:"collection-info",children:[Se.jsx("div",{className:"collection-row-1",children:Se.jsx("h3",{children:e.name})}),Se.jsx("div",{className:"collection-row-2",children:Se.jsx("p",{className:"collection-name",children:e.collection_name})}),Se.jsx("div",{className:"collection-market-data",children:e.loading_market_data?Se.jsxs("div",{className:"market-data-loading",children:[Se.jsx("div",{className:"mini-spinner"}),Se.jsx("span",{children:"Loading market data..."})]}):Se.jsxs(Se.Fragment,{children:[void 0!==e.floor_price&&e.floor_price>0&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Floor:"}),Se.jsxs("span",{className:"stat-value",children:[e.floor_price.toFixed(4)," WAX"]})]}),e.volume&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Volume:"}),Se.jsxs("span",{className:"stat-value",children:[parseFloat(e.volume).toLocaleString()," WAX"]})]}),e.assets&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Assets:"}),Se.jsx("span",{className:"stat-value",children:e.assets})]})]})})]})]},e.collection_name)):o?Se.jsxs("div",{className:"no-results",children:[Se.jsx("svg",{className:"no-results-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("h3",{children:"No collections found"}),Se.jsx("p",{children:"Try adjusting your search terms or browse all collections"}),Se.jsx("button",{onClick:()=>c(""),className:"clear-search-button",children:"Clear Search"})]}):null}),A&&!o&&Se.jsx("div",{className:"load-more-container",children:Se.jsx("button",{onClick:async()=>{f(!0);try{if(h<e.length)m(e=>e+12);else{const e=v+50,a=await dt.getCollections({limit:e,whitelistOnly:!0});if(a&&a.length>v){const e=a.map(e=>({collection_name:e.collection_name,name:e.name,img:e.img,author:e.author,created_at_time:e.created_at_time,created_at_block:e.created_at_block,loading_market_data:!0}));t(e),y(a.length),m(e=>e+12);const s=e.slice(v);s.length>0&&w(s)}}}catch(a){const e=a instanceof Error?a:new Error("Failed to load more collections");Le.logError("Collections.loadMoreCollections",e,{displayedCount:h,totalFetched:v})}finally{f(!1)}},disabled:p,className:"load-more-button",children:p?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"button-spinner"}),"Loading..."]}):`Load More Collections (${_.length-h} remaining)`})})]})]})]})},ns={pixeljourney:{tier:"platinum",verified:!0,quickLinks:[{label:"Main Website",url:"https://pixeljourney.xyz",icon:"\ud83c\udf10"},{label:"Discord",url:"http://discord.gg/pixel-journey-1130670500776005734",icon:"\ud83d\udcac"},{label:"X/Twitter",url:"https://x.com/PXJourney",icon:"\ud83d\udc26"},{label:"Whitepaper",url:"https://docs.pixeljourney.xyz",icon:"\ud83d\udcc4"}],benefits:["Premium marketplace placement","Exclusive promotional campaigns","Priority customer support","Advanced analytics dashboard","Custom branding options"],ownerMessage:"Welcome to Pixel Journey! Join our community of adventurers exploring the digital realm. Connect with fellow travelers, learn about all the things and discover exclusive content.",discordUrl:"http://discord.gg/pixel-journey-1130670500776005734",learnAboutGrid:[{title:"PXJ Token",description:"Learn about our native utility token, its use cases, and how it powers the Pixel Journey ecosystem.",icon:"\ud83e\ude99",url:"https://docs.pixeljourney.xyz/season-1/kickstarting-the-pxj-economy"},{title:"NFT Collections",description:"Discover our diverse range of NFT collectibles, from Pixal PFPs to Pixel Ingredients and special editions.",icon:"\ud83c\udfa8",url:"https://docs.pixeljourney.xyz/season-1/the-pixal-pfps"},{title:"Leaderboards",description:"Explore the PXJourney mechanics, quests, and adventures awaiting in Pixel Journey.",icon:"\ud83c\udfae",url:"https://lb.pixeljourney.xyz/"},{title:"Staking & Rewards",description:"Understand how to stake your NFTs and tokens to earn rewards and participate in governance.",icon:"\ud83d\udc8e",url:"https://pixeljourney.xyz/staking"},{title:"Roadmap",description:"Check out our development roadmap and upcoming features planned for the ecosystem.",icon:"\ud83d\uddfa\ufe0f",url:"/journeymap"},{title:"Community",description:"Join our vibrant community of adventurers, participate in events, and connect with fellow travelers.",icon:"\ud83d\udc65",url:"http://discord.gg/pixel-journey-1130670500776005734"}]},friedfactory:{tier:"partner",verified:!0,quickLinks:[{label:"Artist Portfolio",url:"https://friedfactory.art",icon:"\ud83c\udfa8"},{label:"Discord",url:"https://discord.gg/friedfactory",icon:"\ud83d\udcac"},{label:"Twitter",url:"https://twitter.com/friedfactory",icon:"\ud83d\udc26"}],benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]},crptomuffins:{tier:"gold",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"\u2139\ufe0f"},{label:"Discord",url:"#",icon:"\ud83d\udcac"}],benefits:["Homepage featured carousel","Social media promotion","Exclusive events participation","Direct community manager contact"]},akufishheads:{tier:"silver",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"\u2139\ufe0f"}],benefits:["Priority marketplace placement","Weekly newsletter mentions","Custom collection banner","Analytics dashboard access"]},pantheon:{tier:"bronze",verified:!0,benefits:["Basic marketplace listing","Collection verification badge","Community Discord access","Monthly featured spot rotation"]},pocketsizedp:{tier:"partner",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"\u2139\ufe0f"}],benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]},nimasodyssey:{tier:"partner",verified:!0,benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]}},is=({collectionName:e})=>{const t=T(e);if(!t)return null;const a=P(t.tier),s=t.quickLinks&&t.quickLinks.length>0;return Se.jsxs("div",{className:"quick-links-container",children:[Se.jsx("div",{className:"tier-section",children:Se.jsxs("div",{className:`tier-badge ${a.className}`,children:[Se.jsx("span",{className:"tier-icon",children:a.icon}),Se.jsx("span",{className:"tier-label",children:a.label}),t.verified&&Se.jsx("span",{className:"verified-icon",children:"\u2713"})]})}),s&&Se.jsxs("div",{className:"links-section",children:[Se.jsx("h4",{className:"links-title",children:"Quick Links"}),Se.jsx("div",{className:"links-grid",children:t.quickLinks.map((e,t)=>Se.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"quick-link",children:[e.icon&&Se.jsx("span",{className:"link-icon",children:e.icon}),Se.jsx("span",{className:"link-label",children:e.label})]},t))})]}),(t.ownerMessage||t.discordUrl)&&Se.jsxs("div",{className:"owner-section",children:[t.ownerMessage&&Se.jsxs("div",{className:"owner-message",children:[Se.jsxs("div",{className:"owner-title-container",style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[Se.jsx("h4",{className:"owner-title",children:"From the Collection Owner"}),Se.jsx("div",{className:"info-tooltip",title:"This message is provided directly by the collection owner to share information about their project, community, or special announcements with collectors and fans.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"rgba(255, 255, 255, 0.7)",fontSize:"12px",fontWeight:"bold",cursor:"help",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.15)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",e.currentTarget.style.color="rgba(255, 255, 255, 0.7)"},children:"?"})]}),Se.jsx("p",{className:"owner-text",children:t.ownerMessage})]}),t.discordUrl&&Se.jsx("div",{className:"discord-section",children:Se.jsxs("a",{href:t.discordUrl,target:"_blank",rel:"noopener noreferrer",className:"discord-link",children:[Se.jsx("span",{className:"discord-icon",children:"\ud83d\udcac"}),Se.jsx("span",{className:"discord-text",children:"Join Our Discord Community"}),Se.jsx("span",{className:"external-icon",children:"\u2197"})]})})]}),t.learnAboutGrid&&Se.jsxs("div",{className:"learn-about-section",style:{marginTop:"2rem"},children:[Se.jsx("h3",{className:"learn-about-title",children:"Learn About Pixel Journey"}),Se.jsx("div",{className:"learn-about-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginTop:"16px"},children:t.learnAboutGrid.map((e,t)=>Se.jsxs("div",{className:"learn-about-card",style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"20px",transition:"all 0.3s ease",cursor:e.url?"pointer":"default"},onClick:()=>e.url&&window.open(e.url,"_blank"),onMouseEnter:t=>{e.url&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.08)",t.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",t.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:t=>{e.url&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.05)",t.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)",t.currentTarget.style.transform="translateY(0)")},children:[Se.jsxs("div",{className:"learn-card-header",style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[Se.jsx("span",{className:"learn-card-icon",style:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:e.icon}),Se.jsx("h4",{className:"learn-card-title",style:{margin:0,fontSize:"16px",fontWeight:"600",color:"white"},children:e.title}),e.url&&Se.jsx("span",{className:"external-link-icon",style:{marginLeft:"auto",fontSize:"14px",color:"rgba(255, 255, 255, 0.6)"},children:"\u2197"})]}),Se.jsx("p",{className:"learn-card-description",style:{margin:0,fontSize:"14px",lineHeight:"1.5",color:"rgba(255, 255, 255, 0.8)"},children:e.description})]},t))})]})]})},rs=({collectionName:e})=>{const{account:t,isConnected:a}=Fe(),{showError:s,showSuccess:n}=xt(),{settings:i}=at(),[r,l]=O.useState(!1),[o,c]=O.useState(!0),[d,u]=O.useState(!1),[h,m]=O.useState(!1),[p,f]=O.useState([]),[x,g]=O.useState(0),[v,y]=O.useState(null),[j,b]=O.useState(""),[N,w]=O.useState(null),[k,_]=O.useState(!1),[C,A]=O.useState(!0),[T,P]=O.useState(30),[E,I]=O.useState(!1),[F,$]=O.useState(!1),[L,M]=O.useState(!1),[R,W]=O.useState({collection:e||void 0,hideSpam:!0}),D=O.useRef(null),U=O.useRef(null),B=O.useRef(null),z=(e,t="")=>{const a=B.current;if(!a)return;const s=a.selectionStart,n=a.selectionEnd,i=j.substring(s,n),r=j.substring(0,s),l=j.substring(n);b(r+e+i+t+l),setTimeout(()=>{a.focus();const n=s+e.length+i.length+t.length;a.setSelectionRange(n,n)},0)},X=e=>{const t=S(e);return Se.jsx("span",{dangerouslySetInnerHTML:{__html:t}})};O.useEffect(()=>{if(0!==p.length)if(v){const e=p.filter(e=>new Date(e.timestamp)>new Date(v));g(e.length)}else g(o?p.length:0);else g(0)},[p,v,o]),O.useEffect(()=>{if(!o&&p.length>0){const e=p[p.length-1];y(e.timestamp),g(0)}},[o,p]);const H=O.useCallback(async(t=!1)=>{t||u(!0);try{const t=e?{...R,collection:e}:R,a=await na.getMessages(t,50,0);f(a)}catch(a){De.error("Error loading messages:","ChatWidget",a),t||s("Failed to load chat messages")}finally{t||u(!1)}},[R,e,s]);O.useEffect(()=>{!e||R.collection&&R.collection===e||W(t=>({...t,collection:e}))},[e,R]),O.useEffect(()=>{H()},[H]),O.useEffect(()=>(C&&!o?U.current=setInterval(()=>{H(!0)},1e3*T):U.current&&(clearInterval(U.current),U.current=null),()=>{U.current&&clearInterval(U.current)}),[C,o,T,H]);const q=O.useCallback(async()=>{if(t&&j)try{const e=await na.calculateMessageCost(j,t,k);w(e)}catch(e){De.error("Error calculating cost:","ChatWidget",e)}},[t,j,k]);if(O.useEffect(()=>{j&&t?q():w(null)},[j,t,q]),O.useEffect(()=>{V()},[p]),!i.showChatButton)return null;const J=async()=>{if(t&&j.trim()){m(!0);try{const a=e?`::col:${e}:: ${j.trim()}`:j.trim(),s=await na.sendMessage(a,t,e,k);n("Message sent!",`Transaction: ${s.substring(0,8)}...`),b(""),w(null),_(!1),setTimeout(()=>{H(!0)},2e3)}catch(a){De.error("Error sending message:","ChatWidget",a);const e=a instanceof Error?a.message:"Unknown error";e.includes("transaction ID not found")?s("Message Status Unclear","Your message may have been sent successfully. Please check your transaction history or refresh the chat to confirm."):s("Failed to send message",e)}finally{m(!1)}}},V=()=>{D.current?.scrollIntoView({behavior:"smooth"})},G=e=>{const t=new Date(e),a=(new Date).getTime()-t.getTime(),s=Math.floor(a/6e4),n=Math.floor(a/36e5),i=Math.floor(a/864e5);return s<1?"now":s<60?`${s}m`:n<24?`${n}h`:i<7?`${i}d`:t.toLocaleDateString()},K=e=>{const t=parseFloat(e.split(" ")[0]);return t>=1e3?`${(t/1e3).toFixed(1)}K PXJ`:`${t.toFixed(0)} PXJ`},Y=e=>e.isSponsored?"chat_message--sponsored":"premium"===e.messageType?"chat_message--premium":"chat_message--normal";return o?Se.jsx("div",{className:"chat_widget chat_widget--minimized",children:Se.jsxs("button",{className:"chat_toggle-btn",onClick:()=>c(!1),title:"Open Chat",children:[Se.jsx("span",{className:"chat_icon",children:"\ud83d\udcac"}),x>0&&Se.jsx("span",{className:"chat_notification-badge",children:x})]})}):Se.jsxs("div",{className:"chat_widget "+(r?"chat_widget--expanded":"chat_widget--normal"),children:[Se.jsxs("div",{className:"chat_header",children:[Se.jsxs("div",{className:"chat_header-left",children:[Se.jsx("span",{className:"chat_title",children:e?`${e} Chat`:"Global Chat"}),Se.jsxs("span",{className:"chat_status",children:[p.length," messages"]})]}),Se.jsxs("div",{className:"chat_header-right",children:[Se.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>H(),disabled:d,title:"Refresh",children:Se.jsx("span",{className:"chat_refresh-icon "+(d?"chat_refresh-icon--spinning":""),children:"\ud83d\udd04"})}),Se.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>l(!r),title:r?"Minimize":"Expand",children:Se.jsx("span",{children:r?"\ud83d\uddd7":"\ud83d\uddd6"})}),Se.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>c(!0),title:"Close",children:Se.jsx("span",{children:"\u2715"})})]})]}),!e&&Se.jsxs("div",{className:"chat_filters",children:[Se.jsxs("select",{className:"chat_select",value:R.collection||"",onChange:e=>W({...R,collection:e.target.value||void 0}),children:[Se.jsx("option",{value:"",children:"All Collections"}),Se.jsx("option",{value:"pixeljourney",children:"Pixel Journey"}),Se.jsx("option",{value:"pixalcards",children:"Pixal Cards"})]}),Se.jsxs("label",{className:"chat_checkbox-label",children:[Se.jsx("input",{type:"checkbox",checked:R.hideSpam||!1,onChange:e=>W({...R,hideSpam:e.target.checked})}),"Hide Spam"]}),Se.jsxs("label",{className:"chat_checkbox-label",children:[Se.jsx("input",{type:"checkbox",checked:R.showOnlySponsored||!1,onChange:e=>W({...R,showOnlySponsored:e.target.checked})}),"Sponsored Only"]})]}),Se.jsxs("div",{className:"chat_messages",children:[d&&0===p.length?Se.jsx("div",{className:"chat_loading",children:"Loading messages..."}):0===p.length?Se.jsxs("div",{className:"chat_empty",children:[Se.jsx("p",{children:"No messages yet."}),Se.jsx("p",{children:"Be the first to start the conversation!"})]}):p.map(e=>Se.jsxs("div",{className:`chat_message ${Y(e)}`,children:[Se.jsxs("div",{className:"chat_message-header",children:[Se.jsx("div",{className:"chat_message-avatar",children:Se.jsx("img",{src:`https://api.dicebear.com/7.x/identicon/svg?seed=${e.sender}`,alt:e.sender,className:"chat_avatar"})}),Se.jsxs("div",{className:"chat_message-info",children:[Se.jsx("span",{className:"chat_sender",children:e.sender}),Se.jsx("span",{className:"chat_timestamp",children:G(e.timestamp)}),Se.jsx("span",{className:"chat_amount",children:K(e.pxjAmount)}),e.isSponsored&&Se.jsx("span",{className:"chat_sponsored-badge",children:"SPONSORED"})]}),Se.jsx("div",{className:"chat_message-actions",children:Se.jsx("a",{href:`https://wax.bloks.io/transaction/${e.transactionId}`,target:"_blank",rel:"noopener noreferrer",className:"chat_tx-link",title:"View on Explorer",children:"\ud83d\udd17"})})]}),Se.jsx("div",{className:"chat_message-content",children:X(e.message)})]},e.id)),Se.jsx("div",{ref:D})]}),a?Se.jsxs("div",{className:"chat_input-section",children:[N&&Se.jsxs("div",{className:"chat_cost-info",children:[Se.jsxs("div",{className:"chat_cost-display",children:[Se.jsxs("span",{className:"chat_cost-amount",children:["Cost: ",(N.totalCost/1e4).toFixed(4)," PXJ"]}),Se.jsx("button",{className:"chat_info-btn",onClick:()=>M(!L),title:"View price breakdown",children:"\u2139\ufe0f"})]}),N.hasPixalPFP&&Se.jsxs("span",{className:"chat_discount",children:["Pixal PFP Discount: ",N.discount,"%"]}),Se.jsxs("span",{className:"chat_char-count",children:[j.length,"/240 chars"]}),L&&Se.jsx("div",{className:"chat_price-tooltip",children:Se.jsxs("div",{className:"chat_price-content",children:[Se.jsx("h4",{children:"Price Breakdown"}),Se.jsxs("div",{className:"price-factor",children:[Se.jsx("span",{children:"Base Cost:"}),Se.jsxs("span",{children:[(N.baseCost/1e4).toFixed(4)," PXJ"]})]}),Se.jsxs("div",{className:"price-factor",children:[Se.jsxs("span",{children:["Character Cost (",j.length," chars):"]}),Se.jsxs("span",{children:[((N.totalCost-N.baseCost)/1e4).toFixed(4)," PXJ"]})]}),N.hasPixalPFP&&Se.jsxs("div",{className:"price-factor discount",children:[Se.jsxs("span",{children:["Pixal PFP Discount (",N.discount,"%):"]}),Se.jsxs("span",{children:["-",((N.baseCost+(N.totalCost-N.baseCost))*(N.discount/100)/1e4).toFixed(4)," PXJ"]})]}),Se.jsxs("div",{className:"price-factor total",children:[Se.jsx("span",{children:"Total Cost:"}),Se.jsxs("span",{children:[(N.totalCost/1e4).toFixed(4)," PXJ"]})]}),Se.jsx("div",{className:"price-note",children:Se.jsx("small",{children:"Cost increases by 100% per 50 extra characters. Holders capped at 500 PXJ."})})]})})]}),Se.jsxs("div",{className:"chat_input-controls",children:[Se.jsxs("div",{className:"chat_sponsored-container",children:[Se.jsxs("label",{className:"chat_checkbox-label",children:[Se.jsx("input",{type:"checkbox",checked:k,onChange:e=>_(e.target.checked)}),"Sponsored (",N?.hasPixalPFP?"10,000":"25,000"," PXJ)"]}),Se.jsx("button",{className:"chat_info-btn",onClick:()=>I(!E),title:"Learn more about sponsored messages",children:"\u2139\ufe0f"}),E&&Se.jsx("div",{className:"chat_info-tooltip",children:Se.jsxs("div",{className:"chat_info-content",children:[Se.jsx("h4",{children:"Sponsored Messages"}),Se.jsx("p",{children:"\u2022 Messages appear with special highlighting"}),Se.jsx("p",{children:"\u2022 Higher visibility in chat feed"}),Se.jsxs("p",{children:["\u2022 Costs ",N?.hasPixalPFP?"10,000":"25,000"," PXJ regardless of length"]}),Se.jsxs("p",{children:["\u2022 ",N?.hasPixalPFP?"Pixal PFP holders get 60% discount!":"Get a Pixal PFP for 60% discount!"]}),Se.jsx("p",{children:"\u2022 Perfect for announcements & promotions"})]})})]}),Se.jsxs("label",{className:"chat_checkbox-label",children:[Se.jsx("input",{type:"checkbox",checked:C,onChange:e=>A(e.target.checked)}),"Auto-refresh"]})]}),Se.jsxs("div",{className:"chat_formatting-toolbar",children:[Se.jsx("button",{className:"chat_format-btn",onClick:()=>z("**","**"),title:"Bold",children:Se.jsx("strong",{children:"B"})}),Se.jsx("button",{className:"chat_format-btn",onClick:()=>z("*","*"),title:"Italic",children:Se.jsx("em",{children:"I"})}),Se.jsxs("div",{className:"chat_emoji-container",children:[Se.jsx("button",{className:"chat_format-btn",onClick:()=>$(!F),title:"Add emoji",children:"\ud83d\ude0a"}),F&&Se.jsx("div",{className:"chat_emoji-picker",children:Se.jsx("div",{className:"chat_emoji-grid",children:["\ud83d\ude0a","\ud83d\ude02","\u2764\ufe0f","\ud83d\udc4d","\ud83d\udc4e","\ud83d\udd25","\ud83d\udcaf","\ud83d\ude80","\ud83d\udc8e","\ud83c\udf89","\ud83d\ude0e","\ud83e\udd14","\ud83d\ude0d","\ud83e\udd73","\ud83d\udcaa","\ud83d\udc4f","\ud83d\ude4c","\u2728","\u2b50","\ud83c\udf1f"].map(e=>Se.jsx("button",{className:"chat_emoji-btn",onClick:()=>(e=>{const t=B.current;if(!t)return;const a=t.selectionStart,s=j.substring(0,a),n=j.substring(a);b(s+e+n),$(!1),setTimeout(()=>{t.focus();const s=a+e.length;t.setSelectionRange(s,s)},0)})(e),children:e},e))})})]})]}),Se.jsxs("div",{className:"chat_input-wrapper",children:[Se.jsx("textarea",{ref:B,className:"chat_input",placeholder:`Type your message... (${e||"global"} chat)`,value:j,onChange:e=>b(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),J())},maxLength:240,rows:r?3:2,disabled:h}),Se.jsx("button",{className:"chat_send-btn",onClick:J,disabled:!j.trim()||h,children:h?"\u23f3":"\ud83d\udce4"})]})]}):Se.jsx("div",{className:"chat_login-prompt",children:Se.jsx("p",{children:"Connect your wallet to join the chat!"})}),r&&Se.jsx("div",{className:"chat_settings",children:Se.jsxs("div",{className:"chat_setting-group",children:[Se.jsx("label",{children:"Auto-refresh interval:"}),Se.jsxs("select",{value:T,onChange:e=>P(Number(e.target.value)),className:"chat_select chat_select--small",children:[Se.jsx("option",{value:10,children:"10s"}),Se.jsx("option",{value:30,children:"30s"}),Se.jsx("option",{value:60,children:"1m"}),Se.jsx("option",{value:300,children:"5m"})]})]})})]})},ls=({isOpen:e,imageUrl:t,imageName:a,onClose:s})=>{if(!e)return null;const n=e=>{"Escape"===e.key&&s()};return D.useEffect(()=>(e&&(document.addEventListener("keydown",n),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",n),document.body.style.overflow="unset"}),[e]),Se.jsx("div",{className:"image-zoom-modal",onClick:s,children:Se.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsx("button",{className:"zoom-modal-close",onClick:s,children:"\xd7"}),Se.jsx("img",{src:t,alt:a,className:"zoom-modal-image"}),Se.jsx("div",{className:"zoom-modal-info",children:Se.jsx("h3",{children:a})})]})})},os=D.memo(()=>{const{collectionName:e}=X(),{settings:t}=at(),[a,s]=O.useState(null),[n,i]=O.useState([]),[r,l]=O.useState([]),[o,c]=O.useState(null),[d,u]=O.useState("24"),[h,m]=O.useState({}),[p,f]=O.useState(!1),[x,g]=O.useState("WAX"),[v,y]=O.useState(.05),[j,b]=O.useState([]),[N,w]=O.useState(1),[k,_]=O.useState(!1),[S,C]=O.useState(!0),[A,E]=O.useState([]),[I,F]=O.useState([]),[$,L]=O.useState(1),[M]=O.useState(10),[R,W]=O.useState(!1),[D,B]=O.useState([]),[z,H]=O.useState(null),[q,J]=O.useState(""),[V,G]=O.useState(!1),[K,Y]=O.useState(null),[Q,Z]=O.useState("sales"),[ee,te]=O.useState(""),[ae,se]=O.useState("name"),[ne,ie]=O.useState(!1),[re,le]=O.useState({url:"",name:""}),[oe,ce]=O.useState(!1),de=n.filter(e=>e.schema_name.toLowerCase().includes(ee.toLowerCase())).sort((e,t)=>{switch(ae){case"name":return e.schema_name.localeCompare(t.schema_name);case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();default:return 0}}),ue=r.filter(e=>{const t=e.immutable_data?.name&&String(e.immutable_data.name).toLowerCase().includes(ee.toLowerCase())||e.template_id.toLowerCase().includes(ee.toLowerCase()),a=!q||e.schema_name===q;return t&&a}).sort((e,t)=>{switch(ae){case"name":{const a=String(e.immutable_data?.name||`Template #${e.template_id}`),s=String(t.immutable_data?.name||`Template #${t.template_id}`);return a.localeCompare(s)}case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();case"supply":return parseInt(t.issued_supply)-parseInt(e.issued_supply);default:return 0}}),he=O.useCallback(async t=>{if(!e)return"0";try{const a=await fetch(`https://wax-api.hivebp.io/v3/volume/${t}/${e}`);if(!a.ok)throw new Error("Failed to fetch volume data");const s=await a.json();return s.volume?String(s.volume):"0"}catch(a){return console.warn(`Failed to fetch ${t}d volume data:`,a),"0"}},[e]),me=O.useCallback(async()=>{if(!e)return null;try{const t=await fetch(`https://wax-api.hivebp.io/v3/collection-stats/${e}`);if(!t.ok)throw new Error("Failed to fetch collection stats");const a=await t.json();return{numUsers:a.numUsers||0,usdMarketCap:a.usdMarketCap||0,waxMarketCap:a.waxMarketCap||0,numAssets:a.numAssets||0}}catch(t){return console.warn("Failed to fetch collection stats:",t),null}},[e]),pe=O.useCallback(async()=>{if(!e)return;f(!0);const t=["24","7","30","90","365"],a=t.indexOf(d),s=t[(a+1)%t.length];if(h[s])return u(s),void f(!1);const n=await he(s);m(e=>({...e,[s]:n})),u(s),f(!1)},[e,d,h,he]),fe=O.useCallback(async()=>{if(e){G(!0),Y(null);try{const[t,a,n]=await Promise.all([dt.getCollectionDetails(e),dt.getCollectionSchemas(e),dt.getCollectionTemplates(e)]);s(t),i(a),l(n),Promise.all([dt.getCollectionAnalytics(e),dt.getEnhancedCollectionStats(e),dt.getCollectionVolumeGraph(e,30),dt.getSimilarCollections(e),dt.getCollectionHolders(e,500),dt.getCollectionTopSales(e,50),he("24"),me(),dt.getCollectionMarketStats({collection_name:e,symbol:"WAX"})]).then(([e,t,,a,s,n,i,r,l])=>{m(e=>({...e,24:i}));const o=l.success&&l.data?{sales:l.data.sales||"0",volume:l.data.volume?String(parseFloat(l.data.volume)/Math.pow(10,8)):"0",suggested_median:l.data.suggested_median?String(parseFloat(l.data.suggested_median)/Math.pow(10,8)):"0",suggested_average:l.data.suggested_average?String(parseFloat(l.data.suggested_average)/Math.pow(10,8)):"0"}:null;H(o);const d={volume:o?.volume||e?.volume||"0",sales:o?.sales||e?.sales||"0",floor_price:t.floorPrice&&!isNaN(t.floorPrice)?String(t.floorPrice):e?.floor_price&&!isNaN(parseFloat(e.floor_price))?e.floor_price:e?.floor&&!isNaN(parseFloat(e.floor))?e.floor:o?.suggested_median&&!isNaN(parseFloat(o.suggested_median))?o.suggested_median:n&&n.length>0?(()=>{const e=n.slice(-5).map(e=>{const t="string"==typeof e.price?e.price:e.price?.amount||"0";return parseFloat(t||"0")}).filter(e=>!isNaN(e)&&e>0);return e.length>0?String(Math.min(...e).toFixed(2)):"0"})():"0",market_cap:r?.waxMarketCap?String(r.waxMarketCap):t.marketCap?String(t.marketCap):e?.market_cap||"0",holders:r?.numUsers||e?.holders||0,assets:r?.numAssets?String(r.numAssets):e?.assets||"0",volume_24h:i||(t.volume24h?String(t.volume24h):e?.volume_24h||e?.volume||"0")};c(d),B(a),b(s),E(n||[])}).catch(t=>{De.error("Enhanced analytics failed to load","CollectionDetail.loadCollectionData",t,{collectionName:e})})}catch(t){De.error("Failed to load collection data","CollectionDetail.loadCollectionData",t,{collectionName:e}),Y(`Failed to load collection "${e}". This collection may not exist or be temporarily unavailable.`)}finally{G(!1)}}},[e]),xe=O.useCallback(async t=>{if(e)try{const a=await dt.getCollectionTemplates(e,t);l(a)}catch(a){De.error("Failed to load collection templates","CollectionDetail.loadTemplates",a,{collectionName:e,schemaName:t})}},[e]);O.useEffect(()=>{e&&fe()},[e,fe]),O.useEffect(()=>{q&&e&&xe(q)},[q,e,xe]);O.useEffect(()=>{const e=$*M,t=A.slice(0,e);F(t),W(e<A.length)},[A,$,M]);const ge=e=>{if(e)return e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`},ve=e=>{if(!e)return"N/A";try{let t;if(e.includes("T"))t=new Date(e);else{const a=parseInt(e);if(a>946684800&&a<4102444800)t=new Date(1e3*a);else{if(!(a>9466848e5&&a<41024448e5))return"N/A";t=new Date(a)}}return isNaN(t.getTime())?"N/A":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}},ye=(e,a="template-image")=>{const s=(e=>{if(e.immutable_data?.video){const t=e.immutable_data.video;if("string"==typeof t)return t.startsWith("Qm")?`${qe.IPFS.GATEWAYS[0]}${t}`:t}return null})(e),n=(e=>{if(e.immutable_data?.img){const t=e.immutable_data.img;if("string"==typeof t)return t.startsWith("Qm")?`https://ipfs.io/ipfs/${t}`:t}return"https://pixeljourney.xyz/img/toppixals/10.webp"})(e);return Se.jsx(Qt,{imageUrl:n,videoUrl:s,alt:String(e.immutable_data?.name||"NFT"),className:a,enableAnimations:t.enableAnimatedNFTs})};return V?Se.jsx("div",{className:"collection-detail-container",children:Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading collection details..."})]})}):K?Se.jsx("div",{className:"collection-detail-container",children:Se.jsxs("div",{className:"error-state",children:[Se.jsx("h2",{children:"Collection Error"}),Se.jsx("p",{children:K}),Se.jsx(U,{to:"/collections",className:"back-link",children:"\u2190 Back to Collections"})]})}):a?Se.jsxs("div",{className:"collection-profile-page",children:[Se.jsxs("div",{className:"collection-hero",children:[Se.jsxs("div",{className:"hero-background",children:[Se.jsx("img",{src:ge(a.img||""),alt:a.name||a.collection_name,className:"hero-bg-image"}),Se.jsx("div",{className:"hero-overlay"})]}),Se.jsxs("div",{className:"hero-content",children:[Se.jsxs("div",{className:"breadcrumb",children:[Se.jsx(U,{to:"/",className:"breadcrumb-link",children:"Home"}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx(U,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx("span",{className:"breadcrumb-current",children:a.name||a.collection_name})]}),Se.jsxs("div",{className:"collection-profile",children:[Se.jsx("div",{className:"collection-logo-container",children:Se.jsx("img",{src:ge(a.img||""),alt:a.name||a.collection_name,className:"collection-logo"})}),Se.jsxs("div",{className:"profile-info",children:[Se.jsx("div",{className:"title-section",children:Se.jsx("h1",{className:"collection-title",children:a.name||a.collection_name})}),Se.jsxs("div",{className:"collection-actions-row",style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px",marginBottom:"12px"},children:[(()=>{const e=T(a.collection_name);if(e){const t=P(e.tier);return Se.jsxs("div",{className:`collection-tier-badge ${t.className}`,children:[Se.jsx("span",{className:"tier-icon",children:t.icon}),Se.jsx("span",{className:"tier-label",children:t.label}),e.verified&&Se.jsx("span",{className:"verified-icon",children:"\u2713"})]})}return null})(),Se.jsxs("button",{className:"share-button",onClick:()=>ce(!0),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"8px 12px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.15)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)"},children:[Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:Se.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),"Share Collection"]})]}),Se.jsxs("p",{className:"collection-handle",children:["@",a.collection_name]}),Se.jsxs("p",{className:"collection-creator",children:["Created by ",a.author]}),a.data?.description&&Se.jsx("div",{className:"collection-description",children:Se.jsx(Va,{text:String(a.data.description||""),maxLength:100,className:"description-text"})})]})]})]})]}),Se.jsxs("div",{className:"stats-dashboard",children:[Se.jsxs("div",{className:"stats-grid",children:[Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:o?.assets||a.assets||0}),Se.jsx("div",{className:"stat-label",children:"Total Assets"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:n.length}),Se.jsx("div",{className:"stat-label",children:"Schemas"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:r.length}),Se.jsx("div",{className:"stat-label",children:"Templates"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:j.length}),Se.jsx("div",{className:"stat-label",children:"Holders"})]})]}),o&&Se.jsxs("div",{className:"stats-grid",children:[Se.jsxs("div",{className:"stat-card premium clickable",onClick:async()=>{if("WAX"===x){try{const e=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),t=await e.json();t.wax&&t.wax.usd&&y(t.wax.usd)}catch(e){console.warn("Could not fetch WAX price:",e)}g("USD")}else g("WAX")},style:{cursor:"pointer"},children:[Se.jsx("div",{className:"stat-value",children:o.market_cap&&"0"!==o.market_cap?"WAX"===x?`${parseFloat(o.market_cap).toLocaleString()} WAX`:`$${(parseFloat(o.market_cap)*v).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"}),Se.jsxs("div",{className:"stat-label",children:["Market Cap (",x,")"]})]}),Se.jsxs("div",{className:"stat-card premium",children:[Se.jsx("div",{className:"stat-value",children:z?.sales&&"0"!==z.sales?`${parseInt(z.sales).toLocaleString()}`:o?.sales&&"0"!==o.sales?`${parseInt(o.sales).toLocaleString()}`:"N/A"}),Se.jsx("div",{className:"stat-label",children:"All Time Sales"})]}),Se.jsxs("div",{className:"stat-card premium",children:[Se.jsx("div",{className:"stat-value",children:z?.volume&&"0"!==z.volume?`${parseFloat(z.volume).toLocaleString()} WAX`:o?.volume&&"0"!==o.volume?`${parseFloat(o.volume).toLocaleString()} WAX`:"N/A"}),Se.jsx("div",{className:"stat-label",children:"All Time Volume"})]}),Se.jsxs("div",{className:"stat-card premium clickable",onClick:pe,style:{cursor:"pointer"},children:[Se.jsx("div",{className:"stat-value",children:p?Se.jsx("span",{style:{opacity:.6},children:"Loading..."}):h[d]&&"0"!==h[d]?`${parseFloat(h[d]).toLocaleString()} WAX`:o?.volume_24h&&"0"!==o.volume_24h?`${parseFloat(o.volume_24h).toLocaleString()} WAX`:"N/A"}),Se.jsxs("div",{className:"stat-label",children:["24"===d?"24H":"7"===d?"7D":"30"===d?"30D":"90"===d?"90D":"365D"," Volume",Se.jsx("span",{style:{fontSize:"0.8em",opacity:.7,marginLeft:"4px"},children:"\u21bb"})]})]}),Se.jsxs("div",{className:"stat-card premium",children:[Se.jsx("div",{className:"stat-value",children:o.floor_price&&"0"!==o.floor_price&&!isNaN(parseFloat(o.floor_price))&&parseFloat(o.floor_price)>0?`${parseFloat(o.floor_price).toFixed(2)} WAX`:z?.suggested_median&&"0"!==z.suggested_median&&!isNaN(parseFloat(z.suggested_median))?`${parseFloat(z.suggested_median).toFixed(2)} WAX`:A&&A.length>0?(()=>{const e=A.slice(-3).map(e=>{const t="string"==typeof e.price?e.price:e.price?.amount||"0";return parseFloat(t||"0")}).filter(e=>!isNaN(e)&&e>0);return e.length>0?`~${Math.min(...e).toFixed(2)} WAX`:"N/A"})():"N/A"}),Se.jsx("div",{className:"stat-label",children:"Floor Price"})]})]})]}),Se.jsx(is,{collectionName:a.collection_name}),Se.jsx("div",{className:"collection-content-navigation",children:Se.jsxs("div",{className:"collection-nav-container",children:[Se.jsxs("div",{className:"collection-nav-tabs",children:[Se.jsx("button",{className:"collection-nav-tab "+("sales"===Q?"active":""),onClick:()=>Z("sales"),children:Se.jsxs("div",{className:"tab-content",children:[Se.jsx("span",{className:"tab-icon",children:"\ud83d\udcb0"}),Se.jsx("span",{className:"tab-text",children:"Top Sales"}),Se.jsx("span",{className:"tab-count",children:I.length})]})}),Se.jsx("button",{className:"collection-nav-tab "+("holders"===Q?"active":""),onClick:()=>Z("holders"),children:Se.jsxs("div",{className:"tab-content",children:[Se.jsx("span",{className:"tab-icon",children:"\ud83d\udc65"}),Se.jsx("span",{className:"tab-text",children:"Holders"}),Se.jsx("span",{className:"tab-count",children:j.length})]})}),Se.jsx("button",{className:"collection-nav-tab "+("schemas"===Q?"active":""),onClick:()=>Z("schemas"),children:Se.jsxs("div",{className:"tab-content",children:[Se.jsx("span",{className:"tab-icon",children:"\ud83d\udccb"}),Se.jsx("span",{className:"tab-text",children:"Schemas"}),Se.jsx("span",{className:"tab-count",children:de.length})]})}),Se.jsx("button",{className:"collection-nav-tab "+("templates"===Q?"active":""),onClick:()=>Z("templates"),children:Se.jsxs("div",{className:"tab-content",children:[Se.jsx("span",{className:"tab-icon",children:"\ud83c\udfa8"}),Se.jsx("span",{className:"tab-text",children:"Templates"}),Se.jsx("span",{className:"tab-count",children:ue.length})]})}),Se.jsx("button",{className:"collection-nav-tab "+("similar"===Q?"active":""),onClick:()=>Z("similar"),children:Se.jsxs("div",{className:"tab-content",children:[Se.jsx("span",{className:"tab-icon",children:"\ud83d\udd17"}),Se.jsx("span",{className:"tab-text",children:"Similar"}),Se.jsx("span",{className:"tab-count",children:D.length})]})}),Se.jsx("button",{className:"collection-nav-tab "+("chat"===Q?"active":""),onClick:()=>Z("chat"),children:Se.jsxs("div",{className:"tab-content",children:[Se.jsx("span",{className:"tab-icon",children:"\ud83d\udcac"}),Se.jsx("span",{className:"tab-text",children:"Chat"}),Se.jsx("span",{className:"tab-count",children:"0"})]})})]}),Se.jsx("div",{className:"nav-indicator"})]})}),Se.jsxs("div",{className:"tab-content-area",children:["sales"===Q&&Se.jsxs("div",{className:"sales-section",children:[Se.jsx("div",{className:"sales-grid",children:I.length>0?I.map((e,a)=>Se.jsxs("div",{className:"sale-item",children:[Se.jsxs("div",{className:"sale-rank",children:["#",a+1]}),Se.jsxs("div",{className:"sale-media",children:[Se.jsx(Qt,{imageUrl:ma(e),videoUrl:pa(e),alt:String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"NFT"),className:"sale-image",controls:!0,muted:!0,loop:!0,enableAnimations:t.enableAnimatedNFTs}),Se.jsx("div",{className:"zoom-overlay",onClick:()=>{const t=ma(e),a=String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"NFT");t&&le({url:t,name:a}),ie(!0)},children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),Se.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]}),Se.jsxs("div",{className:"sale-details",children:[Se.jsx("div",{className:"sale-name",children:e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"Unnamed NFT"}),Se.jsxs("div",{className:"sale-template",children:["Template #",e.assets?.[0]?.template?.template_id]}),Se.jsx("div",{className:"sale-price",children:e.price?(parseInt(e.price.amount)/Math.pow(10,e.price.token_precision)).toFixed(e.price.token_precision)+" "+e.price.token_symbol:"N/A"}),Se.jsx("div",{className:"sale-date",children:ve(e.updated_at_time||"")})]})]},e.sale_id||a)):Se.jsx("div",{className:"no-data",children:"No sales data available"})}),R&&Se.jsx("div",{className:"load-more-section",children:Se.jsx("button",{className:"load-more-btn",onClick:()=>{R&&L(e=>e+1)},children:"Load More Sales"})})]}),"holders"===Q&&Se.jsxs("div",{className:"holders-section",children:[Se.jsx("div",{className:"holders-grid",children:j.length>0?j.map((e,t)=>Se.jsxs("div",{className:"holder-item",children:[Se.jsxs("div",{className:"holder-rank",children:["#",t+1]}),Se.jsx(U,{to:`/profile-lookup/${e.account}`,className:"holder-account clickable",children:e.account}),Se.jsxs("div",{className:"holder-count",children:[e.assets," assets"]})]},t)):Se.jsx("div",{className:"no-data",children:"No holders data available"})}),S&&Se.jsx("div",{className:"load-more-section",children:Se.jsx("button",{className:"load-more-btn",onClick:async()=>{if(e&&!k&&S){_(!0);try{const t=N+1,a=500*(t-1),s=await dt.getCollectionHolders(e,500,a);s&&s.length>0?(b(e=>[...e,...s]),w(t),C(500===s.length)):C(!1)}catch(t){console.error("Error loading more holders:",t),C(!1)}finally{_(!1)}}},disabled:k,children:k?"Loading...":"Load More Holders"})})]}),"similar"===Q&&Se.jsx("div",{className:"similar-collections",children:Se.jsx("div",{className:"similar-collections-grid",children:D.length>0?D.slice(0,12).map((e,t)=>Se.jsx("div",{className:"similar-collection-item",children:Se.jsxs(U,{to:`/collections/${e.collection_name}`,children:[Se.jsx("div",{className:"similar-collection-name",children:e.collection_name}),Se.jsx("div",{className:"similar-collection-volume",children:"Similar Collection"})]})},t)):Se.jsx("div",{className:"no-data",children:"No similar collections found"})})}),"chat"===Q&&Se.jsx("div",{className:"chat-section",children:Se.jsx("div",{className:"chat-container",children:Se.jsx(rs,{collectionName:e})})}),Se.jsxs("div",{className:"search-filter-section",children:[Se.jsxs("div",{className:"search-controls",children:[Se.jsxs("div",{className:"search-input-container",children:[Se.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("input",{type:"text",placeholder:`Search ${Q}...`,value:ee,onChange:e=>te(e.target.value),className:"search-input"}),ee&&Se.jsx("button",{onClick:()=>te(""),className:"clear-search","aria-label":"Clear search",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),Se.jsxs("div",{className:"sort-container",children:[Se.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),Se.jsxs("select",{id:"sortBy",value:ae,onChange:e=>se(e.target.value),className:"sort-select",children:[Se.jsx("option",{value:"name",children:"Name"}),Se.jsx("option",{value:"created",children:"Created Date"}),"templates"===Q&&Se.jsx("option",{value:"supply",children:"Supply"})]})]})]}),ee&&Se.jsx("div",{className:"search-results-info",children:Se.jsxs("p",{children:["Found ","schemas"===Q?de.length:ue.length,' results for "',ee,'"']})}),"schemas"===Q&&Se.jsx("div",{className:"schemas-section",children:0===de.length?Se.jsx("div",{className:"empty-state",children:ee?Se.jsxs(Se.Fragment,{children:[Se.jsx("svg",{className:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("h3",{children:"No schemas found"}),Se.jsxs("p",{children:['No schemas match your search "',ee,'"']}),Se.jsx("button",{onClick:()=>te(""),className:"clear-search-button",children:"Clear Search"})]}):Se.jsx("p",{children:"No schemas found for this collection."})}):Se.jsx("div",{className:"schemas-grid",children:de.map(e=>Se.jsxs("div",{className:"schema-card",children:[Se.jsxs("div",{className:"schema-header",children:[Se.jsx("h3",{children:e.schema_name}),Se.jsx("button",{className:"view-templates-btn",onClick:()=>{J(e.schema_name),Z("templates")},children:"View Templates"})]}),Se.jsxs("div",{className:"schema-format",children:[Se.jsx("h4",{children:"Attributes:"}),Se.jsx("div",{className:"attributes-list",children:e.format.map((e,t)=>Se.jsxs("div",{className:"attribute",children:[Se.jsx("span",{className:"attr-name",children:e.name}),Se.jsx("span",{className:"attr-type",children:e.type})]},t))})]})]},e.schema_name))})}),"templates"===Q&&Se.jsxs("div",{className:"templates-section",children:[q&&Se.jsxs("div",{className:"schema-filter",children:[Se.jsx("label",{children:"Filter by Schema:"}),Se.jsxs("select",{value:q,onChange:e=>J(e.target.value),children:[Se.jsx("option",{value:"",children:"All Schemas"}),n.map(e=>Se.jsx("option",{value:e.schema_name,children:e.schema_name},e.schema_name))]})]}),0===ue.length?Se.jsx("div",{className:"empty-state",children:ee?Se.jsxs(Se.Fragment,{children:[Se.jsx("svg",{className:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("h3",{children:"No templates found"}),Se.jsxs("p",{children:['No templates match your search "',ee,'"']}),Se.jsx("button",{onClick:()=>te(""),className:"clear-search-button",children:"Clear Search"})]}):Se.jsxs("p",{children:["No templates found",q?` for schema "${q}"`:" for this collection","."]})}):Se.jsx("div",{className:"templates-grid",children:ue.map(t=>{return Se.jsxs(U,{to:`/collections/${e}/templates/${t.template_id}`,className:"template-card",children:[ye(t,"template-image"),Se.jsxs("div",{className:"template-info",children:[Se.jsx("h4",{children:String(t.immutable_data?.name||`Template #${t.template_id}`)}),Se.jsxs("p",{className:"template-schema",children:["Template ID: ",t.template_id]}),Se.jsxs("p",{className:"template-supply",children:["Supply: ",(a=t.issued_supply,s=t.max_supply,"0"===s?`${a} (Unlimited)`:`${a} / ${s}`)]})]})]},t.template_id);var a,s})})]})]})]}),ne&&Se.jsx(ls,{isOpen:ne,imageUrl:re.url,imageName:re.name,onClose:()=>ie(!1)}),oe&&Se.jsx(sa,{isOpen:oe,onClose:()=>ce(!1),title:a?.name||a?.collection_name||"Collection",description:String(a?.data?.description||`Check out this amazing collection: ${a?.name||a?.collection_name}`),imageUrl:ge(a?.img||""),shareUrl:`${window.location.origin}/collections/${a?.collection_name}`,defaultShareText:`Check out the ${a?.name||a?.collection_name} collection on PxMarket! \ud83c\udfae\u2728 Explore it at market.pixeljourney.xyz`,type:"collection"})]}):Se.jsx("div",{className:"collection-detail-container",children:Se.jsxs("div",{className:"error-state",children:[Se.jsx("h2",{children:"Collection Not Found"}),Se.jsxs("p",{children:['The collection "',e,'" could not be found.']}),Se.jsx(U,{to:"/collections",className:"back-link",children:"\u2190 Back to Collections"})]})})});os.displayName="CollectionDetail";const cs=()=>{const{collectionName:e,templateId:t}=X(),{settings:a}=at(),[s,n]=O.useState(null),[i,r]=O.useState(null),[l,o]=O.useState(null),[c,d]=O.useState([]),[u,h]=O.useState(!1),[m,p]=O.useState(!1),[f,x]=O.useState(1),[g,v]=O.useState(!0),[y,j]=O.useState(!1),b=O.useCallback(async()=>{if(e&&t){h(!0);try{const[a,s,i]=await Promise.all([dt.getCollectionTemplates(e),dt.getCollectionDetails(e),dt.getCollectionSchemas(e)]),l=a.find(e=>e.template_id===t);if(n(l||null),r(s),l){const a=await dt.getCollectionAssets(e,void 0,t,1);if(a.length>0){const e=a[0].schema_name,t=i.find(t=>t.schema_name===e);o(t||null)}}}catch(a){console.error("Error loading template data:",a)}finally{h(!1)}}},[e,t,h,n,r,o]),N=O.useCallback(async a=>{if(e&&t){p(!0);try{const s=await dt.getCollectionAssets(e,void 0,t,20);d(1===a?s:e=>[...e,...s]),v(20===s.length),x(a)}catch(s){console.error("Error loading assets:",s)}finally{p(!1)}}},[e,t,p,d,v,x]);O.useEffect(()=>{e&&t&&(b(),N(1))},[e,t,b,N]);const w=e=>new Date(1e3*parseInt(e)).toLocaleDateString(),k=e=>"object"==typeof e&&null!==e?JSON.stringify(e):String(e);return u?Se.jsx("div",{className:"template-detail-container",children:Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading template details..."})]})}):s?Se.jsxs("div",{className:"template-detail-container",children:[Se.jsxs("div",{className:"breadcrumb",children:[Se.jsx(U,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx(U,{to:`/collections/${e}`,className:"breadcrumb-link",children:i?.name||e}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx("span",{className:"breadcrumb-current",children:`Template #${t}`})]}),Se.jsxs("div",{className:"template-content",children:[Se.jsxs("div",{className:"template-header",children:[Se.jsx("div",{className:"template-image-container",children:s&&Se.jsx(Qt,{imageUrl:ua(s),videoUrl:ha(s),alt:"Template",className:"template-image",enableAnimations:a.enableAnimatedNFTs})}),Se.jsxs("div",{className:"template-info",children:[Se.jsx("h1",{children:`Template #${t}`}),Se.jsxs("p",{className:"template-id",children:["Template ID: ",s.template_id]}),Se.jsxs("p",{className:"template-schema",children:["Schema: ",l?.schema_name||"Loading..."]}),Se.jsxs("p",{className:"template-collection",children:["Collection: ",i?.name||i?.collection_name||"Loading..."]}),Se.jsxs("div",{className:"template-stats",children:[Se.jsxs("div",{className:"stat",children:[Se.jsx("span",{className:"stat-value",children:s.issued_supply}),Se.jsx("span",{className:"stat-label",children:"Minted"})]}),Se.jsxs("div",{className:"stat",children:[Se.jsx("span",{className:"stat-value",children:"0"===s.max_supply?"\u221e":s.max_supply}),Se.jsx("span",{className:"stat-label",children:"Max Supply"})]}),Se.jsxs("div",{className:"stat",children:[Se.jsx("span",{className:"stat-value",children:c.length}),Se.jsx("span",{className:"stat-label",children:"Assets Loaded"})]})]}),Se.jsxs("p",{className:"template-created",children:["Created: ",w(s.created_at_time)]}),Se.jsxs("button",{className:"share-btn",onClick:()=>j(!0),style:{marginTop:"20px",padding:"12px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"12px",color:"white",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},children:[Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share Template"]})]})]}),s.immutable_data&&Object.keys(s.immutable_data).length>0&&Se.jsxs("div",{className:"template-attributes",children:[Se.jsx("h2",{children:"Template Attributes"}),Se.jsx("div",{className:"attributes-grid",children:Object.entries(s.immutable_data).map(([e,t])=>Se.jsxs("div",{className:"attribute-item",children:[Se.jsx("span",{className:"attribute-name",children:e}),Se.jsx("span",{className:"attribute-value",children:k(t)})]},e))})]}),l&&l.format&&Se.jsxs("div",{className:"schema-format",children:[Se.jsx("h2",{children:"Schema Format"}),Se.jsx("div",{className:"format-grid",children:l.format.map((e,t)=>Se.jsxs("div",{className:"format-item",children:[Se.jsx("span",{className:"format-name",children:String(e.name)}),Se.jsx("span",{className:"format-type",children:String(e.type)})]},t))})]}),Se.jsxs("div",{className:"assets-section",children:[Se.jsxs("h2",{children:["Assets (",s.issued_supply," total)"]}),0!==c.length||m?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"assets-grid",children:c.map(e=>Se.jsxs(U,{to:`/assets/${e.asset_id}`,className:"asset-card",children:[Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name||`Asset #${e.asset_id}`,className:"asset-image",enableAnimations:a.enableAnimatedNFTs}),Se.jsxs("div",{className:"asset-info",children:[Se.jsx("h4",{children:e.name||`Asset #${e.asset_id}`}),Se.jsxs("p",{className:"asset-id",children:["#",e.asset_id]}),Se.jsxs("p",{className:"asset-owner",children:["Owner: ",e.owner]}),Se.jsxs("p",{className:"asset-minted",children:["Minted: ",w(e.minted_at_time)]})]})]},e.asset_id))}),g&&Se.jsx("div",{className:"load-more-container",children:Se.jsx("button",{className:"load-more-btn",onClick:()=>{!m&&g&&N(f+1)},disabled:m,children:m?"Loading...":"Load More Assets"})})]}):Se.jsx("div",{className:"empty-state",children:Se.jsx("p",{children:"No assets found for this template."})})]})]}),s&&Se.jsx(sa,{isOpen:y,onClose:()=>j(!1),title:`Template #${t}`,description:`${i?.name||i?.collection_name} collection`,imageUrl:ua(s),shareUrl:`${window.location.origin}/collections/${e}/templates/${t}`,defaultShareText:`Check out this amazing template: Template #${t} from ${i?.name||i?.collection_name} collection! \ud83c\udfa8\u2728 View it at ${window.location.origin}/collections/${e}/templates/${t}`,type:"template"})]}):Se.jsx("div",{className:"template-detail-container",children:Se.jsxs("div",{className:"error-state",children:[Se.jsx("h2",{children:"Template Not Found"}),Se.jsxs("p",{children:['The template "',t,'" could not be found in collection "',e,'".']}),Se.jsx(U,{to:`/collections/${e}`,className:"back-link",children:"\u2190 Back to Collection"})]})})},ds=()=>{const{assetId:e}=X(),[t,a]=O.useState(null),[s,n]=O.useState(!1),[i,r]=O.useState(null),[l,o]=O.useState(!1),[c,d]=O.useState(""),{isConnected:u,purchaseNFT:h,login:m}=Fe(),{showSuccess:p,showError:f,showWarning:x}=xt(),g=O.useCallback(async()=>{if(e){n(!0);try{const t=await dt.getAssetDetails(e);a(t)}catch(t){De.error("Failed to load asset data","AssetDetail.loadAssetData",t,{assetId:e})}finally{n(!1)}}},[e]),v=O.useCallback(async()=>{if(e){o(!0);try{const s=await dt.getMarketplaceNFTs({page:1,limit:1,asset_id:e});if(s.data&&s.data.length>0){const n=s.data[0],i={sale_id:n.sale_id,asset_id:n.asset_id,name:t?.name||`Asset #${n.asset_id}`,image:String(t?.data?.img||t?.template?.immutable_data?.img||""),price:n.price,seller:n.seller,collection:t?.collection?.collection_name||"Unknown",schema:t?.schema?.schema_name||"Unknown",template_mint:void 0,max_supply:t?.template?.max_supply||void 0,traits:t?.data?Object.fromEntries(Object.entries(t.data).filter(([,e])=>null!=e)):{}};if(r(i),i.price)try{const e=parseFloat(i.price.replace(" WAX","")),t=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),a=await t.json(),s=(e*(a.wax?.usd||0)).toFixed(2);d(`$${s} USD`)}catch(a){De.warn("Failed to fetch USD price for asset","AssetDetail.checkListingStatus",{assetId:e,error:a.message})}}else r(null),d("")}catch(a){De.error("Failed to check listing status","AssetDetail.checkListingStatus",a,{assetId:e}),r(null)}finally{o(!1)}}},[e]);O.useEffect(()=>{e&&(g(),v())},[e,g,v]);const y=e=>{return e?e.startsWith("http")?e:(t=e)?t.startsWith("http")?t:oa(t):"":"https://pixeljourney.xyz/img/toppixals/10.webp";var t},j=()=>t?ca(t)??"https://pixeljourney.xyz/img/toppixals/10.webp":"https://pixeljourney.xyz/img/toppixals/10.webp",b=e=>new Date(1e3*parseInt(e)).toLocaleString(),N=e=>{if(null==e)return Se.jsx("span",{className:"null-value",children:"null"});if("boolean"==typeof e)return Se.jsx("span",{className:"boolean-value",children:e.toString()});if("number"==typeof e)return Se.jsx("span",{className:"number-value",children:e.toLocaleString()});if("object"==typeof e)return Se.jsx("pre",{className:"object-value",children:JSON.stringify(e,null,2)});const t=String(e);return t.match(/\.(jpg|jpeg|png|gif|webp)$/i)||t.startsWith("Qm")?Se.jsxs("div",{className:"image-attribute",children:[Se.jsx("img",{src:y(t),alt:"Attribute image",className:"attribute-image",onError:e=>{e.currentTarget.style.display="none"}}),Se.jsx("span",{className:"image-hash",children:t})]}):Se.jsx("span",{className:"string-value",children:t})};if(s)return Se.jsx("div",{className:"asset-detail-container",children:Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading asset details..."})]})});if(!t)return Se.jsx("div",{className:"asset-detail-container",children:Se.jsxs("div",{className:"error-state",children:[Se.jsx("h2",{children:"Asset Not Found"}),Se.jsxs("p",{children:['The asset "',e,'" could not be found.']}),Se.jsx(U,{to:"/collections",className:"back-link",children:"\u2190 Back to Collections"})]})});const w=t?da(t):null,k=t?{...t.template?.immutable_data,...t.data}:{};return Se.jsx("div",{className:"asset-detail-container",children:Se.jsxs("div",{className:"asset-content",children:[Se.jsxs("div",{className:"breadcrumb",children:[Se.jsx(U,{to:"/",className:"breadcrumb-link",children:"Home"}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx(U,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx(U,{to:`/collections/${t.collection.collection_name}`,className:"breadcrumb-link",children:t.collection.name||t.collection.collection_name}),Se.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),Se.jsx("span",{className:"breadcrumb-current",children:t.name||`Asset #${e}`})]}),Se.jsxs("div",{className:"asset-header",children:[Se.jsx("div",{className:"asset-media-container",children:w?Se.jsx("video",{src:w,className:"asset-video",controls:!0,poster:j(),children:"Your browser does not support the video tag."}):Se.jsx("img",{src:j(),alt:t.name||`Asset #${e}`,className:"asset-image",onError:()=>{}})}),Se.jsxs("div",{className:"asset-info",children:[Se.jsx("h1",{children:t.name||`Asset #${e}`}),Se.jsxs("p",{className:"asset-id",children:["Asset ID: ",t.asset_id]}),Se.jsxs("div",{className:"asset-links",children:[Se.jsxs("p",{className:"asset-collection",children:["Collection:",Se.jsx(U,{to:`/collections/${t.collection.collection_name}`,children:t.collection.name||t.collection.collection_name})]}),Se.jsxs("p",{className:"asset-template",children:["Template:",Se.jsx(U,{to:`/collections/${t.collection.collection_name}/templates/${t.template.template_id}`,children:t.template?.immutable_data?.name||`#${t.template.template_id}`})]}),Se.jsxs("p",{className:"asset-schema",children:["Schema: ",t.schema.schema_name]})]}),Se.jsxs("div",{className:"asset-ownership",children:[Se.jsxs("div",{className:"owner-info",children:[Se.jsx("span",{className:"owner-label",children:"Owner:"}),Se.jsx("span",{className:"owner-address",children:t.owner})]}),Se.jsxs("div",{className:"author-info",children:[Se.jsx("span",{className:"author-label",children:"Collection Author:"}),Se.jsx("span",{className:"author-address",children:t.owner||"Unknown"})]})]}),l?Se.jsx("div",{className:"listing-status loading",children:Se.jsx("span",{children:"Checking listing status..."})}):i?Se.jsxs("div",{className:"listing-status available",children:[Se.jsxs("div",{className:"listing-info",children:[Se.jsx("h3",{children:"Available for Sale"}),Se.jsxs("div",{className:"price-display",children:[Se.jsx("span",{className:"price-wax",children:i.price}),c&&Se.jsx("span",{className:"price-usd",children:c})]})]}),Se.jsx("button",{className:"buy-now-btn",onClick:async()=>{if(i)try{if(!u){x("Please connect your wallet to purchase this NFT");try{await m()}catch(t){return void De.error("Wallet login failed during purchase","AssetDetail.handlePurchase",t,{assetId:e,saleId:i.sale_id})}}if(!i.sale_id||!i.price)return void f("This NFT is not available for purchase");const a=i.price.replace(" WAX","");De.info("Initiating NFT purchase","AssetDetail.handlePurchase",{saleId:i.sale_id,price:a,assetId:e}),await h(i.sale_id,a),p(`Successfully purchased ${i.name||"NFT"}!`),v()}catch(t){De.error("NFT purchase failed","AssetDetail.handlePurchase",t,{assetId:e,saleId:i?.sale_id,price:i?.price});const a=t instanceof Error?t.message:"Unknown error occurred";f(`Purchase failed: ${a}`)}},disabled:!u,children:u?"Buy Now":"Connect Wallet to Buy"})]}):Se.jsx("div",{className:"listing-status not-listed",children:Se.jsx("span",{children:"Not currently listed for sale"})}),Se.jsxs("div",{className:"asset-timestamps",children:[Se.jsxs("div",{className:"timestamp",children:[Se.jsx("span",{className:"timestamp-label",children:"Minted:"}),Se.jsx("span",{className:"timestamp-value",children:b(t.minted_at_time)})]}),Se.jsxs("div",{className:"timestamp",children:[Se.jsx("span",{className:"timestamp-label",children:"Last Transfer:"}),Se.jsx("span",{className:"timestamp-value",children:b(t.transferred_at_time)})]}),Se.jsxs("div",{className:"timestamp",children:[Se.jsx("span",{className:"timestamp-label",children:"Last Update:"}),Se.jsx("span",{className:"timestamp-value",children:b(t.updated_at_time)})]})]}),t.burned_by_account&&Se.jsxs("div",{className:"burn-info",children:[Se.jsx("span",{className:"burn-label",children:"\ud83d\udd25 Burned by:"}),Se.jsx("span",{className:"burn-account",children:t.burned_by_account}),Se.jsx("span",{className:"burn-time",children:b(t.burned_at_time)})]})]})]}),Se.jsxs("div",{className:"template-info-section",children:[Se.jsx("h2",{children:"Template Information"}),Se.jsxs("div",{className:"template-stats",children:[Se.jsxs("div",{className:"template-stat",children:[Se.jsx("span",{className:"stat-label",children:"Template ID:"}),Se.jsx("span",{className:"stat-value",children:t.template.template_id})]}),Se.jsxs("div",{className:"template-stat",children:[Se.jsx("span",{className:"stat-label",children:"Max Supply:"}),Se.jsx("span",{className:"stat-value",children:"0"===t.template.max_supply?"Unlimited":t.template.max_supply})]}),Se.jsxs("div",{className:"template-stat",children:[Se.jsx("span",{className:"stat-label",children:"Issued Supply:"}),Se.jsx("span",{className:"stat-value",children:t.template.issued_supply})]})]})]}),Object.keys(k).length>0&&Se.jsxs("div",{className:"asset-attributes",children:[Se.jsx("h2",{children:"Attributes"}),Se.jsx("div",{className:"attributes-grid",children:Object.entries(k).map(([e,t])=>Se.jsxs("div",{className:"attribute-item",children:[Se.jsx("span",{className:"attribute-name",children:e}),Se.jsx("div",{className:"attribute-value",children:N(t)})]},e))})]}),Se.jsxs("div",{className:"schema-format",children:[Se.jsx("h2",{children:"Schema Format"}),Se.jsx("div",{className:"format-grid",children:t.schema.format?.map((e,t)=>Se.jsxs("div",{className:"format-item",children:[Se.jsx("span",{className:"format-name",children:e.name}),Se.jsx("span",{className:"format-type",children:e.type})]},t))})]}),t.backed_tokens&&t.backed_tokens.length>0&&Se.jsxs("div",{className:"backed-tokens",children:[Se.jsx("h2",{children:"Backed Tokens"}),Se.jsx("div",{className:"tokens-list",children:t.backed_tokens.map((e,t)=>Se.jsx("div",{className:"token-item",children:Se.jsx("pre",{children:JSON.stringify(e,null,2)})},t))})]})]})})},us=()=>{const{saleId:e}=X(),t=B(),[a,s]=O.useState(null),[n,i]=O.useState(!0),[r,l]=O.useState(null),[o,c]=O.useState(""),[d,u]=O.useState(!1),[h,m]=O.useState(!1),[p,f]=O.useState(!1),[x,g]=O.useState(!1),[v,y]=O.useState(0);O.useEffect(()=>{e&&j()},[e]);const j=async()=>{if(e)try{i(!0),l(null);const t=`${dt.atomicMarketAPI}/atomicmarket/v1/sales/${e}`,a=await dt.fetchWithRetry(t),n=await a.json();if(n.success&&n.data){const e=n.data;y(e.state);const t={sale_id:e.sale_id,asset_id:e.assets[0]?.asset_id||"",name:e.assets[0]?.name||`${e.assets[0]?.collection?.collection_name||"Unknown"} #${e.assets[0]?.asset_id}`,image:b(e.assets[0]),price:`${(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision)).toFixed(4)} ${e.price.token_symbol}`,seller:e.seller,collection:e.assets[0]?.collection?.collection_name||"Unknown",schema:e.assets[0]?.schema?.schema_name||"Unknown",template_mint:parseInt(e.assets[0]?.template?.template_id||"0")||0,max_supply:e.assets[0]?.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(e.assets[0]?.data||{}).map(([e,t])=>[e,null==t?"":"string"==typeof t||"number"==typeof t||"boolean"==typeof t?t:String(t)]))};s(t);const a=parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision),i=await dt.getUSDPrice(a);c(i)}else l("Listing not found")}catch(t){console.error("Error loading listing:",t),l(`Failed to load listing data: ${t instanceof Error?t.message:"Unknown error"}`)}finally{i(!1)}},b=e=>e?e.data?.img?e.data.img.startsWith("http")?e.data.img:`https://ipfs.io/ipfs/${e.data.img}`:e.data?.image?e.data.image.startsWith("http")?e.data.image:`https://ipfs.io/ipfs/${e.data.image}`:e.template?.immutable_data?.img?e.template.immutable_data.img.startsWith("http")?e.template.immutable_data.img:`https://ipfs.io/ipfs/${e.template.immutable_data.img}`:e.template?.immutable_data?.image?e.template.immutable_data.image.startsWith("http")?e.template.immutable_data.image:`https://ipfs.io/ipfs/${e.template.immutable_data.image}`:"https://pixeljourney.xyz/img/toppixals/10.webp":"",{isConnected:N,purchaseNFT:k,login:_}=Fe(),{showSuccess:S,showError:C,showWarning:A}=xt();return n?Se.jsx("div",{className:"listing-detail-container",children:Se.jsxs("div",{className:"loading-container",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading listing..."})]})}):r||!a?Se.jsx("div",{className:"listing-detail-container",children:Se.jsxs("div",{className:"error-container",children:[Se.jsx("h2",{children:"Listing Not Found"}),Se.jsx("p",{children:r||"The requested listing could not be found."}),Se.jsx("button",{onClick:()=>t("/marketplace"),className:"btn-primary",children:"Back to Marketplace"})]})}):Se.jsxs("div",{className:"listing-detail-container",children:[Se.jsxs("div",{className:"listing-detail-header",children:[Se.jsx("button",{onClick:()=>t(-1),className:"back-button",children:"\u2190 Back"}),Se.jsx("h1",{children:"Listing Details"})]}),Se.jsxs("div",{className:"listing-detail-content",children:[Se.jsx("div",{className:"listing-image-section",children:Se.jsx("div",{className:"listing-image",children:a.image.includes(".mp4")||a.image.includes(".webm")?Se.jsx("video",{src:a.image,controls:!0,muted:!0,loop:!0,className:"listing-media"}):Se.jsxs(Se.Fragment,{children:[Se.jsx("img",{src:a.image,alt:a.name,className:"listing-media",onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),Se.jsx("div",{className:"zoom-overlay",onClick:()=>g(!0),children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),Se.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]})})}),Se.jsxs("div",{className:"listing-info-section",children:[Se.jsxs("div",{className:"listing-header",children:[Se.jsx("h2",{children:a.name}),Se.jsxs("div",{className:"listing-actions",children:[Se.jsx("button",{onClick:()=>u(!0),className:"listing-detail-nav-btn",children:"\ud83d\udccb View Details"}),Se.jsxs("button",{onClick:()=>m(!0),className:"listing-detail-nav-btn",children:[Se.jsx("svg",{viewBox:"0 -8 72 72",fill:"currentColor",style:{width:"16px",height:"16px",marginRight:"8px"},children:Se.jsx("path",{d:"M64,12.78v17s-3.63.71-4.38.81-3.08.85-4.78-.78C52.22,27.25,42.93,18,42.93,18a3.54,3.54,0,0,0-4.18-.21c-2.36,1.24-5.87,3.07-7.33,3.78a3.37,3.37,0,0,1-5.06-2.64,3.44,3.44,0,0,1,2.1-3c3.33-2,10.36-6,13.29-7.52,1.78-1,3.06-1,5.51,1C50.27,12,53,14.27,53,14.27a2.75,2.75,0,0,0,2.26.43C58.63,14,64,12.78,64,12.78ZM27,41.5a3,3,0,0,0-3.55-4.09,3.07,3.07,0,0,0-.64-3,3.13,3.13,0,0,0-3-.75,3.07,3.07,0,0,0-.65-3,3.38,3.38,0,0,0-4.72.13c-1.38,1.32-2.27,3.72-1,5.14s2.64.55,3.72.3c-.3,1.07-1.2,2.07-.09,3.47s2.64.55,3.72.3c-.3,1.07-1.16,2.16-.1,3.46s2.84.61,4,.25c-.45,1.15-1.41,2.39-.18,3.79s4.08.75,5.47-.58a3.32,3.32,0,0,0,.3-4.68A3.18,3.18,0,0,0,27,41.5Zm25.35-8.82L41.62,22a3.53,3.53,0,0,0-3.77-.68c-1.5.66-3.43,1.56-4.89,2.24a8.15,8.15,0,0,1-3.29,1.1,5.59,5.59,0,0,1-3-10.34C29,12.73,34.09,10,34.09,10a6.46,6.46,0,0,0-5-2C25.67,8,18.51,12.7,18.51,12.7a5.61,5.61,0,0,1-4.93.13L8,10.89v19.4s1.59.46,3,1a6.33,6.33,0,0,1,1.56-2.47,6.17,6.17,0,0,1,8.48-.06,5.4,5.4,0,0,1,1.34,2.37,5.49,5.49,0,0,1,2.29,1.4A5.4,5.4,0,0,1,26,34.94a5.47,5.47,0,0,1,3.71,4,5.38,5.38,0,0,1,2.39,1.43,5.65,5.65,0,0,1,1.48,4.89a0,0,0,0,1,0,0s.8.9,1.29,1.39a2.46,2.46,0,0,0,3.48-3.48s2,2.48,4.28,1c2-1.4,1.69-3.06.74-4a3.19,3.19,0,0,0,4.77.13,2.45,2.45,0,0,0,.13-3.3s1.33,1.81,4,.12c1.89-1.6,1-3.43,0-4.39Z"})}),"Make Offer"]}),Se.jsx("button",{onClick:()=>f(!0),className:"listing-detail-nav-btn",children:"\ud83d\udd17 Share"})]})]}),Se.jsxs("div",{className:"listing-price-section",children:[Se.jsxs("div",{className:"price-display",children:[Se.jsx("div",{className:"price-main",children:a.price}),Se.jsx("div",{className:"price-usd",children:o}),Se.jsx("div",{className:"sale-status-display",children:Se.jsx("span",{className:"status-badge "+(1===v?"status-active":3===v?"status-sold":"status-canceled"),children:1===v?"\ud83d\udd04 Available":3===v?"\u2705 Sold":"\u274c Canceled"})})]}),1===v?Se.jsx("button",{onClick:async()=>{if(a)try{if(!N){A("Please connect your wallet to purchase this NFT");try{await _()}catch(e){return void De.error("Login failed","ListingDetail",e)}}if(!a.sale_id||!a.price)return void C("This NFT is not available for purchase");const s=a.price.replace(" WAX","");De.info("Purchasing NFT","ListingDetail.handlePurchase",{saleId:a.sale_id,price:s}),await k(a.sale_id,s),S(`Successfully purchased ${a.name||"NFT"}!`),t("/marketplace")}catch(e){De.error("Purchase failed","ListingDetail",e);const t=e instanceof Error?e.message:"Unknown error occurred";C(`Purchase failed: ${t}`)}},className:"listing-detail-nav-btn listing-detail-primary-btn purchase-btn",children:"\ud83d\uded2 Buy Now"}):Se.jsx("button",{disabled:!0,className:"listing-detail-nav-btn listing-detail-primary-btn purchase-btn",children:3===v?"\u2705 Sold":"\u274c Not Available"})]}),Se.jsxs("div",{className:"listing-details",children:[Se.jsxs("div",{className:"detail-item",children:[Se.jsx("span",{className:"detail-label",children:"Collection:"}),Se.jsx("span",{className:"detail-value link",onClick:()=>{a&&t(`/collections/${a.collection}`)},children:a.collection})]}),Se.jsxs("div",{className:"detail-item",children:[Se.jsx("span",{className:"detail-label",children:"Schema:"}),Se.jsx("span",{className:"detail-value",children:a.schema})]}),Se.jsxs("div",{className:"detail-item",children:[Se.jsx("span",{className:"detail-label",children:"Asset ID:"}),Se.jsx("span",{className:"detail-value link",onClick:()=>{a&&a.asset_id&&t(`/assets/${a.asset_id}`)},children:a.asset_id})]}),Se.jsxs("div",{className:"detail-item",children:[Se.jsx("span",{className:"detail-label",children:"Seller:"}),Se.jsx("span",{className:"detail-value link",onClick:()=>{a&&a.seller&&t(`/user-profile-lookup?user=${encodeURIComponent(a.seller)}`)},children:a.seller})]}),Se.jsxs("div",{className:"detail-item",children:[Se.jsx("span",{className:"detail-label",children:"Sale ID:"}),Se.jsx("span",{className:"detail-value",children:a.sale_id})]}),a.template_mint&&a.template_mint>0&&Se.jsxs("div",{className:"detail-item",children:[Se.jsx("span",{className:"detail-label",children:"Mint:"}),Se.jsxs("span",{className:"detail-value",children:[a.template_mint," / ","0"===a.max_supply?"\u221e":a.max_supply]})]})]}),a.traits&&Object.keys(a.traits).length>0&&Se.jsxs("div",{className:"listing-attributes",children:[Se.jsx("h3",{children:"Attributes"}),Se.jsx("div",{className:"attributes-grid",children:Object.entries(a.traits).map(([e,t])=>Se.jsxs("div",{className:"attribute-item",children:[Se.jsx("span",{className:"attribute-name",children:e}),Se.jsx("span",{className:"attribute-value",children:t})]},e))})]})]})]}),Se.jsx(fa,{nft:a,isOpen:d,onClose:()=>u(!1)}),Se.jsx(w,{nft:a,isOpen:h,onClose:()=>m(!1)}),Se.jsx(ga,{nft:a,isOpen:p,onClose:()=>f(!1)}),Se.jsx(ls,{isOpen:x,onClose:()=>g(!1),imageUrl:a.image,imageName:a.name})]})},hs=()=>{const{transactionId:e}=X(),t=B(),[a,s]=O.useState(null),[n,i]=O.useState(null),[r,l]=O.useState(!0),[o,c]=O.useState(null),[d,u]=O.useState("overview");O.useEffect(()=>{e&&h(e)},[e]);const h=async e=>{try{l(!0),c(null);const t=await fetch("https://wax.eosrio.io/v1/history/get_transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok)throw new Error(`Failed to fetch transaction: ${t.status}`);const a=await t.json();if(!a.id)throw new Error("Transaction not found");const n={transaction_id:a.id,block_num:a.block_num,block_time:a.block_time,action_name:a.trx?.transaction?.actions?.[0]?.name||"unknown",actor:a.trx?.transaction?.actions?.[0]?.authorization?.[0]?.actor||"unknown",receiver:a.trx?.transaction?.actions?.[0]?.account||"unknown",status:"executed"===a.receipt?.status?"success":"failed",cpu_usage_us:a.receipt?.cpu_usage_us||0,net_usage_words:a.receipt?.max_net_usage_words||a.receipt?.net_usage_words||0,traces:a.traces||[]},r=a.trx?.transaction?.actions?.[0]?.data;r&&(r.asset_ids&&(n.asset_id=r.asset_ids[0]),r.from&&(n.from=r.from),r.to&&(n.to=r.to),r.memo&&(n.memo=r.memo),r.listing_price_to_assert&&(n.price=`${parseFloat(r.listing_price_to_assert.split(" ")[0])} WAX`)),s(n);const o=await fetch("https://wax.eosrio.io/v1/chain/get_block",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({block_num_or_id:a.block_num})});if(o.ok){const e=await o.json();i({block_num:e.block_num,block_id:e.id,timestamp:e.timestamp,producer:e.producer,transaction_count:e.transactions?.length||0})}}catch(t){De.error("Error fetching transaction details","TransactionDetails.fetchTransactionDetails",t),c(t instanceof Error?t.message:"Failed to load transaction details")}finally{l(!1)}},m=e=>{t(`/user-profile-lookup?user=${encodeURIComponent(e)}`)};return r?Se.jsx("div",{className:"page-content",children:Se.jsx("div",{className:"transaction-details-container",children:Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading transaction details..."})]})})}):o||!a?Se.jsx("div",{className:"page-content",children:Se.jsx("div",{className:"transaction-details-container",children:Se.jsxs("div",{className:"error-state",children:[Se.jsx("h2",{children:"Transaction Not Found"}),Se.jsx("p",{children:o||"The requested transaction could not be found."}),Se.jsx("button",{onClick:()=>t(-1),className:"btn btn-primary",children:"Go Back"})]})})}):Se.jsx("div",{className:"page-content",children:Se.jsxs("div",{className:"transaction-details-container",children:[Se.jsxs("div",{className:"transaction-header",children:[Se.jsx("button",{onClick:()=>t(-1),className:"back-button",children:"\u2190 Back"}),Se.jsxs("div",{className:"transaction-title",children:[Se.jsx("h1",{children:"Transaction Details"}),Se.jsxs("div",{className:"transaction-id",children:[Se.jsxs("span",{children:["ID: ",a.transaction_id]}),Se.jsx("button",{onClick:()=>{return e=a.transaction_id,void navigator.clipboard.writeText(e);var e},className:"copy-button",title:"Copy transaction ID",children:"\ud83d\udccb"})]})]}),Se.jsxs("div",{className:`transaction-status ${a.status}`,children:["success"===a.status?"\u2705":"\u274c"," ",a.status.toUpperCase()]})]}),Se.jsxs("div",{className:"tab-navigation",children:[Se.jsx("button",{className:"tab "+("overview"===d?"active":""),onClick:()=>u("overview"),children:"Overview"}),Se.jsx("button",{className:"tab "+("traces"===d?"active":""),onClick:()=>u("traces"),children:"Action Traces"}),Se.jsx("button",{className:"tab "+("raw"===d?"active":""),onClick:()=>u("raw"),children:"Raw Data"})]}),Se.jsxs("div",{className:"tab-content",children:["overview"===d&&Se.jsxs("div",{className:"overview-tab",children:[Se.jsxs("div",{className:"info-section",children:[Se.jsx("h3",{children:"Basic Information"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Block Number:"}),Se.jsx("span",{children:a.block_num.toLocaleString()})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Timestamp:"}),Se.jsx("span",{children:(p=a.block_time,new Date(p+"Z").toLocaleString())})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Action:"}),Se.jsx("span",{className:"action-name",children:a.action_name})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Contract:"}),Se.jsx("span",{className:"contract-name",children:a.receiver})]})]})]}),Se.jsxs("div",{className:"info-section",children:[Se.jsx("h3",{children:"Transaction Parties"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Actor:"}),Se.jsx("span",{className:"clickable-account",onClick:()=>m(a.actor),children:a.actor})]}),a.from&&a.from!==a.actor&&Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"From:"}),Se.jsx("span",{className:"clickable-account",onClick:()=>m(a.from),children:a.from})]}),a.to&&Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"To:"}),Se.jsx("span",{className:"clickable-account",onClick:()=>m(a.to),children:a.to})]})]})]}),(a.asset_id||a.price)&&Se.jsxs("div",{className:"info-section",children:[Se.jsx("h3",{children:"Asset Information"}),Se.jsxs("div",{className:"info-grid",children:[a.asset_id&&Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Asset ID:"}),Se.jsx("span",{className:"clickable-asset",onClick:()=>{return e=a.asset_id,void t(`/assets/${e}`);var e},children:a.asset_id})]}),a.asset_name&&Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Asset Name:"}),Se.jsx("span",{children:a.asset_name})]}),a.collection_name&&Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Collection:"}),Se.jsx("span",{children:"string"==typeof a.collection_name?a.collection_name:a.collection_name?.collection_name||a.collection_name?.name||"Unknown"})]}),a.price&&Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Price:"}),Se.jsx("span",{className:"price",children:a.price})]})]})]}),Se.jsxs("div",{className:"info-section",children:[Se.jsx("h3",{children:"Resource Usage"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"CPU Usage:"}),Se.jsxs("span",{children:[a.cpu_usage_us.toLocaleString()," \u03bcs"]})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"NET Usage:"}),Se.jsxs("span",{children:[a.net_usage_words.toLocaleString()," words"]})]})]})]}),n&&Se.jsxs("div",{className:"info-section",children:[Se.jsx("h3",{children:"Block Information"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Block ID:"}),Se.jsx("span",{className:"block-id",children:n.block_id})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Producer:"}),Se.jsx("span",{children:n.producer})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("label",{children:"Transactions in Block:"}),Se.jsx("span",{children:n.transaction_count})]})]})]}),a.memo&&Se.jsxs("div",{className:"info-section",children:[Se.jsx("h3",{children:"Memo"}),Se.jsx("div",{className:"memo-content",children:a.memo})]})]}),"traces"===d&&Se.jsxs("div",{className:"traces-tab",children:[Se.jsx("h3",{children:"Action Traces"}),a.traces&&a.traces.length>0?Se.jsx("div",{className:"traces-list",children:a.traces.map((e,t)=>Se.jsxs("div",{className:"trace-item",children:[Se.jsxs("div",{className:"trace-header",children:[Se.jsxs("span",{className:"trace-index",children:["#",t+1]}),Se.jsx("span",{className:"trace-action",children:e.act?.name||"unknown"}),Se.jsx("span",{className:"trace-account",children:e.act?.account||"unknown"})]}),Se.jsx("pre",{className:"trace-data",children:JSON.stringify(e,null,2)})]},t))}):Se.jsx("p",{children:"No action traces available for this transaction."})]}),"raw"===d&&Se.jsxs("div",{className:"raw-tab",children:[Se.jsx("h3",{children:"Raw Transaction Data"}),Se.jsx("pre",{className:"raw-data",children:JSON.stringify(a,null,2)})]})]})]})});var p},ms=({isOpen:e,onClose:t,resourceType:a,action:s,onSuccess:n})=>{const[i,r]=O.useState(""),[l,o]=O.useState(!1),{session:c,transact:d}=Fe(),{showError:u}=xt();if(!e)return null;const h=a.toUpperCase(),m="stake"===s?"Stake":"Unstake";return Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h2",{children:[m," ",h]}),Se.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"resource-info",children:[Se.jsx("div",{className:"resource-icon",children:"cpu"===a?"\u26a1":"\ud83c\udf10"}),Se.jsxs("div",{className:"resource-description",children:[Se.jsxs("h3",{children:[h," ",m]}),Se.jsx("p",{children:"stake"===s?`Stake WAX to increase your ${h} resources. Staked tokens will be locked for 3 days after unstaking.`:`Unstake WAX from your ${h} resources. Tokens will be available after a 3-day waiting period.`})]})]}),Se.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),c&&i&&!(parseFloat(i)<=0)){o(!0);try{const e=`${parseFloat(i).toFixed(8)} WAX`;if("stake"===s){const t=[{account:"eosio",name:"delegatebw",authorization:[{actor:c.actor.toString(),permission:c.permission.toString()}],data:{from:c.actor.toString(),receiver:c.actor.toString(),stake_net_quantity:"net"===a?e:"0.00000000 WAX",stake_cpu_quantity:"cpu"===a?e:"0.00000000 WAX",transfer:!1}}];await d(t)}else{const t=[{account:"eosio",name:"undelegatebw",authorization:[{actor:c.actor.toString(),permission:c.permission.toString()}],data:{from:c.actor.toString(),receiver:c.actor.toString(),unstake_net_quantity:"net"===a?e:"0.00000000 WAX",unstake_cpu_quantity:"cpu"===a?e:"0.00000000 WAX"}}];await d(t)}n?.(),t()}catch(r){De.error(`Failed to ${s} ${a.toUpperCase()}`,"StakingModal.handleSubmit",r,{action:s,resourceType:a,amount:i}),u(`Failed to ${s} ${a.toUpperCase()}. Please try again.`,"Transaction Failed")}finally{o(!1)}}},children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"amount",children:"Amount (WAX)"}),Se.jsx("input",{type:"number",id:"amount",value:i,onChange:e=>r(e.target.value),placeholder:"Enter WAX amount",min:"0.00000001",step:"0.00000001",required:!0,disabled:l})]}),Se.jsxs("div",{className:"form-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:l,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary",disabled:l||!i||parseFloat(i)<=0,children:l?"Processing...":`${m} ${h}`})]})]})]})]})})},ps=({isOpen:e,onClose:t,action:a,onSuccess:s})=>{const[n,i]=O.useState(""),[r,l]=O.useState(!1),[o,c]=O.useState(null),[d,u]=O.useState(null),[h,m]=O.useState(!1),{session:p,transact:f}=Fe(),{showSuccess:x,showError:g}=xt();O.useEffect(()=>{e&&p&&v()},[e,p]);const v=async()=>{if(p){m(!0);try{const e=await fetch("https://wax.greymass.com/v1/chain/get_table_rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"eosio",scope:"eosio",table:"rammarket",limit:1})});if(e.ok){const t=await e.json();if(t.rows&&t.rows.length>0){const e=t.rows[0],a=parseFloat(e.quote.balance.split(" ")[0]),s=parseFloat(e.base.balance.split(" ")[0]);c(a/s)}}const t=await fetch("https://wax.greymass.com/v1/chain/get_account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:p.actor.toString()})});if(t.ok){const e=await t.json();u(e.ram_quota-e.ram_usage)}}catch(e){De.error("Failed to fetch RAM market data","RAMModal.fetchRAMData",e,{account:p?.actor.toString()})}finally{m(!1)}}};if(!e)return null;const y="buy"===a?"Buy":"Sell",j="buy"===a?"Amount (WAX)":"Bytes to Sell",b="buy"===a?"Enter WAX amount":"Enter bytes amount";return Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h2",{children:[y," RAM"]}),Se.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"resource-info",children:[Se.jsx("div",{className:"resource-icon",children:"\ud83d\udcbe"}),Se.jsxs("div",{className:"resource-description",children:[Se.jsxs("h3",{children:["RAM ",y]}),Se.jsx("p",{children:"buy"===a?"Purchase RAM with WAX tokens. RAM is used to store account data and smart contract state.":"Sell RAM bytes back to the system for WAX tokens. Only sell RAM you don't need."}),Se.jsx("div",{className:"ram-market-info",children:h?Se.jsx("div",{className:"loading-info",children:Se.jsx("span",{children:"Loading RAM market data..."})}):Se.jsxs(Se.Fragment,{children:[null!==o&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Current RAM Price:"}),Se.jsxs("span",{className:"stat-value",children:[(1024*o).toFixed(8)," WAX/KB"]})]}),"sell"===a&&null!==d&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Available RAM:"}),Se.jsxs("span",{className:"stat-value",children:[d.toLocaleString()," bytes"]})]}),"buy"===a&&null!==o&&n&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Estimated RAM:"}),Se.jsxs("span",{className:"stat-value",children:[Math.floor(parseFloat(n)/o).toLocaleString()," bytes"]})]}),"sell"===a&&null!==o&&n&&Se.jsxs("div",{className:"market-stat",children:[Se.jsx("span",{className:"stat-label",children:"Estimated WAX:"}),Se.jsxs("span",{className:"stat-value",children:[(parseFloat(n)*o).toFixed(8)," WAX"]})]})]})})]})]}),Se.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p&&n&&!(parseFloat(n)<=0)){if("sell"===a&&null!==d){if(Math.floor(parseFloat(n))>d)return void g("Insufficient RAM",`You only have ${d.toLocaleString()} bytes available to sell.`)}l(!0);try{if("buy"===a){const e=`${parseFloat(n).toFixed(8)} WAX`,t=[{account:"eosio",name:"buyram",authorization:[{actor:Gt.safeGetActor(p),permission:Gt.safeGetPermission(p)}],data:{payer:Gt.safeGetActor(p),receiver:Gt.safeGetActor(p),quant:e}}];await f(t),x("RAM Purchase Successful",`Successfully purchased RAM with ${e}!`)}else{const e=Math.floor(parseFloat(n)),t=[{account:"eosio",name:"sellram",authorization:[{actor:Gt.safeGetActor(p),permission:Gt.safeGetPermission(p)}],data:{account:Gt.safeGetActor(p),bytes:e}}];await f(t),x("RAM Sale Successful",`Successfully sold ${e.toLocaleString()} bytes of RAM!`)}s?.(),t(),i("")}catch(r){De.error(`Failed to ${a} RAM`,"RAMModal.handleSubmit",r,{action:a,amount:n,account:Gt.safeGetActor(p)});const e=r instanceof Error?r.message:"Unknown error occurred";g(`RAM ${"buy"===a?"Purchase":"Sale"} Failed`,e)}finally{l(!1)}}},children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"amount",children:j}),Se.jsx("input",{type:"number",id:"amount",value:n,onChange:e=>i(e.target.value),placeholder:b,min:"buy"===a?"0.00000001":"1",step:"buy"===a?"0.00000001":"1",required:!0,disabled:r}),"buy"===a&&Se.jsx("small",{className:"form-hint",children:"Minimum: 0.00000001 WAX"}),"sell"===a&&Se.jsx("small",{className:"form-hint",children:"Enter the number of bytes to sell"})]}),Se.jsxs("div",{className:"form-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:r,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary",disabled:r||!n||parseFloat(n)<=0,children:r?"Processing...":`${y} RAM`})]})]})]})]})})},fs=({token:e,isOpen:t,onClose:a,onSuccess:s})=>{const[n,i]=O.useState(""),[r,l]=O.useState(""),[o,c]=O.useState(""),[d,u]=O.useState(!1),[h,m]=O.useState([]),[p,f]=O.useState(!1),{session:x,transferTokens:g}=Fe(),{showSuccess:v,showError:y}=xt(),j=e=>/^[a-z1-5.]{1,12}$/.test(e)&&e.length>=1&&e.length<=12,b=t=>{const a=parseFloat(t),s=parseFloat(e?.balance||"0");return a>0&&a<=s},N=()=>r&&0!==h.length?parseFloat(r)/h.length:0,w=e=>{const t=e.split(" ");if(t.length>0){const e=t[0].split(".")[1];return e?e.length:0}return 8},k=()=>{d||(i(""),l(""),c(""),m([]),f(!1),a())};return t&&e?Se.jsx("div",{className:"modal-overlay",onClick:k,children:Se.jsxs("div",{className:"modal-content token-transfer-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h2",{children:["Transfer ",e.symbol]}),Se.jsx("button",{className:"modal-close",onClick:k,disabled:d,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsx("div",{className:"token-preview",children:Se.jsxs("div",{className:"token-info",children:[Se.jsx("div",{className:"token-icon",children:"\ud83e\ude99"}),Se.jsxs("div",{className:"token-details",children:[Se.jsx("h3",{children:e.symbol}),Se.jsx("p",{className:"token-contract",children:e.contract}),Se.jsxs("p",{className:"token-balance",children:["Available: ",e.balance," ",e.symbol]}),"N/A"!==e.value&&"0.00"!==e.value&&Se.jsxs("p",{className:"token-usd-value",children:["\u2248 $",e.value," USD"]})]})]})}),Se.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!(e&&x&&n.trim()&&r.trim()))return void y("Validation Error","Please fill in all required fields");const d=h.filter(e=>!j(e));if(d.length>0)y("Invalid Account Names",`Invalid WAX account names: ${d.join(", ")}. Account names must be 12 characters, lowercase letters and numbers 1-5.`);else if(b(r)){u(!0);try{const t=w(e.balance),d=[];if(p&&h.length>1){const a=N().toFixed(t)+" "+e.symbol;for(const t of h)d.push({account:e.contract,name:"transfer",authorization:[{actor:x.actor,permission:x.permission}],data:{from:Gt.safeGetActor(x),to:t,quantity:a,memo:o.trim()||"Bulk transfer via PxMarket - market.pixeljourney.xyz"}})}else{const a=parseFloat(r).toFixed(t)+" "+e.symbol;d.push({account:e.contract,name:"transfer",authorization:[{actor:Gt.safeGetActor(x),permission:Gt.safeGetPermission(x)}],data:{from:Gt.safeGetActor(x),to:h[0]||n.trim(),quantity:a,memo:o.trim()||"Transferred via PxMarket - market.pixeljourney.xyz"}})}if(p){let t=0;for(const a of h)try{if(!g){De.error("transferTokens service not available","TokenTransferModal");continue}await g(a,N().toString(),e.symbol,o.trim()||"Bulk transfer via PxMarket - market.pixeljourney.xyz")&&t++}catch(k){De.error(`Transfer to ${a} failed`,"TokenTransferModal",k)}if(t>0){const a=t===h.length?`${r} ${e.symbol} transferred to all ${h.length} recipients successfully!`:`${r} ${e.symbol} transferred to ${t}/${h.length} recipients successfully!`;v("Bulk Transfer Complete",a)}}else{if(!g)return void y("Transfer Error","Transfer service not available");await g(h[0]||n.trim(),r,e.symbol,o.trim()||"Transferred via PxMarket - market.pixeljourney.xyz")&&v("Transfer Successful",`${r} ${e.symbol} transferred successfully!`)}s?.(),a(),i(""),l(""),c(""),m([]),f(!1)}catch(k){De.error("Token transfer failed","TokenTransferModal",k),y("Transfer Failed",k instanceof Error?k.message:"Unknown error occurred")}finally{u(!1)}}else y("Invalid Amount","Please enter a valid amount that does not exceed your balance")},className:"modal-form token-transfer-form",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"recipient",children:p?"Recipients (comma-separated) *":"Recipient WAX Account *"}),Se.jsx("input",{type:"text",id:"recipient",value:n,onChange:e=>(e=>{i(e.toLowerCase());const t=e.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0);m(t),f(t.length>1)})(e.target.value),placeholder:p?"e.g. pixeljourney,market.pxj,council.pxj":"e.g. pixeljourney",required:!0,disabled:d,className:"recipient-input"}),Se.jsx("small",{className:"input-help",children:p?`Enter WAX account names separated by commas (${h.length} recipients detected)`:"Enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)"}),p&&h.length>1&&Se.jsxs("div",{className:"recipients-preview",children:[Se.jsx("strong",{children:"Recipients:"}),Se.jsx("ul",{children:h.map((e,t)=>Se.jsxs("li",{className:j(e)?"valid":"invalid",children:[e," ",!j(e)&&"\u274c"]},t))})]})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"amount",children:"Amount *"}),Se.jsxs("div",{className:"amount-input-wrapper",children:[Se.jsx("input",{type:"number",id:"amount",value:r,onChange:e=>l(e.target.value),placeholder:"0.00000000",step:"0.00000001",min:"0",max:e.balance.split(" ")[0],required:!0,disabled:d,className:"amount-input"}),Se.jsx("button",{type:"button",className:"max-btn",onClick:()=>{if(e){const t=e.balance.split(" ")[0];l(t)}},disabled:d,children:"MAX"})]}),p&&h.length>1&&r&&Se.jsxs("small",{className:"distribution-info",children:["Each recipient will receive: ",N().toFixed(w(e.balance))," ",e.symbol]})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),Se.jsx("input",{type:"text",id:"memo",value:o,onChange:e=>c(e.target.value),placeholder:"Optional transfer message",maxLength:256,disabled:d,className:"memo-input"})]}),Se.jsxs("div",{className:"transfer-warning",children:[Se.jsx("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),Se.jsxs("div",{className:"warning-text",children:[Se.jsx("strong",{children:"Warning:"})," This action cannot be undone. Make sure you trust the recipient and have entered the correct account name and amount."]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{type:"button",className:"btn-secondary",onClick:k,disabled:d,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn-primary transfer-btn",disabled:d||!n.trim()||!r.trim()||!j(n.trim())||!b(r),children:d?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"spinner"}),p?"Bulk Transferring...":"Transferring..."]}):p?`Bulk Transfer ${e.symbol}`:`Transfer ${e.symbol}`})]})]})]})]})}):null},xs=()=>{const{isConnected:e,account:t}=Fe(),[a,s]=O.useState(null),[n,i]=O.useState([]),[r,l]=O.useState([]),[o,c]=O.useState([]),[d,u]=O.useState(!1),[h,m]=O.useState("30d"),[p,f]=O.useState("overview"),x=O.useCallback(async e=>{if(t)try{const a=await dt.getUserTransactions(t,1e3),s="7d"===h?7:"30d"===h?30:"90d"===h?90:365,n=[],i=new Date;for(let t=s;t>=0;t--){const s=new Date(i);s.setDate(s.getDate()-t);const r=s.getTime(),l=a.filter(e=>new Date(e.block_time).getTime()<=r);let o=0,c=0;l.forEach(e=>{if("purchase"===e.type&&e.price){const t=parseFloat(e.price.replace(/[^0-9.-]/g,"")||"0");c+=t,o+=t}else if("sale"===e.type&&e.price){const t=parseFloat(e.price.replace(/[^0-9.-]/g,"")||"0");o-=t}}),0===t?(o=e.totalValue,c=e.totalInvested):0===o&&0===c&&(o=0,c=0),n.push({date:s.toISOString().split("T")[0],value:o,invested:c})}c(n)}catch(a){console.error("Error generating time series data:",a);const t=[];for(let s="7d"===h?7:"30d"===h?30:"90d"===h?90:365;s>=0;s--){const a=new Date;a.setDate(a.getDate()-s),t.push({date:a.toISOString().split("T")[0],value:0===s?e.totalValue:.95*e.totalValue,invested:e.totalInvested})}c(t)}},[t,h]),g=O.useCallback(async()=>{if(t){u(!0);try{const e=await dt.getUserInventory(t),a=await dt.getUserTransactions(t);let n=0,r=0;const l={};for(const t of e){const e=parseFloat(t.price||"0");n+=e;const s=a.find(e=>e.asset_id===t.asset_id&&"purchase"===e.type),i=s?parseFloat(s.price||"0"):e;r+=i,l[t.collection]||(l[t.collection]={collection:t.collection,totalValue:0,totalInvested:0,profitLoss:0,profitLossPercentage:0,nftCount:0,averagePrice:0,floorPrice:0,performance:"neutral"}),l[t.collection].totalValue+=e,l[t.collection].totalInvested+=i,l[t.collection].nftCount+=1}const o=Object.values(l).map(e=>(e.profitLoss=e.totalValue-e.totalInvested,e.profitLossPercentage=e.totalInvested>0?e.profitLoss/e.totalInvested*100:0,e.averagePrice=e.nftCount>0?e.totalValue/e.nftCount:0,e.profitLossPercentage>20?e.performance="excellent":e.profitLossPercentage>5?e.performance="good":e.profitLossPercentage>-5?e.performance="neutral":e.performance="poor",e)),c=n-r,d=r>0?c/r*100:0,u=o.sort((e,t)=>t.profitLossPercentage-e.profitLossPercentage),h=u[0]?.collection||"N/A",m=u[u.length-1]?.collection||"N/A",p=45,f={totalValue:n,totalInvested:r,profitLoss:c,profitLossPercentage:d,totalNFTs:e.length,uniqueCollections:o.length,averageHoldingTime:p,bestPerformingCollection:h,worstPerformingCollection:m};s(f),i(o),v(f,o),await x(f)}catch(e){console.error("Error calculating portfolio metrics:",e)}finally{u(!1)}}},[t,x]),v=(e,t)=>{const a=[];e.profitLoss>0?a.push({type:"profit",title:"Portfolio in Profit",description:`Your portfolio has gained ${e.profitLossPercentage.toFixed(1)}% since initial investment`,value:`+${e.profitLoss.toFixed(2)} WAX`}):e.profitLoss<0&&a.push({type:"loss",title:"Portfolio Underperforming",description:`Your portfolio is down ${Math.abs(e.profitLossPercentage).toFixed(1)}% from initial investment`,value:`${e.profitLoss.toFixed(2)} WAX`});const s=t.find(t=>t.collection===e.bestPerformingCollection);s&&s.profitLossPercentage>10&&a.push({type:"profit",title:"Top Performer",description:`${s.collection} is your best performing collection`,value:`+${s.profitLossPercentage.toFixed(1)}%`,collection:s.collection}),t.length<3&&a.push({type:"opportunity",title:"Diversification Opportunity",description:"Consider diversifying across more collections to reduce risk",value:`${t.length} collections`});const n=t.reduce((e,t)=>t.totalValue>e.totalValue?t:e,t[0]);n&&n.totalValue/e.totalValue>.6&&a.push({type:"warning",title:"High Concentration Risk",description:`${n.collection} represents over 60% of your portfolio`,collection:n.collection}),l(a)};O.useEffect(()=>{e&&t&&g()},[e,t,g]);const y=e=>`${e.toFixed(2)} WAX`,j=e=>`${e>=0?"+":""}${e.toFixed(1)}%`;return e?d?Se.jsx("div",{className:"portfolio-analytics",children:Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Analyzing your portfolio..."})]})}):Se.jsxs("div",{className:"portfolio-analytics",children:[Se.jsxs("div",{className:"analytics-header",children:[Se.jsx("h2",{children:"Portfolio Analytics"}),Se.jsxs("div",{className:"analytics-controls",children:[Se.jsx("div",{className:"timeframe-selector",children:["7d","30d","90d","1y"].map(e=>Se.jsx("button",{className:"timeframe-btn "+(h===e?"active":""),onClick:()=>m(e),children:e},e))}),Se.jsx("div",{className:"view-selector",children:["overview","collections","insights"].map(e=>Se.jsx("button",{className:"view-btn "+(p===e?"active":""),onClick:()=>f(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),"overview"===p&&a&&Se.jsxs("div",{className:"overview-section",children:[Se.jsxs("div",{className:"metrics-grid",children:[Se.jsxs("div",{className:"metric-card primary",children:[Se.jsxs("div",{className:"metric-header",children:[Se.jsx("h3",{children:"Total Portfolio Value"}),Se.jsx("span",{className:"metric-icon",children:"\ud83d\udcb0"})]}),Se.jsx("div",{className:"metric-value",children:y(a.totalValue)}),Se.jsxs("div",{className:"metric-change "+(a.profitLoss>=0?"positive":"negative"),children:[j(a.profitLossPercentage)," (",y(a.profitLoss),")"]})]}),Se.jsxs("div",{className:"metric-card",children:[Se.jsxs("div",{className:"metric-header",children:[Se.jsx("h3",{children:"Total Invested"}),Se.jsx("span",{className:"metric-icon",children:"\ud83d\udcc8"})]}),Se.jsx("div",{className:"metric-value",children:y(a.totalInvested)})]}),Se.jsxs("div",{className:"metric-card",children:[Se.jsxs("div",{className:"metric-header",children:[Se.jsx("h3",{children:"NFTs Owned"}),Se.jsx("span",{className:"metric-icon",children:"\ud83c\udfa8"})]}),Se.jsx("div",{className:"metric-value",children:a.totalNFTs}),Se.jsxs("div",{className:"metric-subtitle",children:[a.uniqueCollections," collections"]})]}),Se.jsxs("div",{className:"metric-card",children:[Se.jsxs("div",{className:"metric-header",children:[Se.jsx("h3",{children:"Avg. Holding Time"}),Se.jsx("span",{className:"metric-icon",children:"\u23f1\ufe0f"})]}),Se.jsxs("div",{className:"metric-value",children:[a.averageHoldingTime,"d"]})]})]}),Se.jsxs("div",{className:"performance-chart",children:[Se.jsx("h3",{children:"Portfolio Performance"}),Se.jsxs("div",{className:"chart-container",children:[Se.jsx("svg",{className:"performance-svg",viewBox:"0 0 800 200",children:o.map((e,t)=>{const a=t/(o.length-1)*780+10,s=190-e.value/Math.max(...o.map(e=>e.value))*180,n=190-e.invested/Math.max(...o.map(e=>e.value))*180;return Se.jsxs("g",{children:[t>0&&Se.jsxs(Se.Fragment,{children:[Se.jsx("line",{x1:(t-1)/(o.length-1)*780+10,y1:190-o[t-1].value/Math.max(...o.map(e=>e.value))*180,x2:a,y2:s,stroke:"#4CAF50",strokeWidth:"2"}),Se.jsx("line",{x1:(t-1)/(o.length-1)*780+10,y1:190-o[t-1].invested/Math.max(...o.map(e=>e.value))*180,x2:a,y2:n,stroke:"#FF9800",strokeWidth:"2",strokeDasharray:"5,5"})]}),Se.jsx("circle",{cx:a,cy:s,r:"3",fill:"#4CAF50"})]},t)})}),Se.jsxs("div",{className:"chart-legend",children:[Se.jsxs("div",{className:"legend-item",children:[Se.jsx("div",{className:"legend-color",style:{backgroundColor:"var(--success-color)"}}),Se.jsx("span",{children:"Current Value"})]}),Se.jsxs("div",{className:"legend-item",children:[Se.jsx("div",{className:"legend-color dashed",style:{backgroundColor:"var(--warning-color)"}}),Se.jsx("span",{children:"Invested Amount"})]})]})]})]})]}),"collections"===p&&Se.jsxs("div",{className:"collections-section",children:[Se.jsx("h3",{children:"Collection Performance"}),Se.jsx("div",{className:"collections-grid",children:n.map((e,t)=>Se.jsxs("div",{className:`collection-card ${e.performance}`,children:[Se.jsxs("div",{className:"collection-header",children:[Se.jsx("h4",{children:e.collection}),Se.jsx("span",{className:`performance-badge ${e.performance}`,children:e.performance})]}),Se.jsxs("div",{className:"collection-metrics",children:[Se.jsxs("div",{className:"collection-metric",children:[Se.jsx("span",{className:"metric-label",children:"Value:"}),Se.jsx("span",{className:"metric-value",children:y(e.totalValue)})]}),Se.jsxs("div",{className:"collection-metric",children:[Se.jsx("span",{className:"metric-label",children:"P&L:"}),Se.jsx("span",{className:"metric-value "+(e.profitLoss>=0?"positive":"negative"),children:j(e.profitLossPercentage)})]}),Se.jsxs("div",{className:"collection-metric",children:[Se.jsx("span",{className:"metric-label",children:"NFTs:"}),Se.jsx("span",{className:"metric-value",children:e.nftCount})]}),Se.jsxs("div",{className:"collection-metric",children:[Se.jsx("span",{className:"metric-label",children:"Avg Price:"}),Se.jsx("span",{className:"metric-value",children:y(e.averagePrice)})]})]})]},t))})]}),"insights"===p&&Se.jsxs("div",{className:"insights-section",children:[Se.jsx("h3",{children:"Investment Insights"}),Se.jsx("div",{className:"insights-grid",children:r.map((e,t)=>Se.jsxs("div",{className:`insight-card ${e.type}`,children:[Se.jsxs("div",{className:"insight-header",children:[Se.jsxs("span",{className:`insight-icon ${e.type}`,children:["profit"===e.type&&"\ud83d\udcc8","loss"===e.type&&"\ud83d\udcc9","opportunity"===e.type&&"\ud83d\udca1","warning"===e.type&&"\u26a0\ufe0f"]}),Se.jsx("h4",{children:e.title}),e.value&&Se.jsx("span",{className:"insight-value",children:e.value})]}),Se.jsx("p",{className:"insight-description",children:e.description}),e.collection&&Se.jsxs("div",{className:"insight-collection",children:["Collection: ",e.collection]})]},t))})]})]}):Se.jsx("div",{className:"portfolio-analytics",children:Se.jsxs("div",{className:"wallet-connection-prompt",children:[Se.jsx("h3",{children:"\ud83d\udd17 Connect Your Wallet"}),Se.jsx("p",{children:"Connect your WAX wallet to view detailed portfolio analytics and investment insights."})]})})},gs={},vs=(e,t)=>{if(!e||void 0===t)return 0;return 1e11*(t/100)},ys=(e,t)=>{if(!e||void 0===t)return 0;return 2e9*((100-t)/100)},js=(e,t,a,s,n)=>{if(n&&n.virtual_block_cpu_limit&&n.block_cpu_limit){let i=parseFloat(n.block_cpu_limit),r=parseFloat(n.virtual_block_cpu_limit)/i;const l=F(e,t,a,s).cpuAmount*r;if(!l||l<=0)return"0 ms";const o=l/1e3;return o>=1e3?`${(o/1e3).toFixed(2)} seconds`:`${o.toFixed(2)} ms`}return"0 ms"},bs=()=>{const{account:e}=Da(),[t,a]=O.useState([]),[s,n]=O.useState(!0),[i,r]=O.useState(new Set),[l,o]=O.useState(null),[c,d]=O.useState(!1),u=O.useCallback(async()=>{if(e)try{n(!0);const t=await ht.checkUserBadges(e),s=await ht.getUserBadgeStats(e);a(t.badges),o(s)}catch(t){De.error("Error loading badges","PxBadges.loadUserBadges",t,{account:e})}finally{n(!1)}},[e]);O.useEffect(()=>{e?u():(a([]),n(!1))},[e,u]);const h=O.useMemo(()=>{const e=ht.getAllBadgeDefinitions(),a={holdings:{id:"holdings",name:"Token Holdings",icon:"\ud83d\udcb0",description:"Achievements for holding various tokens",badges:[]},ownership:{id:"ownership",name:"NFT Collections",icon:"\ud83c\udfad",description:"Achievements for owning NFTs and collectibles",badges:[]},trading:{id:"trading",name:"Trading Mastery",icon:"\ud83d\udcc8",description:"Achievements for trading activities",badges:[]},social:{id:"social",name:"Community",icon:"\ud83d\udc65",description:"Achievements for community participation",badges:[]},achievement:{id:"achievement",name:"Special Achievements",icon:"\ud83c\udfc6",description:"Rare and special accomplishments",badges:[]},special:{id:"special",name:"Legendary",icon:"\u2b50",description:"Ultra-rare legendary achievements",badges:[]}};return e.forEach(e=>{const s=a[e.type]||a.achievement,n=t.find(t=>t.id===e.id);s.badges.push(n||{...e,unlockedAt:void 0})}),Object.values(a).filter(e=>e.badges.length>0)},[t]),m=O.useMemo(()=>{const e=[],a=t.filter(e=>e.id.startsWith("pixal-collector")).sort((e,t)=>(e.tier||0)-(t.tier||0));if(a.length>0){const t=[1,2,3,4,5].map(e=>{const t=a.find(t=>t.tier===e);return{tier:e,earned:!!t?.unlockedAt,current:t?.progress&&!t.unlockedAt}});e.push({name:"Pixal Collector",badges:a,steps:t})}const s=t.filter(e=>e.id.startsWith("waxrock-collector")).sort((e,t)=>(e.tier||0)-(t.tier||0));if(s.length>0){const t=[1,2,3].map(e=>{const t=s.find(t=>t.tier===e);return{tier:e,earned:!!t?.unlockedAt,current:t?.progress&&!t.unlockedAt}});e.push({name:"WaxRock Collector",badges:s,steps:t})}return e},[t]),p=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return e?Se.jsxs("div",{className:"pxbadges-container",children:[Se.jsxs("div",{className:"pxbadges-header",children:[Se.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1rem"},children:[Se.jsx("h1",{className:"pxbadges-title",children:"Achievements"}),Se.jsx("button",{onClick:()=>d(!0),style:{background:"rgba(255, 215, 0, 0.2)",border:"2px solid #ffd700",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease",color:"#ffd700"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.3)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.2)",e.currentTarget.style.transform="scale(1)"},title:"Share Achievements",children:Se.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})})})]}),Se.jsx("p",{className:"pxbadges-subtitle",children:"Track your progress and unlock prestigious badges in the Pixel Journey ecosystem"}),l&&Se.jsxs("div",{className:"achievement-stats",children:[Se.jsxs("div",{className:"stat-card",children:[Se.jsx("span",{className:"stat-number",children:l.totalBadges}),Se.jsx("span",{className:"stat-label",children:"Total Earned"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("span",{className:"stat-number",children:l.badgesByRarity?.legendary||0}),Se.jsx("span",{className:"stat-label",children:"Legendary"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("span",{className:"stat-number",children:l.badgesByRarity?.epic||0}),Se.jsx("span",{className:"stat-label",children:"Epic"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("span",{className:"stat-number",children:l.badgesByRarity?.rare||0}),Se.jsx("span",{className:"stat-label",children:"Rare"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("span",{className:"stat-number",children:l.progressBadges?.length||0}),Se.jsx("span",{className:"stat-label",children:"In Progress"})]})]})]}),s?Se.jsxs("div",{className:"achievements-loading",children:[Se.jsx("div",{className:"loading-spinner"}),"Loading achievements..."]}):Se.jsxs("div",{className:"achievement-categories",children:[m.length>0&&Se.jsxs("div",{className:"category-section",children:[Se.jsxs("div",{className:"category-header",children:[Se.jsx("span",{className:"category-icon",children:"\ud83c\udfc6"}),Se.jsx("h2",{className:"category-title",children:"Achievement Series"})]}),m.map(e=>Se.jsxs("div",{className:"achievement-card earned",children:[Se.jsxs("div",{className:"achievement-header",children:[Se.jsx("span",{className:"achievement-icon",children:"\ud83c\udfaf"}),Se.jsxs("div",{className:"achievement-info",children:[Se.jsx("h3",{className:"achievement-name",children:e.name}),Se.jsxs("p",{className:"achievement-description",children:["Multi-tier achievement series with ",e.steps.length," levels"]})]})]}),Se.jsx("div",{className:"achievement-series",children:e.steps.map(e=>Se.jsx("div",{className:"series-step "+(e.earned?"completed":e.current?"current":""),children:e.tier},e.tier))})]},e.name))]}),h.map(e=>{const t=e.badges.filter(e=>e.unlockedAt).length,a=e.badges.length,s=i.has(e.id);return Se.jsxs("div",{className:"category-section",children:[Se.jsxs("div",{className:"category-header",onClick:()=>(e=>{const t=new Set(i);t.has(e)?t.delete(e):t.add(e),r(t)})(e.id),children:[Se.jsx("span",{className:"category-icon",children:e.icon}),Se.jsx("h2",{className:"category-title",children:e.name}),Se.jsxs("span",{className:"category-progress",children:[t,"/",a]}),Se.jsx("span",{className:"category-toggle "+(s?"collapsed":""),children:"\u25bc"})]}),!s&&Se.jsx("div",{className:"achievements-grid",children:e.badges.map(e=>{const t=!!e.unlockedAt,a=(e=>"legendary"===e.rarity?"legendary":"epic"===e.rarity?"epic":"rare"===e.rarity?"rare":"")(e);return Se.jsxs("div",{className:`achievement-card ${t?"earned":""} ${a}`,children:[Se.jsxs("div",{className:"achievement-header",children:[Se.jsx("span",{className:"achievement-icon",children:e.icon}),Se.jsxs("div",{className:"achievement-info",children:[Se.jsx("h3",{className:"achievement-name",children:e.name}),Se.jsx("p",{className:"achievement-description",children:e.description}),Se.jsx("p",{className:"achievement-requirements",children:e.requirements})]})]}),e.tier&&Se.jsxs("div",{className:"achievement-tier",children:["Tier ",e.tier]}),e.progress&&Se.jsxs("div",{className:"achievement-progress",children:[Se.jsx("div",{className:"progress-bar",children:Se.jsx("div",{className:"progress-fill",style:{width:`${e.progress.percentage}%`}})}),Se.jsxs("div",{className:"progress-text",children:[e.progress.current.toLocaleString()," / ",e.progress.required.toLocaleString(),"(",e.progress.percentage,"%)"]})]}),t&&e.unlockedAt&&Se.jsx("div",{className:"achievement-date",children:p(e.unlockedAt)})]},e.id)})})]},e.id)}),0===h.length&&Se.jsxs("div",{className:"no-achievements",children:[Se.jsx("div",{className:"no-achievements-icon",children:"\ud83c\udfaf"}),Se.jsx("div",{className:"no-achievements-text",children:"No Achievements Yet"}),Se.jsx("div",{className:"no-achievements-subtitle",children:"Start participating in the Pixel Journey ecosystem to earn your first badges!"})]})]}),Se.jsx(sa,{isOpen:c,onClose:()=>d(!1),title:`${e}'s Achievements`,description:`Check out my achievements in the Pixel Journey ecosystem! I've earned ${l?.totalBadges||0} badges including ${l?.badgesByRarity?.legendary||0} legendary achievements.`,shareUrl:`${window.location.origin}/pxbadges?user=${e}`,defaultShareText:`Check out my achievements in the Pixel Journey ecosystem! I've earned ${l?.totalBadges||0} badges. #PixelJourney #Achievements`,type:"achievement",badges:t,totalBadges:l?.totalBadges||0,legendaryCount:l?.badgesByRarity?.legendary||0,username:e||""})]}):Se.jsx("div",{className:"pxbadges-container",children:Se.jsxs("div",{className:"no-achievements",children:[Se.jsx("div",{className:"no-achievements-icon",children:"\ud83d\udd12"}),Se.jsx("div",{className:"no-achievements-text",children:"Connect Your Wallet"}),Se.jsx("div",{className:"no-achievements-subtitle",children:"Connect your wallet to view your achievements and progress"})]})})},Ns=O.createContext(void 0),ws=({children:e})=>{const{account:t}=Da(),[a,s]=O.useState({}),[n,i]=O.useState([]),[r,l]=O.useState(!1),[o,c]=O.useState(0),d=O.useCallback(()=>Date.now()-o>5e3,[o]),u=O.useCallback(async()=>{if(!t)return s({}),void i([]);if(!d()&&n.length>0)De.info("Skipping balance fetch - too recent","TokenBalanceContext");else{l(!0);try{De.info("Fetching token balances from Light API","TokenBalanceContext",{account:t});const e=await dt.getLightApiBalances(t);if(e&&e.balances){const a={};i(e.balances);for(const t of e.balances){const e=`${t.currency}-${t.contract}`;a[t.currency]=`${t.amount} ${t.currency}`,a[e]=`${t.amount} ${t.currency}`}s(a),c(Date.now()),De.info("Successfully loaded token balances","TokenBalanceContext",{account:t,tokenCount:e.balances.length})}else De.warn("No balances returned from Light API","TokenBalanceContext",{account:t}),s({}),i([])}catch(e){De.error("Failed to load token balances","TokenBalanceContext",e,{account:t}),s({}),i([])}finally{l(!1)}}},[t,d,n.length]),h=O.useCallback((e,t)=>{if(t){const a=n.find(a=>a.currency===e&&a.contract===t);if(a)return`${a.amount} ${a.currency}`}return a[e]||`0.0000 ${e}`},[a,n]);O.useEffect(()=>{u()},[t]),O.useEffect(()=>{if(!t)return;const e=setInterval(()=>{u()},3e4);return()=>clearInterval(e)},[t,u]);const m={balances:a,lightApiBalances:n,isLoading:r,refreshBalances:u,getTokenBalance:h};return Se.jsx(Ns.Provider,{value:m,children:e})},ks=()=>{const e=O.useContext(Ns);if(void 0===e)throw new Error("useTokenBalance must be used within a TokenBalanceProvider");return e};const _s=new class{constructor(){M(this,"ALCOR_API_BASE","https://alcor.exchange/api/v2"),M(this,"WAX_CONTRACT","eosio.token"),M(this,"WPIXAL_CONTRACT","pixeljourney"),M(this,"WAX_SYMBOL","WAX"),M(this,"WPIXAL_SYMBOL","WPIXAL"),M(this,"WAX_TOKEN_ID","wax-eosio.token"),M(this,"WPIXAL_TOKEN_ID","wpixal-pixeljourney"),M(this,"tokensCache",null),M(this,"tokensCacheExpiry",0),M(this,"CACHE_DURATION",3e5)}async getAllTokens(){try{if(this.tokensCache&&Date.now()<this.tokensCacheExpiry)return this.tokensCache;const e=`${this.ALCOR_API_BASE}/tokens`,t=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const a=await t.json();return this.tokensCache=a.map(e=>({id:e.id||`${e.symbol.toLowerCase()}-${e.contract}`,symbol:e.symbol,contract:e.contract,precision:e.precision||8,logo:e.logo,usd_price:e.usd_price,system_price:e.system_price})),this.tokensCacheExpiry=Date.now()+this.CACHE_DURATION,this.tokensCache||[]}catch(e){return De.error("Error fetching all tokens:","AlcorService.getAllTokens",e),[{id:this.WAX_TOKEN_ID,symbol:this.WAX_SYMBOL,contract:this.WAX_CONTRACT,precision:8},{id:this.WPIXAL_TOKEN_ID,symbol:this.WPIXAL_SYMBOL,contract:this.WPIXAL_CONTRACT,precision:8}]}}async getSwapQuoteForPair(e,t,a,s,n="EXACT_INPUT",i=.05){try{const r=`${this.ALCOR_API_BASE}/swapRouter/getRoute?trade_type=${n}&input=${e.token_id}&output=${t.token_id}&amount=${parseFloat(a).toFixed(e.precision)}&slippage=${i.toFixed(2)}&receiver=${s}&maxHops=3&v2=true`;De.info("Fetching swap route from:",r);const l=await fetch(r);if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const o=await l.json();if(De.info("Swap route response:",o),!o.swaps||0===o.swaps.length)throw new Error("No swap route found for this token pair");const c=o.swaps[0];return{input_amount:o.maxSent||c.maxSent||o.input||c.input,output_amount:o.output||c.output||o.minReceived||c.minReceived,price_impact:o.priceImpact?.toString()||"0",minimum_received:o.minReceived||c.minReceived,route:o.route?.map((a,s)=>({pool_id:a,token_in:0===s?`${e.symbol}@${e.contract}`:"intermediate",token_out:s===o.route.length-1?`${t.symbol}@${t.contract}`:"intermediate",amount_in:0===s?o.input||c.input:"0",amount_out:s===o.route.length-1?o.output||c.output:"0"}))||[],memo:o.memo||c.memo,input_token:e,output_token:t}}catch(r){throw De.error("Error getting swap quote for pair:","AlcorService.getSwapQuoteForPair",r),new Error(`Failed to get swap quote for ${e.symbol}/${t.symbol}: ${r instanceof Error?r.message:"Unknown error"}`)}}async getExactOutputQuote(e,t,a=.05){try{const s=`${this.ALCOR_API_BASE}/swapRouter/getRoute?trade_type=EXACT_OUTPUT&input=${this.WAX_TOKEN_ID}&output=${this.WPIXAL_TOKEN_ID}&amount=${parseFloat(e).toFixed(8)}&slippage=${a.toFixed(2)}&receiver=${t}&maxHops=3&v2=true`;De.error("Fetching swap route from:",s);const n=await fetch(s);if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(De.error("Swap route response:",i),!i.swaps||0===i.swaps.length)throw new Error("No swap route found");const r=i.swaps[0];return{input_amount:i.maxSent||r.maxSent,output_amount:i.output||r.output,price_impact:i.priceImpact?.toString()||"0",minimum_received:i.minReceived||r.minReceived,route:i.route?.map((e,t)=>({pool_id:e,token_in:0===t?`${this.WAX_SYMBOL}@${this.WAX_CONTRACT}`:"intermediate",token_out:t===i.route.length-1?`${this.WPIXAL_SYMBOL}@${this.WPIXAL_CONTRACT}`:"intermediate",amount_in:0===t?i.input||r.input:"0",amount_out:t===i.route.length-1?i.output||r.output:"0"}))||[],memo:i.memo||r.memo,input_token:{symbol:this.WAX_SYMBOL,contract:this.WAX_CONTRACT,precision:8,token_id:this.WAX_TOKEN_ID},output_token:{symbol:this.WPIXAL_SYMBOL,contract:this.WPIXAL_CONTRACT,precision:8,token_id:this.WPIXAL_TOKEN_ID}}}catch(s){throw De.error("Error getting exact output quote:","alcorService.getExactOutputQuote",s),new Error(`Failed to get swap quote: ${s instanceof Error?s.message:"Unknown error"}`)}}async getSwapQuote(e){const t=await this.getExchangeRate(),a=(parseFloat(e)/t).toFixed(8);return this.getExactOutputQuote(a,"dummy.account",.5)}async executeSwap(e,t,a=.5){try{const s=await this.getExactOutputQuote(e,t,a),n={expiration:new Date(Date.now()+18e5).toISOString(),ref_block_num:0,ref_block_prefix:0,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.WAX_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"swap.alcor",quantity:`${parseFloat(s.input_amount).toFixed(8)} ${this.WAX_SYMBOL}`,memo:s.memo}}],transaction_extensions:[]};return De.info("Swap transaction prepared","AlcorService.executeSwap",{wpixalAmount:e,maxWaxInput:s.input_amount,memo:s.memo,route:s.route}),n}catch(s){throw De.error("Error executing swap:","AlcorService.executeSwap",s instanceof Error?s:new Error(String(s))),s}}async executeSwapForPair(e,t,a,s,n="EXACT_INPUT",i=.05){try{const r=await this.getSwapQuoteForPair(e,t,a,s,n,i),l={expiration:new Date(Date.now()+18e5).toISOString(),ref_block_num:0,ref_block_prefix:0,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:e.contract,name:"transfer",authorization:[{actor:s,permission:"active"}],data:{from:s,to:"swap.alcor",quantity:`${parseFloat(r.input_amount).toFixed(e.precision)} ${e.symbol}`,memo:r.memo}}],transaction_extensions:[]};return De.info("Generic swap transaction prepared","AlcorService.executeSwapForPair",{inputToken:e.symbol,outputToken:t.symbol,amount:a,tradeType:n,inputAmount:r.input_amount,outputAmount:r.output_amount,memo:r.memo,route:r.route}),l}catch(r){throw De.error("Error executing swap for pair:","AlcorService.executeSwapForPair",r instanceof Error?r:new Error(String(r))),r}}async calculateOutputAmount(e,t,a,s,n=.05){return this.getSwapQuoteForPair(e,t,a,s,"EXACT_INPUT",n)}async calculateInputAmount(e,t,a,s,n=.05){return this.getSwapQuoteForPair(e,t,a,s,"EXACT_OUTPUT",n)}formatTokenId(e,t){return`${e.toLowerCase()}-${t.toLowerCase()}`}parseSwapMemo(e){try{if(!e.startsWith("swap,"))return null;const t=e.split(","),a=[];let s="0";for(const e of t)if(e.startsWith("pools:")){const t=e.substring(6).split(":");a.push(...t.map(e=>parseInt(e)))}else e.startsWith("minOut:")&&(s=e.substring(7));return{pools:a,minOut:s}}catch(t){return De.error("Error parsing swap memo:","AlcorService.parseSwapMemo",t),null}}async getExchangeRate(){try{const e=await this.getExactOutputQuote("1.00000000","dummy.account",0);return parseFloat(e.input_amount)}catch(e){return De.error("Error getting exchange rate:","AlcorService.getExchangeRate",e instanceof Error?e:new Error(String(e))),292e-6}}async checkLiquidity(e){try{const t=await this.getExactOutputQuote(e,"dummy.account",.5);return parseFloat(t.price_impact)<5}catch(t){return De.error("Error checking liquidity:","AlcorService.checkLiquidity",t instanceof Error?t:new Error(String(t))),!1}}async estimateWaxNeeded(e){try{return(await this.getExactOutputQuote(e,"dummy.account",0)).input_amount}catch(t){throw De.error("Error estimating WAX needed:","AlcorService.estimateWaxNeeded",t instanceof Error?t:new Error(String(t))),t}}},Ss=(e,t)=>`https://raw.githubusercontent.com/alcorexchange/alcor-ui/refs/heads/master/assets/tokens/wax/${`${e.toLowerCase()}_${t.toLowerCase()}.png`}`,Cs=e=>({WAX:"\ud83e\ude99",WPIXAL:"\ud83d\udc7d",PXJ:"\u267b\ufe0f",KING:"\ud83d\udc51",WAXUSDC:"\ud83d\udcb5",WAXWBTC:"\u20bf",WUF:"\ud83d\udc36",LSWAX:"\ud83d\udc8e",BRWL:"\u2694\ufe0f",TLM:"\u26cf\ufe0f",WOMBAT:"\ud83d\udc28",TACO:"\ud83c\udf2e",SHING:"\u2728",YEET:"\ud83d\ude80",DMT:"\ud83d\udda5\ufe0f",FGL:"\ud83c\udfae",SOREN:"\u2708\ufe0f"}[e.toUpperCase()]||"\ud83e\ude99"),As=({iconUrl:e,fallbackEmoji:t="\ud83e\ude99",symbol:a,className:s=""})=>{const[n,i]=O.useState(!1);return!e||n?Se.jsx("span",{className:s,children:t}):Se.jsx("img",{src:e,alt:a,className:s,onError:()=>{i(!0)},style:{width:"20px",height:"20px",objectFit:"contain"}})},Ts={PXJ:{contract:"pixeljourney",decimals:8,priority:1},WPIXAL:{contract:"pixeljourney",decimals:8,priority:2},WAX:{contract:"eosio.token",decimals:8,priority:3},KING:{contract:"alpha.waxfun",decimals:8,priority:4},WAXUSDC:{contract:"eth.token",decimals:8,priority:5},WAXWBTC:{contract:"eth.token",decimals:8,priority:6},WUF:{contract:"wuffi",decimals:4,priority:7},LSWAX:{contract:"token.defi",decimals:8,priority:8},BRWL:{contract:"brawlertoken",decimals:4,priority:9},TLM:{contract:"alien.worlds",decimals:4,priority:10},WOMBAT:{contract:"wombattoken",decimals:4,priority:11}},Ps=["WAX","WPIXAL"],Es=({selectedToken:e,onTokenSelect:t,availableTokens:a=Ps,className:s="",filterByAvailable:n=!1})=>{const{account:i}=Da(),{lightApiBalances:r}=ks(),[l,o]=O.useState(!1),[c,d]=O.useState([]),[u,h]=O.useState([]),[m,p]=O.useState(!1),f=O.useRef(null),x=O.useCallback(async()=>{try{const e=await _s.getAllTokens();return h(e),e}catch(e){De.error("Failed to load Alcor tokens","TokenDropdown.loadAlcorTokens",e);const t=[{symbol:"WAX",contract:"eosio.token",precision:8,logo:null},{symbol:"WPIXAL",contract:"pixeljourney",precision:8,logo:null}];return h(t),t}},[]),g=O.useMemo(()=>e=>{const t=Ts[e];if(t)return{contract:t.contract,decimals:t.decimals,iconUrl:Ss(e,t.contract),fallbackEmoji:Cs(e),priority:t.priority};const a=u.find(t=>t.symbol===e);return a?{contract:a.contract,decimals:a.precision,iconUrl:Ss(e,a.contract),fallbackEmoji:Cs(e),priority:999}:{contract:"eosio.token",decimals:8,iconUrl:Ss(e,"eosio.token"),fallbackEmoji:Cs(e),priority:1e3}},[u]),v=O.useCallback(async()=>{if(0===u.length&&await x(),!i){const e=(n?a:u.map(e=>e.symbol)).map(e=>{const t=g(e);return{symbol:e,contract:t.contract,amount:"0.0000",decimals:t.decimals,iconUrl:t.iconUrl,fallbackEmoji:t.fallbackEmoji,priority:t.priority||999}});return void d(e)}p(!0);try{const e=[],t=n?a:u.map(e=>e.symbol);for(const a of t){const t=g(a);if(!t)continue;const s=r.find(e=>e.currency===a&&e.contract===t.contract);e.push({symbol:a,contract:t.contract,amount:s?s.amount:"0.0000",decimals:s?parseInt(s.decimals):t.decimals,iconUrl:t.iconUrl,fallbackEmoji:t.fallbackEmoji,priority:t.priority||999})}if(e.sort((e,t)=>(e.priority||999)-(t.priority||999)),!n){for(const a of r)if(!t.includes(a.currency)){const t=g(a.currency);t&&e.push({symbol:a.currency,contract:a.contract,amount:a.amount,decimals:parseInt(a.decimals),iconUrl:t.iconUrl,fallbackEmoji:t.fallbackEmoji,priority:t.priority||999})}e.sort((e,t)=>(e.priority||999)-(t.priority||999))}d(e)}catch(e){De.error("Failed to load token balances","TokenDropdown.loadTokenBalances",e);const t=(n?a:u.map(e=>e.symbol)).map(e=>{const t=g(e);return{symbol:e,contract:t.contract,amount:"0.0000",decimals:t.decimals,iconUrl:t.iconUrl,fallbackEmoji:t.fallbackEmoji,priority:t.priority||999}});t.sort((e,t)=>(e.priority||999)-(t.priority||999)),d(t)}finally{p(!1)}},[i,a,u,n,r,x,g]);O.useEffect(()=>{x()},[x]),O.useEffect(()=>{v()},[v]),O.useEffect(()=>{const e=e=>{f.current&&!f.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const y=c.find(t=>t.symbol===e),j=g(e);return Se.jsxs("div",{className:`token-dropdown ${s}`,ref:f,children:[Se.jsxs("button",{className:"token-button",onClick:()=>o(!l),type:"button",children:[Se.jsx("span",{className:"token-icon",children:Se.jsx(As,{iconUrl:y?.iconUrl,fallbackEmoji:y?.fallbackEmoji||j?.fallbackEmoji,symbol:e,className:"token-logo"})}),Se.jsx("span",{className:"token-symbol",children:e}),Se.jsx("span",{className:"dropdown-arrow "+(l?"open":""),children:"\u25bc"})]}),l&&Se.jsx("div",{className:"token-dropdown-menu",children:m?Se.jsx("div",{className:"token-dropdown-loading",children:Se.jsx("span",{children:"Loading tokens..."})}):Se.jsxs(Se.Fragment,{children:[c.map(a=>Se.jsxs("button",{className:"token-option "+(a.symbol===e?"selected":""),onClick:()=>(e=>{t(e.symbol),o(!1)})(a),type:"button",children:[Se.jsxs("div",{className:"token-option-left",children:[Se.jsx("span",{className:"token-option-icon",children:Se.jsx(As,{iconUrl:a.iconUrl,fallbackEmoji:a.fallbackEmoji,symbol:a.symbol,className:"token-logo"})}),Se.jsxs("div",{className:"token-option-info",children:[Se.jsx("span",{className:"token-option-symbol",children:a.symbol}),Se.jsx("span",{className:"token-option-contract",children:a.contract})]})]}),Se.jsx("div",{className:"token-option-balance",children:parseFloat(a.amount).toFixed(4)})]},`${a.contract}-${a.symbol}`)),0===c.length&&Se.jsx("div",{className:"token-dropdown-empty",children:Se.jsx("span",{children:"No tokens available"})})]})})]})},Is=({isModal:e=!1,onClose:t,initialSellAmount:a=0,initialBuyAmount:s=1})=>{const{showSuccess:n,showError:i}=xt(),{account:r,session:l}=Da(),{getTokenBalance:o}=ks(),[c,d]=O.useState(a.toString()),[u,h]=O.useState(s.toString()),[m,p]=O.useState("WAX"),[f,x]=O.useState("WPIXAL"),[g,v]=O.useState(!1),[y,j]=O.useState(null),[b,N]=O.useState(.5),[w,k]=O.useState(!1),[_,S]=O.useState([]),[C,A]=O.useState(!1),[T,P]=O.useState("sell"),E=O.useCallback(async()=>{try{const e=await _s.getAllTokens();return S(e),e}catch(e){return De.error("Failed to load Alcor tokens","SwapInterface.loadAlcorTokens",e),[]}},[]),I={PXJ:{contract:"pixeljourney",precision:8,priority:1,icon:Ss("PXJ","pixeljourney")},WPIXAL:{contract:"pixeljourney",precision:8,priority:2,icon:Ss("WPIXAL","pixeljourney")},WAX:{contract:"eosio.token",precision:8,priority:3,icon:Ss("WAX","eosio.token")},KING:{contract:"alpha.waxfun",precision:8,priority:4,icon:Ss("KING","alpha.waxfun")},WAXUSDC:{contract:"eth.token",precision:8,priority:5,icon:Ss("WAXUSDC","eth.token")},WAXWBTC:{contract:"eth.token",precision:8,priority:6,icon:Ss("WAXWBTC","eth.token")},WUF:{contract:"wuffi",precision:4,priority:7,icon:Ss("WUF","wuffi")},LSWAX:{contract:"token.defi",precision:8,priority:8,icon:Ss("LSWAX","token.defi")},BRWL:{contract:"brawlertoken",precision:4,priority:9,icon:Ss("BRWL","brawlertoken")},TLM:{contract:"alien.worlds",precision:4,priority:10,icon:Ss("TLM","alien.worlds")},WOMBAT:{contract:"wombattoken",precision:4,priority:11,icon:Ss("WOMBAT","wombattoken")},TACO:{contract:"t.taco",precision:8,priority:12,icon:Ss("TACO","t.taco")},SHING:{contract:"t.taco",precision:8,priority:13,icon:Ss("SHING","t.taco")},YEET:{contract:"token.yeet",precision:4,priority:14,icon:Ss("YEET","token.yeet")},DMT:{contract:"defiminingtk",precision:4,priority:15,icon:Ss("DMT","defiminingtk")},FGL:{contract:"fgltokenmgmt",precision:4,priority:16,icon:Ss("FGL","fgltokenmgmt")},SOREN:{contract:"farfromhomes",precision:4,priority:17,icon:Ss("SOREN","farfromhomes")}},F=O.useCallback(e=>{if(I[e]){const t=I[e];return{symbol:e,contract:t.contract,precision:t.precision,token_id:`${e.toLowerCase()}-${t.contract.toLowerCase()}`,decimals:t.precision,icon:t.icon,logo:t.icon}}const t=_.find(t=>t.symbol===e);return t?{symbol:t.symbol,contract:t.contract,precision:t.decimals,token_id:`${t.symbol.toLowerCase()}-${t.contract.toLowerCase()}`,decimals:t.decimals,icon:t.logo||"/icons/default-token.png",logo:t.logo||"/icons/default-token.png"}:null},[_]);O.useEffect(()=>{E()},[]);const $=O.useCallback((e,t)=>{const a=o(e,t).split(" ")[0];return parseFloat(a)||0},[o]),L=O.useCallback(async(e,t,a,s)=>{if(!e||parseFloat(e)<=0||!r)return null;try{A(!0);const n=F(t),i=F(a);if(!n||!i)return De.error("Token info not found","SwapInterface.calculateSwapAmount"),null;let l;return l="EXACT_INPUT"===s?await _s.calculateOutputAmount(n,i,e,r||"market.pxjm",b/100):await _s.calculateInputAmount(n,i,e,r||"market.pxj",b/100),j(l),l}catch(n){return De.error("Failed to calculate swap amount","SwapInterface.calculateSwapAmount",n),null}finally{A(!1)}},[r,b,F]),M=O.useCallback(async e=>{if(d(e),P("sell"),!e||parseFloat(e)<=0)return h(""),void j(null);const t=await L(e,m,f,"EXACT_INPUT");t&&h(t.output_amount)},[m,f,L]),R=O.useCallback(async e=>{if(h(e),P("buy"),!e||parseFloat(e)<=0)return d(""),void j(null);const t=await L(e,m,f,"EXACT_OUTPUT");t&&d(t.input_amount)},[m,f,L]);O.useEffect(()=>{"sell"===T&&c?M(c):"buy"===T&&u&&R(u)},[m,f,T,c,u,M,R]);const W=O.useCallback(async()=>{"sell"===T&&c?await M(c):"buy"===T&&u&&await R(u)},[T,c,u,M,R]),D=Se.jsxs("div",{className:"swap-interface "+(e?"modal-content":""),children:[e&&Se.jsxs("div",{className:"swap-header",children:[Se.jsx("h2",{children:"Swap Tokens"}),Se.jsx("button",{className:"close-button",onClick:t,children:"\xd7"})]}),Se.jsxs("div",{className:"swap-container",children:[Se.jsxs("div",{className:"settings-container",children:[Se.jsx("button",{className:"settings-toggle",onClick:()=>k(!w),children:"\u2699\ufe0f"}),Se.jsx("button",{className:"refresh-quote-button",onClick:W,disabled:C||!c&&!u,title:"Refresh price quote",children:C?"\u27f3":"\ud83d\udd04"})]}),w&&Se.jsxs("div",{className:"slippage-settings",children:[Se.jsx("label",{children:"Slippage Tolerance"}),Se.jsxs("div",{className:"slippage-options",children:[Se.jsx("button",{className:1===b?"active":"",onClick:()=>N(1),children:"1%"}),Se.jsx("button",{className:5===b?"active":"",onClick:()=>N(5),children:"5%"}),Se.jsx("button",{className:25===b?"active":"",onClick:()=>N(25),children:"25.0%"}),Se.jsx("input",{type:"number",value:b,onChange:e=>N(parseFloat(e.target.value)||.5),step:"0.1",min:"0.1",max:"50",className:"custom-slippage"})]})]}),Se.jsxs("div",{className:"swap-section sell-section",children:[Se.jsxs("div",{className:"swap-section-header",children:[Se.jsx("span",{className:"section-label",children:"Sell"}),Se.jsxs("span",{className:"balance",onClick:()=>{const e=$(m);M(e.toString())},style:{cursor:"pointer"},children:["Balance: ",$(m).toFixed(4)," ",m]})]}),Se.jsxs("div",{className:"input-container",children:[Se.jsx("input",{type:"number",value:c,onChange:e=>M(e.target.value),placeholder:"0",className:"amount-input"}),Se.jsx("div",{className:"token-selector",children:Se.jsx(Es,{selectedToken:m,onTokenSelect:p,filterByAvailable:!1,className:"sell-token-dropdown"})})]}),Se.jsxs("div",{className:"percentage-slider",children:[Se.jsx("input",{type:"range",min:"0",max:"100",value:c?Math.round(parseFloat(c)/$(m)*100):0,onChange:e=>(e=>{const t=($(m)*e/100).toFixed(4);M(t)})(parseInt(e.target.value)),className:"slider"}),Se.jsxs("div",{className:"slider-labels",children:[Se.jsx("span",{children:"0%"}),Se.jsx("span",{children:"25%"}),Se.jsx("span",{children:"50%"}),Se.jsx("span",{children:"75%"}),Se.jsx("span",{children:"100%"})]})]})]}),Se.jsx("div",{className:"swap-arrow-container",children:Se.jsx("button",{className:"swap-arrow",onClick:()=>{const e=m,t=c;p(f),x(e),d(u),h(t)},children:"\u2193"})}),Se.jsxs("div",{className:"swap-section buy-section",children:[Se.jsxs("div",{className:"swap-section-header",children:[Se.jsx("span",{className:"section-label",children:"Buy"}),Se.jsxs("span",{className:"balance",children:["Balance: ",$(f).toFixed(4)," ",f]})]}),Se.jsxs("div",{className:"input-container",children:[Se.jsx("input",{type:"number",value:u,onChange:e=>R(e.target.value),placeholder:"0",className:"amount-input",title:"Enter desired output amount"}),Se.jsx("div",{className:"token-selector",children:Se.jsx(Es,{selectedToken:f,onTokenSelect:x,filterByAvailable:!1,className:"buy-token-dropdown"})})]})]}),y&&Se.jsxs("div",{className:"quote-info",children:[Se.jsxs("div",{className:"quote-row",children:[Se.jsx("span",{className:"quote-label",children:"Rate"}),Se.jsxs("span",{className:"quote-value",children:[y.rate||"0.00340412"," WPIXAL per WAX (0.02%)"]})]}),Se.jsxs("div",{className:"quote-row",children:[Se.jsx("span",{className:"quote-label",children:"Expected Output"}),Se.jsx("span",{className:"quote-value",children:y.expectedOutput||u})]}),Se.jsxs("div",{className:"quote-row",children:[Se.jsx("span",{className:"quote-label",children:"Price Impact"}),Se.jsx("span",{className:"quote-value",children:y.priceImpact||"< 0.01%"})]}),Se.jsxs("div",{className:"quote-row",children:[Se.jsx("span",{className:"quote-label",children:"Maximum Send after slippage"}),Se.jsxs("span",{className:"quote-value",children:[y.maxSent||"309.45013892"," WAX (0.50%)"]})]})]}),Se.jsx("button",{className:"swap-button "+(g||!r||!y||parseFloat(c)<=0?"disabled":""),onClick:async()=>{if(r&&l)if(y)try{v(!0);const a=F(m),s=F(f);if(!a||!s)throw new Error(`Token configuration not found for ${a?f:m}`);const i=await _s.executeSwapForPair(a,s,c,r,"EXACT_INPUT",b/100),o=await l.transact({actions:i.actions});n(`Successfully swapped ${c} ${m} for ${u} ${f}`),De.info("Swap transaction completed","SwapInterface.executeSwap",{sellAmount:c,sellToken:m,buyAmount:u,buyToken:f,transactionId:o?.transaction?.id||o?.transactionId||o?.id||"unknown"}),d("0"),h("0"),j(null),e&&t&&t()}catch(a){De.error("Error executing swap","SwapInterface.executeSwap",a),i("Failed to execute swap transaction")}finally{v(!1)}else i("No quote available");else i("Please connect your wallet first")},disabled:g||!r||!y||parseFloat(c)<=0,children:g?Se.jsxs("span",{className:"loading-text",children:[Se.jsx("span",{className:"spinner"}),"Processing..."]}):r?y?parseFloat(c)<=0?"Enter Valid Amount":`Swap ${m} To ${f}`:"Enter Amount":"Connect Wallet"})]})]});return e?Se.jsx("div",{className:"swap-modal-overlay",onClick:t,children:Se.jsx("div",{onClick:e=>e.stopPropagation(),children:D})}):D},Fs=()=>{const{account:e,isConnected:t,session:a,login:s}=Fe(),{showError:n,showSuccess:i}=xt(),r=B(),[l,o]=O.useState("overview"),[c,d]=O.useState([]),[u,h]=O.useState({}),[m,p]=O.useState(null),[f,x]=O.useState(null),[g,v]=O.useState(null),[y,j]=O.useState([]),[b,N]=O.useState("0.0000 WAX"),[w,k]=O.useState(new Set),[_,S]=O.useState(!1),[C,A]=O.useState(!1),[T,P]=O.useState(null),[E,I]=O.useState([]),[$,L]=O.useState(null),[M,R]=O.useState("all"),[W,D]=O.useState("all"),[U,z]=O.useState({start:"",end:""}),[X,H]=O.useState(""),[q,J]=O.useState(1),[V]=O.useState(10),[G,Y]=O.useState("date"),[Q,Z]=O.useState("desc"),[ee,te]=O.useState(!1),[ae,se]=O.useState(!1),[ne,ie]=O.useState(null),[re,le]=O.useState(null),[oe,ce]=O.useState({isOpen:!1,resourceType:"cpu",action:"stake"}),[de,ue]=O.useState({isOpen:!1,action:"buy"}),[he,me]=O.useState({isOpen:!1,token:null}),[pe,fe]=O.useState(e||""),[xe,ge]=O.useState(100),[ve,ye]=O.useState(0),[je,be]=O.useState(!1),[,Ne]=(()=>{const{account:e,session:t}=Fe(),[a,s]=O.useState(null),[n,i]=O.useState(!1);return[a,O.useCallback(async(a=null)=>{if(!t&&!a)return void De.warn("No wallet session or account name provided");const n=a||e;if(n){i(!0);try{const{apiService:e}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),t=await e.getWaxAccountInfo(n);if(!t)throw new Error("Failed to fetch account resources: No data returned");const a={account_name:n,cpu_limit:{used:t.cpu_limit?.used||0,available:t.cpu_limit?.available||0,max:t.cpu_limit?.max||0},net_limit:{used:t.net_limit?.used||0,available:t.net_limit?.available||0,max:t.net_limit?.max||0},ram_usage:t.ram_usage||0,ram_quota:t.ram_quota||0,total_resources:t.total_resources||{},self_delegated_bandwidth:t.self_delegated_bandwidth||{},refund_request:t.refund_request||null,voter_info:t.voter_info||null};s(a),De.info("Account resources fetched:",a)}catch(T){De.error("Error fetching account resources:",T),s(null)}finally{i(!1)}}else De.warn("No target account found")},[t,e]),n]})(),[we,ke]=(()=>{const[e,t]=O.useState(null),[a,s]=O.useState(!1);return[e,O.useCallback(async()=>{s(!0);try{const{apiService:e}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),a=await e.getPowerupState();if(a.rows&&a.rows.length>0){const e=a.rows[0],s={version:e.version||0,net:{version:e.net?.version||0,weight:e.net?.weight||"0",weight_ratio:e.net?.weight_ratio||"0",assumed_stake_weight:e.net?.assumed_stake_weight||"0",initial_weight_ratio:e.net?.initial_weight_ratio||"0",target_weight_ratio:e.net?.target_weight_ratio||"0",initial_timestamp:e.net?.initial_timestamp||"",target_timestamp:e.net?.target_timestamp||"",exponent:e.net?.exponent||2,decay_secs:e.net?.decay_secs||86400,min_price:e.net?.min_price||"0",max_price:e.net?.max_price||"0",utilization:e.net?.utilization||"0",adjusted_utilization:e.net?.adjusted_utilization||"0",utilization_timestamp:e.net?.utilization_timestamp||""},cpu:{version:e.cpu?.version||0,weight:e.cpu?.weight||"0",weight_ratio:e.cpu?.weight_ratio||"0",assumed_stake_weight:e.cpu?.assumed_stake_weight||"0",initial_weight_ratio:e.cpu?.initial_weight_ratio||"0",target_weight_ratio:e.cpu?.target_weight_ratio||"0",initial_timestamp:e.cpu?.initial_timestamp||"",target_timestamp:e.cpu?.target_timestamp||"",exponent:e.cpu?.exponent||2,decay_secs:e.cpu?.decay_secs||86400,min_price:e.cpu?.min_price||"0",max_price:e.cpu?.max_price||"0",utilization:e.cpu?.utilization||"0",adjusted_utilization:e.cpu?.adjusted_utilization||"0",utilization_timestamp:e.cpu?.utilization_timestamp||""},powerup_days:e.powerup_days||1,min_powerup_fee:e.min_powerup_fee||"0.0001 WAX"};t(s)}else console.warn("No powerup state data found"),t(null)}catch(T){console.error("Error fetching powerup state:",T),t(null)}finally{s(!1)}},[]),a]})(),[_e,Ce]=(()=>{const[e,t]=O.useState(null),[a,s]=O.useState(!1);return[e,O.useCallback(async()=>{s(!0);try{const{apiService:e}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),a=await e.getChainInfo(),s={server_version:a.server_version||"",chain_id:a.chain_id||"",head_block_num:a.head_block_num||0,last_irreversible_block_num:a.last_irreversible_block_num||0,last_irreversible_block_id:a.last_irreversible_block_id||"",head_block_id:a.head_block_id||"",head_block_time:a.head_block_time||"",head_block_producer:a.head_block_producer||"",virtual_block_cpu_limit:a.virtual_block_cpu_limit||0,virtual_block_net_limit:a.virtual_block_net_limit||0,block_cpu_limit:a.block_cpu_limit||0,block_net_limit:a.block_net_limit||0,server_version_string:a.server_version_string||"",fork_db_head_block_num:a.fork_db_head_block_num||0,fork_db_head_block_id:a.fork_db_head_block_id||""};t(s)}catch(T){console.error("Error fetching chain info:",T),t(null)}finally{s(!1)}},[]),a]})(),Ae=O.useCallback(async()=>{if(De.debug("loadTransactions called with account","UserProfile",{account:e}),se(!0),ie(null),!e){De.debug("No account connected, using test account","UserProfile");const e="pixeljourney";try{De.debug("Fetching transactions for test account","UserProfile",{testAccount:e});const t=await dt.getUserTransactions(e,20);if(De.debug("Test transactions fetched","UserProfile",{count:t?.length||0,sample:t?.slice(0,2)}),t&&0!==t.length){const e=t.map(e=>({...e,type:e.type,status:e.status||"completed"}));d(e)}else De.warn("No test transactions returned","UserProfile"),d([])}catch(t){De.error("Error loading test transactions","UserProfile",t,{name:t instanceof Error?t.name:"Unknown",message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0});const e=t instanceof Error?t.message:"Unable to load transaction history. Please try again later.";ie(e),n("Transaction Error",e)}finally{se(!1)}return}try{De.debug("Loading transactions for connected account","UserProfile",{account:e,apiServiceAvailable:!!dt,getUserTransactionsType:typeof dt.getUserTransactions});const t=await dt.getUserTransactions(e,20);if(De.debug("Fetched transactions","UserProfile",{count:t?.length||0,sample:t?.slice(0,2)}),t&&0!==t.length){const e=t.map(e=>({...e,type:e.type,status:e.status||"completed"}));d(e)}else De.warn("No transactions returned from API","UserProfile"),d([])}catch(t){De.error("Error loading transactions","UserProfile",t,{name:t instanceof Error?t.name:"Unknown",message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0});const e=t instanceof Error?t.message:"Unable to load transaction history. Please try again later.";ie(e),n("Transaction Error",e)}finally{se(!1)}},[e,n]),Te=O.useCallback(async()=>{if(e)try{const t=await dt.getUserStats(e);p(t),t.favoriteCollections.length>0&&Ve(t.favoriteCollections)}catch(t){throw De.error("Error loading user stats","UserProfile",t),t}},[e]),Pe=O.useCallback(async()=>{if(e)try{const t=await dt.getWaxAccountInfo(e);t&&(x(t),t.cpu_limit&&t.net_limit&&t.ram_quota&&v({cpu:{used:t.cpu_limit.used,available:t.cpu_limit.available,max:t.cpu_limit.max},net:{used:t.net_limit.used,available:t.net_limit.available,max:t.net_limit.max},ram:{used:t.ram_usage,available:t.ram_quota-t.ram_usage,max:t.ram_quota}}))}catch(t){De.error("Failed to fetch account data","UserProfile",t),n("Account Data Error","Unable to fetch account information. Some features may not work properly.")}},[e,n]),Ee=O.useCallback(async()=>{if(e)try{const t=await dt.getUserTransactions(e,1);t&&t.length>0&&L(t[0].block_time)}catch(t){De.error("Failed to fetch last transaction date","UserProfile",t),L(null)}},[e]),Ie=O.useMemo(()=>["swap.taco","alpha.waxfun","beta.waxfun"],[]),$e=O.useMemo(()=>[{symbol:"WAX",contract:"eosio.token"},{symbol:"PXJ",contract:"pixeljourney"},{symbol:"WPIXAL",contract:"pixeljourney"},{symbol:"WUF",contract:"wuffi"},{symbol:"TLM",contract:"alien.worlds"}],[]),Le=O.useCallback(async()=>{if(e)try{const a=[],s=$e.filter(e=>!Ie.includes(e.contract));for(let n=0;n<s.length;n++){const i=s[n];try{n>0&&await ze(500);const s=await dt.getWaxCurrencyBalance(e,i.contract,i.symbol);if(s&&s.length>0){let n="N/A";const r=parseFloat(s[0].balance.split(" ")[0]);try{if("WAX"===i.symbol&&"eosio.token"===i.contract){const e=await Ke.getWaxPriceUSD();n=Re(r*e,2)}else if("WPIXAL"===i.symbol&&"pixeljourney"===i.contract){const e=await Ke.getWpixalPriceUSD();n=Re(r*e,4)}else if("PXJ"===i.symbol&&"pixeljourney"===i.contract){const e=await Ke.getPxjPriceUSD();n=Re(r*e,6)}else n="WUF"===i.symbol&&"wuffi"===i.contract?"0.00":"N/A"}catch(t){De.warn(`Failed to fetch price for ${i.symbol} in fallback`,"UserProfile",{error:t}),n="0.00"}const l={...s[0],value:n};if("WAX"===i.symbol&&"eosio.token"===i.contract)try{const t=await mt.getWaxBalance(e);N(t)}catch(t){De.warn("Failed to get WAX balance from balance service, using fallback","UserProfile",{error:t}),N(l.balance)}a.push(l)}}catch(t){De.error(`Failed to fetch ${i.symbol} balance`,"UserProfile",t)}}j(a)}catch(t){De.error("Failed to fetch token balances with fallback","UserProfile",t)}},[e,$e,Ie]),We=O.useCallback(async()=>{if(e)try{const t=await ht.checkUserBadges(e);I(t.badges)}catch(t){De.error("Failed to fetch user badges","UserProfile.fetchUserBadges",t,{account:e})}},[e]),Oe=O.useCallback(async()=>{if(e)try{const a=await dt.getLightApiBalances(e);if(a&&a.balances){const s=[],n=a.balances.filter(e=>parseFloat(e.amount)>1e-4).sort((e,t)=>parseFloat(t.amount)-parseFloat(e.amount)).sort((e,t)=>{const a=$e.some(t=>t.symbol===e.currency&&t.contract===e.contract),s=$e.some(e=>e.symbol===t.currency&&e.contract===t.contract);return a&&!s?-1:!a&&s?1:0}).filter(e=>!Ie.includes(e.contract));for(let a=0;a<n.length;a++){const i=n[a];try{a>0&&await ze(300);let n="0.00";const r=parseFloat(i.amount);try{if("WAX"===i.currency&&"eosio.token"===i.contract){const e=await Ke.getWaxPriceUSD();n=Re(r*e,2)}else if("WPIXAL"===i.currency&&"pixeljourney"===i.contract){const e=await Ke.getWpixalPriceUSD();n=Re(r*e,4)}else if("PXJ"===i.currency&&"pixeljourney"===i.contract){const e=await Ke.getPxjPriceUSD();n=Re(r*e,6)}else n="WUF"===i.currency&&"wuffi"===i.contract?"0.00":"N/A"}catch(t){De.warn(`Failed to fetch price for ${i.currency}`,"UserProfile",{error:t}),n="0.00"}const l={balance:`${i.amount} ${i.currency}`,symbol:i.currency,contract:i.contract,value:n};if("WAX"===i.currency&&"eosio.token"===i.contract)try{const t=await mt.getWaxBalance(e);N(t)}catch(t){De.warn("Failed to get WAX balance from balance service, using fallback","UserProfile",{error:t}),N(l.balance)}s.push(l)}catch(t){De.error(`Failed to get price for ${i.currency}`,"UserProfile",t);const e={balance:`${i.amount} ${i.currency}`,symbol:i.currency,contract:i.contract,value:"0.00"};s.push(e)}}j(s)}}catch(t){De.error("Failed to fetch token balances","UserProfile",t),await Le()}},[e,Ie,$e,Le]),Ue=O.useCallback(async()=>{if(e){A(!0),P(null);try{await Ae(),await Te(),await Oe(),await We()}catch(t){De.error("Error loading user data","UserProfile",t),P("Failed to load user data"),n("User Data Error","Unable to load user profile data. Please try refreshing the page.")}finally{A(!1)}}},[e,n,Oe,Ae,Te,We]);O.useEffect(()=>{if(t&&e){(async()=>{try{await Ue(),await Pe(),await Ee(),await ke(),await Ce(),Ne()}catch(e){De.error("Error initializing user data","UserProfile",e),n("Failed to Load User Data","Unable to initialize user profile. Please try refreshing the page."),P("Failed to load user data")}})()}},[t,e]),O.useEffect(()=>{e&&fe(e)},[e]);const Be=(e,t)=>0===t?0:e/t*100,ze=e=>new Promise(t=>setTimeout(t,e)),Xe=(e,t)=>{ce({isOpen:!0,resourceType:e,action:t})},He=e=>{ue({isOpen:!0,action:e})},qe=()=>{me({isOpen:!1,token:null})},Je=()=>{Pe()},Ve=async e=>{const t={};for(const s of e)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/collections/${s}`),a=await e.json();if(a.success&&a.data?.img){const e=a.data.img;t[s]=e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`}}catch(a){De.error(`Error fetching avatar for collection ${s}`,"UserProfile",a)}h(t)},Ge=c.filter(e=>{if("all"!==M)if("tokens"===M){if("token_send"!==e.type&&"token_receive"!==e.type)return!1}else if(e.type!==M)return!1;if(X){const t=X.toLowerCase(),a=e.asset_name?.toLowerCase().includes(t),s=e.collection_name?.toLowerCase().includes(t),n=e.transaction_id.toLowerCase().includes(t),i=e.from?.toLowerCase().includes(t),r=e.to?.toLowerCase().includes(t);if(!(a||s||n||i||r))return!1}if("all"!==W){const t=new Date(e.block_time);if("custom"===W){if(U.start&&U.end){const e=new Date(U.start),a=new Date(U.end);if(a.setHours(23,59,59,999),t<e||t>a)return!1}else if(U.start){if(t<new Date(U.start))return!1}else if(U.end){const e=new Date(U.end);if(e.setHours(23,59,59,999),t>e)return!1}}else{const e="7d"===W?7:"30d"===W?30:90;if(t<new Date((new Date).getTime()-24*e*60*60*1e3))return!1}}return!0}),Ye=[...Ge].sort((e,t)=>{let a=0;switch(G){case"date":a=new Date(e.block_time).getTime()-new Date(t.block_time).getTime();break;case"amount":a=parseFloat(e.price?.replace(" WAX","")||"0")-parseFloat(t.price?.replace(" WAX","")||"0");break;case"type":a=e.type.localeCompare(t.type)}return"desc"===Q?-a:a}),Qe=Math.ceil(Ye.length/V),Ze=(q-1)*V,et=Ye.slice(Ze,Ze+V),tt=t=>{te(!0),le(null);try{let a,s,n;if("csv"===t){const t=[["Transaction ID","Date","Type","Asset Name","Collection","Price","From","To","Status"].join(",")];Ge.forEach(e=>{const a=[e.transaction_id,e.block_time,e.type,e.asset_name||"",e.collection_name||"",e.price||"",e.from||"",e.to||"",e.status].map(e=>`"${e}"`);t.push(a.join(","))}),a=t.join("\n"),s=`transactions_${e}_${(new Date).toISOString().split("T")[0]}.csv`,n="text/csv"}else a=JSON.stringify(Ge,null,2),s=`transactions_${e}_${(new Date).toISOString().split("T")[0]}.json`,n="application/json";const i=new Blob([a],{type:n}),r=URL.createObjectURL(i),l=document.createElement("a");l.href=r,l.download=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)}catch(a){De.error("Export failed","UserProfile",a);const e=a instanceof Error?a.message:"Failed to export transactions. Please try again.";le(e),n("Export Error",e)}finally{te(!1)}};return t?Se.jsxs("div",{className:"user-profile",children:[Se.jsxs("div",{className:"profile-container",children:[Se.jsxs("div",{className:"profile-header",children:[Se.jsx("div",{className:"profile-avatar",children:Se.jsx("div",{className:"avatar-placeholder",children:e?.charAt(0).toUpperCase()})}),Se.jsxs("div",{className:"profile-info",children:[Se.jsx("h1",{children:e}),Se.jsxs("div",{className:"profile-badges",children:[E.map(e=>Se.jsxs("span",{className:`badge ${e.id}`,title:e.description,children:[e.icon," ",e.name]},e.id)),0===E.length&&Se.jsx("span",{className:"badge no-badges",children:"No badges earned yet"})]})]}),Se.jsx("div",{className:"profile-stats-quick",children:m&&Se.jsxs(Se.Fragment,{children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:m.nftsOwned}),Se.jsx("span",{className:"stat-label",children:"NFTs Owned"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:m.totalPurchases}),Se.jsx("span",{className:"stat-label",children:"Purchases"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:m.totalSales}),Se.jsx("span",{className:"stat-label",children:"Sales"})]})]})})]}),Se.jsxs("div",{className:"profile-tabs",role:"tablist","aria-label":"Profile sections",children:[Se.jsxs("div",{className:"tab-row",children:[Se.jsx("button",{className:"tab-button "+("overview"===l?"active":""),onClick:()=>o("overview"),role:"tab","aria-selected":"overview"===l,"aria-controls":"overview-panel",id:"overview-tab",children:"Overview"}),Se.jsx("button",{className:"tab-button "+("transactions"===l?"active":""),onClick:()=>o("transactions"),role:"tab","aria-selected":"transactions"===l,"aria-controls":"transactions-panel",id:"transactions-tab",children:"Transactions"}),Se.jsx("button",{className:"tab-button "+("portfolio"===l?"active":""),onClick:()=>o("portfolio"),role:"tab","aria-selected":"portfolio"===l,"aria-controls":"portfolio-panel",id:"portfolio-tab",children:"Portfolio Analytics"}),Se.jsx("button",{className:"tab-button "+("pxbadges"===l?"active":""),onClick:()=>o("pxbadges"),role:"tab","aria-selected":"pxbadges"===l,"aria-controls":"pxbadges-panel",id:"pxbadges-tab",children:"PxBadges"})]}),Se.jsxs("div",{className:"tab-row",children:[Se.jsx("button",{className:"tab-button "+("network-resources"===l?"active":""),onClick:()=>o("network-resources"),role:"tab","aria-selected":"network-resources"===l,"aria-controls":"network-resources-panel",id:"network-resources-tab",children:"Network Resources"}),Se.jsx("button",{className:"tab-button "+("powerup"===l?"active":""),onClick:()=>o("powerup"),role:"tab","aria-selected":"powerup"===l,"aria-controls":"powerup-panel",id:"powerup-tab",children:"Powerup"}),Se.jsx("button",{className:"tab-button "+("token-balances"===l?"active":""),onClick:()=>o("token-balances"),role:"tab","aria-selected":"token-balances"===l,"aria-controls":"token-balances-panel",id:"token-balances-tab",children:"Token Balances"}),Se.jsx("button",{className:"tab-button "+("swap"===l?"active":""),onClick:()=>o("swap"),role:"tab","aria-selected":"swap"===l,"aria-controls":"swap-panel",id:"swap-tab",children:"Swap"})]})]}),Se.jsxs("div",{className:"profile-content",children:[C&&Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading profile data..."})]}),T&&Se.jsxs("div",{className:"error-state",children:[Se.jsx("p",{children:T}),Se.jsx("button",{onClick:Ue,className:"retry-button",children:"Retry"})]}),!C&&!T&&Se.jsxs(Se.Fragment,{children:["overview"===l&&m&&Se.jsxs("div",{className:"overview-tab",children:[Se.jsxs("div",{className:"balance-info",children:[Se.jsxs("div",{className:"balance-item",children:[Se.jsx("span",{className:"balance-label",children:"WAX Balance:"}),Se.jsx("span",{className:"balance-value",children:b})]}),Se.jsxs("div",{className:"balance-item",children:[Se.jsx("span",{className:"balance-label",children:"USD Value:"}),Se.jsx("span",{className:"balance-value",children:"$0.00"})]})]}),Se.jsxs("div",{className:"account-info",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Account Name:"}),Se.jsx("span",{className:"info-value",children:e})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Created:"}),Se.jsx("span",{className:"info-value",children:f?.created?new Date(f.created).toLocaleDateString():"Loading..."})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Last Active:"}),Se.jsx("span",{className:"info-value",children:$?new Date($).toLocaleDateString():f?.last_code_update?new Date(f.last_code_update).toLocaleDateString():"Loading..."})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"info-label",children:"Reputation:"}),Se.jsx("span",{className:"info-value",children:m?.reputation||"\u2b50\u2b50\u2b50\u2b50\u2b50 (4.8/5)"})]})]}),Se.jsxs("div",{className:"stats-grid",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:m?.nftsOwned||0}),Se.jsx("div",{className:"stat-label",children:"NFTs Owned"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:m?.totalTransactions||0}),Se.jsx("div",{className:"stat-label",children:"Transactions"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:m?.totalEarned||"0"}),Se.jsx("div",{className:"stat-label",children:"WAX Earned"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:m?.tierStatus||"Bronze"}),Se.jsx("div",{className:"stat-label",children:"Tier Status"})]})]}),Se.jsxs("div",{className:"favorite-collections",children:[Se.jsx("h3",{children:"Favorite Collections"}),Se.jsx("div",{className:"collections-list",children:m.favoriteCollections.map((e,t)=>Se.jsxs("div",{className:"collection-item",children:[Se.jsxs("div",{className:"user-collection-avatar",children:[u[e]?Se.jsx("img",{src:u[e],alt:`${e} avatar`,onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}):null,Se.jsx("div",{className:"fallback-avatar",style:{display:u[e]?"none":"flex"},children:e.charAt(0).toUpperCase()})]}),Se.jsx("span",{className:"collection-name",children:e})]},t))})]})]}),"transactions"===l&&Se.jsxs("div",{className:"transactions-tab",children:[!t&&Se.jsx("div",{className:"wallet-connection-prompt",children:Se.jsxs("div",{className:"prompt-content",children:[Se.jsx("h3",{children:"\ud83d\udd17 Connect Your Wallet"}),Se.jsx("p",{children:"Connect your WAX wallet to view your personal transaction history and account details."}),Se.jsx("button",{className:"connect-wallet-btn",onClick:s,children:"Connect Wallet"}),Se.jsx("div",{className:"demo-notice",children:Se.jsxs("p",{children:["\ud83d\udcca Currently showing demo data from account: ",Se.jsx("strong",{children:"pixeljourney"})]})})]})}),Se.jsxs("div",{className:"quick-filters",children:[Se.jsx("button",{className:"filter-btn "+("all"===M?"active":""),onClick:()=>R("all"),children:"\ud83d\udd0d All Activity"}),Se.jsx("button",{className:"filter-btn "+("purchase"===M?"active":""),onClick:()=>R("purchase"),children:"\ud83d\uded2 Purchases"}),Se.jsx("button",{className:"filter-btn "+("sale"===M?"active":""),onClick:()=>R("sale"),children:"\ud83d\udcb0 Sales"}),Se.jsx("button",{className:"filter-btn "+("transfer"===M?"active":""),onClick:()=>R("transfer"),children:"\ud83d\udd04 Transfers"}),Se.jsx("button",{className:"filter-btn "+("tokens"===M?"active":""),onClick:()=>R("tokens"),children:"\ud83d\udcb8 Tokens"})]}),Se.jsxs("div",{className:"transactions-header",children:[Se.jsxs("div",{className:"transactions-stats",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:Ye.length}),Se.jsx("span",{className:"stat-label",children:"Total Found"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:c.length}),Se.jsx("span",{className:"stat-label",children:"All Transactions"})]})]}),Se.jsxs("div",{className:"transactions-actions",children:[Se.jsxs("button",{className:"export-btn",onClick:()=>tt("csv"),disabled:ee||0===Ge.length,children:[ee?"\u23f3":"\ud83d\udcca"," Export CSV"]}),Se.jsxs("button",{className:"export-btn",onClick:()=>tt("json"),disabled:ee||0===Ge.length,children:[ee?"\u23f3":"\ud83d\udcc4"," Export JSON"]})]})]}),Se.jsxs("div",{className:"transactions-controls",children:[Se.jsx("div",{className:"search-section",children:Se.jsxs("div",{className:"search-input-wrapper",children:[Se.jsx("input",{type:"text",placeholder:"Search by asset name, collection, transaction ID, or address...",value:X,onChange:e=>{H(e.target.value),J(1)},className:"search-input"}),Se.jsx("span",{className:"search-icon",children:"\ud83d\udd0d"})]})}),Se.jsxs("div",{className:"filters-section",children:[Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{children:"Type:"}),Se.jsxs("select",{value:M,onChange:e=>{R(e.target.value),J(1)},className:"filter-select",children:[Se.jsx("option",{value:"all",children:"All Types"}),Se.jsx("option",{value:"purchase",children:"\ud83d\uded2 Purchases"}),Se.jsx("option",{value:"sale",children:"\ud83d\udcb0 Sales"}),Se.jsx("option",{value:"transfer",children:"\ud83d\udd04 Transfers"}),Se.jsx("option",{value:"tokens",children:"\ud83d\udcb8 Token Transactions"})]})]}),Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{children:"Date:"}),Se.jsxs("select",{value:W,onChange:e=>{D(e.target.value),J(1)},className:"filter-select",children:[Se.jsx("option",{value:"7d",children:"Last 7 days"}),Se.jsx("option",{value:"30d",children:"Last 30 days"}),Se.jsx("option",{value:"90d",children:"Last 90 days"}),Se.jsx("option",{value:"all",children:"All time"}),Se.jsx("option",{value:"custom",children:"\ud83d\udcc5 Custom Range"})]}),"custom"===W&&Se.jsxs("div",{className:"custom-date-range",children:[Se.jsxs("div",{className:"date-input-group",children:[Se.jsx("label",{children:"From:"}),Se.jsx("input",{type:"date",className:"date-input",value:U.start,onChange:e=>{z(t=>({...t,start:e.target.value})),J(1)}})]}),Se.jsxs("div",{className:"date-input-group",children:[Se.jsx("label",{children:"To:"}),Se.jsx("input",{type:"date",className:"date-input",value:U.end,onChange:e=>{z(t=>({...t,end:e.target.value})),J(1)}})]})]})]}),Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{children:"Sort:"}),Se.jsxs("select",{value:`${G}-${Q}`,onChange:e=>{const[t,a]=e.target.value.split("-");Y(t),Z(a)},className:"filter-select",children:[Se.jsx("option",{value:"date-desc",children:"\ud83d\udcc5 Newest First"}),Se.jsx("option",{value:"date-asc",children:"\ud83d\udcc5 Oldest First"}),Se.jsx("option",{value:"amount-desc",children:"\ud83d\udcb0 Highest Amount"}),Se.jsx("option",{value:"amount-asc",children:"\ud83d\udcb0 Lowest Amount"}),Se.jsx("option",{value:"type-asc",children:"\ud83d\udd24 Type A-Z"}),Se.jsx("option",{value:"type-desc",children:"\ud83d\udd24 Type Z-A"})]})]})]})]}),ae&&Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner",children:"\u23f3"}),Se.jsx("h3",{children:"Loading Transactions..."}),Se.jsx("p",{children:"Fetching your transaction history from the blockchain."})]}),ne&&!ae&&Se.jsxs("div",{className:"error-state",children:[Se.jsx("div",{className:"error-icon",children:"\u274c"}),Se.jsx("h3",{children:"Failed to Load Transactions"}),Se.jsx("p",{children:ne}),Se.jsx("button",{className:"retry-btn",onClick:()=>Ae(),children:"\ud83d\udd04 Retry"})]}),re&&Se.jsxs("div",{className:"export-error",children:[Se.jsxs("span",{className:"error-text",children:["Export failed: ",re]}),Se.jsx("button",{className:"dismiss-error-btn",onClick:()=>le(null),children:"\u2715"})]}),Se.jsx("div",{className:"transactions-list",children:ae||ne||0!==et.length?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"transactions-grid",children:et.map(t=>{return Se.jsxs("div",{className:"transaction-card",children:[Se.jsxs("div",{className:"transaction-header",children:[Se.jsxs("div",{className:"transaction-icon",children:["purchase"===t.type&&"\ud83d\uded2","sale"===t.type&&"\ud83d\udcb0","transfer"===t.type&&"\ud83d\udd04","token_send"===t.type&&"\ud83d\udce4","token_receive"===t.type&&"\ud83d\udce5","mint"===t.type&&"\u2728"]}),Se.jsx("div",{className:"transaction-type-badge",children:Se.jsx("span",{className:`type-badge ${t.type}`,children:t.type.charAt(0).toUpperCase()+t.type.slice(1).replace("_"," ")})}),Se.jsx("div",{className:"transaction-status",children:Se.jsxs("span",{className:`status-badge ${t.status}`,children:["completed"===t.status&&"\u2705","pending"===t.status&&"\u23f3","failed"===t.status&&"\u274c"]})})]}),Se.jsxs("div",{className:"transaction-content",children:[Se.jsxs("div",{className:"asset-info",children:[Se.jsx("h4",{className:"asset-name",children:t.asset_name||"Unknown Asset"}),t.collection_name&&Se.jsx("span",{className:"collection-name",children:t.collection_name})]}),t.price&&Se.jsx("div",{className:"transaction-amount",children:Se.jsxs("span",{className:"amount "+("sale"===t.type||"token_receive"===t.type?"positive":"negative"),children:["sale"===t.type||"token_receive"===t.type?"+":"-",(s=t.price,Me(parseFloat(s.replace(" WAX",""))))]})}),Se.jsxs("div",{className:"transaction-meta",children:[Se.jsxs("div",{className:"meta-row",children:[Se.jsx("span",{className:"meta-label",children:"Date:"}),Se.jsx("span",{className:"meta-value",children:(a=t.block_time,new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),t.from&&t.from!==e&&Se.jsxs("div",{className:"meta-row",children:[Se.jsx("span",{className:"meta-label",children:"From:"}),Se.jsx("span",{className:"meta-value address",children:t.from})]}),t.to&&t.to!==e&&Se.jsxs("div",{className:"meta-row",children:[Se.jsx("span",{className:"meta-label",children:"To:"}),Se.jsx("span",{className:"meta-value address",children:t.to})]}),Se.jsxs("div",{className:"meta-row",children:[Se.jsx("span",{className:"meta-label",children:"TX ID:"}),Se.jsxs("span",{className:"meta-value transaction-id-link",onClick:()=>r(`/transactions/${t.transaction_id}`),title:"View transaction details",children:[t.transaction_id.slice(0,12),"..."]})]}),t.memo&&Se.jsxs("div",{className:"meta-row",children:[Se.jsx("span",{className:"meta-label",children:"Memo:"}),Se.jsx("span",{className:"meta-value memo",children:t.memo})]})]})]})]},t.transaction_id);var a,s})}),Qe>1&&Se.jsxs("div",{className:"pagination",children:[Se.jsx("div",{className:"pagination-info",children:Se.jsxs("span",{children:["Showing ",Ze+1,"-",Math.min(Ze+V,Ye.length)," of ",Ye.length," transactions"]})}),Se.jsxs("div",{className:"pagination-controls",children:[Se.jsx("button",{className:"pagination-btn",onClick:()=>J(1),disabled:1===q,title:"First page",children:"\u23ee\ufe0f"}),Se.jsx("button",{className:"pagination-btn",onClick:()=>J(q-1),disabled:1===q,title:"Previous page",children:"\u23ea"}),Se.jsx("div",{className:"page-numbers",children:Array.from({length:Math.min(5,Qe)},(e,t)=>{let a;return a=Qe<=5||q<=3?t+1:q>=Qe-2?Qe-4+t:q-2+t,Se.jsx("button",{className:"page-number "+(q===a?"active":""),onClick:()=>J(a),children:a},a)})}),Se.jsx("button",{className:"pagination-btn",onClick:()=>J(q+1),disabled:q===Qe,title:"Next page",children:"\u23e9"}),Se.jsx("button",{className:"pagination-btn",onClick:()=>J(Qe),disabled:q===Qe,title:"Last page",children:"\u23ed\ufe0f"})]})]})]}):Se.jsxs("div",{className:"no-transactions",children:[Se.jsx("div",{className:"no-transactions-icon",children:"\ud83d\udced"}),Se.jsx("h3",{children:"No transactions found"}),Se.jsx("p",{children:X?`No transactions match your search "${X}"`:"No transactions found for the selected filters."}),(X||"all"!==M||"all"!==W)&&Se.jsx("button",{className:"clear-filters-btn",onClick:()=>{H(""),R("all"),D("all"),z({start:"",end:""}),J(1)},children:"Clear All Filters"})]})})]}),"portfolio"===l&&Se.jsx("div",{className:"portfolio-tab",children:Se.jsx(xs,{})}),"pxbadges"===l&&Se.jsx(bs,{}),"network-resources"===l&&Se.jsxs("div",{className:"network-resources-tab",children:[Se.jsxs("div",{className:"resources-header",children:[Se.jsx("h2",{children:"Network Resources"}),Se.jsx("p",{children:"Manage your WAX account resources (CPU, NET, RAM)"})]}),Se.jsxs("div",{className:"resources-grid",children:[Se.jsxs("div",{className:"resource-card cpu",children:[Se.jsxs("div",{className:"resource-header",children:[Se.jsx("div",{className:"resource-icon",children:"\u26a1"}),Se.jsxs("div",{className:"resource-info",children:[Se.jsx("h3",{children:"CPU"}),Se.jsx("p",{children:"Processing power for transactions"})]})]}),Se.jsxs("div",{className:"resource-stats",children:[Se.jsx("div",{className:"usage-bar",children:Se.jsx("div",{className:"usage-fill cpu",style:{width:g?g.cpu.used/g.cpu.max*100+"%":"45%"}})}),Se.jsx("div",{className:"usage-text",children:g?`${(g.cpu.used/g.cpu.max*100).toFixed(1)}% used (${(g.cpu.used/1e3).toFixed(1)}ms / ${(g.cpu.max/1e3).toFixed(1)}ms)`:"45% used (4.5ms / 10ms)"})]}),Se.jsxs("div",{className:"resource-actions",children:[Se.jsx("button",{className:"stake-btn",onClick:()=>Xe("cpu","stake"),children:"Stake CPU"}),Se.jsx("button",{className:"unstake-btn",onClick:()=>Xe("cpu","unstake"),children:"Unstake CPU"})]})]}),Se.jsxs("div",{className:"resource-card net",children:[Se.jsxs("div",{className:"resource-header",children:[Se.jsx("div",{className:"resource-icon",children:"\ud83c\udf10"}),Se.jsxs("div",{className:"resource-info",children:[Se.jsx("h3",{children:"NET"}),Se.jsx("p",{children:"Network bandwidth for transactions"})]})]}),Se.jsxs("div",{className:"resource-stats",children:[Se.jsx("div",{className:"usage-bar",children:Se.jsx("div",{className:"usage-fill net",style:{width:g?g.net.used/g.net.max*100+"%":"30%"}})}),Se.jsx("div",{className:"usage-text",children:g?`${(g.net.used/g.net.max*100).toFixed(1)}% used (${(g.net.used/1024).toFixed(1)}KB / ${(g.net.max/1024).toFixed(1)}KB)`:"30% used (3KB / 10KB)"})]}),Se.jsxs("div",{className:"resource-actions",children:[Se.jsx("button",{className:"stake-btn",onClick:()=>Xe("net","stake"),children:"Stake NET"}),Se.jsx("button",{className:"unstake-btn",onClick:()=>Xe("net","unstake"),children:"Unstake NET"})]})]}),Se.jsxs("div",{className:"resource-card ram",children:[Se.jsxs("div",{className:"resource-header",children:[Se.jsx("div",{className:"resource-icon",children:"\ud83d\udcbe"}),Se.jsxs("div",{className:"resource-info",children:[Se.jsx("h3",{children:"RAM"}),Se.jsx("p",{children:"Storage space for account data"})]})]}),Se.jsxs("div",{className:"resource-stats",children:[Se.jsx("div",{className:"usage-bar",children:Se.jsx("div",{className:"usage-fill ram",style:{width:g?g.ram.used/g.ram.max*100+"%":"65%"}})}),Se.jsx("div",{className:"usage-text",children:g?`${(g.ram.used/g.ram.max*100).toFixed(1)}% used (${(g.ram.used/1024).toFixed(1)}KB / ${(g.ram.max/1024).toFixed(1)}KB)`:"65% used (6.5KB / 10KB)"})]}),Se.jsxs("div",{className:"resource-actions",children:[Se.jsx("button",{className:"buy-ram-btn",onClick:()=>He("buy"),children:"Buy RAM"}),Se.jsx("button",{className:"sell-ram-btn",onClick:()=>He("sell"),children:"Sell RAM"})]})]})]})]}),"powerup"===l&&Se.jsxs("div",{className:"powerup-tab",children:[Se.jsxs("div",{className:"powerup-header",children:[Se.jsx("h2",{children:"Powerup Resources"}),Se.jsx("p",{children:"Boost your account resources for 24 hours"})]}),Se.jsx("div",{className:"powerup-stats",children:Se.jsxs("div",{className:"current-usage",children:[Se.jsx("h3",{children:"Current Resource Usage"}),Se.jsxs("div",{className:"usage-grid",children:[Se.jsxs("div",{className:"usage-item",children:[Se.jsx("span",{className:"usage-label",children:"CPU:"}),Se.jsx("div",{className:"usage-bar",children:Se.jsx("div",{className:"usage-fill",style:{width:g?`${Be(g.cpu.used,g.cpu.max)}%`:"0%"}})}),Se.jsx("span",{className:"usage-percent",children:g?`${Be(g.cpu.used,g.cpu.max).toFixed(1)}%`:"0%"})]}),Se.jsxs("div",{className:"usage-item",children:[Se.jsx("span",{className:"usage-label",children:"NET:"}),Se.jsx("div",{className:"usage-bar",children:Se.jsx("div",{className:"usage-fill",style:{width:g?`${Be(g.net.used,g.net.max)}%`:"0%"}})}),Se.jsx("span",{className:"usage-percent",children:g?`${Be(g.net.used,g.net.max).toFixed(1)}%`:"0%"})]})]})]})}),Se.jsxs("div",{className:"powerup-form",children:[Se.jsxs("div",{className:"form-section",children:[Se.jsx("label",{children:"Account to Boost:"}),Se.jsx("input",{type:"text",placeholder:"Enter account name",value:pe,onChange:e=>fe(e.target.value)})]}),Se.jsxs("div",{className:"form-section",children:[Se.jsx("label",{children:"WAX Amount to Spend:"}),Se.jsxs("div",{className:"amount-input-container",children:[Se.jsx("input",{type:"number",placeholder:"0.0000",value:ve||"",onChange:e=>{const t=e.target.value;if((""===t||/^\d*\.?\d*$/.test(t))&&(""===t||!isNaN(Number(t)))){if(""!==t){const e=parseFloat(b.split(" ")[0]);if(Number(t)>e)return}ye(Number(t))}},step:"0.0001",min:"0",max:parseFloat(b.split(" ")[0])}),Se.jsx("span",{className:"wax-label",children:"WAX"})]}),Se.jsxs("div",{className:"slider-container",children:[Se.jsx("input",{type:"range",min:"0",max:"100",value:parseFloat(b.split(" ")[0])>0?ve/parseFloat(b.split(" ")[0])*100:0,onChange:e=>{const t=Number(e.target.value),a=parseFloat(b.split(" ")[0]),s=Number(a*t/100).toFixed(8);ye(Number(s))},className:"slider"}),Se.jsxs("div",{className:"slider-value",children:[Me(ve)," (Max: ",b,")"]})]})]}),Se.jsxs("div",{className:"form-section",children:[Se.jsxs("label",{children:["CPU/NET Ratio: ",xe,"% CPU / ",100-xe,"% NET"]}),Se.jsxs("div",{className:"progress-container",children:[Se.jsxs("div",{className:"progress-bar-container",children:[Se.jsx("div",{className:"progress-bar cpu",style:{width:`${xe}%`}}),Se.jsx("div",{className:"progress-bar net",style:{width:100-xe+"%"}})]}),Se.jsxs("div",{className:"progress-text",children:[Se.jsxs("span",{className:"cpu-text",children:[xe,"% CPU"]}),Se.jsx("span",{className:"separator",children:" / "}),Se.jsxs("span",{className:"net-text",children:[100-xe,"% NET"]})]})]}),Se.jsx("div",{className:"slider-container",children:Se.jsx("input",{type:"range",min:"0",max:"100",value:xe,onChange:e=>{const t=Number(e.target.value);ge(t)},className:"slider"})})]}),ve>0&&we&&_e&&Se.jsxs("div",{className:"powerup-estimation",children:[Se.jsx("h4",{children:"Estimated Boost (24 hours):"}),Se.jsxs("div",{className:"boost-details",children:[Se.jsxs("div",{className:"boost-item",children:[Se.jsx("span",{children:"CPU:"}),Se.jsx("span",{children:js(vs(ve,xe),ys(ve,xe),we?.cpu,we?.net,_e)})]}),Se.jsxs("div",{className:"boost-item",children:[Se.jsx("span",{children:"NET:"}),Se.jsx("span",{children:(at=F(vs(ve,xe),ys(ve,xe),we?.cpu,we?.net).netAmount,!at||at<=0?"0 bytes":at>=1048576?`${(at/1048576).toFixed(2)} MB`:at>=1024?`${(at/1024).toFixed(2)} KB`:`${at} bytes`)})]})]}),Se.jsxs("div",{className:"cost-info",children:[Se.jsxs("div",{className:"cost-item",children:[Se.jsx("span",{children:"CPU Cost:"}),Se.jsxs("span",{children:[F(vs(ve,xe),ys(ve,xe),we?.cpu,we?.net).cpuFee.toFixed(8)," WAX"]})]}),Se.jsxs("div",{className:"cost-item",children:[Se.jsx("span",{children:"NET Cost:"}),Se.jsxs("span",{children:[F(vs(ve,xe),ys(ve,xe),we?.cpu,we?.net).netFee.toFixed(8)," WAX"]})]})]})]}),Se.jsx("button",{className:"powerup-btn",disabled:!ve||ve<=0||!pe||je,onClick:()=>{if(ve>0&&pe&&a){const e=vs(ve,xe),t=ys(ve,xe);(async(e,t,a,s,n,i,r,l,o)=>{if(i(!0),r("Awaiting confirmation..."),null==localStorage.getItem("wharf--session"))return void r("You are not logged in. Click the wallet icon in the top menu");const c=o;let d=`${Number(a).toFixed(8)} WAX`;const u=[{account:"waxdao",name:"powerup",authorization:[c.permissionLevel],data:{}},{account:"eosio",name:"powerup",authorization:[c.permissionLevel],data:{payer:c.actor,receiver:t,days:1,net_frac:parseFloat(n).toFixed(0),cpu_frac:parseFloat(s).toFixed(0),max_payment:d}}];try{await c.transact({actions:u},gs),l(!0),r("Processing transaction...");const a=setTimeout(()=>{r(`${t} has been boosted with ${d}`),e(e=>!e),l(!1)},3e3);return()=>clearTimeout(a)}catch(h){De.error("Powerup transaction error:",h),r(h.message)}})(pe,ve,e,t,be,a)}},children:je?"Processing...":"Boost Resources"})]})]}),"token-balances"===l&&Se.jsxs("div",{className:"token-balances-tab",children:[Se.jsxs("div",{className:"balances-header",children:[Se.jsx("h2",{children:"Token Balances"}),Se.jsx("p",{children:"View your token balances with USD values"}),Se.jsxs("div",{className:"balance-summary",children:[Se.jsxs("div",{className:"balance-summary-item",children:[Se.jsx("span",{className:"balance-summary-label",children:"Total Tokens:"}),Se.jsx("span",{className:"balance-summary-value",children:y.length})]}),Se.jsxs("div",{className:"balance-summary-item",children:[Se.jsx("span",{className:"balance-summary-label",children:"With USD Values:"}),Se.jsx("span",{className:"balance-summary-value",children:y.filter(e=>"N/A"!==e.value&&"0.00"!==e.value).length})]})]})]}),Se.jsxs("div",{className:"balances-controls",children:[Se.jsxs("div",{className:"search-sort",children:[Se.jsx("input",{type:"text",placeholder:"Search tokens...",className:"search-input"}),Se.jsxs("select",{className:"sort-select",children:[Se.jsx("option",{value:"balance",children:"Sort by Balance"}),Se.jsx("option",{value:"value",children:"Sort by Value"}),Se.jsx("option",{value:"name",children:"Sort by Name"})]})]}),Se.jsxs("div",{className:"bulk-actions",children:[Se.jsx("button",{className:"select-all-btn",onClick:()=>{if(w.size===y.length)k(new Set);else{const e=y.map((e,t)=>t.toString());k(new Set(e))}},children:w.size===y.length?"Deselect All":"Select All"}),Se.jsxs("span",{className:"selected-info",children:[w.size," selected"]}),Se.jsx("button",{className:"bulk-sell-btn",onClick:async()=>{if(0!==w.size&&e){S(!0);try{const e=Array.from(w).map(e=>y[parseInt(e)]).filter(e=>"PXJ"!==e.symbol);if(0===e.length)return void n("Invalid Selection","No valid tokens selected for swap (PXJ cannot be swapped for itself)");let a=0;const s=[];for(const n of e)try{const e=parseFloat(n.balance.split(" ")[0]),t=await dt.getAlcorSwapQuote({from_token:n.symbol,from_contract:n.contract,to_token:"PXJ",to_contract:"pixeljourney",amount:e.toString(),slippage:.5});t&&parseFloat(t.output.amount)>0?(s.push({token:n.symbol,amount:e,pxjReceived:parseFloat(t.output.amount),success:!0}),a+=parseFloat(t.output.amount)):s.push({token:n.symbol,amount:e,pxjReceived:0,success:!1,error:"No liquidity available"})}catch(t){De.error(`Failed to get swap quote for ${n.symbol}`,"UserProfile",t),s.push({token:n.symbol,amount:parseFloat(n.balance.split(" ")[0]),pxjReceived:0,success:!1,error:"Swap quote failed"})}const r=s.filter(e=>e.success),l=s.filter(e=>!e.success);let o="Bulk Sell Summary:\n\n";r.length>0&&(o+=`Successful swaps (${r.length}):\n`,r.forEach(e=>{o+=`\u2022 ${e.amount} ${e.token} \u2192 ${e.pxjReceived.toFixed(8)} PXJ\n`}),o+=`\nTotal PXJ received: ${a.toFixed(8)} PXJ\n`),l.length>0&&(o+=`\nFailed swaps (${l.length}):\n`,l.forEach(e=>{o+=`\u2022 ${e.amount} ${e.token} - ${e.error}\n`})),o+="\nNote: This is a preview. Actual swaps would require wallet confirmation.",i("Bulk Sell Summary",o),k(new Set),r.length>0&&await Oe()}catch(t){De.error("Bulk sell failed","UserProfile",t),n("Bulk Sell Failed","Bulk sell failed. Please try again.")}finally{S(!1)}}},disabled:0===w.size||_,children:_?"Processing...":"Bulk Sell into PXJ "+(w.size>0?`(${w.size})`:"(Coming Soon)")})]})]}),Se.jsx("div",{className:"token-balances-grid",children:0===y.length?Se.jsxs("div",{className:"no-tokens-message",children:[Se.jsx("div",{className:"no-tokens-icon",children:"\ud83e\ude99"}),Se.jsx("h3",{children:"No Token Balances Found"}),Se.jsx("p",{children:"Your account doesn't have any token balances or they're still loading."})]}):y.map((e,t)=>Se.jsxs("div",{className:"token-balance-card",children:[Se.jsxs("div",{className:"token-header",children:[Se.jsx("div",{className:"token-icon",children:"\ud83e\ude99"}),Se.jsxs("div",{className:"token-details",children:[Se.jsx("h3",{children:e.symbol}),Se.jsx("p",{className:"token-contract",children:e.contract})]})]}),Se.jsxs("div",{className:"token-amounts",children:[Se.jsxs("div",{className:"token-balance",children:[Se.jsx("span",{className:"balance-label",children:"Balance:"}),Se.jsx("span",{className:"balance-value",children:e.balance})]}),Se.jsxs("div",{className:"token-usd-value",children:[Se.jsx("span",{className:"usd-label",children:"USD Value:"}),Se.jsx("span",{className:"usd-value "+("N/A"===e.value?"unavailable":"0.00"===e.value?"zero":"available"),children:"N/A"===e.value?"N/A":`$${e.value}`})]})]}),Se.jsxs("div",{className:"token-actions",children:[Se.jsx("button",{className:"token-action-btn transfer",onClick:()=>(e=>{me({isOpen:!0,token:e})})(e),children:"Transfer"}),Se.jsx("button",{className:"token-action-btn trade",disabled:!0,children:"Trade"})]})]},`${e.contract}-${e.symbol}-${t}`))})]}),"swap"===l&&Se.jsxs("div",{className:"swap-tab",children:[Se.jsxs("div",{className:"swap-tab-header",children:[Se.jsx("h2",{children:"Token Swap"}),Se.jsx("p",{children:"Swap tokens directly using Alcor DEX integration"})]}),Se.jsx(Is,{})]})]})]})]}),Se.jsx(ms,{isOpen:oe.isOpen,onClose:()=>{ce({isOpen:!1,resourceType:"cpu",action:"stake"})},resourceType:oe.resourceType,action:oe.action,onSuccess:Je}),Se.jsx(ps,{isOpen:de.isOpen,onClose:()=>{ue({isOpen:!1,action:"buy"})},action:de.action,onSuccess:Je}),Se.jsx(fs,{isOpen:he.isOpen,onClose:qe,token:he.token,onSuccess:()=>{Pe(),qe()}})]}):Se.jsx("div",{className:"user-profile",children:Se.jsx("div",{className:"profile-container",children:Se.jsxs("div",{className:"not-connected",children:[Se.jsx("div",{className:"not-connected-icon",children:"\ud83d\udd12"}),Se.jsx("h2",{children:"Connect Your Wallet"}),Se.jsx("p",{children:"Please connect your wallet to view your profile and transaction history."})]})})});var at},$s=()=>{const{account:e}=X(),[t]=H(),a=B(),s=e||t.get("user"),[n,i]=O.useState(null),[r,l]=O.useState(null),[o,c]=O.useState(null),[d,u]=O.useState("0.0000"),[h,m]=O.useState([]),[p,f]=O.useState(null),[x,g]=O.useState(!1),[v,y]=O.useState(null),[j,b]=O.useState(null),[N,w]=O.useState(!1),[k,_]=O.useState({}),[S,C]=O.useState(1),[A,T]=O.useState("all"),[P,E]=O.useState([]),[I,F]=O.useState({Body:"",Eyes:"",Head:"",Mouth:"",WaxRock:"",PixelPet:"",Background:"","Hats and Hair":"","Glasses and Masks":"","Special Accessories":""}),[$,L]=O.useState({}),M=O.useCallback(async e=>{try{const a=["token.pxj","eosio.token"],s=[];for(const n of a)try{const t=await dt.getWaxCurrencyBalance(e,n),a=await Promise.all(t.map(async e=>({...e,contract:n,value:await U(e.balance,e.symbol)})));s.push(...a)}catch(t){De.error(`Failed to fetch balance for ${n}:`,"UserProfileLookup.fetchTokenBalances",t)}m(s)}catch(t){De.error("Error fetching token balances:","UserProfileLookup.fetchTokenBalances",t)}},[]),R=O.useCallback(async()=>{if(s){g(!0),y(null);try{const e=await dt.getUserInventory(s),t=[...new Set(e.map(e=>e.collection))],a=await ht.checkUserBadges(s);E(a.badges);const n=e.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema),r={Body:new Set,Eyes:new Set,Head:new Set,Mouth:new Set,WaxRock:new Set,PixelPet:new Set,Background:new Set,"Hats and Hair":new Set,"Glasses and Masks":new Set,"Special Accessories":new Set};n.forEach(e=>{Object.keys(r).forEach(t=>{const a=e.data?.[t];a&&"none"!==a&&""!==a&&r[t].add(a)})});const o={};Object.entries(r).forEach(([e,t])=>{o[e]=Array.from(t).sort()}),L(o),await Promise.all([W(s),D(s),M(s)]);const c=await(async e=>{try{const t=await dt.getWaxAccountInfo(e);if(t&&t.created)return new Date(t.created).toISOString().split("T")[0]}catch(v){De.warn("Could not fetch account creation date:","UserProfileLookup.getAccountCreationDate",v)}try{const t=await dt.getUserTransactions(e,1);if(t&&t.length>0){const e=t[t.length-1];if(e.block_time)return new Date(e.block_time).toISOString().split("T")[0]}}catch(v){De.warn("Could not fetch first transaction date:","UserProfileLookup.getAccountCreationDate",v)}return"2023-01-01"})(s),d={account:s,nftsOwned:e,totalNFTs:e.length,collections:t,joinDate:c,isVerified:a.badges.some(e=>"pixal-pfp"===e.id),badges:a.badges.map(e=>e.name)},u=await z(e),h={totalAssets:e.length,uniqueCollections:t.length,totalValue:u,rareAssets:e.filter(e=>e.template_mint&&e.template_mint<=100).length};i(d),l(h),t.length>0&&J(t)}catch(e){De.error("Error loading user profile:","UserProfileLookup.loadUserProfile",e),y("Failed to load user profile. Please check the account name and try again.")}finally{g(!1)}}},[s,M]);O.useEffect(()=>{s&&R()},[s,R]);const W=async e=>{try{const t=await dt.getWaxAccountInfo(e);if(c(t),t){const e={cpu:{used:t.cpu_limit.used,available:t.cpu_limit.available,max:t.cpu_limit.max},net:{used:t.net_limit.used,available:t.net_limit.available,max:t.net_limit.max},ram:{used:t.ram_usage,available:t.ram_quota-t.ram_usage,max:t.ram_quota}};f(e)}}catch(t){De.error("Failed to fetch WAX account info:","UserProfileLookup.fetchWaxAccountInfo",t)}},D=async e=>{try{const t=await mt.getWaxBalance(e);u(t)}catch(t){De.error("Failed to fetch WAX balance:","UserProfileLookup.fetchWaxBalance",t)}},U=async(e,t)=>{const a=parseFloat(e.split(" ")[0]);try{const e={TLM:"alien.worlds",NEFTY:"neftyblocksp",SEST:"sest.token"}[t];if(e){const s=await dt.getAlcorTokenPrice(t,e);if(s&&s.usd_price)return`$${(a*s.usd_price).toFixed(4)}`}return`$${(a*({TLM:.02,NEFTY:.001,SEST:1e-4}[t]||.001)).toFixed(4)}`}catch(s){De.error(`Error fetching price for ${t}:`,"UserProfileLookup.fetchWaxAccountInfo",s);return`$${(a*({TLM:.02,NEFTY:.001,SEST:1e-4}[t]||.001)).toFixed(4)}`}},z=async e=>{if(0===e.length)return"0.00 WAX";try{const a=e.reduce((e,t)=>{const a=t.collection;return e[a]||(e[a]=[]),e[a].push(t),e},{});let s=0;for(const[e,n]of Object.entries(a))try{const t=await dt.getCollectionStats(e);let a=0;if(t&&t.floor_price)a=parseFloat(t.floor_price);else{const t=await fetch(`${dt.atomicMarketAPI}/atomicmarket/v1/sales?state=3&collection_name=${e}&limit=50&order=desc&sort=updated`),s=await t.json();if(s.success&&s.data?.length>0){const e=s.data.filter(e=>e.price?.amount).map(e=>parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8));e.length>0&&(a=Math.min(...e))}}0===a&&(a=1),n.forEach(e=>{let t=a;e.template_mint&&(e.template_mint<=10?t*=3:e.template_mint<=50?t*=2:e.template_mint<=100&&(t*=1.5)),s+=t})}catch(t){De.warn(`Failed to get market data for collection ${e}, using fallback pricing:`,"UserProfileLookup.calculateTotalValue",t),s+=1.5*n.length}return`${s.toFixed(2)} WAX`}catch(t){De.error("Error calculating total portfolio value:","UserProfileLookup.calculateTotalValue",t);return`${(2*e.length).toFixed(2)} WAX`}},q=()=>{if(!n)return[];let e=n.nftsOwned;switch(A){case"pixals":e=e.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema),Object.entries(I).forEach(([t,a])=>{a&&""!==a&&(e=e.filter(e=>{const s=e.data?.[t];return s&&s.toLowerCase().includes(a.toLowerCase())}))});break;case"waxrock":e=e.filter(e=>{const t=e.data?.WaxRock;return"pixeljourney"===e.collection&&"pixals"===e.schema&&t&&"none"!==t});break;case"ingredients":e=e.filter(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema)}return e},J=async e=>{const t={};for(const s of e)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/collections/${s}`),a=await e.json();if(a.success&&a.data?.img){const e=a.data.img;t[s]=e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`}}catch(a){De.error(`Error fetching avatar for collection ${s}:`,"UserProfileLookup.fetchCollectionAvatars",a)}_(t)},V=e=>{C(e),window.scrollTo({top:0,behavior:"smooth"})};if(x)return Se.jsx("div",{className:"user-profile-lookup",children:Se.jsx("div",{className:"profile-container",children:Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading user profile..."})]})})});if(v)return Se.jsx("div",{className:"user-profile-lookup",children:Se.jsx("div",{className:"profile-container",children:Se.jsxs("div",{className:"error-state",children:[Se.jsx("div",{className:"error-icon",children:"\u26a0\ufe0f"}),Se.jsx("h2",{children:"Profile Not Found"}),Se.jsx("p",{children:v}),Se.jsxs("div",{className:"error-actions",children:[Se.jsx("button",{onClick:()=>a(-1),className:"btn-secondary",children:"Go Back"}),Se.jsx("button",{onClick:R,className:"btn-primary",children:"Try Again"})]})]})})});if(!n||!r)return Se.jsx("div",{className:"user-profile-lookup",children:Se.jsx("div",{className:"profile-container",children:Se.jsx("div",{className:"no-data",children:Se.jsx("p",{children:"No profile data available"})})})});const G=q(),K=(()=>{const e=q(),t=20*(S-1);return e.slice(t,t+20)})(),Y=(()=>{const e=q();return Math.ceil(e.length/20)})();return Se.jsxs("div",{className:"user-profile-lookup",children:[Se.jsxs("div",{className:"profile-container",children:[Se.jsxs("div",{className:"profile-header",children:[Se.jsx("div",{className:"profile-avatar",children:Se.jsx("div",{className:"avatar-placeholder",children:s?.charAt(0).toUpperCase()})}),Se.jsxs("div",{className:"profile-info",children:[Se.jsx("h1",{children:s}),Se.jsxs("div",{className:"profile-badges",children:[n.isVerified&&Se.jsx("span",{className:"badge verified",children:"\u2713 Verified"}),P.map(e=>Se.jsxs("span",{className:`badge ${e.id}`,title:e.description,children:[e.icon," ",e.name]},e.id))]})]}),Se.jsxs("div",{className:"profile-stats-quick",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:r.totalAssets}),Se.jsx("span",{className:"stat-label",children:"NFTs Owned"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:r.uniqueCollections}),Se.jsx("span",{className:"stat-label",children:"Collections"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("span",{className:"stat-value",children:r.rareAssets}),Se.jsx("span",{className:"stat-label",children:"Rare Assets"})]})]})]}),o&&Se.jsxs("div",{className:"account-info-section",children:[Se.jsx("h3",{children:"Account Information"}),Se.jsxs("div",{className:"account-info-grid",children:[Se.jsxs("div",{className:"user-info-card",children:[Se.jsx("div",{className:"info-icon",children:"\ud83d\udc64"}),Se.jsxs("div",{className:"info-details",children:[Se.jsx("h4",{children:"Account Name"}),Se.jsx("p",{children:o.account_name})]})]}),Se.jsxs("div",{className:"user-info-card",children:[Se.jsx("div",{className:"info-icon",children:"\ud83d\udcc5"}),Se.jsxs("div",{className:"info-details",children:[Se.jsx("h4",{children:"Created"}),Se.jsx("p",{children:new Date(o.created).toLocaleDateString()})]})]}),Se.jsxs("div",{className:"user-info-card",children:[Se.jsx("div",{className:"info-icon",children:"\ud83d\udd11"}),Se.jsxs("div",{className:"info-details",children:[Se.jsx("h4",{children:"Permissions"}),Se.jsxs("p",{children:[o.permissions?.length||0," keys"]})]})]})]})]}),Se.jsxs("div",{className:"balance-section",children:[Se.jsx("h3",{children:"Balances"}),Se.jsxs("div",{className:"balance-grid",children:[Se.jsxs("div",{className:"balance-card primary",children:[Se.jsx("div",{className:"balance-icon",children:"\ud83d\udcb0"}),Se.jsxs("div",{className:"balance-details",children:[Se.jsx("h4",{children:"WAX Balance"}),Se.jsx("p",{className:"balance-value",children:d})]})]}),h.map((e,t)=>Se.jsxs("div",{className:"balance-card",children:[Se.jsx("div",{className:"balance-icon",children:"\ud83e\ude99"}),Se.jsxs("div",{className:"balance-details",children:[Se.jsx("h4",{children:e.symbol}),Se.jsx("p",{className:"balance-value",children:e.balance}),Se.jsx("p",{className:"balance-usd",children:e.value})]})]},t))]})]}),p&&Se.jsxs("div",{className:"resources-section",children:[Se.jsx("h3",{children:"Resources"}),Se.jsxs("div",{className:"resources-grid",children:[Se.jsxs("div",{className:"resource-card",children:[Se.jsxs("div",{className:"resource-header",children:[Se.jsx("span",{className:"resource-icon",children:"\u26a1"}),Se.jsx("h4",{children:"CPU"})]}),Se.jsx("div",{className:"resource-bar",children:Se.jsx("div",{className:"resource-fill",style:{width:p.cpu.used/p.cpu.max*100+"%"}})}),Se.jsxs("div",{className:"resource-stats",children:[Se.jsxs("span",{children:[p.cpu.used.toLocaleString()," / ",p.cpu.max.toLocaleString()]}),Se.jsxs("span",{children:[(p.cpu.used/p.cpu.max*100).toFixed(1),"%"]})]})]}),Se.jsxs("div",{className:"resource-card",children:[Se.jsxs("div",{className:"resource-header",children:[Se.jsx("span",{className:"resource-icon",children:"\ud83c\udf10"}),Se.jsx("h4",{children:"NET"})]}),Se.jsx("div",{className:"resource-bar",children:Se.jsx("div",{className:"resource-fill",style:{width:p.net.used/p.net.max*100+"%"}})}),Se.jsxs("div",{className:"resource-stats",children:[Se.jsxs("span",{children:[p.net.used.toLocaleString()," / ",p.net.max.toLocaleString()]}),Se.jsxs("span",{children:[(p.net.used/p.net.max*100).toFixed(1),"%"]})]})]}),Se.jsxs("div",{className:"resource-card",children:[Se.jsxs("div",{className:"resource-header",children:[Se.jsx("span",{className:"resource-icon",children:"\ud83d\udcbe"}),Se.jsx("h4",{children:"RAM"})]}),Se.jsx("div",{className:"resource-bar",children:Se.jsx("div",{className:"resource-fill",style:{width:p.ram.used/p.ram.max*100+"%"}})}),Se.jsxs("div",{className:"resource-stats",children:[Se.jsxs("span",{children:[(p.ram.used/1024).toFixed(2)," KB / ",(p.ram.max/1024).toFixed(2)," KB"]}),Se.jsxs("span",{children:[(p.ram.used/p.ram.max*100).toFixed(1),"%"]})]})]})]})]}),Se.jsxs("div",{className:"stats-grid",children:[Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-icon",children:"\ud83c\udfa8"}),Se.jsxs("div",{className:"stat-details",children:[Se.jsx("h3",{children:"Total Assets"}),Se.jsx("p",{className:"stat-value",children:r.totalAssets})]})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-icon",children:"\ud83d\udcda"}),Se.jsxs("div",{className:"stat-details",children:[Se.jsx("h3",{children:"Collections"}),Se.jsx("p",{className:"stat-value",children:r.uniqueCollections})]})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-icon",children:"\ud83d\udc8e"}),Se.jsxs("div",{className:"stat-details",children:[Se.jsx("h3",{children:"Estimated Value"}),Se.jsx("p",{className:"stat-value",children:r.totalValue})]})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-icon",children:"\u2b50"}),Se.jsxs("div",{className:"stat-details",children:[Se.jsx("h3",{children:"Rare Assets"}),Se.jsx("p",{className:"stat-value",children:r.rareAssets})]})]})]}),Se.jsxs("div",{className:"collections-section",children:[Se.jsxs("h3",{children:["Collections (",n.collections.length,")"]}),Se.jsx("div",{className:"collections-list",children:n.collections.map((e,t)=>Se.jsxs("div",{className:"collection-item",onClick:()=>a(`/collections/${e}`),children:[Se.jsxs("div",{className:"user-collection-avatar",children:[k[e]?Se.jsx("img",{src:k[e],alt:`${e} avatar`,onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}):null,Se.jsx("div",{className:"fallback-avatar",style:{display:k[e]?"none":"flex"},children:e.charAt(0).toUpperCase()})]}),Se.jsx("span",{className:"collection-name",children:e}),Se.jsx("span",{className:"collection-count",children:n.nftsOwned.filter(t=>t.collection===e).length})]},t))})]}),Se.jsxs("div",{className:"inventory-section",children:[Se.jsxs("div",{className:"inventory-header",children:[Se.jsxs("h3",{children:["NFT Inventory (",G.length,")"]}),Se.jsxs("div",{className:"filter-tabs",children:[Se.jsxs("button",{className:"filter-tab "+("all"===A?"active":""),onClick:()=>{T("all"),C(1)},children:["All (",n.nftsOwned.length,")"]}),Se.jsxs("button",{className:"filter-tab "+("pixals"===A?"active":""),onClick:()=>{T("pixals"),C(1)},children:["Pixals (",n.nftsOwned.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema).length,")"]}),Se.jsxs("button",{className:"filter-tab "+("waxrock"===A?"active":""),onClick:()=>{T("waxrock"),C(1)},children:["WaxRock (",n.nftsOwned.filter(e=>{const t=e.data?.WaxRock;return"pixeljourney"===e.collection&&"pixals"===e.schema&&t&&"none"!==t}).length,")"]}),Se.jsxs("button",{className:"filter-tab "+("ingredients"===A?"active":""),onClick:()=>{T("ingredients"),C(1)},children:["Ingredients (",n.nftsOwned.filter(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema).length,")"]})]}),"pixals"===A&&Se.jsxs("div",{className:"pixal-filters",children:[Se.jsx("h4",{children:"Filter by Traits"}),Se.jsx("div",{className:"filters-grid",children:Object.entries(I).map(([e,t])=>Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{children:e}),Se.jsxs("select",{value:t,onChange:t=>{F(a=>({...a,[e]:t.target.value})),C(1)},children:[Se.jsxs("option",{value:"",children:["All ",e]}),$[e]?.map(e=>Se.jsx("option",{value:e,children:e},e))]})]},e))}),Se.jsx("button",{className:"clear-filters-btn",onClick:()=>{F({Body:"",Eyes:"",Head:"",Mouth:"",WaxRock:"",PixelPet:"",Background:"","Hats and Hair":"","Glasses and Masks":"","Special Accessories":""}),C(1)},children:"Clear All Filters"})]})]}),0===K.length?Se.jsxs("div",{className:"empty-inventory",children:[Se.jsx("div",{className:"empty-icon",children:"\ud83d\udce6"}),Se.jsx("h3",{children:"No NFTs Found"}),Se.jsx("p",{children:"This user doesn't have any NFTs in the selected category."})]}):Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"nft-grid",children:K.map(e=>Se.jsxs("div",{className:"nft-card",onClick:()=>(e=>{b(e),w(!0)})(e),children:[Se.jsx("div",{className:"nft-image",children:e.video?Se.jsx("video",{src:e.video,className:"nft-media",muted:!0,loop:!0,onMouseEnter:e=>e.currentTarget.play(),onMouseLeave:e=>e.currentTarget.pause(),onError:t=>{const a=document.createElement("img");a.src=e.image,a.className="nft-media",a.alt=e.name,a.loading="lazy",t.currentTarget.parentNode?.replaceChild(a,t.currentTarget)}}):Se.jsx("img",{src:e.image,alt:e.name,className:"nft-media",loading:"lazy"})}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h4",{className:"nft-name",children:e.name}),Se.jsx("p",{className:"nft-collection",children:e.collection}),Se.jsxs("div",{className:"nft-schema-template",children:[Se.jsx("span",{className:"nft-schema",children:e.schema}),e.template_id&&Se.jsxs("span",{className:"nft-template",children:["T#",e.template_id]})]}),Se.jsxs("div",{className:"nft-details",children:[Se.jsxs("span",{className:"nft-mint",children:["#",e.template_mint]}),e.max_supply&&parseInt(e.max_supply)>0&&Se.jsxs("span",{className:"nft-supply",children:["/",e.max_supply]})]})]})]},e.asset_id))}),Y>1&&Se.jsxs("div",{className:"pagination",children:[Se.jsx("button",{className:"pagination-btn",onClick:()=>V(S-1),disabled:1===S,children:"Previous"}),Se.jsx("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,Y)},(e,t)=>{let a;return a=Y<=5||S<=3?t+1:S>=Y-2?Y-4+t:S-2+t,Se.jsx("button",{className:"pagination-number "+(S===a?"active":""),onClick:()=>V(a),children:a},a)})}),Se.jsx("button",{className:"pagination-btn",onClick:()=>V(S+1),disabled:S===Y,children:"Next"})]})]})]})]}),j&&Se.jsx(fa,{nft:j,isOpen:N,onClose:()=>{w(!1),b(null)}})]})},Ls=()=>{const{settings:e}=at(),{showSuccess:t,showError:a}=xt(),[s,n]=O.useState([]),[i,r]=O.useState(!1),[l,o]=O.useState(null),[c,d]=O.useState(!1),[u,h]=O.useState(new Set),[m,p]=O.useState(!1),[f,x]=O.useState(!1),[g,v]=O.useState(""),[y,j]=O.useState(""),[b,N]=O.useState(1),[w,k]=O.useState(!1),[_,S]=O.useState(1),{isConnected:C,account:A,login:T,session:P}=Fe();O.useEffect(()=>{const e=setTimeout(()=>{j(g)},300);return()=>clearTimeout(e)},[g]);const E=O.useCallback(async(e=1,t=!1)=>{if(A){1===e&&r(!0);try{const a=await dt.getUserInventoryPaginated(A,e,100),s=a.assets.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image,video:e.video||e.traits?.video||void 0,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:(e.max_supply||0).toString()},data:e.traits||{},mint_number:e.template_mint})).filter(e=>Ra.isPackNFT(e));t?n(e=>[...e,...s]):(n(s),N(1)),k(100===a.assets.length),S(e)}catch(s){console.error("Error loading packs:",s),a("Failed to load pack inventory")}finally{r(!1)}}},[A,a]);O.useEffect(()=>{C&&A?E(1,!1):n([])},[C,A,E]);const I=O.useMemo(()=>{if(!y)return s;const e=y.toLowerCase();return s.filter(t=>t.name.toLowerCase().includes(e)||t.collection.collection_name.toLowerCase().includes(e)||t.schema.schema_name.toLowerCase().includes(e))},[s,y]),F=O.useMemo(()=>{const e=20*(b-1),t=e+20;return I.slice(e,t)},[I,b,20]),$=Math.ceil(I.length/20),L=I.length,M=e=>{N(e),window.scrollTo({top:0,behavior:"smooth"})};return C?Se.jsxs("div",{className:"page-content packs-page",children:[Se.jsxs("div",{className:"page-header",children:[Se.jsx("h1",{children:"Pack Inventory"}),Se.jsx("p",{children:"Manage and unpack your NFT packs, chests, boxes, and containers"})]}),Se.jsxs("div",{className:"inventory-controls",children:[Se.jsx("div",{className:"search-container",children:Se.jsx("input",{type:"text",placeholder:"Search packs...",value:g,onChange:e=>v(e.target.value),className:"search-input"})}),Se.jsxs("div",{className:"control-buttons",children:[Se.jsx("button",{className:"multi-select-btn "+(m?"active":""),onClick:()=>{p(!m),h(new Set)},children:m?"\u2713 Multi-Select":"Multi-Select"}),m&&u.size>0&&Se.jsxs("button",{className:"bulk-btn unpack-btn",onClick:()=>{0!==u.size&&x(!0)},children:["\ud83d\udce6 Unpack (",u.size,")"]})]})]}),i&&Se.jsxs("div",{className:"loading-container",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading your packs..."})]}),!i&&Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"inventory-page-stats",children:Se.jsxs("p",{children:[L," packs found"]})}),s.length>0?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"inventory-page-grid",children:F.map(t=>Se.jsxs("div",{className:"nft-card "+(m&&u.has(t.asset_id)?"selected":""),onClick:()=>(e=>{if(m){const t=new Set(u);t.has(e.asset_id)?t.delete(e.asset_id):t.add(e.asset_id),h(t)}else o(e),d(!0)})(t),children:[m&&Se.jsx("div",{className:"selection-checkbox",children:Se.jsx("input",{type:"checkbox",checked:u.has(t.asset_id),onChange:()=>{}})}),Se.jsxs("div",{className:"nft-image-container",children:[Se.jsx(Qt,{imageUrl:ca({img:t.img}),videoUrl:t.video?da({video:t.video}):void 0,alt:t.name,className:"w-full h-full object-cover",controls:e.showVideoControls,autoPlay:e.autoPlayVideos,muted:e.muteVideos}),Se.jsx("div",{className:"pack-indicator",children:"\ud83d\udce6 Pack"})]}),Se.jsxs("div",{className:"nft-info",children:[Se.jsx("h3",{className:"nft-name",children:t.name}),Se.jsx("p",{className:"nft-collection",children:"string"==typeof t.collection?t.collection:t.collection?.collection_name||t.collection?.name||"Unknown"}),Se.jsx("p",{className:"nft-schema",children:t.schema.schema_name}),t.mint_number&&Se.jsxs("p",{className:"nft-mint",children:["Mint #",t.mint_number]})]})]},t.asset_id))}),w&&Se.jsx("div",{className:"load-more-container",children:Se.jsx("button",{className:"load-more-btn",onClick:()=>{w&&E(_+1,!0)},children:"Load More Packs"})}),$>1&&Se.jsxs("div",{className:"pagination-container",children:[Se.jsxs("div",{className:"pagination",children:[Se.jsx("button",{className:"pagination-btn",onClick:()=>M(b-1),disabled:1===b,children:"Previous"}),Array.from({length:Math.min(5,$)},(e,t)=>{const a=t+1;return Se.jsx("button",{className:"pagination-btn "+(b===a?"active":""),onClick:()=>M(a),children:a},a)}),Se.jsx("button",{className:"pagination-btn",onClick:()=>M(b+1),disabled:b===$,children:"Next"})]}),Se.jsxs("div",{className:"pagination-info",children:["Page ",b," of ",$]})]})]}):Se.jsxs("div",{className:"empty-state",children:[Se.jsx("div",{className:"empty-icon",children:"\ud83d\udce6"}),Se.jsx("h3",{children:"No Packs Found"}),Se.jsx("p",{children:"You don't have any pack NFTs in your inventory yet."}),Se.jsx("p",{children:"Packs, chests, boxes, and containers will appear here when you acquire them."})]})]}),l&&Se.jsx(fa,{nft:{asset_id:l.asset_id,name:l.name,image:l.img,collection:l.collection.collection_name,schema:l.schema.schema_name,template_mint:l.mint_number,traits:l.data,price:null,sale_id:null,seller:null},isOpen:c,onClose:()=>{d(!1),o(null)}}),Se.jsx(Wa,{selectedNFTs:s.filter(e=>u.has(e.asset_id)),isOpen:f,onClose:()=>{x(!1)},userAccount:A||"",walletSession:P,onUnpackComplete:()=>{h(new Set),p(!1),E(1,!1),t("Packs unpacked successfully!")}})]}):Se.jsxs("div",{className:"page-content",children:[Se.jsxs("div",{className:"page-header",children:[Se.jsx("h1",{children:"Pack Inventory"}),Se.jsx("p",{children:"Manage and unpack your NFT packs"})]}),Se.jsx("div",{className:"connect-wallet-prompt",children:Se.jsxs("div",{className:"connect-card",children:[Se.jsx("h3",{children:"Connect Your Wallet"}),Se.jsx("p",{children:"Connect your WAX wallet to view your pack inventory"}),Se.jsx("button",{className:"connect-btn",onClick:T,children:"Connect Wallet"})]})})]})},Ms=()=>{const[e,t]=O.useState([]),[a,s]=O.useState(!0),[n,i]=O.useState({}),[r,l]=O.useState(null),[o,c]=O.useState(""),[d,u]=O.useState("below");O.useEffect(()=>{h()},[]),O.useEffect(()=>{e.length>0&&(async()=>{const t={};for(const a of e)a.nft.price&&(t[a.nft.asset_id]=await Ke.convertWaxToUSDAsync(a.nft.price));i(t)})()},[e]);const h=async()=>{try{s(!0);const e=await wt.getWatchlist();t(e)}catch(e){De.error("Error loading watchlist","Watchlist",e)}finally{s(!1)}},m=e=>e?e>0?"\u2197":"\u2198":"";return a?Se.jsx("div",{className:"watchlist-container",children:Se.jsxs("div",{className:"watchlist-loading",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading your watchlist..."})]})}):Se.jsxs("div",{className:"watchlist-container",children:[Se.jsxs("div",{className:"watchlist-header",children:[Se.jsx("h1",{children:"My Watchlist"}),Se.jsx("p",{className:"watchlist-subtitle",children:"Track your favorite NFTs and get notified when prices change"})]}),0===e.length?Se.jsxs("div",{className:"watchlist-empty",children:[Se.jsx("div",{className:"empty-icon",children:"\ud83d\udc41\ufe0f"}),Se.jsx("h3",{children:"Your watchlist is empty"}),Se.jsx("p",{children:"Add NFTs to your watchlist from the marketplace to track their prices"}),Se.jsx("a",{href:"/marketplace",className:"btn-primary",children:"Browse Marketplace"})]}):Se.jsx("div",{className:"watchlist-grid",children:e.map(e=>{return Se.jsxs("div",{className:"watchlist-card",children:[Se.jsxs("div",{className:"watchlist-card-image",children:[Se.jsx("img",{src:e.nft.image,alt:e.nft.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),e.targetPrice&&Se.jsx("div",{className:"alert-badge",children:Se.jsx("span",{className:"alert-icon",children:"\ud83d\udd14"})})]}),Se.jsxs("div",{className:"watchlist-card-content",children:[Se.jsx("h3",{className:"nft-name",children:e.nft.name}),Se.jsx("p",{className:"nft-collection",children:e.nft.collection}),Se.jsxs("div",{className:"price-info",children:[Se.jsxs("div",{className:"current-price",children:[Se.jsx("span",{className:"price-label",children:"Current Price:"}),Se.jsxs("div",{className:"price-values",children:[Se.jsxs("span",{className:"wax-price",children:[e.nft.price," WAX"]}),n[e.nft.asset_id]&&Se.jsxs("span",{className:"usd-price",children:["$",n[e.nft.asset_id]]})]})]}),void 0!==e.priceChange&&Se.jsxs("div",{className:"price-change",style:{color:(a=e.priceChange,a?a>0?"var(--success-color)":"var(--error-color)":"var(--text-secondary)")},children:[Se.jsx("span",{className:"change-icon",children:m(e.priceChange)}),Se.jsxs("span",{children:[Math.abs(e.priceChange).toFixed(2),"%"]})]})]}),e.targetPrice&&Se.jsxs("div",{className:"price-alert-info",children:[Se.jsxs("span",{className:"alert-label",children:["Alert when price is ",e.alertType,":"]}),Se.jsxs("span",{className:"alert-price",children:[e.targetPrice," WAX"]})]}),Se.jsxs("div",{className:"watchlist-actions",children:[e.targetPrice?Se.jsx("button",{className:"btn-secondary btn-sm",onClick:()=>(async e=>{try{await wt.removePriceAlert(e),t(t=>t.map(t=>t.nft.asset_id===e?{...t,targetPrice:void 0,alertType:"any"}:t))}catch(a){De.error("Error removing price alert","Watchlist",a)}})(e.nft.asset_id),children:"Remove Alert"}):Se.jsx("button",{className:"btn-primary btn-sm",onClick:()=>l(e.nft.asset_id),children:"Add Price Alert"}),Se.jsx("button",{className:"btn-danger btn-sm",onClick:()=>(async e=>{try{await wt.removeFromWatchlist(e),t(t=>t.filter(t=>t.nft.asset_id!==e))}catch(a){De.error("Error removing from watchlist","Watchlist",a)}})(e.nft.asset_id),children:"Remove"})]})]}),r===e.nft.asset_id&&Se.jsxs("div",{className:"price-alert-form",children:[Se.jsx("h4",{children:"Set Price Alert"}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Alert Type:"}),Se.jsxs("select",{value:d,onChange:e=>u(e.target.value),children:[Se.jsx("option",{value:"below",children:"Price drops below"}),Se.jsx("option",{value:"above",children:"Price rises above"}),Se.jsx("option",{value:"any",children:"Any price change"})]})]}),"any"!==d&&Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Target Price (WAX):"}),Se.jsx("input",{type:"number",step:"0.01",value:o,onChange:e=>c(e.target.value),placeholder:"Enter price in WAX"})]}),Se.jsxs("div",{className:"form-actions",children:[Se.jsx("button",{className:"btn-primary btn-sm",onClick:()=>(async e=>{if(o)try{await wt.setPriceAlert(e,{targetPrice:parseFloat(o),alertType:d,enabled:!0}),t(t=>t.map(t=>t.nft.asset_id===e?{...t,targetPrice:parseFloat(o),alertType:d}:t)),l(null),c("")}catch(a){De.error("Error adding price alert","Watchlist",a)}})(e.nft.asset_id),disabled:"any"!==d&&!o,children:"Set Alert"}),Se.jsx("button",{className:"btn-secondary btn-sm",onClick:()=>l(null),children:"Cancel"})]})]})]},e.nft.asset_id);var a})})]})},Rs=()=>{const e=[{title:"Pixel Journey",url:"https://pixeljourney.xyz",icon:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),Se.jsx("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),Se.jsx("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})},{title:"Documentation",url:"https://docs.pixeljourney.xyz",icon:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),Se.jsx("polyline",{points:"14,2 14,8 20,8"}),Se.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),Se.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),Se.jsx("polyline",{points:"10,9 9,9 8,9"})]})},{title:"Discord",url:"http://discord.gg/pixel-journey-1130670500776005734",icon:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})})},{title:"Twitter/X",url:"https://x.com/PXJourney",icon:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})}];return Se.jsx("footer",{className:"footer",children:Se.jsxs("div",{className:"footer-container",children:[Se.jsxs("div",{className:"footer-content",children:[Se.jsxs("div",{className:"footer-brand",children:[Se.jsxs("a",{href:"https://pixeljourney.xyz",className:"footer-logo",target:"_blank",rel:"noopener noreferrer",children:[Se.jsx("img",{src:"https://pixeljourney.xyz/img/logo.png",alt:"Pixel Journey",className:"footer-logo-image"}),Se.jsx("span",{className:"footer-logo-text",children:"Pixel Journey"})]}),Se.jsx("p",{className:"footer-description",children:"Explore the Pixel Journey ecosystem - a comprehensive NFT marketplace and gaming platform across multiple blockchains."})]}),Se.jsxs("div",{className:"footer-section footer-center",children:[Se.jsx("h3",{className:"footer-section-title",children:"PXJourney across Web3"}),Se.jsxs("div",{className:"blockchain-grid",children:[Se.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-eth",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[Se.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/ethereum.svg",alt:"Ethereum",className:"blockchain-logo"}),Se.jsx("span",{className:"blockchain-name",children:"Ethereum"})]}),Se.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-polygon",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[Se.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/polygon.jpeg",alt:"Polygon",className:"blockchain-logo"}),Se.jsx("span",{className:"blockchain-name",children:"Polygon"})]}),Se.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-base",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[Se.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/base.jpg",alt:"Base",className:"blockchain-logo"}),Se.jsx("span",{className:"blockchain-name",children:"Base"})]}),Se.jsxs("a",{href:"https://nft.monbase.com/collections/66c4eb2ca339b05c5a660e44/detail",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[Se.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/BSC.png",alt:"BNB Chain",className:"blockchain-logo"}),Se.jsx("span",{className:"blockchain-name",children:"BNB Chain"})]})]}),Se.jsx("div",{className:"bridge-section",children:Se.jsx("a",{href:"https://bridge.mycloudwallet.com/",target:"_blank",rel:"noopener noreferrer",className:"bridge-link",children:"Bridge Now"})})]}),Se.jsxs("div",{className:"footer-section footer-wax",children:[Se.jsx("h3",{className:"footer-section-title",children:Se.jsx("a",{href:"https://wax.io/",target:"_blank",rel:"noopener noreferrer",className:"wax-title-link",children:"PXJourney across WAX"})}),Se.jsxs("div",{className:"wax-dapps-grid",children:[Se.jsxs("a",{href:"https://market.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item purple-glow",children:[Se.jsx("span",{className:"dapp-icon",children:"\ud83d\udecd\ufe0f"}),Se.jsx("span",{className:"dapp-name",children:"PxMarket"})]}),Se.jsxs("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item green-glow",children:[Se.jsx("span",{className:"dapp-icon",children:"\ud83e\uddd1\u200d\ud83c\udf3e"}),Se.jsx("span",{className:"dapp-name",children:"PxStaking"})]}),Se.jsxs("a",{href:"https://lb.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item golden-glow",children:[Se.jsx("span",{className:"dapp-icon",children:"\ud83c\udfc6"}),Se.jsx("span",{className:"dapp-name",children:"PxLeaderboards"})]}),Se.jsxs(U,{to:"/pxcrafting",className:"wax-dapp-item craft-glow",children:[Se.jsx("span",{className:"dapp-icon",children:"\u267b\ufe0f"}),Se.jsx("span",{className:"dapp-name",children:"PxCraft"})]})]}),Se.jsx("div",{className:"journey-section",children:Se.jsx(U,{to:"/journeymap",className:"journey-link",children:"Journey Map"})})]}),Se.jsxs("div",{className:"footer-section footer-right",children:[Se.jsx("h4",{className:"footer-title",children:"Quick Links"}),Se.jsx("div",{className:"footer-links",children:e.map((e,t)=>Se.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"footer-link",children:[Se.jsx("span",{className:"footer-link-icon",children:e.icon}),e.title]},t))})]})]}),Se.jsx("div",{className:"footer-bottom",children:Se.jsxs("div",{className:"footer-bottom-content",children:[Se.jsx("p",{className:"footer-copyright",children:"\xa9 2025 Pixel Journey. All rights reserved."}),Se.jsx("div",{className:"footer-bottom-links",children:Se.jsx("span",{className:"footer-note",children:"Requires a Pixal PFP to unlock full market access"})})]})})]})})},Ws=D.memo(()=>{const e=B(),{settings:t}=at(),[a,s]=O.useState("activity"),[n,i]=O.useState([]),[r,l]=O.useState([]),[o,c]=O.useState(null),[d,u]=O.useState(null),[h,m]=O.useState([]),[p,f]=O.useState([]),[x,g]=O.useState(!1),[v,y]=O.useState(null),[j,b]=O.useState(!1),N=async()=>{try{g(!0),y(null);const e=await dt.getRecentSales(50);i(e.map(e=>{const t=e.assets[0];return{sale_id:e.sale_id,asset_id:t?.asset_id||"",collection_name:t?.collection?.collection_name||"",schema_name:t?.schema?.schema_name||"",template_id:t?.template?.template_id||"",asset_name:t?.name||"",seller:e.seller||"",buyer:e.buyer||"",price:e.listing_price||"0",updated_at_time:e.updated_at_time||"",state:e.state||0,image:t?.data?.img||void 0,video:t?.data?.video||void 0}}))}catch(e){console.error("Error loading activity data:",e),y("Failed to load activity data")}finally{g(!1)}},w=async()=>{try{g(!0),y(null);const e=await dt.getCollections({limit:20,whitelistOnly:!0});if(e.length>0){const t=e.slice(0,10).map(async e=>{try{const t=await dt.getCollectionStats(e.collection_name);return{collection_name:e.collection_name,assets:"0",burned:"0",templates:"0",schemas:"0",volume:t?.volume||"0",sales:t?.sales||"0",floor_price:t?.floor||"0"}}catch{return{collection_name:e.collection_name,assets:"0",burned:"0",templates:"0",schemas:"0",volume:"0",sales:"0",floor_price:"0"}}}),a=await Promise.all(t);l(a)}const t=await dt.getMarketStats();if(t&&t.results&&t.results.length>0){const e=t.results[t.results.length-1];c({total_sales:e.sales||"0",total_volume:e.volume||"0",total_assets:"0",active_listings:"0"})}const[a,s,n]=await Promise.all([dt.getNFTTradingStats(),dt.getTopCollectionsByVolume(10),dt.getRecentNFTTrades(20)]);a&&u({dailyVolume:a.dailyVolume||"0",dailySales:a.dailySales||0,totalTransactions:a.totalTransactions||0,activeListings:a.activeListings||0,averagePrice:a.averagePrice||"0",topCollectionsByVolume:s.map(e=>({collection_name:e.collection_name,volume_24h:"0",sales_24h:0,floor_price:"0",assets_count:"0"}))}),f(s.map(e=>({collection_name:e.collection_name,volume_24h:"0",sales_24h:0,floor_price:"0",assets_count:"0"}))||[]),m((n||[]).map(e=>({sale_id:e.sale_id,collection_name:e.collection_name||"",asset_name:String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"Unknown Asset"),price:String(e.listing_price||e.price?.amount||"0"),buyer:e.buyer||"",seller:e.seller||"",timestamp:e.updated_at_time||""})))}catch(e){console.error("Error loading stats data:",e),y("Failed to load statistics data")}finally{g(!1)}},k=O.useCallback(async()=>{b(!0),"activity"===a?await N():await w(),b(!1)},[a]),_=O.useCallback(t=>{e(`/user-profile-lookup?user=${encodeURIComponent(t)}`)},[e]),S=O.useCallback(t=>{e(`/assets/${t}`)},[e]),C=O.useCallback(t=>{e(`/collections/${encodeURIComponent(t)}`)},[e]),A=O.useCallback(t=>{e(`/listings/${t}`)},[e]),T=O.useCallback(t=>{e(`/listings/${t}`)},[e]);O.useEffect(()=>{"activity"===a?N():w()},[a]);const P=e=>{if("string"==typeof e&&e.includes("WAX"))return e;const t=parseFloat(e)/1e8;return Me(t)},E=e=>{const t=parseInt(e);return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()},I=e=>new Date(1e3*parseInt(e)).toLocaleString();return Se.jsxs("div",{className:"activity-stats-page",children:[Se.jsxs("div",{className:"activity-stats-header",children:[Se.jsx("h1",{className:"activity-stats-title",children:"Market Activity & Statistics"}),Se.jsx("p",{className:"activity-stats-subtitle",children:"Real-time marketplace data and analytics"})]}),Se.jsxs("div",{className:"activity-stats-tabs",children:[Se.jsxs("button",{className:"tab-btn "+("activity"===a?"active":""),onClick:()=>s("activity"),children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M3 3v18h18"}),Se.jsx("path",{d:"M7 12l4-4 4 4 6-6"})]}),"Activity Feed"]}),Se.jsxs("button",{className:"tab-btn "+("stats"===a?"active":""),onClick:()=>s("stats"),children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),Se.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),Se.jsx("line",{x1:"15",y1:"11",x2:"15",y2:"15"})]}),"Statistics"]}),Se.jsxs("button",{className:"refresh-btn "+(j?"refreshing":""),onClick:k,disabled:j,children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("polyline",{points:"23 4 23 10 17 10"}),Se.jsx("polyline",{points:"1 20 1 14 7 14"}),Se.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]}),j?"Refreshing...":"Refresh"]})]}),v&&Se.jsxs("div",{className:"error-message",children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),Se.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),v]}),"activity"===a&&Se.jsxs("div",{className:"activity-content",children:[Se.jsxs("div",{className:"section-header",children:[Se.jsx("h2",{children:"Recent Sales"}),Se.jsx("p",{children:"Latest NFT sales across all collections"})]}),x?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading recent sales..."})]}):Se.jsxs("div",{className:"sales-feed",children:[n.map(e=>Se.jsxs("div",{className:"sale-item clickable-sale",onClick:()=>A(e.sale_id),children:[Se.jsx("div",{className:"sale-media",children:Se.jsx(Qt,{imageUrl:e.image,videoUrl:e.video,alt:e.asset_name||`Asset #${e.asset_id}`,className:"sale-image",enableAnimations:t.enableAnimatedNFTs})}),Se.jsxs("div",{className:"sale-info",children:[Se.jsxs("div",{className:"sale-asset",children:[Se.jsx("h4",{className:"clickable-asset-name",onClick:t=>{t.stopPropagation(),S(e.asset_id)},children:e.asset_name||`Asset #${e.asset_id}`}),Se.jsx("p",{className:"sale-collection clickable-collection",onClick:t=>{t.stopPropagation(),C(e.collection_name)},children:e.collection_name})]}),Se.jsxs("div",{className:"sale-details",children:[Se.jsx("div",{className:"sale-price",children:P(e.price)}),Se.jsx("div",{className:"sale-time",children:I(e.updated_at_time)}),Se.jsx("div",{className:"sale-status",children:3===e.state?Se.jsx("span",{className:"status-sold",children:"\u2705 Sold"}):2===e.state?Se.jsx("span",{className:"status-canceled",children:"\u274c Canceled"}):(e.state,Se.jsx("span",{className:"status-active",children:"\ud83d\udd04 Active"}))})]})]}),Se.jsxs("div",{className:"sale-parties",children:[Se.jsxs("div",{className:"sale-party",children:[Se.jsx("span",{className:"party-label",children:"Seller:"}),Se.jsx("span",{className:"party-name clickable",onClick:t=>{t.stopPropagation(),_(e.seller)},children:e.seller})]}),Se.jsxs("div",{className:"sale-party",children:[Se.jsx("span",{className:"party-label",children:"Buyer:"}),Se.jsx("span",{className:"party-name clickable",onClick:t=>{t.stopPropagation(),_(e.buyer)},children:e.buyer})]}),Se.jsxs("div",{className:"sale-party",children:[Se.jsx("span",{className:"party-label",children:"Sale ID:"}),Se.jsxs("span",{className:"sale-id-link clickable",onClick:t=>{t.stopPropagation(),A(e.sale_id)},title:"View sale details",children:[e.sale_id.slice(0,8),"..."]})]})]})]},e.sale_id)),0===n.length&&!x&&Se.jsxs("div",{className:"empty-state",children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("path",{d:"M12 6v6l4 2"})]}),Se.jsx("h3",{children:"No recent sales"}),Se.jsx("p",{children:"No sales data available at the moment"})]})]})]}),"stats"===a&&Se.jsxs("div",{className:"stats-content",children:[o&&Se.jsxs("div",{className:"market-overview",children:[Se.jsx("h2",{children:"Market Overview"}),Se.jsxs("div",{className:"stats-grid",children:[Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:E(o.total_sales)}),Se.jsx("div",{className:"stat-label",children:"Total Sales"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:P(o.total_volume)}),Se.jsx("div",{className:"stat-label",children:"Total Volume"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:E(o.total_assets)}),Se.jsx("div",{className:"stat-label",children:"Total Assets"})]}),Se.jsxs("div",{className:"stat-card",children:[Se.jsx("div",{className:"stat-value",children:E(o.active_listings)}),Se.jsx("div",{className:"stat-label",children:"Active Listings"})]})]})]}),d&&Se.jsxs("div",{className:"nft-trading-stats-section",children:[Se.jsx("h2",{children:"WAX NFT Trading Data"}),Se.jsxs("div",{className:"nft-stats-grid",children:[Se.jsxs("div",{className:"stat-card nft-card",children:[Se.jsxs("div",{className:"stat-value",children:[d.dailyVolume," WAX"]}),Se.jsx("div",{className:"stat-label",children:"24h Trading Volume"})]}),Se.jsxs("div",{className:"stat-card nft-card",children:[Se.jsx("div",{className:"stat-value",children:E(d.dailySales.toString())}),Se.jsx("div",{className:"stat-label",children:"24h Sales"})]}),Se.jsxs("div",{className:"stat-card nft-card",children:[Se.jsx("div",{className:"stat-value",children:E(d.activeListings.toString())}),Se.jsx("div",{className:"stat-label",children:"Active Listings"})]}),Se.jsxs("div",{className:"stat-card nft-card",children:[Se.jsxs("div",{className:"stat-value",children:[d.averagePrice," WAX"]}),Se.jsx("div",{className:"stat-label",children:"Average Sale Price"})]})]}),p.length>0&&Se.jsxs("div",{className:"top-collections-section",children:[Se.jsx("h3",{children:"Top Collections by Volume"}),Se.jsx("div",{className:"top-collections-grid",children:p.slice(0,6).map(e=>Se.jsxs("div",{className:"collection-card",children:[Se.jsx("div",{className:"collection-name",children:e.collection_name}),Se.jsxs("div",{className:"collection-volume",children:[e.volume_24h," WAX"]}),Se.jsxs("div",{className:"collection-sales",children:[e.sales_24h," sales"]}),Se.jsxs("div",{className:"collection-floor",children:["Floor: ",e.floor_price," WAX"]})]},e.collection_name))})]}),h.length>0&&Se.jsxs("div",{className:"recent-trades-section",children:[Se.jsx("h3",{children:"Recent NFT Trades"}),Se.jsx("div",{className:"recent-trades-list",children:h.slice(0,8).map(e=>Se.jsxs("div",{className:"trade-item clickable-trade",onClick:()=>T(e.sale_id),children:[Se.jsxs("div",{className:"trade-asset",children:[Se.jsx("span",{className:"asset-name clickable-asset-name",onClick:t=>{t.stopPropagation(),T(e.sale_id)},children:e.asset_name}),Se.jsx("span",{className:"collection-name clickable-collection",onClick:t=>{t.stopPropagation(),C(e.collection_name)},children:e.collection_name})]}),Se.jsxs("div",{className:"trade-price",children:[e.price," WAX"]}),Se.jsx("div",{className:"trade-time",children:I(e.timestamp)})]},e.sale_id))})]})]}),Se.jsxs("div",{className:"section-header",children:[Se.jsx("h2",{children:"Collection Statistics"}),Se.jsx("p",{children:"Performance metrics for top collections"})]}),x?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading collection statistics..."})]}):Se.jsxs("div",{className:"collections-table",children:[Se.jsxs("div",{className:"table-header",children:[Se.jsx("div",{className:"table-cell",children:"Collection"}),Se.jsx("div",{className:"table-cell",children:"Assets"}),Se.jsx("div",{className:"table-cell",children:"Volume"}),Se.jsx("div",{className:"table-cell",children:"Sales"}),Se.jsx("div",{className:"table-cell",children:"Floor Price"})]}),r.map(e=>Se.jsxs("div",{className:"table-row",children:[Se.jsx("div",{className:"table-cell collection-name",children:e.collection_name}),Se.jsx("div",{className:"table-cell",children:E(e.assets)}),Se.jsx("div",{className:"table-cell",children:P(e.volume)}),Se.jsx("div",{className:"table-cell",children:E(e.sales)}),Se.jsx("div",{className:"table-cell",children:P(e.floor_price)})]},e.collection_name)),0===r.length&&!x&&Se.jsxs("div",{className:"empty-state",children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),Se.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),Se.jsx("line",{x1:"15",y1:"11",x2:"15",y2:"15"})]}),Se.jsx("h3",{children:"No statistics available"}),Se.jsx("p",{children:"Statistics data is currently unavailable"})]})]})]})]})});Ws.displayName="ActivityStats";const Os=new class{constructor(){M(this,"subscriptions",new Map),M(this,"pollInterval",null),M(this,"isPolling",!1),M(this,"POLL_INTERVAL",3e4),M(this,"MAX_REQUESTS_PER_MINUTE",30),M(this,"REQUEST_DELAY",2e3),M(this,"lastRequestTime",0),M(this,"requestCount",0),M(this,"requestResetTime",Date.now()+6e4),M(this,"auctionCache",new Map),M(this,"CACHE_DURATION",15e3)}subscribe(e,t){this.subscriptions.has(e)||this.subscriptions.set(e,[]);const a={auction_id:e,callback:t};return this.subscriptions.get(e).push(a),this.startPolling(),()=>{const t=this.subscriptions.get(e);if(t){const s=t.indexOf(a);s>-1&&t.splice(s,1),0===t.length&&this.subscriptions.delete(e)}0===this.subscriptions.size&&this.stopPolling()}}startPolling(){this.isPolling||(this.isPolling=!0,this.pollInterval=setInterval(()=>{this.pollAuctionUpdates()},this.POLL_INTERVAL))}stopPolling(){this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.isPolling=!1}async pollAuctionUpdates(){const e=Array.from(this.subscriptions.keys());if(0!==e.length)try{this.clearExpiredCache();(await this.fetchAuctionUpdates(e)).forEach(e=>{const t=this.subscriptions.get(e.auction_id);t&&t.forEach(t=>{try{t.callback(e)}catch(a){Le.logError("AuctionService.pollAuctionUpdates.callback",a,{auctionId:e.auction_id})}})})}catch(t){Le.logError("AuctionService.pollAuctionUpdates",t,{auctionIds:e})}else this.stopPolling()}async fetchAuctionUpdates(e){const t=[],a=Date.now();a>this.requestResetTime&&(this.requestCount=0,this.requestResetTime=a+6e4);for(const n of e){const e=this.auctionCache.get(n);if(e&&a-e.timestamp<this.CACHE_DURATION){t.push(e.data);continue}if(this.requestCount>=this.MAX_REQUESTS_PER_MINUTE){Oe.warn("Rate limit reached, skipping auction","AUCTION",{auctionId:n}),e&&t.push(e.data);continue}const i=a-this.lastRequestTime;i<this.REQUEST_DELAY&&await new Promise(e=>setTimeout(e,this.REQUEST_DELAY-i));try{const e=`${dt.getCurrentAtomicEndpoint()}/atomicmarket/v1/auctions/${n}`,a=await dt.fetchWithRetry(e),s=await a.json();if(this.requestCount++,this.lastRequestTime=Date.now(),s.success&&s.data){const e=s.data,a={auction_id:n,current_bid:e.current_bid,bidder:e.current_bidder,end_time:e.end_time,status:this.getAuctionStatus(e),bid_count:e.bid_count||0,last_bid_time:e.updated_at_time};this.auctionCache.set(n,{data:a,timestamp:Date.now()}),t.push(a)}}catch(s){Le.logError("AuctionService.fetchAuctionUpdates.single",s,{auctionId:n}),e&&t.push(e.data)}}return t}getAuctionStatus(e){const t=Date.now(),a=new Date(e.end_time+"Z").getTime();return 3===e.state?"cancelled":t>a?"ended":"active"}async getAuctionBids(e){try{const t=await dt.getAuctions({limit:1});if(!t.success||!t.data.length)return[];const a=t.data[0].assets.map(e=>e.asset_id);return(await this.fetchAuctionBidHistory(e,a)).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())}catch(t){return Le.logError("AuctionService.getAuctionBids",t,{auctionId:e}),[]}}async fetchAuctionBidHistory(e,t){try{const t=[qe.WAX_CHAIN.EOSRIO,qe.WAX_CHAIN.WAXSWEDEN,qe.HYPERION[2]];for(const s of t)try{const t=await fetch(`${s}/v2/history/get_actions?account=atomicmarket&filter=atomicmarket:auctionbid&limit=100&sort=desc&after=${new Date(Date.now()-6048e5).toISOString()}`,{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)continue;const a=await t.json(),n=[];if(a.actions)for(const s of a.actions)s.act?.data?.auction_id===e&&n.push({bidder:s.act.data.bidder||s.act.authorization?.[0]?.actor||"unknown",bid_amount:s.act.data.bid||"0.0000 WAX",timestamp:s.timestamp,transaction_id:s.trx_id});return n}catch(a){Oe.warn("Failed to fetch from endpoint","AUCTION",{endpoint:s,error:a});continue}return[]}catch(s){return Le.logError("AuctionService.fetchAuctionBidHistory",s,{auctionId:e,assetIds:t}),[]}}getTimeRemaining(e){const t=Date.now();let a;if(!e)return{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};if(e.includes("T")&&!e.endsWith("Z"))a=new Date(e+"Z").getTime();else if(e.includes("T")&&e.endsWith("Z"))a=new Date(e).getTime();else{const t=parseInt(e);a=isNaN(t)?new Date(e).getTime():t>1e12?t:1e3*t}if(isNaN(a))return Oe.warn("Invalid endTime format","AUCTION",{endTime:e}),{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};const s=a-t;if(s<=0)return{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};return{total:s,days:Math.floor(s/864e5),hours:Math.floor(s%864e5/36e5),minutes:Math.floor(s%36e5/6e4),seconds:Math.floor(s%6e4/1e3),isExpired:!1}}formatTimeRemaining(e){const t=this.getTimeRemaining(e);return t.isExpired?"Auction ended":t.days>0?`${t.days}d ${t.hours}h ${t.minutes}m`:t.hours>0?`${t.hours}h ${t.minutes}m ${t.seconds}s`:t.minutes>0?`${t.minutes}m ${t.seconds}s`:`${t.seconds}s`}isEndingSoon(e){const t=this.getTimeRemaining(e);return!t.isExpired&&t.total<3e5}clearExpiredCache(){const e=Date.now();for(const[t,a]of this.auctionCache.entries())e-a.timestamp>2*this.CACHE_DURATION&&this.auctionCache.delete(t)}cleanup(){this.subscriptions.clear(),this.stopPolling(),this.auctionCache.clear()}},Ds=D.memo(()=>{const e=B(),{isConnected:t,account:a,session:s}=Da(),{showSuccess:n,showError:i}=xt(),[r,l]=O.useState([]),[o,c]=O.useState(!0),[d,u]=O.useState(!1),[h,m]=O.useState(null),[p,f]=O.useState(1),[x,g]=O.useState(!0),[v,y]=O.useState(1),[j,b]=O.useState("all"),[N,w]=O.useState("created_desc"),[k,_]=O.useState(""),[S,C]=O.useState(""),[A,T]=O.useState(!1),[P,E]=O.useState(!1),[I,F]=O.useState(!1),[$,L]=O.useState(null),[M,R]=O.useState(""),[W,D]=O.useState(!1),[U,z]=O.useState(!1),[X,H]=O.useState(new Set),[q,J]=O.useState([]),[V,G]=O.useState(!1),[K,Y]=O.useState(""),[Q,Z]=O.useState(0),[ee,te]=O.useState(1),[ae,se]=O.useState(0),[ne,ie]=O.useState(0),[re,le]=O.useState(""),[oe,ce]=O.useState([]),de=O.useCallback(()=>{switch(N){case"price_asc":case"price_desc":return"price";default:return"created"}},[N]),ue=O.useCallback(()=>{switch(N){case"price_asc":case"created_asc":return"asc";default:return"desc"}},[N]),he=O.useCallback(async(e=1,t=!1)=>{try{1===e?(c(!0),f(1),g(!0)):u(!0),m(null);const a=await dt.getAuctions({state:1,limit:36,offset:36*(e-1),sort:de(),order:ue(),hide_empty_auctions:A,search:k||void 0,collection_name:S||void 0,collection_blacklist:"flinttffunko,onlyfanzgaly,farmerpetsco,fantaspeop",seller_blacklist:"dximg.wam,xpvrs.wam,5rrrc.wam,nnmnmnmnn.gm",symbol:"WAX"});if(!a.success||!a.data)throw new Error("Failed to fetch auctions data");const s=a.data.map(e=>({auction_id:e.auction_id,asset_id:e.asset_id,seller:e.seller,price:e.price,end_time:e.end_time,collection_name:e.collection_name,template_id:e.template_id,asset_name:e.asset_name,image:e.image,current_bid:e.current_bid||null,bidder:e.bidder||null,collection_info:void 0}));l(t&&e>1?e=>[...e,...s]:s);const n=36,i=s.length===n;g(i),f(e),y(i?e+1:e)}catch(a){De.error("Error loading auctions","Auctions",a),m("Failed to load auctions. Please try again later.")}finally{c(!1),u(!1)}},[de,ue,A,k,S]),me=O.useCallback(()=>{!d&&x&&he(p+1,!0)},[he,p,x,d]),pe=O.useCallback(()=>{f(1),g(!0),he(1,!1)},[he]);O.useEffect(()=>{pe()},[pe,j,k,S,A,N]),O.useEffect(()=>{(async()=>{try{const e=await dt.getCollections({limit:50,whitelistOnly:!0});if(e&&e.length>0){const t=e.map(e=>({collection_name:e.collection_name,name:e.name||e.collection_name}));ce(t)}}catch(e){De.error("Failed to load collections","Auctions",e),ce([{collection_name:"pixeljourney",name:"Pixel Journey"},{collection_name:"friedfactory",name:"Fried Factory"}])}})()},[]);const fe=e=>{const t=parseFloat(e)/1e8;return Me(t)},xe=O.useMemo(()=>r.filter(e=>{if(k){const t=k.toLowerCase();if(!(e.asset_name?.toLowerCase().includes(t)||e.asset_id?.toString().includes(t)||e.collection_name?.toLowerCase().includes(t)))return!1}return(!S||e.collection_name===S)&&!!(!A||e.bidder&&e.current_bid&&"0"!==e.current_bid)}),[r,k,S,A]);O.useEffect(()=>{const e=[];return xe.forEach(t=>{const a=Os.subscribe(t.auction_id,e=>{l(t=>t.map(t=>t.auction_id===e.auction_id?{...t,current_bid:e.current_bid||t.current_bid,bidder:e.bidder||t.bidder,end_time:e.end_time}:t))});e.push(a)}),()=>{e.forEach(e=>e())}},[xe]);const ge=()=>7*Q*24*60*60+24*ee*60*60+60*ae*60+60*ne,ve=(e,t)=>{const a=Math.max(0,Math.min(t,ye(e)));switch(e){case"weeks":Z(a);break;case"days":te(a);break;case"hours":se(a);break;case"minutes":ie(a)}},ye=e=>{switch(e){case"weeks":return 4;case"days":return 30;case"hours":return 23;case"minutes":return 59;default:return 0}};return Se.jsxs("div",{className:"auctions-page",children:[Se.jsx("div",{className:"page-header",children:Se.jsxs("div",{className:"header-content",children:[Se.jsxs("div",{className:"header-text",children:[Se.jsx("h1",{children:"Auctions"}),Se.jsx("p",{children:"Discover and bid on unique NFTs from the WAX ecosystem"})]}),Se.jsx("button",{className:"create-auction-btn",onClick:()=>{E(!0),a&&(async()=>{if(a){G(!0);try{const e=`${dt.atomicAssetsAPI}/atomicassets/v1/assets?owner=${a}&limit=100`,t=await dt.fetchWithRetry(e),s=await t.json();if(s.success&&s.data){const e=s.data.map(e=>({asset_id:e.asset_id,name:e.name||`${e.collection.collection_name} #${e.template_mint||e.asset_id}`,collection_name:e.collection.collection_name,image:e.data?.img?`https://ipfs.io/ipfs/${e.data.img}`:void 0,template_mint:e.template_mint,isSelected:!1}));J(e)}}catch(e){De.error("Error loading user assets","Auctions",e),J([])}finally{G(!1)}}})()},children:"Create Auction"})]})}),Se.jsxs("div",{className:"auctions-controls",children:[Se.jsx("div",{className:"search-section",children:Se.jsxs("div",{className:"search-input-wrapper",children:[Se.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("input",{type:"text",placeholder:"Search auctions by name or asset ID...",value:k,onChange:e=>_(e.target.value),className:"search-input"})]})}),Se.jsxs("div",{className:"filters-section",children:[Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{children:"Collection:"}),Se.jsxs("select",{value:S,onChange:e=>C(e.target.value),className:"collection-filter",children:[Se.jsx("option",{value:"",children:"All Collections"}),oe.map(e=>Se.jsx("option",{value:e.collection_name,children:e.name},e.collection_name))]})]}),Se.jsxs("div",{className:"filter-group",children:[Se.jsx("label",{children:"Sort by:"}),Se.jsxs("select",{value:N,onChange:e=>w(e.target.value),className:"sort-filter",children:[Se.jsx("option",{value:"price_asc",children:"Price: Low to High"}),Se.jsx("option",{value:"price_desc",children:"Price: High to Low"}),Se.jsx("option",{value:"created_desc",children:"Newest First"}),Se.jsx("option",{value:"created_asc",children:"Oldest First"})]})]}),Se.jsx("div",{className:"filter-group",children:Se.jsxs("label",{className:"checkbox-label",children:[Se.jsx("input",{type:"checkbox",checked:A,onChange:e=>T(e.target.checked)}),Se.jsx("span",{className:"checkmark"}),"Hide auctions without bids"]})})]}),Se.jsxs("div",{className:"auctions-filters",children:[Se.jsx("button",{className:"filter-btn "+("all"===j?"active":""),onClick:()=>b("all"),children:"All Auctions"}),Se.jsx("button",{className:"filter-btn "+("ending-soon"===j?"active":""),onClick:()=>b("ending-soon"),children:"Ending Soon"}),Se.jsx("button",{className:"filter-btn "+("new"===j?"active":""),onClick:()=>b("new"),children:"New Auctions"})]})]}),o&&Se.jsxs("div",{className:"loading-container",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading auctions..."})]}),h&&Se.jsxs("div",{className:"error-container",children:[Se.jsx("p",{className:"error-message",children:h}),Se.jsx("button",{onClick:()=>he(),className:"retry-btn",children:"Try Again"})]}),!o&&!h&&0===xe.length&&r.length>0&&Se.jsxs("div",{className:"empty-state",children:[Se.jsx("h3",{children:"No Matching Auctions"}),Se.jsx("p",{children:"No auctions match your current filters. Try adjusting your search criteria."})]}),!o&&!h&&0===r.length&&Se.jsxs("div",{className:"empty-state",children:[Se.jsx("h3",{children:"No Active Auctions"}),Se.jsx("p",{children:"There are currently no active auctions. Check back later!"})]}),!o&&!h&&xe.length>0&&Se.jsx("div",{className:"auctions-grid",children:xe.map(s=>Se.jsxs("div",{className:"auction-card clickable-card",onClick:()=>e(`/auctions/${s.auction_id}`),children:[Se.jsxs("div",{className:"auction-image",children:[Se.jsx(Qt,{imageUrl:s.image,videoUrl:s.video,alt:s.asset_name,className:"auction-media",enableAnimations:!0}),Se.jsx("div",{className:"auction-timer",children:Os.formatTimeRemaining(s.end_time)})]}),Se.jsxs("div",{className:"auction-info",children:[Se.jsx("h3",{className:"auction-title",children:s.asset_name}),Se.jsxs("div",{className:"auction-collection-info",children:[s.collection_info?.img&&Se.jsx("img",{src:s.collection_info.img,alt:s.collection_info.name,className:"collection-avatar"}),Se.jsxs("div",{className:"collection-details",children:[Se.jsx("p",{className:"collection-name",children:s.collection_info?.name||s.collection_name}),s.collection_info?.description&&Se.jsx("p",{className:"collection-description",children:s.collection_info.description.length>60?`${s.collection_info.description.substring(0,60)}...`:s.collection_info.description})]})]}),Se.jsxs("div",{className:"seller-info",children:[Se.jsx("span",{className:"label",children:"Seller: "}),Se.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(s.seller)}`)},className:"seller-account",children:s.seller})]}),Se.jsxs("div",{className:"auction-pricing",children:[Se.jsxs("div",{className:"current-bid",children:[Se.jsx("span",{className:"label",children:s.current_bid?"Current Bid:":"Starting Price:"}),Se.jsx("span",{className:"price",children:s.current_bid?fe(s.current_bid):fe(s.price)})]}),s.bidder&&Se.jsxs("div",{className:"bidder",children:[Se.jsx("span",{className:"label",children:"Top Bidder:"}),Se.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(s.bidder||"")}`)},className:"account",children:s.bidder})]})]}),Se.jsxs("div",{className:"auction-actions",children:[Se.jsx("button",{className:"bid-btn",onClick:e=>{e.stopPropagation(),(e=>{t&&a?e.seller!==a?(L(e),R(""),F(!0)):i("Invalid Action","You cannot bid on your own auction"):i("Wallet Required","Please connect your wallet to place bids")})(s)},disabled:!t||s.seller===a,children:t?s.seller===a?"Your Auction":"Place Bid":"Connect Wallet"}),Se.jsx("button",{className:"view-btn",onClick:t=>{t.stopPropagation(),(t=>{e(`/assets/${t.asset_id}`)})(s)},children:"View Details"})]})]})]},s.auction_id))}),!o&&!h&&xe.length>0&&Se.jsxs("div",{className:"pagination-container",children:[x&&Se.jsx("button",{className:"load-more-btn",onClick:me,disabled:d,children:d?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"loading-spinner small"}),"Loading more..."]}):"Load More Auctions"}),Se.jsxs("div",{className:"pagination-info",children:[Se.jsxs("span",{children:["Page ",p," of ",v]}),Se.jsxs("span",{children:[xe.length," auctions loaded"]})]})]}),Se.jsxs("div",{className:"coming-soon-notice",children:[Se.jsx("h3",{children:"\ud83d\udea7 Integration in Progress"}),Se.jsx("p",{children:"Full AtomicMarket auction integration is currently being implemented. This page will soon display live auction data and allow bidding functionality."})]}),I&&$&&Se.jsx("div",{className:"modal-overlay",onClick:()=>F(!1),children:Se.jsxs("div",{className:"bid-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"bid-modal-header",children:[Se.jsx("h2",{children:"Place Your Bid"}),Se.jsx("button",{className:"close-btn",onClick:()=>F(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"bid-modal-body",children:[Se.jsxs("div",{className:"bid-auction-summary",children:[Se.jsxs("div",{className:"bid-asset-image",children:[Se.jsx(Qt,{imageUrl:$.image,videoUrl:$.video,alt:$.asset_name,className:"bid-modal-media",enableAnimations:!0}),Se.jsx("div",{className:"auction-timer-small",children:Os.formatTimeRemaining($.end_time)})]}),Se.jsxs("div",{className:"bid-asset-info",children:[Se.jsx("h3",{children:$.asset_name}),Se.jsxs("div",{className:"bid-collection-info",children:[$.collection_info?.img&&Se.jsx("img",{src:$.collection_info.img,alt:$.collection_info.name,className:"collection-avatar-small"}),Se.jsx("span",{className:"collection-name",children:$.collection_info?.name||$.collection_name})]}),Se.jsxs("div",{className:"bid-current-info",children:[Se.jsxs("div",{className:"current-bid-display",children:[Se.jsx("span",{className:"label",children:$.current_bid?"Current Bid":"Starting Price"}),Se.jsx("span",{className:"amount",children:fe($.current_bid||$.price)})]}),$.bidder&&Se.jsxs("div",{className:"current-bidder",children:[Se.jsx("span",{className:"label",children:"Leading Bidder"}),Se.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent($.bidder||"")}`)},className:"bidder-account",children:$.bidder})]})]})]})]}),Se.jsx("div",{className:"bid-input-section",children:Se.jsxs("div",{className:"bid-form-group",children:[Se.jsx("label",{children:"Your Bid Amount"}),Se.jsxs("div",{className:"bid-input-wrapper",children:[Se.jsx("input",{type:"number",value:M,onChange:e=>R(e.target.value),placeholder:"0.0000",step:"0.0001",min:$.current_bid&&$.bidder?parseFloat($.current_bid)/1e8+1e-4:parseFloat($.price)/1e8,className:"bid-amount-input",disabled:W}),Se.jsx("span",{className:"currency-label",children:"WAX"})]}),Se.jsxs("div",{className:"bid-requirements",children:[Se.jsx("p",{className:"minimum-bid",children:$.current_bid&&$.bidder?`Minimum: ${Me(parseFloat($.current_bid)/1e8+1e-4)}`:`Starting Price: ${Me(parseFloat($.price)/1e8)}`}),M&&Se.jsxs("p",{className:"bid-total",children:["Total: ",Me(parseFloat(M))]})]})]})}),Se.jsxs("div",{className:"previous-bids-section",children:[Se.jsx("h4",{children:"Bid History"}),Se.jsx("div",{className:"bids-list",children:$.bidder?Se.jsxs("div",{className:"bid-item",children:[Se.jsxs("div",{className:"bidder-info",children:[Se.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent($.bidder||"")}`)},className:"bidder",children:$.bidder}),Se.jsx("span",{className:"bid-time",children:"Current leading bid"})]}),Se.jsx("span",{className:"bid-amount",children:fe($.current_bid||$.price)})]}):Se.jsx("div",{className:"no-bids",children:Se.jsx("p",{children:"No bids yet - be the first to bid!"})})})]}),Se.jsxs("div",{className:"bid-notice",children:[Se.jsx("div",{className:"notice-icon",children:"\ud83d\udca1"}),Se.jsx("div",{className:"notice-text",children:Se.jsxs("p",{children:[Se.jsx("strong",{children:"Important:"})," Ensure you have sufficient WAX balance for your bid. Bids are binding and cannot be cancelled."]})})]})]}),Se.jsxs("div",{className:"bid-modal-footer",children:[Se.jsx("button",{className:"cancel-bid-btn",onClick:()=>F(!1),disabled:W,children:"Cancel"}),Se.jsx("button",{className:"submit-bid-btn",onClick:async()=>{if(!$||!s||!a)return void i("Error","Please connect your wallet first");const e=parseFloat(M);if(isNaN(e)||e<=0)return void i("Invalid Bid","Please enter a valid bid amount");const t=parseFloat($.current_bid||$.price)/1e8,r=$.current_bid&&$.bidder;if(r&&e<=t)i("Invalid Bid",`Bid must be higher than current bid of ${Me(t)}`);else if(!r&&e<t)i("Invalid Bid",`Bid must be at least the starting price of ${Me(t)}`);else{D(!0);try{const t=`${e.toFixed(8)} WAX`,i={account:"atomicmarket",name:"auctionbid",authorization:[{actor:a,permission:Gt.safeGetPermission(s)}],data:{bidder:a,auction_id:$.auction_id,bid:t,taker_marketplace:"market.pxj"}};await s.transact({actions:[i]})&&(n("Bid Placed",`Successfully placed bid of ${Me(e)}`),F(!1),R(""),L(null),he())}catch(l){De.error("Error placing bid","Auctions",l);const e=l instanceof Error?l.message:"Failed to place bid. Please try again.";i("Bid Failed",e)}finally{D(!1)}}},disabled:W||!M||($.current_bid&&$.bidder?parseFloat(M)<=parseFloat($.current_bid)/1e8:parseFloat(M)<parseFloat($.price)/1e8),children:W?Se.jsxs(Se.Fragment,{children:[Se.jsx("span",{className:"loading-spinner-small"}),"Placing Bid..."]}):`Place Bid \u2022 ${M||"0.0000"} WAX`})]})]})}),P&&Se.jsx("div",{className:"modal-overlay auction-modal",onClick:()=>E(!1),children:Se.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Create Auction"}),Se.jsx("button",{className:"close-btn",onClick:()=>E(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsx("div",{className:"asset-selection-section",children:Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Select Assets to Auction"}),Se.jsx("div",{className:"asset-selection-container",children:V?Se.jsxs("div",{className:"loading-assets",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("span",{children:"Loading your assets..."})]}):q.length>0?Se.jsx("div",{className:"assets-grid",children:q.map(e=>Se.jsxs("div",{className:"asset-item "+(X.has(e.asset_id)?"selected":""),onClick:()=>(e=>{const t=new Set(X);t.has(e)?t.delete(e):t.add(e),H(t)})(e.asset_id),children:[Se.jsxs("div",{className:"asset-image",children:[Se.jsx(Qt,{imageUrl:ca(e),videoUrl:da(e),alt:e.name||`Asset #${e.asset_id}`,className:"asset-media",enableAnimations:!0,loading:"lazy"}),X.has(e.asset_id)&&Se.jsx("div",{className:"selection-indicator",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M9,20.42l-6.21,-6.21l2.83,-2.83L9,14.77l9.88,-9.89l2.83,2.83L9,20.42z"})})})]}),Se.jsxs("div",{className:"asset-info",children:[Se.jsx("div",{className:"asset-name",children:e.name||`Asset #${e.asset_id}`}),Se.jsx("div",{className:"asset-collection",children:e.collection_name}),e.template_mint&&Se.jsxs("div",{className:"asset-mint-info",children:["Mint #",e.template_mint]})]})]},e.asset_id))}):Se.jsxs("div",{className:"no-assets",children:[Se.jsx("svg",{className:"no-assets-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M20,7l-8,-4l-8,4m16,0l-8,4m8,-4v10l-8,4m0,-10L4,7m8,4v10M4,7v10l8,4"})}),Se.jsx("h3",{children:"No Assets Found"}),Se.jsx("p",{children:"You don't have any assets to auction. Visit the marketplace to acquire some NFTs first."})]})}),X.size>0&&Se.jsx("div",{className:"selection-summary",children:Se.jsxs("span",{children:[X.size," asset",X.size>1?"s":""," selected"]})})]})}),Se.jsxs("div",{className:"auction-form-section",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Starting Price (WAX)"}),Se.jsx("input",{type:"number",placeholder:"0.0000",step:"0.0001",min:"0",value:K,onChange:e=>Y(e.target.value),className:"form-input"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Auction Duration"}),Se.jsxs("div",{className:"duration-inputs",children:[Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Weeks"}),Se.jsx("input",{type:"number",min:"0",max:"4",value:Q,onChange:e=>ve("weeks",parseInt(e.target.value)||0),className:"duration-input"})]}),Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Days"}),Se.jsx("input",{type:"number",min:"0",max:"30",value:ee,onChange:e=>ve("days",parseInt(e.target.value)||0),className:"duration-input"})]}),Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Hours"}),Se.jsx("input",{type:"number",min:"0",max:"23",value:ae,onChange:e=>ve("hours",parseInt(e.target.value)||0),className:"duration-input"})]}),Se.jsxs("div",{className:"duration-field",children:[Se.jsx("label",{className:"duration-label",children:"Minutes"}),Se.jsx("input",{type:"number",min:"0",max:"59",value:ne,onChange:e=>ve("minutes",parseInt(e.target.value)||0),className:"duration-input"})]})]}),Se.jsxs("div",{className:"duration-summary",children:[Se.jsx("span",{className:"duration-display",children:(()=>{const e=[];return Q>0&&e.push(`${Q} week${Q>1?"s":""}`),ee>0&&e.push(`${ee} day${ee>1?"s":""}`),ae>0&&e.push(`${ae} hour${ae>1?"s":""}`),ne>0&&e.push(`${ne} minute${ne>1?"s":""}`),0===e.length?"No duration set":e.join(", ")})()}),Se.jsxs("span",{className:"duration-total",children:["Total: ",Math.floor(ge()/3600),"h ",Math.floor(ge()%3600/60),"m"]})]})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Memo (Optional)"}),Se.jsx("textarea",{placeholder:"Add a description for your auction",className:"form-textarea",rows:3,value:re,onChange:e=>le(e.target.value)})]})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"cancel-btn",onClick:()=>E(!1),children:"Cancel"}),Se.jsx("button",{className:"create-btn",onClick:async()=>{if(0===X.size)return void i("No Assets Selected","Please select at least one asset to auction");if(!K||parseFloat(K)<=0)return void i("Invalid Price","Please enter a valid starting price");const e=ge();if(e<3600)i("Invalid Duration","Auction duration must be at least 1 hour");else if(e>2592e3)i("Invalid Duration","Auction duration cannot exceed 30 days");else try{z(!0);const t=Array.from(X).map(e=>parseInt(e)),i=`${parseFloat(K).toFixed(8)} WAX`,r=[{account:"atomicmarket",name:"announceauct",authorization:[{actor:a||"",permission:s?.permission||"active"}],data:{seller:a||"",asset_ids:t,starting_bid:i,duration:e,maker_marketplace:"market.pxj"}}];s&&await s.transact({actions:r}),n("Auction Created",`Successfully created auction for ${X.size} asset(s). Remember to transfer your assets to the atomicmarket contract to activate the auction.`),E(!1),H(new Set),Y(""),Z(0),te(1),se(0),ie(0),le(""),he()}catch(t){De.error("Failed to create auction","Auctions",t),i("Auction Creation Failed",t instanceof Error?t.message:"Failed to create auction")}finally{z(!1)}},disabled:0===X.size||!K||parseFloat(K)<=0||U,children:U?Se.jsxs(Se.Fragment,{children:[Se.jsx("span",{className:"loading-spinner-small"}),"Creating Auction..."]}):"Create Auction"+(X.size>0?` (${X.size} asset${X.size>1?"s":""})`:"")})]})]})})]})}),Us=()=>{const{id:e}=X(),t=B(),{isConnected:a,account:s,session:n}=Da(),{showSuccess:i,showError:r}=xt(),[l,o]=O.useState(null),[c,d]=O.useState(!0),[u,h]=O.useState(null),[m,p]=O.useState(!1),[f,x]=O.useState(""),[g,v]=O.useState(!1),y=O.useCallback(async()=>{if(e){d(!0),h(null);try{const t=await dt.getAuction(e);if(!t.success||!t.data)return void h("Auction not found");o(t.data)}catch(t){console.error("Error loading auction:",t),h("Failed to load auction details")}finally{d(!1)}}},[e]);O.useEffect(()=>{e&&y()},[e,y]),O.useEffect(()=>{if(!l)return;const e=Os.subscribe(l.auction_id,e=>{o(t=>t?{...t,current_bid:e.current_bid||t.current_bid,bidder:e.bidder||t.bidder,end_time:e.end_time}:null)});return()=>e()},[l]);const j=e=>`${(parseFloat(e)/1e8).toFixed(4)} WAX`,b=e=>{t(`/user-profile-lookup?user=${encodeURIComponent(e)}`)};if(c)return Se.jsx("div",{className:"auction-detail-page",children:Se.jsxs("div",{className:"loading-container",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading auction details..."})]})});if(u||!l)return Se.jsx("div",{className:"auction-detail-page",children:Se.jsxs("div",{className:"error-container",children:[Se.jsx("h2",{children:"Auction Not Found"}),Se.jsx("p",{children:u||"The requested auction could not be found."}),Se.jsx("button",{className:"btn-primary",onClick:()=>t("/auctions"),children:"Back to Auctions"})]})});const N=(w=l.end_time,Os.formatTimeRemaining(w));var w;const k="Auction ended"===N,_=l.current_bid?j(l.current_bid):j(l.price);return Se.jsxs("div",{className:"auction-detail-page",children:[Se.jsxs("div",{className:"auction-detail-container",children:[Se.jsx("button",{className:"back-button",onClick:()=>t("/auctions"),children:"\u2190 Back to Auctions"}),Se.jsxs("div",{className:"auction-detail-content",children:[Se.jsxs("div",{className:"auction-image-section",children:[Se.jsx("div",{className:"auction-image-container",children:Se.jsx(Qt,{imageUrl:l.image?`${qe.IPFS.GATEWAYS[0]}${l.image}`:void 0,videoUrl:l.video?`${qe.IPFS.GATEWAYS[0]}${l.video}`:void 0,alt:l.asset_name||"NFT",className:"auction-image",enableAnimations:!0})}),Se.jsxs("div",{className:"auction-basic-info",children:[Se.jsx("h1",{className:"auction-title",children:l.asset_name||`Asset #${l.asset_id||"Unknown"}`}),Se.jsxs("div",{className:"auction-collection",children:["Collection: ",l.collection_name||"Unknown"]}),Se.jsxs("div",{className:"auction-id",children:["Auction ID: ",l.auction_id]})]})]}),Se.jsxs("div",{className:"auction-info-section",children:[Se.jsxs("div",{className:"auction-status",children:[Se.jsx("div",{className:"status-badge "+(k?"ended":"active"),children:k?"Ended":"Active"}),!k&&Se.jsxs("div",{className:"time-remaining",children:[Se.jsx("span",{className:"time-label",children:"Time Remaining:"}),Se.jsx("span",{className:"time-value",children:N})]})]}),Se.jsx("div",{className:"price-section",children:Se.jsxs("div",{className:"current-price",children:[Se.jsx("span",{className:"price-label",children:l.current_bid?"Current Bid:":"Starting Price:"}),Se.jsx("span",{className:"price-value",children:_})]})}),Se.jsxs("div",{className:"participants-section",children:[Se.jsxs("div",{className:"seller-info",children:[Se.jsx("span",{className:"participant-label",children:"Seller:"}),Se.jsx("button",{className:"participant-link",onClick:()=>b(l.seller),children:l.seller})]}),l.bidder&&Se.jsxs("div",{className:"bidder-info",children:[Se.jsx("span",{className:"participant-label",children:"Top Bidder:"}),Se.jsx("button",{className:"participant-link",onClick:()=>b(l.bidder||""),children:l.bidder})]})]}),Se.jsx("div",{className:"auction-actions",children:!k&&Se.jsx("button",{className:"btn-primary bid-button",onClick:()=>{a&&s?l?.seller!==s?(x(""),p(!0)):r("Invalid Action","You cannot bid on your own auction"):r("Wallet Required","Please connect your wallet to place bids")},disabled:!a||l.seller===s,children:a?l.seller===s?"Your Auction":"Place Bid":"Connect Wallet"})})]})]})]}),m&&Se.jsx("div",{className:"modal-overlay",onClick:()=>p(!1),children:Se.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h3",{children:"Place Bid"}),Se.jsx("button",{className:"modal-close",onClick:()=>p(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"auction-summary",children:[Se.jsx(Qt,{imageUrl:l.image?`${qe.IPFS.GATEWAYS[0]}${l.image}`:void 0,videoUrl:l.video?`${qe.IPFS.GATEWAYS[0]}${l.video}`:void 0,alt:l.asset_name||"NFT",className:"modal-nft-image",enableAnimations:!0}),Se.jsxs("div",{className:"modal-nft-info",children:[Se.jsx("h4",{children:l.asset_name||`Asset #${l.asset_id||"Unknown"}`}),Se.jsxs("p",{children:["Current: ",_]})]})]}),l.bidder&&Se.jsxs("div",{className:"current-bidder",children:[Se.jsx("span",{className:"label",children:"Leading Bidder"}),Se.jsx("button",{className:"bidder-account",onClick:()=>b(l.bidder),children:l.bidder})]}),Se.jsxs("div",{className:"bid-input-section",children:[Se.jsx("label",{htmlFor:"bidAmount",children:"Your Bid (WAX)"}),Se.jsx("input",{id:"bidAmount",type:"number",step:"0.0001",placeholder:"Enter bid amount",value:f,onChange:e=>x(e.target.value),min:l.current_bid&&l.bidder?parseFloat(l.current_bid)/1e8+1e-4:parseFloat(l.price)/1e8}),Se.jsxs("div",{className:"bid-requirement",children:["Minimum: ",l.current_bid&&l.bidder?`${(parseFloat(l.current_bid)/1e8+1e-4).toFixed(4)} WAX`:`${(parseFloat(l.price)/1e8).toFixed(4)} WAX`]})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"btn-secondary",onClick:()=>p(!1),disabled:g,children:"Cancel"}),Se.jsx("button",{className:"btn-primary",onClick:async()=>{if(!l||!n||!s)return void r("Error","Please connect your wallet first");const e=parseFloat(f);if(isNaN(e)||e<=0)return void r("Invalid Bid","Please enter a valid bid amount");const t=parseFloat(l.current_bid||l.price)/1e8,a=l.current_bid&&l.bidder;if(a&&e<=t)r("Invalid Bid",`Bid must be higher than current bid of ${t.toFixed(4)} WAX`);else if(!a&&e<parseFloat(l.price)/1e8)r("Invalid Bid",`Bid must be at least ${(parseFloat(l.price)/1e8).toFixed(4)} WAX`);else{v(!0);try{const t=Math.floor(1e8*e);await n.transact({actions:[{account:"atomicmarket",name:"auctionbid",authorization:[{actor:s,permission:"active"}],data:{bidder:s,auction_id:l.auction_id,bid:`${t} WAX`,taker_marketplace:"market.pxj"}}]})&&(i("Bid Placed",`Successfully placed bid of ${e.toFixed(4)} WAX`),p(!1),x(""),o(e=>e?{...e,current_bid:t.toString(),bidder:s}:null))}catch(c){console.error("Error placing bid:",c),r("Bid Failed",c instanceof Error?c.message:"Failed to place bid")}finally{v(!1)}}},disabled:g||!f,children:g?"Placing Bid...":"Place Bid"})]})]})})]})},Bs=()=>{const[e,t]=O.useState("getting-started"),a=[{id:"getting-started",title:"Getting Started on WAX",content:Se.jsxs("div",{className:"guide-content",children:[Se.jsx("h3",{children:"Welcome to the WAX Blockchain!"}),Se.jsx("p",{children:"WAX (Worldwide Asset eXchange) is a purpose-built blockchain for NFTs and gaming. Here's how to get started:"}),Se.jsxs("div",{className:"step-list",children:[Se.jsxs("div",{className:"step",children:[Se.jsx("div",{className:"step-number",children:"1"}),Se.jsxs("div",{className:"step-content",children:[Se.jsx("h4",{children:"Create a WAX Wallet"}),Se.jsxs("p",{children:["Visit ",Se.jsx("a",{href:"https://wallet.wax.io",target:"_blank",rel:"noopener noreferrer",children:"wallet.wax.io"})," to create your free WAX account. No gas fees required!"]})]})]}),Se.jsxs("div",{className:"step",children:[Se.jsx("div",{className:"step-number",children:"2"}),Se.jsxs("div",{className:"step-content",children:[Se.jsx("h4",{children:"Get Some WAX Tokens"}),Se.jsx("p",{children:"Purchase WAX tokens from exchanges like Binance, KuCoin, or use the built-in WAX wallet exchange."})]})]}),Se.jsxs("div",{className:"step",children:[Se.jsx("div",{className:"step-number",children:"3"}),Se.jsxs("div",{className:"step-content",children:[Se.jsx("h4",{children:"Connect Your Wallet"}),Se.jsx("p",{children:'Use the "Connect Wallet" button in the top right to connect your WAX wallet to PxMarket.'})]})]}),Se.jsxs("div",{className:"step",children:[Se.jsx("div",{className:"step-number",children:"4"}),Se.jsxs("div",{className:"step-content",children:[Se.jsx("h4",{children:"Start Trading!"}),Se.jsx("p",{children:"Browse collections, buy NFTs, and start building your digital asset portfolio."})]})]})]})]})},{id:"pixel-journey",title:"About Pixel Journey",content:Se.jsxs("div",{className:"guide-content",children:[Se.jsx("h3",{children:"Welcome to Pixel Journey!"}),Se.jsx("p",{children:"Pixel Journey is a comprehensive NFT ecosystem on the WAX blockchain, featuring unique pixel art collections and gaming utilities."}),Se.jsxs("div",{className:"feature-grid",children:[Se.jsxs("div",{className:"feature-card",children:[Se.jsx("h4",{children:"\ud83c\udfa8 Pixel Art NFTs"}),Se.jsx("p",{children:"Collect unique pixel art characters, items, and accessories with various rarity levels."})]}),Se.jsxs("div",{className:"feature-card",children:[Se.jsx("h4",{children:"\ud83c\udfae Gaming Integration"}),Se.jsx("p",{children:"Use your NFTs in games and earn rewards through various gameplay mechanics."})]}),Se.jsxs("div",{className:"feature-card",children:[Se.jsx("h4",{children:"\ud83d\udc8e Staking Rewards"}),Se.jsx("p",{children:"Stake your Pixel Journey NFTs to earn PXJ tokens and other rewards."})]}),Se.jsxs("div",{className:"feature-card",children:[Se.jsx("h4",{children:"\ud83c\udfea Marketplace"}),Se.jsx("p",{children:"Trade your NFTs on our integrated marketplace with zero fees for holders."})]})]}),Se.jsxs("div",{className:"collections-info",children:[Se.jsx("h4",{children:"Main Collections:"}),Se.jsxs("ul",{children:[Se.jsxs("li",{children:[Se.jsx("strong",{children:"Pixals:"})," The main character collection with various traits and rarities"]}),Se.jsxs("li",{children:[Se.jsx("strong",{children:"Pixel Ingredients:"})," Crafting materials and consumables"]}),Se.jsxs("li",{children:[Se.jsx("strong",{children:"Pixel Tools:"})," Equipment and utility items"]}),Se.jsxs("li",{children:[Se.jsx("strong",{children:"Pixel Lands:"})," Virtual land parcels for building and development"]})]})]})]})},{id:"trading-tips",title:"Trading Tips & Strategies",content:Se.jsxs("div",{className:"guide-content",children:[Se.jsx("h3",{children:"Smart Trading on WAX"}),Se.jsxs("div",{className:"tip-section",children:[Se.jsx("h4",{children:"\ud83d\udd0d Research Before Buying"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Check the collection's total supply and rarity distribution"}),Se.jsx("li",{children:"Look at recent sales history and price trends"}),Se.jsx("li",{children:"Verify the authenticity of the collection"}),Se.jsx("li",{children:"Join the project's Discord or Telegram for community insights"})]})]}),Se.jsxs("div",{className:"tip-section",children:[Se.jsx("h4",{children:"\ud83d\udcb0 Pricing Strategies"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Use floor price as a baseline for common items"}),Se.jsx("li",{children:"Factor in rarity and trait combinations for pricing"}),Se.jsx("li",{children:"Consider market timing and overall WAX ecosystem trends"}),Se.jsx("li",{children:"Set competitive prices for quick sales or premium prices for rare items"})]})]}),Se.jsxs("div",{className:"tip-section",children:[Se.jsx("h4",{children:"\u26a0\ufe0f Risk Management"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Never invest more than you can afford to lose"}),Se.jsx("li",{children:"Diversify across different collections and projects"}),Se.jsx("li",{children:"Be aware of market volatility and seasonal trends"}),Se.jsx("li",{children:"Keep some WAX liquid for opportunities"})]})]})]})},{id:"faq",title:"Frequently Asked Questions",content:Se.jsxs("div",{className:"guide-content",children:[Se.jsx("h3",{children:"Common Questions"}),Se.jsxs("div",{className:"faq-list",children:[Se.jsxs("div",{className:"faq-item",children:[Se.jsx("h4",{children:"Q: Are there any fees for trading on PxMarket?"}),Se.jsx("p",{children:"A: PxMarket charges a small marketplace fee on sales. However, Pixel Journey NFT holders may receive fee discounts or exemptions."})]}),Se.jsxs("div",{className:"faq-item",children:[Se.jsx("h4",{children:"Q: How do I know if an NFT is authentic?"}),Se.jsx("p",{children:"A: Always verify the collection name and creator account. Authentic Pixel Journey NFTs are minted by verified accounts and will show the official collection badge."})]}),Se.jsxs("div",{className:"faq-item",children:[Se.jsx("h4",{children:"Q: Can I cancel a listing after it's posted?"}),Se.jsx("p",{children:"A: Yes, you can cancel your listings at any time from your inventory or profile page. There's no fee for canceling listings."})]}),Se.jsxs("div",{className:"faq-item",children:[Se.jsx("h4",{children:"Q: What happens if I lose access to my WAX wallet?"}),Se.jsx("p",{children:"A: Always keep your private keys and recovery phrases secure. If you lose access, you may lose your NFTs permanently. Consider using hardware wallets for valuable collections."})]}),Se.jsxs("div",{className:"faq-item",children:[Se.jsx("h4",{children:"Q: How do I participate in NFT drops and launches?"}),Se.jsx("p",{children:"A: Follow Pixel Journey on social media and join our Discord for announcements. Most drops happen directly through our platform or partner sites."})]}),Se.jsxs("div",{className:"faq-item",children:[Se.jsx("h4",{children:"Q: Can I use my NFTs in games?"}),Se.jsx("p",{children:"A: Many Pixel Journey NFTs have gaming utility. Check the NFT details page for specific game integrations and benefits."})]})]})]})},{id:"advanced",title:"Advanced Features",content:Se.jsxs("div",{className:"guide-content",children:[Se.jsx("h3",{children:"Power User Features"}),Se.jsxs("div",{className:"advanced-section",children:[Se.jsx("h4",{children:"\ud83d\udd27 Bulk Operations"}),Se.jsx("p",{children:"Use our bulk tools to:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"List multiple NFTs at once with smart pricing"}),Se.jsx("li",{children:"Transfer multiple items to different recipients"}),Se.jsx("li",{children:"Burn unwanted NFTs in batches"}),Se.jsx("li",{children:"Stake multiple NFTs for rewards"})]})]}),Se.jsxs("div",{className:"advanced-section",children:[Se.jsx("h4",{children:"\ud83d\udcca Analytics & Tracking"}),Se.jsx("p",{children:"Monitor your portfolio with:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Real-time portfolio value tracking"}),Se.jsx("li",{children:"Transaction history and profit/loss analysis"}),Se.jsx("li",{children:"Collection performance metrics"}),Se.jsx("li",{children:"Market trend indicators"})]})]}),Se.jsxs("div",{className:"advanced-section",children:[Se.jsx("h4",{children:"\ud83c\udfaf Watchlists & Alerts"}),Se.jsx("p",{children:"Stay informed with:"}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"Custom watchlists for tracking specific NFTs"}),Se.jsx("li",{children:"Price alerts for collections you're interested in"}),Se.jsx("li",{children:"New listing notifications"}),Se.jsx("li",{children:"Auction ending reminders"})]})]})]})}];return Se.jsxs("div",{className:"learn-page",children:[Se.jsxs("div",{className:"page-header",children:[Se.jsx("h1",{children:"Learn Hub"}),Se.jsx("p",{children:"Everything you need to know about WAX, NFTs, and Pixel Journey"})]}),Se.jsxs("div",{className:"learn-container",children:[Se.jsx("div",{className:"learn-sidebar",children:Se.jsx("nav",{className:"learn-nav",children:a.map(a=>Se.jsx("button",{className:"nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id),children:a.title},a.id))})}),Se.jsx("div",{className:"learn-content",children:a.find(t=>t.id===e)?.content})]}),Se.jsxs("div",{className:"help-section",children:[Se.jsx("h3",{children:"Need More Help?"}),Se.jsx("p",{children:"Access our documentation and join our community for support:"}),Se.jsxs("div",{className:"community-links",children:[Se.jsxs("a",{href:"https://docs.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"community-link docs",children:[Se.jsx("span",{className:"icon",children:"\ud83d\udcda"}),"Documentation"]}),Se.jsxs("a",{href:"#",className:"community-link discord",children:[Se.jsx("span",{className:"icon",children:"\ud83d\udcac"}),"Discord Community"]}),Se.jsxs("a",{href:"#",className:"community-link telegram",children:[Se.jsx("span",{className:"icon",children:"\ud83d\udcf1"}),"Telegram Group"]}),Se.jsxs("a",{href:"#",className:"community-link twitter",children:[Se.jsx("span",{className:"icon",children:"\ud83d\udc26"}),"Twitter Updates"]})]})]})]})},zs=()=>{const[e,t]=O.useState("overview"),a=[{id:"overview",title:"Overview",content:Se.jsxs("div",{className:"section-content",children:[Se.jsx("h3",{children:"PxMarket Journey Map"}),Se.jsx("p",{children:"Welcome to the comprehensive roadmap of the Pixel Journey ecosystem. This page serves as both a sitemap for current features and a development roadmap for future enhancements."}),Se.jsxs("div",{className:"ecosystem-grid",children:[Se.jsxs("div",{className:"ecosystem-card current",children:[Se.jsx("h4",{children:"\ud83c\udfea Current Platform"}),Se.jsx("p",{children:"PxMarket - Your gateway to the Pixel Journey NFT ecosystem"})]}),Se.jsxs("div",{className:"ecosystem-card future",children:[Se.jsx("h4",{children:"\ud83d\ude80 Future dApps"}),Se.jsx("p",{children:"Expanding ecosystem of interconnected applications"})]})]})]})},{id:"pxmarket-features",title:"PxMarket Features",content:Se.jsxs("div",{className:"section-content",children:[Se.jsx("h3",{children:"PxMarket Feature Map"}),Se.jsx("p",{children:"Explore all the features available in the current PxMarket platform:"}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83d\uded2 Marketplace Core"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"NFT Marketplace"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Collection Browser"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Asset Details"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Advanced Filtering"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83d\udc64 User Features"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"User Profiles"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Inventory Management"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Watchlist"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Activity Tracking"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83d\udcb0 Trading & Economy"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Buy/Sell NFTs"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Bulk Operations"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Price Analytics"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Auctions"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Offers System"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Shopping Cart"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83d\udd04 WAX Integration"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"RWAX Tokenization"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"WAX Balance Management"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Resource Management (CPU/NET/RAM)"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Multi-Wallet Support"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83c\udfc6 Staking & Rewards"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"NFT Staking"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Token Staking"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Reward Distribution"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"PXJ Badge System"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83c\udf81 Rewards & Gamification"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Pack Opening"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Chat System"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Live Transactions Feed"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Social Sharing"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item planned",children:[Se.jsx("span",{className:"feature-name",children:"Achievement System"}),Se.jsx("span",{className:"status-badge planned",children:"Planned"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83d\udee0\ufe0f Advanced Features"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"NFT Comparison Tool"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Portfolio Analytics"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Price Alerts"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Collection Analytics"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"Accessibility Features"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsxs("div",{className:"feature-item live",children:[Se.jsx("span",{className:"feature-name",children:"PWA Support"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),Se.jsxs("div",{className:"feature-category",children:[Se.jsx("h4",{children:"\ud83c\udfa8 Crafting & Creation"}),Se.jsxs("div",{className:"feature-list",children:[Se.jsxs("div",{className:"feature-item beta",children:[Se.jsx("span",{className:"feature-name",children:"NFT Crafting System"}),Se.jsx("span",{className:"status-badge beta",children:"Beta"})]}),Se.jsxs("div",{className:"feature-item planned",children:[Se.jsx("span",{className:"feature-name",children:"Custom Templates"}),Se.jsx("span",{className:"status-badge planned",children:"Planned"})]}),Se.jsxs("div",{className:"feature-item planned",children:[Se.jsx("span",{className:"feature-name",children:"Community Creations"}),Se.jsx("span",{className:"status-badge planned",children:"Planned"})]})]})]})]})},{id:"wax-ecosystem",title:"WAX Ecosystem",content:Se.jsxs("div",{className:"section-content",children:[Se.jsx("h3",{children:"PXJourney across WAX"}),Se.jsx("p",{children:"Explore the expanding Pixel Journey ecosystem on the WAX blockchain:"}),Se.jsxs("div",{className:"dapp-grid",children:[Se.jsxs("div",{className:"dapp-card live purple-glow",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxMarket"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsx("p",{children:"NFT marketplace and trading platform"}),Se.jsx("a",{href:"https://market.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxMarket \u2192"})]}),Se.jsxs("div",{className:"dapp-card live green-glow",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxStaking"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsx("p",{children:"Stake your Pixel Journey NFTs for rewards"}),Se.jsx("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxStaking \u2192"})]}),Se.jsxs("div",{className:"dapp-card live golden-glow",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxLeaderboards"}),Se.jsx("span",{className:"status-badge live",children:"Live"})]}),Se.jsx("p",{children:"Track rankings and compete with other players"}),Se.jsx("a",{href:"https://lb.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxLeaderboards \u2192"})]}),Se.jsxs("div",{className:"dapp-card planned",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxDeFi"}),Se.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),Se.jsx("p",{children:"Decentralized finance features for the ecosystem"}),Se.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]}),Se.jsxs("div",{className:"dapp-card coming-soon",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxCraft"}),Se.jsx("span",{className:"status-badge coming-soon",children:"Coming Soon"})]}),Se.jsx("p",{children:"Craft and create new NFTs from existing assets"}),Se.jsx("div",{className:"dapp-link disabled",children:"In Development"})]}),Se.jsxs("div",{className:"dapp-card coming-soon",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxMilestones"}),Se.jsx("span",{className:"status-badge coming-soon",children:"Coming Soon"})]}),Se.jsx("p",{children:"Achievement and milestone tracking system"}),Se.jsx("div",{className:"dapp-link disabled",children:"In Development"})]}),Se.jsxs("div",{className:"dapp-card planned",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxQuest"}),Se.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),Se.jsx("p",{children:"Quest and mission system for earning rewards"}),Se.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]}),Se.jsxs("div",{className:"dapp-card planned",children:[Se.jsxs("div",{className:"dapp-header",children:[Se.jsx("h4",{children:"PxDAO"}),Se.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),Se.jsx("p",{children:"Decentralized governance for the ecosystem"}),Se.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]})]})]})},{id:"external-links",title:"External Platforms",content:Se.jsxs("div",{className:"section-content",children:[Se.jsx("h3",{children:"Pixel Journey Across Platforms"}),Se.jsx("p",{children:"Find Pixel Journey on various platforms and marketplaces:"}),Se.jsxs("div",{className:"platform-category",children:[Se.jsx("h4",{children:"\ud83c\udf10 Official Websites"}),Se.jsxs("div",{className:"link-grid",children:[Se.jsxs("a",{href:"https://pixeljourney.xyz/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"Main Website"}),Se.jsx("span",{className:"platform-desc",children:"Official Pixel Journey homepage"})]}),Se.jsxs("a",{href:"https://docs.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"Documentation"}),Se.jsx("span",{className:"platform-desc",children:"Complete project documentation"})]})]})]}),Se.jsxs("div",{className:"platform-category",children:[Se.jsx("h4",{children:"\ud83d\uded2 NFT Marketplaces (WAX)"}),Se.jsxs("div",{className:"link-grid",children:[Se.jsxs("a",{href:"https://atomichub.io/explorer/collection/wax-mainnet/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"AtomicHub"}),Se.jsx("span",{className:"platform-desc",children:"Primary WAX marketplace"})]}),Se.jsxs("a",{href:"https://neftyblocks.com/collection/pixeljourney/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"NeftyBlocks"}),Se.jsx("span",{className:"platform-desc",children:"WAX NFT marketplace"})]}),Se.jsxs("a",{href:"https://nfthive.io/collection/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"NFTHive"}),Se.jsx("span",{className:"platform-desc",children:"WAX marketplace and drops"})]}),Se.jsxs("a",{href:"https://www.pfpwizard.xyz/pfp/pixals/ranking/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"PFP Wizard"}),Se.jsx("span",{className:"platform-desc",children:"Pixal PFP marketplace"})]})]})]}),Se.jsxs("div",{className:"platform-category",children:[Se.jsx("h4",{children:"\ud83c\udf09 Cross-Chain Marketplaces"}),Se.jsxs("div",{className:"link-grid",children:[Se.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-polygon",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"OpenSea (Polygon)"}),Se.jsx("span",{className:"platform-desc",children:"Polygon bridged collection"})]}),Se.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-base",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"OpenSea (Base)"}),Se.jsx("span",{className:"platform-desc",children:"Base bridged collection"})]}),Se.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-eth",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"OpenSea (Ethereum)"}),Se.jsx("span",{className:"platform-desc",children:"Ethereum bridged collection"})]}),Se.jsxs("a",{href:"https://nft.monbase.com/collections/66c4eb2ca339b05c5a660e44/detail",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"MonBase"}),Se.jsx("span",{className:"platform-desc",children:"Base chain marketplace"})]})]})]}),Se.jsxs("div",{className:"platform-category",children:[Se.jsx("h4",{children:"\ud83d\udcb0 DeFi & Staking"}),Se.jsxs("div",{className:"link-grid",children:[Se.jsxs("a",{href:"https://waxdao.io/v2/farm/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"WaxDAO Farm"}),Se.jsx("span",{className:"platform-desc",children:"NFT staking rewards"})]}),Se.jsxs("a",{href:"https://www.pfpwizard.xyz/pfp/pixals/buy/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[Se.jsx("span",{className:"platform-name",children:"PFP Wizard Buy"}),Se.jsx("span",{className:"platform-desc",children:"Get your Pixal PFP"})]})]})]})]})},{id:"social-community",title:"Social & Community",content:Se.jsxs("div",{className:"section-content",children:[Se.jsx("h3",{children:"Join the Community"}),Se.jsx("p",{children:"Connect with the Pixel Journey community across various platforms:"}),Se.jsxs("div",{className:"social-grid",children:[Se.jsxs("a",{href:"https://twitter.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"social-link twitter",children:[Se.jsx("div",{className:"social-icon",children:"\ud83d\udc26"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"Twitter/X"}),Se.jsx("span",{className:"social-desc",children:"Latest updates and announcements"})]})]}),Se.jsxs("a",{href:"https://t.me/pixel_journey",target:"_blank",rel:"noopener noreferrer",className:"social-link telegram",children:[Se.jsx("div",{className:"social-icon",children:"\ud83d\udcf1"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"Telegram"}),Se.jsx("span",{className:"social-desc",children:"Community chat and discussions"})]})]}),Se.jsxs("a",{href:"https://discord.gg/waxblockchain",target:"_blank",rel:"noopener noreferrer",className:"social-link discord",children:[Se.jsx("div",{className:"social-icon",children:"\ud83d\udcac"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"WAX Discord"}),Se.jsx("span",{className:"social-desc",children:"Join the broader WAX community"})]})]}),Se.jsxs("a",{href:"https://instagram.com/pixeljourney_xyz",target:"_blank",rel:"noopener noreferrer",className:"social-link instagram",children:[Se.jsx("div",{className:"social-icon",children:"\ud83d\udcf8"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"Instagram"}),Se.jsx("span",{className:"social-desc",children:"Visual updates and behind-the-scenes"})]})]}),Se.jsxs("a",{href:"https://coinmarketcap.com/community/profile/pixeljourney/",target:"_blank",rel:"noopener noreferrer",className:"social-link cmc",children:[Se.jsx("div",{className:"social-icon",children:"\ud83d\udcca"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"CoinMarketCap"}),Se.jsx("span",{className:"social-desc",children:"Project profile and metrics"})]})]}),Se.jsxs("a",{href:"https://dappradar.com/nft-collection/pixel-journey",target:"_blank",rel:"noopener noreferrer",className:"social-link dappradar",children:[Se.jsx("div",{className:"social-icon",children:"\ud83d\udcc8"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"DappRadar"}),Se.jsx("span",{className:"social-desc",children:"NFT collection analytics"})]})]}),Se.jsxs("a",{href:"https://pixel-journey.uncut.network/",target:"_blank",rel:"noopener noreferrer",className:"social-link uncut",children:[Se.jsx("div",{className:"social-icon",children:"\ud83c\udfae"}),Se.jsxs("div",{className:"social-info",children:[Se.jsx("span",{className:"social-name",children:"Uncut Network"}),Se.jsx("span",{className:"social-desc",children:"Gaming community presence"})]})]})]})]})},{id:"roadmap",title:"Development Roadmap",content:Se.jsxs("div",{className:"section-content",children:[Se.jsx("h3",{children:"Future Development Roadmap"}),Se.jsx("p",{children:"Planned features and enhancements for the Pixel Journey ecosystem:"}),Se.jsxs("div",{className:"roadmap-timeline",children:[Se.jsxs("div",{className:"roadmap-phase completed",children:[Se.jsxs("div",{className:"phase-header",children:[Se.jsx("h4",{children:"Phase 1: Foundation"}),Se.jsx("span",{className:"phase-status completed",children:"Completed"})]}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"\u2705 PxMarket NFT marketplace launch"}),Se.jsx("li",{children:"\u2705 Basic trading functionality"}),Se.jsx("li",{children:"\u2705 User profiles and inventory"}),Se.jsx("li",{children:"\u2705 PXJ token integration"})]})]}),Se.jsxs("div",{className:"roadmap-phase current",children:[Se.jsxs("div",{className:"phase-header",children:[Se.jsx("h4",{children:"Phase 2: Enhancement"}),Se.jsx("span",{className:"phase-status current",children:"Current"})]}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"\u2705 Advanced filtering and search"}),Se.jsx("li",{children:"\u2705 Bulk operations"}),Se.jsx("li",{children:"\ud83d\udd04 Auction system (Beta)"}),Se.jsx("li",{children:"\ud83d\udd04 Enhanced analytics"})]})]}),Se.jsxs("div",{className:"roadmap-phase planned",children:[Se.jsxs("div",{className:"phase-header",children:[Se.jsx("h4",{children:"Phase 3: Ecosystem Expansion"}),Se.jsx("span",{className:"phase-status planned",children:"Q2 2025"})]}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"\ud83d\udd2e PxCraft crafting system"}),Se.jsx("li",{children:"\ud83d\udd2e PxMilestones achievement system"}),Se.jsx("li",{children:"\ud83d\udd2e Enhanced gamification"}),Se.jsx("li",{children:"\ud83d\udd2e Cross-platform integration"})]})]}),Se.jsxs("div",{className:"roadmap-phase future",children:[Se.jsxs("div",{className:"phase-header",children:[Se.jsx("h4",{children:"Phase 4: Advanced Features"}),Se.jsx("span",{className:"phase-status future",children:"Q3-Q4 2025"})]}),Se.jsxs("ul",{children:[Se.jsx("li",{children:"\ud83d\udd2e PxQuest mission system"}),Se.jsx("li",{children:"\ud83d\udd2e PxDeFi financial features"}),Se.jsx("li",{children:"\ud83d\udd2e PxDAO governance"}),Se.jsx("li",{children:"\ud83d\udd2e Mobile applications"})]})]})]})]})}];return Se.jsxs("div",{className:"journeymap-page",children:[Se.jsxs("div",{className:"page-header",children:[Se.jsx("h1",{children:"Journey Map"}),Se.jsx("p",{children:"Your comprehensive guide to the Pixel Journey ecosystem - current features, future roadmap, and community links"})]}),Se.jsxs("div",{className:"journeymap-container",children:[Se.jsx("div",{className:"journeymap-sidebar",children:Se.jsx("nav",{className:"journeymap-nav",children:a.map(a=>Se.jsx("button",{className:"nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id),children:a.title},a.id))})}),Se.jsx("div",{className:"journeymap-content",children:a.find(t=>t.id===e)?.content})]})]})},Xs=({isOpen:e,onClose:t,templateId:a,templateName:s,action:n,onSuccess:i})=>{const[r,l]=O.useState([]),[o,c]=O.useState([]),[d,u]=O.useState(!1),[h,m]=O.useState(!1),[p,f]=O.useState(null),[x,g]=O.useState(null),{session:v,account:y}=Fe(),{addNotification:j,showSuccess:b,showError:N}=xt();O.useEffect(()=>{e&&y&&w()},[e,y,a]);const w=async()=>{if(y){u(!0);try{if("stake"===n){const{apiService:e}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),t=`${e.atomicAssetsAPI}/atomicassets/v1/assets?owner=${y}&template_id=${a}&page=1&limit=100&order=desc&sort=asset_id`,s=await e.fetchWithRetry(t),n=await s.json();l(n.data||[])}else{const{apiService:e}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),t=await e.waxRpcCall("/v1/chain/get_table_rows",{json:!0,code:"farms.waxdao",scope:"farms.waxdao",table:"stakers",lower_bound:y,upper_bound:y,limit:1}),a=t.rows.find(e=>e.user===y),s=a?.staked_assets||[];if(0===s.length)l([]);else{const t=await e.fetchWithRetry(`${e.atomicAssetsAPI}/atomicassets/v1/assets?ids=${s.join(",")}&page=1&limit=1000`);if(!t.ok)throw new Error("Failed to fetch asset details");const a=await t.json();l(a.data||[])}}}catch(e){De.error("Failed to fetch staking assets","NFTStakingModal.fetchAssets",e,{account:y}),j({type:"error",message:"Failed to load assets"})}finally{u(!1)}}};return e?Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"modal-content nft-staking-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h2",{children:["stake"===n?"Stake":"Unstake"," ",s," NFTs"]}),Se.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),Se.jsx("div",{className:"modal-body",children:d?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsxs("p",{children:["Loading your ",s," NFTs..."]})]}):h?Se.jsxs("div",{className:"processing-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsxs("p",{children:["stake"===n?"Staking":"Unstaking"," your NFTs..."]}),p&&Se.jsxs("div",{className:"batch-progress",children:[Se.jsx("div",{className:"progress-bar",children:Se.jsx("div",{className:"progress-fill",style:{width:p.current/p.total*100+"%"}})}),Se.jsxs("p",{children:["Processing ",p.current," of ",p.total," NFTs"]})]}),x&&Se.jsxs("div",{className:"transaction-results",children:[Se.jsxs("div",{className:"results-summary",children:[Se.jsxs("div",{className:"success-count",children:["\u2705 ",x.successful_transactions.length," successful"]}),x.failed_transactions.length>0&&Se.jsxs("div",{className:"error-count",children:["\u274c ",x.failed_transactions.length," failed"]})]}),x.failed_transactions.length>0&&Se.jsxs("div",{className:"failed-transactions",children:[Se.jsx("h4",{children:"Failed Transactions:"}),x.failed_transactions.slice(0,5).map(e=>Se.jsxs("div",{className:"failure-item",children:[Se.jsxs("span",{children:["#",e.asset_id]}),Se.jsx("span",{className:"error-message",children:e.error})]},e.asset_id)),x.failed_transactions.length>5&&Se.jsxs("p",{children:["... and ",x.failed_transactions.length-5," more"]})]})]})]}):Se.jsxs(Se.Fragment,{children:[Se.jsxs("div",{className:"selection-controls",children:[Se.jsx("button",{className:"btn btn-secondary",onClick:()=>{o.length===r.length?c([]):c(r.map(e=>e.asset_id))},children:o.length===r.length?"Deselect All":"Select All"}),Se.jsxs("span",{className:"selection-count",children:[o.length," of ",r.length," selected"]})]}),Se.jsx("div",{className:"asset-grid",children:0===r.length?Se.jsx("div",{className:"no-assets",children:Se.jsxs("p",{children:["No ",s," NFTs available to ",n]})}):r.map(e=>Se.jsxs("div",{className:"asset-item "+(o.includes(e.asset_id)?"selected":""),onClick:()=>{return t=e.asset_id,void c(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[Se.jsx(Qa,{src:e.image||`https://ipfs.io/ipfs/${e.data?.img||"placeholder"}`,alt:e.name}),Se.jsxs("div",{className:"asset-id",children:["#",e.asset_id]}),o.includes(e.asset_id)&&Se.jsx("div",{className:"selection-indicator",children:"\u2713"})]},e.asset_id))})]})}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),Se.jsx("button",{className:"btn btn-primary",onClick:async()=>{if(v&&0!==o.length){m(!0),f({current:0,total:o.length}),g(null);try{let e;if(e="stake"===n?await Xa.stakeNFTsBatch(v,o,"pixeljourney"):await Xa.unstakeNFTsBatch(v,o),g(e),e.success)b("Transaction Successful",`Successfully ${n}d ${e.successful_transactions.length} ${s} NFT${e.successful_transactions.length>1?"s":""}`),setTimeout(()=>{i?.(),t()},2e3);else{const t=e.successful_transactions.length,a=e.failed_transactions.length;t>0?b("Partial Success",`${t} NFTs ${n}d successfully, ${a} failed`):N("Transaction Failed",`Failed to ${n} NFTs. Please try again.`)}}catch(e){De.error(`NFT ${n} operation failed`,"NFTStakingModal.handleBatchAction",e,{action:n,selectedAssetsCount:o.length});const t=e instanceof Error?e.message:`Failed to ${n} NFTs`;N("Transaction Error",t)}finally{m(!1),f(null)}}},disabled:0===o.length||h,children:h?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"loading-spinner"}),"stake"===n?"Staking...":"Unstaking..."]}):`${"stake"===n?"Stake":"Unstake"} ${o.length} NFT${1!==o.length?"s":""}`})]})]})}):null},Hs=e=>({PXJ:"/img/tokens/pxj.png",WUF:"/img/tokens/wuf.png",WAX:"/img/tokens/wax.png",PIXAL:"/img/tokens/pixal.png"}[e.toUpperCase()]||"/img/tokens/default.png"),qs=({isOpen:e,onClose:t,action:a,farmName:s="pxjfarm1",onSuccess:n})=>{const{session:i}=Fe(),{showSuccess:r,showError:l}=xt(),[o,c]=O.useState(""),[d,u]=O.useState(!1),[h,m]=O.useState(null),[p,f]=O.useState(null),[x,g]=O.useState(0),[v,y]=O.useState(!1),j=O.useCallback(async()=>{if(i){y(!0);try{const e=await Xa.getTokenFarmInfo(s);m(e);const t=await Xa.getTokenStakingInfo(i.actor.toString(),s);f(t);const a=await fetch("https://wax.greymass.com/v1/chain/get_currency_balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"pixeljourney",account:i.actor.toString(),symbol:"PXJ"})});if(a.ok){const e=await a.json(),t=e.length>0?parseFloat(e[0].split(" ")[0]):0;g(t)}}catch(e){console.error("Error fetching data:",e),l("Failed to load staking data")}finally{y(!1)}}},[i,y,s,m,f,g,l]);O.useEffect(()=>{e&&i&&j()},[e,i,s,j]);const b=e=>e.toLocaleString(void 0,{minimumFractionDigits:4,maximumFractionDigits:4});if(!e)return null;return Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"modal-content token-staking-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h3",{children:(()=>{switch(a){case"stake":return"Stake PXJ Tokens";case"unstake":return"Unstake PXJ Tokens";case"claim":return"Claim Rewards";default:return"Token Staking"}})()}),Se.jsx("button",{className:"close-btn",onClick:t,children:"\xd7"})]}),Se.jsx("div",{className:"modal-body",children:v?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading staking data..."})]}):Se.jsxs(Se.Fragment,{children:[h&&Se.jsxs("div",{className:"farm-info-section",children:[Se.jsx("h4",{children:"Farm Information"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"label",children:"Farm:"}),Se.jsx("span",{className:"value",children:h.farm_name})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"label",children:"Total Staked:"}),Se.jsxs("span",{className:"value",children:[b(h.total_staked)," PXJ"]})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"label",children:"Vesting Period:"}),Se.jsxs("span",{className:"value",children:[Math.floor(h.vesting_time/86400)," days"]})]})]})]}),p&&Se.jsxs("div",{className:"user-stake-info",children:[Se.jsx("h4",{children:"Your Staking Position"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"label",children:"Staked Amount:"}),Se.jsxs("span",{className:"value",children:[b(p.staked_amount)," PXJ"]})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"label",children:"Pending Rewards:"}),Se.jsx("span",{className:"value",children:p.pending_rewards.map(e=>`${b(e.amount)} ${e.token}`).join(", ")||"None"})]}),Se.jsxs("div",{className:"info-item",children:[Se.jsx("span",{className:"label",children:"Unlock Time:"}),Se.jsx("span",{className:"value",children:(e=>{const t=e-Date.now()/1e3;if(t<=0)return"Available now";const a=Math.floor(t/86400),s=Math.floor(t%86400/3600),n=Math.floor(t%3600/60);return a>0?`${a}d ${s}h remaining`:s>0?`${s}h ${n}m remaining`:`${n}m remaining`})(p.vesting_time)})]})]})]}),Se.jsx("div",{className:"balance-info",children:Se.jsxs("div",{className:"balance-item",children:[Se.jsx(es,{src:Hs("PXJ"),alt:"PXJ"}),Se.jsxs("span",{children:["Available: ",b(x)," PXJ"]})]})}),Se.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),i&&!d)if("claim"===a||o&&!(parseFloat(o)<=0))if("stake"===a&&parseFloat(o)>x)l("Insufficient PXJ balance");else if("unstake"===a&&p&&parseFloat(o)>p.staked_amount)l("Amount exceeds staked balance");else{u(!0);try{let e;const c=`${parseFloat(o).toFixed(4)} PXJ`;switch(a){case"stake":e=await Xa.stakeTokens(i,c,s);break;case"unstake":e=await Xa.unstakeTokens(i,c,s);break;case"claim":e=await Xa.claimTokenFarmRewards(i,s);break;default:throw new Error("Invalid action")}e.success?(r(`Successfully ${"stake"===a?"staked":"unstake"===a?"unstaked":"claimed"} tokens!`),n?.(),t()):l(e.error||`Failed to ${a} tokens`)}catch(c){console.error(`Error ${a}ing tokens:`,c),l(c instanceof Error?c.message:`Failed to ${a} tokens`)}finally{u(!1)}}else l("Please enter a valid amount")},className:"staking-form",children:["claim"!==a&&Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{htmlFor:"amount",children:"Amount (PXJ)"}),Se.jsxs("div",{className:"input-group",children:[Se.jsx("input",{type:"number",id:"amount",value:o,onChange:e=>c(e.target.value),placeholder:"0.0000",step:"0.0001",min:"0",max:"stake"===a?x:p?.staked_amount||0,required:!0,disabled:d}),Se.jsx("button",{type:"button",className:"max-btn",onClick:()=>{c(("stake"===a?x:p?.staked_amount||0).toFixed(4))},disabled:d,children:"MAX"})]})]}),"claim"===a&&p&&p.pending_rewards.length>0&&Se.jsxs("div",{className:"rewards-preview",children:[Se.jsx("h4",{children:"Rewards to Claim:"}),Se.jsx("div",{className:"rewards-list",children:p.pending_rewards.map((e,t)=>Se.jsxs("div",{className:"reward-item",children:[Se.jsx(es,{src:Hs(e.token),alt:e.token}),Se.jsxs("span",{children:[b(e.amount)," ",e.token]})]},t))})]}),Se.jsxs("div",{className:"form-actions",children:[Se.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,disabled:d,children:"Cancel"}),Se.jsx("button",{type:"submit",className:"btn btn-primary",disabled:d||"claim"!==a&&!o,children:(()=>{if(d)return"Processing...";switch(a){case"stake":return"Stake Tokens";case"unstake":return"Unstake Tokens";case"claim":return"Claim Rewards";default:return"Submit"}})()})]})]})]})})]})})},Js=async(e,t)=>{try{const t=await dt.getSales({template:e,limit:10});if(t&&t.data.length>0){const e=t.data.reduce((e,t)=>e+parseFloat(t.price?.amount||"0"),0)/t.data.length;return Math.floor(100*e)}}catch(a){De.warn("Could not fetch template sales data","Staking",a)}return{Common:1e3,Uncommon:2500,Rare:5e3,Epic:15e3,Legendary:5e4}[t]||1e3},Vs=async e=>{try{const t=await dt.getSales({template:e,limit:5});if(t&&t.data.length>0){const e=t.data.map(e=>parseFloat(e.price?.amount||"0")),a=Math.min(...e.filter(e=>e>0));return Math.floor(a)}}catch(t){De.warn("Could not fetch template listings","Staking",t)}return 50},Gs=({template:e,isOpen:t,onClose:a})=>t&&e?Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal-content quick-buy-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsxs("h3",{children:["Quick Buy - ",e.name]}),Se.jsx("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),Se.jsx("div",{className:"modal-body",children:Se.jsxs("div",{className:"buy-item-preview",children:[Se.jsx(Qa,{src:e.image,alt:e.name}),Se.jsxs("div",{className:"item-details",children:[Se.jsx("h4",{children:e.name}),Se.jsx("p",{className:"rarity",children:e.rarity}),Se.jsxs("p",{className:"price",children:[e.market_price||"N/A"," WAX"]}),Se.jsxs("p",{className:"available",children:[e.available_for_sale||0," available"]})]})]})}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),Se.jsx("button",{className:"btn btn-primary",children:"Buy Now"})]})]})}):null,Ks=()=>{const{session:e,isConnected:t,login:a}=Fe(),{showSuccess:s,showError:n}=xt(),[i,r]=O.useState(!1),[l,o]=O.useState([]),[c,d]=O.useState({pxj:0,wuf:0}),[u,h]=O.useState(!1),[m,p]=O.useState(0),[f,x]=O.useState(null),[g,v]=O.useState(!1),[y,j]=O.useState(!1),[b,N]=O.useState(!1),[w,k]=O.useState(null),[_,S]=O.useState(!1),[C,A]=O.useState(null),[T,P]=O.useState(null),[E,I]=O.useState(!1),[F,$]=O.useState("stake"),[L,M]=O.useState(!1),[R,W]=O.useState(0),D=O.useMemo(()=>[{template_id:"1001",name:"Black Ingredient",type:"Legendary",rarity:"Legendary",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:50,wuf:25},estimated_value:1e5,apr:120,market_price:2500,available_for_sale:3},{template_id:"1002",name:"Tertiary Ingredient",type:"Epic",rarity:"Epic",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:10,wuf:5},estimated_value:25e3,apr:80,market_price:500,available_for_sale:12},{template_id:"1003",name:"Secondary Ingredient",type:"Rare",rarity:"Rare",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:2,wuf:1},estimated_value:5e3,apr:40,market_price:100,available_for_sale:25},{template_id:"1004",name:"Primary Ingredient",type:"Common",rarity:"Common",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:.1,wuf:.05},estimated_value:1e3,apr:10,market_price:25,available_for_sale:50}],[]),B=O.useCallback(async()=>{h(!0);try{if(!e)return o(D),void h(!1);try{const{apiService:t}=await K(async()=>{const{apiService:e}=await Promise.resolve().then(()=>ut);return{apiService:e}},void 0),a=await t.fetchWithRetry(`${t.atomicAssetsAPI}/atomicassets/v1/templates?collection_name=pixeljourney&schema_name=ingredients&page=1&limit=100&order=desc&sort=created`);if(!a.ok)throw new Error("AtomicAssets API failed");const s=await a.json(),n=s.data.slice(0,10).map(e=>e.template_id),i=await t.getAssetCountsBatch(n,e.actor.toString()),r=(await Promise.all(s.data.slice(0,10).map(async t=>{try{const s=i.data[t.template_id]||0;let n=0;try{const t=await fetch("https://wax.greymass.com/v1/chain/get_table_rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"farms.waxdao",scope:"farms.waxdao",table:"stakers",lower_bound:Gt.safeGetActor(e),upper_bound:Gt.safeGetActor(e),limit:1})});if(t.ok){const a=(await t.json()).rows.find(t=>t.user===e.actor.toString());n=(a?.staked_assets||[]).length}}catch(a){De.warn("Failed to fetch staked count for template","Staking",{templateId:t.template_id,error:a})}const r=String(t.immutable_data?.rarity||"Common");let l=.1,o=5;switch(r.toLowerCase()){case"legendary":l=50,o=120;break;case"epic":l=10,o=80;break;case"rare":l=2,o=40;break;case"uncommon":l=.5,o=20;break;default:l=.1,o=10}return{template_id:t.template_id,name:t.immutable_data?.name||`Template ${t.template_id}`,type:t.immutable_data?.type||r,rarity:r,image:t.immutable_data?.img?`https://ipfs.io/ipfs/${t.immutable_data.img}`:"",owned_count:s,staked_count:n,rewards_per_hour:{pxj:l,wuf:.5*l},estimated_value:await Js(t.template_id,r),apr:o,market_price:await Vs(t.template_id),available_for_sale:Math.floor(20*Math.random())+1}}catch(a){return De.error("Error processing template","Staking",a),null}}))).filter(e=>null!==e);o(r.length>0?r:D),i.errors.length>0&&De.warn("Some template counts could not be fetched","Staking",{errors:i.errors})}catch(t){De.warn("API fetch failed, using default templates","Staking",t),o(D)}}catch(a){De.error("Failed to fetch NFT templates","Staking",a),o(D)}finally{h(!1)}},[e,h,o,D]),z=O.useCallback(async()=>{if(e)try{const t=await Xa.getStakingInfo(e.actor.toString()),a=t.pending_rewards.reduce((e,t)=>("PXJ"===t.token?e.pxj=t.amount:"WUF"===t.token&&(e.wuf=t.amount),e),{pxj:0,wuf:0});d(a),p(t.total_staking_power);const s=l.map(e=>{const a=t.staked_nfts.filter(t=>t.template_id===e.template_id);return{...e,staked_count:a.length,rewards_per_hour:a.length>0?a[0].rewards_per_hour:e.rewards_per_hour}});o(s)}catch(t){De.error("Failed to fetch rewards","Staking",t);const a=Date.now(),s=localStorage.getItem(`lastClaimTime_${Gt.safeGetActor(e)}`)||a.toString(),n=(a-parseInt(s))/1e3/3600,i=l.reduce((e,t)=>{const a=t.staked_count*t.rewards_per_hour.pxj*Math.floor(n),s=t.staked_count*t.rewards_per_hour.wuf*Math.floor(n);return{pxj:e.pxj+a,wuf:e.wuf+s}},{pxj:0,wuf:0});d(i)}},[e,l,d,p,o]),X=O.useCallback(async()=>{if(e){M(!0);try{const t=await Xa.getTokenFarmInfo("pxjfarm1");P(t);const a=await Xa.getTokenStakingInfo(e.actor.toString(),"pxjfarm1");A(a);const s=await fetch("https://wax.greymass.com/v1/chain/get_currency_balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"pixeljourney",account:e.actor.toString(),symbol:"PXJ"})});if(s.ok){const e=await s.json(),t=e.length>0?parseFloat(e[0].split(" ")[0]):0;W(t)}}catch(t){De.error("Failed to fetch token staking data","Staking",t)}finally{M(!1)}}},[e,M,P,A,W]),H=e=>{$(e),I(!0)},q=e=>{k(e),N(!0)},J=()=>{N(!1),k(null)},V=e=>{switch(e.toLowerCase()){case"legendary":return"#f59e0b";case"epic":return"#8b5cf6";case"rare":return"#3b82f6";case"uncommon":return"#10b981";default:return"#6b7280"}};return O.useEffect(()=>{B(),e&&(z(),X())},[e,B,z,X]),O.useEffect(()=>{const t=setInterval(()=>{e&&(z(),X())},3e4);return()=>clearInterval(t)},[e,l,z,X]),O.useEffect(()=>{const e=l.reduce((e,t)=>e+t.staked_count*(t.rewards_per_hour.pxj+t.rewards_per_hour.wuf),0);p(e)},[l]),t?Se.jsxs("div",{className:"staking-container",children:[Se.jsx("div",{className:"staking-header",children:Se.jsxs("div",{className:"header-content",children:[Se.jsx("h1",{children:"NFT Staking Dashboard"}),Se.jsxs("button",{className:"refresh-btn",onClick:async()=>{r(!0),await Promise.all([B(),z(),X()]),r(!1)},disabled:i,children:[i?"\ud83d\udd04":"\u21bb"," Refresh"]})]})}),Se.jsx("div",{className:"staking-portal-section",children:Se.jsxs("div",{className:"portal-card",children:[Se.jsxs("div",{className:"portal-header",children:[Se.jsx("div",{className:"portal-icon",children:"\ud83d\ude80"}),Se.jsxs("div",{className:"portal-info",children:[Se.jsx("h2",{children:"Advanced Staking Portal"}),Se.jsx("p",{children:"Access our comprehensive staking platform with advanced features, analytics, and enhanced rewards management."})]})]}),Se.jsxs("div",{className:"portal-features",children:[Se.jsxs("div",{className:"feature-item",children:[Se.jsx("span",{className:"feature-icon",children:"\ud83d\udcca"}),Se.jsx("span",{children:"Advanced Analytics"})]}),Se.jsxs("div",{className:"feature-item",children:[Se.jsx("span",{className:"feature-icon",children:"\u26a1"}),Se.jsx("span",{children:"Enhanced Rewards"})]}),Se.jsxs("div",{className:"feature-item",children:[Se.jsx("span",{className:"feature-icon",children:"\ud83d\udd27"}),Se.jsx("span",{children:"Advanced Tools"})]})]}),Se.jsx("div",{className:"portal-actions",children:Se.jsxs("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary portal-btn",children:["Launch Staking Portal",Se.jsx("svg",{className:"external-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})}),Se.jsxs("div",{className:"stats-bar",style:{display:"none"},children:[Se.jsxs("div",{className:"stat",children:[Se.jsx(es,{src:"/img/tokens/pxj.png",alt:"PXJ"}),Se.jsx("span",{children:"PXJ Balance: 0"})]}),Se.jsxs("div",{className:"stat",children:[Se.jsx(es,{src:"/img/tokens/wuf.png",alt:"WUF"}),Se.jsx("span",{children:"WUF Balance: 0"})]})]}),Se.jsxs("div",{className:"dashboard-row",children:[Se.jsxs("div",{className:"rewards-section",id:"rewardsSection",style:{display:c.pxj>0||c.wuf>0?"block":"none"},children:[Se.jsxs("div",{className:"rewards-header",children:[Se.jsx("h3",{children:"Claimable Rewards"}),Se.jsx("div",{className:"simulation-toggle",onClick:()=>S(!_),children:Se.jsx("div",{className:"toggle "+(_?"active":"")})})]}),Se.jsxs("div",{id:"claimableRewards",children:[c.pxj.toFixed(2)," PXJ + ",c.wuf.toFixed(2)," WUF"]}),Se.jsx("button",{className:"claim-btn",onClick:async()=>{if(e)if(0!==c.pxj||0!==c.wuf){r(!0);try{const t=await Xa.claimAllRewards(e,"pixeljourney");if(t.success){const t=`PXJ: ${c.pxj.toFixed(1)} | WUF: ${c.wuf.toFixed(1)}`;s("Success",`Rewards claimed successfully! ${t}`),d({pxj:0,wuf:0}),await z();const a=Date.now();localStorage.setItem(`lastClaimTime_${Gt.safeGetActor(e)}`,a.toString())}else n("Error",t.error||"Failed to claim rewards")}catch(t){De.error("Failed to claim rewards","Staking",t),n("Error","Failed to claim rewards. Please try again.")}finally{r(!1)}}else n("Error","No rewards available to claim");else n("Error","Please connect your wallet first")},disabled:i,children:i?"Claiming...":"Claim All Rewards"}),_&&Se.jsx("div",{className:"simulation-status",children:"\ud83d\udd34 SIMULATION MODE ACTIVE"})]}),Se.jsxs("div",{className:"quick-claim-section",children:[Se.jsx("h4",{children:"Quick Actions"}),Se.jsx("button",{className:"quick-claim-btn",onClick:()=>j(!0),children:"Open Crafting"})]})]}),m>0&&Se.jsxs("div",{className:"total-power",children:[Se.jsx("h3",{children:"Total Staking Power"}),Se.jsxs("div",{className:"power-value-container",children:[Se.jsx("div",{className:"power-value",children:m.toFixed(1)}),Se.jsx("div",{className:"power-rate",children:"/hr"})]}),Se.jsx("p",{children:"Combined rewards per hour from all staked NFTs"})]}),Se.jsxs("div",{className:"token-staking-section",children:[Se.jsxs("div",{className:"token-staking-header",children:[Se.jsx("h2",{children:"PXJ Token Staking"}),Se.jsx("p",{className:"section-description",children:"Stake your PXJ tokens in the pxjfarm1 to earn additional rewards"})]}),L?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading token staking data..."})]}):Se.jsxs("div",{className:"token-staking-content",children:[T&&Se.jsxs("div",{className:"token-farm-card",children:[Se.jsxs("div",{className:"farm-header",children:[Se.jsx("div",{className:"farm-icon",children:Se.jsx(es,{src:"/img/tokens/pxj.png",alt:"PXJ"})}),Se.jsxs("div",{className:"farm-info",children:[Se.jsx("h3",{children:T.farm_name}),Se.jsx("p",{className:"farm-description",children:"PXJ Token Farm"})]})]}),Se.jsxs("div",{className:"farm-stats",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-label",children:"Total Staked"}),Se.jsxs("div",{className:"stat-value",children:[T.total_staked.toLocaleString()," PXJ"]})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-label",children:"Vesting Period"}),Se.jsxs("div",{className:"stat-value",children:[Math.floor(T.vesting_time/86400)," days"]})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-label",children:"Your Balance"}),Se.jsxs("div",{className:"stat-value",children:[R.toLocaleString()," PXJ"]})]})]}),C&&Se.jsxs("div",{className:"user-position",children:[Se.jsx("h4",{children:"Your Staking Position"}),Se.jsxs("div",{className:"position-stats",children:[Se.jsxs("div",{className:"position-item",children:[Se.jsx("span",{className:"label",children:"Staked:"}),Se.jsxs("span",{className:"value",children:[C.staked_amount.toLocaleString()," PXJ"]})]}),Se.jsxs("div",{className:"position-item",children:[Se.jsx("span",{className:"label",children:"Pending Rewards:"}),Se.jsx("span",{className:"value",children:C.pending_rewards.length>0?C.pending_rewards.map(e=>`${e.amount.toFixed(4)} ${e.token}`).join(", "):"None"})]}),Se.jsxs("div",{className:"position-item",children:[Se.jsx("span",{className:"label",children:"Unlock Time:"}),Se.jsx("span",{className:"value",children:C.vesting_time>Date.now()/1e3?`${Math.ceil((C.vesting_time-Date.now()/1e3)/86400)} days remaining`:"Available now"})]})]})]}),Se.jsxs("div",{className:"token-actions",children:[Se.jsx("button",{className:"btn btn-primary",onClick:()=>H("stake"),disabled:!t||R<=0,children:"Stake PXJ"}),Se.jsx("button",{className:"btn btn-secondary",onClick:()=>H("unstake"),disabled:!t||!C||C.staked_amount<=0,children:"Unstake PXJ"}),Se.jsx("button",{className:"btn btn-accent",onClick:()=>H("claim"),disabled:!t||!C||0===C.pending_rewards.length,children:"Claim Rewards"})]})]}),!t&&Se.jsxs("div",{className:"connect-prompt",children:[Se.jsx("h3",{children:"Connect Your Wallet"}),Se.jsx("p",{children:"Connect your WAX wallet to view and manage your PXJ token staking"}),Se.jsx("button",{className:"btn btn-primary",onClick:a,children:"Connect Wallet"})]})]})]}),Se.jsxs("div",{className:"nft-staking-section",children:[Se.jsxs("div",{className:"nft-staking-header",children:[Se.jsx("h2",{children:"Pixel Journey NFT Staking"}),Se.jsx("p",{className:"section-description",children:"Stake your ingredients to earn PXJ and WUF rewards"})]}),u?Se.jsxs("div",{className:"loading-state",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("p",{children:"Loading NFT staking data..."})]}):Se.jsx("div",{className:"template-grid",children:l.map(e=>Se.jsxs("div",{className:"template-card",children:[Se.jsxs("div",{className:"template-image",style:{backgroundImage:`url(${e.image})`},children:[e.owned_count>0&&Se.jsx("div",{className:"asset-count",children:e.owned_count}),e.staked_count>0&&Se.jsxs("div",{className:"staked-count",children:["\u26a1",e.staked_count]}),Se.jsx("div",{className:"rarity-badge",style:{backgroundColor:V(e.rarity)},children:e.rarity}),e.image.includes("placeholder")?e.name:null]}),Se.jsxs("div",{className:"template-info",children:[Se.jsxs("div",{className:"template-header",children:[Se.jsx("div",{className:"template-name",children:e.name}),Se.jsxs("div",{className:"template-apr",children:[e.apr,"% APR"]})]}),Se.jsxs("div",{className:"template-stats",children:[Se.jsxs("div",{className:"stat-row",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:e.rewards_per_hour.pxj}),Se.jsx("div",{className:"stat-label",children:"PXJ/hr"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:e.rewards_per_hour.wuf}),Se.jsx("div",{className:"stat-label",children:"WUF/hr"})]})]}),Se.jsx("div",{className:"staking-status",children:Se.jsxs("span",{children:["Staked: ",e.staked_count,"/",e.owned_count]})})]}),Se.jsx("div",{className:"template-actions",children:e.owned_count>0?Se.jsx("button",{className:"btn btn-primary",onClick:()=>(e=>{x(e),v(!0)})(e),children:"Manage Staking"}):Se.jsx("button",{className:"btn btn-secondary",onClick:()=>q(e),children:"Quick Buy"})})]})]},e.template_id))})]}),Se.jsxs("div",{className:"crafting-mechanics",children:[Se.jsx("h2",{children:"PXJ Lockup & Crafting Mechanics"}),Se.jsxs("div",{className:"mechanics-content",children:[Se.jsxs("div",{className:"mechanics-overview",children:[Se.jsx("h3",{children:"\ud83d\udd12 PXJ Lockup System"}),Se.jsx("p",{children:"Lock your PXJ tokens to participate in advanced crafting and upgrade systems. Each month, we distribute additional NFT rewards to collectors based on their PXJ lockup value."}),Se.jsx("div",{className:"leaderboard-info",children:Se.jsxs("div",{className:"leaderboard-card",children:[Se.jsxs("div",{className:"leaderboard-header",children:[Se.jsx("span",{className:"leaderboard-icon",children:"\ud83c\udfc6"}),Se.jsx("h4",{children:"Monthly Leaderboard Rewards"})]}),Se.jsxs("div",{className:"leaderboard-details",children:[Se.jsxs("p",{children:[Se.jsx("strong",{children:"Entry Requirement:"})," 25,000 PXJ locked per entry"]}),Se.jsx("p",{children:"Rewards distributed based on upgraded ingredient lockup value"}),Se.jsx("a",{href:"https://lb.pixeljourney.xyz/",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",children:"View Leaderboard"})]})]})})]}),Se.jsxs("div",{className:"crafting-process",children:[Se.jsx("h3",{children:"\u2697\ufe0f Ingredient Combination System"}),Se.jsxs("div",{className:"process-flow",children:[Se.jsxs("div",{className:"process-step",children:[Se.jsx("div",{className:"step-icon",children:"\ud83e\uddea"}),Se.jsx("h4",{children:"Primary Ingredients"}),Se.jsx("p",{children:"Common base materials that form the foundation of all crafting recipes"})]}),Se.jsx("div",{className:"process-arrow",children:"\u2192"}),Se.jsxs("div",{className:"process-step",children:[Se.jsx("div",{className:"step-icon",children:"\u26a1"}),Se.jsx("h4",{children:"Secondary Ingredients"}),Se.jsx("p",{children:"Rare catalysts that enhance and modify the properties of primary ingredients"})]}),Se.jsx("div",{className:"process-arrow",children:"\u2192"}),Se.jsxs("div",{className:"process-step",children:[Se.jsx("div",{className:"step-icon",children:"\ud83d\udc8e"}),Se.jsx("h4",{children:"Tertiary Ingredients"}),Se.jsx("p",{children:"Epic components that unlock powerful abilities and unique traits"})]}),Se.jsx("div",{className:"process-arrow",children:"\u2192"}),Se.jsxs("div",{className:"process-step",children:[Se.jsx("div",{className:"step-icon",children:"\ud83c\udf1f"}),Se.jsx("h4",{children:"Black Ingredients"}),Se.jsx("p",{children:"Legendary materials that create the most powerful and sought-after items"})]})]})]}),Se.jsx("div",{className:"learn-more-section",children:Se.jsxs("div",{className:"learn-more-card",children:[Se.jsx("h3",{children:"\ud83d\udcda Want to Learn More?"}),Se.jsx("p",{children:"Dive deeper into the Pixel Journey ecosystem with our comprehensive documentation covering all aspects of crafting, staking, and gameplay mechanics."}),Se.jsxs("div",{className:"learn-actions",children:[Se.jsx(U,{to:"/learn",className:"btn-primary",children:"Visit Learn Page"}),Se.jsx("a",{href:"https://docs.pixeljourney.xyz/season-1/recycling-and-crafting",target:"_blank",rel:"noopener noreferrer",className:"btn-secondary",children:"Journey Docs"})]})]})})]})]}),Se.jsx(Xs,{isOpen:g,onClose:()=>{v(!1),x(null)},templateId:f?.template_id||"",templateName:f?.name||"",action:"stake",onSuccess:()=>{B(),z()}}),Se.jsx(qs,{isOpen:E,onClose:()=>{I(!1)},action:F,farmName:"pxjfarm1",onSuccess:()=>{X(),z()}}),Se.jsx($a,{isOpen:y,onClose:()=>j(!1),ingredient:null}),Se.jsx(Gs,{template:w,isOpen:b,onClose:J})]}):Se.jsxs("div",{className:"staking-container",children:[Se.jsxs("div",{className:"connect-wallet-prompt",children:[Se.jsx("h2",{children:"Connect Your Wallet"}),Se.jsx("p",{children:"Connect your WAX wallet to access NFT staking features"}),Se.jsx("button",{className:"btn btn-primary",onClick:a,children:"Connect Wallet"})]}),Se.jsxs("div",{className:"nft-staking-section",children:[Se.jsx("h2",{children:"Pixel Journey NFT Staking"}),Se.jsx("p",{className:"section-description",children:"Stake your Pixel Journey ingredients to earn PXJ and WUF rewards"}),Se.jsx("div",{className:"template-grid",children:D.map(e=>Se.jsxs("div",{className:"template-card",children:[Se.jsxs("div",{className:"template-image",children:[Se.jsx(Qa,{src:e.image,alt:e.name,width:160,height:160,fallbackText:e.name}),Se.jsx("div",{className:"rarity-badge",style:{backgroundColor:V(e.rarity)},children:e.rarity})]}),Se.jsxs("div",{className:"template-info",children:[Se.jsxs("div",{className:"template-header",children:[Se.jsx("div",{className:"template-name",children:e.name}),Se.jsxs("div",{className:"template-apr",children:[e.apr,"% APR"]})]}),Se.jsxs("div",{className:"template-stats",children:[Se.jsxs("div",{className:"stat-row",children:[Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:e.rewards_per_hour.pxj}),Se.jsx("div",{className:"stat-label",children:"PXJ/hr"})]}),Se.jsxs("div",{className:"stat-item",children:[Se.jsx("div",{className:"stat-value",children:e.rewards_per_hour.wuf}),Se.jsx("div",{className:"stat-label",children:"WUF/hr"})]})]}),Se.jsx("div",{className:"staking-status",children:Se.jsx("span",{children:"Connect wallet to view your assets"})})]}),Se.jsx("div",{className:"template-actions",children:Se.jsx("button",{className:"btn btn-secondary",onClick:()=>q(e),children:"Quick Buy"})})]})]},e.template_id))})]}),Se.jsx(Gs,{template:w,isOpen:b,onClose:J})]})};const Ys=new class{constructor(){M(this,"baseUrl","https://wax-api.hivebp.io/api")}async getAttributeFilters(e,t){try{const a=new URL(`${this.baseUrl}/filter-attributes/${e}`);t&&a.searchParams.append("schema",t);const s=await fetch(a.toString());if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(a){return De.error("Error fetching attribute filters from API, will use fallback","AttributeService",a),{}}}extractAttributesFromNFTs(e,t){const a=new Map;(t?e.filter(e=>e.schema===t):e).forEach(e=>{e.traits&&Object.entries(e.traits).forEach(([e,t])=>{if(null!=t){a.has(e)||a.set(e,new Map);const s=a.get(e),n=String(t),i=s.get(n)||0;s.set(n,i+1)}})});const s={};return a.forEach((e,t)=>{const a=[];e.forEach((e,t)=>{a.push({value:t,numMinted:e,maxSupply:e})}),a.sort((e,t)=>t.numMinted-e.numMinted),s[t]={values:a}}),s}formatAttributesForQuery(e){const t=[];return Object.entries(e).forEach(([e,a])=>{a.forEach(a=>{t.push(`${e}:${encodeURIComponent(a)}`)})}),t.join("&")}parseAttributeQuery(e){const t={};if(!e)return t;return e.split("&").forEach(e=>{const[a,s]=e.split(":");if(a&&s){const e=decodeURIComponent(s);t[a]||(t[a]=[]),t[a].push(e)}}),t}},Qs=({isOpen:e,onClose:t,onSuccess:a})=>{const{account:s}=Da(),{showSuccess:n,showError:i}=xt(),[r,l]=O.useState([]),[o,c]=O.useState([]),[d,u]=O.useState(new Set),[h,m]=O.useState(null),[p,f]=O.useState(!1),[x,g]=O.useState(""),[v,y]=O.useState(1),[j,b]=O.useState(0),N=O.useCallback(async(e=1)=>{if(s){f(!0),g("");try{const t=12*(e-1),a=await Ba.getUserPixalAssets(s,12,t);l(a),b(a.length)}catch(t){De.error("Failed to load user Pixal assets","TokenizeFromInventoryModal.loadUserAssets",t,{account:s,page:e}),g("Failed to load your Pixal assets. Please try again."),i("Failed to load assets")}finally{f(!1)}}},[s,12,i]),w=O.useCallback(async()=>{try{const e=await Ba.getFeeTokens();c(e)}catch(e){De.error("Failed to load fee tokens","TokenizeFromInventoryModal.loadFeeTokens",e),i("Failed to load fee tokens")}},[i]);O.useEffect(()=>{e&&s&&(N(v),w())},[e,s,v,N,w]);const k=e=>{y(e),u(new Set)};if(!e)return null;const _=Math.ceil(j/12),S=d.size;return z.createPortal(Se.jsx("div",{className:"modal-overlay",onClick:t,children:Se.jsxs("div",{className:"tokenize-inventory-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Tokenize from Inventory"}),Se.jsx("button",{className:"close-button",onClick:t,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[x&&Se.jsx("div",{className:"error-message",children:x}),Se.jsxs("div",{className:"selection-controls",children:[Se.jsx("div",{className:"selection-info",children:Se.jsxs("span",{children:[S," asset",1!==S?"s":""," selected"]})}),Se.jsxs("div",{className:"selection-actions",children:[Se.jsx("button",{className:"select-all-btn",onClick:()=>{const e=new Set(r.map(e=>e.assetId.toString()));u(e)},disabled:p,children:"Select All on Page"}),Se.jsx("button",{className:"clear-all-btn",onClick:()=>{u(new Set)},disabled:p||0===S,children:"Clear All"})]})]}),Se.jsxs("div",{className:"assets-section",children:[Se.jsx("h3",{children:"Your Pixal Assets"}),p?Se.jsxs("div",{className:"loading-spinner",children:[Se.jsx("div",{className:"spinner"}),Se.jsx("p",{children:"Loading your assets..."})]}):Se.jsx("div",{className:"assets-grid",children:r.map(e=>Se.jsxs("div",{className:"asset-card "+(d.has(e.assetId.toString())?"selected":""),onClick:()=>(e=>{const t=new Set(d);t.has(e)?t.delete(e):t.add(e),u(t)})(e.assetId.toString()),children:[Se.jsxs("div",{className:"asset-image-container",children:[Se.jsx(Qt,{imageUrl:e.image,alt:e.name,className:"asset-image"}),d.has(e.assetId.toString())&&Se.jsx("div",{className:"selection-indicator",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})})]}),Se.jsxs("div",{className:"asset-info",children:[Se.jsx("h4",{className:"asset-name",children:e.name}),Se.jsxs("p",{className:"asset-id",children:["#",e.assetId.toString()]})]})]},e.assetId))}),_>1&&Se.jsxs("div",{className:"pagination",children:[Se.jsx("button",{className:"pagination-btn",onClick:()=>k(v-1),disabled:1===v||p,children:"Previous"}),Se.jsxs("span",{className:"pagination-info",children:["Page ",v," of ",_]}),Se.jsx("button",{className:"pagination-btn",onClick:()=>k(v+1),disabled:v===_||p,children:"Next"})]})]}),S>0&&Se.jsxs("div",{className:"fee-selection",children:[Se.jsx("h3",{children:"Select Fee Token"}),Se.jsx("div",{className:"fee-tokens-grid",children:o.map((e,t)=>Se.jsxs("div",{className:"fee-option "+(h===e?"selected":""),onClick:()=>m(e),children:[Se.jsxs("div",{className:"fee-info",children:[Se.jsx("span",{className:"fee-amount",children:e.fee}),Se.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&Se.jsxs("div",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]})]}),Se.jsxs("div",{className:"modal-footer",children:[Se.jsx("button",{className:"cancel-button",onClick:t,disabled:p,children:"Cancel"}),Se.jsx("button",{className:"tokenize-button",onClick:async()=>{if(s&&0!==d.size&&h){f(!0);try{const e=Array.from(d),s=await Ba.executeTokenization(e,h);n(`Tokenization transaction prepared for ${e.length} asset(s)`),De.info("Tokenization transaction prepared","TokenizeFromInventoryModal.executeTokenization",{assetIds:e,feeToken:h.symbol,transaction:s}),u(new Set),m(null),t(),a&&a()}catch(e){De.error("Tokenization execution failed","TokenizeFromInventoryModal.executeTokenization",e,{assetIds:Array.from(d),feeToken:h?.symbol}),i("Tokenization failed. Please try again.")}finally{f(!1)}}else i("Please select assets and a fee token")},disabled:p||0===S||!h,children:p?"Processing...":`Tokenize ${S} Asset${1!==S?"s":""}`})]})]})}),document.body)},Zs=({asset:e,isOpen:t,onClose:a,onRedeem:s})=>{const{account:n}=Da(),{showError:i}=xt(),[r,l]=O.useState([]),[o,c]=O.useState(null),[d,u]=O.useState(!1),[h,m]=O.useState(!1),p=async()=>{try{const e=await Ba.getFeeTokens();l(e)}catch(e){De.error("Failed to load fee tokens","AssetDetailModal.loadFeeTokens",e),i("Failed to load fee tokens")}};O.useEffect(()=>{t&&e&&p()},[t,e,p]);return t&&e?Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"asset-detail-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h2",{children:"Asset Details"}),Se.jsx("button",{className:"close-button",onClick:a,children:"\xd7"})]}),Se.jsxs("div",{className:"modal-body",children:[Se.jsxs("div",{className:"asset-main-info",children:[Se.jsx("div",{className:"asset-image-section",children:Se.jsx(Qt,{imageUrl:e.image,alt:e.name,className:"asset-image"})}),Se.jsxs("div",{className:"asset-info-section",children:[Se.jsx("h3",{className:"asset-name",children:e.name}),Se.jsxs("div",{className:"asset-metadata",children:[Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Asset ID:"}),Se.jsx("span",{className:"value",children:e.assetId})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Collection:"}),Se.jsx("span",{className:"value",children:e.collection?.displayName||e.collection?.collectionName})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Schema:"}),Se.jsx("span",{className:"value",children:e.schema})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Mint #:"}),Se.jsx("span",{className:"value",children:e.mint})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Template ID:"}),Se.jsx("span",{className:"value",children:e.template?.templateId})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"WPIXAL Amount:"}),Se.jsxs("span",{className:"value highlight",children:[e.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),e.rarityScore&&Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Rarity Score:"}),Se.jsx("span",{className:"value highlight",children:e.rarityScore.toFixed(2)})]}),e.attributesFloor&&Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Attributes Floor:"}),Se.jsxs("span",{className:"value highlight",children:[e.attributesFloor.toFixed(8)," WPIXAL"]})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Contract:"}),Se.jsx("span",{className:"value",children:e.contract})]}),Se.jsxs("div",{className:"metadata-item",children:[Se.jsx("span",{className:"label",children:"Owner:"}),Se.jsx("span",{className:"value",children:e.owner})]})]}),e.immutableData&&e.immutableData.length>0&&Se.jsxs("div",{className:"asset-attributes",children:[Se.jsx("h4",{children:"NFT Traits"}),Se.jsx("div",{className:"attributes-grid",children:e.immutableData.filter(({key:e,value:t})=>!["image","img","video","audio","model","description","name"].includes(e.toLowerCase())&&t&&null!==t[1]&&void 0!==t[1]&&""!==t[1]).map(({key:e,value:t})=>{const a=e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),s=Array.isArray(t)?t[1]:t;return Se.jsxs("div",{className:"trait-item",children:[Se.jsx("div",{className:"trait-label",children:a}),Se.jsx("div",{className:"trait-value",children:String(s)})]},e)})}),(()=>{const t=e.immutableData.find(e=>"description"===e.key.toLowerCase()),a=t?Array.isArray(t.value)?t.value[1]:t.value:null;return a&&String(a).trim()?Se.jsxs("div",{className:"asset-description",children:[Se.jsx("h4",{children:"Description"}),Se.jsx("p",{children:String(a)})]}):null})()]})]})]}),n&&Se.jsx("div",{className:"redemption-section",children:h?Se.jsxs("div",{className:"redeem-form",children:[Se.jsx("h4",{children:"Redeem Asset"}),Se.jsxs("p",{className:"redeem-description",children:["Redeem this tokenized asset by paying ",e.rwax.redeemAmount.toFixed(8)," WPIXAL plus a fee."]}),Se.jsxs("div",{className:"fee-selection",children:[Se.jsx("h5",{children:"Select Fee Token:"}),Se.jsx("div",{className:"fee-options",children:r.map((e,t)=>Se.jsxs("div",{className:"fee-option "+(o===e?"selected":""),onClick:()=>c(e),children:[Se.jsxs("div",{className:"fee-info",children:[Se.jsx("span",{className:"fee-amount",children:e.fee}),Se.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&Se.jsxs("div",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]}),Se.jsxs("div",{className:"redeem-actions",children:[Se.jsx("button",{className:"cancel-redeem-button",onClick:()=>m(!1),children:"Cancel"}),Se.jsx("button",{className:"confirm-redeem-button",onClick:async()=>{if(e&&o&&n){u(!0);try{s&&await s(e,o),a()}catch(t){De.error("Asset redemption failed","AssetDetailModal.handleRedeem",t,{assetId:e?.assetId,feeToken:o?.symbol}),i("Redemption failed. Please try again.")}finally{u(!1)}}else i("Please select a fee token")},disabled:!o||d,children:d?"Processing...":"Confirm Redemption"})]})]}):Se.jsx("button",{className:"show-redeem-button",onClick:()=>m(!0),children:"Redeem this Asset"})}),!n&&Se.jsx("div",{className:"wallet-connect-message",children:Se.jsx("p",{children:"Connect your wallet to redeem this asset"})})]})]})}):null},en=({limit:e=12,refreshInterval:t=3e4})=>{const[a,s]=O.useState([]),[n,i]=O.useState(!0),[r,l]=O.useState(null),[o,c]=O.useState(null),[d,u]=O.useState(1),[h,m]=O.useState(!0),[p,f]=O.useState(!1),x=O.useCallback(async(t=1,a=!1)=>{try{a?f(!0):(l(null),i(!0));const n=await dt.getRWAXTransfers({limit:e,page:t,order:"desc"});if(!n.success)throw new Error("Failed to fetch RWAX transactions");{const t=n.data;s(a?e=>[...e,...t]:t),m(t.length===e),c(new Date)}}catch(n){De.error("Error fetching RWAX transactions","RWAXLiveTransactions",n),a||l("Failed to load RWAX transactions")}finally{i(!1),f(!1)}},[e]);O.useEffect(()=>{x();const e=setInterval(()=>{x(1,!1),u(1)},t);return()=>clearInterval(e)},[e,t,x]);const g=e=>{try{const t=new Date(e);if(isNaN(t.getTime()))return"Unknown";const a=(new Date).getTime()-t.getTime(),s=Math.floor(a/6e4);return s<0||s<1?"Just now":s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:`${Math.floor(s/1440)}d ago`}catch(t){return"Unknown"}},v=e=>"tokenization"===e?"Tokenized":"Redeemed";return n&&0===a.length?Se.jsxs("div",{className:"rwax-live-transactions",children:[Se.jsxs("div",{className:"rwax-live-transactions-header",children:[Se.jsx("h3",{children:"Live RWAX Transactions"}),Se.jsx("div",{className:"loading-spinner"})]}),Se.jsx("div",{className:"transactions-loading",children:Se.jsx("p",{children:"Loading RWAX transactions..."})})]}):r&&0===a.length?Se.jsxs("div",{className:"rwax-live-transactions",children:[Se.jsxs("div",{className:"rwax-live-transactions-header",children:[Se.jsx("h3",{children:"Live RWAX Transactions"}),Se.jsx("button",{onClick:()=>x(),className:"refresh-button",children:"\ud83d\udd04"})]}),Se.jsxs("div",{className:"transactions-error",children:[Se.jsx("p",{children:r}),Se.jsx("button",{onClick:()=>x(),className:"retry-button",children:"Try Again"})]})]}):Se.jsxs("div",{className:"rwax-live-transactions",children:[Se.jsxs("div",{className:"rwax-live-transactions-header",children:[Se.jsx("h3",{children:"Live RWAX Transactions"}),Se.jsxs("div",{className:"header-actions",children:[o&&Se.jsxs("span",{className:"last-update",children:["Updated ",g(o.toISOString())]}),Se.jsx("button",{onClick:()=>{x(1,!1),u(1)},className:"refresh-button",disabled:n,children:n?"\u23f3":"\ud83d\udd04"})]})]}),Se.jsx("div",{className:"rwax-transactions-grid",children:0===a.length?Se.jsx("div",{className:"no-transactions",children:Se.jsx("p",{children:"No recent RWAX transactions found"})}):a.map((e,t)=>{return Se.jsxs("div",{className:"rwax-transaction-card",children:[Se.jsxs("div",{className:"transaction-header",children:[Se.jsxs("div",{className:"transaction-type",children:[Se.jsx("span",{className:"transaction-icon",children:(a=e.type,"tokenization"===a?"\ud83d\udd04":"\ud83c\udf81")}),Se.jsx("span",{className:`transaction-label ${e.type}`,children:v(e.type)})]}),Se.jsx("span",{className:"transaction-time",children:g(e.created_at_time)})]}),Se.jsxs("div",{className:"transaction-assets",children:[e.assets.slice(0,1).map(e=>{return Se.jsxs("div",{className:"asset-preview",children:[Se.jsx(Qt,{imageUrl:(t=e.data?.img,t?t.startsWith("Qm")||t.startsWith("baf")?`https://ipfs.io/ipfs/${t}`:t.startsWith("/")?`https://ipfs.io/ipfs${t}`:t:"/placeholder-nft.png"),alt:e.name||"Unknown Asset",className:"asset-image"}),Se.jsxs("div",{className:"asset-info",children:[Se.jsx("h4",{className:"asset-name",children:e.name||"Unknown Asset"}),Se.jsxs("p",{className:"asset-mint",children:["#",e.template_mint||e.asset_id||"N/A"]})]})]},e.asset_id);var t}),e.assets.length>1&&Se.jsxs("div",{className:"additional-assets",children:["+",e.assets.length-1," more"]})]}),Se.jsxs("div",{className:"transaction-details",children:[Se.jsxs("div",{className:"transaction-accounts",children:[Se.jsxs("span",{className:"account from",children:["From: ",e.sender_name.length>8?`${e.sender_name.slice(0,6)}...`:e.sender_name]}),Se.jsxs("span",{className:"account to",children:["To: ",e.recipient_name.length>8?`${e.recipient_name.slice(0,6)}...`:e.recipient_name]})]}),Se.jsx("div",{className:"transaction-actions",children:Se.jsx("button",{className:"view-tx-button",onClick:()=>window.open(`https://waxblock.io/transaction/${e.txid}`,"_blank"),title:"View on WAX Block Explorer",children:"\ud83d\udd17"})})]})]},`${e.txid}-${e.transfer_id}-${t}`);var a})}),h&&Se.jsx("div",{className:"load-more-section",children:Se.jsx("button",{onClick:async()=>{if(!p&&h){const e=d+1;u(e),await x(e,!0)}},className:"load-more-button",disabled:p,children:p?Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"loading-spinner small"}),"Loading more..."]}):"Load More Transactions"})})]})},tn={Background:["Nefty Spot","Blue Sky","Forest","Desert","Ocean","Mountain","City","Space","Sunset","Rainbow"],Body:["Pink-Blue Overalls","Red Shirt","Blue Hoodie","Green Jacket","Yellow Dress","Purple Suit","Orange Tank","Black Tee","White Polo","Gray Sweater"],Eyes:["Kawaii Green","Brown","Blue","Hazel","Gray","Amber","Violet","Red","Black","Gold"],Head:["Grey","Black Hair","Brown Hair","Blonde Hair","Red Hair","Blue Hair","Green Hair","Purple Hair","Bald","Hat"]},an=({onFiltersChange:e,initialFilters:t={}})=>{const[a,s]=O.useState({});O.useEffect(()=>{const e={};Object.keys(tn).forEach(a=>{e[a]={isExpanded:!1,selectedValues:new Set(t[a]||[]),searchTerm:""}}),s(e)},[]);const n=O.useCallback((e,t)=>{s(a=>{const s={...a};s[e]||(s[e]={isExpanded:!1,selectedValues:new Set,searchTerm:""});const n=new Set(s[e].selectedValues);return n.has(t)?n.delete(t):n.add(t),s[e]={...s[e],selectedValues:n},s})},[]),i=O.useCallback(e=>{s(t=>({...t,[e]:{...t[e],isExpanded:!t[e]?.isExpanded}}))},[]),r=O.useCallback((e,t)=>{s(a=>({...a,[e]:{...a[e],searchTerm:t}}))},[]),l=O.useCallback(()=>{const e={};Object.keys(tn).forEach(t=>{e[t]={isExpanded:!1,selectedValues:new Set,searchTerm:""}}),s(e)},[]);O.useEffect(()=>{const t={};Object.entries(a).forEach(([e,a])=>{a.selectedValues.size>0&&(t[e]=Array.from(a.selectedValues))}),e(t)},[a,e]);const o=Object.values(a).reduce((e,t)=>e+t.selectedValues.size,0);return Se.jsxs("div",{className:"attribute-filter-container",children:[Se.jsxs("div",{className:"filter-header",children:[Se.jsx("h3",{children:"Pixal Traits"}),o>0&&Se.jsxs("button",{className:"clear-all-button",onClick:l,children:["Clear All (",o,")"]})]}),Object.entries(tn).map(([e])=>{const t=a[e],s=(e=>{const t=a[e]?.searchTerm?.toLowerCase()||"",s=tn[e]||[];return t?s.filter(e=>e.toLowerCase().includes(t)):s})(e),l=t?.selectedValues.size||0;return Se.jsxs("div",{className:"filter-group",children:[Se.jsxs("div",{className:"filter-group-header",onClick:()=>i(e),children:[Se.jsxs("div",{className:"attribute-name",children:[e,l>0&&Se.jsx("span",{className:"selected-count",children:l})]}),Se.jsx("div",{className:"expand-icon "+(t?.isExpanded?"expanded":""),children:"\u25bc"})]}),t?.isExpanded&&Se.jsxs("div",{className:"filter-group-content",children:[Se.jsx("input",{type:"text",placeholder:`Search ${e.toLowerCase()}...`,value:t.searchTerm,onChange:t=>r(e,t.target.value),className:"attribute-search"}),Se.jsx("div",{className:"attribute-values",children:s.length>0?s.map(a=>{const s=t.selectedValues.has(a);return Se.jsx("div",{className:"attribute-value-item "+(s?"selected":""),onClick:()=>n(e,a),children:Se.jsx("span",{className:"attribute-value-text",children:a})},a)}):Se.jsxs("div",{className:"no-results",children:["No ",e.toLowerCase(),' found matching "',t.searchTerm,'"']})})]})]},e)})]})},sn=()=>{const e=B(),{account:t,session:a}=Da(),{showSuccess:s,showError:n}=xt(),[i,r]=O.useState("redeem"),[l,o]=O.useState([]),[c,d]=O.useState([]),[u,h]=O.useState(!1),[m,p]=O.useState(null),[f,x]=O.useState(!1),[g,v]=O.useState(!1),[y,j]=O.useState(!1),[b,N]=O.useState(!1),[w,k]=O.useState(!1),[_,S]=O.useState(null),[C,A]=O.useState(null),[T,P]=O.useState(null),[E,I]=O.useState("confirm"),[F,$]=O.useState(""),[L,M]=O.useState(new Set),[R,W]=O.useState(!1),[D,U]=O.useState(null),[z,X]=O.useState(!1),[H,q]=O.useState(0),[J,V]=O.useState(0),[G,K]=O.useState(0),[Y,Q]=O.useState(!1),[Z,ee]=O.useState({min:"",max:""}),[te,ae]=O.useState(0),[se,ne]=O.useState(!1),[ie]=O.useState(null),[re,le]=O.useState(10),[oe,ce]=O.useState(!1),[de,ue]=O.useState(null),[he,me]=O.useState(!1),[pe,fe]=O.useState(""),[xe,ge]=O.useState("0.0000 WAX"),[ve,ye]=O.useState(1),[je,be]=O.useState(!0),[Ne,we]=O.useState(!1),[ke,_e]=O.useState("rarity_score_desc"),[Ce,Ae]=O.useState(""),[Te,Pe]=O.useState({}),[Ee,Ie]=O.useState(""),[Fe,$e]=O.useState(new Set),[Le,Me]=O.useState(new Map),Re=O.useMemo(()=>{if(!Ee.trim())return l;const e=Ee.toLowerCase();return l.filter(t=>{if(t.name?.toLowerCase().includes(e))return!0;if(t.collection?.collectionName?.toLowerCase().includes(e)||t.collection?.displayName?.toLowerCase().includes(e))return!0;if(t.template?.templateId?.toString().includes(e))return!0;if(t.immutableData)for(const a of t.immutableData)if(a.key?.toLowerCase().includes(e)||a.value?.[1]?.toString().toLowerCase().includes(e))return!0;if(t.mutableData)for(const a of t.mutableData)if(a.key?.toLowerCase().includes(e)||a.value?.[1]?.toString().toLowerCase().includes(e))return!0;return!1})},[l,Ee]),We=O.useCallback(async(e=1,t=!1)=>{De.debug("Loading tokenized assets","RWax.loadTokenizedAssets",{page:e,append:t,sortBy:ke,attributeFilters:Ce});try{t?we(!0):(h(!0),p(null));const a=36,s=(e-1)*a;De.debug("Calling rwaxService.getTokenizedAssets","RWax.loadTokenizedAssets",{limit:a,offset:s,sortBy:ke,attributeFilters:Ce});const n=await Ba.getTokenizedAssets(a,s,ke,Ce);De.info("Received tokenized assets","RWax.loadTokenizedAssets",{count:n.length}),o(t?e=>[...e,...n]:n),be(n.length===a)}catch(a){De.error("Error loading tokenized assets","RWax",a),t||p("Failed to load tokenized assets. Please try again later.")}finally{h(!1),we(!1)}},[ke,Ce]),Oe=O.useCallback(async()=>{const e=ve+1;await We(e,!0),ye(e)},[ve,We]),Ue=O.useCallback(e=>{_e(e),ye(1)},[]),Be=O.useCallback(e=>{Pe(e);const t=Ys.formatAttributesForQuery(e);Ae(t),ye(1)},[]);O.useEffect(()=>{const e=setTimeout(()=>{"redeem"===i&&We(1,!1)},300);return()=>clearTimeout(e)},[ke,Ce,i]);const ze=O.useCallback(async()=>{try{const e=await Ba.getFeeTokens();d(e)}catch(e){De.error("Error loading fee tokens","RWax",e)}},[]),Xe=O.useCallback(async()=>{try{const[e,t,a]=await Promise.all([Ke.getWpixalPriceWAX(),Ke.getWpixalPriceUSD(),Ke.getWaxPriceUSD()]);V(e),K(t),ae(a)}catch(e){De.error("Error loading price data","RWax",e),V(.0177),K(9e-4),ae(.051),n("Price Loading Error","Unable to fetch current prices. Using fallback values.")}},[n]),He=O.useCallback(async()=>{if(t)try{const e=await mt.getWaxBalance(t);ge(e)}catch(e){De.error("Error loading WAX balance","RWax",e),ge("0.0000 WAX")}else ge("0.0000 WAX")},[t]);O.useEffect(()=>{ze(),Xe(),He(),"redeem"===i&&We(1,!1)},[i,We,ze,Xe,He]),O.useEffect(()=>{const e=setInterval(Xe,3e5);return()=>clearInterval(e)},[Xe]);const qe=()=>{k(!1),I("confirm"),$(""),h(!1),S(null)},Je=e=>{A(e),N(!0)},Ve=O.useCallback(()=>{Q(e=>!e)},[]),Ge=O.useCallback(()=>{Q(!1)},[]),Ye=e=>"rwax"in e&&e.rwax&&"redeemAmount"in e.rwax;O.useEffect(()=>{const e=localStorage.getItem("rwax-watchlist");if(e)try{const t=JSON.parse(e);$e(new Set(t))}catch(t){De.error("Error loading watchlist","RWax",t)}},[]);const Qe=O.useCallback((e,t)=>{const a=parseFloat(e.rwax.redeemAmount.toString()),n={assetId:e.assetId.toString(),assetName:e.name,originalPrice:a,alertPercentage:t,createdAt:Date.now()},i=new Map(Le);i.set(e.assetId.toString(),n),Me(i);const r=Array.from(i.entries());localStorage.setItem("rwax-price-alerts",JSON.stringify(r)),s(`Price alert set for ${e.name} at ${t}% change`)},[Le,s]),Ze=O.useCallback(e=>{const t=new Map(Le);t.delete(e),Me(t);const a=Array.from(t.entries());localStorage.setItem("rwax-price-alerts",JSON.stringify(a)),s("Price alert removed")},[Le,s]),et=O.useCallback(()=>{0!==Le.size&&0!==l.length&&Le.forEach((e,t)=>{const a=l.find(e=>e.assetId.toString()===t);if(!a)return n(`Alert: ${e.assetName} is no longer available on RWAX!`),void Ze(t);const i=(parseFloat(a.rwax.redeemAmount.toString())-e.originalPrice)/e.originalPrice*100;if(Math.abs(i)>=e.alertPercentage){const t=i>0?"increased":"decreased";s(`Price Alert: ${e.assetName} has ${t} by ${Math.abs(i).toFixed(2)}%!`),Qe(a,e.alertPercentage)}})},[Le,l,n,s,Ze,Qe]);return O.useEffect(()=>{const e=localStorage.getItem("rwax-price-alerts");if(e)try{const t=JSON.parse(e);Me(new Map(t))}catch(t){De.error("Error loading price alerts","RWax",t)}},[]),O.useEffect(()=>{et()},[et]),Se.jsxs("div",{className:"rwax-container",children:[Se.jsxs("div",{className:"rwax-header",children:[Se.jsxs("div",{className:"rwax-header-top",children:[Se.jsxs("button",{className:"rwax-back-button",onClick:()=>e("/marketplace"),children:[Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Marketplace"]}),Se.jsx("div",{className:"header-actions"})]}),Se.jsx("h1",{children:"R-WAX Tokenization"}),Se.jsx("p",{children:"Tokenize your Pixals to WPIXAL or redeem WPIXAL back to Pixals"}),Se.jsxs("p",{style:{marginTop:"16px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Visit the ",Se.jsx("a",{href:"https://r-wax.io/token/pixeljourney/WPIXAL",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary-purple)",textDecoration:"none",fontWeight:"500"},onMouseEnter:e=>e.target.style.textDecoration="underline",onMouseLeave:e=>e.target.style.textDecoration="none",children:"official RWAX website"})," for full WPIXAL markets and trading features."]})]}),Se.jsxs("div",{className:"rwax-tabs",children:[Se.jsx("button",{className:"tab-button "+("redeem"===i?"active":""),onClick:()=>r("redeem"),children:"WPIXAL to Pixal PFP"}),Se.jsx("button",{className:"tab-button "+("other-collections"===i?"active":""),onClick:()=>r("other-collections"),children:"Other RWAX Collections"})]}),m&&Se.jsx("div",{className:"error-message",children:m}),Se.jsx("div",{className:"rwax-content",children:"redeem"===i?Se.jsxs("div",{className:"redeem-section",children:[Se.jsxs("div",{className:"actions-and-controls-container",children:[Se.jsxs("div",{className:"left-actions",children:[Se.jsx("div",{className:"action-group",children:Se.jsx("button",{className:"inventory-tokenize-button",onClick:()=>j(!0),children:"Tokenize from Inventory"})}),Se.jsxs("div",{className:"action-group",children:[Se.jsxs("button",{className:"wpixal-alert-button "+(localStorage.getItem("wpixalPriceAlert")?"has-alert":""),onClick:()=>me(!0),children:[Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),Se.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"WPIXAL Price Alert"]}),localStorage.getItem("wpixalPriceAlert")&&Se.jsxs("div",{className:"current-alert-display",children:[Se.jsxs("span",{children:["Current Alert: ",localStorage.getItem("wpixalPriceAlert")," WAX"]}),Se.jsx("button",{className:"remove-alert",onClick:e=>{e.stopPropagation(),localStorage.removeItem("wpixalPriceAlert"),fe("")},title:"Remove Alert",children:"\xd7"})]})]})]}),Se.jsxs("div",{className:"sorting-and-filter-controls",children:[Se.jsx("div",{className:"search-bar-container",children:Se.jsxs("div",{className:"search-input-container",children:[Se.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),Se.jsx("input",{type:"text",placeholder:"Search R-WAX assets...",value:Ee,onChange:e=>Ie(e.target.value),className:"search-input"}),Ee&&Se.jsx("button",{onClick:()=>Ie(""),className:"clear-search","aria-label":"Clear search",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})}),Se.jsxs("div",{className:"sorting-controls",children:[Se.jsx("label",{htmlFor:"sort-select",children:"Sort by:"}),Se.jsxs("select",{id:"sort-select",value:ke,onChange:e=>Ue(e.target.value),className:"sort-dropdown",children:[Se.jsx("option",{value:"date_desc",children:"Date (Newest First)"}),Se.jsx("option",{value:"date_asc",children:"Date (Oldest First)"}),Se.jsx("option",{value:"price_desc",children:"Price (High to Low)"}),Se.jsx("option",{value:"price_asc",children:"Price (Low to High)"}),Se.jsx("option",{value:"floor_desc",children:"Floor Price (High to Low)"}),Se.jsx("option",{value:"floor_asc",children:"Floor Price (Low to High)"}),Se.jsx("option",{value:"mint_desc",children:"Mint Number (High to Low)"}),Se.jsx("option",{value:"mint_asc",children:"Mint Number (Low to High)"}),Se.jsx("option",{value:"rarity_score_desc",children:"Rarity Score (High to Low)"}),Se.jsx("option",{value:"rarity_score_asc",children:"Rarity Score (Low to High)"})]}),Se.jsx("button",{className:"filter-toggle-btn",onClick:Ve,title:"Open Filters",children:Se.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]})]})]}),u?Se.jsx("div",{className:"loading-spinner",children:"Loading tokenized assets..."}):Se.jsxs(Se.Fragment,{children:[Re.length>0&&Se.jsxs("div",{className:"multi-select-controls",children:[Se.jsx("button",{className:"select-all-button",onClick:()=>{L.size===l.length?M(new Set):M(new Set(l.map(e=>e.assetId.toString())))},children:L.size===Re.length?"Deselect All":"Select All"}),Se.jsxs("div",{className:"selected-count-container",children:[Se.jsxs("div",{className:"selected-count",children:[L.size," of ",Re.length," selected"]}),je&&Se.jsx("button",{className:"load-more-small-button",onClick:Oe,disabled:Ne,title:"Load More Assets",children:Ne?"Loading...":"Load More"})]}),Se.jsxs("button",{className:"batch-redeem-button",onClick:async()=>{if(0!==L.size)try{h(!0);const a=l.filter(e=>L.has(e.assetId.toString())),i=c.length>0?c[0]:null;if(!i)return void n("No fee tokens available for batch redemption");for(const s of a){if(!t)return void n("Please connect your wallet");try{const e=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:i.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:i.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${s.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${s.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:s.assetId.toString(),fee_currency:`8,${i.symbol}`}}],a=await Kt.transact(e);De.info(`Redemption transaction completed for ${s.name}`,"RWax.handleBatchRedemption",{assetId:s.assetId,result:a})}catch(e){De.error(`Error redeeming asset ${s.assetId}`,"RWax",e)}}s(`Successfully processed redemption for ${L.size} assets!`),M(new Set),We()}catch(a){De.error("Batch redemption failed","RWax",a),n("Batch redemption failed. Please try again.")}finally{h(!1)}},disabled:0===L.size||!t,children:["Batch Redeem (",L.size,")"]})]}),Se.jsx("div",{className:"rwax-assets-grid",children:Re.map((e,a)=>Se.jsxs("div",{className:"asset-card "+(L.has(e.assetId.toString())?"selected":""),children:[Se.jsx("div",{className:"selection-checkbox "+(L.has(e.assetId.toString())?"checked":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(L);t.has(e)?t.delete(e):t.add(e),M(t)})(e.assetId.toString())},children:L.has(e.assetId.toString())&&Se.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:Se.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}),Se.jsxs("div",{className:"asset-card-content",onClick:()=>Je(e),children:[Se.jsxs("div",{className:"asset-image",children:[Se.jsx(Qt,{imageUrl:e.image,alt:e.name,className:"nft-image"}),Se.jsx("div",{className:"zoom-overlay",onClick:t=>{t.stopPropagation(),((e,t)=>{let a=e;e&&!e.startsWith("http")&&(e.startsWith("Qm")||e.startsWith("baf")?a=`https://ipfs.io/ipfs/${e}`:e.startsWith("/ipfs/")?a=`https://ipfs.io/ipfs/${e.replace("/ipfs/","")}`:e.startsWith("ipfs://")&&(a=e.replace("ipfs://","https://ipfs.io/ipfs/"))),U({url:a,name:t}),W(!0)})(e.image,e.name)},children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[Se.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),Se.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]}),Se.jsxs("div",{className:"asset-info",children:[Se.jsx("h3",{children:e.name}),Se.jsxs("div",{className:"pricing-info",children:[Se.jsxs("div",{className:"wpixal-amount",onClick:t=>{var a;t.stopPropagation(),a=parseFloat(e.rwax.redeemAmount.toString()),q(a),X(!0)},title:`Exact amount: ${e.rwax.redeemAmount} WPIXAL`,children:[parseFloat(e.rwax.redeemAmount.toString()).toFixed(1)," WPIXAL"]}),Se.jsxs("div",{className:"rwax-price-convert",children:[Se.jsxs("div",{className:"wax-price",children:["\u2248 ",(parseFloat(e.rwax.redeemAmount.toString())*J).toFixed(4)," WAX"]}),Se.jsxs("div",{className:"usd-price",children:["\u2248 $",(parseFloat(e.rwax.redeemAmount.toString())*G).toFixed(4)," USD"]})]})]})]})]}),Se.jsxs("div",{className:"asset-actions",children:[Se.jsx("button",{className:"redeem-button primary",onClick:t=>{t.stopPropagation(),(e=>{S(e),v(!0)})(e)},disabled:!t,children:"Redeem (WPIXAL)"}),Se.jsxs("div",{className:"secondary-actions",children:[Se.jsx("button",{className:"wax-redeem-button secondary",onClick:t=>{t.stopPropagation(),(e=>{S(e),k(!0),I("confirm"),$("")})(e)},disabled:!t,children:"Redeem (WAX)"}),Se.jsx("button",{className:"info-button secondary",onClick:t=>{t.stopPropagation(),Je(e)},children:"Info"})]}),Se.jsxs("div",{className:"icon-actions",children:[Se.jsx("button",{className:"btn-watchlist icon-only "+(Fe.has(e.assetId.toString())?"active":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(Fe);t.has(e)?(t.delete(e),s("Removed from watchlist")):(t.add(e),s("Added to watchlist")),$e(t),localStorage.setItem("rwax-watchlist",JSON.stringify(Array.from(t)))})(e.assetId.toString())},title:Fe.has(e.assetId.toString())?"Remove from Watchlist":"Add to Watchlist",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:Fe.has(e.assetId.toString())?"currentColor":"none",stroke:"currentColor",children:Se.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),Se.jsx("button",{className:"btn-copy-link icon-only",onClick:t=>{t.stopPropagation();const a=`${window.location.origin}/asset/${e.assetId}`;navigator.clipboard.writeText(a).then(()=>{s("Asset link copied to clipboard!")}).catch(()=>{n("Failed to copy link")})},title:"Copy Link",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),Se.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}),Se.jsx("button",{className:"btn-share icon-only",onClick:t=>{t.stopPropagation(),(e=>{ue(e),ce(!0)})(e)},title:"Share Asset",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),Se.jsx("polyline",{points:"16,6 12,2 8,6"}),Se.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})})]})]})]},`${e.assetId}-${a}`))}),je&&Se.jsx("div",{className:"load-more-section",children:Se.jsx("button",{className:"load-more-button",onClick:Oe,disabled:Ne,children:Ne?"Loading...":"Load More Assets"})})]})]}):"other-collections"===i?Se.jsx("div",{className:"other-collections-section",children:Se.jsxs("div",{className:"construction-message",children:[Se.jsx("div",{className:"construction-icon",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:Se.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})}),Se.jsx("h2",{children:"Other RWAX Collections"}),Se.jsx("p",{children:"Support for additional RWAX collections is coming soon!"}),Se.jsx("div",{className:"construction-details",children:Se.jsx("p",{children:"We're working on expanding RWAX tokenization to support more NFT collections beyond Pixals. Stay tuned for updates!"})})]})}):null}),f&&_&&Se.jsx("div",{className:"rwax-modal-overlay",onClick:()=>x(!1),children:Se.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"rwax-modal-header",children:[Se.jsx("h2",{children:"Tokenize Pixal"}),Se.jsx("button",{className:"rwax-close-button",onClick:()=>x(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"rwax-modal-body",children:[Se.jsxs("div",{className:"selected-asset",children:[Se.jsx(Qt,{imageUrl:_.image,alt:_.name,className:"modal-asset-image"}),Se.jsx("h3",{children:_.name})]}),Se.jsxs("div",{className:"fee-selection",children:[Se.jsx("h4",{children:"Select Fee Token:"}),c.map((e,t)=>Se.jsxs("div",{className:"fee-option "+(T===e?"selected":""),onClick:()=>P(e),children:[Se.jsx("span",{className:"fee-amount",children:e.fee}),e.wax_value&&"WAX"!==e.symbol&&Se.jsxs("span",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"cancel-button",onClick:()=>x(!1),children:"Cancel"}),Se.jsx("button",{className:"confirm-button",onClick:async()=>{if(_&&T&&a&&t)try{const e=await Ba.executeTokenization([_.assetId.toString()],T);s("Tokenization transaction prepared"),De.info("Tokenization transaction prepared","RWax.handleTokenization",{transaction:e}),x(!1),setTimeout(()=>{We()},2e3)}catch(e){De.error("Error during tokenization","RWax",e),n("Tokenization failed. Please try again.")}else n("Please select an asset and fee token")},disabled:!T,children:"Tokenize"})]})]})]})}),g&&_&&Ye(_)&&Se.jsx("div",{className:"rwax-modal-overlay",onClick:()=>v(!1),children:Se.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"rwax-modal-header",children:[Se.jsx("h2",{children:"Redeem WPIXAL"}),Se.jsx("button",{className:"rwax-close-button",onClick:()=>v(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"rwax-modal-body",children:[Se.jsxs("div",{className:"selected-asset",children:[Se.jsx(Qt,{imageUrl:_.image,alt:_.name,className:"modal-asset-image"}),Se.jsx("h3",{children:_.name}),Ye(_)&&Se.jsxs("p",{className:"wpixal-required",children:["Required: ",_.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),Se.jsxs("div",{className:"fee-selection",children:[Se.jsx("h4",{children:"Select Fee Token:"}),c.map((e,t)=>Se.jsxs("div",{className:"fee-option "+(T===e?"selected":""),onClick:()=>P(e),children:[Se.jsx("span",{className:"fee-amount",children:e.fee}),e.wax_value&&"WAX"!==e.symbol&&Se.jsxs("span",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"cancel-button",onClick:()=>v(!1),children:"Cancel"}),Se.jsx("button",{className:"confirm-button",onClick:async()=>{if(_&&T&&a&&t&&Ye(_))try{h(!0);const e=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:T.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:T.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${_.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${_.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:_.assetId.toString(),fee_currency:`8,${T.symbol}`}}],a=await Kt.transact(e);s("Redemption transaction completed successfully!"),De.info("Redemption transaction completed","RWax.handleRedeemFromModal",{result:a}),v(!1),setTimeout(()=>{We()},2e3)}catch(e){De.error("Error during redemption","RWax",e),n("Redemption failed. Please try again.")}finally{h(!1)}else n("Please select an asset and fee token")},disabled:!T,children:"Redeem"})]})]})]})}),Se.jsx(Qs,{isOpen:y,onClose:()=>j(!1),onSuccess:()=>{"redeem"===i&&We()}}),Se.jsx(Zs,{asset:C,isOpen:b,onClose:()=>{N(!1),A(null)},onRedeem:async(e,a)=>{if(t)try{h(!0);const n=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:a.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:a.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${e.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${e.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:e.assetId.toString(),fee_currency:`8,${a.symbol}`}}],i=await Kt.transact(n);s("Redemption transaction completed successfully!"),De.info("Redemption transaction completed","RWax.handleRedemption",{result:i}),N(!1),A(null),We()}catch(i){De.error("Error during redemption","RWax",i),n("Redemption failed. Please try again.")}finally{h(!1)}else n("Please connect your wallet")}}),w&&_&&Se.jsx("div",{className:"rwax-modal-overlay",onClick:qe,children:Se.jsxs("div",{className:"rwax-modal-content rwax-wax-redeem-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"rwax-modal-header",children:[Se.jsx("h2",{children:"Pay with WAX"}),Se.jsx("button",{className:"rwax-close-button",onClick:qe,children:"\xd7"})]}),Se.jsxs("div",{className:"rwax-modal-body",children:[Se.jsxs("div",{className:"selected-asset",children:[Se.jsx(Qt,{imageUrl:_.image,alt:_.name,className:"modal-asset-image"}),Se.jsx("h3",{children:_.name}),Ye(_)&&Se.jsxs(Se.Fragment,{children:[Se.jsxs("p",{className:"wpixal-required",children:["Required: ",_.rwax.redeemAmount.toFixed(8)," WPIXAL"]}),Se.jsxs("p",{className:"wax-cost",children:["Cost: ",(_.rwax.redeemAmount*J).toFixed(4)," WAX"]}),Se.jsxs("p",{className:"usd-cost",children:["USD: $",(_.rwax.redeemAmount*G).toFixed(4)]})]})]}),"confirm"===E&&Se.jsxs("div",{className:"wax-redeem-step",children:[Se.jsx("h4",{children:"Step 1: Confirm WAX Payment"}),Se.jsx("p",{className:"step-description",children:"This process will swap your WAX for WPIXAL via Alcor, then use that WPIXAL to redeem your NFT."}),Se.jsxs("div",{className:"wax-calculator-section",children:[Se.jsxs("div",{className:"available-wax",children:[Se.jsx("h4",{children:"Your Available WAX"}),Se.jsxs("div",{className:"wax-balance",children:[Se.jsx("span",{className:"nav-balance-amount",children:xe}),Se.jsxs("span",{className:"balance-usd",children:["($",(parseFloat(xe.split(" ")[0])*te).toFixed(2)," USD)"]})]})]}),Se.jsxs("div",{className:"wpixal-calculator",children:[Se.jsx("h4",{children:"WPIXAL Calculator"}),Se.jsxs("div",{className:"calculator-info",children:[Se.jsx("p",{children:"With your available WAX, you can buy:"}),Se.jsx("div",{className:"max-wpixal",children:Se.jsxs("strong",{children:[J>0?(100/J).toFixed(4):"0.0000"," WPIXAL"]})}),Se.jsx("div",{className:"rate-info",children:Se.jsxs("small",{children:["Rate: 1 WPIXAL = ",J.toFixed(6)," WAX"]})})]}),Se.jsxs("div",{className:"purchase-slider",children:[Se.jsx("label",{children:"Amount to purchase:"}),Se.jsx("input",{type:"range",min:"0",max:Math.min(100,J>0&&Ye(_)?_.rwax.redeemAmount*J:0),step:"0.0001",value:F?parseFloat(F):0,onChange:e=>$(parseFloat(e.target.value).toFixed(4)),className:"wpixal-slider"}),Se.jsxs("div",{className:"slider-labels",children:[Se.jsx("span",{children:"0 WAX"}),Se.jsxs("span",{children:[Math.min(100,J>0&&Ye(_)?_.rwax.redeemAmount*J:0).toFixed(4)," WAX"]})]})]}),Se.jsxs("div",{className:"purchase-summary",children:[Se.jsxs("div",{className:"summary-row",children:[Se.jsx("span",{children:"WPIXAL to buy:"}),Se.jsxs("span",{children:[F?(parseFloat(F)/J).toFixed(4):"0.0000"," WPIXAL"]})]}),Se.jsxs("div",{className:"summary-row",children:[Se.jsx("span",{children:"WAX cost:"}),Se.jsxs("span",{children:[F||"0.0000"," WAX"]})]}),Se.jsxs("div",{className:"summary-row",children:[Se.jsx("span",{children:"USD cost:"}),Se.jsxs("span",{children:["$",F?(parseFloat(F)*te).toFixed(4):"0.0000"]})]})]})]})]}),Se.jsxs("div",{className:"process-steps",children:[Se.jsxs("div",{className:"step-item",children:[Se.jsx("span",{className:"step-number",children:"1"}),Se.jsx("span",{className:"step-text",children:"Swap WAX \u2192 WPIXAL via Alcor"})]}),Se.jsxs("div",{className:"step-item",children:[Se.jsx("span",{className:"step-number",children:"2"}),Se.jsx("span",{className:"step-text",children:"Redeem NFT with WPIXAL"})]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"cancel-button",onClick:qe,children:"Cancel"}),Se.jsx("button",{className:"confirm-button",onClick:async()=>{if(!(_&&t&&a&&Ye(_)))return void n("Missing required data for WAX redemption");const e=parseFloat(xe.split(" ")[0]),i=parseFloat(F);if(e<i)n(`Insufficient WAX balance. You have ${xe} but need ${i.toFixed(4)} WAX`);else try{h(!0),I("swap");const e=await _s.executeSwap(F,t);s("Swap transaction prepared"),De.info("Swap transaction prepared","RWax.handleWaxRedemption",{swapTransaction:e}),await new Promise(e=>setTimeout(e,2e3)),I("redeem");const a={fee:"0.00000000",contract:"eosio.token",exchange_rate:"1",symbol:"WAX",amount:"0.00000000"};if(!Ye(_))return void n("Selected asset is not a tokenized asset");const i=await Ba.executeRedemption(_.assetId.toString(),_.rwax.redeemAmount.toFixed(8)+" WPIXAL",a);s("Redemption transaction prepared"),De.info("Redemption transaction prepared","RWax.handleWaxRedemption",{redeemTransaction:i}),await new Promise(e=>setTimeout(e,2e3)),I("complete"),s("WAX redemption completed successfully!")}catch(r){De.error("Error during WAX redemption","RWax",r),n("WAX redemption failed. Please try again."),I("confirm")}finally{h(!1)}},disabled:!F||parseFloat(F)<=0||J<=0||!Ye(_)||parseFloat(F)/J>_.rwax.redeemAmount,children:"Buy WPIXAL & Redeem"})]})]}),"swap"===E&&Se.jsxs("div",{className:"wax-redeem-step",children:[Se.jsx("h4",{children:"Step 2: Swapping WAX to WPIXAL"}),Se.jsxs("p",{className:"step-description",children:["Connecting to Alcor to swap ",F," WAX for WPIXAL..."]}),Se.jsxs("div",{className:"swap-progress",children:[Se.jsx("div",{className:"progress-spinner"}),Se.jsx("p",{children:"Processing swap transaction..."})]}),Se.jsx("div",{className:"modal-actions",children:Se.jsx("button",{className:"cancel-button",onClick:qe,children:"Cancel"})})]}),"redeem"===E&&Se.jsxs("div",{className:"wax-redeem-step",children:[Se.jsx("h4",{children:"Step 3: Redeeming NFT"}),Se.jsx("p",{className:"step-description",children:"Using WPIXAL to redeem your NFT..."}),Se.jsxs("div",{className:"redeem-progress",children:[Se.jsx("div",{className:"progress-spinner"}),Se.jsx("p",{children:"Processing redemption transaction..."})]})]}),"complete"===E&&Se.jsxs("div",{className:"wax-redeem-step",children:[Se.jsx("h4",{children:"\u2705 Redemption Complete!"}),Se.jsx("p",{className:"step-description success",children:"Your NFT has been successfully redeemed using WAX payment."}),Se.jsx("div",{className:"modal-actions",children:Se.jsx("button",{className:"confirm-button",onClick:()=>{qe(),We()},children:"Done"})})]})]})]})}),Se.jsx("div",{className:"live-transactions-section",children:Se.jsx(en,{limit:12,refreshInterval:3e4})}),R&&Se.jsx("div",{className:"image-zoom-modal",onClick:()=>W(!1),children:Se.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsx("button",{className:"zoom-modal-close",onClick:()=>W(!1),children:"\xd7"}),D&&Se.jsxs(Se.Fragment,{children:[Se.jsx("img",{src:D.url,alt:D.name,className:"zoom-modal-image"}),Se.jsx("div",{className:"zoom-modal-info",children:Se.jsx("h3",{children:D.name})})]})]})}),z&&Se.jsx(Is,{isModal:!0,onClose:()=>X(!1),initialBuyAmount:H}),se&&ie&&Se.jsx("div",{className:"rwax-modal-overlay",onClick:()=>ne(!1),children:Se.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"rwax-modal-header",children:[Se.jsx("h2",{children:"Set Price Alert"}),Se.jsx("button",{className:"rwax-close-button",onClick:()=>ne(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"rwax-modal-body",children:[ie&&Se.jsxs("div",{className:"alert-asset-info",children:[Se.jsx(Qt,{imageUrl:ie.image,alt:ie.name,className:"modal-asset-image"}),Se.jsx("h3",{children:ie.name}),Se.jsxs("p",{children:["Current Price: ",ie.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),Se.jsxs("div",{className:"alert-settings",children:[Se.jsx("h4",{children:"Alert when price changes by:"}),Se.jsx("div",{className:"percentage-options",children:[5,10,15,20,25].map(e=>Se.jsxs("button",{className:"percentage-option "+(re===e?"selected":""),onClick:()=>le(e),children:[e,"%"]},e))}),Se.jsxs("div",{className:"custom-percentage",children:[Se.jsx("label",{children:"Custom percentage:"}),Se.jsx("input",{type:"number",min:"1",max:"100",value:re,onChange:e=>le(parseInt(e.target.value)||10),className:"percentage-input"}),Se.jsx("span",{children:"%"})]}),Se.jsxs("div",{className:"alert-preview",children:[Se.jsxs("p",{children:["You will be notified when the price moves ",re,"% from the current value."]}),Se.jsxs("div",{className:"price-thresholds",children:[Se.jsxs("div",{className:"threshold-item",children:[Se.jsx("span",{className:"threshold-label",children:"Alert above:"}),Se.jsxs("span",{className:"threshold-value",children:[(ie.rwax.redeemAmount*(1+re/100)).toFixed(4)," WPIXAL"]})]}),Se.jsxs("div",{className:"threshold-item",children:[Se.jsx("span",{className:"threshold-label",children:"Alert below:"}),Se.jsxs("span",{className:"threshold-value",children:[(ie.rwax.redeemAmount*(1-re/100)).toFixed(4)," WPIXAL"]})]})]})]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"cancel-button",onClick:()=>ne(!1),children:"Cancel"}),ie&&Le.has(ie.assetId.toString())&&Se.jsx("button",{className:"remove-alert-button",onClick:()=>{ie&&(Ze(ie.assetId.toString()),ne(!1))},children:"Remove Alert"}),Se.jsx("button",{className:"confirm-button",onClick:()=>{ie&&(Qe(ie,re),ne(!1))},children:ie&&Le.has(ie.assetId.toString())?"Update Alert":"Set Alert"})]})]})]})}),he&&Se.jsx("div",{className:"rwax-modal-overlay",onClick:()=>me(!1),children:Se.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"rwax-modal-header",children:[Se.jsx("h2",{children:"WPIXAL Price Alert"}),Se.jsx("button",{className:"rwax-close-button",onClick:()=>me(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"rwax-modal-body",children:[Se.jsxs("div",{className:"wpixal-alert-info",children:[Se.jsx("h3",{children:"Set WPIXAL Price Alert"}),Se.jsxs("div",{className:"current-wpixal-prices",children:[Se.jsx("p",{children:"Current WPIXAL Price:"}),Se.jsxs("div",{className:"price-display",children:[Se.jsx("span",{className:"wax-price",children:J>0?`${J.toFixed(8)} WAX`:"Loading..."}),Se.jsx("span",{className:"usd-price",children:G>0?`($${G.toFixed(6)} USD)`:""})]})]}),localStorage.getItem("wpixalPriceAlert")&&Se.jsxs("div",{className:"existing-alert-info",children:[Se.jsxs("p",{children:["Your Current Alert: ",localStorage.getItem("wpixalPriceAlert")," WAX"]}),Se.jsx("p",{className:"price-comparison",children:J>0&&localStorage.getItem("wpixalPriceAlert")?`Current price is ${((J-parseFloat(localStorage.getItem("wpixalPriceAlert")))/parseFloat(localStorage.getItem("wpixalPriceAlert"))*100).toFixed(2)}% ${J>parseFloat(localStorage.getItem("wpixalPriceAlert"))?"above":"below"} your alert`:""})]}),Se.jsx("p",{children:"Get notified when WPIXAL price drops below your target value"})]}),Se.jsxs("div",{className:"alert-settings",children:[Se.jsx("h4",{children:"Alert when WPIXAL price (in WAX) drops below:"}),Se.jsxs("div",{className:"price-input-container",children:[Se.jsx("input",{type:"number",step:"0.00000001",min:"0",value:pe,onChange:e=>fe(e.target.value),placeholder:"Enter WAX amount",className:"price-alert-input"}),Se.jsx("span",{className:"currency-label",children:"WAX"})]})]}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"cancel-button",onClick:()=>me(!1),children:"Cancel"}),Se.jsx("button",{className:"confirm-button",onClick:()=>{pe&&parseFloat(pe)>0&&(localStorage.setItem("wpixalPriceAlert",pe),me(!1),fe(""),s("Price Alert Set",`WPIXAL price alert set for ${pe} WAX`))},disabled:!pe||parseFloat(pe)<=0,children:"Set Alert"})]})]})]})}),Y&&Se.jsxs(Se.Fragment,{children:[Se.jsx("div",{className:"filter-sidebar-overlay",onClick:Ge}),Se.jsxs("div",{className:"filter-sidebar",children:[Se.jsxs("div",{className:"filter-sidebar-header",children:[Se.jsx("h3",{children:"Advanced Filters"}),Se.jsx("button",{className:"close-sidebar-btn",onClick:Ge,children:Se.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Se.jsxs("div",{className:"filter-section",children:[Se.jsx("h4",{children:"Price Range (WPIXAL)"}),Se.jsxs("div",{className:"price-range-inputs",children:[Se.jsx("input",{type:"number",placeholder:"Min",value:Z.min,onChange:e=>ee(t=>({...t,min:e.target.value})),className:"price-input"}),Se.jsx("span",{children:"to"}),Se.jsx("input",{type:"number",placeholder:"Max",value:Z.max,onChange:e=>ee(t=>({...t,max:e.target.value})),className:"price-input"})]})]}),Se.jsx("div",{className:"filter-section",children:Se.jsx(an,{onFiltersChange:Be,initialFilters:Te})})]})]}),oe&&de&&Se.jsx(sa,{isOpen:oe,onClose:()=>{ce(!1),ue(null)},type:"nft",title:"",shareUrl:`${window.location.origin}/rwax/asset/${de.assetId}`,defaultShareText:`Check out this tokenized Pixal: ${de.name} - ${de.rwax.redeemAmount.toFixed(8)} WPIXAL on PxMarket! \ud83c\udfae\u2728`})]})},nn=[{id:781515,pxj:1,wuf:22,pxjUpgrade:0,name:"Pixal PFP",type:"pixals"},{id:820134,pxj:2.22,wuf:5,pxjUpgrade:0,name:"Pixel Ingredient Pack",type:"pixelpack"},{id:858568,pxj:142,wuf:142,pxjUpgrade:0,name:"Black",type:"special"},{id:858569,pxj:.42,wuf:1,pxjUpgrade:0,name:"Blue",type:"primary ingredient"},{id:858570,pxj:.42,wuf:1,pxjUpgrade:0,name:"Red",type:"primary ingredient"},{id:858571,pxj:.42,wuf:1,pxjUpgrade:0,name:"Yellow",type:"primary ingredient"},{id:858572,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Green",type:"secondary ingredient"},{id:858573,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Orange",type:"secondary ingredient"},{id:858574,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Purple",type:"secondary ingredient"},{id:858575,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Amber",type:"tertiary ingredient"},{id:858576,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Chartreuse",type:"tertiary ingredient"},{id:858577,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Violet",type:"tertiary ingredient"},{id:858578,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Teal",type:"tertiary ingredient"},{id:858580,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Vermillion",type:"tertiary ingredient"},{id:859273,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Magenta",type:"tertiary ingredient"}],rn=()=>{const[e,t]=O.useState("overview"),[a,s]=O.useState(!1),[n,i]=O.useState(.001),[r,l]=O.useState(5e-4),[o,c]=O.useState({ingredients:!0,governance:!0,collectibles:!0,overviewIngredients:!0}),d=e=>{const t=nn.find(t=>t.id===e.resultTemplateId);if(!t)return{craftingCost:0,dailyEarnings:0,roiDays:0,profitMargin:0};const a=(e.ingredients.reduce((e,t)=>{const a=nn.find(e=>e.id===t.templateId);return e+(a?a.pxj*t.quantity:0)},0)+t.pxjUpgrade)*n,s=24*t.pxj*n;return{craftingCost:a,dailyEarnings:s,roiDays:a>0?a/s:0,profitMargin:s>0?(s-a/365)/s*100+100:100}},u=O.useMemo(()=>{const e={special:[],"primary ingredient":[],"secondary ingredient":[],"tertiary ingredient":[],pixals:[],pixelpack:[]};return nn.forEach(t=>{e[t.type]&&e[t.type].push(t)}),e},[]),h=()=>{s(!0)},m=e=>({858575:"http://pixeljourney.xyz/ingredients/Pixel_Amber_vid_25fps_300px.mp4",858576:"http://pixeljourney.xyz/ingredients/Pixel_Chartreuse_vid_25fps_300px.mp4",858577:"http://pixeljourney.xyz/ingredients/Pixel_Violet_vid_25fps_300px.mp4",858578:"http://pixeljourney.xyz/ingredients/Pixel_Teal_vid_25fps_300px.mp4",858580:"http://pixeljourney.xyz/ingredients/Pixel_Vermillion_vid_25fps_300px.mp4",859273:"http://pixeljourney.xyz/ingredients/Pixel_Magenta_vid_25fps_300px.mp4",858574:"http://pixeljourney.xyz/ingredients/Pixel_Purple_vid_25fps_300px.mp4",858573:"http://pixeljourney.xyz/ingredients/Pixel_Orange_vid_25fps_300px.mp4",858572:"http://pixeljourney.xyz/ingredients/Pixel_Green_vid_25fps_300px.mp4",858570:"http://pixeljourney.xyz/ingredients/Pixel_Red_vid_25fps_300px.mp4",858569:"http://pixeljourney.xyz/ingredients/Pixel_Blue_vid_25fps_300px.mp4",858571:"http://pixeljourney.xyz/ingredients/Pixel_Yellow_vid_25fps_300px.mp4",858568:"http://pixeljourney.xyz/ingredients/Pixel_Black_White_vid_25fps_300px.mp4"}[e.toString()]||`/img/ingredients/${e}.png`),p=e=>e.includes(".mp4")||e.includes(".webm");return Se.jsxs("div",{className:"pxcrafting-container",children:[Se.jsxs("div",{className:"pxcrafting-header",children:[Se.jsx("h1",{children:"Pixel Ingredient Crafting"}),Se.jsx("p",{className:"pxcrafting-subtitle",children:"Master the art of pixel ingredient crafting with comprehensive guides, ROI calculations, and staking insights."})]}),Se.jsxs("div",{className:"pxcrafting-tabs",children:[Se.jsx("button",{className:"tab-btn "+("overview"===e?"active":""),onClick:()=>t("overview"),children:"Overview"}),Se.jsx("button",{className:"tab-btn "+("recipes"===e?"active":""),onClick:()=>t("recipes"),children:"Recipes"}),Se.jsx("button",{className:"tab-btn "+("calculator"===e?"active":""),onClick:()=>t("calculator"),children:"ROI Calculator"}),Se.jsx("button",{className:"tab-btn "+("staking"===e?"active":""),onClick:()=>t("staking"),children:"Staking Info"})]}),Se.jsxs("div",{className:"pxcrafting-content",children:["overview"===e&&Se.jsxs("div",{className:"overview-tab",children:[Se.jsxs("div",{className:"overview-grid",children:[Se.jsxs("div",{className:"overview-card",children:[Se.jsx("h3",{children:"\ud83c\udfa8 Crafting System"}),Se.jsx("p",{children:"Create powerful pixel ingredients by combining primary colors into secondary and tertiary ingredients. Each tier offers increased staking rewards and unique properties."}),Se.jsx("button",{className:"cta-button",onClick:()=>h(),children:"Start Crafting"})]}),Se.jsxs("div",{className:"overview-card",children:[Se.jsx("h3",{children:"\ud83d\udcb0 Staking Rewards"}),Se.jsx("p",{children:"Stake your crafted ingredients to earn PXJ and WUF tokens. Higher tier ingredients provide significantly better returns on your investment."}),Se.jsx("button",{className:"cta-button secondary",onClick:()=>t("staking"),children:"View Staking Info"})]}),Se.jsxs("div",{className:"overview-card",children:[Se.jsx("h3",{children:"\ud83d\udcca ROI Analysis"}),Se.jsx("p",{children:"Calculate the return on investment for different crafting strategies. Optimize your crafting decisions with real-time profitability analysis."}),Se.jsx("button",{className:"cta-button secondary",onClick:()=>t("calculator"),children:"Calculate ROI"})]})]}),Se.jsx("div",{className:"main-staking-section",children:Se.jsxs("div",{className:"main-staking-card",children:[Se.jsx("h3",{children:"\ud83c\udfdb\ufe0f Main Staking Platform"}),Se.jsx("p",{children:"Visit the official Pixel Journey staking platform to stake all your NFT collectibles and earn rewards across the entire ecosystem."}),Se.jsx("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"main-staking-button",children:"Visit Staking Platform"})]})}),Se.jsx("div",{className:"ingredient-tiers",children:Se.jsxs("div",{className:"collapsible-section",children:[Se.jsxs("button",{className:"section-header",onClick:()=>c(e=>({...e,overviewIngredients:!e.overviewIngredients})),children:[Se.jsx("h2",{children:"Staking Values"}),Se.jsx("span",{className:"collapse-icon "+(o.overviewIngredients?"collapsed":""),children:"\u25bc"})]}),!o.overviewIngredients&&Se.jsxs("div",{className:"smart-tier-layout",children:[Se.jsxs("div",{className:"tier-row tier-row-premium",children:[Se.jsxs("div",{className:"tier-card pixelpack",children:[Se.jsx("h4",{children:"Pixel Ingredient Pack"}),Se.jsx("div",{className:"tier-ingredients",children:nn.filter(e=>"pixelpack"===e.type).map(e=>{const t=m(e.id)||"https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif";return Se.jsxs("div",{className:"ingredient-preview",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif"}}),Se.jsxs("span",{children:[e.name," ",Se.jsx("span",{className:"season-tag",children:"Season 1"})]}),Se.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),Se.jsxs("div",{className:"tier-card special",children:[Se.jsx("h4",{children:"Special Ingredients"}),Se.jsx("div",{className:"tier-ingredients",children:nn.filter(e=>"special"===e.type).map(e=>{const t=m(e.id);return Se.jsxs("div",{className:"ingredient-preview",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),Se.jsxs("span",{children:[e.name," ",Se.jsx("span",{className:"season-tag",children:"Season 1"})]}),Se.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]})]}),Se.jsxs("div",{className:"tier-row tier-row-standard",children:[Se.jsxs("div",{className:"tier-card primary",children:[Se.jsx("h4",{children:"Primary Ingredients"}),Se.jsx("div",{className:"tier-ingredients",children:nn.filter(e=>"primary ingredient"===e.type).map(e=>{const t=m(e.id);return Se.jsxs("div",{className:"ingredient-preview",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),Se.jsxs("span",{children:[e.name," ",Se.jsx("span",{className:"season-tag",children:"Season 1"})]}),Se.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),Se.jsxs("div",{className:"tier-card secondary",children:[Se.jsx("h4",{children:"Secondary Ingredients"}),Se.jsx("div",{className:"tier-ingredients",children:nn.filter(e=>"secondary ingredient"===e.type).map(e=>{const t=m(e.id);return Se.jsxs("div",{className:"ingredient-preview",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),Se.jsxs("span",{children:[e.name," ",Se.jsx("span",{className:"season-tag",children:"Season 1"})]}),Se.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]})]}),Se.jsxs("div",{className:"tier-row tier-row-tertiary",children:[Se.jsxs("div",{className:"tier-card tertiary",children:[Se.jsx("h4",{children:"Tertiary Ingredients"}),Se.jsx("div",{className:"tier-ingredients",children:nn.filter(e=>"tertiary ingredient"===e.type).map(e=>{const t=m(e.id);return Se.jsxs("div",{className:"ingredient-preview",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),Se.jsxs("span",{children:[e.name," ",Se.jsx("span",{className:"season-tag",children:"Season 1"})]}),Se.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),Se.jsxs("div",{className:"tier-card collectibles",children:[Se.jsx("h4",{children:"Collectibles"}),Se.jsx("div",{className:"tier-ingredients",children:Se.jsxs("div",{className:"sub-tier",children:[Se.jsx("h5",{children:"PFPs"}),nn.filter(e=>"pixals"===e.type).map(e=>{const t=m(e.id)||"https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp";return Se.jsxs("div",{className:"ingredient-preview",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp"}}),Se.jsxs("span",{children:[e.name," ",Se.jsx("span",{className:"season-tag",children:"Season 1"})]}),Se.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})]})})]})]})]})]})})]}),"recipes"===e&&Se.jsxs("div",{className:"recipes-tab",children:[Se.jsxs("div",{className:"recipes-header",children:[Se.jsx("h2",{children:"Crafting Recipes"}),Se.jsxs("div",{className:"recipe-category-tabs",children:[Se.jsx("button",{className:"recipe-tab active",children:"Ingredient"}),Se.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Collectibles"}),Se.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Event"}),Se.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Governance"})]})]}),Se.jsx("div",{className:"recipes-grid",children:Ea.map((e,t)=>{const a=d(e),s=nn.find(t=>t.id===e.resultTemplateId);return Se.jsxs("div",{className:"recipe-card",children:[Se.jsxs("div",{className:"recipe-header",children:[Se.jsx("h3",{children:e.name}),Se.jsx("span",{className:`tier-badge ${e.tier}`,children:e.tier})]}),Se.jsxs("div",{className:"recipe-ingredients",children:[Se.jsx("h4",{children:"Ingredients Required:"}),e.ingredients.map((e,t)=>{const a=nn.find(t=>t.id===e.templateId),s=m(e.templateId);return Se.jsxs("div",{className:"ingredient-requirement",children:[p(s)?Se.jsx("video",{src:s,autoPlay:!0,loop:!0,muted:!0,onError:e=>{e.currentTarget.style.display="none";const t=document.createElement("img");t.src="/img/placeholder-ingredient.png",t.alt=a?.name||"Unknown",e.currentTarget.parentNode?.appendChild(t)}}):Se.jsx("img",{src:s,alt:a?.name||"Unknown",onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),Se.jsxs("span",{children:[e.quantity,"x ",a?.name||"Unknown"]})]},t)})]}),Se.jsxs("div",{className:"recipe-result",children:[Se.jsx("h4",{children:"Creates:"}),Se.jsxs("div",{className:"result-item",children:[(()=>{const t=m(e.resultTemplateId);return p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:e=>{e.currentTarget.style.display="none";const t=document.createElement("img");t.src="/img/placeholder-ingredient.png",t.alt=s?.name||"Unknown",e.currentTarget.parentNode?.appendChild(t)}}):Se.jsx("img",{src:t,alt:s?.name||"Unknown",onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}})})(),Se.jsxs("span",{children:["1x ",s?.name||"Unknown"]})]})]}),Se.jsxs("div",{className:"recipe-stats",children:[Se.jsxs("div",{className:"stat",children:[Se.jsx("label",{children:"Cost:"}),Se.jsxs("span",{children:[a.craftingCost.toFixed(4)," WAX"]})]}),Se.jsxs("div",{className:"stat",children:[Se.jsx("label",{children:"Daily Earnings:"}),Se.jsxs("span",{children:[a.dailyEarnings.toFixed(4)," WAX"]})]}),Se.jsxs("div",{className:"stat",children:[Se.jsx("label",{children:"ROI Period:"}),Se.jsxs("span",{children:[a.roiDays.toFixed(1)," days"]})]})]}),Se.jsx("button",{className:"craft-button",onClick:()=>{h()},children:"Craft This Recipe"})]},t)})})]}),"calculator"===e&&Se.jsxs("div",{className:"calculator-tab",children:[Se.jsx("h2",{children:"ROI Calculator"}),Se.jsxs("div",{className:"price-inputs",children:[Se.jsxs("div",{className:"input-group",children:[Se.jsx("label",{children:"PXJ Price (WAX):"}),Se.jsx("input",{type:"number",step:"0.0001",value:n,onChange:e=>i(parseFloat(e.target.value)||0)})]}),Se.jsxs("div",{className:"input-group",children:[Se.jsx("label",{children:"WUF Price (WAX):"}),Se.jsx("input",{type:"number",step:"0.0001",value:r,onChange:e=>l(parseFloat(e.target.value)||0)})]})]}),Se.jsx("div",{className:"roi-table",children:Se.jsxs("table",{children:[Se.jsx("thead",{children:Se.jsxs("tr",{children:[Se.jsx("th",{children:"Recipe"}),Se.jsx("th",{children:"Tier"}),Se.jsx("th",{children:"Crafting Cost"}),Se.jsx("th",{children:"Daily Earnings"}),Se.jsx("th",{children:"ROI Period"}),Se.jsx("th",{children:"Profit Margin"})]})}),Se.jsx("tbody",{children:Ea.map((e,t)=>{const a=d(e);return Se.jsxs("tr",{children:[Se.jsx("td",{children:e.name}),Se.jsx("td",{children:Se.jsx("span",{className:`tier-badge ${e.tier}`,children:e.tier})}),Se.jsxs("td",{children:[a.craftingCost.toFixed(4)," WAX"]}),Se.jsxs("td",{children:[a.dailyEarnings.toFixed(4)," WAX"]}),Se.jsxs("td",{children:[a.roiDays.toFixed(1)," days"]}),Se.jsxs("td",{className:a.profitMargin>0?"positive":"negative",children:[a.profitMargin.toFixed(1),"%"]})]},t)})})]})})]}),"staking"===e&&Se.jsxs("div",{className:"staking-tab",children:[Se.jsx("h2",{children:"Staking Information"}),Se.jsx("p",{className:"staking-description",children:"Stake your Pixel Journey NFTs to earn PXJ and WUF rewards. Use PXJ to infuse, upgrade, and unlock new journeys while earning returns over a 2-3 year period. Benefit from our yearly PXJ allocations (~25% of yearly inflation) that boost crafting incentives and reward active participants in the ecosystem."}),Se.jsxs("div",{className:"staking-tiers",children:[Se.jsxs("div",{className:"collapsible-section",children:[Se.jsxs("button",{className:"section-header",onClick:()=>c(e=>({...e,collectibles:!e.collectibles})),children:[Se.jsx("h3",{children:"Collectibles"}),Se.jsx("span",{className:"collapse-icon "+(o.collectibles?"collapsed":""),children:"\u25bc"})]}),!o.collectibles&&Se.jsx("div",{className:"tiers-grid",children:Se.jsxs("div",{className:"tier-section",children:[Se.jsx("h4",{className:"tier-title",children:"PFPs"}),Se.jsx("div",{className:"tier-items",children:nn.filter(e=>"pixals"===e.type).map(e=>{const t=m(e.id),a="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp";return Se.jsxs("div",{className:"tier-item",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const s=document.createElement("img");s.src=a,s.alt=e.name,t.currentTarget.parentNode?.appendChild(s)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),Se.jsxs("div",{className:"tier-info",children:[Se.jsx("h5",{children:e.name}),Se.jsxs("div",{className:"tier-stats",children:[Se.jsxs("span",{children:["PXJ: ",e.pxj]}),Se.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&Se.jsxs("span",{children:["Upgrade: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]})})]}),Se.jsxs("div",{className:"collapsible-section",children:[Se.jsxs("button",{className:"section-header",onClick:()=>c(e=>({...e,ingredients:!e.ingredients})),children:[Se.jsx("h3",{children:"Ingredients"}),Se.jsx("span",{className:"collapse-icon "+(o.ingredients?"collapsed":""),children:"\u25bc"})]}),!o.ingredients&&Se.jsxs("div",{className:"tiers-grid",children:[u.pixelpack.length>0&&Se.jsxs("div",{className:"tier-section",children:[Se.jsx("h4",{className:"tier-title",children:"Pixel Ingredient Pack"}),Se.jsx("div",{className:"tier-items",children:u.pixelpack.map(e=>{const t=m(e.id),a="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif";return Se.jsxs("div",{className:"tier-item",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const s=document.createElement("img");s.src=a,s.alt=e.name,t.currentTarget.parentNode?.appendChild(s)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),Se.jsxs("div",{className:"ingredient-info",children:[Se.jsx("h5",{children:e.name}),Se.jsxs("div",{className:"ingredient-stats",children:[Se.jsxs("span",{children:["PXJ: ",e.pxj]}),Se.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&Se.jsxs("span",{children:["Cost: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]}),Object.entries(u).filter(([e])=>"pixals"!==e&&"pixelpack"!==e).map(([e,t])=>Se.jsxs("div",{className:"tier-section",children:[Se.jsxs("h4",{className:"tier-title",children:[e.charAt(0).toUpperCase()+e.slice(1)," Ingredients"]}),Se.jsx("div",{className:"tier-items",children:t.map(e=>{const t=m(e.id),a="pixelpack"===e.type?"https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif":"pixals"===e.type?"https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp":"/img/placeholder-ingredient.png";return Se.jsxs("div",{className:"tier-item",children:[p(t)?Se.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const s=document.createElement("img");s.src=a,s.alt=e.name,t.currentTarget.parentNode?.appendChild(s)}}):Se.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),Se.jsxs("div",{className:"ingredient-info",children:[Se.jsx("h5",{children:e.name}),Se.jsxs("div",{className:"ingredient-stats",children:[Se.jsxs("span",{children:["PXJ: ",e.pxj]}),Se.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&Se.jsxs("span",{children:["Cost: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]},e))]})]}),Se.jsxs("div",{className:"collapsible-section",children:[Se.jsxs("button",{className:"section-header",onClick:()=>c(e=>({...e,governance:!e.governance})),children:[Se.jsx("h3",{children:"Governance NFTs"}),Se.jsx("span",{className:"collapse-icon "+(o.governance?"collapsed":""),children:"\u25bc"})]}),!o.governance&&Se.jsx("div",{className:"coming-soon-content",children:Se.jsx("p",{children:"Coming soon at next PixelDAO expansions"})})]})]})]})]}),Se.jsx($a,{isOpen:a,onClose:()=>s(!1),ingredient:null})]})};const ln=new class{constructor(){M(this,"FEATURE_ACCOUNT","feature.pxj"),M(this,"MIN_AMOUNT",5e5),M(this,"MAX_AMOUNT",5e6),M(this,"MIN_DAYS",30),M(this,"MAX_DAYS",365)}calculateDuration(e){const t=(e-this.MIN_AMOUNT)/(this.MAX_AMOUNT-this.MIN_AMOUNT);return Math.floor(this.MIN_DAYS+t*(this.MAX_DAYS-this.MIN_DAYS))}calculateRequiredAmount(e){const t=(e-this.MIN_DAYS)/(this.MAX_DAYS-this.MIN_DAYS);return Math.floor(this.MIN_AMOUNT+t*(this.MAX_AMOUNT-this.MIN_AMOUNT))}generatePromoMemo(e){const t=`${e.tokenSymbol}@${e.tokenContract}`,a=t.length+1+(e.imageUrl?e.imageUrl.length+1:0)+(e.websiteUrl?e.websiteUrl.length+1:0),s=Math.min(100,235-a);let n=e.description;n.length>s&&(n=n.substring(0,s-3)+"...");let i=`${t}|${n}`;return e.imageUrl&&(i+=`|${e.imageUrl}`),e.websiteUrl&&(i+=`|${e.websiteUrl}`),i}parseMemo(e){if(!e)return null;try{if(e.includes("|")&&e.includes("@")&&!e.startsWith("{")){const t=e.split("|");if(t.length>=2){const[e,a,s="",n=""]=t,[i,r]=e.split("@");return{type:"feature_token",token:e,tokenSymbol:i,tokenContract:r,description:a,image:s,website:n}}}const t=JSON.parse(e);return"feature_token"===t.type?t:null}catch(t){return De.error("Failed to parse memo:","FeaturedTokensService.parseMemo",t),null}}async getFeaturedTokens(){try{const t=await fetch(`https://wax.eosrio.io/v2/history/get_actions?account=${this.FEATURE_ACCOUNT}&filter=eosio.token:transfer&limit=100&sort=desc`);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.json(),s=[];for(const n of a.actions||[])try{const e=n.act.data,t=this.parseMemo(e.memo);if(!t||"feature_token"!==t.type)continue;const a=parseFloat(e.quantity.split(" ")[0]),i=new Date(n.timestamp),r=new Date(i.getTime()+24*t.duration*60*60*1e3),l=new Date<=r;if(a>=this.MIN_AMOUNT&&l){const[e,o]=t.token.split("@");s.push({id:n.trx_id,tokenSymbol:e,tokenContract:o,description:t.description,imageUrl:t.image,websiteUrl:t.website,paidAmount:a,startDate:i,endDate:r,transactionId:n.trx_id,isActive:l})}}catch(e){De.error("Error processing featured token action:","FeaturedTokensService.getFeaturedTokens",e)}return s.sort((e,t)=>e.paidAmount!==t.paidAmount?t.paidAmount-e.paidAmount:t.startDate.getTime()-e.startDate.getTime())}catch(e){return De.error("Failed to fetch featured tokens:","FeaturedTokensService.getFeaturedTokens",e),[]}}validatePayment(e){if(e.amount<this.MIN_AMOUNT||e.amount>this.MAX_AMOUNT)return{valid:!1,error:`Amount must be between ${this.MIN_AMOUNT.toLocaleString()} and ${this.MAX_AMOUNT.toLocaleString()} PXJ`};if(e.duration<this.MIN_DAYS||e.duration>this.MAX_DAYS)return{valid:!1,error:`Duration must be between ${this.MIN_DAYS} and ${this.MAX_DAYS} days`};if(!e.tokenSymbol||!e.tokenContract)return{valid:!1,error:"Token symbol and contract are required"};if(!e.description||e.description.length<10)return{valid:!1,error:"Description must be at least 10 characters"};const t=`${e.tokenSymbol}@${e.tokenContract}`.length+1+(e.imageUrl?e.imageUrl.length+1:0)+(e.websiteUrl?e.websiteUrl.length+1:0),a=Math.min(100,235-t);return e.description.length>a?{valid:!1,error:`Description too long. Maximum ${a} characters allowed with current image/website URLs.`}:{valid:!0}}},on=({className:e=""})=>{const{account:t,session:a}=Da(),{showSuccess:s,showError:n}=xt(),[i,r]=O.useState([]),[l,o]=O.useState(!0),[c,d]=O.useState(!1),[u,h]=O.useState({amount:5e5,duration:30,tokenSymbol:"",tokenContract:"",description:"",imageUrl:"",websiteUrl:""});O.useEffect(()=>{m()},[]);const m=async()=>{try{o(!0);const e=await ln.getFeaturedTokens();r(e)}catch(e){De.error("Failed to load featured tokens:","FeaturedTokens.loadFeaturedTokens",e)}finally{o(!1)}},p=e=>{const t=new Date,a=e.getTime()-t.getTime(),s=Math.floor(a/864e5),n=Math.floor(a%864e5/36e5);return s>0?`${s}d ${n}h remaining`:n>0?`${n}h remaining`:"Expires soon"};return Se.jsxs("div",{className:`featured-tokens ${e}`,children:[Se.jsxs("div",{className:"featured-tokens-header",children:[Se.jsx("h3",{children:"\ud83c\udf1f Featured Tokens"}),Se.jsx("button",{className:"promote-button",onClick:()=>d(!0),disabled:!t,children:"Promote Your Token"})]}),l?Se.jsxs("div",{className:"featured-tokens-loading",children:[Se.jsx("div",{className:"loading-spinner"}),Se.jsx("span",{children:"Loading featured tokens..."})]}):i.length>0?Se.jsx("div",{className:"featured-tokens-grid",children:i.slice(0,6).map(e=>Se.jsxs("div",{className:"featured-token-card",children:[e.imageUrl&&Se.jsx("div",{className:"token-image",children:Se.jsx("img",{src:e.imageUrl,alt:e.tokenSymbol})}),Se.jsxs("div",{className:"token-info",children:[Se.jsxs("div",{className:"token-header",children:[Se.jsx("span",{className:"token-symbol",children:e.tokenSymbol}),Se.jsxs("span",{className:"token-contract",children:["@",e.tokenContract]})]}),Se.jsx("p",{className:"token-description",children:e.description}),Se.jsxs("div",{className:"token-meta",children:[Se.jsxs("span",{className:"promo-amount",children:[e.paidAmount.toLocaleString()," PXJ"]}),Se.jsx("span",{className:"time-remaining",children:p(e.endDate)})]}),e.websiteUrl&&Se.jsx("a",{href:e.websiteUrl,target:"_blank",rel:"noopener noreferrer",className:"token-website",children:"Visit Website \u2192"})]})]},e.id))}):Se.jsxs("div",{className:"no-featured-tokens",children:[Se.jsx("p",{children:"No featured tokens at the moment."}),Se.jsx("p",{children:"Be the first to promote your token!"})]}),c&&Se.jsx("div",{className:"promo-modal-overlay",onClick:()=>d(!1),children:Se.jsxs("div",{className:"promo-modal",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"promo-modal-header",children:[Se.jsx("h3",{children:"Promote Your Token"}),Se.jsx("button",{className:"close-button",onClick:()=>d(!1),children:"\xd7"})]}),Se.jsxs("div",{className:"promo-form",children:[Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Token Symbol"}),Se.jsx("input",{type:"text",value:u.tokenSymbol,onChange:e=>h(t=>({...t,tokenSymbol:e.target.value.toUpperCase()})),placeholder:"e.g., MYTOKEN"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Token Contract"}),Se.jsx("input",{type:"text",value:u.tokenContract,onChange:e=>h(t=>({...t,tokenContract:e.target.value})),placeholder:"e.g., mycontract12"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Description"}),Se.jsx("textarea",{value:u.description,onChange:e=>h(t=>({...t,description:e.target.value})),placeholder:"Describe your token and why users should trade it...",rows:3})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Image URL (optional)"}),Se.jsx("input",{type:"url",value:u.imageUrl,onChange:e=>h(t=>({...t,imageUrl:e.target.value})),placeholder:"https://example.com/token-logo.png"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsx("label",{children:"Website URL (optional)"}),Se.jsx("input",{type:"url",value:u.websiteUrl,onChange:e=>h(t=>({...t,websiteUrl:e.target.value})),placeholder:"https://yourtoken.com"})]}),Se.jsxs("div",{className:"form-group",children:[Se.jsxs("label",{children:["Promotion Amount: ",u.amount.toLocaleString()," PXJ"]}),Se.jsx("input",{type:"range",min:5e5,max:5e6,step:5e4,value:u.amount,onChange:e=>(e=>{const t=ln.calculateDuration(e);h(a=>({...a,amount:e,duration:t}))})(parseInt(e.target.value)),className:"amount-slider"}),Se.jsxs("div",{className:"slider-labels",children:[Se.jsx("span",{children:"500K PXJ (30 days)"}),Se.jsx("span",{children:"5M PXJ (365 days)"})]})]}),Se.jsxs("div",{className:"promotion-summary",children:[Se.jsxs("div",{className:"summary-item",children:[Se.jsx("span",{children:"Duration:"}),Se.jsxs("span",{children:[u.duration," days"]})]}),Se.jsxs("div",{className:"summary-item",children:[Se.jsx("span",{children:"Cost:"}),Se.jsxs("span",{children:[u.amount.toLocaleString()," PXJ"]})]})]}),Se.jsxs("div",{className:"form-actions",children:[Se.jsx("button",{className:"cancel-button",onClick:()=>d(!1),children:"Cancel"}),Se.jsx("button",{className:"submit-button",onClick:async()=>{if(!t||!a)return void n("Please connect your wallet first");const e=ln.validatePayment(u);if(e.valid)try{const e=ln.generatePromoMemo(u),n={actions:[{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"feature.pxj",quantity:`${u.amount.toFixed(4)} PXJ`,memo:e}}]},i=await a.transact(n);let r=null;i&&(r=i.transaction_id||i.id||i.processed?.id||i.processed?.transaction_id||i.response&&i.response.transaction_id||i.transaction&&i.transaction.id),s(r?`Promotion submitted successfully! Transaction: ${r}`:"Promotion submitted successfully!"),d(!1),setTimeout(()=>{m()},3e3)}catch(i){De.error("Failed to submit promotion:","FeaturedTokens.submitPromotion",i),n(`Failed to submit promotion: ${i instanceof Error?i.message:"Unknown error"}`)}else n(e.error||"Invalid promotion parameters")},disabled:!u.tokenSymbol||!u.tokenContract||!u.description,children:"Submit Promotion"})]})]})]})})]})},cn=()=>Se.jsx("div",{className:"pxswap-page",children:Se.jsxs("div",{className:"pxswap-container",children:[Se.jsxs("div",{className:"pxswap-header",children:[Se.jsx("h1",{children:"PxSwap"}),Se.jsxs("p",{children:["PxSwap currently uses ",Se.jsx("strong",{children:Se.jsx("a",{href:"https://alcor.exchange/swap",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary-purple)",textDecoration:"none",fontWeight:"500"},onMouseEnter:e=>e.target.style.textDecoration="underline",onMouseLeave:e=>e.target.style.textDecoration="none",children:"Alcor Exchange"})})," for all swaps, providing reliable liquidity and competitive rates. We're expanding to include multi-DEX routing in the future."]})]}),Se.jsx("div",{className:"pxswap-content",children:Se.jsx(Is,{})}),Se.jsxs("div",{className:"pxswap-info",children:[Se.jsxs("div",{className:"swap-info-section",children:[Se.jsx("h3",{children:"\ud83d\udd04 PxSwap Platform Overview"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"Universal Token Swapping"}),Se.jsx("p",{children:"PxSwap enables seamless trading of any tokens held directly on our platform. Trade between WAX ecosystem tokens, community tokens, and project-specific assets with ease using our integrated Alcor Exchange routing."})]}),Se.jsxs("div",{className:"info-card routing-info",children:[Se.jsx("h4",{children:"\ud83d\udee3\ufe0f Multi-DEX Routing"}),Se.jsxs("p",{children:["PxSwap currently uses ",Se.jsx("strong",{children:"Alcor Exchange"})," for all swaps, providing reliable liquidity and competitive rates. We're expanding to include multi-DEX routing in the future for even better prices and deeper liquidity."]}),Se.jsxs("p",{children:[Se.jsx("strong",{children:"Want advanced routing now?"})," Visit"," ",Se.jsx("a",{href:"https://waxonedge.app/swap/WAX_eosio.token/PXJ_pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"WaxOnEdge"})," ","for their ecosystem-MVP swap routing platform."]})]})]})]}),Se.jsx(on,{}),Se.jsxs("div",{className:"swap-info-section",children:[Se.jsx("h3",{children:"\ud83d\udcb0 DeFi & LP Farming on WAX"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"\ud83c\udfdb\ufe0f Alcor Exchange"}),Se.jsx("p",{children:"The premier DEX on WAX with deep liquidity pools and farming opportunities."}),Se.jsx("a",{href:"https://alcor.exchange/farm",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Farm on Alcor \u2192"})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"\ud83c\udf2e TacoCrypto"}),Se.jsx("p",{children:"Innovative DeFi platform offering unique yield farming and staking mechanisms."}),Se.jsx("a",{href:"https://swap.tacocrypto.io/meal",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Explore TacoCrypto \u2192"})]})]})]}),Se.jsxs("div",{className:"swap-info-section",children:[Se.jsx("h3",{children:"\ud83d\udcc8 PXJ Spot Markets"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"PXJ/WAX"}),Se.jsx("p",{children:"Primary trading pair with highest liquidity"}),Se.jsx("a",{href:"https://alcor.exchange/trade/pxj-pixeljourney_wax-eosio.token",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Trade PXJ/WAX \u2192"})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"PXJ/WUF"}),Se.jsx("p",{children:"Community favorite pairing"}),Se.jsx("a",{href:"https://alcor.exchange/trade/pxj-pixeljourney_wuf-wuffi",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Trade PXJ/WUF \u2192"})]}),Se.jsxs("div",{className:"info-card community-request",children:[Se.jsx("h4",{children:"\ud83e\udd14 What's Next?"}),Se.jsx("p",{children:"What market should we open next? WPIXAL/PXJ? WPIXAL/USDC? Let us and the WaxRock Council know on our Discord!"}),Se.jsx("a",{href:"#",className:"info-link discord-link",children:"Join Discord \u2192"})]})]})]}),Se.jsxs("div",{className:"swap-info-section",children:[Se.jsx("h3",{children:"\ud83d\udcca WAX DeFi Analytics"}),Se.jsxs("div",{className:"info-grid",children:[Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"\ud83d\udcc8 Alcor Analytics"}),Se.jsx("p",{children:"Detailed trading data and market insights for Alcor Exchange"}),Se.jsx("a",{href:"https://alcor.exchange/analytics/",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"View Alcor Data \u2192"})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"\ud83c\udf0a WaxOnEdge Analytics"}),Se.jsx("p",{children:"Comprehensive ecosystem analytics and cross-DEX insights"}),Se.jsx("a",{href:"https://waxonedge.app/analytics",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Explore WaxOnEdge \u2192"})]}),Se.jsxs("div",{className:"info-card",children:[Se.jsx("h4",{children:"\ud83d\udd0d WAX Network Overview"}),Se.jsx("p",{children:"Complete WAX blockchain DeFi metrics and network statistics"}),Se.jsx("a",{href:"https://grafana.waxtools.net/",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"View Network Stats \u2192"})]})]})]})]})]})}),dn=({alert:e,onClose:t})=>{const[a,s]=O.useState(!1),[n,i]=O.useState(!1),r=O.useCallback(()=>{i(!0),setTimeout(()=>{t()},300)},[t]);O.useEffect(()=>{const e=setTimeout(()=>s(!0),100),t=setTimeout(()=>{r()},8e3);return()=>{clearTimeout(e),clearTimeout(t)}},[r]);return Se.jsx("div",{className:`price-alert-notification ${a&&!n?"visible":""} ${n?"closing":""}`,children:Se.jsxs("div",{className:"notification-content",children:[Se.jsxs("div",{className:"notification-header",children:[Se.jsx("div",{className:"notification-icon",children:Se.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:Se.jsx("path",{d:"M15 17h5l-5 5-5-5h5v-5a7.5 7.5 0 1 0-15 0v5h5l-5 5-5-5h5v-5a12.5 12.5 0 1 1 25 0v5z"})})}),Se.jsxs("div",{className:"notification-title",children:[Se.jsx("h4",{children:"Price Alert"}),Se.jsx("span",{className:"notification-time",children:(new Date).toLocaleTimeString()})]}),Se.jsx("button",{className:"notification-close",onClick:r,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"notification-body",children:[Se.jsx("div",{className:"nft-preview",children:Se.jsx("img",{src:e.item.nft.image,alt:e.item.nft.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}})}),Se.jsxs("div",{className:"alert-details",children:[Se.jsx("h5",{className:"nft-name",children:e.item.nft.name}),Se.jsx("p",{className:"alert-message",children:e.message})]})]}),Se.jsxs("div",{className:"notification-actions",children:[Se.jsx("button",{className:"btn-secondary",onClick:r,children:"Dismiss"}),Se.jsx("button",{className:"btn-primary",onClick:()=>{window.location.href="/watchlist",r()},children:"View Watchlist"})]})]})})},un=()=>{const[e,t]=O.useState([]);O.useEffect(()=>{const e=e=>{t(t=>[...t,e.detail])};return window.addEventListener("priceAlert",e),()=>{window.removeEventListener("priceAlert",e)}},[]);return Se.jsx("div",{className:"price-alert-manager",children:e.map((e,a)=>Se.jsx(dn,{alert:e,onClose:()=>(e=>{t(t=>t.filter((t,a)=>a!==e))})(a)},`${e.item.nft.asset_id}-${Date.now()}-${a}`))})},hn=()=>{const{notifications:e,removeNotification:t,soundEnabled:a}=xt(),s=O.useRef(null),n=O.useRef({}),i=(e,t,a,s)=>{const n=e.sampleRate,i=n*a,r=e.createBuffer(1,i,n),l=r.getChannelData(0);for(let o=0;o<i;o++){const e=o/n;let a=0;switch(s){case"sine":a=Math.sin(2*Math.PI*t*e);break;case"square":a=Math.sign(Math.sin(2*Math.PI*t*e));break;case"triangle":a=2/Math.PI*Math.asin(Math.sin(2*Math.PI*t*e))}const i=Math.exp(5*-e);l[o]=a*i*.1}return r},r=O.useCallback(e=>{if(a&&s.current&&n.current[e])try{const t=s.current.createBufferSource();t.buffer=n.current[e],t.connect(s.current.destination),t.start()}catch(t){console.warn("Failed to play notification sound:",t)}},[a]);if(O.useEffect(()=>((async()=>{try{s.current=new(window.AudioContext||window.webkitAudioContext);const e={success:i(s.current,800,.1,"sine"),error:i(s.current,400,.2,"square"),warning:i(s.current,600,.15,"triangle"),info:i(s.current,500,.1,"sine")};n.current=e}catch(e){console.warn("Audio context initialization failed:",e)}})(),()=>{s.current&&s.current.close()}),[]),O.useEffect(()=>{if(e.length>0){const t=e[e.length-1];r(t.type)}},[e.length,e,r]),0===e.length)return null;return Se.jsx("div",{className:"notification-container",children:e.map(e=>Se.jsx("div",{className:`notification notification-${e.type}`,"data-notification-id":e.id,children:Se.jsxs("div",{className:"notification-content",children:[Se.jsxs("div",{className:"notification-header",children:[e.title&&Se.jsx("h4",{className:"notification-title",children:e.title}),Se.jsx("button",{className:"notification-close",onClick:()=>(e=>{const a=document.querySelector(`[data-notification-id="${e}"]`);a?(a.classList.add("removing"),setTimeout(()=>{t(e)},300)):t(e)})(e.id),"aria-label":"Close notification",children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsxs("div",{className:"notification-body",children:[Se.jsxs("div",{className:"notification-icon",children:["success"===e.type&&Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),Se.jsx("polyline",{points:"22,4 12,14.01 9,11.01"})]}),"error"===e.type&&Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),Se.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"warning"===e.type&&Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),Se.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),Se.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),"info"===e.type&&Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("circle",{cx:"12",cy:"12",r:"10"}),Se.jsx("path",{d:"M12 16v-4"}),Se.jsx("path",{d:"M12 8h.01"})]})]}),Se.jsxs("div",{className:"notification-message",children:[Se.jsx("p",{children:e.message}),e.action&&Se.jsx("button",{className:"notification-action",onClick:e.action.onClick,children:e.action.label})]})]})]})},e.id))})},mn=()=>{const{confirmDialog:e,resolveConfirm:t}=xt();if(!e)return null;const a=()=>{t(!1)};return Se.jsx("div",{className:"modal-overlay",onClick:a,children:Se.jsxs("div",{className:"modal confirm-dialog",onClick:e=>e.stopPropagation(),children:[Se.jsxs("div",{className:"modal-header",children:[Se.jsx("h3",{children:e.title||"Confirm Action"}),Se.jsx("button",{className:"modal-close",onClick:a,children:Se.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[Se.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Se.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),Se.jsx("div",{className:"modal-body",children:Se.jsx("p",{children:e.message})}),Se.jsxs("div",{className:"modal-actions",children:[Se.jsx("button",{className:"btn-secondary",onClick:a,children:e.cancelText||"Cancel"}),Se.jsx("button",{className:"btn-primary",onClick:()=>{t(!0)},children:e.confirmText||"Confirm"})]})]})})};class pn extends O.Component{constructor(e){super(e),M(this,"reportError",async(e,t)=>{try{const a={message:e.message,stack:e.stack,componentStack:t.componentStack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href};Oe.warn("Error Report generated","ErrorBoundary",a)}catch(a){Oe.error("Failed to report error","ErrorBoundary",a)}}),M(this,"handleRetry",()=>{const e=this.state.retryCount+1;e>3?Oe.warn("Maximum retry attempts reached","ErrorBoundary"):this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e})}),this.state={hasError:!1,retryCount:0}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){Oe.error("ErrorBoundary caught an error","ErrorBoundary",e,{componentStack:t.componentStack,errorBoundary:this.constructor.name}),this.props.onError&&this.props.onError(e,t),this.setState({error:e,errorInfo:t}),this.reportError(e,t)}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=this.state.retryCount>=3;return Se.jsx(va,{title:"Something went wrong",message:e?"Multiple errors occurred. Please refresh the page or contact support if the problem persists.":"An unexpected error occurred. Please try again or refresh the page.",onRetry:e?void 0:this.handleRetry,showRetry:!e})}return this.props.children}}class fn extends O.Component{constructor(e){super(e),M(this,"maxRetries",3),M(this,"retryTimeouts",[]),M(this,"handleRetry",()=>{if(this.state.retryCount>=this.maxRetries)return void De.warn("Max retries reached for API error boundary");const e=1e3*Math.pow(2,this.state.retryCount),t=.1*Math.random()*e,a=Math.min(e+t,3e4);this.setState({isRetrying:!0,lastRetryTime:Date.now()});const s=setTimeout(()=>{this.setState(e=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e.retryCount+1,isRetrying:!1}))},a);this.retryTimeouts.push(s)}),M(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:0})}),this.state={hasError:!1,retryCount:0,isRetrying:!1,errorCategory:"unknown"}}componentWillUnmount(){this.retryTimeouts.forEach(e=>clearTimeout(e))}static getDerivedStateFromError(e){const t=e.message.toLowerCase();let a="unknown";t.includes("fetch")||t.includes("network")||t.includes("connection")?a="network":t.includes("timeout")||t.includes("aborted")?a="timeout":(t.includes("http")||t.includes("api")||t.includes("failed to load"))&&(a="api");if(["network","api","timeout"].includes(a)||"ChunkLoadError"===e.name||"TypeError"===e.name&&t.includes("fetch"))return{hasError:!0,error:e,errorCategory:a};throw e}componentDidCatch(e,t){Le.logError("APIErrorBoundary",e,{errorInfo:t,retryCount:this.state.retryCount,componentStack:t.componentStack}),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=this.state.retryCount<this.maxRetries;let t;switch(this.state.errorCategory){case"network":t="NETWORK_ERROR";break;case"timeout":t="TIMEOUT_ERROR";break;case"api":t="API_ERROR";break;default:t="LOAD_FAILED"}return Se.jsxs("div",{className:"error-boundary-container",children:[Se.jsx(va,{errorType:t,onRetry:e?this.handleRetry:this.handleReset,showRetry:!0,isRetrying:this.state.isRetrying,retryCount:this.state.retryCount,maxRetries:this.maxRetries}),this.state.retryCount>0&&Se.jsxs("div",{className:"error-retry-info",children:[Se.jsxs("p",{children:["Retry attempt ",this.state.retryCount," of ",this.maxRetries]}),this.state.isRetrying&&Se.jsxs("div",{className:"retry-progress",children:[Se.jsx("div",{className:"retry-spinner"}),Se.jsx("span",{children:"Retrying..."})]})]}),!1]})}return this.props.children}}const xn=()=>{const{isConnected:e,account:t}=Fe();return O.useEffect(()=>{if(!e||!t)return;const a=setTimeout(async()=>{try{const e=`watchlist_last_check_${t}`,a=localStorage.getItem(e),s=a?parseInt(a):0,n=Date.now();if(n-s<3e5)return;const i=await wt.getWatchlist();if(0===i.length)return void localStorage.setItem(e,n.toString());const r=[];for(const t of i){const e=wt.getPriceAlert(t.nft.asset_id);if(e&&e.enabled&&e.lastTriggered&&e.lastTriggered>s){let a="";const s=t.lastPrice||parseFloat(t.nft.price||"0");switch(e.alertType){case"below":a=`${t.nft.name} price dropped to ${s.toFixed(2)} WAX (target: ${e.targetPrice} WAX)`;break;case"above":a=`${t.nft.name} price rose to ${s.toFixed(2)} WAX (target: ${e.targetPrice} WAX)`;break;case"any":{const e=Math.abs(t.priceChange||0),n=(t.priceChange||0)>0?"increased":"decreased";a=`${t.nft.name} price ${n} by ${e.toFixed(1)}% to ${s.toFixed(2)} WAX`;break}}r.push({alert:e,item:t,message:a,triggeredAt:e.lastTriggered})}}r.sort((e,t)=>t.triggeredAt-e.triggeredAt),r.forEach((e,t)=>{setTimeout(()=>{window.dispatchEvent(new CustomEvent("priceAlert",{detail:{item:e.item,message:e.message}}))},1e3*t)}),localStorage.setItem(e,n.toString()),r.length>0&&De.info(`Found ${r.length} triggered watchlist alerts since last visit`)}catch(e){De.error("Error checking watchlist alerts:","WatchlistAlertChecker.checkTriggeredAlerts",e)}},2e3);return()=>clearTimeout(a)},[e,t]),null},gn=()=>{const[e,t]=O.useState(null),[a,s]=O.useState(!1),[n,i]=O.useState(!1),[r,l]=O.useState(navigator.onLine),[o,c]=O.useState(!1);O.useEffect(()=>{(()=>{const e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");c(e),i(e)})();const e=e=>{e.preventDefault();t(e),s(!0)},a=()=>{i(!0),s(!1),t(null)},n=()=>l(!0),r=()=>l(!1);window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",a),window.addEventListener("online",n),window.addEventListener("offline",r);const o=window.matchMedia("(display-mode: standalone)"),d=e=>{c(e.matches),i(e.matches)};return o.addEventListener?o.addEventListener("change",d):o.addListener(d),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",a),window.removeEventListener("online",n),window.removeEventListener("offline",r),o.removeEventListener?o.removeEventListener("change",d):o.removeListener(d)}},[]);return{isInstallable:a,isInstalled:n,isOnline:r,isStandalone:o,installPrompt:e,showInstallPrompt:async()=>{if(e)try{await e.prompt();const{outcome:a}=await e.userChoice;De.info("accepted"===a?"User accepted the install prompt":"User dismissed the install prompt"),t(null),s(!1)}catch(a){De.error("Error showing install prompt:","usePWA.showInstallPrompt",a)}},dismissInstallPrompt:()=>{t(null),s(!1)}}},vn=({className:e=""})=>{const{isInstallable:t,isInstalled:a,isStandalone:s,showInstallPrompt:n,dismissInstallPrompt:i}=gn();return!t||a||s?null:Se.jsx("div",{className:`pwa-install-banner ${e}`,role:"banner","aria-label":"Install app banner",children:Se.jsxs("div",{className:"pwa-banner-content",children:[Se.jsx("div",{className:"pwa-banner-icon",children:Se.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[Se.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",fill:"currentColor",fillOpacity:"0.1",stroke:"currentColor",strokeWidth:"1.5"}),Se.jsx("path",{d:"M8 12l2 2 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),Se.jsxs("div",{className:"pwa-banner-text",children:[Se.jsx("h3",{className:"pwa-banner-title",children:"Install PxMarket"}),Se.jsx("p",{className:"pwa-banner-description",children:"Get the full app experience with offline access and faster loading."})]}),Se.jsxs("div",{className:"pwa-banner-actions",children:[Se.jsxs("button",{type:"button",className:"pwa-install-button",onClick:n,"aria-label":"Install PxMarket app",children:[Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Se.jsx("path",{d:"M8 1v10M4 7l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Install"]}),Se.jsx("button",{type:"button",className:"pwa-dismiss-button",onClick:i,"aria-label":"Dismiss install banner",children:Se.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:Se.jsx("path",{d:"M12 4L4 12M4 4l8 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})})},yn=({className:e=""})=>{const{isOnline:t}=gn();return t?null:Se.jsx("div",{className:`offline-indicator ${e}`,role:"status","aria-live":"polite","aria-label":"You are currently offline",children:Se.jsxs("div",{className:"offline-content",children:[Se.jsx("div",{className:"offline-icon",children:Se.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[Se.jsx("path",{d:"M3 7c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v6c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V7z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),Se.jsx("path",{d:"M7 9l6 4M13 9l-6 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),Se.jsxs("div",{className:"offline-text",children:[Se.jsx("span",{className:"offline-title",children:"You're offline"}),Se.jsx("span",{className:"offline-description",children:"Some features may be limited"})]}),Se.jsx("div",{className:"offline-pulse","aria-hidden":"true"})]})})},jn=()=>{const[e,t]=O.useState([]),[a,s]=O.useState(new Set),{activeTransactions:n,completedTransactions:i}=(()=>{const[e,t]=O.useState({activeTransactions:new Map,completedTransactions:[],isProcessing:!1}),{executeTransaction:a,getTransaction:s,cancelTransaction:n}=Fe(),i=O.useRef(new Map),r=O.useCallback((e,a)=>{t(t=>{const s=new Map(t.activeTransactions),n=s.get(e);if(n){const r={...n,...a};if("success"===r.status||"failed"===r.status||"cancelled"===r.status){s.delete(e);const a=i.current.get(e);return a&&(clearInterval(a),i.current.delete(e)),{...t,activeTransactions:s,completedTransactions:[r,...t.completedTransactions.slice(0,49)],isProcessing:s.size>0}}return s.set(e,r),{...t,activeTransactions:s}}return t})},[]),l=O.useCallback(async e=>{try{if(!s)return void De.warn("getWalletTransaction not available");const t=await s(e);t&&r(e,t)}catch(t){De.error(`Error polling transaction ${e}:`,"useTransactionManager.pollTransactionStatus",t),r(e,{status:"failed",error:"Failed to check transaction status"})}},[s,r]),o=O.useCallback(e=>{const t=i.current.get(e);t&&clearInterval(t);const a=setInterval(()=>{l(e)},2e3);i.current.set(e,a),setTimeout(()=>{i.current.get(e)===a&&(clearInterval(a),i.current.delete(e),r(e,{status:"failed",error:"Transaction timeout - please check manually"}))},3e5)},[l,r]),c=O.useCallback(async(e,s)=>{try{if(t(e=>({...e,isProcessing:!0})),!a)throw new Error("executeTransaction not available - wallet not connected");const n=await a(e,s);if(n){const a={id:n,type:e,status:"pending",timestamp:Date.now(),account:"",actions:[],metadata:s};return t(e=>{const t=new Map(e.activeTransactions);return t.set(n,a),{...e,activeTransactions:t}}),o(n),n}return null}catch(n){throw De.error("Error starting transaction:","useTransactionManager.startTransaction",n),t(e=>({...e,isProcessing:!1})),n}},[a,o]),d=O.useCallback(t=>{const a=e.activeTransactions.get(t);return a||(e.completedTransactions.find(e=>e.id===t)||null)},[e.activeTransactions,e.completedTransactions]),u=O.useCallback(async e=>{try{if(!n)return De.warn("cancelWalletTransaction not available"),!1;const t=await n(e);return t&&r(e,{status:"cancelled",error:"Transaction cancelled by user"}),t}catch(t){return De.error("Error cancelling transaction:","useTransactionManager.cancelTransaction",t),!1}},[n,r]),h=O.useCallback(()=>{t(e=>({...e,completedTransactions:[]}))},[]),m=O.useCallback(()=>e.activeTransactions.size,[e.activeTransactions.size]),p=O.useCallback(()=>e.completedTransactions.length,[e.completedTransactions.length]),f=O.useCallback(()=>e.completedTransactions.some(e=>"failed"===e.status),[e.completedTransactions]);return{activeTransactions:Array.from(e.activeTransactions.values()),completedTransactions:e.completedTransactions,isProcessing:e.isProcessing,startTransaction:c,getTransaction:d,cancelTransaction:u,clearCompleted:h,getActiveCount:m,getCompletedCount:p,hasFailedTransactions:f}})(),{showSuccess:r,showError:l}=xt(),o=O.useCallback(e=>{const a={...e,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),autoHide:e.autoHide??!0,duration:e.duration??5e3};t(e=>[a,...e.slice(0,4)]),a.autoHide&&setTimeout(()=>{c(a.id)},a.duration)},[]),c=O.useCallback(e=>{t(t=>t.filter(t=>t.id!==e))},[]);O.useEffect(()=>{[...n,...i].forEach(e=>{if(!a.has(e.id))switch(s(t=>new Set([...t,e.id])),e.status){case"pending":o({type:"info",title:"Transaction Started",message:`${d(e.type)} transaction is being prepared...`,transactionId:e.id,duration:3e3});break;case"processing":o({type:"info",title:"Processing Transaction",message:`${d(e.type)} is being processed on the blockchain...`,transactionId:e.id,duration:4e3});break;case"success":o({type:"success",title:"Transaction Successful!",message:`${d(e.type)} completed successfully`,transactionId:e.id,duration:6e3}),r("Transaction Complete",`Your ${d(e.type).toLowerCase()} has been processed successfully!`);break;case"failed":o({type:"error",title:"Transaction Failed",message:e.error||`${d(e.type)} failed to process`,transactionId:e.id,autoHide:!1}),l("Transaction Failed",e.error||"Your transaction failed to process. Please try again.");break;case"cancelled":o({type:"warning",title:"Transaction Cancelled",message:`${d(e.type)} was cancelled`,transactionId:e.id,duration:4e3})}})},[n,i,a,o,r,l]);const d=e=>{switch(e){case"nft_purchase":return"NFT Purchase";case"nft_transfer":return"NFT Transfer";case"token_transfer":return"Token Transfer";case"nft_listing":return"NFT Listing";case"listing_cancel":return"Cancel Listing";case"crafting":return"Crafting";case"blend":return"Blend";case"burn":return"Burn Assets";case"unpack":return"Unpack Asset";case"auction_bid":return"Auction Bid";case"tokenize_wax":return"Tokenize WAX";default:return e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}},u=e=>{switch(e){case"success":return"\u2705";case"error":return"\u274c";case"warning":return"\u26a0\ufe0f";default:return"\u2139\ufe0f"}},h=e=>{const t=Date.now()-e,a=Math.floor(t/1e3),s=Math.floor(a/60);if(a<60)return"Just now";if(s<60)return`${s}m ago`;const n=Math.floor(s/60);return n<24?`${n}h ago`:new Date(e).toLocaleDateString()};return 0===e.length?null:Se.jsx("div",{className:"transaction-notifications",children:e.map(e=>Se.jsxs("div",{className:`notification notification-${e.type}`,children:[Se.jsxs("div",{className:"notification-content",children:[Se.jsxs("div",{className:"notification-header",children:[Se.jsx("span",{className:"notification-icon",children:u(e.type)}),Se.jsx("span",{className:"notification-title",children:e.title}),Se.jsx("span",{className:"notification-time",children:h(e.timestamp)}),Se.jsx("button",{className:"notification-close",onClick:()=>c(e.id),children:"\xd7"})]}),Se.jsx("div",{className:"notification-message",children:e.message}),e.transactionId&&Se.jsxs("div",{className:"notification-transaction-id",children:["ID: ",e.transactionId.slice(0,8),"...",e.transactionId.slice(-8)]})]}),e.autoHide&&Se.jsx("div",{className:"notification-progress",style:{animationDuration:`${e.duration}ms`}})]},e.id))})},bn=()=>{const e=J(),[t,a]=O.useState("landing");D.useEffect(()=>{const t=e.pathname;""===t||"/"===t||"/market-alphatest/"===t||"/market-alphatest"===t?a("/landing"):"/marketplace"===t||"/market-alphatest/marketplace"===t?a("marketplace"):"/rewards"===t?a("rewards"):"/inventory"===t?a("inventory"):"/packs"===t?a("packs"):t.startsWith("/collections")?a("collections"):"/activity"===t||"/stats"===t?a("activity"):"/staking"===t?a("staking"):"/profile"===t?a("profile"):"/watchlist"===t?a("watchlist"):"/auctions"===t?a("auctions"):"/learn"===t?a("learn"):"/journeymap"===t?a("journeymap"):"/pxcrafting"===t&&a("pxcrafting")},[e.pathname]),D.useEffect(()=>{window.scrollTo(0,0)},[e.pathname]);return Se.jsxs("div",{className:"App",children:[Se.jsx(jt,{currentPage:t,onPageChange:e=>{a(e),"landing"===e?window.history.pushState(null,"","/"):"marketplace"===e?window.history.pushState(null,"","/marketplace"):window.history.pushState(null,"",`/${e}`)}}),Se.jsx("main",{id:"main-content",role:"main","aria-label":"Main content",className:"main-content",children:Se.jsxs(V,{children:[Se.jsx(G,{path:"/",element:Se.jsx(fn,{children:Se.jsx(bt,{})})}),Se.jsx(G,{path:"/marketplace",element:Se.jsx(fn,{children:Se.jsx(ba,{})})}),Se.jsx(G,{path:"/rewards",element:Se.jsx(fn,{children:Se.jsx(Na,{})})}),Se.jsx(G,{path:"/inventory",element:Se.jsx(fn,{children:Se.jsx(Ja,{})})}),Se.jsx(G,{path:"/packs",element:Se.jsx(fn,{children:Se.jsx(Ls,{})})}),Se.jsx(G,{path:"/collections",element:Se.jsx(fn,{children:Se.jsx(ss,{})})}),Se.jsx(G,{path:"/collections/:collectionName",element:Se.jsx(fn,{children:Se.jsx(os,{})})}),Se.jsx(G,{path:"/collections/:collectionName/templates/:templateId",element:Se.jsx(fn,{children:Se.jsx(cs,{})})}),Se.jsx(G,{path:"/assets/:assetId",element:Se.jsx(fn,{children:Se.jsx(ds,{})})}),Se.jsx(G,{path:"/listings/:saleId",element:Se.jsx(fn,{children:Se.jsx(us,{})})}),Se.jsx(G,{path:"/transactions/:transactionId",element:Se.jsx(fn,{children:Se.jsx(hs,{})})}),Se.jsx(G,{path:"/activity",element:Se.jsx(fn,{children:Se.jsx(Ws,{})})}),Se.jsx(G,{path:"/stats",element:Se.jsx(fn,{children:Se.jsx(Ws,{})})}),Se.jsx(G,{path:"/profile",element:Se.jsx(fn,{children:Se.jsx(Fs,{})})}),Se.jsx(G,{path:"/profile/:account",element:Se.jsx(fn,{children:Se.jsx($s,{})})}),Se.jsx(G,{path:"/user-profile-lookup",element:Se.jsx(fn,{children:Se.jsx($s,{})})}),Se.jsx(G,{path:"/watchlist",element:Se.jsx(fn,{children:Se.jsx(Ms,{})})}),Se.jsx(G,{path:"/auctions",element:Se.jsx(fn,{children:Se.jsx(Ds,{})})}),Se.jsx(G,{path:"/auctions/:id",element:Se.jsx(fn,{children:Se.jsx(Us,{})})}),Se.jsx(G,{path:"/learn",element:Se.jsx(fn,{children:Se.jsx(Bs,{})})}),Se.jsx(G,{path:"/journeymap",element:Se.jsx(fn,{children:Se.jsx(zs,{})})}),Se.jsx(G,{path:"/staking",element:Se.jsx(fn,{children:Se.jsx(Ks,{})})}),Se.jsx(G,{path:"/rwax",element:Se.jsx(fn,{children:Se.jsx(sn,{})})}),Se.jsx(G,{path:"/pxcrafting",element:Se.jsx(fn,{children:Se.jsx(rn,{})})}),Se.jsx(G,{path:"/pxswap",element:Se.jsx(fn,{children:Se.jsx(cn,{})})})]})}),Se.jsx(Rs,{})]})};Ee.createRoot(document.getElementById("root")).render(Se.jsx(O.StrictMode,{children:Se.jsx($,{})}));
//# sourceMappingURL=index-BazSAacu.js.map
