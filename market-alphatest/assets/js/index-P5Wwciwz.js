var e=Object.defineProperty,t=(t,a,n)=>((t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n)(t,"symbol"!=typeof a?a+"":a,n);import{r as a,b as n,c as i,R as r,L as s,u as l,d as c,e as o,f as d,B as h,h as u,i as m,j as p}from"./vendor-WE9EuH_2.js";import{_ as f,W as v,a as y,b as g}from"./wallets-Dpi4wZtH.js";import{t as b,F as N,u as w,v as k,b as x,s as C,w as A,x as _,U as S,T as P,y as T,z as $,D as F,E,N as I,r as M,G as L,H as W}from"./wharfkit-CpEkzKdn.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var R,O,B,j,D,U,X={exports:{}},z={},H=(O||(O=1,X.exports=function(){if(R)return z;R=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(t,a,n){var i=null;if(void 0!==n&&(i=""+n),void 0!==a.key&&(i=""+a.key),"key"in a)for(var r in n={},a)"key"!==r&&(n[r]=a[r]);else n=a;return a=n.ref,{$$typeof:e,type:t,key:i,ref:void 0!==a?a:null,props:n}}return z.Fragment=t,z.jsx=a,z.jsxs=a,z}()),X.exports),J={exports:{}},q={},V={exports:{}},G={};var Y=(U||(U=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){}}(),J.exports=function(){if(D)return q;D=1;var e=(j||(j=1,V.exports=(B||(B=1,function(e){function t(e,t){var a=e.length;e.push(t);e:for(;0<a;){var n=a-1>>>1,r=e[n];if(!(0<i(r,t)))break e;e[n]=t,e[a]=r,a=n}}function a(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var n=0,r=e.length,s=r>>>1;n<s;){var l=2*(n+1)-1,c=e[l],o=l+1,d=e[o];if(0>i(c,a))o<r&&0>i(d,c)?(e[n]=d,e[o]=a,n=o):(e[n]=c,e[l]=a,n=l);else{if(!(o<r&&0>i(d,a)))break e;e[n]=d,e[o]=a,n=o}}}return t}function i(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var r=performance;e.unstable_now=function(){return r.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],o=[],d=1,h=null,u=3,m=!1,p=!1,f=!1,v=!1,y="function"==typeof setTimeout?setTimeout:null,g="function"==typeof clearTimeout?clearTimeout:null,b="undefined"!=typeof setImmediate?setImmediate:null;function N(e){for(var i=a(o);null!==i;){if(null===i.callback)n(o);else{if(!(i.startTime<=e))break;n(o),i.sortIndex=i.expirationTime,t(c,i)}i=a(o)}}function w(e){if(f=!1,N(e),!p)if(null!==a(c))p=!0,x||(x=!0,k());else{var t=a(o);null!==t&&F(w,t.startTime-e)}}var k,x=!1,C=-1,A=5,_=-1;function S(){return!(!v&&e.unstable_now()-_<A)}function P(){if(v=!1,x){var t=e.unstable_now();_=t;var i=!0;try{e:{p=!1,f&&(f=!1,g(C),C=-1),m=!0;var r=u;try{t:{for(N(t),h=a(c);null!==h&&!(h.expirationTime>t&&S());){var s=h.callback;if("function"==typeof s){h.callback=null,u=h.priorityLevel;var l=s(h.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof l){h.callback=l,N(t),i=!0;break t}h===a(c)&&n(c),N(t)}else n(c);h=a(c)}if(null!==h)i=!0;else{var d=a(o);null!==d&&F(w,d.startTime-t),i=!1}}break e}finally{h=null,u=r,m=!1}i=void 0}}finally{i?k():x=!1}}}if("function"==typeof b)k=function(){b(P)};else if("undefined"!=typeof MessageChannel){var T=new MessageChannel,$=T.port2;T.port1.onmessage=P,k=function(){$.postMessage(null)}}else k=function(){y(P,0)};function F(t,a){C=y(function(){t(e.unstable_now())},a)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e||(A=0<e?Math.floor(1e3/e):5)},e.unstable_getCurrentPriorityLevel=function(){return u},e.unstable_next=function(e){switch(u){case 1:case 2:case 3:var t=3;break;default:t=u}var a=u;u=t;try{return e()}finally{u=a}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=u;u=e;try{return t()}finally{u=a}},e.unstable_scheduleCallback=function(n,i,r){var s=e.unstable_now();switch(r="object"==typeof r&&null!==r&&"number"==typeof(r=r.delay)&&0<r?s+r:s,n){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return n={id:d++,callback:i,priorityLevel:n,startTime:r,expirationTime:l=r+l,sortIndex:-1},r>s?(n.sortIndex=r,t(o,n),null===a(c)&&n===a(o)&&(f?(g(C),C=-1):f=!0,F(w,r-s))):(n.sortIndex=l,t(c,n),p||m||(p=!0,x||(x=!0,k()))),n},e.unstable_shouldYield=S,e.unstable_wrapCallback=function(e){var t=u;return function(){var a=u;u=t;try{return e.apply(this,arguments)}finally{u=a}}}}(G)),G)),V.exports),t=a(),i=n();function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&null!==(e=e.alternate)&&(t=e.memoizedState),null!==t)return t.dehydrated}return null}function o(e){if(l(e)!==e)throw Error(r(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var h=Object.assign,u=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),N=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),S=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function T(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=P&&e[P]||e["@@iterator"])?e:null}var $=Symbol.for("react.client.reference");function F(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===$?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case f:return"Fragment";case y:return"Profiler";case v:return"StrictMode";case k:return"Suspense";case x:return"SuspenseList";case _:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case p:return"Portal";case N:return(e.displayName||"Context")+".Provider";case b:return(e.t.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:F(e.type)||"Memo";case A:t=e.i,e=e.l;try{return F(e(t))}catch(a){}}return null}var E=Array.isArray,I=t.o,M=i.h,L={pending:!1,data:null,method:null,action:null},W=[],R=-1;function O(e){return{current:e}}function U(e){0>R||(e.current=W[R],W[R]=null,R--)}function X(e,t){R++,W[R]=e.current,e.current=t}var z=O(null),H=O(null),J=O(null),Y=O(null);function K(e,t){switch(X(J,t),X(H,e),X(z,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?oh(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=dh(t=oh(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(z),X(z,e)}function Q(){U(z),U(H),U(J)}function Z(e){null!==e.memoizedState&&X(Y,e);var t=z.current,a=dh(t,e.type);t!==a&&(X(H,e),X(z,a))}function ee(e){H.current===e&&(U(z),U(H)),Y.current===e&&(U(Y),Zh.u=L)}var te={}.hasOwnProperty,ae=e.unstable_scheduleCallback,ne=e.unstable_cancelCallback,ie=e.unstable_shouldYield,re=e.unstable_requestPaint,se=e.unstable_now,le=e.unstable_getCurrentPriorityLevel,ce=e.unstable_ImmediatePriority,oe=e.unstable_UserBlockingPriority,de=e.unstable_NormalPriority,he=e.unstable_LowPriority,ue=e.unstable_IdlePriority,me=e.log,pe=e.unstable_setDisableYieldValue,fe=null,ve=null;function ye(e){if("function"==typeof me&&pe(e),ve&&"function"==typeof ve.setStrictMode)try{ve.setStrictMode(fe,e)}catch(t){}}var ge=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(be(e)/Ne|0)|0},be=Math.log,Ne=Math.LN2,we=256,ke=4194304;function xe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ce(e,t,a){var n=e.pendingLanes;if(0===n)return 0;var i=0,r=e.suspendedLanes,s=e.pingedLanes;e=e.warmLanes;var l=134217727&n;return 0!==l?0!==(n=l&~r)?i=xe(n):0!==(s&=l)?i=xe(s):a||0!==(a=l&~e)&&(i=xe(a)):0!==(l=n&~r)?i=xe(l):0!==s?i=xe(s):a||0!==(a=n&~e)&&(i=xe(a)),0===i?0:0!==t&&t!==i&&0===(t&r)&&((r=i&-i)>=(a=t&-t)||32===r&&4194048&a)?t:i}function Ae(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function _e(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function Se(){var e=we;return!(4194048&(we<<=1))&&(we=256),e}function Pe(){var e=ke;return!(62914560&(ke<<=1))&&(ke=4194304),e}function Te(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function $e(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Fe(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var n=31-ge(t);e.entangledLanes|=t,e.entanglements[n]=1073741824|e.entanglements[n]|4194090&a}function Ee(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var n=31-ge(a),i=1<<n;i&t|e[n]&t&&(e[n]|=t),a&=~i}}function Ie(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Me(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Le(){var e=M.p;return 0!==e?e:void 0===(e=window.event)?32:pu(e.type)}var We=Math.random().toString(36).slice(2),Re="__reactFiber$"+We,Oe="__reactProps$"+We,Be="__reactContainer$"+We,je="__reactEvents$"+We,De="__reactListeners$"+We,Ue="__reactHandles$"+We,Xe="__reactResources$"+We,ze="__reactMarker$"+We;function He(e){delete e[Re],delete e[Oe],delete e[je],delete e[De],delete e[Ue]}function Je(e){var t=e[Re];if(t)return t;for(var a=e.parentNode;a;){if(t=a[Be]||a[Re]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=Ch(e);null!==e;){if(a=e[Re])return a;e=Ch(e)}return t}a=(e=a).parentNode}return null}function qe(e){if(e=e[Re]||e[Be]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function Ve(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(r(33))}function Ge(e){var t=e[Xe];return t||(t=e[Xe]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Ye(e){e[ze]=!0}var Ke=new Set,Qe={};function Ze(e,t){et(e,t),et(e+"Capture",t)}function et(e,t){for(Qe[e]=t,e=0;e<t.length;e++)Ke.add(t[e])}var tt,at,nt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),it={},rt={};function st(e,t,a){if(i=t,te.call(rt,i)||!te.call(it,i)&&(nt.test(i)?rt[i]=!0:(it[i]=!0,0)))if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var n=t.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void e.removeAttribute(t)}e.setAttribute(t,""+a)}var i}function lt(e,t,a){if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+a)}}function ct(e,t,a,n){if(null===n)e.removeAttribute(a);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(a)}e.setAttributeNS(t,a,""+n)}}function ot(e){if(void 0===tt)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);tt=t&&t[1]||"",at=-1<a.stack.indexOf("\n    at")?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+tt+e+at}var dt=!1;function ht(e,t){if(!e||dt)return"";dt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(t){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(i){var n=i}Reflect.construct(e,[],a)}else{try{a.call()}catch(r){n=r}e.call(a.prototype)}}else{try{throw Error()}catch(s){n=s}(a=e())&&"function"==typeof a.catch&&a.catch(function(){})}}catch(l){if(l&&n&&"string"==typeof l.stack)return[l.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var i=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");i&&i.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var r=n.DetermineComponentFrameRoot(),s=r[0],l=r[1];if(s&&l){var c=s.split("\n"),o=l.split("\n");for(i=n=0;n<c.length&&!c[n].includes("DetermineComponentFrameRoot");)n++;for(;i<o.length&&!o[i].includes("DetermineComponentFrameRoot");)i++;if(n===c.length||i===o.length)for(n=c.length-1,i=o.length-1;1<=n&&0<=i&&c[n]!==o[i];)i--;for(;1<=n&&0<=i;n--,i--)if(c[n]!==o[i]){if(1!==n||1!==i)do{if(n--,0>--i||c[n]!==o[i]){var d="\n"+c[n].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=n&&0<=i);break}}}finally{dt=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?ot(a):""}function ut(e){switch(e.tag){case 26:case 27:case 5:return ot(e.type);case 16:return ot("Lazy");case 13:return ot("Suspense");case 19:return ot("SuspenseList");case 0:case 15:return ht(e.type,!1);case 11:return ht(e.type.render,!1);case 1:return ht(e.type,!0);case 31:return ot("Activity");default:return""}}function mt(e){try{var t="";do{t+=ut(e),e=e.return}while(e);return t}catch(a){return"\nError generating stack: "+a.message+"\n"+a.stack}}function pt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ft(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function vt(e){e.v||(e.v=function(e){var t=ft(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==a&&"function"==typeof a.get&&"function"==typeof a.set){var i=a.get,r=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e.v=null,delete e[t]}}}}(e))}function yt(e){if(!e)return!1;var t=e.v;if(!t)return!0;var a=t.getValue(),n="";return e&&(n=ft(e)?e.checked?"true":"false":e.value),(e=n)!==a&&(t.setValue(e),!0)}function gt(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var bt=/[\n"\\]/g;function Nt(e){return e.replace(bt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function wt(e,t,a,n,i,r,s,l){e.name="",null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s?e.type=s:e.removeAttribute("type"),null!=t?"number"===s?(0===t&&""===e.value||e.value!=t)&&(e.value=""+pt(t)):e.value!==""+pt(t)&&(e.value=""+pt(t)):"submit"!==s&&"reset"!==s||e.removeAttribute("value"),null!=t?xt(e,s,pt(t)):null!=a?xt(e,s,pt(a)):null!=n&&e.removeAttribute("value"),null==i&&null!=r&&(e.defaultChecked=!!r),null!=i&&(e.checked=i&&"function"!=typeof i&&"symbol"!=typeof i),null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l?e.name=""+pt(l):e.removeAttribute("name")}function kt(e,t,a,n,i,r,s,l){if(null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r&&(e.type=r),null!=t||null!=a){if(("submit"===r||"reset"===r)&&null==t)return;a=null!=a?""+pt(a):"",t=null!=t?""+pt(t):a,l||t===e.value||(e.value=t),e.defaultValue=t}n="function"!=typeof(n=null!=n?n:i)&&"symbol"!=typeof n&&!!n,e.checked=l?e.checked:!!n,e.defaultChecked=!!n,null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&"boolean"!=typeof s&&(e.name=s)}function xt(e,t,a){"number"===t&&gt(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function Ct(e,t,a,n){if(e=e.options,t){t={};for(var i=0;i<a.length;i++)t["$"+a[i]]=!0;for(a=0;a<e.length;a++)i=t.hasOwnProperty("$"+e[a].value),e[a].selected!==i&&(e[a].selected=i),i&&n&&(e[a].defaultSelected=!0)}else{for(a=""+pt(a),t=null,i=0;i<e.length;i++){if(e[i].value===a)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function At(e,t,a){null==t||((t=""+pt(t))!==e.value&&(e.value=t),null!=a)?e.defaultValue=null!=a?""+pt(a):"":e.defaultValue!==t&&(e.defaultValue=t)}function _t(e,t,a,n){if(null==t){if(null!=n){if(null!=a)throw Error(r(92));if(E(n)){if(1<n.length)throw Error(r(93));n=n[0]}a=n}null==a&&(a=""),t=a}a=pt(t),e.defaultValue=a,(n=e.textContent)===a&&""!==n&&null!==n&&(e.value=n)}function St(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var Pt=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Tt(e,t,a){var n=0===t.indexOf("--");null==a||"boolean"==typeof a||""===a?n?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":n?e.setProperty(t,a):"number"!=typeof a||0===a||Pt.has(t)?"float"===t?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function $t(e,t,a){if(null!=t&&"object"!=typeof t)throw Error(r(62));if(e=e.style,null!=a){for(var n in a)!a.hasOwnProperty(n)||null!=t&&t.hasOwnProperty(n)||(0===n.indexOf("--")?e.setProperty(n,""):"float"===n?e.cssFloat="":e[n]="");for(var i in t)n=t[i],t.hasOwnProperty(i)&&a[i]!==n&&Tt(e,i,n)}else for(var s in t)t.hasOwnProperty(s)&&Tt(e,s,t[s])}function Ft(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Et=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),It=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mt(e){return It.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Lt=null;function Wt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Rt=null,Ot=null;function Bt(e){var t=qe(e);if(t&&(e=t.stateNode)){var a=e[Oe]||null;e:switch(e=t.stateNode,t.type){case"input":if(wt(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+Nt(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var n=a[t];if(n!==e&&n.form===e.form){var i=n[Oe]||null;if(!i)throw Error(r(90));wt(n,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name)}}for(t=0;t<a.length;t++)(n=a[t]).form===e.form&&yt(n)}break e;case"textarea":At(e,a.value,a.defaultValue);break e;case"select":null!=(t=a.value)&&Ct(e,!!a.multiple,t,!1)}}}var jt=!1;function Dt(e,t,a){if(jt)return e(t,a);jt=!0;try{return e(t)}finally{if(jt=!1,(null!==Rt||null!==Ot)&&(Jo(),Rt&&(t=Rt,e=Ot,Ot=Rt=null,Bt(t),e)))for(t=0;t<e.length;t++)Bt(e[t])}}function Ut(e,t){var a=e.stateNode;if(null===a)return null;var n=a[Oe]||null;if(null===n)return null;a=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(a&&"function"!=typeof a)throw Error(r(231,t,typeof a));return a}var Xt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),zt=!1;if(Xt)try{var Ht={};Object.defineProperty(Ht,"passive",{get:function(){zt=!0}}),window.addEventListener("test",Ht,Ht),window.removeEventListener("test",Ht,Ht)}catch(Ou){zt=!1}var Jt=null,qt=null,Vt=null;function Gt(){if(Vt)return Vt;var e,t,a=qt,n=a.length,i="value"in Jt?Jt.value:Jt.textContent,r=i.length;for(e=0;e<n&&a[e]===i[e];e++);var s=n-e;for(t=1;t<=s&&a[n-t]===i[r-t];t++);return Vt=i.slice(e,1<t?1-t:void 0)}function Yt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Kt(){return!0}function Qt(){return!1}function Zt(e){function t(t,a,n,i,r){for(var s in this.N=t,this.k=n,this.type=a,this.nativeEvent=i,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(s)&&(t=e[s],this[s]=t?t(i):i[s]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?Kt:Qt,this.isPropagationStopped=Qt,this}return h(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Kt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Kt)},persist:function(){},isPersistent:Kt}),t}var ea,ta,aa,na={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ia=Zt(na),ra=h({},na,{view:0,detail:0}),sa=Zt(ra),la=h({},ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ga,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==aa&&(aa&&"mousemove"===e.type?(ea=e.screenX-aa.screenX,ta=e.screenY-aa.screenY):ta=ea=0,aa=e),ea)},movementY:function(e){return"movementY"in e?e.movementY:ta}}),ca=Zt(la),oa=Zt(h({},la,{dataTransfer:0})),da=Zt(h({},ra,{relatedTarget:0})),ha=Zt(h({},na,{animationName:0,elapsedTime:0,pseudoElement:0})),ua=Zt(h({},na,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),ma=Zt(h({},na,{data:0})),pa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},va={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ya(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=va[e])&&!!t[e]}function ga(){return ya}var ba=Zt(h({},ra,{key:function(e){if(e.key){var t=pa[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Yt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fa[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ga,charCode:function(e){return"keypress"===e.type?Yt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Yt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Na=Zt(h({},la,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),wa=Zt(h({},ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ga})),ka=Zt(h({},na,{propertyName:0,elapsedTime:0,pseudoElement:0})),xa=Zt(h({},la,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Ca=Zt(h({},na,{newState:0,oldState:0})),Aa=[9,13,27,32],_a=Xt&&"CompositionEvent"in window,Sa=null;Xt&&"documentMode"in document&&(Sa=document.documentMode);var Pa=Xt&&"TextEvent"in window&&!Sa,Ta=Xt&&(!_a||Sa&&8<Sa&&11>=Sa),$a=String.fromCharCode(32),Fa=!1;function Ea(e,t){switch(e){case"keyup":return-1!==Aa.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ia(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Ma=!1,La={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Wa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!La[e.type]:"textarea"===t}function Ra(e,t,a,n){Rt?Ot?Ot.push(n):Ot=[n]:Rt=n,0<(t=Gd(t,"onChange")).length&&(a=new ia("onChange","change",null,a,n),e.push({event:a,listeners:t}))}var Oa=null,Ba=null;function ja(e){Dd(e,0)}function Da(e){if(yt(Ve(e)))return e}function Ua(e,t){if("change"===e)return t}var Xa=!1;if(Xt){var za;if(Xt){var Ha="oninput"in document;if(!Ha){var Ja=document.createElement("div");Ja.setAttribute("oninput","return;"),Ha="function"==typeof Ja.oninput}za=Ha}else za=!1;Xa=za&&(!document.documentMode||9<document.documentMode)}function qa(){Oa&&(Oa.detachEvent("onpropertychange",Va),Ba=Oa=null)}function Va(e){if("value"===e.propertyName&&Da(Ba)){var t=[];Ra(t,Ba,e,Wt(e)),Dt(ja,t)}}function Ga(e,t,a){"focusin"===e?(qa(),Ba=a,(Oa=t).attachEvent("onpropertychange",Va)):"focusout"===e&&qa()}function Ya(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Da(Ba)}function Ka(e,t){if("click"===e)return Da(t)}function Qa(e,t){if("input"===e||"change"===e)return Da(t)}var Za="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function en(e,t){if(Za(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++){var i=a[n];if(!te.call(t,i)||!Za(e[i],t[i]))return!1}return!0}function tn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function an(e,t){var a,n=tn(e);for(e=0;n;){if(3===n.nodeType){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=tn(n)}}function nn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?nn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function rn(e){for(var t=gt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var a="string"==typeof t.contentWindow.location.href}catch(n){a=!1}if(!a)break;t=gt((e=t.contentWindow).document)}return t}function sn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ln=Xt&&"documentMode"in document&&11>=document.documentMode,cn=null,on=null,dn=null,hn=!1;function un(e,t,a){var n=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;hn||null==cn||cn!==gt(n)||(n="selectionStart"in(n=cn)&&sn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},dn&&en(dn,n)||(dn=n,0<(n=Gd(on,"onSelect")).length&&(t=new ia("onSelect","select",null,t,a),e.push({event:t,listeners:n}),t.target=cn)))}function mn(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var pn={animationend:mn("Animation","AnimationEnd"),animationiteration:mn("Animation","AnimationIteration"),animationstart:mn("Animation","AnimationStart"),transitionrun:mn("Transition","TransitionRun"),transitionstart:mn("Transition","TransitionStart"),transitioncancel:mn("Transition","TransitionCancel"),transitionend:mn("Transition","TransitionEnd")},fn={},vn={};function yn(e){if(fn[e])return fn[e];if(!pn[e])return e;var t,a=pn[e];for(t in a)if(a.hasOwnProperty(t)&&t in vn)return fn[e]=a[t];return e}Xt&&(vn=document.createElement("div").style,"AnimationEvent"in window||(delete pn.animationend.animation,delete pn.animationiteration.animation,delete pn.animationstart.animation),"TransitionEvent"in window||delete pn.transitionend.transition);var gn=yn("animationend"),bn=yn("animationiteration"),Nn=yn("animationstart"),wn=yn("transitionrun"),kn=yn("transitionstart"),xn=yn("transitioncancel"),Cn=yn("transitionend"),An=new Map,_n="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Sn(e,t){An.set(e,t),Ze(t,[e])}_n.push("scrollEnd");var Pn=new WeakMap;function Tn(e,t){if("object"==typeof e&&null!==e){var a=Pn.get(e);return void 0!==a?a:(t={value:e,source:t,stack:mt(t)},Pn.set(e,t),t)}return{value:e,source:t,stack:mt(t)}}var $n=[],Fn=0,En=0;function In(){for(var e=Fn,t=En=Fn=0;t<e;){var a=$n[t];$n[t++]=null;var n=$n[t];$n[t++]=null;var i=$n[t];$n[t++]=null;var r=$n[t];if($n[t++]=null,null!==n&&null!==i){var s=n.pending;null===s?i.next=i:(i.next=s.next,s.next=i),n.pending=i}0!==r&&Rn(a,i,r)}}function Mn(e,t,a,n){$n[Fn++]=e,$n[Fn++]=t,$n[Fn++]=a,$n[Fn++]=n,En|=n,e.lanes|=n,null!==(e=e.alternate)&&(e.lanes|=n)}function Ln(e,t,a,n){return Mn(e,t,a,n),On(e)}function Wn(e,t){return Mn(e,null,null,t),On(e)}function Rn(e,t,a){e.lanes|=a;var n=e.alternate;null!==n&&(n.lanes|=a);for(var i=!1,r=e.return;null!==r;)r.childLanes|=a,null!==(n=r.alternate)&&(n.childLanes|=a),22===r.tag&&(null===(e=r.stateNode)||1&e._||(i=!0)),e=r,r=r.return;return 3===e.tag?(r=e.stateNode,i&&null!==t&&(i=31-ge(a),null===(n=(e=r.hiddenUpdates)[i])?e[i]=[t]:n.push(t),t.lane=536870912|a),r):null}function On(e){if(50<Ro)throw Ro=0,Oo=null,Error(r(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Bn={};function jn(e,t,a,n){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dn(e,t,a,n){return new jn(e,t,a,n)}function Un(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Xn(e,t){var a=e.alternate;return null===a?((a=Dn(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=65011712&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function zn(e,t){e.flags&=65011714;var a=e.alternate;return null===a?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Hn(e,t,a,n,i,s){var l=0;if(n=e,"function"==typeof e)Un(e)&&(l=1);else if("string"==typeof e)l=function(e,t,a){if(1===a||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,a,z.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case _:return(e=Dn(31,a,t,i)).elementType=_,e.lanes=s,e;case f:return Jn(a.children,i,s,t);case v:l=8,i|=24;break;case y:return(e=Dn(12,a,t,2|i)).elementType=y,e.lanes=s,e;case k:return(e=Dn(13,a,t,i)).elementType=k,e.lanes=s,e;case x:return(e=Dn(19,a,t,i)).elementType=x,e.lanes=s,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case g:case N:l=10;break e;case b:l=9;break e;case w:l=11;break e;case C:l=14;break e;case A:l=16,n=null;break e}l=29,a=Error(r(130,null===e?"null":typeof e,"")),n=null}return(t=Dn(l,a,t,i)).elementType=e,t.type=n,t.lanes=s,t}function Jn(e,t,a,n){return(e=Dn(7,e,n,t)).lanes=a,e}function qn(e,t,a){return(e=Dn(6,e,null,t)).lanes=a,e}function Vn(e,t,a){return(t=Dn(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gn=[],Yn=0,Kn=null,Qn=0,Zn=[],ei=0,ti=null,ai=1,ni="";function ii(e,t){Gn[Yn++]=Qn,Gn[Yn++]=Kn,Kn=e,Qn=t}function ri(e,t,a){Zn[ei++]=ai,Zn[ei++]=ni,Zn[ei++]=ti,ti=e;var n=ai;e=ni;var i=32-ge(n)-1;n&=~(1<<i),a+=1;var r=32-ge(t)+i;if(30<r){var s=i-i%5;r=(n&(1<<s)-1).toString(32),n>>=s,i-=s,ai=1<<32-ge(t)+i|a<<i|n,ni=r+e}else ai=1<<r|a<<i|n,ni=e}function si(e){null!==e.return&&(ii(e,1),ri(e,1,0))}function li(e){for(;e===Kn;)Kn=Gn[--Yn],Gn[Yn]=null,Qn=Gn[--Yn],Gn[Yn]=null;for(;e===ti;)ti=Zn[--ei],Zn[ei]=null,ni=Zn[--ei],Zn[ei]=null,ai=Zn[--ei],Zn[ei]=null}var ci=null,oi=null,di=!1,hi=null,ui=!1,mi=Error(r(519));function pi(e){throw Ni(Tn(Error(r(418,"")),e)),mi}function fi(e){var t=e.stateNode,a=e.type,n=e.memoizedProps;switch(t[Re]=e,t[Oe]=n,a){case"dialog":Ud("cancel",t),Ud("close",t);break;case"iframe":case"object":case"embed":Ud("load",t);break;case"video":case"audio":for(a=0;a<Bd.length;a++)Ud(Bd[a],t);break;case"source":Ud("error",t);break;case"img":case"image":case"link":Ud("error",t),Ud("load",t);break;case"details":Ud("toggle",t);break;case"input":Ud("invalid",t),kt(t,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),vt(t);break;case"select":Ud("invalid",t);break;case"textarea":Ud("invalid",t),_t(t,n.value,n.defaultValue,n.children),vt(t)}"string"!=typeof(a=n.children)&&"number"!=typeof a&&"bigint"!=typeof a||t.textContent===""+a||!0===n.suppressHydrationWarning||th(t.textContent,a)?(null!=n.popover&&(Ud("beforetoggle",t),Ud("toggle",t)),null!=n.onScroll&&Ud("scroll",t),null!=n.onScrollEnd&&Ud("scrollend",t),null!=n.onClick&&(t.onclick=ah),t=!0):t=!1,t||pi(e)}function vi(e){for(ci=e.return;ci;)switch(ci.tag){case 5:case 13:return void(ui=!1);case 27:case 3:return void(ui=!0);default:ci=ci.return}}function yi(e){if(e!==ci)return!1;if(!di)return vi(e),di=!0,!1;var t,a=e.tag;if((t=3!==a&&27!==a)&&((t=5===a)&&(t=!("form"!==(t=e.type)&&"button"!==t)||hh(e.type,e.memoizedProps)),t=!t),t&&oi&&pi(e),vi(e),13===a){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,a=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===a){oi=kh(e.nextSibling);break e}a--}else"$"!==t&&"$!"!==t&&"$?"!==t||a++;e=e.nextSibling}oi=null}}else 27===a?(a=oi,gh(e.type)?(e=xh,xh=null,oi=e):oi=a):oi=ci?kh(e.stateNode.nextSibling):null;return!0}function gi(){oi=ci=null,di=!1}function bi(){var e=hi;return null!==e&&(null===Co?Co=e:Co.push.apply(Co,e),hi=null),e}function Ni(e){null===hi?hi=[e]:hi.push(e)}var wi=O(null),ki=null,xi=null;function Ci(e,t,a){X(wi,t.u),t.u=a}function Ai(e){e.u=wi.current,U(wi)}function _i(e,t,a){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===a)break;e=e.return}}function Si(e,t,a,n){var i=e.child;for(null!==i&&(i.return=e);null!==i;){var s=i.dependencies;if(null!==s){var l=i.child;s=s.firstContext;e:for(;null!==s;){var c=s;s=i;for(var o=0;o<t.length;o++)if(c.context===t[o]){s.lanes|=a,null!==(c=s.alternate)&&(c.lanes|=a),_i(s.return,a,e),n||(l=null);break e}s=c.next}}else if(18===i.tag){if(null===(l=i.return))throw Error(r(341));l.lanes|=a,null!==(s=l.alternate)&&(s.lanes|=a),_i(l,a,e),l=null}else l=i.child;if(null!==l)l.return=i;else for(l=i;null!==l;){if(l===e){l=null;break}if(null!==(i=l.sibling)){i.return=l.return,l=i;break}l=l.return}i=l}}function Pi(e,t,a,n){e=null;for(var i=t,s=!1;null!==i;){if(!s)if(524288&i.flags)s=!0;else if(262144&i.flags)break;if(10===i.tag){var l=i.alternate;if(null===l)throw Error(r(387));if(null!==(l=l.memoizedProps)){var c=i.type;Za(i.pendingProps.value,l.value)||(null!==e?e.push(c):e=[c])}}else if(i===Y.current){if(null===(l=i.alternate))throw Error(r(387));l.memoizedState.memoizedState!==i.memoizedState.memoizedState&&(null!==e?e.push(Zh):e=[Zh])}i=i.return}null!==e&&Si(t,e,a,n),t.flags|=262144}function Ti(e){for(e=e.firstContext;null!==e;){if(!Za(e.context.u,e.memoizedValue))return!0;e=e.next}return!1}function $i(e){ki=e,xi=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Fi(e){return Ii(ki,e)}function Ei(e,t){return null===ki&&$i(e),Ii(e,t)}function Ii(e,t){var a=t.u;if(t={context:t,memoizedValue:a,next:null},null===xi){if(null===e)throw Error(r(308));xi=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else xi=xi.next=t;return a}var Mi="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Li=e.unstable_scheduleCallback,Wi=e.unstable_NormalPriority,Ri={$$typeof:N,Consumer:null,Provider:null,u:null,P:null,$:0};function Oi(){return{controller:new Mi,data:new Map,refCount:0}}function Bi(e){e.refCount--,0===e.refCount&&Li(Wi,function(){e.controller.abort()})}var ji=null,Di=0,Ui=0,Xi=null;function zi(){if(0===--Di&&null!==ji){null!==Xi&&(Xi.status="fulfilled");var e=ji;ji=null,Ui=0,Xi=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Hi=I.S;I.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===ji){var a=ji=[];Di=0,Ui=Md(),Xi={status:"pending",value:void 0,then:function(e){a.push(e)}}}Di++,t.then(zi,zi)}(0,t),null!==Hi&&Hi(e,t)};var Ji=O(null);function qi(){var e=Ji.current;return null!==e?e:lo.pooledCache}function Vi(e,t){X(Ji,null===t?Ji.current:t.pool)}function Gi(){var e=qi();return null===e?null:{parent:Ri.u,pool:e}}var Yi=Error(r(460)),Ki=Error(r(474)),Qi=Error(r(542)),Zi={then:function(){}};function er(e){return"fulfilled"===(e=e.status)||"rejected"===e}function tr(){}function ar(e,t,a){switch(void 0===(a=e[a])?e.push(t):a!==t&&(t.then(tr,tr),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw rr(e=t.reason),e;default:if("string"==typeof t.status)t.then(tr,tr);else{if(null!==(e=lo)&&100<e.shellSuspendCounter)throw Error(r(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var a=t;a.status="fulfilled",a.value=e}},function(e){if("pending"===t.status){var a=t;a.status="rejected",a.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw rr(e=t.reason),e}throw nr=t,Yi}}var nr=null;function ir(){if(null===nr)throw Error(r(459));var e=nr;return nr=null,e}function rr(e){if(e===Yi||e===Qi)throw Error(r(483))}var sr=!1;function lr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function or(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function dr(e,t,a){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&so){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,t=On(e),Rn(e,null,a),t}return Mn(e,n,t,a),On(e)}function hr(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&a)){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,Ee(e,a)}}function ur(e,t){var a=e.updateQueue,n=e.alternate;if(null!==n&&a===(n=n.updateQueue)){var i=null,r=null;if(null!==(a=a.firstBaseUpdate)){do{var s={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};null===r?i=r=s:r=r.next=s,a=a.next}while(null!==a);null===r?i=r=t:r=r.next=t}else i=r=t;return a={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:r,shared:n.shared,callbacks:n.callbacks},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var mr=!1;function pr(){if(mr&&null!==Xi)throw Xi}function fr(e,t,a,n){mr=!1;var i=e.updateQueue;sr=!1;var r=i.firstBaseUpdate,s=i.lastBaseUpdate,l=i.shared.pending;if(null!==l){i.shared.pending=null;var c=l,o=c.next;c.next=null,null===s?r=o:s.next=o,s=c;var d=e.alternate;null!==d&&(l=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===l?d.firstBaseUpdate=o:l.next=o,d.lastBaseUpdate=c)}if(null!==r){var u=i.baseState;for(s=0,d=o=c=null,l=r;;){var m=-536870913&l.lane,p=m!==l.lane;if(p?(oo&m)===m:(n&m)===m){0!==m&&m===Ui&&(mr=!0),null!==d&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var f=e,v=l;m=t;var y=a;switch(v.tag){case 1:if("function"==typeof(f=v.payload)){u=f.call(y,u,m);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(m="function"==typeof(f=v.payload)?f.call(y,u,m):f))break e;u=h({},u,m);break e;case 2:sr=!0}}null!==(m=l.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=i.callbacks)?i.callbacks=[m]:p.push(m))}else p={lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(o=d=p,c=u):d=d.next=p,s|=m;if(null===(l=l.next)){if(null===(l=i.shared.pending))break;l=(p=l).next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}null===d&&(c=u),i.baseState=c,i.firstBaseUpdate=o,i.lastBaseUpdate=d,null===r&&(i.shared.lanes=0),go|=s,e.lanes=s,e.memoizedState=u}}function vr(e,t){if("function"!=typeof e)throw Error(r(191,e));e.call(t)}function yr(e,t){var a=e.callbacks;if(null!==a)for(e.callbacks=null,e=0;e<a.length;e++)vr(a[e],t)}var gr=O(null),br=O(0);function Nr(e,t){X(br,e=vo),X(gr,t),vo=e|t.baseLanes}function wr(){X(br,vo),X(gr,gr.current)}function kr(){vo=br.current,U(gr),U(br)}var xr=0,Cr=null,Ar=null,_r=null,Sr=!1,Pr=!1,Tr=!1,$r=0,Fr=0,Er=null,Ir=0;function Mr(){throw Error(r(321))}function Lr(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Za(e[a],t[a]))return!1;return!0}function Wr(e,t,a,n,i,r){return xr=r,Cr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=null===e||null===e.memoizedState?Ys:Ks,Tr=!1,r=a(n,i),Tr=!1,Pr&&(r=Or(t,a,n,i)),Rr(e),r}function Rr(e){I.H=Gs;var t=null!==Ar&&null!==Ar.next;if(xr=0,_r=Ar=Cr=null,Sr=!1,Fr=0,Er=null,t)throw Error(r(300));null===e||Fl||null!==(e=e.dependencies)&&Ti(e)&&(Fl=!0)}function Or(e,t,a,n){Cr=e;var i=0;do{if(Pr&&(Er=null),Fr=0,Pr=!1,25<=i)throw Error(r(301));if(i+=1,_r=Ar=null,null!=e.updateQueue){var s=e.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,null!=s.memoCache&&(s.memoCache.index=0)}I.H=Qs,s=t(a,n)}while(Pr);return s}function Br(){var e=I.H,t=e.useState()[0];return t="function"==typeof t.then?Hr(t):t,e=e.useState()[0],(null!==Ar?Ar.memoizedState:null)!==e&&(Cr.flags|=1024),t}function jr(){var e=0!==$r;return $r=0,e}function Dr(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function Ur(e){if(Sr){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Sr=!1}xr=0,_r=Ar=Cr=null,Pr=!1,Fr=$r=0,Er=null}function Xr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===_r?Cr.memoizedState=_r=e:_r=_r.next=e,_r}function zr(){if(null===Ar){var e=Cr.alternate;e=null!==e?e.memoizedState:null}else e=Ar.next;var t=null===_r?Cr.memoizedState:_r.next;if(null!==t)_r=t,Ar=e;else{if(null===e){if(null===Cr.alternate)throw Error(r(467));throw Error(r(310))}e={memoizedState:(Ar=e).memoizedState,baseState:Ar.baseState,baseQueue:Ar.baseQueue,queue:Ar.queue,next:null},null===_r?Cr.memoizedState=_r=e:_r=_r.next=e}return _r}function Hr(e){var t=Fr;return Fr+=1,null===Er&&(Er=[]),e=ar(Er,e,t),t=Cr,null===(null===_r?t.memoizedState:_r.next)&&(t=t.alternate,I.H=null===t||null===t.memoizedState?Ys:Ks),e}function Jr(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return Hr(e);if(e.$$typeof===N)return Fi(e)}throw Error(r(438,String(e)))}function qr(e){var t=null,a=Cr.updateQueue;if(null!==a&&(t=a.memoCache),null==t){var n=Cr.alternate;null!==n&&null!==(n=n.updateQueue)&&null!=(n=n.memoCache)&&(t={data:n.data.map(function(e){return e.slice()}),index:0})}if(null==t&&(t={data:[],index:0}),null===a&&(a={lastEffect:null,events:null,stores:null,memoCache:null},Cr.updateQueue=a),a.memoCache=t,void 0===(a=t.data[t.index]))for(a=t.data[t.index]=Array(e),n=0;n<e;n++)a[n]=S;return t.index++,a}function Vr(e,t){return"function"==typeof t?t(e):t}function Gr(e){return Yr(zr(),Ar,e)}function Yr(e,t,a){var n=e.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=a;var i=e.baseQueue,s=n.pending;if(null!==s){if(null!==i){var l=i.next;i.next=s.next,s.next=l}t.baseQueue=i=s,n.pending=null}if(s=e.baseState,null===i)e.memoizedState=s;else{var c=l=null,o=null,d=t=i.next,h=!1;do{var u=-536870913&d.lane;if(u!==d.lane?(oo&u)===u:(xr&u)===u){var m=d.revertLane;if(0===m)null!==o&&(o=o.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),u===Ui&&(h=!0);else{if((xr&m)===m){d=d.next,m===Ui&&(h=!0);continue}u={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===o?(c=o=u,l=s):o=o.next=u,Cr.lanes|=m,go|=m}u=d.action,Tr&&a(s,u),s=d.hasEagerState?d.eagerState:a(s,u)}else m={lane:u,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===o?(c=o=m,l=s):o=o.next=m,Cr.lanes|=u,go|=u;d=d.next}while(null!==d&&d!==t);if(null===o?l=s:o.next=c,!Za(s,e.memoizedState)&&(Fl=!0,h&&null!==(a=Xi)))throw a;e.memoizedState=s,e.baseState=l,e.baseQueue=o,n.lastRenderedState=s}return null===i&&(n.lanes=0),[e.memoizedState,n.dispatch]}function Kr(e){var t=zr(),a=t.queue;if(null===a)throw Error(r(311));a.lastRenderedReducer=e;var n=a.dispatch,i=a.pending,s=t.memoizedState;if(null!==i){a.pending=null;var l=i=i.next;do{s=e(s,l.action),l=l.next}while(l!==i);Za(s,t.memoizedState)||(Fl=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),a.lastRenderedState=s}return[s,n]}function Qr(e,t,a){var n=Cr,i=zr(),s=di;if(s){if(void 0===a)throw Error(r(407));a=a()}else a=t();var l=!Za((Ar||i).memoizedState,a);if(l&&(i.memoizedState=a,Fl=!0),i=i.queue,ws(2048,8,ts.bind(null,n,i,e),[e]),i.getSnapshot!==t||l||null!==_r&&1&_r.memoizedState.tag){if(n.flags|=2048,gs(9,{destroy:void 0,resource:void 0},es.bind(null,n,i,a,t),null),null===lo)throw Error(r(349));s||124&xr||Zr(n,t,a)}return a}function Zr(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=Cr.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Cr.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function es(e,t,a,n){t.value=a,t.getSnapshot=n,as(t)&&ns(e)}function ts(e,t,a){return a(function(){as(t)&&ns(e)})}function as(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Za(e,a)}catch(n){return!0}}function ns(e){var t=Wn(e,2);null!==t&&Do(t,0,2)}function is(e){var t=Xr();if("function"==typeof e){var a=e;if(e=a(),Tr){ye(!0);try{a()}finally{ye(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vr,lastRenderedState:e},t}function rs(e,t,a,n){return e.baseState=a,Yr(e,Ar,"function"==typeof n?n:Vr)}function ss(e,t,a,n,i){if(Js(e))throw Error(r(485));if(null!==(e=t.action)){var s={payload:i,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){s.listeners.push(e)}};null!==I.T?a(!0):s.isTransition=!1,n(s),null===(a=t.pending)?(s.next=t.pending=s,ls(t,s)):(s.next=a.next,t.pending=a.next=s)}}function ls(e,t){var a=t.action,n=t.payload,i=e.state;if(t.isTransition){var r=I.T,s={};I.T=s;try{var l=a(i,n),c=I.S;null!==c&&c(s,l),cs(e,t,l)}catch(o){ds(e,t,o)}finally{I.T=r}}else try{cs(e,t,r=a(i,n))}catch(d){ds(e,t,d)}}function cs(e,t,a){null!==a&&"object"==typeof a&&"function"==typeof a.then?a.then(function(a){os(e,t,a)},function(a){return ds(e,t,a)}):os(e,t,a)}function os(e,t,a){t.status="fulfilled",t.value=a,hs(t),e.state=a,null!==(t=e.pending)&&((a=t.next)===t?e.pending=null:(a=a.next,t.next=a,ls(e,a)))}function ds(e,t,a){var n=e.pending;if(e.pending=null,null!==n){n=n.next;do{t.status="rejected",t.reason=a,hs(t),t=t.next}while(t!==n)}e.action=null}function hs(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function us(e,t){return t}function ms(e,t){if(di){var a=lo.formState;if(null!==a){e:{var n=Cr;if(di){if(oi){t:{for(var i=oi,r=ui;8!==i.nodeType;){if(!r){i=null;break t}if(null===(i=kh(i.nextSibling))){i=null;break t}}i="F!"===(r=i.data)||"F"===r?i:null}if(i){oi=kh(i.nextSibling),n="F!"===i.data;break e}}pi(n)}n=!1}n&&(t=a[0])}}return(a=Xr()).memoizedState=a.baseState=t,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:us,lastRenderedState:t},a.queue=n,a=Xs.bind(null,Cr,n),n.dispatch=a,n=is(!1),r=Hs.bind(null,Cr,!1,n.queue),i={state:t,dispatch:null,action:e,pending:null},(n=Xr()).queue=i,a=ss.bind(null,Cr,i,r,a),i.dispatch=a,n.memoizedState=e,[t,a,!1]}function ps(e){return fs(zr(),Ar,e)}function fs(e,t,a){if(t=Yr(e,t,us)[0],e=Gr(Vr)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var n=Hr(t)}catch(s){if(s===Yi)throw Qi;throw s}else n=t;var i=(t=zr()).queue,r=i.dispatch;return a!==t.memoizedState&&(Cr.flags|=2048,gs(9,{destroy:void 0,resource:void 0},vs.bind(null,i,a),null)),[n,r,e]}function vs(e,t){e.action=t}function ys(e){var t=zr(),a=Ar;if(null!==a)return fs(t,a,e);zr(),t=t.memoizedState;var n=(a=zr()).queue.dispatch;return a.memoizedState=e,[t,n,!1]}function gs(e,t,a,n){return e={tag:e,create:a,deps:n,inst:t,next:null},null===(t=Cr.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Cr.updateQueue=t),null===(a=t.lastEffect)?t.lastEffect=e.next=e:(n=a.next,a.next=e,e.next=n,t.lastEffect=e),e}function bs(){return zr().memoizedState}function Ns(e,t,a,n){var i=Xr();n=void 0===n?null:n,Cr.flags|=e,i.memoizedState=gs(1|t,{destroy:void 0,resource:void 0},a,n)}function ws(e,t,a,n){var i=zr();n=void 0===n?null:n;var r=i.memoizedState.inst;null!==Ar&&null!==n&&Lr(n,Ar.memoizedState.deps)?i.memoizedState=gs(t,r,a,n):(Cr.flags|=e,i.memoizedState=gs(1|t,r,a,n))}function ks(e,t){Ns(8390656,8,e,t)}function xs(e,t){ws(2048,8,e,t)}function Cs(e,t){return ws(4,2,e,t)}function As(e,t){return ws(4,4,e,t)}function _s(e,t){if("function"==typeof t){e=e();var a=t(e);return function(){"function"==typeof a?a():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function Ss(e,t,a){a=null!=a?a.concat([e]):null,ws(4,4,_s.bind(null,t,e),a)}function Ps(){}function Ts(e,t){var a=zr();t=void 0===t?null:t;var n=a.memoizedState;return null!==t&&Lr(t,n[1])?n[0]:(a.memoizedState=[e,t],e)}function $s(e,t){var a=zr();t=void 0===t?null:t;var n=a.memoizedState;if(null!==t&&Lr(t,n[1]))return n[0];if(n=e(),Tr){ye(!0);try{e()}finally{ye(!1)}}return a.memoizedState=[n,t],n}function Fs(e,t,a){return void 0===a||1073741824&xr?e.memoizedState=t:(e.memoizedState=a,e=jo(),Cr.lanes|=e,go|=e,a)}function Es(e,t,a,n){return Za(a,t)?a:null!==gr.current?(e=Fs(e,a,n),Za(e,t)||(Fl=!0),e):42&xr?(e=jo(),Cr.lanes|=e,go|=e,t):(Fl=!0,e.memoizedState=a)}function Is(e,t,a,n,i){var r=M.p;M.p=0!==r&&8>r?r:8;var s,l,c,o=I.T,d={};I.T=d,Hs(e,!1,t,a);try{var h=i(),u=I.S;null!==u&&u(d,h),null!==h&&"object"==typeof h&&"function"==typeof h.then?zs(e,t,(s=n,l=[],c={status:"pending",value:null,reason:null,then:function(e){l.push(e)}},h.then(function(){c.status="fulfilled",c.value=s;for(var e=0;e<l.length;e++)(0,l[e])(s)},function(e){for(c.status="rejected",c.reason=e,e=0;e<l.length;e++)(0,l[e])(void 0)}),c),Bo()):zs(e,t,n,Bo())}catch(m){zs(e,t,{then:function(){},status:"rejected",reason:m},Bo())}finally{M.p=r,I.T=o}}function Ms(){}function Ls(e,t,a,n){if(5!==e.tag)throw Error(r(476));var i=Ws(e).queue;Is(e,i,t,L,null===a?Ms:function(){return Rs(e),a(n)})}function Ws(e){var t=e.memoizedState;if(null!==t)return t;var a={};return(t={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vr,lastRenderedState:L},next:null}).next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vr,lastRenderedState:a},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function Rs(e){zs(e,Ws(e).next.queue,{},Bo())}function Os(){return Fi(Zh)}function Bs(){return zr().memoizedState}function js(){return zr().memoizedState}function Ds(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var a=Bo(),n=dr(t,e=or(a),a);return null!==n&&(Do(n,0,a),hr(n,t,a)),t={cache:Oi()},void(e.payload=t)}t=t.return}}function Us(e,t,a){var n=Bo();a={lane:n,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},Js(e)?qs(t,a):null!==(a=Ln(e,t,a,n))&&(Do(a,0,n),Vs(a,t,n))}function Xs(e,t,a){zs(e,t,a,Bo())}function zs(e,t,a,n){var i={lane:n,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(Js(e))qs(t,i);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var s=t.lastRenderedState,l=r(s,a);if(i.hasEagerState=!0,i.eagerState=l,Za(l,s))return Mn(e,t,i,0),null===lo&&In(),!1}catch(c){}if(null!==(a=Ln(e,t,i,n)))return Do(a,0,n),Vs(a,t,n),!0}return!1}function Hs(e,t,a,n){if(n={lane:2,revertLane:Md(),action:n,hasEagerState:!1,eagerState:null,next:null},Js(e)){if(t)throw Error(r(479))}else null!==(t=Ln(e,a,n,2))&&Do(t,0,2)}function Js(e){var t=e.alternate;return e===Cr||null!==t&&t===Cr}function qs(e,t){Pr=Sr=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Vs(e,t,a){if(4194048&a){var n=t.lanes;a|=n&=e.pendingLanes,t.lanes=a,Ee(e,a)}}var Gs={readContext:Fi,use:Jr,useCallback:Mr,useContext:Mr,useEffect:Mr,useImperativeHandle:Mr,useLayoutEffect:Mr,useInsertionEffect:Mr,useMemo:Mr,useReducer:Mr,useRef:Mr,useState:Mr,useDebugValue:Mr,useDeferredValue:Mr,useTransition:Mr,useSyncExternalStore:Mr,useId:Mr,useHostTransitionStatus:Mr,useFormState:Mr,useActionState:Mr,useOptimistic:Mr,useMemoCache:Mr,useCacheRefresh:Mr},Ys={readContext:Fi,use:Jr,useCallback:function(e,t){return Xr().memoizedState=[e,void 0===t?null:t],e},useContext:Fi,useEffect:ks,useImperativeHandle:function(e,t,a){a=null!=a?a.concat([e]):null,Ns(4194308,4,_s.bind(null,t,e),a)},useLayoutEffect:function(e,t){return Ns(4194308,4,e,t)},useInsertionEffect:function(e,t){Ns(4,2,e,t)},useMemo:function(e,t){var a=Xr();t=void 0===t?null:t;var n=e();if(Tr){ye(!0);try{e()}finally{ye(!1)}}return a.memoizedState=[n,t],n},useReducer:function(e,t,a){var n=Xr();if(void 0!==a){var i=a(t);if(Tr){ye(!0);try{a(t)}finally{ye(!1)}}}else i=t;return n.memoizedState=n.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},n.queue=e,e=e.dispatch=Us.bind(null,Cr,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Xr().memoizedState=e},useState:function(e){var t=(e=is(e)).queue,a=Xs.bind(null,Cr,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:Ps,useDeferredValue:function(e,t){return Fs(Xr(),e,t)},useTransition:function(){var e=is(!1);return e=Is.bind(null,Cr,e.queue,!0,!1),Xr().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var n=Cr,i=Xr();if(di){if(void 0===a)throw Error(r(407));a=a()}else{if(a=t(),null===lo)throw Error(r(349));124&oo||Zr(n,t,a)}i.memoizedState=a;var s={value:a,getSnapshot:t};return i.queue=s,ks(ts.bind(null,n,s,e),[e]),n.flags|=2048,gs(9,{destroy:void 0,resource:void 0},es.bind(null,n,s,a,t),null),a},useId:function(){var e=Xr(),t=lo.identifierPrefix;if(di){var a=ni;t="\xab"+t+"R"+(a=(ai&~(1<<32-ge(ai)-1)).toString(32)+a),0<(a=$r++)&&(t+="H"+a.toString(32)),t+="\xbb"}else t="\xab"+t+"r"+(a=Ir++).toString(32)+"\xbb";return e.memoizedState=t},useHostTransitionStatus:Os,useFormState:ms,useActionState:ms,useOptimistic:function(e){var t=Xr();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=Hs.bind(null,Cr,!0,a),a.dispatch=t,[e,t]},useMemoCache:qr,useCacheRefresh:function(){return Xr().memoizedState=Ds.bind(null,Cr)}},Ks={readContext:Fi,use:Jr,useCallback:Ts,useContext:Fi,useEffect:xs,useImperativeHandle:Ss,useInsertionEffect:Cs,useLayoutEffect:As,useMemo:$s,useReducer:Gr,useRef:bs,useState:function(){return Gr(Vr)},useDebugValue:Ps,useDeferredValue:function(e,t){return Es(zr(),Ar.memoizedState,e,t)},useTransition:function(){var e=Gr(Vr)[0],t=zr().memoizedState;return["boolean"==typeof e?e:Hr(e),t]},useSyncExternalStore:Qr,useId:Bs,useHostTransitionStatus:Os,useFormState:ps,useActionState:ps,useOptimistic:function(e,t){return rs(zr(),0,e,t)},useMemoCache:qr,useCacheRefresh:js},Qs={readContext:Fi,use:Jr,useCallback:Ts,useContext:Fi,useEffect:xs,useImperativeHandle:Ss,useInsertionEffect:Cs,useLayoutEffect:As,useMemo:$s,useReducer:Kr,useRef:bs,useState:function(){return Kr(Vr)},useDebugValue:Ps,useDeferredValue:function(e,t){var a=zr();return null===Ar?Fs(a,e,t):Es(a,Ar.memoizedState,e,t)},useTransition:function(){var e=Kr(Vr)[0],t=zr().memoizedState;return["boolean"==typeof e?e:Hr(e),t]},useSyncExternalStore:Qr,useId:Bs,useHostTransitionStatus:Os,useFormState:ys,useActionState:ys,useOptimistic:function(e,t){var a=zr();return null!==Ar?rs(a,0,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:qr,useCacheRefresh:js},Zs=null,el=0;function tl(e){var t=el;return el+=1,null===Zs&&(Zs=[]),ar(Zs,e,t)}function al(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function nl(e,t){if(t.$$typeof===u)throw Error(r(525));throw e={}.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function il(e){return(0,e.l)(e.i)}function rl(e){function t(t,a){if(e){var n=t.deletions;null===n?(t.deletions=[a],t.flags|=16):n.push(a)}}function a(a,n){if(!e)return null;for(;null!==n;)t(a,n),n=n.sibling;return null}function n(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function i(e,t){return(e=Xn(e,t)).index=0,e.sibling=null,e}function s(t,a,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<a?(t.flags|=67108866,a):n:(t.flags|=67108866,a):(t.flags|=1048576,a)}function l(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,a,n){return null===t||6!==t.tag?((t=qn(a,e.mode,n)).return=e,t):((t=i(t,a)).return=e,t)}function o(e,t,a,n){var r=a.type;return r===f?h(e,t,a.props.children,n,a.key):null!==t&&(t.elementType===r||"object"==typeof r&&null!==r&&r.$$typeof===A&&il(r)===t.type)?(al(t=i(t,a.props),a),t.return=e,t):(al(t=Hn(a.type,a.key,a.props,null,e.mode,n),a),t.return=e,t)}function d(e,t,a,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=Vn(a,e.mode,n)).return=e,t):((t=i(t,a.children||[])).return=e,t)}function h(e,t,a,n,r){return null===t||7!==t.tag?((t=Jn(a,e.mode,n,r)).return=e,t):((t=i(t,a)).return=e,t)}function u(e,t,a){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=qn(""+t,e.mode,a)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case m:return al(a=Hn(t.type,t.key,t.props,null,e.mode,a),t),a.return=e,a;case p:return(t=Vn(t,e.mode,a)).return=e,t;case A:return u(e,t=(0,t.l)(t.i),a)}if(E(t)||T(t))return(t=Jn(t,e.mode,a,null)).return=e,t;if("function"==typeof t.then)return u(e,tl(t),a);if(t.$$typeof===N)return u(e,Ei(e,t),a);nl(e,t)}return null}function v(e,t,a,n){var i=null!==t?t.key:null;if("string"==typeof a&&""!==a||"number"==typeof a||"bigint"==typeof a)return null!==i?null:c(e,t,""+a,n);if("object"==typeof a&&null!==a){switch(a.$$typeof){case m:return a.key===i?o(e,t,a,n):null;case p:return a.key===i?d(e,t,a,n):null;case A:return v(e,t,a=(i=a.l)(a.i),n)}if(E(a)||T(a))return null!==i?null:h(e,t,a,n,null);if("function"==typeof a.then)return v(e,t,tl(a),n);if(a.$$typeof===N)return v(e,t,Ei(e,a),n);nl(e,a)}return null}function y(e,t,a,n,i){if("string"==typeof n&&""!==n||"number"==typeof n||"bigint"==typeof n)return c(t,e=e.get(a)||null,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case m:return o(t,e=e.get(null===n.key?a:n.key)||null,n,i);case p:return d(t,e=e.get(null===n.key?a:n.key)||null,n,i);case A:return y(e,t,a,n=(0,n.l)(n.i),i)}if(E(n)||T(n))return h(t,e=e.get(a)||null,n,i,null);if("function"==typeof n.then)return y(e,t,a,tl(n),i);if(n.$$typeof===N)return y(e,t,a,Ei(t,n),i);nl(t,n)}return null}function g(c,o,d,h){if("object"==typeof d&&null!==d&&d.type===f&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case m:e:{for(var b=d.key;null!==o;){if(o.key===b){if((b=d.type)===f){if(7===o.tag){a(c,o.sibling),(h=i(o,d.props.children)).return=c,c=h;break e}}else if(o.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===A&&il(b)===o.type){a(c,o.sibling),al(h=i(o,d.props),d),h.return=c,c=h;break e}a(c,o);break}t(c,o),o=o.sibling}d.type===f?((h=Jn(d.props.children,c.mode,h,d.key)).return=c,c=h):(al(h=Hn(d.type,d.key,d.props,null,c.mode,h),d),h.return=c,c=h)}return l(c);case p:e:{for(b=d.key;null!==o;){if(o.key===b){if(4===o.tag&&o.stateNode.containerInfo===d.containerInfo&&o.stateNode.implementation===d.implementation){a(c,o.sibling),(h=i(o,d.children||[])).return=c,c=h;break e}a(c,o);break}t(c,o),o=o.sibling}(h=Vn(d,c.mode,h)).return=c,c=h}return l(c);case A:return g(c,o,d=(b=d.l)(d.i),h)}if(E(d))return function(i,r,l,c){for(var o=null,d=null,h=r,m=r=0,p=null;null!==h&&m<l.length;m++){h.index>m?(p=h,h=null):p=h.sibling;var f=v(i,h,l[m],c);if(null===f){null===h&&(h=p);break}e&&h&&null===f.alternate&&t(i,h),r=s(f,r,m),null===d?o=f:d.sibling=f,d=f,h=p}if(m===l.length)return a(i,h),di&&ii(i,m),o;if(null===h){for(;m<l.length;m++)null!==(h=u(i,l[m],c))&&(r=s(h,r,m),null===d?o=h:d.sibling=h,d=h);return di&&ii(i,m),o}for(h=n(h);m<l.length;m++)null!==(p=y(h,i,m,l[m],c))&&(e&&null!==p.alternate&&h.delete(null===p.key?m:p.key),r=s(p,r,m),null===d?o=p:d.sibling=p,d=p);return e&&h.forEach(function(e){return t(i,e)}),di&&ii(i,m),o}(c,o,d,h);if(T(d)){if("function"!=typeof(b=T(d)))throw Error(r(150));return function(i,l,c,o){if(null==c)throw Error(r(151));for(var d=null,h=null,m=l,p=l=0,f=null,g=c.next();null!==m&&!g.done;p++,g=c.next()){m.index>p?(f=m,m=null):f=m.sibling;var b=v(i,m,g.value,o);if(null===b){null===m&&(m=f);break}e&&m&&null===b.alternate&&t(i,m),l=s(b,l,p),null===h?d=b:h.sibling=b,h=b,m=f}if(g.done)return a(i,m),di&&ii(i,p),d;if(null===m){for(;!g.done;p++,g=c.next())null!==(g=u(i,g.value,o))&&(l=s(g,l,p),null===h?d=g:h.sibling=g,h=g);return di&&ii(i,p),d}for(m=n(m);!g.done;p++,g=c.next())null!==(g=y(m,i,p,g.value,o))&&(e&&null!==g.alternate&&m.delete(null===g.key?p:g.key),l=s(g,l,p),null===h?d=g:h.sibling=g,h=g);return e&&m.forEach(function(e){return t(i,e)}),di&&ii(i,p),d}(c,o,d=b.call(d),h)}if("function"==typeof d.then)return g(c,o,tl(d),h);if(d.$$typeof===N)return g(c,o,Ei(c,d),h);nl(c,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==o&&6===o.tag?(a(c,o.sibling),(h=i(o,d)).return=c,c=h):(a(c,o),(h=qn(d,c.mode,h)).return=c,c=h),l(c)):a(c,o)}return function(e,t,a,n){try{el=0;var i=g(e,t,a,n);return Zs=null,i}catch(s){if(s===Yi||s===Qi)throw s;var r=Dn(29,s,null,e.mode);return r.lanes=n,r.return=e,r}}}var sl=rl(!0),ll=rl(!1),cl=O(null),ol=null;function dl(e){var t=e.alternate;X(pl,1&pl.current),X(cl,e),null===ol&&(null===t||null!==gr.current||null!==t.memoizedState)&&(ol=e)}function hl(e){if(22===e.tag){if(X(pl,pl.current),X(cl,e),null===ol){var t=e.alternate;null!==t&&null!==t.memoizedState&&(ol=e)}}else ul()}function ul(){X(pl,pl.current),X(cl,cl.current)}function ml(e){U(cl),ol===e&&(ol=null),U(pl)}var pl=O(0);function fl(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||"$?"===a.data||wh(a)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function vl(e,t,a,n){a=null==(a=a(n,t=e.memoizedState))?t:h({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}var yl={enqueueSetState:function(e,t,a){e=e.F;var n=Bo(),i=or(n);i.payload=t,null!=a&&(i.callback=a),null!==(t=dr(e,i,n))&&(Do(t,0,n),hr(t,e,n))},enqueueReplaceState:function(e,t,a){e=e.F;var n=Bo(),i=or(n);i.tag=1,i.payload=t,null!=a&&(i.callback=a),null!==(t=dr(e,i,n))&&(Do(t,0,n),hr(t,e,n))},enqueueForceUpdate:function(e,t){e=e.F;var a=Bo(),n=or(a);n.tag=2,null!=t&&(n.callback=t),null!==(t=dr(e,n,a))&&(Do(t,0,a),hr(t,e,a))}};function gl(e,t,a,n,i,r,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,r,s):!(t.prototype&&t.prototype.isPureReactComponent&&en(a,n)&&en(i,r))}function bl(e,t,a,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,n),t.state!==e&&yl.enqueueReplaceState(t,t.state,null)}function Nl(e,t){var a=t;if("ref"in t)for(var n in a={},t)"ref"!==n&&(a[n]=t[n]);if(e=e.defaultProps)for(var i in a===t&&(a=h({},a)),e)void 0===a[i]&&(a[i]=e[i]);return a}var wl="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e)};function kl(e){wl(e)}function xl(e){}function Cl(e){wl(e)}function Al(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function _l(e,t,a){try{(0,e.onCaughtError)(a.value,{componentStack:a.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(n){setTimeout(function(){throw n})}}function Sl(e,t,a){return(a=or(a)).tag=3,a.payload={element:null},a.callback=function(){Al(e,t)},a}function Pl(e){return(e=or(e)).tag=3,e}function Tl(e,t,a,n){var i=a.type.getDerivedStateFromError;if("function"==typeof i){var r=n.value;e.payload=function(){return i(r)},e.callback=function(){_l(t,a,n)}}var s=a.stateNode;null!==s&&"function"==typeof s.componentDidCatch&&(e.callback=function(){_l(t,a,n),"function"!=typeof i&&(null===To?To=new Set([this]):To.add(this));var e=n.stack;this.componentDidCatch(n.value,{componentStack:null!==e?e:""})})}var $l=Error(r(461)),Fl=!1;function El(e,t,a,n){t.child=null===e?ll(t,null,a,n):sl(t,e.child,a,n)}function Il(e,t,a,n,i){a=a.render;var r=t.ref;if("ref"in n){var s={};for(var l in n)"ref"!==l&&(s[l]=n[l])}else s=n;return $i(t),n=Wr(e,t,a,s,r,i),l=jr(),null===e||Fl?(di&&l&&si(t),t.flags|=1,El(e,t,n,i),t.child):(Dr(e,t,i),Zl(e,t,i))}function Ml(e,t,a,n,i){if(null===e){var r=a.type;return"function"!=typeof r||Un(r)||void 0!==r.defaultProps||null!==a.compare?((e=Hn(a.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,Ll(e,t,r,n,i))}if(r=e.child,!ec(e,i)){var s=r.memoizedProps;if((a=null!==(a=a.compare)?a:en)(s,n)&&e.ref===t.ref)return Zl(e,t,i)}return t.flags|=1,(e=Xn(r,n)).ref=t.ref,e.return=t,t.child=e}function Ll(e,t,a,n,i){if(null!==e){var r=e.memoizedProps;if(en(r,n)&&e.ref===t.ref){if(Fl=!1,t.pendingProps=n=r,!ec(e,i))return t.lanes=e.lanes,Zl(e,t,i);131072&e.flags&&(Fl=!0)}}return Bl(e,t,a,n,i)}function Wl(e,t,a){var n=t.pendingProps,i=n.children,r=null!==e?e.memoizedState:null;if("hidden"===n.mode){if(128&t.flags){if(n=null!==r?r.baseLanes|a:a,null!==e){for(i=t.child=e.child,r=0;null!==i;)r=r|i.lanes|i.childLanes,i=i.sibling;t.childLanes=r&~n}else t.childLanes=0,t.child=null;return Rl(e,t,n,a)}if(!(536870912&a))return t.lanes=t.childLanes=536870912,Rl(e,t,null!==r?r.baseLanes|a:a,a);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Vi(0,null!==r?r.cachePool:null),null!==r?Nr(t,r):wr(),hl(t)}else null!==r?(Vi(0,r.cachePool),Nr(t,r),ul(),t.memoizedState=null):(null!==e&&Vi(0,null),wr(),ul());return El(e,t,i,a),t.child}function Rl(e,t,a,n){var i=qi();return i=null===i?null:{parent:Ri.u,pool:i},t.memoizedState={baseLanes:a,cachePool:i},null!==e&&Vi(0,null),wr(),hl(t),null!==e&&Pi(e,t,n,!0),null}function Ol(e,t){var a=t.ref;if(null===a)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof a&&"object"!=typeof a)throw Error(r(284));null!==e&&e.ref===a||(t.flags|=4194816)}}function Bl(e,t,a,n,i){return $i(t),a=Wr(e,t,a,n,void 0,i),n=jr(),null===e||Fl?(di&&n&&si(t),t.flags|=1,El(e,t,a,i),t.child):(Dr(e,t,i),Zl(e,t,i))}function jl(e,t,a,n,i,r){return $i(t),t.updateQueue=null,a=Or(t,n,a,i),Rr(e),n=jr(),null===e||Fl?(di&&n&&si(t),t.flags|=1,El(e,t,a,r),t.child):(Dr(e,t,r),Zl(e,t,r))}function Dl(e,t,a,n,i){if($i(t),null===t.stateNode){var r=Bn,s=a.contextType;"object"==typeof s&&null!==s&&(r=Fi(s)),r=new a(n,r),t.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,r.updater=yl,t.stateNode=r,r.F=t,(r=t.stateNode).props=n,r.state=t.memoizedState,r.refs={},lr(t),s=a.contextType,r.context="object"==typeof s&&null!==s?Fi(s):Bn,r.state=t.memoizedState,"function"==typeof(s=a.getDerivedStateFromProps)&&(vl(t,a,s,n),r.state=t.memoizedState),"function"==typeof a.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(s=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),s!==r.state&&yl.enqueueReplaceState(r,r.state,null),fr(t,n,r,i),pr(),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.flags|=4194308),n=!0}else if(null===e){r=t.stateNode;var l=t.memoizedProps,c=Nl(a,l);r.props=c;var o=r.context,d=a.contextType;s=Bn,"object"==typeof d&&null!==d&&(s=Fi(d));var h=a.getDerivedStateFromProps;d="function"==typeof h||"function"==typeof r.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(l||o!==s)&&bl(t,r,n,s),sr=!1;var u=t.memoizedState;r.state=u,fr(t,n,r,i),pr(),o=t.memoizedState,l||u!==o||sr?("function"==typeof h&&(vl(t,a,h,n),o=t.memoizedState),(c=sr||gl(t,a,c,n,u,o,s))?(d||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||("function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount()),"function"==typeof r.componentDidMount&&(t.flags|=4194308)):("function"==typeof r.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=o),r.props=n,r.state=o,r.context=s,n=c):("function"==typeof r.componentDidMount&&(t.flags|=4194308),n=!1)}else{r=t.stateNode,cr(e,t),d=Nl(a,s=t.memoizedProps),r.props=d,h=t.pendingProps,u=r.context,o=a.contextType,c=Bn,"object"==typeof o&&null!==o&&(c=Fi(o)),(o="function"==typeof(l=a.getDerivedStateFromProps)||"function"==typeof r.getSnapshotBeforeUpdate)||"function"!=typeof r.UNSAFE_componentWillReceiveProps&&"function"!=typeof r.componentWillReceiveProps||(s!==h||u!==c)&&bl(t,r,n,c),sr=!1,u=t.memoizedState,r.state=u,fr(t,n,r,i),pr();var m=t.memoizedState;s!==h||u!==m||sr||null!==e&&null!==e.dependencies&&Ti(e.dependencies)?("function"==typeof l&&(vl(t,a,l,n),m=t.memoizedState),(d=sr||gl(t,a,d,n,u,m,c)||null!==e&&null!==e.dependencies&&Ti(e.dependencies))?(o||"function"!=typeof r.UNSAFE_componentWillUpdate&&"function"!=typeof r.componentWillUpdate||("function"==typeof r.componentWillUpdate&&r.componentWillUpdate(n,m,c),"function"==typeof r.UNSAFE_componentWillUpdate&&r.UNSAFE_componentWillUpdate(n,m,c)),"function"==typeof r.componentDidUpdate&&(t.flags|=4),"function"==typeof r.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof r.componentDidUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),r.props=n,r.state=m,r.context=c,n=d):("function"!=typeof r.componentDidUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=4),"function"!=typeof r.getSnapshotBeforeUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.flags|=1024),n=!1)}return r=n,Ol(e,t),n=!!(128&t.flags),r||n?(r=t.stateNode,a=n&&"function"!=typeof a.getDerivedStateFromError?null:r.render(),t.flags|=1,null!==e&&n?(t.child=sl(t,e.child,null,i),t.child=sl(t,null,a,i)):El(e,t,a,i),t.memoizedState=r.state,e=t.child):e=Zl(e,t,i),e}function Ul(e,t,a,n){return gi(),t.flags|=256,El(e,t,a,n),t.child}var Xl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function zl(e){return{baseLanes:e,cachePool:Gi()}}function Hl(e,t,a){return e=null!==e?e.childLanes&~a:0,t&&(e|=wo),e}function Jl(e,t,a){var n,i=t.pendingProps,s=!1,l=!!(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&!!(2&pl.current)),n&&(s=!0,t.flags&=-129),n=!!(32&t.flags),t.flags&=-33,null===e){if(di){if(s?dl(t):ul(),di){var c,o=oi;if(c=o){e:{for(c=o,o=ui;8!==c.nodeType;){if(!o){o=null;break e}if(null===(c=kh(c.nextSibling))){o=null;break e}}o=c}null!==o?(t.memoizedState={dehydrated:o,treeContext:null!==ti?{id:ai,overflow:ni}:null,retryLane:536870912,hydrationErrors:null},(c=Dn(18,null,null,0)).stateNode=o,c.return=t,t.child=c,ci=t,oi=null,c=!0):c=!1}c||pi(t)}if(null!==(o=t.memoizedState)&&null!==(o=o.dehydrated))return wh(o)?t.lanes=32:t.lanes=536870912,null;ml(t)}return o=i.children,i=i.fallback,s?(ul(),o=Vl({mode:"hidden",children:o},s=t.mode),i=Jn(i,s,a,null),o.return=t,i.return=t,o.sibling=i,t.child=o,(s=t.child).memoizedState=zl(a),s.childLanes=Hl(e,n,a),t.memoizedState=Xl,i):(dl(t),ql(t,o))}if(null!==(c=e.memoizedState)&&null!==(o=c.dehydrated)){if(l)256&t.flags?(dl(t),t.flags&=-257,t=Gl(e,t,a)):null!==t.memoizedState?(ul(),t.child=e.child,t.flags|=128,t=null):(ul(),s=i.fallback,o=t.mode,i=Vl({mode:"visible",children:i.children},o),(s=Jn(s,o,a,null)).flags|=2,i.return=t,s.return=t,i.sibling=s,t.child=i,sl(t,e.child,null,a),(i=t.child).memoizedState=zl(a),i.childLanes=Hl(e,n,a),t.memoizedState=Xl,t=s);else if(dl(t),wh(o)){if(n=o.nextSibling&&o.nextSibling.dataset)var d=n.dgst;n=d,(i=Error(r(419))).stack="",i.digest=n,Ni({value:i,source:null,stack:null}),t=Gl(e,t,a)}else if(Fl||Pi(e,t,a,!1),n=0!==(a&e.childLanes),Fl||n){if(null!==(n=lo)&&0!==(i=0!==((i=42&(i=a&-a)?1:Ie(i))&(n.suspendedLanes|a))?0:i)&&i!==c.retryLane)throw c.retryLane=i,Wn(e,i),Do(n,0,i),$l;"$?"===o.data||Qo(),t=Gl(e,t,a)}else"$?"===o.data?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,oi=kh(o.nextSibling),ci=t,di=!0,hi=null,ui=!1,null!==e&&(Zn[ei++]=ai,Zn[ei++]=ni,Zn[ei++]=ti,ai=e.id,ni=e.overflow,ti=t),(t=ql(t,i.children)).flags|=4096);return t}return s?(ul(),s=i.fallback,o=t.mode,d=(c=e.child).sibling,(i=Xn(c,{mode:"hidden",children:i.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?s=Xn(d,s):(s=Jn(s,o,a,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,null===(o=e.child.memoizedState)?o=zl(a):(null!==(c=o.cachePool)?(d=Ri.u,c=c.parent!==d?{parent:d,pool:d}:c):c=Gi(),o={baseLanes:o.baseLanes|a,cachePool:c}),s.memoizedState=o,s.childLanes=Hl(e,n,a),t.memoizedState=Xl,i):(dl(t),e=(a=e.child).sibling,(a=Xn(a,{mode:"visible",children:i.children})).return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a)}function ql(e,t){return(t=Vl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Vl(e,t){return(e=Dn(22,e,null,t)).lanes=0,e.stateNode={_:1,I:null,W:null,R:null},e}function Gl(e,t,a){return sl(t,e.child,null,a),(e=ql(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Yl(e,t,a){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),_i(e.return,t,a)}function Kl(e,t,a,n,i){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:i}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=a,r.tailMode=i)}function Ql(e,t,a){var n=t.pendingProps,i=n.revealOrder,r=n.tail;if(El(e,t,n.children,a),2&(n=pl.current))n=1&n|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Yl(e,a,t);else if(19===e.tag)Yl(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}switch(X(pl,n),i){case"forwards":for(a=t.child,i=null;null!==a;)null!==(e=a.alternate)&&null===fl(e)&&(i=a),a=a.sibling;null===(a=i)?(i=t.child,t.child=null):(i=a.sibling,a.sibling=null),Kl(t,!1,i,a,r);break;case"backwards":for(a=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===fl(e)){t.child=i;break}e=i.sibling,i.sibling=a,a=i,i=e}Kl(t,!0,a,null,r);break;case"together":Kl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Zl(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),go|=t.lanes,0===(a&t.childLanes)){if(null===e)return null;if(Pi(e,t,a,!1),0===(a&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(a=Xn(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=Xn(e,e.pendingProps)).return=t;a.sibling=null}return t.child}function ec(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Ti(e))}function tc(e,t,a){if(null!==e)if(e.memoizedProps!==t.pendingProps)Fl=!0;else{if(!(ec(e,a)||128&t.flags))return Fl=!1,function(e,t,a){switch(t.tag){case 3:K(t,t.stateNode.containerInfo),Ci(0,Ri,e.memoizedState.cache),gi();break;case 27:case 5:Z(t);break;case 4:K(t,t.stateNode.containerInfo);break;case 10:Ci(0,t.type,t.memoizedProps.value);break;case 13:var n=t.memoizedState;if(null!==n)return null!==n.dehydrated?(dl(t),t.flags|=128,null):0!==(a&t.child.childLanes)?Jl(e,t,a):(dl(t),null!==(e=Zl(e,t,a))?e.sibling:null);dl(t);break;case 19:var i=!!(128&e.flags);if((n=0!==(a&t.childLanes))||(Pi(e,t,a,!1),n=0!==(a&t.childLanes)),i){if(n)return Ql(e,t,a);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),X(pl,pl.current),n)break;return null;case 22:case 23:return t.lanes=0,Wl(e,t,a);case 24:Ci(0,Ri,e.memoizedState.cache)}return Zl(e,t,a)}(e,t,a);Fl=!!(131072&e.flags)}else Fl=!1,di&&1048576&t.flags&&ri(t,Qn,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var n=t.elementType,i=n.l;if(n=i(n.i),t.type=n,"function"!=typeof n){if(null!=n){if((i=n.$$typeof)===w){t.tag=11,t=Il(null,t,n,e,a);break e}if(i===C){t.tag=14,t=Ml(null,t,n,e,a);break e}}throw t=F(n)||n,Error(r(306,t,""))}Un(n)?(e=Nl(n,e),t.tag=1,t=Dl(null,t,n,e,a)):(t.tag=0,t=Bl(null,t,n,e,a))}return t;case 0:return Bl(e,t,t.type,t.pendingProps,a);case 1:return Dl(e,t,n=t.type,i=Nl(n,t.pendingProps),a);case 3:e:{if(K(t,t.stateNode.containerInfo),null===e)throw Error(r(387));n=t.pendingProps;var s=t.memoizedState;i=s.element,cr(e,t),fr(t,n,null,a);var l=t.memoizedState;if(n=l.cache,Ci(0,Ri,n),n!==s.cache&&Si(t,[Ri],a,!0),pr(),n=l.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Ul(e,t,n,a);break e}if(n!==i){Ni(i=Tn(Error(r(424)),t)),t=Ul(e,t,n,a);break e}for(e=9===(e=t.stateNode.containerInfo).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,oi=kh(e.firstChild),ci=t,di=!0,hi=null,ui=!0,a=ll(t,null,n,a),t.child=a;a;)a.flags=-3&a.flags|4096,a=a.sibling}else{if(gi(),n===i){t=Zl(e,t,a);break e}El(e,t,n,a)}t=t.child}return t;case 26:return Ol(e,t),null===e?(a=Ih(t.type,null,t.pendingProps,null))?t.memoizedState=a:di||(a=t.type,e=t.pendingProps,(n=ch(J.current).createElement(a))[Re]=t,n[Oe]=e,rh(n,a,e),Ye(n),t.stateNode=n):t.memoizedState=Ih(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Z(t),null===e&&di&&(n=t.stateNode=Ah(t.type,t.pendingProps,J.current),ci=t,ui=!0,i=oi,gh(t.type)?(xh=i,oi=kh(n.firstChild)):oi=i),El(e,t,t.pendingProps.children,a),Ol(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&di&&((i=n=oi)&&(null!==(n=function(e,t,a,n){for(;1===e.nodeType;){var i=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!n&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(n){if(!e[ze])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(r=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(r!==i.rel||e.getAttribute("href")!==(null==i.href||""===i.href?null:i.href)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin)||e.getAttribute("title")!==(null==i.title?null:i.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((r=e.getAttribute("src"))!==(null==i.src?null:i.src)||e.getAttribute("type")!==(null==i.type?null:i.type)||e.getAttribute("crossorigin")!==(null==i.crossOrigin?null:i.crossOrigin))&&r&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var r=null==i.name?null:""+i.name;if("hidden"===i.type&&e.getAttribute("name")===r)return e}if(null===(e=kh(e.nextSibling)))break}return null}(n,t.type,t.pendingProps,ui))?(t.stateNode=n,ci=t,oi=kh(n.firstChild),ui=!1,i=!0):i=!1),i||pi(t)),Z(t),i=t.type,s=t.pendingProps,l=null!==e?e.memoizedProps:null,n=s.children,hh(i,s)?n=null:null!==l&&hh(i,l)&&(t.flags|=32),null!==t.memoizedState&&(i=Wr(e,t,Br,null,null,a),Zh.u=i),Ol(e,t),El(e,t,n,a),t.child;case 6:return null===e&&di&&((e=a=oi)&&(null!==(a=function(e,t,a){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!a)return null;if(null===(e=kh(e.nextSibling)))return null}return e}(a,t.pendingProps,ui))?(t.stateNode=a,ci=t,oi=null,e=!0):e=!1),e||pi(t)),null;case 13:return Jl(e,t,a);case 4:return K(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=sl(t,null,n,a):El(e,t,n,a),t.child;case 11:return Il(e,t,t.type,t.pendingProps,a);case 7:return El(e,t,t.pendingProps,a),t.child;case 8:case 12:return El(e,t,t.pendingProps.children,a),t.child;case 10:return n=t.pendingProps,Ci(0,t.type,n.value),El(e,t,n.children,a),t.child;case 9:return i=t.type.t,n=t.pendingProps.children,$i(t),n=n(i=Fi(i)),t.flags|=1,El(e,t,n,a),t.child;case 14:return Ml(e,t,t.type,t.pendingProps,a);case 15:return Ll(e,t,t.type,t.pendingProps,a);case 19:return Ql(e,t,a);case 31:return n=t.pendingProps,a=t.mode,n={mode:n.mode,children:n.children},null===e?((a=Vl(n,a)).ref=t.ref,t.child=a,a.return=t,t=a):((a=Xn(e.child,n)).ref=t.ref,t.child=a,a.return=t,t=a),t;case 22:return Wl(e,t,a);case 24:return $i(t),n=Fi(Ri),null===e?(null===(i=qi())&&(i=lo,s=Oi(),i.pooledCache=s,s.refCount++,null!==s&&(i.pooledCacheLanes|=a),i=s),t.memoizedState={parent:n,cache:i},lr(t),Ci(0,Ri,i)):(0!==(e.lanes&a)&&(cr(e,t),fr(t,null,null,a),pr()),i=e.memoizedState,s=t.memoizedState,i.parent!==n?(i={parent:n,cache:n},t.memoizedState=i,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=i),Ci(0,Ri,n)):(n=s.cache,Ci(0,Ri,n),n!==i.cache&&Si(t,[Ri],a,!0))),El(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(r(156,t.tag))}function ac(e){e.flags|=4}function nc(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!Jh(t)){if(null!==(t=cl.current)&&((4194048&oo)===oo?null!==ol:(62914560&oo)!==oo&&!(536870912&oo)||t!==ol))throw nr=Zi,Ki;e.flags|=8192}}function ic(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?Pe():536870912,e.lanes|=t,ko|=t)}function rc(e,t){if(!di)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var n=null;null!==a;)null!==a.alternate&&(n=a),a=a.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function sc(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,n=0;if(t)for(var i=e.child;null!==i;)a|=i.lanes|i.childLanes,n|=65011712&i.subtreeFlags,n|=65011712&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)a|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=a,t}function lc(e,t,a){var n=t.pendingProps;switch(li(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return sc(t),null;case 3:return a=t.stateNode,n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ai(Ri),Q(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(yi(t)?ac(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,bi())),sc(t),null;case 26:return a=t.memoizedState,null===e?(ac(t),null!==a?(sc(t),nc(t,a)):(sc(t),t.flags&=-16777217)):a?a!==e.memoizedState?(ac(t),sc(t),nc(t,a)):(sc(t),t.flags&=-16777217):(e.memoizedProps!==n&&ac(t),sc(t),t.flags&=-16777217),null;case 27:ee(t),a=J.current;var i=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ac(t);else{if(!n){if(null===t.stateNode)throw Error(r(166));return sc(t),null}e=z.current,yi(t)?fi(t):(e=Ah(i,n,a),t.stateNode=e,ac(t))}return sc(t),null;case 5:if(ee(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==n&&ac(t);else{if(!n){if(null===t.stateNode)throw Error(r(166));return sc(t),null}if(e=z.current,yi(t))fi(t);else{switch(i=ch(J.current),e){case 1:e=i.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=i.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=i.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=i.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof n.is?i.createElement("select",{is:n.is}):i.createElement("select"),n.multiple?e.multiple=!0:n.size&&(e.size=n.size);break;default:e="string"==typeof n.is?i.createElement(a,{is:n.is}):i.createElement(a)}}e[Re]=t,e[Oe]=n;e:for(i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&27!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break e;for(;null===i.sibling;){if(null===i.return||i.return===t)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}t.stateNode=e;e:switch(rh(e,a,n),a){case"button":case"input":case"select":case"textarea":e=!!n.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&ac(t)}}return sc(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==n&&ac(t);else{if("string"!=typeof n&&null===t.stateNode)throw Error(r(166));if(e=J.current,yi(t)){if(e=t.stateNode,a=t.memoizedProps,n=null,null!==(i=ci))switch(i.tag){case 27:case 5:n=i.memoizedProps}e[Re]=t,(e=!!(e.nodeValue===a||null!==n&&!0===n.suppressHydrationWarning||th(e.nodeValue,a)))||pi(t)}else(e=ch(e).createTextNode(n))[Re]=t,t.stateNode=e}return sc(t),null;case 13:if(n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(i=yi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!i)throw Error(r(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(r(317));i[Re]=t}else gi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;sc(t),i=!1}else i=bi(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=i),i=!0;if(!i)return 256&t.flags?(ml(t),t):(ml(t),null)}if(ml(t),128&t.flags)return t.lanes=a,t;if(a=null!==n,e=null!==e&&null!==e.memoizedState,a){i=null,null!==(n=t.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(i=n.alternate.memoizedState.cachePool.pool);var s=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(s=n.memoizedState.cachePool.pool),s!==i&&(n.flags|=2048)}return a!==e&&a&&(t.child.flags|=8192),ic(t,t.updateQueue),sc(t),null;case 4:return Q(),null===e&&Hd(t.stateNode.containerInfo),sc(t),null;case 10:return Ai(t.type),sc(t),null;case 19:if(U(pl),null===(i=t.memoizedState))return sc(t),null;if(n=!!(128&t.flags),null===(s=i.rendering))if(n)rc(i,!1);else{if(0!==yo||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(s=fl(e))){for(t.flags|=128,rc(i,!1),e=s.updateQueue,t.updateQueue=e,ic(t,e),t.subtreeFlags=0,e=a,a=t.child;null!==a;)zn(a,e),a=a.sibling;return X(pl,1&pl.current|2),t.child}e=e.sibling}null!==i.tail&&se()>So&&(t.flags|=128,n=!0,rc(i,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=fl(s))){if(t.flags|=128,n=!0,e=e.updateQueue,t.updateQueue=e,ic(t,e),rc(i,!0),null===i.tail&&"hidden"===i.tailMode&&!s.alternate&&!di)return sc(t),null}else 2*se()-i.renderingStartTime>So&&536870912!==a&&(t.flags|=128,n=!0,rc(i,!1),t.lanes=4194304);i.isBackwards?(s.sibling=t.child,t.child=s):(null!==(e=i.last)?e.sibling=s:t.child=s,i.last=s)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=se(),t.sibling=null,e=pl.current,X(pl,n?1&e|2:1&e),t):(sc(t),null);case 22:case 23:return ml(t),kr(),n=null!==t.memoizedState,null!==e?null!==e.memoizedState!==n&&(t.flags|=8192):n&&(t.flags|=8192),n?!!(536870912&a)&&!(128&t.flags)&&(sc(t),6&t.subtreeFlags&&(t.flags|=8192)):sc(t),null!==(a=t.updateQueue)&&ic(t,a.retryQueue),a=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),n=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(n=t.memoizedState.cachePool.pool),n!==a&&(t.flags|=2048),null!==e&&U(Ji),null;case 24:return a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Ai(Ri),sc(t),null;case 25:case 30:return null}throw Error(r(156,t.tag))}function cc(e,t){switch(li(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ai(Ri),Q(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return ee(t),null;case 13:if(ml(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));gi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(pl),null;case 4:return Q(),null;case 10:return Ai(t.type),null;case 22:case 23:return ml(t),kr(),null!==e&&U(Ji),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Ai(Ri),null;default:return null}}function oc(e,t){switch(li(t),t.tag){case 3:Ai(Ri),Q();break;case 26:case 27:case 5:ee(t);break;case 4:Q();break;case 13:ml(t);break;case 19:U(pl);break;case 10:Ai(t.type);break;case 22:case 23:ml(t),kr(),null!==e&&U(Ji);break;case 24:Ai(Ri)}}function dc(e,t){try{var a=t.updateQueue,n=null!==a?a.lastEffect:null;if(null!==n){var i=n.next;a=i;do{if((a.tag&e)===e){n=void 0;var r=a.create,s=a.inst;n=r(),s.destroy=n}a=a.next}while(a!==i)}}catch(l){fd(t,t.return,l)}}function hc(e,t,a){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&e)===e){var s=n.inst,l=s.destroy;if(void 0!==l){s.destroy=void 0,i=t;var c=a,o=l;try{o()}catch(d){fd(i,c,d)}}}n=n.next}while(n!==r)}}catch(d){fd(t,t.return,d)}}function uc(e){var t=e.updateQueue;if(null!==t){var a=e.stateNode;try{yr(t,a)}catch(n){fd(e,e.return,n)}}}function mc(e,t,a){a.props=Nl(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(n){fd(e,t,n)}}function pc(e,t){try{var a=e.ref;if(null!==a){switch(e.tag){case 26:case 27:case 5:var n=e.stateNode;break;default:n=e.stateNode}"function"==typeof a?e.refCleanup=a(n):a.current=n}}catch(i){fd(e,t,i)}}function fc(e,t){var a=e.ref,n=e.refCleanup;if(null!==a)if("function"==typeof n)try{n()}catch(i){fd(e,t,i)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof a)try{a(null)}catch(r){fd(e,t,r)}else a.current=null}function vc(e){var t=e.type,a=e.memoizedProps,n=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&n.focus();break e;case"img":a.src?n.src=a.src:a.srcSet&&(n.srcset=a.srcSet)}}catch(i){fd(e,e.return,i)}}function yc(e,t,a){try{var n=e.stateNode;!function(e,t,a,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var i=null,s=null,l=null,c=null,o=null,d=null,h=null;for(p in a){var u=a[p];if(a.hasOwnProperty(p)&&null!=u)switch(p){case"checked":case"value":break;case"defaultValue":o=u;default:n.hasOwnProperty(p)||nh(e,t,p,null,n,u)}}for(var m in n){var p=n[m];if(u=a[m],n.hasOwnProperty(m)&&(null!=p||null!=u))switch(m){case"type":s=p;break;case"name":i=p;break;case"checked":d=p;break;case"defaultChecked":h=p;break;case"value":l=p;break;case"defaultValue":c=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(r(137,t));break;default:p!==u&&nh(e,t,m,p,n,u)}}return void wt(e,l,c,o,d,h,s,i);case"select":for(s in p=l=c=m=null,a)if(o=a[s],a.hasOwnProperty(s)&&null!=o)switch(s){case"value":break;case"multiple":p=o;default:n.hasOwnProperty(s)||nh(e,t,s,null,n,o)}for(i in n)if(s=n[i],o=a[i],n.hasOwnProperty(i)&&(null!=s||null!=o))switch(i){case"value":m=s;break;case"defaultValue":c=s;break;case"multiple":l=s;default:s!==o&&nh(e,t,i,s,n,o)}return t=c,a=l,n=p,void(null!=m?Ct(e,!!a,m,!1):!!n!=!!a&&(null!=t?Ct(e,!!a,t,!0):Ct(e,!!a,a?[]:"",!1)));case"textarea":for(c in p=m=null,a)if(i=a[c],a.hasOwnProperty(c)&&null!=i&&!n.hasOwnProperty(c))switch(c){case"value":case"children":break;default:nh(e,t,c,null,n,i)}for(l in n)if(i=n[l],s=a[l],n.hasOwnProperty(l)&&(null!=i||null!=s))switch(l){case"value":m=i;break;case"defaultValue":p=i;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=i)throw Error(r(91));break;default:i!==s&&nh(e,t,l,i,n,s)}return void At(e,m,p);case"option":for(var f in a)m=a[f],a.hasOwnProperty(f)&&null!=m&&!n.hasOwnProperty(f)&&("selected"===f?e.selected=!1:nh(e,t,f,null,n,m));for(o in n)m=n[o],p=a[o],!n.hasOwnProperty(o)||m===p||null==m&&null==p||("selected"===o?e.selected=m&&"function"!=typeof m&&"symbol"!=typeof m:nh(e,t,o,m,n,p));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var v in a)m=a[v],a.hasOwnProperty(v)&&null!=m&&!n.hasOwnProperty(v)&&nh(e,t,v,null,n,m);for(d in n)if(m=n[d],p=a[d],n.hasOwnProperty(d)&&m!==p&&(null!=m||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=m)throw Error(r(137,t));break;default:nh(e,t,d,m,n,p)}return;default:if(Ft(t)){for(var y in a)m=a[y],a.hasOwnProperty(y)&&void 0!==m&&!n.hasOwnProperty(y)&&ih(e,t,y,void 0,n,m);for(h in n)m=n[h],p=a[h],!n.hasOwnProperty(h)||m===p||void 0===m&&void 0===p||ih(e,t,h,m,n,p);return}}for(var g in a)m=a[g],a.hasOwnProperty(g)&&null!=m&&!n.hasOwnProperty(g)&&nh(e,t,g,null,n,m);for(u in n)m=n[u],p=a[u],!n.hasOwnProperty(u)||m===p||null==m&&null==p||nh(e,t,u,m,n,p)}(n,e.type,a,t),n[Oe]=t}catch(i){fd(e,e.return,i)}}function gc(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&gh(e.type)||4===e.tag}function bc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||gc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&gh(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Nc(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?(9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).insertBefore(e,t):((t=9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).appendChild(e),null!=(a=a.O)||null!==t.onclick||(t.onclick=ah));else if(4!==n&&(27===n&&gh(e.type)&&(a=e.stateNode,t=null),null!==(e=e.child)))for(Nc(e,t,a),e=e.sibling;null!==e;)Nc(e,t,a),e=e.sibling}function wc(e,t,a){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==n&&(27===n&&gh(e.type)&&(a=e.stateNode),null!==(e=e.child)))for(wc(e,t,a),e=e.sibling;null!==e;)wc(e,t,a),e=e.sibling}function kc(e){var t=e.stateNode,a=e.memoizedProps;try{for(var n=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);rh(t,n,a),t[Re]=e,t[Oe]=a}catch(r){fd(e,e.return,r)}}var xc=!1,Cc=!1,Ac=!1,_c="function"==typeof WeakSet?WeakSet:Set,Sc=null;function Pc(e,t,a){var n=a.flags;switch(a.tag){case 0:case 11:case 15:Dc(e,a),4&n&&dc(5,a);break;case 1:if(Dc(e,a),4&n)if(e=a.stateNode,null===t)try{e.componentDidMount()}catch(s){fd(a,a.return,s)}else{var i=Nl(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.B)}catch(l){fd(a,a.return,l)}}64&n&&uc(a),512&n&&pc(a,a.return);break;case 3:if(Dc(e,a),64&n&&null!==(e=a.updateQueue)){if(t=null,null!==a.child)switch(a.child.tag){case 27:case 5:case 1:t=a.child.stateNode}try{yr(e,t)}catch(s){fd(a,a.return,s)}}break;case 27:null===t&&4&n&&kc(a);case 26:case 5:Dc(e,a),null===t&&4&n&&vc(a),512&n&&pc(a,a.return);break;case 12:Dc(e,a);break;case 13:Dc(e,a),4&n&&Mc(e,a),64&n&&null!==(e=a.memoizedState)&&null!==(e=e.dehydrated)&&function(e,t){var a=e.ownerDocument;if("$?"!==e.data||"complete"===a.readyState)t();else{var n=function(){t(),a.removeEventListener("DOMContentLoaded",n)};a.addEventListener("DOMContentLoaded",n),e.j=n}}(e,a=bd.bind(null,a));break;case 22:if(!(n=null!==a.memoizedState||xc)){t=null!==t&&null!==t.memoizedState||Cc,i=xc;var r=Cc;xc=n,(Cc=t)&&!r?Xc(e,a,!!(8772&a.subtreeFlags)):Dc(e,a),xc=i,Cc=r}break;case 30:break;default:Dc(e,a)}}function Tc(e){var t=e.alternate;null!==t&&(e.alternate=null,Tc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&null!==(t=e.stateNode)&&He(t),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var $c=null,Fc=!1;function Ec(e,t,a){for(a=a.child;null!==a;)Ic(e,t,a),a=a.sibling}function Ic(e,t,a){if(ve&&"function"==typeof ve.onCommitFiberUnmount)try{ve.onCommitFiberUnmount(fe,a)}catch(r){}switch(a.tag){case 26:Cc||fc(a,t),Ec(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode).parentNode.removeChild(a);break;case 27:Cc||fc(a,t);var n=$c,i=Fc;gh(a.type)&&($c=a.stateNode,Fc=!1),Ec(e,t,a),_h(a.stateNode),$c=n,Fc=i;break;case 5:Cc||fc(a,t);case 6:if(n=$c,i=Fc,$c=null,Ec(e,t,a),Fc=i,null!==($c=n))if(Fc)try{(9===$c.nodeType?$c.body:"HTML"===$c.nodeName?$c.ownerDocument.body:$c).removeChild(a.stateNode)}catch(s){fd(a,t,s)}else try{$c.removeChild(a.stateNode)}catch(s){fd(a,t,s)}break;case 18:null!==$c&&(Fc?(bh(9===(e=$c).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,a.stateNode),Eu(e)):bh($c,a.stateNode));break;case 4:n=$c,i=Fc,$c=a.stateNode.containerInfo,Fc=!0,Ec(e,t,a),$c=n,Fc=i;break;case 0:case 11:case 14:case 15:Cc||hc(2,a,t),Cc||hc(4,a,t),Ec(e,t,a);break;case 1:Cc||(fc(a,t),"function"==typeof(n=a.stateNode).componentWillUnmount&&mc(a,t,n)),Ec(e,t,a);break;case 21:Ec(e,t,a);break;case 22:Cc=(n=Cc)||null!==a.memoizedState,Ec(e,t,a),Cc=n;break;default:Ec(e,t,a)}}function Mc(e,t){if(null===t.memoizedState&&null!==(e=t.alternate)&&null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))try{Eu(e)}catch(a){fd(t,t.return,a)}}function Lc(e,t){var a=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new _c),t;case 22:return null===(t=(e=e.stateNode).W)&&(t=e.W=new _c),t;default:throw Error(r(435,e.tag))}}(e);t.forEach(function(t){var n=Nd.bind(null,e,t);a.has(t)||(a.add(t),t.then(n,n))})}function Wc(e,t){var a=t.deletions;if(null!==a)for(var n=0;n<a.length;n++){var i=a[n],s=e,l=t,c=l;e:for(;null!==c;){switch(c.tag){case 27:if(gh(c.type)){$c=c.stateNode,Fc=!1;break e}break;case 5:$c=c.stateNode,Fc=!1;break e;case 3:case 4:$c=c.stateNode.containerInfo,Fc=!0;break e}c=c.return}if(null===$c)throw Error(r(160));Ic(s,l,i),$c=null,Fc=!1,null!==(s=i.alternate)&&(s.return=null),i.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Oc(t,e),t=t.sibling}var Rc=null;function Oc(e,t){var a=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Wc(t,e),Bc(e),4&n&&(hc(3,e,e.return),dc(3,e),hc(5,e,e.return));break;case 1:Wc(t,e),Bc(e),512&n&&(Cc||null===a||fc(a,a.return)),64&n&&xc&&null!==(e=e.updateQueue)&&null!==(n=e.callbacks)&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===a?n:a.concat(n));break;case 26:var i=Rc;if(Wc(t,e),Bc(e),512&n&&(Cc||null===a||fc(a,a.return)),4&n){var s=null!==a?a.memoizedState:null;if(n=e.memoizedState,null===a)if(null===n)if(null===e.stateNode){e:{n=e.type,a=e.memoizedProps,i=i.ownerDocument||i;t:switch(n){case"title":(!(s=i.getElementsByTagName("title")[0])||s[ze]||s[Re]||"http://www.w3.org/2000/svg"===s.namespaceURI||s.hasAttribute("itemprop"))&&(s=i.createElement(n),i.head.insertBefore(s,i.querySelector("head > title"))),rh(s,n,a),s[Re]=e,Ye(s),n=s;break e;case"link":var l=zh("link","href",i).get(n+(a.href||""));if(l)for(var c=0;c<l.length;c++)if((s=l[c]).getAttribute("href")===(null==a.href||""===a.href?null:a.href)&&s.getAttribute("rel")===(null==a.rel?null:a.rel)&&s.getAttribute("title")===(null==a.title?null:a.title)&&s.getAttribute("crossorigin")===(null==a.crossOrigin?null:a.crossOrigin)){l.splice(c,1);break t}rh(s=i.createElement(n),n,a),i.head.appendChild(s);break;case"meta":if(l=zh("meta","content",i).get(n+(a.content||"")))for(c=0;c<l.length;c++)if((s=l[c]).getAttribute("content")===(null==a.content?null:""+a.content)&&s.getAttribute("name")===(null==a.name?null:a.name)&&s.getAttribute("property")===(null==a.property?null:a.property)&&s.getAttribute("http-equiv")===(null==a.httpEquiv?null:a.httpEquiv)&&s.getAttribute("charset")===(null==a.charSet?null:a.charSet)){l.splice(c,1);break t}rh(s=i.createElement(n),n,a),i.head.appendChild(s);break;default:throw Error(r(468,n))}s[Re]=e,Ye(s),n=s}e.stateNode=n}else Hh(i,e.type,e.stateNode);else e.stateNode=Bh(i,n,e.memoizedProps);else s!==n?(null===s?null!==a.stateNode&&(a=a.stateNode).parentNode.removeChild(a):s.count--,null===n?Hh(i,e.type,e.stateNode):Bh(i,n,e.memoizedProps)):null===n&&null!==e.stateNode&&yc(e,e.memoizedProps,a.memoizedProps)}break;case 27:Wc(t,e),Bc(e),512&n&&(Cc||null===a||fc(a,a.return)),null!==a&&4&n&&yc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Wc(t,e),Bc(e),512&n&&(Cc||null===a||fc(a,a.return)),32&e.flags){i=e.stateNode;try{St(i,"")}catch(p){fd(e,e.return,p)}}4&n&&null!=e.stateNode&&yc(e,i=e.memoizedProps,null!==a?a.memoizedProps:i),1024&n&&(Ac=!0);break;case 6:if(Wc(t,e),Bc(e),4&n){if(null===e.stateNode)throw Error(r(162));n=e.memoizedProps,a=e.stateNode;try{a.nodeValue=n}catch(p){fd(e,e.return,p)}}break;case 3:if(Xh=null,i=Rc,Rc=Th(t.containerInfo),Wc(t,e),Rc=i,Bc(e),4&n&&null!==a&&a.memoizedState.isDehydrated)try{Eu(t.containerInfo)}catch(p){fd(e,e.return,p)}Ac&&(Ac=!1,jc(e));break;case 4:n=Rc,Rc=Th(e.stateNode.containerInfo),Wc(t,e),Bc(e),Rc=n;break;case 12:default:Wc(t,e),Bc(e);break;case 13:Wc(t,e),Bc(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==a&&null!==a.memoizedState)&&(_o=se()),4&n&&null!==(n=e.updateQueue)&&(e.updateQueue=null,Lc(e,n));break;case 22:i=null!==e.memoizedState;var o=null!==a&&null!==a.memoizedState,d=xc,h=Cc;if(xc=d||i,Cc=h||o,Wc(t,e),Cc=h,xc=d,Bc(e),8192&n)e:for(t=e.stateNode,t._=i?-2&t._:1|t._,i&&(null===a||o||xc||Cc||Uc(e)),a=null,t=e;;){if(5===t.tag||26===t.tag){if(null===a){o=a=t;try{if(s=o.stateNode,i)"function"==typeof(l=s.style).setProperty?l.setProperty("display","none","important"):l.display="none";else{c=o.stateNode;var u=o.memoizedProps.style,m=null!=u&&u.hasOwnProperty("display")?u.display:null;c.style.display=null==m||"boolean"==typeof m?"":(""+m).trim()}}catch(p){fd(o,o.return,p)}}}else if(6===t.tag){if(null===a){o=t;try{o.stateNode.nodeValue=i?"":o.memoizedProps}catch(p){fd(o,o.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}4&n&&null!==(n=e.updateQueue)&&null!==(a=n.retryQueue)&&(n.retryQueue=null,Lc(e,a));break;case 19:Wc(t,e),Bc(e),4&n&&null!==(n=e.updateQueue)&&(e.updateQueue=null,Lc(e,n));case 30:case 21:}}function Bc(e){var t=e.flags;if(2&t){try{for(var a,n=e.return;null!==n;){if(gc(n)){a=n;break}n=n.return}if(null==a)throw Error(r(160));switch(a.tag){case 27:var i=a.stateNode;wc(e,bc(e),i);break;case 5:var s=a.stateNode;32&a.flags&&(St(s,""),a.flags&=-33),wc(e,bc(e),s);break;case 3:case 4:var l=a.stateNode.containerInfo;Nc(e,bc(e),l);break;default:throw Error(r(161))}}catch(c){fd(e,e.return,c)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function jc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;jc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Dc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Pc(e,t.alternate,t),t=t.sibling}function Uc(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:hc(4,t,t.return),Uc(t);break;case 1:fc(t,t.return);var a=t.stateNode;"function"==typeof a.componentWillUnmount&&mc(t,t.return,a),Uc(t);break;case 27:_h(t.stateNode);case 26:case 5:fc(t,t.return),Uc(t);break;case 22:null===t.memoizedState&&Uc(t);break;default:Uc(t)}e=e.sibling}}function Xc(e,t,a){for(a=a&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var n=t.alternate,i=e,r=t,s=r.flags;switch(r.tag){case 0:case 11:case 15:Xc(i,r,a),dc(4,r);break;case 1:if(Xc(i,r,a),"function"==typeof(i=(n=r).stateNode).componentDidMount)try{i.componentDidMount()}catch(o){fd(n,n.return,o)}if(null!==(i=(n=r).updateQueue)){var l=n.stateNode;try{var c=i.shared.hiddenCallbacks;if(null!==c)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)vr(c[i],l)}catch(o){fd(n,n.return,o)}}a&&64&s&&uc(r),pc(r,r.return);break;case 27:kc(r);case 26:case 5:Xc(i,r,a),a&&null===n&&4&s&&vc(r),pc(r,r.return);break;case 12:Xc(i,r,a);break;case 13:Xc(i,r,a),a&&4&s&&Mc(i,r);break;case 22:null===r.memoizedState&&Xc(i,r,a),pc(r,r.return);break;case 30:break;default:Xc(i,r,a)}t=t.sibling}}function zc(e,t){var a=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==a&&(null!=e&&e.refCount++,null!=a&&Bi(a))}function Hc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Bi(e))}function Jc(e,t,a,n){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)qc(e,t,a,n),t=t.sibling}function qc(e,t,a,n){var i=t.flags;switch(t.tag){case 0:case 11:case 15:Jc(e,t,a,n),2048&i&&dc(9,t);break;case 1:case 13:default:Jc(e,t,a,n);break;case 3:Jc(e,t,a,n),2048&i&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Bi(e)));break;case 12:if(2048&i){Jc(e,t,a,n),e=t.stateNode;try{var r=t.memoizedProps,s=r.id,l=r.onPostCommit;"function"==typeof l&&l(s,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(c){fd(t,t.return,c)}}else Jc(e,t,a,n);break;case 23:break;case 22:r=t.stateNode,s=t.alternate,null!==t.memoizedState?2&r._?Jc(e,t,a,n):Gc(e,t):2&r._?Jc(e,t,a,n):(r._|=2,Vc(e,t,a,n,!!(10256&t.subtreeFlags))),2048&i&&zc(s,t);break;case 24:Jc(e,t,a,n),2048&i&&Hc(t.alternate,t)}}function Vc(e,t,a,n,i){for(i=i&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var r=e,s=t,l=a,c=n,o=s.flags;switch(s.tag){case 0:case 11:case 15:Vc(r,s,l,c,i),dc(8,s);break;case 23:break;case 22:var d=s.stateNode;null!==s.memoizedState?2&d._?Vc(r,s,l,c,i):Gc(r,s):(d._|=2,Vc(r,s,l,c,i)),i&&2048&o&&zc(s.alternate,s);break;case 24:Vc(r,s,l,c,i),i&&2048&o&&Hc(s.alternate,s);break;default:Vc(r,s,l,c,i)}t=t.sibling}}function Gc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var a=e,n=t,i=n.flags;switch(n.tag){case 22:Gc(a,n),2048&i&&zc(n.alternate,n);break;case 24:Gc(a,n),2048&i&&Hc(n.alternate,n);break;default:Gc(a,n)}t=t.sibling}}var Yc=8192;function Kc(e){if(e.subtreeFlags&Yc)for(e=e.child;null!==e;)Qc(e),e=e.sibling}function Qc(e){switch(e.tag){case 26:Kc(e),e.flags&Yc&&null!==e.memoizedState&&function(e,t,a){if(null===qh)throw Error(r(475));var n=qh;if(!("stylesheet"!==t.type||"string"==typeof a.media&&!1===matchMedia(a.media).matches||4&t.state.loading)){if(null===t.instance){var i=Mh(a.href),s=e.querySelector(Lh(i));if(s)return null!==(e=s.U)&&"object"==typeof e&&"function"==typeof e.then&&(n.count++,n=Gh.bind(n),e.then(n,n)),t.state.loading|=4,t.instance=s,void Ye(s);s=e.ownerDocument||e,a=Wh(a),(i=Sh.get(i))&&Dh(a,i),Ye(s=s.createElement("link"));var l=s;l.U=new Promise(function(e,t){l.onload=e,l.onerror=t}),rh(s,"link",a),t.instance=s}null===n.stylesheets&&(n.stylesheets=new Map),n.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(n.count++,t=Gh.bind(n),e.addEventListener("load",t),e.addEventListener("error",t))}}(Rc,e.memoizedState,e.memoizedProps);break;case 5:default:Kc(e);break;case 3:case 4:var t=Rc;Rc=Th(e.stateNode.containerInfo),Kc(e),Rc=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Yc,Yc=16777216,Kc(e),Yc=t):Kc(e))}}function Zc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function eo(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var a=0;a<t.length;a++){var n=t[a];Sc=n,no(n,e)}Zc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)to(e),e=e.sibling}function to(e){switch(e.tag){case 0:case 11:case 15:eo(e),2048&e.flags&&hc(9,e,e.return);break;case 3:case 12:default:eo(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._&&(null===e.return||13!==e.return.tag)?(t._&=-3,ao(e)):eo(e)}}function ao(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var a=0;a<t.length;a++){var n=t[a];Sc=n,no(n,e)}Zc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:hc(8,t,t.return),ao(t);break;case 22:2&(a=t.stateNode)._&&(a._&=-3,ao(t));break;default:ao(t)}e=e.sibling}}function no(e,t){for(;null!==Sc;){var a=Sc;switch(a.tag){case 0:case 11:case 15:hc(8,a,t);break;case 23:case 22:if(null!==a.memoizedState&&null!==a.memoizedState.cachePool){var n=a.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Bi(a.memoizedState.cache)}if(null!==(n=a.child))n.return=a,Sc=n;else e:for(a=e;null!==Sc;){var i=(n=Sc).sibling,r=n.return;if(Tc(n),n===a){Sc=null;break e}if(null!==i){i.return=r,Sc=i;break e}Sc=r}}}var io={getCacheForType:function(e){var t=Fi(Ri),a=t.data.get(e);return void 0===a&&(a=e(),t.data.set(e,a)),a}},ro="function"==typeof WeakMap?WeakMap:Map,so=0,lo=null,co=null,oo=0,ho=0,uo=null,mo=!1,po=!1,fo=!1,vo=0,yo=0,go=0,bo=0,No=0,wo=0,ko=0,xo=null,Co=null,Ao=!1,_o=0,So=1/0,Po=null,To=null,$o=0,Fo=null,Eo=null,Io=0,Mo=0,Lo=null,Wo=null,Ro=0,Oo=null;function Bo(){return 2&so&&0!==oo?oo&-oo:null!==I.T?0!==Ui?Ui:Md():Le()}function jo(){0===wo&&(wo=536870912&oo&&!di?536870912:Se());var e=cl.current;return null!==e&&(e.flags|=32),wo}function Do(e,t,a){(e!==lo||2!==ho&&9!==ho)&&null===e.cancelPendingCommit||(Vo(e,0),Ho(e,oo,wo,!1)),$e(e,a),2&so&&e===lo||(e===lo&&(!(2&so)&&(bo|=a),4===yo&&Ho(e,oo,wo,!1)),Sd(e))}function Uo(e,t,a){if(6&so)throw Error(r(327));for(var n=!a&&!(124&t)&&0===(t&e.expiredLanes)||Ae(e,t),i=n?function(e,t){var a=so;so|=2;var n=Yo(),i=Ko();lo!==e||oo!==t?(Po=null,So=se()+500,Vo(e,t)):po=Ae(e,t);e:for(;;)try{if(0!==ho&&null!==co){t=co;var s=uo;t:switch(ho){case 1:ho=0,uo=null,id(e,t,s,1);break;case 2:case 9:if(er(s)){ho=0,uo=null,nd(t);break}t=function(){2!==ho&&9!==ho||lo!==e||(ho=7),Sd(e)},s.then(t,t);break e;case 3:ho=7;break e;case 4:ho=5;break e;case 7:er(s)?(ho=0,uo=null,nd(t)):(ho=0,uo=null,id(e,t,s,7));break;case 5:var l=null;switch(co.tag){case 26:l=co.memoizedState;case 5:case 27:var c=co;if(!l||Jh(l)){ho=0,uo=null;var o=c.sibling;if(null!==o)co=o;else{var d=c.return;null!==d?(co=d,rd(d)):co=null}break t}}ho=0,uo=null,id(e,t,s,5);break;case 6:ho=0,uo=null,id(e,t,s,6);break;case 8:qo(),yo=6;break e;default:throw Error(r(462))}}td();break}catch(h){Go(e,h)}return xi=ki=null,I.H=n,I.A=i,so=a,null!==co?0:(lo=null,oo=0,In(),yo)}(e,t):Zo(e,t,!0),s=n;;){if(0===i){po&&!n&&Ho(e,t,0,!1);break}if(a=e.current.alternate,!s||zo(a)){if(2===i){if(s=t,e.errorRecoveryDisabledLanes&s)var l=0;else l=0!=(l=-536870913&e.pendingLanes)?l:536870912&l?536870912:0;if(0!==l){t=l;e:{var c=e;i=xo;var o=c.current.memoizedState.isDehydrated;if(o&&(Vo(c,l).flags|=256),2!==(l=Zo(c,l,!1))){if(fo&&!o){c.errorRecoveryDisabledLanes|=s,bo|=s,i=4;break e}s=Co,Co=i,null!==s&&(null===Co?Co=s:Co.push.apply(Co,s))}i=l}if(s=!1,2!==i)continue}}if(1===i){Vo(e,0),Ho(e,t,0,!0);break}e:{switch(n=e,s=i){case 0:case 1:throw Error(r(345));case 4:if((4194048&t)!==t)break;case 6:Ho(n,t,wo,!mo);break e;case 2:Co=null;break;case 3:case 5:break;default:throw Error(r(329))}if((62914560&t)===t&&10<(i=_o+300-se())){if(Ho(n,t,wo,!mo),0!==Ce(n,0,!0))break e;n.timeoutHandle=mh(Xo.bind(null,n,a,Co,Po,Ao,t,wo,bo,ko,mo,s,2,-0,0),i)}else Xo(n,a,Co,Po,Ao,t,wo,bo,ko,mo,s,0,-0,0)}break}i=Zo(e,t,!1),s=!1}Sd(e)}function Xo(e,t,a,n,i,s,l,c,o,d,h,u,m,p){if(e.timeoutHandle=-1,(8192&(u=t.subtreeFlags)||!(16785408&~u))&&(qh={stylesheets:null,count:0,unsuspend:Vh},Qc(t),null!==(u=function(){if(null===qh)throw Error(r(475));var e=qh;return e.stylesheets&&0===e.count&&Kh(e,e.stylesheets),0<e.count?function(t){var a=setTimeout(function(){if(e.stylesheets&&Kh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(a)}}:null}())))return e.cancelPendingCommit=u(ld.bind(null,e,t,s,a,n,i,l,c,o,h,1,m,p)),void Ho(e,s,l,!d);ld(e,t,s,a,n,i,l,c,o)}function zo(e){for(var t=e;;){var a=t.tag;if((0===a||11===a||15===a)&&16384&t.flags&&null!==(a=t.updateQueue)&&null!==(a=a.stores))for(var n=0;n<a.length;n++){var i=a[n],r=i.getSnapshot;i=i.value;try{if(!Za(r(),i))return!1}catch(s){return!1}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Ho(e,t,a,n){t&=~No,t&=~bo,e.suspendedLanes|=t,e.pingedLanes&=~t,n&&(e.warmLanes|=t),n=e.expirationTimes;for(var i=t;0<i;){var r=31-ge(i),s=1<<r;n[r]=-1,i&=~s}0!==a&&Fe(e,a,t)}function Jo(){return!!(6&so)||(Pd(0),!1)}function qo(){if(null!==co){if(0===ho)var e=co.return;else xi=ki=null,Ur(e=co),Zs=null,el=0,e=co;for(;null!==e;)oc(e.alternate,e),e=e.return;co=null}}function Vo(e,t){var a=e.timeoutHandle;-1!==a&&(e.timeoutHandle=-1,ph(a)),null!==(a=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,a()),qo(),lo=e,co=a=Xn(e.current,null),oo=t,ho=0,uo=null,mo=!1,po=Ae(e,t),fo=!1,ko=wo=No=bo=go=yo=0,Co=xo=null,Ao=!1,8&t&&(t|=32&t);var n=e.entangledLanes;if(0!==n)for(e=e.entanglements,n&=t;0<n;){var i=31-ge(n),r=1<<i;t|=e[i],n&=~r}return vo=t,In(),a}function Go(e,t){Cr=null,I.H=Gs,t===Yi||t===Qi?(t=ir(),ho=3):t===Ki?(t=ir(),ho=4):ho=t===$l?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,uo=t,null===co&&(yo=1,Al(e,Tn(t,e.current)))}function Yo(){var e=I.H;return I.H=Gs,null===e?Gs:e}function Ko(){var e=I.A;return I.A=io,e}function Qo(){yo=4,mo||(4194048&oo)!==oo&&null!==cl.current||(po=!0),!(134217727&go)&&!(134217727&bo)||null===lo||Ho(lo,oo,wo,!1)}function Zo(e,t,a){var n=so;so|=2;var i=Yo(),r=Ko();lo===e&&oo===t||(Po=null,Vo(e,t)),t=!1;var s=yo;e:for(;;)try{if(0!==ho&&null!==co){var l=co,c=uo;switch(ho){case 8:qo(),s=6;break e;case 3:case 2:case 9:case 6:null===cl.current&&(t=!0);var o=ho;if(ho=0,uo=null,id(e,l,c,o),a&&po){s=0;break e}break;default:o=ho,ho=0,uo=null,id(e,l,c,o)}}ed(),s=yo;break}catch(d){Go(e,d)}return t&&e.shellSuspendCounter++,xi=ki=null,so=n,I.H=i,I.A=r,null===co&&(lo=null,oo=0,In()),s}function ed(){for(;null!==co;)ad(co)}function td(){for(;null!==co&&!ie();)ad(co)}function ad(e){var t=tc(e.alternate,e,vo);e.memoizedProps=e.pendingProps,null===t?rd(e):co=t}function nd(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=jl(a,t,t.pendingProps,t.type,void 0,oo);break;case 11:t=jl(a,t,t.pendingProps,t.type.render,t.ref,oo);break;case 5:Ur(t);default:oc(a,t),t=tc(a,t=co=zn(t,vo),vo)}e.memoizedProps=e.pendingProps,null===t?rd(e):co=t}function id(e,t,a,n){xi=ki=null,Ur(t),Zs=null,el=0;var i=t.return;try{if(function(e,t,a,n,i){if(a.flags|=32768,null!==n&&"object"==typeof n&&"function"==typeof n.then){if(null!==(t=a.alternate)&&Pi(t,a,i,!0),null!==(a=cl.current)){switch(a.tag){case 13:return null===ol?Qo():null===a.alternate&&0===yo&&(yo=3),a.flags&=-257,a.flags|=65536,a.lanes=i,n===Zi?a.flags|=16384:(null===(t=a.updateQueue)?a.updateQueue=new Set([n]):t.add(n),vd(e,n,i)),!1;case 22:return a.flags|=65536,n===Zi?a.flags|=16384:(null===(t=a.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([n])},a.updateQueue=t):null===(a=t.retryQueue)?t.retryQueue=new Set([n]):a.add(n),vd(e,n,i)),!1}throw Error(r(435,a.tag))}return vd(e,n,i),Qo(),!1}if(di)return null!==(t=cl.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=i,n!==mi&&Ni(Tn(e=Error(r(422),{cause:n}),a))):(n!==mi&&Ni(Tn(t=Error(r(423),{cause:n}),a)),(e=e.current.alternate).flags|=65536,i&=-i,e.lanes|=i,n=Tn(n,a),ur(e,i=Sl(e.stateNode,n,i)),4!==yo&&(yo=2)),!1;var s=Error(r(520),{cause:n});if(s=Tn(s,a),null===xo?xo=[s]:xo.push(s),4!==yo&&(yo=2),null===t)return!0;n=Tn(n,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=i&-i,a.lanes|=e,ur(a,e=Sl(a.stateNode,n,e)),!1;case 1:if(t=a.type,s=a.stateNode,!(128&a.flags||"function"!=typeof t.getDerivedStateFromError&&(null===s||"function"!=typeof s.componentDidCatch||null!==To&&To.has(s))))return a.flags|=65536,i&=-i,a.lanes|=i,Tl(i=Pl(i),e,a,n),ur(a,i),!1}a=a.return}while(null!==a);return!1}(e,i,t,a,oo))return yo=1,Al(e,Tn(a,e.current)),void(co=null)}catch(s){if(null!==i)throw co=i,s;return yo=1,Al(e,Tn(a,e.current)),void(co=null)}32768&t.flags?(di||1===n?e=!0:po||536870912&oo?e=!1:(mo=e=!0,(2===n||9===n||3===n||6===n)&&null!==(n=cl.current)&&13===n.tag&&(n.flags|=16384)),sd(t,e)):rd(t)}function rd(e){var t=e;do{if(32768&t.flags)return void sd(t,mo);e=t.return;var a=lc(t.alternate,t,vo);if(null!==a)return void(co=a);if(null!==(t=t.sibling))return void(co=t);co=t=e}while(null!==t);0===yo&&(yo=5)}function sd(e,t){do{var a=cc(e.alternate,e);if(null!==a)return a.flags&=32767,void(co=a);if(null!==(a=e.return)&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&null!==(e=e.sibling))return void(co=e);co=e=a}while(null!==e);yo=6,co=null}function ld(e,t,a,n,i,s,l,c,o){e.cancelPendingCommit=null;do{ud()}while(0!==$o);if(6&so)throw Error(r(327));if(null!==t){if(t===e.current)throw Error(r(177));if(s=t.lanes|t.childLanes,function(e,t,a,n,i,r){var s=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var l=e.entanglements,c=e.expirationTimes,o=e.hiddenUpdates;for(a=s&~a;0<a;){var d=31-ge(a),h=1<<d;l[d]=0,c[d]=-1;var u=o[d];if(null!==u)for(o[d]=null,d=0;d<u.length;d++){var m=u[d];null!==m&&(m.lane&=-536870913)}a&=~h}0!==n&&Fe(e,n,0),0!==r&&0===i&&0!==e.tag&&(e.suspendedLanes|=r&~(s&~t))}(e,a,s|=En,l,c,o),e===lo&&(co=lo=null,oo=0),Eo=t,Fo=e,Io=a,Mo=s,Lo=i,Wo=n,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,ae(de,function(){return md(),null})):(e.callbackNode=null,e.callbackPriority=0),n=!!(13878&t.flags),13878&t.subtreeFlags||n){n=I.T,I.T=null,i=M.p,M.p=2,l=so,so|=4;try{!function(e,t){if(e=e.containerInfo,sh=lu,sn(e=rn(e))){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(a=(a=e.ownerDocument)&&a.defaultView||window).getSelection&&a.getSelection();if(n&&0!==n.rangeCount){a=n.anchorNode;var i=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{a.nodeType,s.nodeType}catch(v){a=null;break e}var l=0,c=-1,o=-1,d=0,h=0,u=e,m=null;t:for(;;){for(var p;u!==a||0!==i&&3!==u.nodeType||(c=l+i),u!==s||0!==n&&3!==u.nodeType||(o=l+n),3===u.nodeType&&(l+=u.nodeValue.length),null!==(p=u.firstChild);)m=u,u=p;for(;;){if(u===e)break t;if(m===a&&++d===i&&(c=l),m===s&&++h===n&&(o=l),null!==(p=u.nextSibling))break;m=(u=m).parentNode}u=p}a=-1===c||-1===o?null:{start:c,end:o}}else a=null}a=a||{start:0,end:0}}else a=null;for(lh={focusedElem:e,selectionRange:a},lu=!1,Sc=t;null!==Sc;)if(e=(t=Sc).child,1024&t.subtreeFlags&&null!==e)e.return=t,Sc=e;else for(;null!==Sc;){switch(s=(t=Sc).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==s){e=void 0,a=t,i=s.memoizedProps,s=s.memoizedState,n=a.stateNode;try{var f=Nl(a.type,i,(a.elementType,a.type));e=n.getSnapshotBeforeUpdate(f,s),n.B=e}catch(y){fd(a,a.return,y)}}break;case 3:if(1024&e)if(9===(a=(e=t.stateNode.containerInfo).nodeType))Nh(e);else if(1===a)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Nh(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(r(163))}if(null!==(e=t.sibling)){e.return=t.return,Sc=e;break}Sc=t.return}}(e,t)}finally{so=l,M.p=i,I.T=n}}$o=1,cd(),od(),dd()}}function cd(){if(1===$o){$o=0;var e=Fo,t=Eo,a=!!(13878&t.flags);if(13878&t.subtreeFlags||a){a=I.T,I.T=null;var n=M.p;M.p=2;var i=so;so|=4;try{Oc(t,e);var r=lh,s=rn(e.containerInfo),l=r.focusedElem,c=r.selectionRange;if(s!==l&&l&&l.ownerDocument&&nn(l.ownerDocument.documentElement,l)){if(null!==c&&sn(l)){var o=c.start,d=c.end;if(void 0===d&&(d=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(d,l.value.length);else{var h=l.ownerDocument||document,u=h&&h.defaultView||window;if(u.getSelection){var m=u.getSelection(),p=l.textContent.length,f=Math.min(c.start,p),v=void 0===c.end?f:Math.min(c.end,p);!m.extend&&f>v&&(s=v,v=f,f=s);var y=an(l,f),g=an(l,v);if(y&&g&&(1!==m.rangeCount||m.anchorNode!==y.node||m.anchorOffset!==y.offset||m.focusNode!==g.node||m.focusOffset!==g.offset)){var b=h.createRange();b.setStart(y.node,y.offset),m.removeAllRanges(),f>v?(m.addRange(b),m.extend(g.node,g.offset)):(b.setEnd(g.node,g.offset),m.addRange(b))}}}}for(h=[],m=l;m=m.parentNode;)1===m.nodeType&&h.push({element:m,left:m.scrollLeft,top:m.scrollTop});for("function"==typeof l.focus&&l.focus(),l=0;l<h.length;l++){var N=h[l];N.element.scrollLeft=N.left,N.element.scrollTop=N.top}}lu=!!sh,lh=sh=null}finally{so=i,M.p=n,I.T=a}}e.current=t,$o=2}}function od(){if(2===$o){$o=0;var e=Fo,t=Eo,a=!!(8772&t.flags);if(8772&t.subtreeFlags||a){a=I.T,I.T=null;var n=M.p;M.p=2;var i=so;so|=4;try{Pc(e,t.alternate,t)}finally{so=i,M.p=n,I.T=a}}$o=3}}function dd(){if(4===$o||3===$o){$o=0,re();var e=Fo,t=Eo,a=Io,n=Wo;10256&t.subtreeFlags||10256&t.flags?$o=5:($o=0,Eo=Fo=null,hd(e,e.pendingLanes));var i=e.pendingLanes;if(0===i&&(To=null),Me(a),t=t.stateNode,ve&&"function"==typeof ve.onCommitFiberRoot)try{ve.onCommitFiberRoot(fe,t,void 0,!(128&~t.current.flags))}catch(c){}if(null!==n){t=I.T,i=M.p,M.p=2,I.T=null;try{for(var r=e.onRecoverableError,s=0;s<n.length;s++){var l=n[s];r(l.value,{componentStack:l.stack})}}finally{I.T=t,M.p=i}}3&Io&&ud(),Sd(e),i=e.pendingLanes,4194090&a&&42&i?e===Oo?Ro++:(Ro=0,Oo=e):Ro=0,Pd(0)}}function hd(e,t){0===(e.pooledCacheLanes&=t)&&null!=(t=e.pooledCache)&&(e.pooledCache=null,Bi(t))}function ud(e){return cd(),od(),dd(),md()}function md(){if(5!==$o)return!1;var e=Fo,t=Mo;Mo=0;var a=Me(Io),n=I.T,i=M.p;try{M.p=32>a?32:a,I.T=null,a=Lo,Lo=null;var s=Fo,l=Io;if($o=0,Eo=Fo=null,Io=0,6&so)throw Error(r(331));var c=so;if(so|=4,to(s.current),qc(s,s.current,l,a),so=c,Pd(0),ve&&"function"==typeof ve.onPostCommitFiberRoot)try{ve.onPostCommitFiberRoot(fe,s)}catch(o){}return!0}finally{M.p=i,I.T=n,hd(e,t)}}function pd(e,t,a){t=Tn(a,t),null!==(e=dr(e,t=Sl(e.stateNode,t,2),2))&&($e(e,2),Sd(e))}function fd(e,t,a){if(3===e.tag)pd(e,e,a);else for(;null!==t;){if(3===t.tag){pd(t,e,a);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===To||!To.has(n))){e=Tn(a,e),null!==(n=dr(t,a=Pl(2),2))&&(Tl(a,n,t,e),$e(n,2),Sd(n));break}}t=t.return}}function vd(e,t,a){var n=e.pingCache;if(null===n){n=e.pingCache=new ro;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(a)||(fo=!0,i.add(a),e=yd.bind(null,e,t,a),t.then(e,e))}function yd(e,t,a){var n=e.pingCache;null!==n&&n.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,lo===e&&(oo&a)===a&&(4===yo||3===yo&&(62914560&oo)===oo&&300>se()-_o?!(2&so)&&Vo(e,0):No|=a,ko===oo&&(ko=0)),Sd(e)}function gd(e,t){0===t&&(t=Pe()),null!==(e=Wn(e,t))&&($e(e,t),Sd(e))}function bd(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),gd(e,a)}function Nd(e,t){var a=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(a=i.retryLane);break;case 19:n=e.stateNode;break;case 22:n=e.stateNode.W;break;default:throw Error(r(314))}null!==n&&n.delete(t),gd(e,a)}var wd=null,kd=null,xd=!1,Cd=!1,Ad=!1,_d=0;function Sd(e){e!==kd&&null===e.next&&(null===kd?wd=kd=e:kd=kd.next=e),Cd=!0,xd||(xd=!0,vh(function(){6&so?ae(ce,Td):$d()}))}function Pd(e,t){if(!Ad&&Cd){Ad=!0;do{for(var a=!1,n=wd;null!==n;){if(0!==e){var i=n.pendingLanes;if(0===i)var r=0;else{var s=n.suspendedLanes,l=n.pingedLanes;r=(1<<31-ge(42|e)+1)-1,r=201326741&(r&=i&~(s&~l))?201326741&r|1:r?2|r:0}0!==r&&(a=!0,Id(n,r))}else r=oo,!(3&(r=Ce(n,n===lo?r:0,null!==n.cancelPendingCommit||-1!==n.timeoutHandle)))||Ae(n,r)||(a=!0,Id(n,r));n=n.next}}while(a);Ad=!1}}function Td(){$d()}function $d(){Cd=xd=!1;var e,t=0;0!==_d&&(((e=window.event)&&"popstate"===e.type?e!==uh&&(uh=e,!0):(uh=null,!1))&&(t=_d),_d=0);for(var a=se(),n=null,i=wd;null!==i;){var r=i.next,s=Fd(i,a);0===s?(i.next=null,null===n?wd=r:n.next=r,null===r&&(kd=n)):(n=i,(0!==t||3&s)&&(Cd=!0)),i=r}Pd(t)}function Fd(e,t){for(var a=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,r=-62914561&e.pendingLanes;0<r;){var s=31-ge(r),l=1<<s,c=i[s];-1===c?0!==(l&a)&&0===(l&n)||(i[s]=_e(l,t)):c<=t&&(e.expiredLanes|=l),r&=~l}if(a=oo,a=Ce(e,e===(t=lo)?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),n=e.callbackNode,0===a||e===t&&(2===ho||9===ho)||null!==e.cancelPendingCommit)return null!==n&&null!==n&&ne(n),e.callbackNode=null,e.callbackPriority=0;if(!(3&a)||Ae(e,a)){if((t=a&-a)===e.callbackPriority)return t;switch(null!==n&&ne(n),Me(a)){case 2:case 8:a=oe;break;case 32:default:a=de;break;case 268435456:a=ue}return n=Ed.bind(null,e),a=ae(a,n),e.callbackPriority=t,e.callbackNode=a,t}return null!==n&&null!==n&&ne(n),e.callbackPriority=2,e.callbackNode=null,2}function Ed(e,t){if(0!==$o&&5!==$o)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(ud()&&e.callbackNode!==a)return null;var n=oo;return 0===(n=Ce(e,e===lo?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Uo(e,n,t),Fd(e,se()),null!=e.callbackNode&&e.callbackNode===a?Ed.bind(null,e):null)}function Id(e,t){if(ud())return null;Uo(e,t,!0)}function Md(){return 0===_d&&(_d=Se()),_d}function Ld(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Mt(""+e)}function Wd(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}for(var Rd=0;Rd<_n.length;Rd++){var Od=_n[Rd];Sn(Od.toLowerCase(),"on"+(Od[0].toUpperCase()+Od.slice(1)))}Sn(gn,"onAnimationEnd"),Sn(bn,"onAnimationIteration"),Sn(Nn,"onAnimationStart"),Sn("dblclick","onDoubleClick"),Sn("focusin","onFocus"),Sn("focusout","onBlur"),Sn(wn,"onTransitionRun"),Sn(kn,"onTransitionStart"),Sn(xn,"onTransitionCancel"),Sn(Cn,"onTransitionEnd"),et("onMouseEnter",["mouseout","mouseover"]),et("onMouseLeave",["mouseout","mouseover"]),et("onPointerEnter",["pointerout","pointerover"]),et("onPointerLeave",["pointerout","pointerover"]),Ze("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ze("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ze("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ze("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ze("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Bd));function Dd(e,t){t=!!(4&t);for(var a=0;a<e.length;a++){var n=e[a],i=n.event;n=n.listeners;e:{var r=void 0;if(t)for(var s=n.length-1;0<=s;s--){var l=n[s],c=l.instance,o=l.currentTarget;if(l=l.listener,c!==r&&i.isPropagationStopped())break e;r=l,i.currentTarget=o;try{r(i)}catch(d){wl(d)}i.currentTarget=null,r=c}else for(s=0;s<n.length;s++){if(c=(l=n[s]).instance,o=l.currentTarget,l=l.listener,c!==r&&i.isPropagationStopped())break e;r=l,i.currentTarget=o;try{r(i)}catch(d){wl(d)}i.currentTarget=null,r=c}}}}function Ud(e,t){var a=t[je];void 0===a&&(a=t[je]=new Set);var n=e+"__bubble";a.has(n)||(Jd(t,e,2,!1),a.add(n))}function Xd(e,t,a){var n=0;t&&(n|=4),Jd(a,e,n,t)}var zd="_reactListening"+Math.random().toString(36).slice(2);function Hd(e){if(!e[zd]){e[zd]=!0,Ke.forEach(function(t){"selectionchange"!==t&&(jd.has(t)||Xd(t,!1,e),Xd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[zd]||(t[zd]=!0,Xd("selectionchange",!1,t))}}function Jd(e,t,a,n){switch(pu(t)){case 2:var i=cu;break;case 8:i=ou;break;default:i=du}a=i.bind(null,t,a,e),i=void 0,!zt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,a,{capture:!0,passive:i}):e.addEventListener(t,a,!0):void 0!==i?e.addEventListener(t,a,{passive:i}):e.addEventListener(t,a,!1)}function qd(e,t,a,n,i){var r=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var s=n.tag;if(3===s||4===s){var c=n.stateNode.containerInfo;if(c===i)break;if(4===s)for(s=n.return;null!==s;){var o=s.tag;if((3===o||4===o)&&s.stateNode.containerInfo===i)return;s=s.return}for(;null!==c;){if(null===(s=Je(c)))return;if(5===(o=s.tag)||6===o||26===o||27===o){n=r=s;continue e}c=c.parentNode}}n=n.return}Dt(function(){var n=r,i=Wt(a),s=[];e:{var c=An.get(e);if(void 0!==c){var o=ia,d=e;switch(e){case"keypress":if(0===Yt(a))break e;case"keydown":case"keyup":o=ba;break;case"focusin":d="focus",o=da;break;case"focusout":d="blur",o=da;break;case"beforeblur":case"afterblur":o=da;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=ca;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=oa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=wa;break;case gn:case bn:case Nn:o=ha;break;case Cn:o=ka;break;case"scroll":case"scrollend":o=sa;break;case"wheel":o=xa;break;case"copy":case"cut":case"paste":o=ua;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=Na;break;case"toggle":case"beforetoggle":o=Ca}var h=!!(4&t),u=!h&&("scroll"===e||"scrollend"===e),m=h?null!==c?c+"Capture":null:c;h=[];for(var p,f=n;null!==f;){var v=f;if(p=v.stateNode,5!==(v=v.tag)&&26!==v&&27!==v||null===p||null===m||null!=(v=Ut(f,m))&&h.push(Vd(f,v,p)),u)break;f=f.return}0<h.length&&(c=new o(c,d,null,a,i),s.push({event:c,listeners:h}))}}if(!(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(c="mouseover"===e||"pointerover"===e)||a===Lt||!(d=a.relatedTarget||a.fromElement)||!Je(d)&&!d[Be])&&(o||c)&&(c=i.window===i?i:(c=i.ownerDocument)?c.defaultView||c.parentWindow:window,o?(o=n,null!==(d=(d=a.relatedTarget||a.toElement)?Je(d):null)&&(u=l(d),h=d.tag,d!==u||5!==h&&27!==h&&6!==h)&&(d=null)):(o=null,d=n),o!==d)){if(h=ca,v="onMouseLeave",m="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(h=Na,v="onPointerLeave",m="onPointerEnter",f="pointer"),u=null==o?c:Ve(o),p=null==d?c:Ve(d),(c=new h(v,f+"leave",o,a,i)).target=u,c.relatedTarget=p,v=null,Je(i)===n&&((h=new h(m,f+"enter",d,a,i)).target=p,h.relatedTarget=u,v=h),u=v,o&&d)e:{for(m=d,f=0,p=h=o;p;p=Yd(p))f++;for(p=0,v=m;v;v=Yd(v))p++;for(;0<f-p;)h=Yd(h),f--;for(;0<p-f;)m=Yd(m),p--;for(;f--;){if(h===m||null!==m&&h===m.alternate)break e;h=Yd(h),m=Yd(m)}h=null}else h=null;null!==o&&Kd(s,c,o,h,!1),null!==d&&null!==u&&Kd(s,u,d,h,!0)}if("select"===(o=(c=n?Ve(n):window).nodeName&&c.nodeName.toLowerCase())||"input"===o&&"file"===c.type)var y=Ua;else if(Wa(c))if(Xa)y=Qa;else{y=Ya;var g=Ga}else!(o=c.nodeName)||"input"!==o.toLowerCase()||"checkbox"!==c.type&&"radio"!==c.type?n&&Ft(n.elementType)&&(y=Ua):y=Ka;switch(y&&(y=y(e,n))?Ra(s,y,a,i):(g&&g(e,c,n),"focusout"===e&&n&&"number"===c.type&&null!=n.memoizedProps.value&&xt(c,"number",c.value)),g=n?Ve(n):window,e){case"focusin":(Wa(g)||"true"===g.contentEditable)&&(cn=g,on=n,dn=null);break;case"focusout":dn=on=cn=null;break;case"mousedown":hn=!0;break;case"contextmenu":case"mouseup":case"dragend":hn=!1,un(s,a,i);break;case"selectionchange":if(ln)break;case"keydown":case"keyup":un(s,a,i)}var b;if(_a)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else Ma?Ea(e,a)&&(N="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(N="onCompositionStart");N&&(Ta&&"ko"!==a.locale&&(Ma||"onCompositionStart"!==N?"onCompositionEnd"===N&&Ma&&(b=Gt()):(qt="value"in(Jt=i)?Jt.value:Jt.textContent,Ma=!0)),0<(g=Gd(n,N)).length&&(N=new ma(N,e,null,a,i),s.push({event:N,listeners:g}),(b||null!==(b=Ia(a)))&&(N.data=b))),(b=Pa?function(e,t){switch(e){case"compositionend":return Ia(t);case"keypress":return 32!==t.which?null:(Fa=!0,$a);case"textInput":return(e=t.data)===$a&&Fa?null:e;default:return null}}(e,a):function(e,t){if(Ma)return"compositionend"===e||!_a&&Ea(e,t)?(e=Gt(),Vt=qt=Jt=null,Ma=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ta&&"ko"!==t.locale?null:t.data}}(e,a))&&0<(N=Gd(n,"onBeforeInput")).length&&(g=new ma("onBeforeInput","beforeinput",null,a,i),s.push({event:g,listeners:N}),g.data=b),function(e,t,a,n,i){if("submit"===t&&a&&a.stateNode===i){var r=Ld((i[Oe]||null).action),s=n.submitter;s&&null!==(t=(t=s[Oe]||null)?Ld(t.formAction):s.getAttribute("formAction"))&&(r=t,s=null);var l=new ia("action","action",null,n,i);e.push({event:l,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==_d){var e=s?Wd(i,s):new FormData(i);Ls(a,{pending:!0,data:e,method:i.method,action:r},null,e)}}else"function"==typeof r&&(l.preventDefault(),e=s?Wd(i,s):new FormData(i),Ls(a,{pending:!0,data:e,method:i.method,action:r},r,e))},currentTarget:i}]})}}(s,e,n,a,i)}Dd(s,t)})}function Vd(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Gd(e,t){for(var a=t+"Capture",n=[];null!==e;){var i=e,r=i.stateNode;if(5!==(i=i.tag)&&26!==i&&27!==i||null===r||(null!=(i=Ut(e,a))&&n.unshift(Vd(e,i,r)),null!=(i=Ut(e,t))&&n.push(Vd(e,i,r))),3===e.tag)return n;e=e.return}return[]}function Yd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Kd(e,t,a,n,i){for(var r=t.N,s=[];null!==a&&a!==n;){var l=a,c=l.alternate,o=l.stateNode;if(l=l.tag,null!==c&&c===n)break;5!==l&&26!==l&&27!==l||null===o||(c=o,i?null!=(o=Ut(a,r))&&s.unshift(Vd(a,o,c)):i||null!=(o=Ut(a,r))&&s.push(Vd(a,o,c))),a=a.return}0!==s.length&&e.push({event:t,listeners:s})}var Qd=/\r\n?/g,Zd=/\u0000|\uFFFD/g;function eh(e){return("string"==typeof e?e:""+e).replace(Qd,"\n").replace(Zd,"")}function th(e,t){return t=eh(t),eh(e)===t}function ah(){}function nh(e,t,a,n,i,s){switch(a){case"children":"string"==typeof n?"body"===t||"textarea"===t&&""===n||St(e,n):("number"==typeof n||"bigint"==typeof n)&&"body"!==t&&St(e,""+n);break;case"className":lt(e,"class",n);break;case"tabIndex":lt(e,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":lt(e,a,n);break;case"style":$t(e,n,s);break;case"data":if("object"!==t){lt(e,"data",n);break}case"src":case"href":if(""===n&&("a"!==t||"href"!==a)){e.removeAttribute(a);break}if(null==n||"function"==typeof n||"symbol"==typeof n||"boolean"==typeof n){e.removeAttribute(a);break}n=Mt(""+n),e.setAttribute(a,n);break;case"action":case"formAction":if("function"==typeof n){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof s&&("formAction"===a?("input"!==t&&nh(e,t,"name",i.name,i,null),nh(e,t,"formEncType",i.formEncType,i,null),nh(e,t,"formMethod",i.formMethod,i,null),nh(e,t,"formTarget",i.formTarget,i,null)):(nh(e,t,"encType",i.encType,i,null),nh(e,t,"method",i.method,i,null),nh(e,t,"target",i.target,i,null))),null==n||"symbol"==typeof n||"boolean"==typeof n){e.removeAttribute(a);break}n=Mt(""+n),e.setAttribute(a,n);break;case"onClick":null!=n&&(e.onclick=ah);break;case"onScroll":null!=n&&Ud("scroll",e);break;case"onScrollEnd":null!=n&&Ud("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!=typeof n||!("J"in n))throw Error(r(61));if(null!=(a=n.J)){if(null!=i.children)throw Error(r(60));e.innerHTML=a}}break;case"multiple":e.multiple=n&&"function"!=typeof n&&"symbol"!=typeof n;break;case"muted":e.muted=n&&"function"!=typeof n&&"symbol"!=typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"==typeof n||"boolean"==typeof n||"symbol"==typeof n){e.removeAttribute("xlink:href");break}a=Mt(""+n),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(a,""+n):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":!0===n?e.setAttribute(a,""):!1!==n&&null!=n&&"function"!=typeof n&&"symbol"!=typeof n?e.setAttribute(a,n):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!=typeof n&&"symbol"!=typeof n&&!isNaN(n)&&1<=n?e.setAttribute(a,n):e.removeAttribute(a);break;case"rowSpan":case"start":null==n||"function"==typeof n||"symbol"==typeof n||isNaN(n)?e.removeAttribute(a):e.setAttribute(a,n);break;case"popover":Ud("beforetoggle",e),Ud("toggle",e),st(e,"popover",n);break;case"xlinkActuate":ct(e,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":ct(e,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":ct(e,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":ct(e,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":ct(e,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":ct(e,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":ct(e,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":ct(e,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":ct(e,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":st(e,"is",n);break;case"innerText":case"textContent":break;default:(!(2<a.length)||"o"!==a[0]&&"O"!==a[0]||"n"!==a[1]&&"N"!==a[1])&&st(e,a=Et.get(a)||a,n)}}function ih(e,t,a,n,i,s){switch(a){case"style":$t(e,n,s);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!=typeof n||!("J"in n))throw Error(r(61));if(null!=(a=n.J)){if(null!=i.children)throw Error(r(60));e.innerHTML=a}}break;case"children":"string"==typeof n?St(e,n):("number"==typeof n||"bigint"==typeof n)&&St(e,""+n);break;case"onScroll":null!=n&&Ud("scroll",e);break;case"onScrollEnd":null!=n&&Ud("scrollend",e);break;case"onClick":null!=n&&(e.onclick=ah);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Qe.hasOwnProperty(a)||("o"!==a[0]||"n"!==a[1]||(i=a.endsWith("Capture"),t=a.slice(2,i?a.length-7:void 0),"function"==typeof(s=null!=(s=e[Oe]||null)?s[a]:null)&&e.removeEventListener(t,s,i),"function"!=typeof n)?a in e?e[a]=n:!0===n?e.setAttribute(a,""):st(e,a,n):("function"!=typeof s&&null!==s&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,n,i)))}}function rh(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ud("error",e),Ud("load",e);var n,i=!1,s=!1;for(n in a)if(a.hasOwnProperty(n)){var l=a[n];if(null!=l)switch(n){case"src":i=!0;break;case"srcSet":s=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:nh(e,t,n,l,a,null)}}return s&&nh(e,t,"srcSet",a.srcSet,a,null),void(i&&nh(e,t,"src",a.src,a,null));case"input":Ud("invalid",e);var c=n=l=s=null,o=null,d=null;for(i in a)if(a.hasOwnProperty(i)){var h=a[i];if(null!=h)switch(i){case"name":s=h;break;case"type":l=h;break;case"checked":o=h;break;case"defaultChecked":d=h;break;case"value":n=h;break;case"defaultValue":c=h;break;case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(r(137,t));break;default:nh(e,t,i,h,a,null)}}return kt(e,n,c,o,d,l,s,!1),void vt(e);case"select":for(s in Ud("invalid",e),i=l=n=null,a)if(a.hasOwnProperty(s)&&null!=(c=a[s]))switch(s){case"value":n=c;break;case"defaultValue":l=c;break;case"multiple":i=c;default:nh(e,t,s,c,a,null)}return t=n,a=l,e.multiple=!!i,void(null!=t?Ct(e,!!i,t,!1):null!=a&&Ct(e,!!i,a,!0));case"textarea":for(l in Ud("invalid",e),n=s=i=null,a)if(a.hasOwnProperty(l)&&null!=(c=a[l]))switch(l){case"value":i=c;break;case"defaultValue":s=c;break;case"children":n=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(r(91));break;default:nh(e,t,l,c,a,null)}return _t(e,i,s,n),void vt(e);case"option":for(o in a)a.hasOwnProperty(o)&&null!=(i=a[o])&&("selected"===o?e.selected=i&&"function"!=typeof i&&"symbol"!=typeof i:nh(e,t,o,i,a,null));return;case"dialog":Ud("beforetoggle",e),Ud("toggle",e),Ud("cancel",e),Ud("close",e);break;case"iframe":case"object":Ud("load",e);break;case"video":case"audio":for(i=0;i<Bd.length;i++)Ud(Bd[i],e);break;case"image":Ud("error",e),Ud("load",e);break;case"details":Ud("toggle",e);break;case"embed":case"source":case"link":Ud("error",e),Ud("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in a)if(a.hasOwnProperty(d)&&null!=(i=a[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,t));default:nh(e,t,d,i,a,null)}return;default:if(Ft(t)){for(h in a)a.hasOwnProperty(h)&&void 0!==(i=a[h])&&ih(e,t,h,i,a,void 0);return}}for(c in a)a.hasOwnProperty(c)&&null!=(i=a[c])&&nh(e,t,c,i,a,null)}var sh=null,lh=null;function ch(e){return 9===e.nodeType?e:e.ownerDocument}function oh(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function dh(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function hh(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.J}var uh=null,mh="function"==typeof setTimeout?setTimeout:void 0,ph="function"==typeof clearTimeout?clearTimeout:void 0,fh="function"==typeof Promise?Promise:void 0,vh="function"==typeof queueMicrotask?queueMicrotask:void 0!==fh?function(e){return fh.resolve(null).then(e).catch(yh)}:mh;function yh(e){setTimeout(function(){throw e})}function gh(e){return"head"===e}function bh(e,t){var a=t,n=0,i=0;do{var r=a.nextSibling;if(e.removeChild(a),r&&8===r.nodeType)if("/$"===(a=r.data)){if(0<n&&8>n){a=n;var s=e.ownerDocument;if(1&a&&_h(s.documentElement),2&a&&_h(s.body),4&a)for(_h(a=s.head),s=a.firstChild;s;){var l=s.nextSibling,c=s.nodeName;s[ze]||"SCRIPT"===c||"STYLE"===c||"LINK"===c&&"stylesheet"===s.rel.toLowerCase()||a.removeChild(s),s=l}}if(0===i)return e.removeChild(r),void Eu(t);i--}else"$"===a||"$?"===a||"$!"===a?i++:n=a.charCodeAt(0)-48;else n=0;a=r}while(a);Eu(t)}function Nh(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":Nh(a),He(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===a.rel.toLowerCase())continue}e.removeChild(a)}}function wh(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function kh(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var xh=null;function Ch(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a){if(0===t)return e;t--}else"/$"===a&&t++}e=e.previousSibling}return null}function Ah(e,t,a){switch(t=ch(a),e){case"html":if(!(e=t.documentElement))throw Error(r(452));return e;case"head":if(!(e=t.head))throw Error(r(453));return e;case"body":if(!(e=t.body))throw Error(r(454));return e;default:throw Error(r(451))}}function _h(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);He(e)}var Sh=new Map,Ph=new Set;function Th(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var $h=M.d;M.d={f:function(){var e=$h.f(),t=Jo();return e||t},r:function(e){var t=qe(e);null!==t&&5===t.tag&&"form"===t.type?Rs(t):$h.r(e)},D:function(e){$h.D(e),Eh("dns-prefetch",e,null)},C:function(e,t){$h.C(e,t),Eh("preconnect",e,t)},L:function(e,t,a){$h.L(e,t,a);var n=Fh;if(n&&e&&t){var i='link[rel="preload"][as="'+Nt(t)+'"]';"image"===t&&a&&a.imageSrcSet?(i+='[imagesrcset="'+Nt(a.imageSrcSet)+'"]',"string"==typeof a.imageSizes&&(i+='[imagesizes="'+Nt(a.imageSizes)+'"]')):i+='[href="'+Nt(e)+'"]';var r=i;switch(t){case"style":r=Mh(e);break;case"script":r=Rh(e)}Sh.has(r)||(e=h({rel:"preload",href:"image"===t&&a&&a.imageSrcSet?void 0:e,as:t},a),Sh.set(r,e),null!==n.querySelector(i)||"style"===t&&n.querySelector(Lh(r))||"script"===t&&n.querySelector(Oh(r))||(rh(t=n.createElement("link"),"link",e),Ye(t),n.head.appendChild(t)))}},m:function(e,t){$h.m(e,t);var a=Fh;if(a&&e){var n=t&&"string"==typeof t.as?t.as:"script",i='link[rel="modulepreload"][as="'+Nt(n)+'"][href="'+Nt(e)+'"]',r=i;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":r=Rh(e)}if(!Sh.has(r)&&(e=h({rel:"modulepreload",href:e},t),Sh.set(r,e),null===a.querySelector(i))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Oh(r)))return}rh(n=a.createElement("link"),"link",e),Ye(n),a.head.appendChild(n)}}},X:function(e,t){$h.X(e,t);var a=Fh;if(a&&e){var n=Ge(a).hoistableScripts,i=Rh(e),r=n.get(i);r||((r=a.querySelector(Oh(i)))||(e=h({src:e,async:!0},t),(t=Sh.get(i))&&Uh(e,t),Ye(r=a.createElement("script")),rh(r,"link",e),a.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},n.set(i,r))}},S:function(e,t,a){$h.S(e,t,a);var n=Fh;if(n&&e){var i=Ge(n).hoistableStyles,r=Mh(e);t=t||"default";var s=i.get(r);if(!s){var l={loading:0,preload:null};if(s=n.querySelector(Lh(r)))l.loading=5;else{e=h({rel:"stylesheet",href:e,"data-precedence":t},a),(a=Sh.get(r))&&Dh(e,a);var c=s=n.createElement("link");Ye(c),rh(c,"link",e),c.U=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){l.loading|=1}),c.addEventListener("error",function(){l.loading|=2}),l.loading|=4,jh(s,t,n)}s={type:"stylesheet",instance:s,count:1,state:l},i.set(r,s)}}},M:function(e,t){$h.M(e,t);var a=Fh;if(a&&e){var n=Ge(a).hoistableScripts,i=Rh(e),r=n.get(i);r||((r=a.querySelector(Oh(i)))||(e=h({src:e,async:!0,type:"module"},t),(t=Sh.get(i))&&Uh(e,t),Ye(r=a.createElement("script")),rh(r,"link",e),a.head.appendChild(r)),r={type:"script",instance:r,count:1,state:null},n.set(i,r))}}};var Fh="undefined"==typeof document?null:document;function Eh(e,t,a){var n=Fh;if(n&&"string"==typeof t&&t){var i=Nt(t);i='link[rel="'+e+'"][href="'+i+'"]',"string"==typeof a&&(i+='[crossorigin="'+a+'"]'),Ph.has(i)||(Ph.add(i),e={rel:e,crossOrigin:a,href:t},null===n.querySelector(i)&&(rh(t=n.createElement("link"),"link",e),Ye(t),n.head.appendChild(t)))}}function Ih(e,t,a,n){var i,s,l,c,o=(o=J.current)?Th(o):null;if(!o)throw Error(r(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof a.precedence&&"string"==typeof a.href?(t=Mh(a.href),(n=(a=Ge(o).hoistableStyles).get(t))||(n={type:"style",instance:null,count:0,state:null},a.set(t,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===a.rel&&"string"==typeof a.href&&"string"==typeof a.precedence){e=Mh(a.href);var d=Ge(o).hoistableStyles,h=d.get(e);if(h||(o=o.ownerDocument||o,h={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,h),(d=o.querySelector(Lh(e)))&&!d.U&&(h.instance=d,h.state.loading=5),Sh.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},Sh.set(e,a),d||(i=o,s=e,l=a,c=h.state,i.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=i.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),rh(s,"link",l),Ye(s),i.head.appendChild(s))))),t&&null===n)throw Error(r(528,""));return h}if(t&&null!==n)throw Error(r(529,""));return null;case"script":return t=a.async,"string"==typeof(a=a.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=Rh(a),(n=(a=Ge(o).hoistableScripts).get(t))||(n={type:"script",instance:null,count:0,state:null},a.set(t,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,e))}}function Mh(e){return'href="'+Nt(e)+'"'}function Lh(e){return'link[rel="stylesheet"]['+e+"]"}function Wh(e){return h({},e,{"data-precedence":e.precedence,precedence:null})}function Rh(e){return'[src="'+Nt(e)+'"]'}function Oh(e){return"script[async]"+e}function Bh(e,t,a){if(t.count++,null===t.instance)switch(t.type){case"style":var n=e.querySelector('style[data-href~="'+Nt(a.href)+'"]');if(n)return t.instance=n,Ye(n),n;var i=h({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return Ye(n=(e.ownerDocument||e).createElement("style")),rh(n,"style",i),jh(n,a.precedence,e),t.instance=n;case"stylesheet":i=Mh(a.href);var s=e.querySelector(Lh(i));if(s)return t.state.loading|=4,t.instance=s,Ye(s),s;n=Wh(a),(i=Sh.get(i))&&Dh(n,i),Ye(s=(e.ownerDocument||e).createElement("link"));var l=s;return l.U=new Promise(function(e,t){l.onload=e,l.onerror=t}),rh(s,"link",n),t.state.loading|=4,jh(s,a.precedence,e),t.instance=s;case"script":return s=Rh(a.src),(i=e.querySelector(Oh(s)))?(t.instance=i,Ye(i),i):(n=a,(i=Sh.get(s))&&Uh(n=h({},a),i),Ye(i=(e=e.ownerDocument||e).createElement("script")),rh(i,"link",n),e.head.appendChild(i),t.instance=i);case"void":return null;default:throw Error(r(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(n=t.instance,t.state.loading|=4,jh(n,a.precedence,e));return t.instance}function jh(e,t,a){for(var n=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),i=n.length?n[n.length-1]:null,r=i,s=0;s<n.length;s++){var l=n[s];if(l.dataset.precedence===t)r=l;else if(r!==i)break}r?r.parentNode.insertBefore(e,r.nextSibling):(t=9===a.nodeType?a.head:a).insertBefore(e,t.firstChild)}function Dh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Uh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Xh=null;function zh(e,t,a){if(null===Xh){var n=new Map,i=Xh=new Map;i.set(a,n)}else(n=(i=Xh).get(a))||(n=new Map,i.set(a,n));if(n.has(e))return n;for(n.set(e,null),a=a.getElementsByTagName(e),i=0;i<a.length;i++){var r=a[i];if(!(r[ze]||r[Re]||"link"===e&&"stylesheet"===r.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==r.namespaceURI){var s=r.getAttribute(t)||"";s=e+s;var l=n.get(s);l?l.push(r):n.set(s,[r])}}return n}function Hh(e,t,a){(e=e.ownerDocument||e).head.insertBefore(a,"title"===t?e.querySelector("head > title"):null)}function Jh(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var qh=null;function Vh(){}function Gh(){if(this.count--,0===this.count)if(this.stylesheets)Kh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Yh=null;function Kh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Yh=new Map,t.forEach(Qh,e),Yh=null,Gh.call(e))}function Qh(e,t){if(!(4&t.state.loading)){var a=Yh.get(e);if(a)var n=a.get(null);else{a=new Map,Yh.set(e,a);for(var i=e.querySelectorAll("link[data-precedence],style[data-precedence]"),r=0;r<i.length;r++){var s=i[r];"LINK"!==s.nodeName&&"not all"===s.getAttribute("media")||(a.set(s.dataset.precedence,s),n=s)}n&&a.set(null,n)}s=(i=t.instance).getAttribute("data-precedence"),(r=a.get(s)||n)===n&&a.set(null,i),a.set(s,i),this.count++,n=Gh.bind(this),i.addEventListener("load",n),i.addEventListener("error",n),r?r.parentNode.insertBefore(i,r.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(i,e.firstChild),t.state.loading|=4}}var Zh={$$typeof:N,Provider:null,Consumer:null,u:L,P:L,$:0};function eu(e,t,a,n,i,r,s,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Te(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Te(0),this.hiddenUpdates=Te(null),this.identifierPrefix=n,this.onUncaughtError=i,this.onCaughtError=r,this.onRecoverableError=s,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function tu(e,t,a,n,i,r,s,l,c,o,d,h){return e=new eu(e,t,a,s,l,c,o,h),t=1,!0===r&&(t|=24),r=Dn(3,null,null,t),e.current=r,r.stateNode=e,(t=Oi()).refCount++,e.pooledCache=t,t.refCount++,r.memoizedState={element:n,isDehydrated:a,cache:t},lr(r),e}function au(e){return e?e=Bn:Bn}function nu(e,t,a,n,i,r){i=au(i),null===n.context?n.context=i:n.pendingContext=i,(n=or(t)).payload={element:a},null!==(r=void 0===r?null:r)&&(n.callback=r),null!==(a=dr(e,n,t))&&(Do(a,0,t),hr(a,e,t))}function iu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function ru(e,t){iu(e,t),(e=e.alternate)&&iu(e,t)}function su(e){if(13===e.tag){var t=Wn(e,67108864);null!==t&&Do(t,0,67108864),ru(e,67108864)}}var lu=!0;function cu(e,t,a,n){var i=I.T;I.T=null;var r=M.p;try{M.p=2,du(e,t,a,n)}finally{M.p=r,I.T=i}}function ou(e,t,a,n){var i=I.T;I.T=null;var r=M.p;try{M.p=8,du(e,t,a,n)}finally{M.p=r,I.T=i}}function du(e,t,a,n){if(lu){var i=hu(n);if(null===i)qd(e,t,n,uu,a),xu(e,n);else if(function(e,t,a,n,i){switch(t){case"focusin":return vu=Cu(vu,e,t,a,n,i),!0;case"dragenter":return yu=Cu(yu,e,t,a,n,i),!0;case"mouseover":return gu=Cu(gu,e,t,a,n,i),!0;case"pointerover":var r=i.pointerId;return bu.set(r,Cu(bu.get(r)||null,e,t,a,n,i)),!0;case"gotpointercapture":return r=i.pointerId,Nu.set(r,Cu(Nu.get(r)||null,e,t,a,n,i)),!0}return!1}(i,e,t,a,n))n.stopPropagation();else if(xu(e,n),4&t&&-1<ku.indexOf(e)){for(;null!==i;){var r=qe(i);if(null!==r)switch(r.tag){case 3:if((r=r.stateNode).current.memoizedState.isDehydrated){var s=xe(r.pendingLanes);if(0!==s){var l=r;for(l.pendingLanes|=2,l.entangledLanes|=2;s;){var c=1<<31-ge(s);l.entanglements[1]|=c,s&=~c}Sd(r),!(6&so)&&(So=se()+500,Pd(0))}}break;case 13:null!==(l=Wn(r,2))&&Do(l,0,2),Jo(),ru(r,2)}if(null===(r=hu(n))&&qd(e,t,n,uu,a),r===i)break;i=r}null!==i&&n.stopPropagation()}else qd(e,t,n,null,a)}}function hu(e){return mu(e=Wt(e))}var uu=null;function mu(e){if(uu=null,null!==(e=Je(e))){var t=l(e);if(null===t)e=null;else{var a=t.tag;if(13===a){if(null!==(e=c(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return uu=e,null}function pu(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case ce:return 2;case oe:return 8;case de:case he:return 32;case ue:return 268435456;default:return 32}default:return 32}}var fu=!1,vu=null,yu=null,gu=null,bu=new Map,Nu=new Map,wu=[],ku="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function xu(e,t){switch(e){case"focusin":case"focusout":vu=null;break;case"dragenter":case"dragleave":yu=null;break;case"mouseover":case"mouseout":gu=null;break;case"pointerover":case"pointerout":bu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Nu.delete(t.pointerId)}}function Cu(e,t,a,n,i,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:a,eventSystemFlags:n,nativeEvent:r,targetContainers:[i]},null!==t&&null!==(t=qe(t))&&su(t),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Au(e){var t=Je(e.target);if(null!==t){var a=l(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=c(a)))return e.blockedOn=t,void function(e){var t=M.p;try{return M.p=e,function(){if(13===a.tag){var e=Bo();e=Ie(e);var t=Wn(a,e);null!==t&&Do(t,0,e),ru(a,e)}}()}finally{M.p=t}}(e.priority)}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function _u(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=hu(e.nativeEvent);if(null!==a)return null!==(t=qe(a))&&su(t),e.blockedOn=a,!1;var n=new(a=e.nativeEvent).constructor(a.type,a);Lt=n,a.target.dispatchEvent(n),Lt=null,t.shift()}return!0}function Su(e,t,a){_u(e)&&a.delete(t)}function Pu(){fu=!1,null!==vu&&_u(vu)&&(vu=null),null!==yu&&_u(yu)&&(yu=null),null!==gu&&_u(gu)&&(gu=null),bu.forEach(Su),Nu.forEach(Su)}function Tu(t,a){t.blockedOn===a&&(t.blockedOn=null,fu||(fu=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Pu)))}var $u=null;function Fu(t){$u!==t&&($u=t,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){$u===t&&($u=null);for(var e=0;e<t.length;e+=3){var a=t[e],n=t[e+1],i=t[e+2];if("function"!=typeof n){if(null===mu(n||a))continue;break}var r=qe(a);null!==r&&(t.splice(e,3),e-=3,Ls(r,{pending:!0,data:i,method:a.method,action:n},n,i))}}))}function Eu(e){function t(t){return Tu(t,e)}null!==vu&&Tu(vu,e),null!==yu&&Tu(yu,e),null!==gu&&Tu(gu,e),bu.forEach(t),Nu.forEach(t);for(var a=0;a<wu.length;a++){var n=wu[a];n.blockedOn===e&&(n.blockedOn=null)}for(;0<wu.length&&null===(a=wu[0]).blockedOn;)Au(a),null===a.blockedOn&&wu.shift();if(null!=(a=(e.ownerDocument||e).$$reactFormReplay))for(n=0;n<a.length;n+=3){var i=a[n],r=a[n+1],s=i[Oe]||null;if("function"==typeof r)s||Fu(a);else if(s){var l=null;if(r&&r.hasAttribute("formAction")){if(i=r,s=r[Oe]||null)l=s.formAction;else if(null!==mu(i))continue}else l=s.action;"function"==typeof l?a[n+1]=l:(a.splice(n,3),n-=3),Fu(a)}}}function Iu(e){this.q=e}function Mu(e){this.q=e}Mu.prototype.render=Iu.prototype.render=function(e){var t=this.q;if(null===t)throw Error(r(409));nu(t.current,Bo(),e,t,null,null)},Mu.prototype.unmount=Iu.prototype.unmount=function(){var e=this.q;if(null!==e){this.q=null;var t=e.containerInfo;nu(e.current,2,null,e,null,null),Jo(),t[Be]=null}},Mu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Le();e={blockedOn:null,target:e,priority:t};for(var a=0;a<wu.length&&0!==t&&t<wu[a].priority;a++);wu.splice(a,0,e),0===a&&Au(e)}};var Lu=t.version;if("19.1.1"!==Lu)throw Error(r(527,Lu,"19.1.1"));M.findDOMNode=function(e){var t=e.F;if(void 0===t){if("function"==typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(r(188));return t!==e?null:e}for(var a=e,n=t;;){var i=a.return;if(null===i)break;var s=i.alternate;if(null===s){if(null!==(n=i.return)){a=n;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===a)return o(i),e;if(s===n)return o(i),t;s=s.sibling}throw Error(r(188))}if(a.return!==n.return)a=i,n=s;else{for(var c=!1,d=i.child;d;){if(d===a){c=!0,a=i,n=s;break}if(d===n){c=!0,n=i,a=s;break}d=d.sibling}if(!c){for(d=s.child;d;){if(d===a){c=!0,a=s,n=i;break}if(d===n){c=!0,n=s,a=i;break}d=d.sibling}if(!c)throw Error(r(189))}}if(a.alternate!==n)throw Error(r(190))}if(3!==a.tag)throw Error(r(188));return a.stateNode.current===a?e:t}(t),null===(e=null!==e?d(e):null)?null:e.stateNode};var Wu={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:I,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ru.isDisabled&&Ru.supportsFiber)try{fe=Ru.inject(Wu),ve=Ru}catch(Bu){}}return q.createRoot=function(e,t){if(!s(e))throw Error(r(299));var a=!1,n="",i=kl,l=xl,c=Cl;return null!=t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onUncaughtError&&(i=t.onUncaughtError),void 0!==t.onCaughtError&&(l=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=tu(e,1,!1,null,0,a,n,i,l,c,0,null),e[Be]=t.current,Hd(e),new Iu(t)},q.hydrateRoot=function(e,t,a){if(!s(e))throw Error(r(299));var n=!1,i="",l=kl,c=xl,o=Cl,d=null;return null!=a&&(!0===a.unstable_strictMode&&(n=!0),void 0!==a.identifierPrefix&&(i=a.identifierPrefix),void 0!==a.onUncaughtError&&(l=a.onUncaughtError),void 0!==a.onCaughtError&&(c=a.onCaughtError),void 0!==a.onRecoverableError&&(o=a.onRecoverableError),void 0!==a.unstable_transitionCallbacks&&a.unstable_transitionCallbacks,void 0!==a.formState&&(d=a.formState)),(t=tu(e,1,!0,t,0,n,i,l,c,o,0,d)).context=au(null),a=t.current,(i=or(n=Ie(n=Bo()))).callback=null,dr(a,i,n),a=n,t.current.lanes=a,$e(t,a),Sd(t),e[Be]=t.current,Hd(e),new Mu(t)},q.version="19.1.1",q}()),J.exports);const K=i.createContext(void 0),Q=()=>{const e=i.useContext(K);if(void 0===e)throw new Error("useWallet must be used within a WalletProvider");return e},Z=class e{static getMessage(t){return e.MESSAGES[t]}static createMessage(e,t,a){return{title:e,message:t,action:a}}static formatError(t,a){if(t instanceof Error){const a=t.message.toLowerCase(),n=t.name.toLowerCase();return a.includes("network")||a.includes("fetch")||a.includes("connection")?e.MESSAGES.NETWORK_ERROR:a.includes("timeout")||a.includes("aborted")||n.includes("timeout")?e.MESSAGES.TIMEOUT_ERROR:a.includes("rejected")||a.includes("cancelled")?e.MESSAGES.TRANSACTION_REJECTED:a.includes("insufficient")?e.MESSAGES.INSUFFICIENT_BALANCE:a.includes("not found")?e.MESSAGES.NFT_NOT_FOUND:"chunkloaderror"===n?e.MESSAGES.LOAD_FAILED:a.includes("api")||a.includes("http")||a.includes("server")?e.MESSAGES.API_ERROR:"localhost"===window.location.hostname?e.createMessage(`Error: ${t.name}`,t.message,"Retry"):e.createMessage("Error","An error occurred while processing your request.","Retry")}return a||e.MESSAGES.UNKNOWN_ERROR}static logError(e,t,a){f(async()=>{const{log:e}=await Promise.resolve().then(()=>le);return{log:e}},void 0).then(({log:n})=>{const i=t instanceof Error?t:new Error(String(t));n.error(`Error in ${e}`,e,i,a)}).catch(()=>{})}};t(Z,"MESSAGES",{NETWORK_ERROR:{title:"Connection Error",message:"Unable to connect to the server. Please check your internet connection and try again.",action:"Retry"},TIMEOUT_ERROR:{title:"Request Timeout",message:"The request took too long to complete. Please try again.",action:"Retry"},API_ERROR:{title:"Service Unavailable",message:"The service is temporarily unavailable. Please try again in a moment.",action:"Retry"},LOAD_FAILED:{title:"Loading Failed",message:"Failed to load data. Please refresh the page or try again later.",action:"Refresh"},WALLET_CONNECTION_FAILED:{title:"Wallet Connection Failed",message:"Unable to connect to your wallet. Please ensure your wallet is unlocked and try again.",action:"Retry"},WALLET_DISCONNECTED:{title:"Wallet Disconnected",message:"Your wallet has been disconnected. Please reconnect to continue.",action:"Connect Wallet"},INSUFFICIENT_BALANCE:{title:"Insufficient Balance",message:"You do not have enough balance to complete this transaction.",action:"Add Funds"},TRANSACTION_FAILED:{title:"Transaction Failed",message:"The transaction could not be completed. Please try again.",action:"Retry"},TRANSACTION_REJECTED:{title:"Transaction Rejected",message:"The transaction was rejected. Please try again if this was unintentional.",action:"Retry"},INVALID_INPUT:{title:"Invalid Input",message:"Please check your input and try again.",action:"Correct Input"},REQUIRED_FIELD:{title:"Required Field Missing",message:"Please fill in all required fields.",action:"Complete Form"},NFT_NOT_FOUND:{title:"NFT Not Found",message:"The requested NFT could not be found or may no longer be available.",action:"Go Back"},COLLECTION_NOT_FOUND:{title:"Collection Not Found",message:"The requested collection could not be found or may not exist.",action:"Browse Collections"},PURCHASE_FAILED:{title:"Purchase Failed",message:"Unable to complete the purchase. The item may no longer be available.",action:"Refresh Listings"},LISTING_FAILED:{title:"Listing Failed",message:"Unable to list your NFT. Please check your wallet and try again.",action:"Retry"},UNKNOWN_ERROR:{title:"Something Went Wrong",message:"An unexpected error occurred. Please try again or contact support if the problem persists.",action:"Retry"}});let ee=Z;function te(e,t=8,a=0){const n="string"==typeof e?parseFloat(e):e;if(isNaN(n))return"0";if(0===n)return a>0?"0."+"0".repeat(a):"0";if(Math.abs(n)<Math.pow(10,-t))return n.toExponential(2);let i=n.toFixed(t);if(i.includes(".")&&(i=i.replace(/\.?0+$/,"")),a>0){const e=i.indexOf(".");if(-1===e)i+="."+"0".repeat(a);else{const t=i.length-e-1;t<a&&(i+="0".repeat(a-t))}}return i}const ae=function(e,t=!0){const a="string"==typeof e?parseFloat(e.replace(" WAX","")):e;if(isNaN(a))return t?"0 WAX":"0";let n;return n=te(a,a>=1e3||a>=1?4:a>=.01?6:8,0),t?`${n} WAX`:n},ne=te,ie={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"},re=new class{constructor(){t(this,"logLevel",ie.INFO),t(this,"isDevelopment",!1),t(this,"logs",[]),t(this,"maxLogs",1e3),this.logLevel=this.isDevelopment?ie.DEBUG:ie.WARN}createLogEntry(e,t,a,n,i){return{timestamp:(new Date).toISOString(),level:e,message:t,context:a,data:n,error:i}}shouldLog(e){return e>=this.logLevel}storeLog(e){this.logs.push(e),this.logs.length>this.maxLogs&&this.logs.shift()}formatMessage(e){const t=e.level.toUpperCase(),a=e.context?`[${e.context}]`:"";return`${e.timestamp} ${t} ${a} ${e.message}`}debug(e,t,a){if(!this.shouldLog(ie.DEBUG))return;const n=this.createLogEntry(ie.DEBUG,e,t,a);this.storeLog(n),this.isDevelopment}info(e,t,a){if(!this.shouldLog(ie.INFO))return;const n=this.createLogEntry(ie.INFO,e,t,a);this.storeLog(n),this.isDevelopment}warn(e,t,a){if(!this.shouldLog(ie.WARN))return;const n=this.createLogEntry(ie.WARN,e,t,a);this.storeLog(n)}error(e,t,a,n){if(!this.shouldLog(ie.ERROR))return;const i=this.createLogEntry(ie.ERROR,e,t,n,a);this.storeLog(i),!this.isDevelopment&&a&&this.reportError(a,{message:e,context:t,data:n})}async reportError(e,t){try{const a=[this.sendToErrorReportingAPI(e,t),this.sendToLocalStorage(e,t),this.sendToConsole(e,t)];await Promise.allSettled(a)}catch(a){}}async sendToErrorReportingAPI(e,t){try{const a={message:e.message,stack:e.stack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,userId:this.getUserId(),sessionId:this.getSessionId(),buildVersion:this.getBuildVersion(),environment:this.getEnvironment(),metadata:t},n=await fetch("/api/errors/report",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify(a)});if(!n.ok)throw new Error(`Error reporting failed: ${n.status} ${n.statusText}`)}catch{await this.sendToFallbackErrorService(e,t)}}async sendToFallbackErrorService(e,t){try{const a={error:{message:e.message,stack:e.stack,timestamp:(new Date).toISOString()},context:{...t,userAgent:navigator.userAgent,url:window.location.href}};"undefined"!=typeof window&&window.Sentry&&window.Sentry.captureException(e,{extra:a.context,level:"error"})}catch(a){}}async sendToLocalStorage(e,t){try{const n="error_reports",i=50,r={message:e.message,stack:e.stack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,metadata:t};let s=[];const l=localStorage.getItem(n);if(l)try{s=JSON.parse(l)}catch(a){}s.unshift(r),s=s.slice(0,i),localStorage.setItem(n,JSON.stringify(s))}catch(n){}}sendToConsole(e,t){e.stack}getUserId(){return localStorage.getItem("user_id")||sessionStorage.getItem("user_id")||"anonymous"}getSessionId(){let e=sessionStorage.getItem("session_id");return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("session_id",e)),e}getAuthToken(){return localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")||""}getBuildVersion(){return"unknown"}getEnvironment(){return"production"}getLogs(e){return void 0!==e?this.logs.filter(t=>t.level>=e):[...this.logs]}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}},se={debug:(e,t,a)=>re.debug(e,t,a),info:(e,t,a)=>re.info(e,t,a),warn:(e,t,a)=>re.warn(e,t,a),error:(e,t,a,n)=>re.error(e,t,a,n)},le=Object.freeze(Object.defineProperty({__proto__:null,LogLevel:ie,log:se,logger:re},Symbol.toStringTag,{value:"Module"})),ce=["Citrine","Tourmaline","Emerald","Garnet","Peridot","Jade","Sapphire","Turquoise","Pigeon Blood Ruby","Blue Rock","Black Rock","Rock"],oe=["friedfactory","pixeljourney"],de=["alien.worlds","prospectorsc","token.nefty"],he="781515",ue={ATOMIC_ASSETS:["https://atomic.wax.eosrio.io","https://wax-atomic.alcor.exchange","https://atomic-wax-mainnet.wecan.dev","https://wax.eosusa.io","https://wax-atomic-api.eosphere.io","https://atomic.3dkrender.com","https://aa-wax-public1.neftyblocks.com","https://atomic-wax.tacocrypto.io"],WAX_CHAIN:{EOSRIO:"https://wax.eosrio.io",WAXSWEDEN:"https://api.waxsweden.org",GREYMASS:"https://wax.greymass.com",EOSPHERE:"https://wax.eosphere.io",ALOHAEOS:"https://api.wax.alohaeos.com",PINK:"https://wax.pink.gg",CRYPTOLIONS:"https://wax.cryptolions.io",FALLBACK_ENDPOINTS:["https://wax.eosphere.io","https://wax.eosrio.io","https://api.wax.alohaeos.com","https://wax.pink.gg","https://api.waxsweden.org","https://wax.greymass.com","https://wax.cryptolions.io"],HYPERION_ENDPOINTS:["https://wax-hyperion.eosdetroit.io","https://wax.eosrio.io","https://api.waxsweden.org"],HIVEBP:"https://wax-api.hivebp.io",LIGHT_API:"https://wax.light-api.net"},SPECIALIZED:{ALCOR:"https://alcor.exchange/api/v2",DAPPLICA:"https://aa.dapplica.io",NEFTY:"https://api.neftyblocks.com"},IPFS:{GATEWAYS:["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://dweb.link/ipfs/"]},AVATAR:{DICEBEAR:"https://api.dicebear.com/7.x/identicon/svg"},HYPERION:["https://wax-hyperion.eosdetroit.io","https://wax.eosrio.io","https://api.waxsweden.org"],COINGECKO_API:"https://api.coingecko.com/api/v3/simple/price",EXCHANGE_RATE_API:"https://api.exchangerate-api.com/v4/latest/USD",SOCIAL:{TWITTER_INTENT:"https://twitter.com/intent/tweet",FACEBOOK_SHARE:"https://www.facebook.com/sharer/sharer.php",REDDIT_SUBMIT:"https://reddit.com/submit",TELEGRAM_SHARE:"https://t.me/share/url",DISCORD:"https://discord.gg/pixeljourney",ATOMICHUB_EXPLORER:"https://wax.atomichub.io/explorer",BLOKS_EXPLORER:"https://wax.bloks.io"},PIXEL_JOURNEY:{MAIN_SITE:"https://pixeljourney.xyz",DOCS:"https://docs.pixeljourney.xyz",LOGO:"/logo.png",DEFAULT_IMAGE:"https://pixeljourney.xyz/img/toppixals/10.webp",LEADERBOARD:"https://lb.pixeljourney.xyz/",CRAFTING_DOCS:"https://docs.pixeljourney.xyz/season-1/recycling-and-crafting"},DICEBEAR_API:"https://api.dicebear.com/7.x/identicon/svg",GOOGLE_FONTS:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap",WAX_WALLET:"https://wallet.wax.io"};class me{static isValidWaxRock(e){return"none"!==e&&ce.includes(e)}static getWaxRockTypes(){return ce}static async getPartnerCollections(){const e=Date.now();if(this.configCache.partnerCollections&&this.configCache.lastFetch&&e-this.configCache.lastFetch<this.CACHE_DURATION)return this.configCache.partnerCollections;try{const{apiService:t}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),a=await t.getPartnerCollections();return this.configCache.partnerCollections=a,this.configCache.lastFetch=e,a}catch(t){return se.warn("Failed to fetch partner collections from API, using fallback","MarketplaceConfig",{error:t}),[...oe]}}static getPartnerCollectionsSync(){return this.configCache.partnerCollections||oe}static async getTokenContracts(){const e=Date.now();if(this.configCache.tokenContracts&&this.configCache.lastFetch&&e-this.configCache.lastFetch<this.CACHE_DURATION)return this.configCache.tokenContracts;try{const{apiService:t}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),a=await t.getTokenContracts();return this.configCache.tokenContracts=a,this.configCache.lastFetch=e,a}catch(t){return se.warn("Failed to fetch token contracts from API, using fallback","MarketplaceConfig",{error:t}),[...de]}}static getTokenContractsSync(){return this.configCache.tokenContracts||de}static getPixalTemplateId(){return he}static isPixalPFP(e){return e===he}static generateFiltersFromAssets(e){const t=new Set,a=new Map;t.add("All Items"),e.forEach(e=>{if(e.traits&&"object"==typeof e.traits&&null!==e.traits&&Object.keys(e.traits).forEach(t=>{const n=e.traits[t];if(n&&"none"!==n&&""!==n){const e=`${t}: ${n}`;a.set(e,(a.get(e)||0)+1)}}),e.data&&"object"==typeof e.data&&null!==e.data&&Object.keys(e.data).forEach(t=>{const n=e.data[t];if(n&&"none"!==n&&""!==n){const e=`${t}: ${n}`;a.set(e,(a.get(e)||0)+1)}}),e.collection){const t=`Collection: ${e.collection}`;a.set(t,(a.get(t)||0)+1)}if(e.schema){const t=`Schema: ${e.schema}`;a.set(t,(a.get(t)||0)+1)}});const n=Math.max(2,Math.floor(.05*e.length));return a.forEach((e,a)=>{e>=n&&t.add(a)}),Array.from(t).sort()}static async preloadConfiguration(){try{await Promise.all([this.getPartnerCollections(),this.getTokenContracts()])}catch(e){se.warn("Failed to preload marketplace configuration","MarketplaceConfig",{error:e})}}static clearCache(){this.configCache={}}}t(me,"configCache",{}),t(me,"CACHE_DURATION",3e5);const pe=Object.freeze(Object.defineProperty({__proto__:null,API_ENDPOINTS:ue,MarketplaceConfigService:me,PARTNER_COLLECTIONS:oe,PIXAL_TEMPLATE_ID:he,TOKEN_CONTRACTS:de,WAXROCK_TYPES:ce},Symbol.toStringTag,{value:"Module"})),fe=new class{constructor(){t(this,"exchangeRates",{}),t(this,"cryptoRates",{bitcoin:{usd:0},ethereum:{usd:0}}),t(this,"lastFetchTime",0),t(this,"CACHE_DURATION",6e5),t(this,"EXCHANGE_API",ue.EXCHANGE_RATE_API),t(this,"CRYPTO_API",ue.COINGECKO_API),t(this,"FALLBACK_RATES",{USD:1,EUR:.85,DKK:6.3,AED:3.67,INR:83.12,RUB:74.5,CNY:7.1,JPY:110}),t(this,"FALLBACK_CRYPTO",{bitcoin:{usd:115e3},ethereum:{usd:4e3}})}async getExchangeRates(){const e=Date.now();if(Object.keys(this.exchangeRates).length>0&&e-this.lastFetchTime<this.CACHE_DURATION)return this.exchangeRates;try{const a=await fetch(this.EXCHANGE_API,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const n=await a.json();this.exchangeRates={USD:1,EUR:n.rates?.EUR||this.FALLBACK_RATES.EUR,DKK:n.rates?.DKK||this.FALLBACK_RATES.DKK,AED:n.rates?.AED||this.FALLBACK_RATES.AED,INR:n.rates?.INR||this.FALLBACK_RATES.INR,RUB:n.rates?.RUB||this.FALLBACK_RATES.RUB,CNY:n.rates?.CNY||this.FALLBACK_RATES.CNY,JPY:n.rates?.JPY||this.FALLBACK_RATES.JPY};try{const e=await fetch(this.CRYPTO_API,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){const t=await e.json();this.cryptoRates={bitcoin:{usd:t.bitcoin?.usd||this.FALLBACK_CRYPTO.bitcoin.usd},ethereum:{usd:t.ethereum?.usd||this.FALLBACK_CRYPTO.ethereum.usd}}}}catch(t){ee.logError("CurrencyService.getCryptoRates",t),this.cryptoRates=this.FALLBACK_CRYPTO}return this.lastFetchTime=e,this.exchangeRates}catch(a){return ee.logError("CurrencyService.getExchangeRates",a,{api:this.EXCHANGE_API}),this.exchangeRates=this.FALLBACK_RATES,this.cryptoRates=this.FALLBACK_CRYPTO,this.lastFetchTime=e,this.exchangeRates}}async convertUSDToCurrency(e,t){if(e<=0)return"0.00";if("BTC"===t){await this.getExchangeRates();const t=e/this.cryptoRates.bitcoin.usd;return t>=.001?t.toFixed(6):t.toExponential(2)}if("ETH"===t){await this.getExchangeRates();const t=e/this.cryptoRates.ethereum.usd;return t>=.001?t.toFixed(6):t.toExponential(2)}const a=(await this.getExchangeRates())[t];if(!a)return"0.00";const n=e*a;return"JPY"===t?Math.round(n).toString():n.toFixed(2)}async convertWaxToCurrency(e,t){try{const{priceService:a}=await f(async()=>{const{priceService:e}=await Promise.resolve().then(()=>ye);return{priceService:e}},void 0),n=await a.convertWaxToUSDAsync(e),i=parseFloat(n.replace(/[$,]/g,""));if("USD"===t)return n;const r=await this.convertUSDToCurrency(i,t);return this.formatCurrencyAmount(r,t)}catch(a){return ee.logError("CurrencyService.convertWaxToCurrency",a,{waxAmount:e,targetCurrency:t}),"0.00"}}formatCurrencyAmount(e,t){switch(t){case"USD":return`$${e}`;case"EUR":return`\u20ac${e}`;case"DKK":return`${e} kr`;case"AED":return`${e} \u062f.\u0625`;case"INR":return`\u20b9${e}`;case"RUB":return`${e} \u20bd`;case"CNY":case"JPY":return`\xa5${e}`;case"BTC":return`\u20bf${e}`;case"ETH":return`\u039e${e}`;default:return`${e} ${t}`}}getCurrencySymbol(e){return{USD:"$",EUR:"\u20ac",DKK:"kr",AED:"\u062f.\u0625",INR:"\u20b9",RUB:"\u20bd",CNY:"\xa5",JPY:"\xa5",BTC:"\u20bf",ETH:"\u039e"}[e]||e}},ve=new class{constructor(){t(this,"waxPriceUSD",.02),t(this,"wpixalPriceUSD",2e-5),t(this,"wpixalPriceWAX",.001),t(this,"pxjPriceUSD",1e-4),t(this,"lastFetchTime",0),t(this,"CACHE_DURATION",3e5),t(this,"COINGECKO_WAX_API","https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),t(this,"GECKOTERMINAL_WPIXAL_API","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:7845"),t(this,"GECKOTERMINAL_PXJ_POOLS",["https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:1195","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:1657","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:6560"]),t(this,"FALLBACK_WAX_PRICE",.02),t(this,"FALLBACK_WPIXAL_PRICE",2e-5),t(this,"FALLBACK_PXJ_PRICE",1e-4)}async fetchPrices(){const e=Date.now();if(!(e-this.lastFetchTime<this.CACHE_DURATION&&this.waxPriceUSD>0&&this.wpixalPriceUSD>0))try{const[a,n,...i]=await Promise.all([fetch(this.COINGECKO_WAX_API).catch(()=>null),fetch(this.GECKOTERMINAL_WPIXAL_API).catch(()=>null),...this.GECKOTERMINAL_PXJ_POOLS.map(e=>fetch(e).catch(()=>null))]);let r=null;if(a&&a.ok)try{const e=await a.json();r=e.wax?.usd}catch(t){se.warn("Failed to parse WAX price data:","PriceService.fetchPrices",{error:t})}let s=null;if(n&&n.ok)try{const e=await n.json();s=e.data?.attributes?.quote_token_price_usd,s&&(s=parseFloat(s))}catch(t){se.warn("Failed to parse WPIXAL price data:","PriceService.fetchPrices",{error:t})}let l=null;for(const e of i)if(e&&e.ok)try{const t=await e.json(),a=t.data?.attributes?.quote_token_price_usd;if(a){l=parseFloat(a);break}}catch(t){se.warn("Failed to parse PXJ price data from pool:","PriceService.fetchPrices",{error:t})}this.waxPriceUSD=r||this.FALLBACK_WAX_PRICE,this.wpixalPriceUSD=s||this.FALLBACK_WPIXAL_PRICE,this.pxjPriceUSD=l||this.FALLBACK_PXJ_PRICE,this.waxPriceUSD>0?this.wpixalPriceWAX=this.wpixalPriceUSD/this.waxPriceUSD:this.wpixalPriceWAX=.001,this.lastFetchTime=e}catch(t){ee.logError("PriceService.fetchPrices",t,{waxApi:this.COINGECKO_WAX_API,wpixalApi:this.GECKOTERMINAL_WPIXAL_API,pxjPools:this.GECKOTERMINAL_PXJ_POOLS,fallbackWaxPrice:this.FALLBACK_WAX_PRICE,fallbackWpixalPrice:this.FALLBACK_WPIXAL_PRICE,fallbackPxjPrice:this.FALLBACK_PXJ_PRICE}),this.waxPriceUSD=this.FALLBACK_WAX_PRICE,this.wpixalPriceUSD=this.FALLBACK_WPIXAL_PRICE,this.pxjPriceUSD=this.FALLBACK_PXJ_PRICE,this.wpixalPriceWAX=this.FALLBACK_WPIXAL_PRICE/this.FALLBACK_WAX_PRICE,this.lastFetchTime=e}}async getWaxPriceUSD(){return await this.fetchPrices(),this.waxPriceUSD}async getWpixalPriceWAX(){return await this.fetchPrices(),this.wpixalPriceWAX}async getWpixalPriceUSD(){return await this.fetchPrices(),this.wpixalPriceUSD}async getPxjPriceUSD(){return await this.fetchPrices(),this.pxjPriceUSD}convertWaxToUSD(e){const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t)||this.waxPriceUSD<=0)return"$0.00";const a=t*this.waxPriceUSD;return`$${ne(a,2)}`}async convertWaxToUSDAsync(e){return await this.getWaxPriceUSD(),this.convertWaxToUSD(e)}async convertWaxToCurrencyAsync(e,t="USD"){return"USD"===t?this.convertWaxToUSDAsync(e):fe.convertWaxToCurrency(e,t)}async convertWpixalToWAX(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"0.0000 WAX";const a=await this.getWpixalPriceWAX();return ae(t*a)}catch(t){return ee.logError("PriceService.convertWpixalToWAX",t,{wpixalAmount:e}),"0.0000 WAX"}}async convertWpixalToUSD(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"$0.00";const a=await this.getWpixalPriceUSD();return`$${ne(t*a,2)}`}catch(t){return ee.logError("PriceService.convertWpixalToUSD",t,{wpixalAmount:e}),"$0.00"}}async convertPxjToUSD(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"$0.00";const a=await this.getPxjPriceUSD();return`$${ne(t*a,6)}`}catch(t){return ee.logError("PriceService.convertPxjToUSD",t,{pxjAmount:e}),"$0.00"}}async convertPxjToWAX(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"0.0000 WAX";const a=await this.getPxjPriceUSD(),n=await this.getWaxPriceUSD();return ae(t*a/n)}catch(t){return ee.logError("PriceService.convertPxjToWAX",t,{pxjAmount:e}),"0.0000 WAX"}}async convertWaxWithDisplaySettings(e){try{const t=localStorage.getItem("selectedCurrency")||"USD";if(!JSON.parse(localStorage.getItem("showPricesInUSD")||"true")){const t=parseFloat(e.replace(/[^0-9.]/g,""));return ae(t)}return this.convertWaxToCurrencyAsync(e,t)}catch(t){return ee.logError("PriceService.convertWaxWithDisplaySettings",t,{waxAmount:e}),this.convertWaxToUSDAsync(e)}}},ye=Object.freeze(Object.defineProperty({__proto__:null,priceService:ve},Symbol.toStringTag,{value:"Module"})),ge=new class{isStorageAvailable(e){try{const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch{return!1}}get isLocalStorageAvailable(){return"undefined"!=typeof window&&this.isStorageAvailable(localStorage)}get isSessionStorageAvailable(){return"undefined"!=typeof window&&this.isStorageAvailable(sessionStorage)}getItem(e,t=!1){try{const a=t?sessionStorage:localStorage;if(t&&this.isSessionStorageAvailable)return a.getItem(e);if(!t&&this.isLocalStorageAvailable)return a.getItem(e);const n=t?localStorage:sessionStorage;return(t?this.isLocalStorageAvailable:this.isSessionStorageAvailable)?(re.warn(`Primary storage unavailable, using fallback for key: ${e}`),n.getItem(e)):(re.warn(`No storage available for key: ${e}`),null)}catch(a){return re.error("StorageService.getItem failed","StorageService",a,{key:e,useSessionStorage:t}),null}}setItem(e,t,a=!1){try{const n=a?sessionStorage:localStorage;if(a&&this.isSessionStorageAvailable)return n.setItem(e,t),!0;if(!a&&this.isLocalStorageAvailable)return n.setItem(e,t),!0;const i=a?localStorage:sessionStorage;return(a?this.isLocalStorageAvailable:this.isSessionStorageAvailable)?(re.warn(`Primary storage unavailable, using fallback for key: ${e}`),i.setItem(e,t),!0):(re.warn(`No storage available for key: ${e}`),!1)}catch(n){return re.error("StorageService.setItem failed","StorageService",n,{key:e,useSessionStorage:a}),!1}}removeItem(e,t=!1){try{const a=t?sessionStorage:localStorage;if(t&&this.isSessionStorageAvailable)return a.removeItem(e),!0;if(!t&&this.isLocalStorageAvailable)return a.removeItem(e),!0;let n=!1;return this.isLocalStorageAvailable&&(localStorage.removeItem(e),n=!0),this.isSessionStorageAvailable&&(sessionStorage.removeItem(e),n=!0),n||re.warn(`No storage available to remove key: ${e}`),n}catch(a){return re.error("StorageService.removeItem failed","StorageService",a,{key:e,useSessionStorage:t}),!1}}clear(e=!1){try{const t=e?sessionStorage:localStorage;return e&&this.isSessionStorageAvailable||!e&&this.isLocalStorageAvailable?(t.clear(),!0):(re.warn("No storage available to clear"),!1)}catch(t){return re.error("StorageService.clear failed","StorageService",t,{useSessionStorage:e}),!1}}getJSON(e,t,a=!1){try{const n=this.getItem(e,a);return null===n?t:JSON.parse(n)}catch(n){return re.error("StorageService.getJSON failed","StorageService",n,{key:e,useSessionStorage:a}),t}}setJSON(e,t,a=!1){try{const n=JSON.stringify(t);return this.setItem(e,n,a)}catch(n){return re.error("StorageService.setJSON failed","StorageService",n,{key:e,useSessionStorage:a}),!1}}getStorageStats(){const e=e=>{try{let t=0;for(const a in e)({}).hasOwnProperty.call(e,a)&&(t+=e[a].length+a.length);return{used:t,total:5242880}}catch{return{used:0,total:0}}};return{localStorage:{available:this.isLocalStorageAvailable,...e(this.isLocalStorageAvailable?localStorage:{})},sessionStorage:{available:this.isSessionStorageAvailable,...e(this.isSessionStorageAvailable?sessionStorage:{})}}}isQuotaExceeded(){const e=this.getStorageStats(),t=e.localStorage.used/e.localStorage.total,a=e.sessionStorage.used/e.sessionStorage.total;return t>.9||a>.9}cleanup(e=[]){let t=0;try{const a=[{storage:localStorage,available:this.isLocalStorageAvailable},{storage:sessionStorage,available:this.isSessionStorageAvailable}];for(const{storage:n,available:i}of a){if(!i)continue;const a=[];for(let t=0;t<n.length;t++){const i=n.key(t);if(i)for(const t of e)if(i.includes(t)){a.push(i);break}}for(const e of a)n.removeItem(e),t++}}catch(a){re.error("StorageService.cleanup failed","StorageService",a,{keyPatterns:e})}return t}},be=new class{constructor(){t(this,"storageKey","pixal-marketplace-cart"),t(this,"cart",[]),t(this,"listeners",[]),this.loadCart()}loadCart(){try{this.cart=ge.getJSON(this.storageKey,[])}catch(e){ee.logError("CartService.loadCart",e),this.cart=[]}}saveCart(){try{ge.setJSON(this.storageKey,this.cart)||ee.logError("CartService.saveCart",new Error("Failed to save cart to storage"),{storageKey:this.storageKey,cartSize:this.cart.length}),this.notifyListeners()}catch(e){ee.logError("CartService.saveCart",e,{storageKey:this.storageKey,cartSize:this.cart.length})}}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.listeners.forEach(e=>e([...this.cart]))}addToCart(e){if(-1!==this.cart.findIndex(t=>t.nft.asset_id===e.asset_id))return!1;const t={nft:e,addedAt:Date.now(),isAvailable:!0,sale_id:e.sale_id};return this.cart.push(t),this.saveCart(),!0}removeFromCart(e){const t=this.cart.length;return this.cart=this.cart.filter(t=>t.nft.asset_id!==e),this.cart.length!==t&&(this.saveCart(),!0)}isInCart(e){return this.cart.some(t=>t.nft.asset_id===e)}getCart(){return[...this.cart]}getCartCount(){return this.cart.length}clearCart(){this.cart=[],this.saveCart()}cleanupUnavailableItems(){const e=this.cart.length;this.cart=this.cart.filter(e=>!1!==e.isAvailable),this.cart.length!==e&&this.saveCart()}async calculateTotals(){const e=this.cart.filter(e=>!1!==e.isAvailable);let t=0;e.forEach(e=>{if(e.nft.price){const a=parseFloat(e.nft.price.replace(" WAX",""));isNaN(a)||(t+=a)}});const a=`${t.toFixed(4)} WAX`;return{totalWAX:a,totalUSD:await ve.convertWaxToUSDAsync(a),itemCount:e.length}}async checkAvailability(){if(0===this.cart.length)return;const{apiService:e}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0);try{const t=this.cart.map(e=>e.sale_id).filter(Boolean);if(0===t.length)return;const a=`${e.atomicMarketAPI}/atomicmarket/v1/sales?ids=${t.join(",")}&state=1&limit=${t.length}`,n=await e.fetchWithRetry(a),i=await n.json(),r=new Set(i.success&&i.data?i.data.map(e=>e.sale_id):[]);for(const e of this.cart)e.isAvailable=!!e.sale_id&&r.has(e.sale_id)}catch(t){ee.logError("CartService.checkAvailability",t,{cartSize:this.cart.length});for(const e of this.cart)e.isAvailable=!1}this.saveCart()}toggleSelection(e){const t=this.cart.find(t=>t.nft.asset_id===e);t&&(t.selected=!t.selected,this.saveCart())}selectAll(){this.cart.forEach(e=>{!1!==e.isAvailable&&(e.selected=!0)}),this.saveCart()}deselectAll(){this.cart.forEach(e=>{e.selected=!1}),this.saveCart()}getSelectedItems(){return this.cart.filter(e=>!0===e.selected)}getSelectedCount(){return this.cart.filter(e=>!0===e.selected).length}removeSelectedItems(){this.cart=this.cart.filter(e=>!0!==e.selected),this.saveCart()}isSelected(e){const t=this.cart.find(t=>t.nft.asset_id===e);return!0===t?.selected}},Ne=i.createContext(void 0),we=({children:e})=>{const[t,a]=i.useState(()=>({showOtherCollections:JSON.parse(localStorage.getItem("showOtherCollections")||"true"),showWhitelistedOnly:JSON.parse(localStorage.getItem("showWhitelistedOnly")||"true"),enableAnimatedNFTs:JSON.parse(localStorage.getItem("enableAnimatedNFTs")||"true"),showExplicitContent:JSON.parse(localStorage.getItem("showExplicitContent")||"false"),blockNSFW:JSON.parse(localStorage.getItem("blockNSFW")||"false"),blockAI:JSON.parse(localStorage.getItem("blockAI")||"false"),showChatButton:JSON.parse(localStorage.getItem("showChatButton")||"true"),autoPlayVideos:JSON.parse(localStorage.getItem("autoPlayVideos")||"false"),muteVideos:JSON.parse(localStorage.getItem("muteVideos")||"true"),showVideoControls:JSON.parse(localStorage.getItem("showVideoControls")||"true"),showPricesInUSD:JSON.parse(localStorage.getItem("showPricesInUSD")||"true"),selectedCurrency:localStorage.getItem("selectedCurrency")||"USD",showRarityRankings:JSON.parse(localStorage.getItem("showRarityRankings")||"true")})),n={settings:t,updateSetting:(e,t)=>{a(a=>{const n={...a,[e]:t};return"string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)),n})}};return H.jsx(Ne.Provider,{value:n,children:e})},ke=()=>{const e=i.useContext(Ne);if(void 0===e)throw new Error("useDisplaySettings must be used within a DisplaySettingsProvider");return e},xe=new class{constructor(){t(this,"sessionId"),t(this,"userId"),t(this,"session"),t(this,"performanceMetrics",[]),t(this,"apiMetrics",[]),t(this,"errorReports",[]),t(this,"isEnabled",!0),t(this,"batchSize",50),t(this,"flushInterval",3e4),t(this,"maxStoredMetrics",1e3),t(this,"pendingBatches",[]),t(this,"batchTimeout",null),this.sessionId=this.generateSessionId(),this.session={sessionId:this.sessionId,startTime:Date.now(),lastActivity:Date.now(),pageViews:0,events:[]},this.initializeMonitoring(),this.startPerformanceObserver(),this.setupErrorHandlers(),this.startFlushTimer()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}initializeMonitoring(){"undefined"!=typeof window&&window.performance&&(window.addEventListener("load",()=>{setTimeout(()=>{this.trackPageLoadPerformance()},0)}),document.addEventListener("visibilitychange",()=>{this.trackEvent("page_visibility_change",{hidden:document.hidden})}),this.setupUserInteractionTracking())}startPerformanceObserver(){if("undefined"!=typeof window&&"PerformanceObserver"in window)try{new PerformanceObserver(e=>{for(const t of e.getEntries())"navigation"===t.entryType&&this.trackNavigationTiming(t)}).observe({entryTypes:["navigation"]}),new PerformanceObserver(e=>{for(const t of e.getEntries())"resource"===t.entryType&&this.trackResourceTiming(t)}).observe({entryTypes:["resource"]}),new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformanceMetric("largest_contentful_paint",t.startTime)}).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformanceMetric("first_input_delay",t.processingStart-t.startTime)}).observe({entryTypes:["first-input"]})}catch(e){se.warn("Performance Observer not fully supported","MonitoringService.startPerformanceObserver",{error:e})}}setupErrorHandlers(){"undefined"!=typeof window&&(window.addEventListener("error",e=>{this.reportError(e.error||new Error(e.message),"global_error",{filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{this.reportError(e.reason instanceof Error?e.reason:new Error(String(e.reason)),"unhandled_promise_rejection")}))}setupUserInteractionTracking(){"undefined"!=typeof window&&(document.addEventListener("click",e=>{const t=e.target;t.matches('button, a, [role="button"], .clickable')&&this.trackEvent("user_click",{element:t.tagName.toLowerCase(),className:t.className,id:t.id,text:t.textContent?.slice(0,50)})}),document.addEventListener("submit",e=>{const t=e.target;this.trackEvent("form_submit",{formId:t.id,formClass:t.className,action:t.action})}))}startFlushTimer(){setInterval(()=>{this.flushMetrics()},this.flushInterval)}setUserId(e){this.userId=e,this.session.userId=e}trackEvent(e,t={}){if(!this.isEnabled)return;const a={event:e,properties:t,timestamp:Date.now(),userId:this.userId,sessionId:this.sessionId};this.session.events.push(a),this.session.lastActivity=Date.now(),this.addToBatch("events",a),this.session.events.length>this.maxStoredMetrics&&(this.session.events=this.session.events.slice(-this.maxStoredMetrics/2))}trackPerformanceMetric(e,t,a){if(!this.isEnabled)return;const n={name:e,value:t,timestamp:Date.now(),context:a};this.performanceMetrics.push(n),this.addToBatch("performance",n),this.performanceMetrics.length>this.maxStoredMetrics&&(this.performanceMetrics=this.performanceMetrics.slice(-this.maxStoredMetrics/2))}trackAPICall(e,t,a,n,i,r){if(!this.isEnabled)return;const s={endpoint:e,method:t,duration:a,status:n,timestamp:Date.now(),success:i,retryCount:r};this.apiMetrics.push(s),this.addToBatch("api",s),a>5e3&&this.trackPerformanceMetric("slow_api_call",a,{endpoint:e,method:t,status:n}),this.apiMetrics.length>this.maxStoredMetrics&&(this.apiMetrics=this.apiMetrics.slice(-this.maxStoredMetrics/2))}reportError(e,t,a){if(!this.isEnabled)return;se.error(`${t}: ${e.message}`,"monitoringService.reportError",e,{...a});const n={error:e,context:t,additionalInfo:a,timestamp:Date.now(),userId:this.userId,sessionId:this.sessionId,userAgent:navigator.userAgent,url:window.location.href,stackTrace:e.stack};this.errorReports.push(n),this.trackEvent("error_occurred",{context:t,errorName:e.name,errorMessage:e.message,...a}),this.errorReports.length>this.maxStoredMetrics&&(this.errorReports=this.errorReports.slice(-this.maxStoredMetrics/2))}trackPageLoadPerformance(){if(!window.performance||!window.performance.timing)return;const e=window.performance.timing,t=window.performance.navigation,a=e.loadEventEnd-e.navigationStart,n=e.domContentLoadedEventEnd-e.navigationStart,i=e.responseStart-e.navigationStart,r=e.domInteractive-e.navigationStart;this.trackPerformanceMetric("page_load_time",a),this.trackPerformanceMetric("dom_content_loaded_time",n),this.trackPerformanceMetric("first_byte_time",i),this.trackPerformanceMetric("dom_interactive_time",r),this.trackEvent("page_load",{pageLoadTime:a,domContentLoadedTime:n,firstByteTime:i,domInteractiveTime:r,navigationType:t.type,redirectCount:t.redirectCount})}trackNavigationTiming(e){this.trackPerformanceMetric("dns_lookup_time",e.domainLookupEnd-e.domainLookupStart),this.trackPerformanceMetric("tcp_connect_time",e.connectEnd-e.connectStart),this.trackPerformanceMetric("request_response_time",e.responseEnd-e.requestStart),this.trackPerformanceMetric("dom_processing_time",e.domComplete-e.domContentLoadedEventStart)}trackResourceTiming(e){(e.name.includes(".js")||e.name.includes(".css")||e.name.includes("api"))&&this.trackPerformanceMetric("resource_load_time",e.duration,{resource:e.name,type:e.initiatorType,size:e.transferSize})}getSessionSummary(){return{...this.session,events:[...this.session.events]}}getPerformanceMetrics(){return[...this.performanceMetrics]}getAPIMetrics(){return[...this.apiMetrics]}getErrorReports(){return[...this.errorReports]}async flushMetrics(){if(!this.isEnabled)return;const e={session:this.getSessionSummary(),performance:this.getPerformanceMetrics(),api:this.getAPIMetrics(),errors:this.getErrorReports(),timestamp:Date.now()};try{const t=JSON.parse(localStorage.getItem("monitoring_data")||"[]");t.push(e);const a=t.slice(-10);localStorage.setItem("monitoring_data",JSON.stringify(a))}catch(t){se.warn("Failed to store monitoring data","MonitoringService.flushMetrics",{error:t})}this.performanceMetrics=[],this.apiMetrics=[],this.errorReports=[],this.session.events=[]}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}isMonitoringEnabled(){return this.isEnabled}setBatchSize(e){this.batchSize=Math.max(10,Math.min(e,200))}addToBatch(e,t){if(!this.isEnabled)return;let a=this.pendingBatches.find(t=>t.type===e);a||(a={type:e,data:[],timestamp:Date.now()},this.pendingBatches.push(a)),a.data.push(t),a.data.length>=this.batchSize&&(this.processBatch(a),this.pendingBatches=this.pendingBatches.filter(e=>e!==a)),this.scheduleBatchProcessing()}scheduleBatchProcessing(){this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.processAllPendingBatches()},5e3)}async processBatch(e){try{const t={...e,batchId:this.generateBatchId(),processedAt:Date.now()},a=JSON.parse(localStorage.getItem("monitoring_batches")||"[]");a.push(t);const n=a.slice(-20);localStorage.setItem("monitoring_batches",JSON.stringify(n))}catch(t){}}async processAllPendingBatches(){const e=[...this.pendingBatches];this.pendingBatches=[];for(const t of e)await this.processBatch(t);this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null)}generateBatchId(){return`batch_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setFlushInterval(e){this.flushInterval=Math.max(5e3,Math.min(e,3e5))}async exportData(){const e={session:this.getSessionSummary(),performance:this.getPerformanceMetrics(),api:this.getAPIMetrics(),errors:this.getErrorReports()};return JSON.stringify(e,null,2)}clearAllData(){this.performanceMetrics=[],this.apiMetrics=[],this.errorReports=[],this.session.events=[],localStorage.removeItem("monitoring_data")}};class Ce{constructor(e={}){t(this,"cache",new Map),t(this,"config"),t(this,"cleanupTimer",null),this.config={defaultTTL:3e5,maxSize:1e3,cleanupInterval:6e4,...e},this.startCleanup()}startCleanup(){this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}cleanup(){const e=Date.now(),t=[];for(const[a,n]of this.cache.entries())e-n.timestamp>n.ttl&&t.push(a);t.forEach(e=>this.cache.delete(e)),this.cache.size>this.config.maxSize&&Array.from(this.cache.entries()).sort(([,e],[,t])=>e.timestamp-t.timestamp).slice(0,this.cache.size-this.config.maxSize).forEach(([e])=>this.cache.delete(e))}set(e,t,a){const n={data:t,timestamp:Date.now(),ttl:a||this.config.defaultTTL};this.cache.set(e,n)}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data:null}has(e){const t=this.cache.get(e);return!!t&&!(Date.now()-t.timestamp>t.ttl&&(this.cache.delete(e),1))}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}async getOrFetch(e,t,a){const n=this.get(e);if(null!==n)return n;const i=await t();return this.set(e,i,a),i}setMany(e){e.forEach(({key:e,data:t,ttl:a})=>{this.set(e,t,a)})}getMany(e){return e.map(e=>({key:e,data:this.get(e)}))}getStats(){const e=Date.now();let t=0,a=0;for(const n of this.cache.values())e-n.timestamp>n.ttl?a++:t++;return{totalEntries:this.cache.size,validEntries:t,expiredEntries:a,hitRate:t/(t+a)||0}}destroy(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null),this.clear()}}const Ae=new Ce({defaultTTL:3e5,maxSize:1e3,cleanupInterval:6e4}),_e=new Ce({defaultTTL:6e5,maxSize:500,cleanupInterval:12e4}),Se=new Ce({defaultTTL:18e5,maxSize:200,cleanupInterval:3e5}),Pe=new Ce({defaultTTL:12e4,maxSize:100,cleanupInterval:3e4}),Te=new class{constructor(){t(this,"endpointGroups",new Map),t(this,"HEALTH_CHECK_TIMEOUT",5e3),t(this,"MAX_CONSECUTIVE_FAILURES",3),t(this,"HEALTH_CHECK_INTERVAL",3e5),t(this,"healthCheckTimers",new Map),this.initializeEndpointGroups(),this.startHealthChecks()}initializeEndpointGroups(){this.endpointGroups.set("atomic",{name:"atomic",currentIndex:0,fallbackStrategy:"priority",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://atomic.wax.eosrio.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax-atomic.alcor.exchange",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://atomic-wax-mainnet.wecan.dev",priority:3,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax.eosusa.io",priority:4,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3}]}),this.endpointGroups.set("waxChain",{name:"waxChain",currentIndex:0,fallbackStrategy:"priority",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://wax.eosphere.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax.eosrio.io",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://api.wax.alohaeos.com",priority:3,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3}]}),this.endpointGroups.set("hyperion",{name:"hyperion",currentIndex:0,fallbackStrategy:"fastest",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://wax.eosrio.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:2},{url:"https://api.wax.alohaeos.com",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:2}]})}getBestEndpoint(e){const t=this.endpointGroups.get(e);if(!t)return null;const a=t.endpoints.filter(e=>"healthy"===e.healthStatus);if(0===a.length){const e=t.endpoints.filter(e=>"degraded"===e.healthStatus);return e.length>0?this.selectEndpoint(e,t.fallbackStrategy):t.endpoints[0]?.url||null}return this.selectEndpoint(a,t.fallbackStrategy)}selectEndpoint(e,t){switch(t){case"priority":return e.sort((e,t)=>e.priority-t.priority)[0].url;case"fastest":return e.sort((e,t)=>e.averageResponseTime-t.averageResponseTime)[0].url;default:return e[Math.floor(Math.random()*e.length)].url}}reportFailure(e,t){const a=this.endpointGroups.get(e);if(!a)return;const n=a.endpoints.find(e=>e.url===t);n&&(n.consecutiveFailures++,n.consecutiveFailures>=this.MAX_CONSECUTIVE_FAILURES?n.healthStatus="unhealthy":n.consecutiveFailures>=1&&(n.healthStatus="degraded"))}reportSuccess(e,t,a){const n=this.endpointGroups.get(e);if(!n)return;const i=n.endpoints.find(e=>e.url===t);i&&(i.consecutiveFailures=0,i.healthStatus="healthy",0===i.averageResponseTime?i.averageResponseTime=a:i.averageResponseTime=.8*i.averageResponseTime+.2*a)}getEndpoints(e){const t=this.endpointGroups.get(e);return t?t.endpoints.map(e=>e.url):[]}getCurrentIndex(e){const t=this.endpointGroups.get(e);return t?t.currentIndex:0}setCurrentIndex(e,t){const a=this.endpointGroups.get(e);a&&t>=0&&t<a.endpoints.length&&(a.currentIndex=t)}startHealthChecks(){for(const[e,t]of this.endpointGroups){const a=setInterval(()=>{this.performHealthCheck(e)},t.healthCheckInterval);this.healthCheckTimers.set(e,a)}}async performHealthCheck(e){const t=this.endpointGroups.get(e);if(!t)return;const a=t.endpoints.map(async t=>{try{const a=Date.now(),n=new AbortController,i=setTimeout(()=>n.abort(),this.HEALTH_CHECK_TIMEOUT),r=await fetch(`${t.url}/health`,{method:"GET",signal:n.signal,headers:{Accept:"application/json"}});clearTimeout(i);const s=Date.now()-a;t.lastHealthCheck=Date.now(),r.ok?this.reportSuccess(e,t.url,s):this.reportFailure(e,t.url)}catch{t.lastHealthCheck=Date.now(),this.reportFailure(e,t.url)}});await Promise.allSettled(a)}getHealthStatus(){const e={};for(const[t,a]of this.endpointGroups)e[t]={healthy:a.endpoints.filter(e=>"healthy"===e.healthStatus).length,degraded:a.endpoints.filter(e=>"degraded"===e.healthStatus).length,unhealthy:a.endpoints.filter(e=>"unhealthy"===e.healthStatus).length};return e}destroy(){for(const e of this.healthCheckTimers.values())clearInterval(e);this.healthCheckTimers.clear()}},$e=new class{constructor(){t(this,"atomicEndpoints",[...ue.ATOMIC_ASSETS]),t(this,"hiveBPAPI",ue.WAX_CHAIN.HIVEBP),t(this,"waxLightAPI",ue.WAX_CHAIN.LIGHT_API),t(this,"alcorAPI",ue.SPECIALIZED.ALCOR),t(this,"waxChainEndpoints",[...ue.WAX_CHAIN.FALLBACK_ENDPOINTS]),t(this,"hyperionEndpoints",ue.WAX_CHAIN.HYPERION_ENDPOINTS),t(this,"currentEndpointIndex",0),t(this,"currentWaxChainIndex",0),t(this,"currentHyperionIndex",0),t(this,"adaptiveLimits",new Map),t(this,"DEFAULT_CACHE_TTL",3e5),t(this,"approvedCollections",["pixeljourney","friedfactory"]),t(this,"circuitBreakerState",new Map),t(this,"CIRCUIT_BREAKER_THRESHOLD",5),t(this,"CIRCUIT_BREAKER_TIMEOUT",6e4),t(this,"MAX_TIMEOUT",3e4),t(this,"endpointHealth",new Map),t(this,"HEALTH_CHECK_INTERVAL",3e5),t(this,"MAX_CONSECUTIVE_FAILURES",3),t(this,"healthCheckIntervalId",null),t(this,"healthConfigs",new Map),t(this,"eosNationEndpoints",{atomicEndpoints:[],waxChainEndpoints:[],hyperionEndpoints:[],lastUpdated:0}),t(this,"EOS_NATION_UPDATE_INTERVAL",36e5),t(this,"COLLECTION_WHITELIST",["alien.worlds","defiminingio","pixeljourney","crptomuffins","kogsofficial","mlb.topps","gpk.topps","pantheon","cbreakgaming","akufishheads","battleminers","twitchytides","novopangeaio","fadedmonsuta","bcbrawlers","nftopiafrens","drwawncompany","talesofcrypt","official.wax","music.worlds","gkniftyheads","dungeonitems","outlawtroops","byronartset1","prospectorsg","street.hero","crewtoonswax"]),this.currentEndpointIndex=0,this.currentWaxChainIndex=0,this.currentHyperionIndex=0,this.initializeHealthConfigs()}get waxChainAPI(){return Te.getBestEndpoint("waxChain")||this.waxChainEndpoints[this.currentWaxChainIndex]}get atomicMarketAPI(){return this.atomicEndpoints[this.currentEndpointIndex]}get atomicAssetsAPI(){return this.atomicEndpoints[this.currentEndpointIndex]}getCurrentAtomicEndpoint(){const e=Te.getBestEndpoint("atomic");if(e)return e;const t=this.getHealthyEndpoints(this.atomicEndpoints);if(t.length>0){const e=t[0];return this.currentEndpointIndex=this.atomicEndpoints.indexOf(e),e}return this.atomicEndpoints[this.currentEndpointIndex]||this.atomicEndpoints[0]}getFromCache(e){return e.startsWith("asset_")?_e.get(e):e.startsWith("collection_")?Se.get(e):e.startsWith("user_")?Pe.get(e):Ae.get(e)}setCache(e,t,a=this.DEFAULT_CACHE_TTL){e.startsWith("asset_")?_e.set(e,t,a):e.startsWith("collection_")?Se.set(e,t,a):e.startsWith("user_")?Pe.set(e,t,a):Ae.set(e,t,a)}reportEndpointHealth(e,t,a){try{const n=new URL(e),i=`${n.protocol}//${n.host}`;let r="atomic";(e.includes("wax.eosphere.io")||e.includes("wax.eosrio.io")||e.includes("api.wax.alohaeos.com"))&&(r=e.includes("/v2/history")||e.includes("/v1/history")?"hyperion":"waxChain"),t&&void 0!==a?Te.reportSuccess(r,i,a):t||Te.reportFailure(r,i)}catch(n){re.warn("Failed to report endpoint health:","ApiService.reportEndpointHealth",n)}}getCacheStats(){const e=_e.getStats(),t=Se.getStats(),a=Pe.getStats(),n=Ae.getStats();return{totalEntries:e.totalEntries+t.totalEntries+a.totalEntries+n.totalEntries,validEntries:e.validEntries+t.validEntries+a.validEntries+n.validEntries,expiredEntries:e.expiredEntries+t.expiredEntries+a.expiredEntries+n.expiredEntries,hitRate:(e.hitRate+t.hitRate+a.hitRate+n.hitRate)/4}}clearCache(){_e.clear(),Se.clear(),Pe.clear(),Ae.clear()}async warmupCache(e){try{const t=[],a=this.approvedCollections.slice(0,5);for(const e of a)t.push(this.getCollectionStats(e).catch(t=>ee.logError("ApiService.warmupCache.collectionStats",t,{collection:e})));t.push(this.getMarketStats().catch(e=>ee.logError("ApiService.warmupCache.marketStats",e))),e&&t.push(this.getUserInventoryOverview(e).catch(t=>ee.logError("ApiService.warmupCache.userInventory",t,{account:e}))),await Promise.allSettled(t)}catch(t){ee.logError("ApiService.warmupCache",t)}}async prefetchData(e){try{const t=[];if("marketplace"===e.currentPage&&t.push(this.getPxApprovedListings(100,100).catch(e=>ee.logError("ApiService.prefetch.marketplaceAssets",e))),"inventory"===e.currentPage&&e.userAccount&&t.push(this.getUserInventoryOptimized(e.userAccount,{page:2}).catch(t=>ee.logError("ApiService.prefetch.userInventory",t,{account:e.userAccount}))),e.recentCollections)for(const a of e.recentCollections.slice(0,3))t.push(this.getCollectionStats(a).catch(e=>ee.logError("ApiService.prefetch.recentCollection",e,{collection:a})));setTimeout(()=>{Promise.allSettled(t)},1e3)}catch(t){ee.logError("ApiService.prefetchData",t)}}invalidateCache(e){_e.clear(),Se.clear(),Pe.clear(),Ae.clear()}getAdaptiveLimit(e,t){const a=new URL(e).hostname,n=this.adaptiveLimits.get(a);return n?Math.min(t,n,100):Math.min(t,100)}updateAdaptiveLimit(e,t,a){const n=new URL(e).hostname;if(a){if(t<100){const e=this.adaptiveLimits.get(n)||t,a=Math.min(Math.floor(1.1*e),100);this.adaptiveLimits.set(n,a)}}else{const e=Math.max(Math.floor(.7*t),20);this.adaptiveLimits.set(n,e)}}async fetchAlcorAPI(e,t=3,a){let n=null;const i=Date.now(),r=a?.method||"GET";for(let l=0;l<t;l++)try{const s=await fetch(e,{method:r,headers:{Accept:"application/json","Content-Type":"application/json",...a?.headers},mode:"cors",signal:a?.signal,...a}),c=Date.now()-i;if(s.ok)return xe.trackAPICall(e,r,c,s.status,!0,l),s;n=new Error(`HTTP ${s.status}: ${s.statusText}`),l<t-1?await new Promise(e=>setTimeout(e,1e3*(l+1))):xe.trackAPICall(e,r,c,s.status,!1,l)}catch(s){const a=Date.now()-i;if(n=s,l===t-1&&(xe.trackAPICall(e,r,a,0,!1,l),xe.reportError(n,"alcor_api_error",{url:e,method:r,retries:l+1})),s instanceof Error&&"AbortError"===s.name)throw xe.reportError(s,"alcor_api_abort",{url:e,method:r}),s;l<t-1&&await new Promise(e=>setTimeout(e,1e3*(l+1)))}throw n||new Error("Failed to fetch from Alcor Exchange API")}initializeHealthConfigs(){this.healthConfigs.clear(),this.getValidatedEndpoints("atomic").forEach(e=>{this.healthConfigs.set(e,{path:"/atomicassets/v1/collections?limit=1",validator:e=>{const t=e;return Array.isArray(t.data)&&!0===t.success}})}),this.getValidatedEndpoints("waxChain").forEach(e=>{this.healthConfigs.set(e,{path:"/v1/chain/get_info",validator:e=>{const t=e;return"number"==typeof t.head_block_num&&t.head_block_num>0}})}),this.getValidatedEndpoints("hyperion").forEach(e=>{this.healthConfigs.set(e,{path:"/v2/health",validator:e=>{const t=e;return t.health&&"object"==typeof t.health&&"OK"===t.health.status||"OK"===t.health}})}),re.info(`[Health Config] Initialized configurations for ${this.healthConfigs.size} endpoints`)}getCircuitBreakerKey(e){try{return new URL(e).hostname}catch{return e}}isCircuitBreakerOpen(e){const t=this.circuitBreakerState.get(e);return!(!t||"open"!==t.state||Date.now()-t.lastFailure>this.CIRCUIT_BREAKER_TIMEOUT&&(t.state="half-open",1))}recordCircuitBreakerFailure(e){const t=this.circuitBreakerState.get(e)||{failures:0,lastFailure:0,state:"closed"};t.failures++,t.lastFailure=Date.now(),t.failures>=this.CIRCUIT_BREAKER_THRESHOLD&&(t.state="open"),this.circuitBreakerState.set(e,t)}recordCircuitBreakerSuccess(e){const t=this.circuitBreakerState.get(e);t&&(t.failures=0,t.state="closed",this.circuitBreakerState.set(e,t))}updateEndpointHealth(e,t,a){let n=this.endpointHealth.get(e);n||(n={isHealthy:!0,lastCheck:Date.now(),consecutiveFailures:0,responseTime:0},this.endpointHealth.set(e,n)),n.lastCheck=Date.now(),t?(n.consecutiveFailures=0,n.isHealthy=!0,n.responseTime=a):(n.consecutiveFailures++,n.consecutiveFailures>=this.MAX_CONSECUTIVE_FAILURES&&(n.isHealthy=!1)),this.endpointHealth.set(e,n)}isEndpointHealthy(e){const t=this.endpointHealth.get(e);return!t||!(Date.now()-t.lastCheck>2*this.HEALTH_CHECK_INTERVAL)&&t.isHealthy}async performHealthCheck(e){const t=this.getCircuitBreakerKey(e),a=this.healthConfigs.get(e)||{path:"",fallback:!0},n=a.path?`${e}${a.path}`:e;try{const i=Date.now(),r=await fetch(n,{method:a.path?"GET":"HEAD",signal:AbortSignal.timeout(1e4),headers:{Accept:"application/json"}});let s=r.ok;const l=Date.now()-i;if(r.ok&&a.validator){const n=await r.json();s=a.validator(n);const i=this.endpointHealth.get(t);(!s||i&&i.consecutiveFailures>0)&&re.info(`[HealthCheck] ${e}:`,"ApiService.performHealthCheck",{healthy:s,duration:`${l}ms`})}this.updateEndpointHealth(t,s,l),s||re.warn(`[HealthCheck] ${e} failed validation`)}catch(i){re.error(`[HealthCheck] ${e} error:`,"ApiService.performHealthCheck",i),this.updateEndpointHealth(t,!1,0)}}startHealthChecks(){this.healthCheckIntervalId&&(clearInterval(this.healthCheckIntervalId),this.healthCheckIntervalId=null),this.healthCheckIntervalId=setInterval(()=>{re.info("[HealthCheck] Starting periodic health check cycle..."),this.getValidatedEndpoints("atomic").forEach(e=>{this.performHealthCheck(e)}),this.getValidatedEndpoints("waxChain").forEach(e=>{this.performHealthCheck(e)}),this.getValidatedEndpoints("hyperion").forEach(e=>{this.performHealthCheck(e)}),re.info("[HealthCheck] Completed periodic health check cycle")},this.HEALTH_CHECK_INTERVAL),this.updateEosNationEndpoints()}stopHealthChecks(){this.healthCheckIntervalId&&(clearInterval(this.healthCheckIntervalId),this.healthCheckIntervalId=null,re.info("[HealthCheck] Health check interval stopped"))}enableHealthChecks(){re.info("[HealthCheck] Enabling health checks..."),this.startHealthChecks()}async updateEosNationEndpoints(){try{const e=Date.now();if(e-this.eosNationEndpoints.lastUpdated<this.EOS_NATION_UPDATE_INTERVAL)return;re.info("[EOS Nation] Fetching latest endpoint data...");const t=await fetch("https://validate.eosnation.io/wax/reports/endpoints.json",{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.json();if(!a||"object"!=typeof a)throw new Error("Invalid JSON response from EOS Nation API");if(!a.report||"object"!=typeof a.report)throw re.warn("[EOS Nation] No report data found in response:",a),new Error("Invalid response format from EOS Nation API");const n=a.report,i=this.parseEosNationEndpoints(n.atomic_https||[]),r=this.parseEosNationEndpoints(n.api_https2||[]),s=this.parseEosNationEndpoints(n.hyperion_https||[]);re.info("[EOS Nation] Raw endpoint counts:","ApiService.updateEosNationEndpoints",{atomic_https:Array.isArray(n.atomic_https)?n.atomic_https.length:"not array",api_https2:Array.isArray(n.api_https2)?n.api_https2.length:"not array",hyperion_https:Array.isArray(n.hyperion_https)?n.hyperion_https.length:"not array"}),this.eosNationEndpoints={atomicEndpoints:i,waxChainEndpoints:r,hyperionEndpoints:s,lastUpdated:e},re.info(`[EOS Nation] Updated endpoints: ${i.length} atomic, ${r.length} wax chain, ${s.length} hyperion`),this.initializeHealthConfigs(),setTimeout(()=>this.updateEosNationEndpoints(),this.EOS_NATION_UPDATE_INTERVAL)}catch(e){re.error("[EOS Nation] Failed to update endpoint data:","ApiService.updateEosNationEndpoints",e),setTimeout(()=>this.updateEosNationEndpoints(),6e5)}}parseEosNationEndpoints(e){return Array.isArray(e)?e.map(e=>{try{let t;if("string"==typeof e)t=e;else if("object"==typeof e&&null!==e){const a=e;t=a.url||a.endpoint||a.api_url||String(e)}else t=String(e);const a=t.trim().match(/https?:\/\/[^\s]+/);return a?a[0]:null}catch(t){return re.warn("[EOS Nation] Failed to parse endpoint","ApiService.updateEosNationEndpoints",t),null}}).filter(e=>null!==e).filter(e=>{try{return new URL(e),!0}catch{return!1}}):(re.warn("[EOS Nation] Expected array of endpoints, got:",typeof e),[])}getValidatedEndpoints(e){const t="atomic"===e?this.atomicEndpoints:"waxChain"===e?this.waxChainEndpoints:this.hyperionEndpoints,a="atomic"===e?this.eosNationEndpoints.atomicEndpoints:"waxChain"===e?this.eosNationEndpoints.waxChainEndpoints:this.eosNationEndpoints.hyperionEndpoints,n=[...new Set([...a,...t])];return re.info(`[Endpoint Selection] ${e}: ${n.length} total (${a.length} from EOS Nation, ${t.length} static)`),n}getHealthyEndpoints(e){return e.filter(e=>{const t=this.getCircuitBreakerKey(e);return this.isEndpointHealthy(t)&&!this.isCircuitBreakerOpen(t)})}classifyError(e,t){if(t){if(429===t)return"rate-limit";if(408===t||502===t||503===t||504===t)return"retryable";if(t>=400&&t<500)return"non-retryable";if(t>=500)return"retryable"}const a=e.message.toLowerCase();return a.includes("rate limit")||a.includes("429")||a.includes("too many requests")?"rate-limit":a.includes("timeout")||a.includes("network")||a.includes("connection")||a.includes("fetch")||a.includes("enotfound")||a.includes("econnreset")||a.includes("econnrefused")||a.includes("socket hang up")||"AbortError"===e.name?"retryable":a.includes("400")||a.includes("401")||a.includes("403")||a.includes("404")||a.includes("unauthorized")||a.includes("forbidden")||a.includes("not found")||a.includes("bad request")?"non-retryable":"retryable"}calculateDelay(e,t,a=!0){let n;if(n="rate-limit"===t?Math.min(1e3*Math.pow(2,e),this.MAX_TIMEOUT):Math.min(1e3*(e+1),5e3),a){const e=.1*n;n+=2*(Math.random()-.5)*e}return Math.max(n,100)}async fetchWithRetry(e,t=3,a){const n=this.getCircuitBreakerKey(e);let i=null;const r=Date.now();if(this.isCircuitBreakerOpen(n))throw new Error(`Circuit breaker is open for ${n}. Service temporarily unavailable.`);const s=a?.signal?void 0:15e3,l=new AbortController;let c;s&&!a?.signal&&(c=setTimeout(()=>l.abort(),s));const o={method:a?.method||"GET",headers:{Accept:"application/json","Content-Type":"application/json","User-Agent":"PxMarket/2.0",...a?.headers},mode:"cors",signal:a?.signal||l.signal,...a};try{if(e.includes("wax-api.hivebp.io")){for(let a=0;a<t;a++)try{const s=await fetch(e,o);if(s.ok){this.recordCircuitBreakerSuccess(n);const t=Date.now()-r;return this.reportEndpointHealth(e,!0,t),s}const l=this.classifyError(new Error(`HTTP ${s.status}`),s.status);if(i=new Error(`HTTP ${s.status}: ${s.statusText}`),"non-retryable"===l||a===t-1)break;const c=this.calculateDelay(a,l);await new Promise(e=>setTimeout(e,c))}catch(d){const e=d,n=this.classifyError(e);if(i=e,"non-retryable"===n||a===t-1)break;const r=this.calculateDelay(a,n);await new Promise(e=>setTimeout(e,r))}throw this.recordCircuitBreakerFailure(n),i||new Error("Failed to fetch from HiveBP API")}if(this.waxChainEndpoints.some(t=>e.includes(t))){const a=this.getHealthyEndpoints(this.waxChainEndpoints),n=a.length>0?a:this.waxChainEndpoints;for(let r=0;r<n.length;r++){const a=n[r];this.currentWaxChainIndex=this.waxChainEndpoints.indexOf(a);const s=e.replace(/https:\/\/[^/]+/,a),l=this.getCircuitBreakerKey(s);if(this.isCircuitBreakerOpen(l))continue;let c=!1;for(let e=0;e<t;e++)try{const a=await fetch(s,o);if(a.ok)return this.recordCircuitBreakerSuccess(l),c=!0,a;const n=this.classifyError(new Error(`HTTP ${a.status}`),a.status);if(i=new Error(`HTTP ${a.status}: ${a.statusText}`),400===a.status||"non-retryable"===n)break;if(e<t-1){const t=this.calculateDelay(e,n);await new Promise(e=>setTimeout(e,t))}}catch(d){const a=d,n=this.classifyError(a);if(i=a,"non-retryable"===n)break;if(e<t-1){const t=this.calculateDelay(e,n);await new Promise(e=>setTimeout(e,t))}}c||this.recordCircuitBreakerFailure(l)}throw i||new Error("All WAX Chain endpoints failed")}const a=this.getHealthyEndpoints(this.atomicEndpoints),s=a.length>0?a:this.atomicEndpoints;for(let n=0;n<s.length;n++){const a=s[n];this.currentEndpointIndex=this.atomicEndpoints.indexOf(a);const l=e.replace(/https:\/\/[^/]+/,a),c=this.getCircuitBreakerKey(l);if(this.isCircuitBreakerOpen(c))continue;let h=!1;for(let e=0;e<t;e++)try{const a=await fetch(l,o);if(a.ok){this.recordCircuitBreakerSuccess(c),h=!0;const e=Date.now()-r;return this.reportEndpointHealth(l,!0,e),a}const n=this.classifyError(new Error(`HTTP ${a.status}`),a.status);if(i=new Error(`HTTP ${a.status}: ${a.statusText}`),400===a.status||"non-retryable"===n)break;if(e<t-1){const t=this.calculateDelay(e,n);await new Promise(e=>setTimeout(e,t))}}catch(d){const a=d,n=this.classifyError(a);if(i=a,"non-retryable"===n)break;if(e<t-1){const t=this.calculateDelay(e,n);await new Promise(e=>setTimeout(e,t))}}h||this.recordCircuitBreakerFailure(c)}throw i||new Error("All endpoints failed")}finally{c&&clearTimeout(c)}}formatSaleData(e){const t=e.assets[0];return{sale_id:e.sale_id,asset_id:t?.asset_id||"",name:t?.name||`${t?.collection?.collection_name||"Unknown"} #${t?.asset_id||"N/A"}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:e.price?this.formatPrice(e.price):"0 WAX",seller:e.seller,collection:t?.collection?.collection_name||"Unknown",schema:t?.schema?.schema_name||"Unknown",template_mint:t?.template_mint?parseInt(t.template_mint.toString()):void 0,max_supply:t?.template?.max_supply||void 0,traits:t?.data?Object.fromEntries(Object.entries(t.data).filter(([,e])=>null!=e)):{}}}getAssetImage(e){const t=e?.data?.img||e?.template?.immutable_data?.img;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?`${ue.IPFS.GATEWAYS[0]}${t}`:t:ue.PIXEL_JOURNEY.DEFAULT_IMAGE}getAssetVideo(e){const t=e?.data?.video||e?.template?.immutable_data?.video;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?`${ue.IPFS.GATEWAYS[0]}${t}`:t:""}formatPrice(e){if(!e||!e.amount)return"0 WAX";const t=parseFloat(e.amount)/Math.pow(10,e.token_precision||8);return"WAX"!==e.token_symbol&&e.token_symbol?`${ne(t)} ${e.token_symbol}`:ae(t)}async getCheapestPixals(e=50,t=1){const a=this.atomicMarketAPI,n=this.getAdaptiveLimit(a,e);try{const e=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&sort=price&order=asc&limit=${n}&page=${t}`,i=await this.fetchWithRetry(e),r=await i.json();if(r.success&&r.data)return this.updateAdaptiveLimit(a,n,!0),r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(i){throw this.updateAdaptiveLimit(a,n,!1),ee.logError("ApiService.getCheapestPixals",i,{limit:e,adaptiveLimit:n,page:t}),i}}async getWaxRockPixals(e=50,t=1){const a=this.atomicMarketAPI,n=this.getAdaptiveLimit(a,e);try{const{MarketplaceConfigService:e}=await f(async()=>{const{MarketplaceConfigService:e}=await Promise.resolve().then(()=>pe);return{MarketplaceConfigService:e}},void 0),r=e.getWaxRockTypes();let s=[];for(const t of r)try{const e=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&immutable_data.WaxRock=${encodeURIComponent(t)}&sort=price&order=asc&limit=50&page=1`,n=await this.fetchWithRetry(e),i=await n.json();i.success&&i.data&&s.push(...i.data)}catch(i){re.warn(`Failed to fetch ${t} WaxRocks:`,"ApiService.getWaxRockPixals",i)}if(0===s.length){const n=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&sort=price&order=asc&limit=100&page=${t}`,i=await this.fetchWithRetry(n),l=await i.json();l.success&&l.data&&(s=l.data.filter(t=>{if(!t.assets||!t.assets[0])return!1;const a=t.assets[0],n=a.data?.WaxRock||a.template?.immutable_data?.WaxRock;if(n&&"string"==typeof n)return"none"!==n&&e.isValidWaxRock(n);const i=r.map(e=>e.toLowerCase());return!!a.data&&Object.values(a.data).some(e=>{if("string"==typeof e){const t=e.toLowerCase();return"none"!==t&&i.includes(t)}return!1})}))}const l=s.filter((e,t,a)=>t===a.findIndex(t=>t.sale_id===e.sale_id));l.sort((e,t)=>parseFloat(e.listing_price||"0")-parseFloat(t.listing_price||"0"));const c=(t-1)*n,o=l.slice(c,c+n);return this.updateAdaptiveLimit(a,n,!0),o.map(e=>this.formatSaleData(e))}catch(i){throw this.updateAdaptiveLimit(a,n,!1),ee.logError("ApiService.getWaxRockPixals",i,{limit:e,adaptiveLimit:n,page:t}),i}}async getPixelIngredients(e=20,t=1){try{const a=Math.min(e,50),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=ingredients&sort=price&order=asc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getPixelIngredients",a,{limit:e,page:t}),a}}async getBundleListings(e=20,t=1){try{const a=Math.min(e,50),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=bundles&sort=price&order=asc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getBundleListings",a,{limit:e,page:t}),a}}async getFriedFactoryNFTs(e=20,t=1){try{const a=Math.min(e,50),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=friedfactory&sort=price&order=asc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getFriedFactoryNFTs",a,{limit:e,page:t}),a}}async getCryptoMuffinsNFTs(e=20,t=1){try{const a=Math.min(e,50),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=cryptomuffins&sort=price&order=asc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getCryptoMuffinsNFTs",a,{limit:e,page:t}),a}}async getPartnerListings(e=16,t=1){try{const a=Math.min(e,50),n=me.getPartnerCollectionsSync().join(","),i=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=${n}&sort=created&order=desc&limit=${a}&page=${t}`,r=await this.fetchWithRetry(i),s=await r.json();if(s.success&&s.data)return s.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getPartnerListings",a,{limit:e,page:t}),a}}async getPxApprovedListings(e=16,t=1){try{const a=Math.min(e,50),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&sort=created&order=desc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getPxApprovedListings",a,{limit:e,page:t}),a}}async getAHVerifiedListings(e=16,t=1){try{const a=Math.min(e,50),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&verified=true&sort=created&order=desc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw ee.logError("ApiService.getAHVerifiedListings",a,{limit:e,page:t}),a}}async getAllWaxListings(e=16,t=1){const a=this.atomicMarketAPI,n=this.getAdaptiveLimit(a,e);try{const e=`${a}/atomicmarket/v1/sales?state=1&sort=created&order=desc&limit=${n}&page=${t}`,i=await this.fetchWithRetry(e),r=await i.json();if(r.success&&r.data)return this.updateAdaptiveLimit(a,n,!0),r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(i){throw this.updateAdaptiveLimit(a,n,!1),ee.logError("ApiService.getAllWaxListings",i,{limit:e,adaptiveLimit:n,page:t}),i}}async getRecentSales(e=50){try{const t=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&limit=${e}&order=desc&sort=updated`,a=await this.fetchWithRetry(t),n=await a.json();if(n.success&&n.data)return n.data;throw new Error("Invalid API response")}catch(t){return ee.logError("ApiService.getRecentSales",t,{limit:e}),[]}}async getSales(e={}){try{const{page:t=1,limit:a=100,order:n="desc",sort:i="updated",collection_name:r,schema_name:s,template_id:l,asset_id:c,seller:o,buyer:d,state:h="1,3",symbol:u="WAX",min_price:m,max_price:p,before:f,after:v}=e;let y=`${this.atomicMarketAPI}/atomicmarket/v1/sales?page=${t}&limit=${a}&order=${n}&sort=${i}&state=${h}&symbol=${u}`;r&&(y+=`&collection_name=${r}`),s&&(y+=`&schema_name=${s}`),l&&(y+=`&template_id=${l}`),c&&(y+=`&asset_id=${c}`),o&&(y+=`&seller=${o}`),d&&(y+=`&buyer=${d}`),m&&(y+=`&min_price=${m}`),p&&(y+=`&max_price=${p}`),f&&(y+=`&before=${f}`),v&&(y+=`&after=${v}`);const g=await this.fetchWithRetry(y),b=await g.json();return{success:b.success||!1,data:b.data||[],query_total:b.query_total}}catch(t){return ee.logError("ApiService.getSales",t,e),{success:!1,data:[]}}}async getCollections(e={}){try{const{limit:t=20,page:a=1,whitelistOnly:n=!0,author:i,match:r,order:s="desc",sort:l="created",singleCollection:c}=e,o=new URLSearchParams;if(c)o.append("collection_name",c),o.append("limit","1");else{if(n){const e=this.COLLECTION_WHITELIST.slice(0,Math.min(t,20)).map(async e=>{try{const t=await this.fetchWithRetry(`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}`),a=await t.json();return a.success&&a.data?a.data:null}catch{return null}});return(await Promise.all(e)).filter(e=>null!==e)}o.append("limit",Math.min(t,100).toString()),o.append("page",a.toString()),i&&o.append("author",i),r&&o.append("match",r)}o.append("order",s),o.append("sort",l);const d=`${this.atomicAssetsAPI}/atomicassets/v1/collections?${o.toString()}`,h=await this.fetchWithRetry(d),u=await h.json();if(u.success&&u.data)return u.data;throw new Error("Invalid API response")}catch(t){return ee.logError("ApiService.getCollections",t,e),[{collection_name:"pixeljourney",name:"Pixel Journey",img:"",author:"pixeljourney",allow_notify:!0,authorized_accounts:[],notify_accounts:[],market_fee:0,created_at_time:"",created_at_block:""},{collection_name:"friedfactory",name:"Fried Factory",img:"",author:"friedfactory",allow_notify:!0,authorized_accounts:[],notify_accounts:[],market_fee:0,created_at_time:"",created_at_block:""}]}}async getMarketStats(){try{const e=`${this.atomicAssetsAPI}/atomicmarket/v1/stats/graph`,t=await this.fetchWithRetry(e),a=await t.json();return a.success&&a.data&&a.data.length>0?a.data[a.data.length-1]:null}catch(e){return ee.logError("ApiService.getMarketStats",e),null}}async getCollectionDetails(e){const t=`collection-${e}`;if(this.isCircuitBreakerOpen(t))return null;try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}`,a=await this.fetchWithRetry(t),n=await a.json();return n.success&&n.data?n.data:null}catch(a){return this.recordCircuitBreakerFailure(t),this.isCircuitBreakerOpen(t)||ee.logError("ApiService.getCollectionDetails",a,{collectionName:e}),null}}async getCollectionSchemas(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/schemas?collection_name=${e}&limit=${t}&order=desc&sort=created`,n=await this.fetchWithRetry(a),i=await n.json();return i.success&&i.data?i.data:[]}catch(a){return ee.logError("ApiService.getCollectionAssets",a,{collectionName:e,limit:t}),[]}}async getCollectionTemplates(e,t,a=50){try{let n=`${this.atomicAssetsAPI}/atomicassets/v1/templates?collection_name=${e}&limit=${a}&order=desc&sort=created`;t&&(n+=`&schema_name=${t}`);const i=await this.fetchWithRetry(n),r=await i.json();return r.success&&r.data?r.data:[]}catch(n){return ee.logError("ApiService.getCollectionTemplates",n,{collectionName:e,schemaName:t,limit:a}),[]}}async getCollectionAssets(e,t,a,n=50){try{let i=`${this.getCurrentAtomicEndpoint()}/atomicmarket/v1/assets?collection_name=${e}&burned=false&limit=${n}&order=desc&sort=asset_id`;t&&(i+=`&schema_name=${t}`),a&&(i+=`&template_id=${a}`);const r=await this.fetchWithRetry(i),s=await r.json();return s.success&&s.data?s.data:[]}catch(i){return ee.logError("ApiService.getCollectionAssets",i,{collectionName:e,schemaName:t,templateId:a,limit:n}),[]}}async getAssetDetails(e){try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/assets/${e}`,a=await this.fetchWithRetry(t),n=await a.json();return n.success&&n.data?n.data:null}catch(t){return ee.logError("ApiService.getAssetDetails",t,{assetId:e}),null}}async getCollectionStats(e){try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}/stats`,a=await this.fetchWithRetry(t),n=await a.json();return n.success&&n.data?n.data:null}catch(t){return ee.logError("ApiService.getCollectionSchemas",t,{collectionName:e}),null}}async getCollectionBurns(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/burns?collection_name=${e}&limit=${t}&order=desc&sort=created`,n=await this.fetchWithRetry(a),i=await n.json();return i.success&&i.data?i.data:[]}catch(a){return ee.logError("ApiService.getCollectionBurns",a,{collectionName:e,limit:t}),[]}}async getCollectionTransfers(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/transfers?collection_name=${e}&limit=${t}&order=desc&sort=created`,n=await this.fetchWithRetry(a),i=await n.json();return i.success&&i.data?i.data:[]}catch(a){return ee.logError("ApiService.getCollectionTransfers",a,{collectionName:e,limit:t}),[]}}async getCollectionVolumeGraph(e,t=30){try{const a=`${this.hiveBPAPI}/v3/sales-volume-graph/${t}/${e}`,n=await this.fetchWithRetry(a);return await n.json()}catch(a){return re.warn(`HiveBP volume graph not available for ${e}`,"API",a),null}}async getCollectionMarketCap(e){try{const t=`${this.hiveBPAPI}/v3/collection-marketcap/${e}`,a=await this.fetchWithRetry(t);return await a.json()}catch(t){return re.warn(`HiveBP market cap not available for ${e}`,"API",t),null}}async getSimilarCollections(e){try{const t=`${this.hiveBPAPI}/v3/similar-collections/${e}`,a=await this.fetchWithRetry(t);return await a.json()||[]}catch(t){return re.warn(`HiveBP similar collections not available for ${e}`,"API",t),[]}}async getCollectionAnalytics(e){try{const t=`${this.hiveBPAPI}/v3/collection-stats/${e}`,a=await this.fetchWithRetry(t);return await a.json()}catch(t){return re.warn(`HiveBP analytics not available for ${e}`,"API",t),null}}async getHiveBPMarketCap(e){try{const t=`${this.hiveBPAPI}/v3/marketcap/${e}`,a=await this.fetchWithRetry(t),n=await a.json();return n?.marketcap||null}catch(t){return re.warn(`HiveBP market cap not available for ${e}`,"API",t),null}}async getHiveBPVolumeDays(e,t=1){try{const a=`${this.hiveBPAPI}/v3/volume/${t}/${e}`,n=await this.fetchWithRetry(a),i=await n.json();return i?.volume||null}catch(a){return re.warn(`HiveBP volume data not available for ${e}`,"API",a),null}}async getHiveBPFloorPrice(e){try{const t=`${this.hiveBPAPI}/v3/floor/${e}`,a=await this.fetchWithRetry(t),n=await a.json();return n?.floor_price||null}catch(t){return re.warn(`HiveBP floor price not available for template ${e}`,"API",t),null}}async getEnhancedCollectionStats(e){try{const[a,n,i]=await Promise.all([this.getHiveBPMarketCap(e),this.getHiveBPVolumeDays(e,1),this.getHiveBPVolumeDays(e,7)]);let r=null;try{const t=await this.getCollectionTemplates(e,void 0,1);t.length>0&&(r=await this.getHiveBPFloorPrice(t[0].template_id))}catch(t){re.warn(`Could not fetch floor price for ${e}`,"API",t)}return{marketCap:a,volume24h:n,volume7d:i,floorPrice:r}}catch(t){return ee.logError("ApiService.getCollectionStats",t,{collectionName:e}),{marketCap:null,volume24h:null,volume7d:null,floorPrice:null}}}async getCollectionTopSales(e,t=20){try{const a=`${this.atomicAssetsAPI}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=${t}&order=desc&sort=price`,n=await this.fetchWithRetry(a),i=await n.json();return i.success&&i.data?i.data:[]}catch(a){return ee.logError("ApiService.getCollectionTopSales",a,{collectionName:e,limit:t}),[]}}async getCollectionFloorPrice(e){try{const t=`${this.atomicAssetsAPI}/atomicmarket/v1/sales?collection_name=${e}&state=1&limit=1&order=asc&sort=price`,a=await this.fetchWithRetry(t),n=await a.json();return n.success&&n.data&&n.data.length>0?{floorPrice:parseFloat(n.data[0].listing_price)/1e8}:{floorPrice:0}}catch(t){return ee.logError("ApiService.getCollectionFloorPrice",t,{collectionName:e}),{floorPrice:0}}}async getCollectionHolders(e,t=50,a=0){try{let n=`${this.atomicAssetsAPI}/atomicassets/v1/accounts?collection_name=${e}&limit=${t}&order=desc&sort=assets`;a>0&&(n+=`&page=${Math.floor(a/t)+1}`);const i=await this.fetchWithRetry(n),r=await i.json();return r.success&&r.data?r.data:[]}catch(n){return ee.logError("ApiService.getCollectionHolders",n,{collectionName:e,limit:t,offset:a}),[]}}async getNFTTradingStats(){try{const e=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&after=${Date.now()-864e5}&limit=1000`),t=await e.json();let a=0,n=0;t.success&&t.data&&(n=t.data.length,a=t.data.reduce((e,t)=>e+(t.price?parseFloat(t.price.amount)/Math.pow(10,t.price.token_precision):0),0));const i=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&limit=1`),r=await i.json(),s=r.success?parseInt(r.query_time):0;return{collection_name:"global",dailyVolume:ne(a),dailySales:n,totalTransactions:n,activeListings:s,averagePrice:n>0?ne(a/n):"0"}}catch(e){return ee.logError("ApiService.getNFTTradingStats",e),null}}async getTopCollectionsByVolume(e=10){try{const t=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/stats/collections?limit=${e}&sort=volume`),a=await t.json();return a.success&&a.data?a.data.map(e=>({collection_name:e.collection_name,volume_24h:e.volume?ae(parseFloat(e.volume)/1e8):"0 WAX",sales_24h:parseInt(e.sales||"0")||0,floor_price:e.floor_price?ae(parseFloat(e.floor_price)/1e8):"0 WAX",assets_count:e.assets||"0"})):[]}catch(t){return ee.logError("ApiService.getTopCollectionsByVolume",t,{limit:e}),[]}}async getRecentNFTTrades(e=20){try{const t=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&limit=${e}&sort=updated`),a=await t.json();return a.success&&a.data?a.data.map(e=>({sale_id:e.sale_id,collection_name:e.collection_name||e.assets[0]?.collection?.collection_name||"Unknown",asset_name:e.assets[0]?.name||`Asset #${e.assets[0]?.asset_id}`,price:e.price?ae(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision)):"0 WAX",buyer:e.buyer,seller:e.seller,timestamp:e.updated_at_time})):[]}catch(t){return ee.logError("ApiService.getNFTTradingStats",t,{limit:e}),[]}}async getUserInventory(e,t=1e3){try{const a=this.approvedCollections.join(","),n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${a}&burned=false&limit=${t}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))}));throw new Error("Invalid API response")}catch(a){return ee.logError("ApiService.getUserInventory",a,{account:e}),[]}}async getUserInventoryPaginated(e,t=1,a=1e3){try{const n=this.approvedCollections.join(","),i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${n}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),s=await r.json();if(s.success&&s.data){const n=s.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=s.data.length===a;return{assets:n,hasMore:i,total:(t-1)*a+s.data.length+(i?1:0)}}throw new Error("Invalid API response")}catch(n){return ee.logError("ApiService.getUserInventoryPaginated",n,{account:e,page:t,limit:a}),{assets:[],hasMore:!1,total:0}}}async getUserInventoryAll(e,t=1,a=1e3){try{const n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const n=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=r.data.length===a;return{assets:n,total:(t-1)*a+n.length+(i?1:0),hasMore:i,currentPage:t}}return{assets:[],total:0,hasMore:!1,currentPage:t}}catch(n){return ee.logError("ApiService.getUserInventoryAll",n,{account:e,page:t,limit:a}),{assets:[],total:0,hasMore:!1,currentPage:t}}}async getUserInventoryByCollection(e,t,a=1e3,n=0){try{const i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${t}&burned=false&limit=${a}&offset=${n}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),s=await r.json();if(s.success&&s.data){const t=s.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=s.data.length===a;return{assets:t,total:n+t.length+(i?1:0),hasMore:i}}return{assets:[],total:0,hasMore:!1}}catch(i){return ee.logError("ApiService.getUserInventoryByCollection",i,{account:e,collectionName:t,limit:a,offset:n}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryBySchema(e,t,a,n=1e3,i=0){try{const r=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${t}&schema_name=${a}&burned=false&limit=${n}&offset=${i}&order=desc&sort=asset_id`,s=await this.fetchWithRetry(r),l=await s.json();if(l.success&&l.data){const t=l.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),a=l.data.length===n;return{assets:t,total:i+t.length+(a?1:0),hasMore:a}}return{assets:[],total:0,hasMore:!1}}catch(r){return ee.logError("ApiService.getUserInventoryBySchema",r,{account:e,collectionName:t,schemaName:a,limit:n,offset:i}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryOverview(e){try{const t=`${ue.WAX_CHAIN.EOSRIO}/v1/chain/get_table_rows`,a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"atomicassets",scope:e,table:"assets",limit:1e3,reverse:!1})}),n=await a.json(),i=new Map;let r=0;n.rows&&n.rows.forEach(e=>{if(!e.collection_name)return;r++;const t=e.collection_name,a=e.schema_name||"unknown";i.has(t)||i.set(t,{count:0,schemas:new Map});const n=i.get(t);n.count++,n.schemas.set(a,(n.schemas.get(a)||0)+1)});const s=Array.from(i.entries()).map(([e,t])=>({name:e,count:t.count,schema_counts:Object.fromEntries(t.schemas)})).sort((e,t)=>t.count-e.count);return{totalAssets:r,collections:s,topCollections:s.slice(0,10)}}catch(t){ee.logError("ApiService.getUserInventoryOverview",t,{account:e});try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&page=1&limit=1`,a=await this.fetchWithRetry(t),n=await a.json();return{totalAssets:n.success&&n.query_total||0,collections:[],topCollections:[]}}catch(a){return ee.logError("ApiService.getUserInventoryOverview.fallback",a,{account:e}),{totalAssets:0,collections:[],topCollections:[]}}}}async getUserInventoryOptimized(e,t={}){const{page:a=1,limit:n=1e3,collectionName:i,schemaName:r,useCache:s=!0,cacheTTL:l=3e5}=t,c=`inventory_${e}_${a}_${n}_${i||"all"}_${r||"all"}`;if(s){const e=this.getFromCache(c);if(e)return e}try{let t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${n}&page=${a}&order=desc&sort=asset_id`;i&&"all"!==i&&(t+=`&collection_name=${i}`),r&&(t+=`&schema_name=${r}`);const o=await this.fetchWithRetry(t),d=await o.json();if(d.success&&d.data){const t=d.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=d.data.length===n,r={assets:t,total:d.query_total||(a-1)*n+t.length+(i?1:0),hasMore:i,currentPage:a};return s&&this.setCache(c,r,l),r}return{assets:[],total:0,hasMore:!1,currentPage:a}}catch(o){return ee.logError("ApiService.getUserInventoryOptimized",o,{account:e,page:a,limit:n,collectionName:i,schemaName:r}),{assets:[],total:0,hasMore:!1,currentPage:a}}}async getUserInventoryBatch(e,t={}){const{batchSize:a=1e3,maxBatches:n=20,delayMs:i=500,collectionName:r,onProgress:s,maxRetries:l=3,onError:c}=t,o=[],d=[];let h=1,u=!0,m=0;for(;u&&h<=n&&m<3;){let t=!1,f=null;for(let v=0;v<=l;v++)try{if(v>0){const e=i*Math.pow(1.5,m),t=Math.min(1e3*Math.pow(2,v-1)+e,1e4);await new Promise(e=>setTimeout(e,t))}const l=await this.getUserInventoryOptimized(e,{page:h,limit:a,collectionName:r,useCache:!1});o.push(...l.assets),u=l.hasMore,t=!0,m=0,s&&s({current:h,total:Math.min(n,Math.ceil(l.total/a)),assets:[...o],errors:[...d]});break}catch(p){f=p;const t=v<l;if(c&&c(f,h,t),ee.logError(`ApiService.getUserInventoryBatch.batch${h}.attempt${v+1}`,f,{account:e,batchSize:a,currentBatch:h,retryAttempt:v}),!t){const t=`Batch ${h} failed after ${l+1} attempts: ${f.message}`;if(d.push(t),m++,this.isCriticalError(f))return ee.logError("ApiService.getUserInventoryBatch.criticalError",f,{account:e,currentBatch:h,errorType:"critical"}),{assets:o,errors:[...d,"Critical error encountered, stopping batch processing"],partialSuccess:o.length>0}}}if(h++,u&&h<=n&&t){const e=i*Math.pow(1.2,Math.min(m,3));await new Promise(t=>setTimeout(t,e))}}if(m>=3){const t=`Stopped processing due to ${m} consecutive batch failures`;d.push(t),ee.logError("ApiService.getUserInventoryBatch.tooManyFailures",new Error(t),{account:e,currentBatch:h,consecutiveFailures:m})}return{assets:o,errors:d,partialSuccess:o.length>0&&(d.length>0||m>0)}}isCriticalError(e){const t=e.message.toLowerCase();return t.includes("unauthorized")||t.includes("forbidden")||t.includes("invalid account")||t.includes("network error")||t.includes("dns")||t.includes("connection refused")}async executeBatchOperation(e,t,a={}){const{batchSize:n=100,maxRetries:i=3,delayMs:r=500,onProgress:s,onError:l,stopOnCriticalError:c=!0}=a,o=[],d=[],h=this.chunkArray(e,n);let u=0;for(let p=0;p<h.length;p++){const e=h[p];let a=!1,n=null;for(let r=0;r<=i;r++)try{if(r>0){const e=Math.min(1e3*Math.pow(2,r-1),1e4);await new Promise(t=>setTimeout(t,e))}const n=await t(e,p);o.push(...n),a=!0,u=0,s&&s({completed:p+1,total:h.length,errors:[...d]});break}catch(m){n=m;const t=r<i;if(l&&l(n,p,t),ee.logError(`ApiService.executeBatchOperation.batch${p}.attempt${r+1}`,n,{batchIndex:p,retryAttempt:r,batchSize:e.length}),!t){const e=`Batch ${p} failed after ${i+1} attempts: ${n.message}`;if(d.push(e),u++,c&&this.isCriticalError(n))return ee.logError("ApiService.executeBatchOperation.criticalError",n,{batchIndex:p,errorType:"critical"}),{results:o,errors:[...d,"Critical error encountered, stopping batch processing"],partialSuccess:o.length>0}}}if(u>=3){const e=`Stopped processing due to ${u} consecutive batch failures`;d.push(e),ee.logError("ApiService.executeBatchOperation.tooManyFailures",new Error(e),{batchIndex:p,consecutiveFailures:u});break}if(p<h.length-1&&a){const e=r*Math.pow(1.2,Math.min(u,3));await new Promise(t=>setTimeout(t,e))}}return{results:o,errors:d,partialSuccess:o.length>0&&d.length>0}}chunkArray(e,t){const a=[];for(let n=0;n<e.length;n+=t)a.push(e.slice(n,n+t));return a}async getUserInventoryWithFilter(e,t=1,a=1e3,n){try{let i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`;n&&"all"!==n&&(i+=`&collection_name=${n}`);const r=await this.fetchWithRetry(i),s=await r.json();if(s.success&&s.data){const n=s.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=s.data.length===a;return{assets:n,total:(t-1)*a+n.length+(i?1:0),hasMore:i,currentPage:t}}return{assets:[],total:0,hasMore:!1,currentPage:t}}catch(i){return ee.logError("ApiService.getUserInventoryWithFilter",i,{account:e,page:t,limit:a,collectionName:n}),{assets:[],total:0,hasMore:!1,currentPage:t}}}async getUserInventoryEnhanced(e,t={}){const{page:a=1,limit:n=1e3,order:i="desc",sort:r="transferred",burned:s=!1,...l}=t;try{const t=new URLSearchParams({owner:e,burned:s.toString(),limit:n.toString(),page:a.toString(),order:i,sort:r});Object.entries(l).forEach(([e,a])=>{null!=a&&""!==a&&t.append(e,a.toString())});const c=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?${t.toString()}`,o=await this.fetchWithRetry(c),d=await o.json();if(d.success&&d.data){const t=d.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=[...new Set(t.map(e=>e.collection))].filter(e=>"Unknown"!==e),r=[...new Set(t.map(e=>e.schema))].filter(e=>"Unknown"!==e),s=d.data.length===n;return{assets:t,total:(a-1)*n+t.length+(s?1:0),hasMore:s,currentPage:a,collections:i,schemas:r}}return{assets:[],total:0,hasMore:!1,currentPage:a,collections:[],schemas:[]}}catch(c){return ee.logError("ApiService.getUserInventoryEnhanced",c,{account:e,options:t}),{assets:[],total:0,hasMore:!1,currentPage:a,collections:[],schemas:[]}}}async getUserInventoryByTemplate(e,t,a=1e3,n=0){try{const i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&template_id=${t}&burned=false&limit=${a}&offset=${n}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),s=await r.json();if(s.success&&s.data){const t=s.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),i=s.data.length===a;return{assets:t,total:n+t.length+(i?1:0),hasMore:i}}return{assets:[],total:0,hasMore:!1}}catch(i){return ee.logError("ApiService.getUserInventoryByTemplate",i,{account:e,templateId:t,limit:a,offset:n}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryWaxRocks(e,t=1e3,a=0){try{const{MarketplaceConfigService:n}=await f(async()=>{const{MarketplaceConfigService:e}=await Promise.resolve().then(()=>pe);return{MarketplaceConfigService:e}},void 0),i=n.getPixalTemplateId(),r=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&template_id=${i}&burned=false&limit=${t}&offset=${a}&order=desc&sort=asset_id`,s=await this.fetchWithRetry(r),l=await s.json();if(l.success&&l.data){const a=l.data.filter(e=>{const t=e.data?.WaxRock||e.template?.immutable_data?.WaxRock;return!(!t||"string"!=typeof t)&&"none"!==t&&n.isValidWaxRock(t)}).map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""])),data:t.data})),i=l.data.length===t;return{assets:a,total:a.length,hasMore:i}}return{assets:[],total:0,hasMore:!1}}catch(n){return ee.logError("ApiService.getUserInventoryWaxRocks",n,{account:e,limit:t,offset:a}),{assets:[],total:0,hasMore:!1}}}async getWaxChainInfo(){try{const e=await this.fetchWithRetry(`${this.waxChainAPI}/v1/chain/get_info`);if(e.ok)return await e.json();throw new Error("Failed to fetch chain info")}catch(e){return ee.logError("ApiService.getWaxChainInfo",e),this.currentWaxChainIndex<this.waxChainEndpoints.length-1?(this.currentWaxChainIndex++,this.getWaxChainInfo()):(this.currentWaxChainIndex=0,null)}}async getWaxAccountInfo(e){for(let a=0;a<this.waxChainEndpoints.length;a++){const n=this.waxChainEndpoints[a];try{const t=await fetch(`${n}/v1/chain/get_account`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify({account_name:e})});if(t.ok){const e=await t.json();return this.currentWaxChainIndex=a,e}re.warn(`Endpoint ${n} returned status ${t.status}: ${t.statusText}`,"API")}catch(t){ee.logError("ApiService.getWaxAccountInfo",t,{endpoint:n,accountName:e})}}return ee.logError("ApiService.getWaxAccountInfo",new Error("All WAX chain endpoints failed for get_account"),{accountName:e}),null}async getWaxCurrencyBalance(e,t="eosio.token",a="WAX"){re.debug(`Attempting to fetch currency balance for: ${e}`,"API");for(let i=0;i<this.waxChainEndpoints.length;i++){const r=this.waxChainEndpoints[i];re.debug(`Trying endpoint ${i+1}/${this.waxChainEndpoints.length}: ${r}`,"API");try{const n=await fetch(`${r}/v1/chain/get_currency_balance`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify({code:t,account:e,symbol:a})});if(n.ok){const e=await n.json();return re.debug(`Successfully fetched currency balance from ${r}`,"API"),this.currentWaxChainIndex=i,e.map(e=>({balance:e,contract:t,symbol:e.split(" ")[1]||a}))}re.warn(`Endpoint ${r} returned status ${n.status}: ${n.statusText}`,"API")}catch(n){ee.logError("ApiService.getWaxCurrencyBalance",n,{endpoint:r,accountName:e,contract:t,symbol:a})}}return ee.logError("ApiService.getWaxCurrencyBalance",new Error("All WAX chain endpoints failed for get_currency_balance"),{accountName:e,contract:t,symbol:a}),[]}async getLightApiBalances(e){try{const t=`${this.waxLightAPI}/api/balances/wax/${e}`,a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(t){return ee.logError("ApiService.getLightApiBalances",t,{accountName:e}),null}}async getLightApiAccountInfo(e){try{const t=`${this.waxLightAPI}/api/account/wax/${e}`,a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(t){return ee.logError("ApiService.getLightApiAccountInfo",t,{accountName:e}),null}}async getAlcorTokenPrice(e,t){let a=null;try{const n=`${e.toLowerCase()}-${t}`,i=`${this.alcorAPI}/tokens/${n}`,r=new AbortController;a=setTimeout(()=>{r.abort()},8e3);const s=await this.fetchAlcorAPI(i,2,{signal:r.signal});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return await s.json()}catch(n){return n instanceof Error&&"AbortError"===n.name?(re.warn(`Alcor API request timeout for ${e}`,"API"),null):(re.warn(`Error fetching Alcor token price for ${e}`,"API",n),"wax"===e.toLowerCase()?{symbol:"WAX",contract:"eosio.token",id:"wax-eosio.token",system_price:.05,usd_price:.05,decimals:8}:null)}finally{a&&clearTimeout(a)}}async getAlcorMarkets(){try{const e=`${this.alcorAPI}/pairs`,t=await this.fetchAlcorAPI(e);return await t.json()}catch(e){return ee.logError("ApiService.getAlcorMarkets",e),[]}}async getMarketplaceConfig(){try{return{partnerCollections:["friedfactory","pixeljourney"],tokenContracts:["alien.worlds","prospectorsc","token.nefty"],supportedTokens:[{contract:"eosio.token",symbol:"WAX",precision:8},{contract:"alien.worlds",symbol:"TLM",precision:4},{contract:"prospectorsc",symbol:"PGL",precision:4},{contract:"token.nefty",symbol:"NEFTY",precision:8}]}}catch(e){return ee.logError("ApiService.getMarketplaceConfig",e),{partnerCollections:["friedfactory","pixeljourney"],tokenContracts:["alien.worlds","prospectorsc","token.nefty"],supportedTokens:[{contract:"eosio.token",symbol:"WAX",precision:8}]}}}async getPartnerCollections(){try{return(await this.getMarketplaceConfig()).partnerCollections}catch(e){return ee.logError("ApiService.getPartnerCollections",e),["friedfactory","pixeljourney"]}}async getTokenContracts(){try{return(await this.getMarketplaceConfig()).tokenContracts}catch(e){return ee.logError("ApiService.getTokenContracts",e),["alien.worlds","prospectorsc","token.nefty"]}}async getAlcorSwapQuote(e){try{const t=`${this.alcorAPI}/swap/quote`,a=await this.fetchAlcorAPI(t,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await a.json()}catch(t){return ee.logError("ApiService.getAlcorSwapQuote",t,{params:e}),null}}async getPXJPrice(){try{const e=await this.getAlcorTokenPrice("PXJ","pixeljourney");return e?.system_price||0}catch(e){return ee.logError("ApiService.getPXJPrice",e),0}}async calculatePortfolioValue(e){let t=0;for(const n of e)try{const e=await this.getAlcorTokenPrice(n.currency,n.contract);if(e){const a=parseFloat(n.amount),i=parseInt(n.decimals);t+=a/Math.pow(10,i)*e.usd_price}}catch(a){re.warn(`Could not get price for ${n.currency}`,"API",a)}return t}async getMarketplaceNFTs(e){try{const{page:t=1,limit:a=100,asset_id:n,state:i=1}=e;let r=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?state=${i}&page=${t}&limit=${a}&order=desc&sort=created`;n&&(r+=`&asset_id=${n}`);const s=await this.fetchWithRetry(r),l=await s.json();return l.success&&l.data?{success:!0,data:l.data.map(e=>({sale_id:e.sale_id,asset_id:e.assets[0]?.asset_id||"",price:e.price?`${(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)).toFixed(8)} ${e.price.token_symbol}`:"0 WAX",seller:e.seller,created_at_time:e.created_at_time}))}:{success:!0,data:[]}}catch(t){return ee.logError("ApiService.getMarketplaceNFTs",t,{params:e}),{success:!1,data:[]}}}async getAssetOffers(e){try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/buyoffers?asset_id=${e}&state=0&page=1&limit=100&order=desc&sort=price`,a=await this.fetchWithRetry(t),n=await a.json();return n.success&&n.data?n.data.map(e=>({id:e.buyoffer_id,buyer:e.buyer,price:e.price.amount,symbol:e.price.token_symbol,timestamp:e.created_at_time,memo:e.memo||""})):[]}catch(t){return ee.logError("ApiService.getAssetOffers",t,{assetId:e}),[]}}async getAssetsBatch(e){if(!e.length)return{success:!0,data:[],errors:[]};try{const a=this.chunkArray(e,100),n=[],i=[];for(const e of a)try{const t=e.join(","),a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets`,r=await this.fetchWithRetry(a,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,limit:"1000"})}),s=await r.json();s.success&&s.data?n.push(...s.data):i.push(`Failed to fetch assets batch: ${e.join(", ")}`)}catch(t){ee.logError("ApiService.getAssetsBatch",t,{chunk:e}),i.push(`Error fetching assets: ${e.join(", ")}`)}return{success:0===i.length,data:n,errors:i}}catch(t){return ee.logError("ApiService.getAssetsBatch",t,{assetIds:e}),{success:!1,data:[],errors:[`Failed to process asset batch: ${t}`]}}}async getTemplatesBatch(e){if(!e.length)return{success:!0,data:[],errors:[]};try{const a=this.chunkArray(e,100),n=[],i=[];for(const e of a)try{const t=e.join(","),a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/templates`,r=await this.fetchWithRetry(a,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,limit:"1000"})}),s=await r.json();s.success&&s.data?n.push(...s.data):i.push(`Failed to fetch templates batch: ${e.join(", ")}`)}catch(t){ee.logError("ApiService.getTemplatesBatch",t,{chunk:e}),i.push(`Error fetching templates: ${e.join(", ")}`)}return{success:0===i.length,data:n,errors:i}}catch(t){return ee.logError("ApiService.getTemplatesBatch",t,{templateIds:e}),{success:!1,data:[],errors:[`Failed to process template batch: ${t}`]}}}async getAssetCountsBatch(e,t){if(!e.length)return{success:!0,data:{},errors:[]};try{const n={},i=[],r=this.chunkArray(e,50);for(const e of r)try{const a=e.map(async e=>{try{const a={template_id:e,limit:1};t&&(a.owner=t);const n=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets`,i=new URLSearchParams;Object.entries(a).forEach(([e,t])=>{null!=t&&i.append(e,String(t))});const r=await this.fetchWithRetry(`${n}?${i}`),s=await r.json();return s.success?{templateId:e,count:parseInt(s.query_total||"0")}:{templateId:e,count:0,error:"API returned unsuccessful response"}}catch(a){return{templateId:e,count:0,error:String(a)}}});(await Promise.all(a)).forEach(e=>{e.error&&i.push(`Error fetching count for template ${e.templateId}: ${e.error}`),n[e.templateId]=e.count}),r.indexOf(e)<r.length-1&&await new Promise(e=>setTimeout(e,100))}catch(a){ee.logError("ApiService.getAssetCountsBatch chunk",a,{chunk:e}),e.forEach(e=>{n[e]=0,i.push(`Error processing template ${e}: ${a}`)})}return{success:0===i.length,data:n,errors:i}}catch(a){return ee.logError("ApiService.getAssetCountsBatch",a,{templateIds:e}),{success:!1,data:{},errors:[`Failed to process asset counts batch: ${a}`]}}}async getOffers(e={}){try{const{page:t=1,limit:a=100,order:n="desc",sort:i="created",state:r="0",collection_name:s,schema_name:l,template_id:c,asset_id:o,buyer:d,seller:h,min_price:u,max_price:m,symbol:p="WAX"}=e;let f=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/buyoffers?page=${t}&limit=${a}&order=${n}&sort=${i}&state=${r}&symbol=${p}`;s&&(f+=`&collection_name=${s}`),l&&(f+=`&schema_name=${l}`),c&&(f+=`&template_id=${c}`),o&&(f+=`&asset_id=${o}`),d&&(f+=`&buyer=${d}`),h&&(f+=`&seller=${h}`),u&&(f+=`&min_price=${u}`),m&&(f+=`&max_price=${m}`);const v=await this.fetchWithRetry(f),y=await v.json();return{success:y.success||!1,data:y.data||[],query_total:y.query_total}}catch(t){return ee.logError("ApiService.getOffers",t,e),{success:!1,data:[]}}}async getPrices(e={}){try{const{page:t=1,limit:a=100,order:n="desc",sort:i="created",collection_name:r,schema_name:s,template_id:l,symbol:c="WAX"}=e;let o=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/prices?page=${t}&limit=${a}&order=${n}&sort=${i}&symbol=${c}`;r&&(o+=`&collection_name=${r}`),s&&(o+=`&schema_name=${s}`),l&&(o+=`&template_id=${l}`);const d=await this.fetchWithRetry(o),h=await d.json();return{success:h.success||!1,data:h.data||[],query_total:h.query_total}}catch(t){return ee.logError("ApiService.getPrices",t,e),{success:!1,data:[]}}}async getTransfers(e={}){try{const{page:t=1,limit:a=100,order:n="desc",sort:i="created",collection_name:r,schema_name:s,template_id:l,asset_id:c,sender:o,recipient_name:d}=e;let h=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/transfers?page=${t}&limit=${a}&order=${n}&sort=${i}`;r&&(h+=`&collection_name=${r}`),s&&(h+=`&schema_name=${s}`),l&&(h+=`&template_id=${l}`),c&&(h+=`&asset_id=${c}`),o&&(h+=`&sender_name=${o}`),d&&(h+=`&recipient_name=${d}`);const u=await this.fetchWithRetry(h),m=await u.json();return{success:m.success||!1,data:m.data||[],query_total:m.query_total}}catch(t){return ee.logError("ApiService.getTransfers",t,e),{success:!1,data:[]}}}async getCollectionMarketStats(e={}){try{const{collection_name:t,symbol:a="WAX"}=e;let n=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/collections?symbol=${a}`;t&&(n=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/collections/${t}?symbol=${a}`);const i=await this.fetchWithRetry(n),r=await i.json();return{success:r.success||!1,data:r.data||{}}}catch(t){return ee.logError("ApiService.getCollectionMarketStats",t,e),{success:!1,data:{symbol:"",market_contract:"",sales:"0",volume:"0",suggested_median:"0",suggested_average:"0"}}}}async getTemplateStats(e,t,a="WAX"){try{const n=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/templates/${e}/${t}?symbol=${a}`,i=await this.fetchWithRetry(n),r=await i.json();return{success:r.success||!1,data:r.data||{}}}catch(n){return ee.logError("ApiService.getTemplateStats",n,{collectionName:e,templateId:t,symbol:a}),{success:!1,data:{template_id:"",collection_name:"",assets:"0",burned:"0",sales:"0",volume:"0",suggested_median:"0",suggested_average:"0"}}}}async getHyperionTransactionHistory(e,t=100,a=0){re.debug("\ud83d\udd0d Fetching Hyperion transaction history for:","API",{account:e});try{const n=`${this.hyperionEndpoints[this.currentHyperionIndex]}/v2/history/get_actions`,i=new URLSearchParams({account:e,limit:Math.min(t,1e3).toString(),skip:a.toString(),sort:"desc"});re.debug("\ud83d\udce1 Hyperion API URL:","API",{url:`${n}?${i}`});const r=await this.fetchWithRetry(`${n}?${i}`),s=await r.json();if(!s.actions||!Array.isArray(s.actions))return re.warn("No actions found in Hyperion response","API"),[];re.debug(`\ud83d\udcca Found ${s.actions.length} Hyperion actions`,"API");const l=s.actions.map(t=>{const a=t.act.data;let n="unknown";return n="eosio.token"===t.act.account&&"transfer"===t.act.name?a.from===e?"token_send":"token_receive":"atomicassets"===t.act.account&&"transfer"===t.act.name?"nft_transfer":"atomicmarket"===t.act.account&&"purchasesale"===t.act.name?"nft_purchase":"atomicmarket"===t.act.account&&"announcesale"===t.act.name?"nft_listing":"atomicmarket"===t.act.account&&"cancelsale"===t.act.name?"nft_cancel_listing":`${t.act.account}_${t.act.name}`,{transaction_id:t.trx_id,block_time:t.timestamp,action_name:t.act.name,contract:t.act.account,from:a.from,to:a.to,quantity:a.quantity,memo:a.memo,asset_ids:a.asset_ids,collection_name:a.collection_name,type:n,status:"completed"}});return re.debug(`\u2705 Processed ${l.length} Hyperion transactions`,"API"),l}catch(n){return re.error("\u274c Hyperion API error","API",n),this.currentHyperionIndex<this.hyperionEndpoints.length-1?(this.currentHyperionIndex++,re.debug(`\ud83d\udd04 Switching to Hyperion endpoint ${this.currentHyperionIndex+1}`,"API"),this.getHyperionTransactionHistory(e,t,a)):(this.currentHyperionIndex=0,ee.logError("ApiService.getHyperionTransactionHistory",n,{account:e,limit:t,skip:a}),[])}}async getAccountTransfers(e,t,a,n=50,i=0){try{const r=`${this.hyperionEndpoints[this.currentHyperionIndex]}/v2/history/get_actions`,s=new URLSearchParams({account:e,limit:Math.min(n,100).toString(),sort:"desc",skip:i.toString(),"transfer.to":e});re.debug("\ud83d\udd0d Fetching account transfers from Hyperion:","API",{account:e,contract:t,symbol:a,url:`${r}?${s}`});const l=await this.fetchWithRetry(`${r}?${s}`),c=await l.json();if(!c.actions||!Array.isArray(c.actions))return re.warn("No actions found in Hyperion response for transfers","API"),[];re.debug(`\ud83d\udcca Found ${c.actions.length} Hyperion transfer actions`,"API");const o=c.actions.filter(n=>{const i=n.act;return i?.account===t&&"transfer"===i?.name&&(i?.data?.to===e||i?.data?.from===e)&&(i?.data?.quantity?.includes(a)||i?.data?.symbol===a)}).slice(0,n).map(e=>{const t=e.act.data;return{from:t.from,to:t.to,quantity:t.quantity,memo:t.memo||"",timestamp:e.timestamp,transaction_id:e.trx_id,block_num:e.block_num}});return re.debug(`\u2705 Processed ${o.length} transfers for account ${e}`,"API"),o}catch(r){return ee.logError("ApiService.getAccountTransfers",r,{account:e,contract:t,symbol:a,limit:n,offset:i}),re.warn("Falling back to legacy WAX chain API","API"),this.fetchTransfersFromWaxChainAPI(e,t,a,n,i)}}async fetchTransfersFromWaxChainAPI(e,t,a,n=50,i=0){try{const r=await fetch(`${this.waxChainAPI}/v1/history/get_actions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:e,pos:-1,offset:i,filter:`${t}:transfer`})});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return((await r.json()).actions||[]).filter(n=>{const i=n.action_trace?.act;return"transfer"===i?.name&&i?.account===t&&(i?.data?.to===e||i?.data?.from===e)&&i?.data?.quantity?.includes(a)}).slice(0,n).map(e=>{const t=e.action_trace.act.data;return{from:t.from,to:t.to,quantity:t.quantity,memo:t.memo||"",timestamp:e.block_time,transaction_id:e.action_trace.trx_id,block_num:e.block_num}})}catch(r){return ee.logError("ApiService.fetchTransfersFromWaxChainAPI",r,{account:e,contract:t,symbol:a,limit:n,offset:i}),[]}}async getUserTransactions(e,t=500){re.debug("\ud83d\udd0d getUserTransactions called for account:","API",{account:e,limit:t});try{const n=[];try{re.debug("\ud83d\ude80 Fetching Hyperion transaction history...","API");const a=await this.getHyperionTransactionHistory(e,Math.min(t,200));re.debug("\ud83d\ude80 Hyperion transactions:","API",{count:a.length});const i=a.map(e=>({transaction_id:e.transaction_id,block_time:e.block_time,action_name:e.action_name,asset_id:e.asset_ids?.[0],asset_name:e.asset_ids?.[0]?`Asset #${e.asset_ids[0]}`:void 0,collection_name:e.collection_name,price:e.quantity,from:e.from,to:e.to,type:e.type,status:e.status,memo:e.memo}));n.push(...i),re.debug("\u2705 Added Hyperion transactions","API",{count:i.length})}catch(a){re.warn("Failed to fetch Hyperion transactions","API",a)}try{const a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?account=${e}&state=3&page=1&limit=${Math.min(t,200)}&order=desc&sort=updated`;re.debug("\ud83d\udcca Fetching marketplace transactions from:","API",{url:a});const i=await this.fetchWithRetry(a),r=await i.json();if(re.debug("\ud83d\udcca Marketplace response:","API",{success:r.success,dataLength:r.data?.length}),r.success&&r.data){const t=r.data.map(t=>{const a=parseFloat(t.price.amount)/Math.pow(10,t.price.token_precision||8),n="WAX"===t.price.token_symbol?ae(a):`${ne(a)} ${t.price.token_symbol}`;return{transaction_id:t.sale_id,block_time:t.updated_at_time,action_name:t.buyer===e?"purchase":"sale",asset_id:t.assets[0]?.asset_id,asset_name:t.assets[0]?.name||`Asset #${t.assets[0]?.asset_id}`,collection_name:t.assets[0]?.collection?.collection_name,price:n,from:t.buyer===e?t.seller:e,to:t.buyer===e?e:t.buyer,type:t.buyer===e?"purchase":"sale",status:"completed"}});n.push(...t)}}catch(a){re.warn("Failed to fetch marketplace transactions","API",a)}try{const a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/transfers?account=${e}&page=1&limit=${Math.min(t,200)}&order=desc&sort=created`;re.debug("\ud83d\udd04 Fetching NFT transfers from:","API",{url:a});const i=await this.fetchWithRetry(a),r=await i.json();if(re.debug("\ud83d\udd04 NFT transfers response:","API",{success:r.success,dataLength:r.data?.length}),r.success&&r.data){const e=r.data.filter(e=>e.sender!==e.recipient).map(e=>{const t=e.assets?.[0];return{transaction_id:e.tx_id||`transfer_${e.transfer_id}`,block_time:e.created_at_time,action_name:"transfer",asset_id:t?.asset_id,asset_name:t?.name||`Asset #${t?.asset_id}`,collection_name:t?.collection?.collection_name,price:void 0,from:e.sender,to:e.recipient,type:"transfer",status:"completed",memo:e.memo||void 0}});n.push(...e)}}catch(a){re.warn("Failed to fetch NFT transfers","API",a)}try{re.debug("\ud83d\udcb0 Fetching token transfers for account:","API",{account:e});const a=await this.getAccountTransfers(e,"eosio.token","WAX",Math.min(t,100));re.debug("\ud83d\udcb0 Token transfers response:","API",{count:a.length});const i=a.map(t=>({transaction_id:t.transaction_id,block_time:t.timestamp,action_name:"token_transfer",asset_id:void 0,asset_name:"WAX Token",collection_name:"WAX",price:t.quantity,from:t.from,to:t.to,type:t.from===e?"token_send":"token_receive",status:"completed",memo:t.memo}));n.push(...i)}catch(a){re.warn("Failed to fetch token transfers","API",a)}re.debug("\ud83d\udccb Total transactions found:","API",{count:n.length});const i=new Map;n.forEach(e=>{const t=i.get(e.transaction_id);if(t){const a={...t,...e,asset_id:e.asset_id||t.asset_id,asset_name:e.asset_name||t.asset_name,collection_name:e.collection_name||t.collection_name,price:e.price||t.price,from:e.from||t.from,to:e.to||t.to,memo:e.memo||t.memo};i.set(e.transaction_id,a)}else i.set(e.transaction_id,e)});const r=Array.from(i.values()).sort((e,t)=>new Date(t.block_time).getTime()-new Date(e.block_time).getTime()).slice(0,t);return re.debug("\u2705 Returning unique transactions","API",{unique:r.length,total:n.length}),r}catch(a){return ee.logError("ApiService.getUserTransactions",a,{account:e,limit:t}),[]}}async getUserStats(e){try{let a="2023-01-01";try{const t=await this.getWaxAccountInfo(e);t?.created&&(a=new Date(t.created).toISOString().split("T")[0])}catch(t){re.warn("Failed to fetch account creation date","API",{account:e,error:t})}const n=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&page=1&limit=1`,i=await this.fetchWithRetry(n),r=await i.json(),s=r.success&&(r.query_total||r.data?.length)||0,l=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?seller=${e}&state=3&page=1&limit=100&order=desc&sort=updated`,c=await this.fetchWithRetry(l),o=await c.json();let d=0,h=0;const u=new Set;o.success&&o.data&&(d=o.data.length,o.data.forEach(e=>{h+=parseFloat(e.price.amount)||0,e.assets[0]?.collection?.collection_name&&u.add(e.assets[0].collection.collection_name)}));const m=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?buyer=${e}&state=3&page=1&limit=100&order=desc&sort=updated`,p=await this.fetchWithRetry(m),f=await p.json();let v=0,y=0;return f.success&&f.data&&(v=f.data.length,f.data.forEach(e=>{y+=parseFloat(e.price.amount)||0,e.assets[0]?.collection?.collection_name&&u.add(e.assets[0].collection.collection_name)})),{totalAssets:s,totalPurchases:v,totalSales:d,totalSpent:ae(y),totalEarned:ae(h),collections:Array.from(u),favoriteCollections:Array.from(u).slice(0,3),joinDate:a,nftsOwned:s,nftsListed:0}}catch(a){return ee.logError("ApiService.getUserStats",a,{account:e}),{totalAssets:0,totalPurchases:0,totalSales:0,totalSpent:"0.0000 WAX",totalEarned:"0.0000 WAX",collections:[],favoriteCollections:[],joinDate:"2023-01-01",nftsOwned:0,nftsListed:0}}}async getCollectionPriceHistory(e,t="7d"){try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=100&order=desc&sort=updated`,a=await this.fetchWithRetry(t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);return(await a.json()).data.map(e=>({timestamp:new Date(e.updated_at_time).getTime(),price:parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision),volume:1}))}catch(a){return ee.logError("ApiService.getCollectionPriceHistory",a,{collectionName:e,timeframe:t}),this.fetchPriceHistoryFromAlcor(e,t)}}async fetchPriceHistoryFromAlcor(e,t){try{const a=await fetch(`${this.alcorAPI}/markets/1/charts?resolution=1D&limit=100`);if(a.ok){const e=await a.json();if(e&&Array.isArray(e)){const a="24h"===t?1:"7d"===t?7:"30d"===t?30:90;return e.slice(-a).map(e=>({timestamp:1e3*e.time,price:parseFloat(e.close||e.price||"1"),volume:parseFloat(e.volume||"0")}))}}const n=await this.getCollectionMarketStats({collection_name:e});if(n.success&&n.data){const e=parseFloat(n.data.suggested_average||"1"),a=Date.now(),i="24h"===t?1:"7d"===t?7:"30d"===t?30:90,r=[];for(let t=i;t>=0;t--){const s=a-24*t*60*60*1e3,l=e*(.9+.2*Math.random()),c=parseFloat(n.data.volume||"0")/i;r.push({timestamp:s,price:l,volume:c})}return r}return[]}catch(a){return ee.logError("ApiService.fetchPriceHistoryFromAlcor",a,{collectionName:e,timeframe:t}),[]}}async getAuctionBids(e){try{return[]}catch(t){return ee.logError("ApiService.getAuctionBids",t,{auctionId:e}),[]}}async getAuctions(e={}){const{state:t=1,limit:a=36,offset:n=0,sort:i="created",order:r="desc",hide_empty_auctions:s=!0,search:l,collection_name:c,collection_blacklist:o="flinttffunko,onlyfanzgaly,farmerpetsco,fantaspeop",seller_blacklist:d="dximg.wam,xpvrs.wam,5rrrc.wam,nnmnmnmnn.gm",symbol:h="WAX"}=e;try{let e=`${this.atomicMarketAPI}/atomicmarket/v1/auctions?limit=${a}&offset=${n}&sort=${i}&order=${r}&symbol=${h}`;void 0!==t&&(e+=`&state=${t}`),s&&(e+="&hide_empty_auctions=true"),l&&(e+=`&search=${encodeURIComponent(l)}`),c&&(e+=`&collection_name=${encodeURIComponent(c)}`),o&&(e+=`&collection_blacklist=${encodeURIComponent(o)}`),d&&(e+=`&seller_blacklist=${encodeURIComponent(d)}`);const u=await this.fetchWithRetry(e);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const m=await u.json();if(!m.success||!m.data)throw new Error("Invalid API response structure");return{data:m.data.map(e=>{const t=e.assets?.[0],a=t?.name||t?.data?.name||t?.template?.immutable_data?.name||`${t?.collection?.collection_name||"Unknown"} #${t?.asset_id}`,n=e.price?.amount||"0",i=e.price?.token_symbol||"WAX",r=e.price?.token_precision||8,s="0"!==n?`${(parseFloat(n)/Math.pow(10,r)).toFixed(r)} ${i}`:"0 WAX";return{auction_id:e.auction_id,asset_id:t?.asset_id||"",seller:e.seller,price:s,end_time:e.end_time,collection_name:t?.collection?.collection_name||"Unknown",template_id:t?.template?.template_id||"",asset_name:a,image:t?this.getAssetImage(t):"https://pixeljourney.xyz/img/toppixals/10.webp",video:t&&this.getAssetVideo(t)||"",current_bid:s,bidder:e.buyer||null,created_at_time:e.created_at_time}}),success:!0}}catch(u){return ee.logError("ApiService.getAuctions",u,{state:t,limit:a,offset:n,sort:i,order:r}),{data:[],success:!1,error:u}}}async getAuction(e){try{const t=`${this.atomicMarketAPI}/atomicmarket/v1/auctions/${e}`,a=await this.fetchWithRetry(t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const n=await a.json();if(!n.success||!n.data)throw new Error("Invalid API response structure");const i=n.data;return{data:{auction_id:i.auction_id,asset_id:i.assets?.[0]?.asset_id||"",seller:i.seller,price:i.price?.amount||"0",end_time:i.end_time,collection_name:i.assets?.[0]?.collection?.collection_name||"Unknown",template_id:i.assets?.[0]?.template?.template_id||"",asset_name:i.assets?.[0]?.name||i.assets?.[0]?.data?.name||`Asset #${i.assets?.[0]?.asset_id}`,image:i.assets?.[0]?this.getAssetImage(i.assets[0]):"",video:i.assets?.[0]?this.getAssetVideo(i.assets[0]):"",current_bid:i.price?.amount||"0",bidder:i.buyer||null},success:!0}}catch(t){return ee.logError("ApiService.getAuction",t,{auctionId:e}),{data:null,success:!1,error:t}}}async getUSDPrice(e){try{const{priceService:t}=await f(async()=>{const{priceService:e}=await Promise.resolve().then(()=>ye);return{priceService:e}},void 0);return await t.convertWaxToUSDAsync(e.toString())}catch(t){return ee.logError("ApiService.getUSDPrice",t,{waxAmount:e}),"$0.00"}}async waxRpcCall(e,t){for(let n=0;n<this.waxChainEndpoints.length;n++){const i=this.waxChainEndpoints[n],r=`${i}${e}`;try{const e=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify(t)});if(e.ok)return this.currentWaxChainIndex=n,await e.json();re.warn("WAX RPC endpoint returned error status","API",{endpoint:i,status:e.status,statusText:e.statusText})}catch(a){ee.logError("ApiService.waxRpcCall",a,{endpoint:i,body:t})}}throw new Error(`All WAX RPC endpoints failed for ${e}`)}async getPowerupState(){return this.waxRpcCall("/v1/chain/get_table_rows",{json:!0,code:"eosio",scope:"eosio",table:"powup.state",limit:1})}async getChainInfo(){return this.waxRpcCall("/v1/chain/get_info",{})}async getRWAXTransfers(e={}){try{const{limit:t=20,page:a=1,order:n="desc"}=e,[i,r]=await Promise.all([this.getTransfers({recipient_name:"rwax",collection_name:"pixeljourney",limit:Math.ceil(t/2),page:a,order:n,sort:"created"}),this.getTransfers({sender:"rwax",collection_name:"pixeljourney",limit:Math.ceil(t/2),page:a,order:n,sort:"created"})]),s=[...i.data.map(e=>({...e,type:"tokenization"})),...r.data.map(e=>({...e,type:"redemption"}))],l=new Map;s.forEach(e=>{const t=`${e.transfer_id}-${e.txid}`;if(l.has(t)){const a=l.get(t),n=e.assets.length>a.assets.length,i=Object.keys(e).length>Object.keys(a).length;(n||i)&&l.set(t,e)}else l.set(t,e)});const c=Array.from(l.values());return c.sort((e,t)=>{const a=new Date(e.created_at_time).getTime(),i=new Date(t.created_at_time).getTime();return"desc"===n?i-a:a-i}),{success:!0,data:c.slice(0,t),query_total:(i.query_total||0)+(r.query_total||0)}}catch(t){return ee.logError("ApiService.getRWAXTransfers",t,e),{success:!1,data:[]}}}},Fe=Object.freeze(Object.defineProperty({__proto__:null,apiService:$e},Symbol.toStringTag,{value:"Module"})),Ee=new class{constructor(){t(this,"badgeCache",new Map),t(this,"CACHE_DURATION",3e5),t(this,"BADGE_DEFINITIONS",{"pixal-pfp":{id:"pixal-pfp",name:"Pixal PFP",description:"Owns a Pixal PFP NFT (Template 781515)",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"Own Template 781515"},"pixal-collector-5":{id:"pixal-collector-5",name:"Pixal Collector I",description:"Owns 5+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"5+ Pixal PFPs",tier:1},"pixal-collector-25":{id:"pixal-collector-25",name:"Pixal Collector II",description:"Owns 25+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"25+ Pixal PFPs",tier:2,rarity:"rare"},"pixal-collector-50":{id:"pixal-collector-50",name:"Pixal Collector III",description:"Owns 50+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"50+ Pixal PFPs",tier:3,rarity:"epic"},"pixal-collector-100":{id:"pixal-collector-100",name:"Pixal Collector IV",description:"Owns 100+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"100+ Pixal PFPs",tier:4,rarity:"epic"},"pixal-collector-250":{id:"pixal-collector-250",name:"Pixal Collector V",description:"Owns 250+ Pixal PFPs",icon:"\ud83c\udfad",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"250+ Pixal PFPs",tier:5,rarity:"legendary"},waxrock:{id:"waxrock",name:"WaxRock",description:"Owns WaxRock Pixal NFT",icon:"\ud83e\udea8",color:"#f59e0b",borderColor:"rgba(245, 158, 11, 0.3)",type:"ownership",requirements:"Own WaxRock NFTs"},"waxrock-collector-3":{id:"waxrock-collector-3",name:"WaxRock Collector I",description:"Owns 3+ WaxRock trait Pixals",icon:"\ud83e\udea8",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"3+ WaxRock trait Pixals",tier:1},"waxrock-collector-6":{id:"waxrock-collector-6",name:"WaxRock Collector II",description:"Owns 6+ WaxRock trait Pixals",icon:"\ud83e\udea8",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"6+ WaxRock trait Pixals",tier:2,rarity:"rare"},"waxrock-collector-10":{id:"waxrock-collector-10",name:"WaxRock Collector III",description:"Owns 10+ WaxRock trait Pixals",icon:"\ud83e\udea8",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"10+ WaxRock trait Pixals",tier:3,rarity:"epic"},ingredients:{id:"ingredients",name:"Ingredients",description:"Owns Pixel Journey Ingredients",icon:"\ud83e\uddea",color:"#22c55e",borderColor:"rgba(34, 197, 94, 0.3)",type:"ownership",requirements:"Own Ingredient NFTs"},"pxj-whale":{id:"pxj-whale",name:"PXJ Whale",description:"Holds 50,000,000+ PXJ tokens",icon:"\ud83d\udc0b",color:"#3b82f6",borderColor:"rgba(59, 130, 246, 0.3)",type:"holdings",requirements:"50,000,000+ PXJ",rarity:"legendary"},"pxj-holder":{id:"pxj-holder",name:"PXJ Holder",description:"Holds 100,000+ PXJ tokens",icon:"\ud83d\udc8e",color:"#8b5cf6",borderColor:"rgba(139, 92, 246, 0.3)",type:"holdings",requirements:"100,000+ PXJ"},"pxj-shrimp":{id:"pxj-shrimp",name:"PXJ Shrimp",description:"Holds 10,000+ PXJ tokens",icon:"\ud83e\udd90",color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)",type:"holdings",requirements:"10,000+ PXJ"},"wpixal-holder":{id:"wpixal-holder",name:"WPIXAL Holder",description:"Owns WPIXAL tokens",icon:"\ud83e\ude99",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"holdings",requirements:"Own WPIXAL tokens"},"king-holder":{id:"king-holder",name:"KING Holder",description:"Holds KING tokens",icon:"\ud83d\udc51",color:"#fbbf24",borderColor:"rgba(251, 191, 36, 0.3)",type:"holdings",requirements:"Hold KING tokens"},"journey-collector":{id:"journey-collector",name:"Journey Collector",description:"Owns 50+ Journey assets",icon:"\ud83c\udf92",color:"#ec4899",borderColor:"rgba(236, 72, 153, 0.3)",type:"ownership",requirements:"50+ Journey Assets"},"journey-enthusiast":{id:"journey-enthusiast",name:"Journey Enthusiast",description:"Owns 10+ Journey assets",icon:"\u2b50",color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)",type:"ownership",requirements:"10+ Journey Assets"},"early-adopter":{id:"early-adopter",name:"Early Adopter",description:"One of the first Journey participants",icon:"\ud83d\ude80",color:"#06b6d4",borderColor:"rgba(6, 182, 212, 0.3)",type:"special",requirements:"Early participation",rarity:"legendary"},"active-trader":{id:"active-trader",name:"Active Trader",description:"Completed 100+ transactions",icon:"\ud83d\udcc8",color:"#10b981",borderColor:"rgba(16, 185, 129, 0.3)",type:"trading",requirements:"100+ Transactions",rarity:"rare"},"volume-trader":{id:"volume-trader",name:"Volume Trader",description:"Traded 10,000+ WAX in volume",icon:"\ud83d\udcb0",color:"#f59e0b",borderColor:"rgba(245, 158, 11, 0.3)",type:"trading",requirements:"10,000+ WAX Volume",rarity:"epic"},"community-member":{id:"community-member",name:"Community Member",description:"Active community participant",icon:"\ud83d\udc65",color:"#8b5cf6",borderColor:"rgba(139, 92, 246, 0.3)",type:"social",requirements:"Community Engagement",rarity:"common"},"diamond-hands":{id:"diamond-hands",name:"Diamond Hands",description:"Held assets for 6+ months",icon:"\ud83d\udc8e",color:"#3b82f6",borderColor:"rgba(59, 130, 246, 0.3)",type:"achievement",requirements:"6+ Months Holding",rarity:"epic"},"master-collector":{id:"master-collector",name:"Master Collector",description:"Owns 500+ Journey assets",icon:"\ud83c\udfc6",color:"#dc2626",borderColor:"rgba(220, 38, 38, 0.3)",type:"ownership",requirements:"500+ Journey Assets",rarity:"legendary"}})}async checkUserBadges(e,t=!1){if(!t){const t=this.badgeCache.get(e);if(t&&Date.now()<t.expiresAt)return t.result}try{const[t,a,n]=await Promise.all([$e.getUserInventory(e),this.getPXJBalance(e),this.getTradingStats(e)]),i=[];let r=0,s=!1,l=!1,c=!1;const o=n.volume,d=n.transactions,h=n.accountAge;if(t&&t.length>0){r=t.filter(e=>"pixeljourney"===e.collection).length;const e=t.filter(e=>"781515"===e.template_id).length;s=e>0,s&&i.push(this.BADGE_DEFINITIONS["pixal-pfp"]),e>=250?i.push({...this.BADGE_DEFINITIONS["pixal-collector-250"],unlockedAt:new Date}):e>=100?i.push({...this.BADGE_DEFINITIONS["pixal-collector-100"],unlockedAt:new Date,progress:{current:e,required:250,percentage:Math.round(e/250*100)}}):e>=50?i.push({...this.BADGE_DEFINITIONS["pixal-collector-50"],unlockedAt:new Date,progress:{current:e,required:100,percentage:Math.round(e/100*100)}}):e>=25?i.push({...this.BADGE_DEFINITIONS["pixal-collector-25"],unlockedAt:new Date,progress:{current:e,required:50,percentage:Math.round(e/50*100)}}):e>=5&&i.push({...this.BADGE_DEFINITIONS["pixal-collector-5"],unlockedAt:new Date,progress:{current:e,required:25,percentage:Math.round(e/25*100)}});const a=t.filter(e=>{if(e.template_id===me.getPixalTemplateId()){const t=e.traits?.WaxRock;if("string"==typeof t&&"none"!==t)return me.isValidWaxRock(t);if(e.data){const t=Object.values(e.traits||{}).find(e=>"string"==typeof e&&me.isValidWaxRock(e));return t&&"none"!==t}}return!1}).length;l=a>0,l&&i.push(this.BADGE_DEFINITIONS.waxrock),a>=10?i.push({...this.BADGE_DEFINITIONS["waxrock-collector-10"],unlockedAt:new Date}):a>=6?i.push({...this.BADGE_DEFINITIONS["waxrock-collector-6"],unlockedAt:new Date,progress:{current:a,required:10,percentage:Math.round(a/10*100)}}):a>=3&&i.push({...this.BADGE_DEFINITIONS["waxrock-collector-3"],unlockedAt:new Date,progress:{current:a,required:6,percentage:Math.round(a/6*100)}}),c=t.some(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema),c&&i.push(this.BADGE_DEFINITIONS.ingredients),r>=500?i.push({...this.BADGE_DEFINITIONS["master-collector"],unlockedAt:new Date}):r>=50?i.push({...this.BADGE_DEFINITIONS["journey-collector"],unlockedAt:new Date,progress:r<500?{current:r,required:500,percentage:Math.round(r/500*100)}:void 0}):r>=10&&i.push({...this.BADGE_DEFINITIONS["journey-enthusiast"],unlockedAt:new Date,progress:{current:r,required:50,percentage:Math.round(r/50*100)}})}a>=5e7?i.push({...this.BADGE_DEFINITIONS["pxj-whale"],unlockedAt:new Date}):a>=1e5?i.push({...this.BADGE_DEFINITIONS["pxj-holder"],unlockedAt:new Date,progress:a<5e7?{current:a,required:5e7,percentage:Math.round(a/5e7*100)}:void 0}):a>=1e4&&i.push({...this.BADGE_DEFINITIONS["pxj-shrimp"],unlockedAt:new Date,progress:a<1e5?{current:a,required:1e5,percentage:Math.round(a/1e5*100)}:void 0});const[u,m]=await Promise.all([this.getTokenBalance(e,"pixeljourney","WPIXAL"),this.getTokenBalance(e,"alpha.waxfun","KING")]);u>0&&i.push({...this.BADGE_DEFINITIONS["wpixal-holder"],unlockedAt:new Date}),m>0&&i.push({...this.BADGE_DEFINITIONS["king-holder"],unlockedAt:new Date}),d>=100&&i.push({...this.BADGE_DEFINITIONS["active-trader"],unlockedAt:new Date}),o>=1e4&&i.push({...this.BADGE_DEFINITIONS["volume-trader"],unlockedAt:new Date}),h>=180&&i.push({...this.BADGE_DEFINITIONS["diamond-hands"],unlockedAt:new Date}),new Set(i.map(e=>e.type)).size>=3&&i.push({...this.BADGE_DEFINITIONS["community-member"],unlockedAt:new Date}),await this.checkEarlyAdopterStatus(e)&&i.push(this.BADGE_DEFINITIONS["early-adopter"]);const p={badges:i,pxjBalance:a,journeyAssets:r,pixalPfpOwned:s,waxrockOwned:l,ingredientsOwned:c,tradingVolume:o,totalTransactions:d,accountAge:h};return this.badgeCache.set(e,{result:p,timestamp:Date.now(),expiresAt:Date.now()+this.CACHE_DURATION}),p}catch(a){return ee.logError("BadgeService.checkUserBadges",a,{userAccount:e}),{badges:[],pxjBalance:0,journeyAssets:0,pixalPfpOwned:!1,waxrockOwned:!1,ingredientsOwned:!1,tradingVolume:0,totalTransactions:0,accountAge:0}}}async getPXJBalance(e){try{const t=await $e.fetchWithRetry(`${ue.WAX_CHAIN.EOSRIO}/v2/state/get_tokens?account=${e}`),a=await t.json();if(a.tokens){const e=a.tokens.find(e=>"PXJ"===e.symbol&&"pixeljourney"===e.contract);return e?parseFloat(e.amount):0}return 0}catch(t){return ee.logError("BadgeService.getPXJBalance",t,{userAccount:e}),0}}async getTradingStats(e){try{return{volume:5e4*Math.random(),transactions:Math.floor(200*Math.random()),accountAge:Math.floor(365*Math.random())}}catch(t){return ee.logError("BadgeService.getTradingStats",t,{userAccount:e}),{volume:0,transactions:0,accountAge:0}}}async getTokenBalance(e,t,a){try{const n=await $e.fetchWithRetry(`${ue.WAX_CHAIN.GREYMASS}/get_table_rows`,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:t,scope:e,table:"accounts",limit:100})}),i=await n.json();if(i.rows&&i.rows.length>0){const e=i.rows.find(e=>e.balance&&e.balance.includes(a));if(e){const t=e.balance.split(" ")[0];return parseFloat(t)||0}}return 0}catch(n){return ee.logError("BadgeService.getTokenBalance",n,{userAccount:e,contract:t,symbol:a}),0}}async checkEarlyAdopterStatus(e){try{const t=await $e.fetchWithRetry(`${ue.WAX_CHAIN.EOSRIO}/v2/history/get_actions?account=${e}&limit=1&sort=asc`),a=await t.json();if(a.actions&&a.actions.length>0){const e=a.actions[0];return new Date(e.timestamp)<new Date("2023-01-01")}return!1}catch(t){return ee.logError("BadgeService.checkEarlyAdopterStatus",t,{userAccount:e}),!1}}getBadgeDefinition(e){return this.BADGE_DEFINITIONS[e]}getAllBadgeDefinitions(){return Object.values(this.BADGE_DEFINITIONS)}async hasUserBadge(e,t){return(await this.checkUserBadges(e)).badges.some(e=>e.id===t)}async getUserBadgeStats(e){const t=await this.checkUserBadges(e);return this.getBadgeStatistics(t.badges)}getBadgeStatistics(e){const t={},a={},n=e.filter(e=>e.unlockedAt).sort((e,t)=>new Date(t.unlockedAt).getTime()-new Date(e.unlockedAt).getTime()).slice(0,5),i=e.filter(e=>e.progress);return e.forEach(e=>{t[e.type]=(t[e.type]||0)+1,e.rarity&&(a[e.rarity]=(a[e.rarity]||0)+1)}),{totalBadges:e.length,badgesByType:t,badgesByRarity:a,recentBadges:n,progressBadges:i}}clearBadgeCache(e){e?this.badgeCache.delete(e):this.badgeCache.clear()}getBadgeProgress(e,t){const a=this.badgeCache.get(e);if(!a)return null;const n=a.result.badges.find(e=>e.id===t);return n?.progress?{badgeId:t,current:n.progress.current,required:n.progress.required,percentage:n.progress.percentage}:null}async getAllBadgeDefinitionsWithProgress(e){const t=await this.checkUserBadges(e),a=new Set(t.badges.map(e=>e.id));return Object.values(this.BADGE_DEFINITIONS).map(e=>{const n=t.badges.find(t=>t.id===e.id);return{...e,earned:a.has(e.id),progress:n?.progress,unlockedAt:n?.unlockedAt}})}},Ie=new class{constructor(){t(this,"balanceCache",new Map),t(this,"CACHE_DURATION",3e4)}async getWaxBalance(e,t=!1){if(!e)return"0.0000 WAX";const a=`wax_${e}`,n=this.balanceCache.get(a),i=Date.now();if(!t&&n&&i-n.lastUpdated<this.CACHE_DURATION)return n.balance;try{const t=await $e.getLightApiBalances(e);if(t&&t.balances){const e=t.balances.find(e=>"WAX"===e.currency&&"eosio.token"===e.contract);if(e){const t=`${e.amount} ${e.currency}`;return this.balanceCache.set(a,{balance:t,lastUpdated:i}),t}}}catch(r){se.warn("Light API balance fetch failed, falling back to currency balance API","BalanceService",{error:r})}try{const t=await $e.getWaxCurrencyBalance(e,"eosio.token","WAX");if(t&&t.length>0){const e=t[0].balance;return this.balanceCache.set(a,{balance:e,lastUpdated:i}),e}}catch(r){se.error("Failed to fetch WAX balance","BalanceService",r)}return"0.0000 WAX"}clearCache(e){e?this.balanceCache.delete(`wax_${e}`):this.balanceCache.clear()}isCached(e){const t=this.balanceCache.get(`wax_${e}`);return!!t&&Date.now()-t.lastUpdated<this.CACHE_DURATION}},Me=i.createContext(void 0),Le=({children:e})=>{const[t,a]=i.useState([]),n=r.useRef(null),[s,l]=i.useState(null),[c,o]=i.useState(()=>{const e=localStorage.getItem("notification-sound-enabled");return null===e||JSON.parse(e)}),[d]=i.useState(5);i.useEffect(()=>{localStorage.setItem("notification-sound-enabled",JSON.stringify(c))},[c]);const h=e=>{const t=Date.now().toString()+Math.random().toString(36).substr(2,9),n={...e,id:t,duration:e.duration??5e3};a(e=>{const t=[...e,n];return t.length>d?t.slice(-d):t}),n.duration&&n.duration>0&&setTimeout(()=>{u(t)},n.duration)},u=e=>{a(t=>t.filter(t=>t.id!==e))},m=e=>{n.current&&(n.current(e),n.current=null),l(null)},p={notifications:t,addNotification:h,removeNotification:u,clearAllNotifications:()=>{a([])},showSuccess:(e,t,a)=>{h({type:"success",message:e,title:t,duration:a})},showError:(e,t,a)=>{se.warn("User error notification displayed","NotificationContext.showError",{message:e,title:t,duration:a}),h({type:"error",message:e,title:t,duration:a})},showWarning:(e,t,a)=>{se.info("User warning notification displayed","NotificationContext.showWarning",{message:e,title:t,duration:a}),h({type:"warning",message:e,title:t,duration:a})},showInfo:(e,t,a)=>{h({type:"info",message:e,title:t,duration:a})},confirm:(e,t,a="Confirm",i="Cancel")=>new Promise(r=>{l({title:e,message:t,confirmText:a,cancelText:i}),n.current=r}),confirmDialog:s,resolveConfirm:m,soundEnabled:c,toggleSound:()=>{o(e=>!e)}};return H.jsxs(Me.Provider,{value:p,children:[e,s&&H.jsx("div",{className:"modal-overlay",children:H.jsxs("div",{className:"modal-content confirm-dialog",children:[H.jsx("div",{className:"modal-header",children:H.jsx("h3",{children:s.title||"Confirm Action"})}),H.jsx("div",{className:"modal-body",children:H.jsx("p",{children:s.message})}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"btn-secondary",onClick:()=>m(!1),children:s.cancelText}),H.jsx("button",{className:"btn-primary",onClick:()=>m(!0),children:s.confirmText})]})]})})]})},We=()=>{const e=i.useContext(Me);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e},Re=({isOpen:e,onClose:t})=>{const{isConnected:a,login:n,purchaseNFT:r,batchPurchaseNFTs:s}=Q(),{showError:l,showSuccess:c,showWarning:o}=We(),[d,h]=i.useState([]),[u,m]=i.useState({totalWAX:"0.0000 WAX",totalUSD:"$0.00",itemCount:0}),[p,f]=i.useState(!1),[v,y]=i.useState(new Set),[g,b]=i.useState(20),[N,w]=i.useState(!0),k=i.useCallback(async()=>{f(!0);try{await be.checkAvailability();const t=be.getCart();h(t),y(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)));try{const e=await be.calculateTotals();m(e)}catch(e){se.error("Failed to calculate totals","ShoppingCart",e),l("Calculation Error","Unable to calculate cart totals. Some prices may be outdated.")}}catch(t){se.error("Failed to load cart data","ShoppingCart",t),l("Cart Error","Unable to load cart data. Please try refreshing the page.")}finally{f(!1)}},[l]);i.useEffect(()=>{e&&k();const t=e=>{h(e),be.calculateTotals().then(e=>{m(e)}).catch(e=>{se.error("Failed to calculate totals in cart change handler","ShoppingCart",e)})};return be.addListener(t),()=>be.removeListener(t)},[e,k]);const x=e=>{be.removeFromCart(e),y(t=>{const a=new Set(t);return a.delete(e),a})},C=d.filter(e=>!1!==e.isAvailable),A=d.filter(e=>!1===e.isAvailable);return e?H.jsx("div",{className:"modal-backdrop",onClick:e=>{e.target===e.currentTarget&&t()},role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",children:H.jsxs("div",{className:"modal-content shopping-cart-modal",children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h2",{className:"modal-title",id:"cart-title",children:["Shopping Cart (",u.itemCount," ",1===u.itemCount?"item":"items",")"]}),H.jsx("button",{className:"modal-close",onClick:t,"aria-label":"Close shopping cart",type:"button",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsx("div",{className:"modal-body cart-body",children:p?H.jsxs("div",{className:"cart-loading",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Checking item availability..."})]}):0===d.length?H.jsxs("div",{className:"cart-empty",children:[H.jsx("div",{className:"empty-cart-icon",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"9",cy:"21",r:"1"}),H.jsx("circle",{cx:"20",cy:"21",r:"1"}),H.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})}),H.jsx("h3",{children:"Your cart is empty"}),H.jsx("p",{children:"Add some NFTs from the marketplace to get started!"})]}):H.jsxs(H.Fragment,{children:[H.jsxs("div",{className:"cart-controls",children:[H.jsxs("div",{className:"cart-actions-left",children:[H.jsx("button",{className:"btn-select-all",onClick:()=>{const e=d.filter(e=>!1!==e.isAvailable);e.filter(e=>e.selected).length===e.length&&e.length>0?be.deselectAll():be.selectAll();const t=be.getCart();h(t),y(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)))},"aria-label":v.size===C.length&&C.length>0?`Deselect all ${C.length} items`:`Select all ${C.length} items`,type:"button",children:v.size===C.length&&C.length>0?"Deselect All":"Select All"}),A.length>0&&H.jsxs("button",{className:"btn-cleanup",onClick:()=>{be.cleanupUnavailableItems()},"aria-label":`Remove ${A.length} unavailable items from cart`,type:"button",children:["Remove Unavailable (",A.length,")"]})]}),H.jsx("button",{className:"btn-clear-cart",onClick:()=>{confirm("Are you sure you want to clear your entire cart?")&&(be.clearCart(),y(new Set))},"aria-label":"Clear all items from cart",type:"button",children:"Clear Cart"})]}),C.length>1&&H.jsxs("div",{className:"batch-settings",role:"group","aria-labelledby":"batch-settings-label",children:[H.jsxs("div",{className:"batch-toggle",children:[H.jsxs("label",{children:[H.jsx("input",{type:"checkbox",checked:N,onChange:e=>w(e.target.checked),"aria-describedby":"batch-purchase-description"}),H.jsx("span",{id:"batch-settings-label",children:"Use batch purchasing"})]}),H.jsx("div",{id:"batch-purchase-description",className:"sr-only",children:"Batch purchasing allows you to buy multiple items in a single transaction, which is faster and more efficient."})]}),N&&H.jsxs("div",{className:"batch-controls",children:[H.jsx("label",{htmlFor:"items-per-tx",children:"Items per transaction:"}),H.jsxs("div",{className:"batch-slider",children:[H.jsx("input",{id:"items-per-tx",type:"range",min:"1",max:"50",value:g,onChange:e=>b(parseInt(e.target.value))}),H.jsx("span",{className:"batch-value",children:g})]}),H.jsx("div",{className:"batch-info",children:v.size>g&&H.jsxs("small",{children:["Will create ",Math.ceil(v.size/g)," transaction",Math.ceil(v.size/g)>1?"s":""]})})]})]}),C.length>0&&H.jsxs("div",{className:"cart-section",children:[H.jsx("h3",{className:"section-title",children:"Available Items"}),H.jsx("div",{className:"cart-items",children:C.map(e=>H.jsxs("div",{className:"cart-item",children:[H.jsx("div",{className:"item-checkbox",children:H.jsx("input",{type:"checkbox",checked:v.has(e.nft.asset_id),onChange:()=>(e=>{be.toggleSelection(e);const t=be.getCart();h(t),y(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)))})(e.nft.asset_id),"aria-label":`Select ${e.nft.name} for purchase`,id:`item-${e.nft.asset_id}`})}),H.jsx("div",{className:"item-image",children:e.nft.video?H.jsx("video",{src:e.nft.video,className:"cart-item-media",muted:!0,onError:t=>{const a=document.createElement("img");a.src=e.nft.image,a.className="cart-item-media",a.alt=e.nft.name,t.currentTarget.parentNode?.replaceChild(a,t.currentTarget)}}):H.jsx("img",{src:e.nft.image,alt:`${e.nft.name} from ${e.nft.collection}`,className:"cart-item-media"})}),H.jsxs("div",{className:"item-details",children:[H.jsx("h4",{className:"item-name",children:e.nft.name}),H.jsx("p",{className:"item-collection",children:e.nft.collection}),H.jsx("div",{className:"item-price","aria-label":`Price: ${e.nft.price}`,children:H.jsx("span",{className:"price-wax",children:e.nft.price})})]}),H.jsx("button",{className:"btn-remove",onClick:()=>x(e.nft.asset_id),title:"Remove from cart","aria-label":`Remove ${e.nft.name} from cart`,type:"button",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[H.jsx("polyline",{points:"3,6 5,6 21,6"}),H.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]})})]},e.nft.asset_id))})]}),A.length>0&&H.jsxs("div",{className:"cart-section",children:[H.jsxs("h3",{className:"section-title unavailable-title",children:["Unavailable Items (",A.length,")"]}),H.jsx("div",{className:"cart-items unavailable-items",children:A.map(e=>H.jsxs("div",{className:"cart-item unavailable",children:[H.jsxs("div",{className:"item-image",children:[H.jsx("img",{src:e.nft.image,alt:e.nft.name,className:"cart-item-media"}),H.jsx("div",{className:"unavailable-overlay",children:"Unavailable"})]}),H.jsxs("div",{className:"item-details",children:[H.jsx("h4",{className:"item-name",children:e.nft.name}),H.jsx("p",{className:"item-collection",children:e.nft.collection}),H.jsx("div",{className:"item-price",children:H.jsx("span",{className:"price-wax",children:e.nft.price})})]}),H.jsx("button",{className:"btn-remove",onClick:()=>x(e.nft.asset_id),title:"Remove from cart",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("polyline",{points:"3,6 5,6 21,6"}),H.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]})})]},e.nft.asset_id))})]})]})}),d.length>0&&H.jsxs("div",{className:"modal-footer cart-footer",children:[H.jsx("div",{className:"cart-totals",children:H.jsxs("div",{className:"total-line",children:[H.jsxs("span",{className:"total-label",children:["Total (",v.size," selected):"]}),H.jsxs("div",{className:"total-prices",children:[H.jsx("span",{className:"total-wax",children:u.totalWAX}),H.jsx("span",{className:"total-usd",children:u.totalUSD})]})]})}),H.jsxs("div",{className:"cart-actions",children:[H.jsx("button",{className:"btn-secondary",onClick:t,type:"button","aria-label":"Continue shopping and close cart",children:"Continue Shopping"}),H.jsxs("button",{className:"btn-primary",onClick:async()=>{const e=be.getSelectedItems().filter(e=>!1!==e.isAvailable);if(0===e.length)return void l("Please select items to purchase","No Items Selected");if(!a)try{await n()}catch(d){return se.error("Login failed","ShoppingCart",d),void l("Login Failed","Please connect your wallet to purchase NFTs")}let t=0;const i=[];if(N&&e.length>1){const a=[];for(let t=0;t<e.length;t+=g)a.push(e.slice(t,t+g));for(let e=0;e<a.length;e++){const n=a[e],r=n.filter(e=>e.nft.sale_id&&e.nft.price).map(e=>({saleId:e.nft.sale_id,price:e.nft.price.replace(" WAX","")}));if(0!==r.length)try{await s(r),n.forEach(e=>{e.nft.sale_id&&(be.removeFromCart(e.nft.asset_id),y(t=>{const a=new Set(t);return a.delete(e.nft.asset_id),a}),t++)}),e<a.length-1&&await new Promise(e=>setTimeout(e,2e3))}catch(d){se.error("Batch purchase failed","ShoppingCart",d),l("Batch Purchase Failed",`Failed to purchase batch of ${n.length} items`),n.forEach(e=>{i.push(`${e.nft.name} (batch failed: ${d instanceof Error?d.message:"Unknown error"})`)})}else n.forEach(e=>{e.nft.sale_id||i.push(`${e.nft.name} (not for sale)`)})}}else for(const a of e)try{if(!a.nft.sale_id||!a.nft.price){i.push(`${a.nft.name} (not for sale)`);continue}await r(a.nft.sale_id,a.nft.price.replace(" WAX","")),t++,be.removeFromCart(a.nft.asset_id),y(e=>{const t=new Set(e);return t.delete(a.nft.asset_id),t}),e.length>1&&await new Promise(e=>setTimeout(e,1e3))}catch(d){se.error(`Purchase failed for ${a.nft.name}`,"ShoppingCart",d),l("Purchase Failed",`Failed to purchase ${a.nft.name}`),i.push(`${a.nft.name} (${d instanceof Error?d.message:"Unknown error"})`)}t>0&&0===i.length?c(`Successfully purchased ${t} item${1!==t?"s":""}!`,"Purchase Complete"):t>0&&i.length>0?o(`Partially completed: ${t} successful, ${i.length} failed. Failed items: ${i.join(", ")}`,"Purchase Partially Complete",8e3):l(`All purchases failed. Items: ${i.join(", ")}`,"Purchase Failed")},disabled:0===v.size,type:"button","aria-label":`Buy ${v.size} selected items`,"aria-describedby":"cart-totals",children:["Buy Selected (",v.size,")"]})]})]})]})}):null},Oe=new class{constructor(){t(this,"preferences"),t(this,"focusStack",[]),t(this,"trapFocusElements",[]),t(this,"isInitialized",!1),t(this,"mediaQueryListeners",[]),t(this,"keyboardNavigationActive",!1),this.preferences=this.getDefaultPreferences(),this.detectSystemPreferences()}getDefaultPreferences(){return{reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0}}async initialize(){if(!this.isInitialized)try{this.loadPreferences(),this.setupMediaQueryListeners(),this.setupKeyboardNavigation(),this.applyAccessibilitySettings(),this.setupFocusManagement(),this.isInitialized=!0,xe.trackEvent("accessibility_service_initialized",{preferences:this.preferences,systemPreferences:this.detectSystemPreferences()}),re.info("Accessibility service initialized","ACCESSIBILITY")}catch(e){re.error("Failed to initialize accessibility service","ACCESSIBILITY",e),xe.reportError(e,"accessibility_init_error")}}detectSystemPreferences(){const e={};return window.matchMedia&&(e.reducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e.highContrast=window.matchMedia("(prefers-contrast: high)").matches),e.screenReader=this.detectScreenReader(),e}detectScreenReader(){return navigator.userAgent.includes("NVDA")||navigator.userAgent.includes("JAWS")||navigator.userAgent.includes("VoiceOver")||void 0!==window.speechSynthesis}setupMediaQueryListeners(){if(!window.matchMedia)return;const e=window.matchMedia("(prefers-reduced-motion: reduce)");e.addEventListener("change",e=>{this.updatePreference("reducedMotion",e.matches)}),this.mediaQueryListeners.push(e);const t=window.matchMedia("(prefers-contrast: high)");t.addEventListener("change",e=>{this.updatePreference("highContrast",e.matches)}),this.mediaQueryListeners.push(t)}setupKeyboardNavigation(){document.addEventListener("keydown",e=>{"Tab"===e.key&&(this.keyboardNavigationActive=!0,document.body.classList.add("a11y-keyboard-navigation"))}),document.addEventListener("mousedown",()=>{this.keyboardNavigationActive=!1,document.body.classList.remove("a11y-keyboard-navigation")})}setupFocusManagement(){document.addEventListener("focusin",e=>{const t=e.target;t&&this.keyboardNavigationActive&&this.announceToScreenReader(`Focused on ${this.getElementDescription(t)}`)})}applyAccessibilitySettings(){const e=document.documentElement;this.preferences.reducedMotion?e.classList.add("a11y-reduce-motion"):e.classList.remove("a11y-reduce-motion"),this.preferences.highContrast?e.classList.add("a11y-high-contrast"):e.classList.remove("a11y-high-contrast"),this.preferences.largeText?e.classList.add("a11y-large-text"):e.classList.remove("a11y-large-text"),this.preferences.screenReader?e.classList.add("a11y-screen-reader-active"):e.classList.remove("a11y-screen-reader-active")}updatePreference(e,t){this.preferences[e]=t,this.applyAccessibilitySettings(),this.savePreferences(),xe.trackEvent("accessibility_preference_changed",{preference:e,value:t,allPreferences:this.preferences})}getPreferences(){return{...this.preferences}}setAriaLabel(e,t){e.setAttribute("aria-label",t)}setAriaDescribedBy(e,t){e.setAttribute("aria-describedby",t)}setAriaExpanded(e,t){e.setAttribute("aria-expanded",t.toString())}setAriaSelected(e,t){e.setAttribute("aria-selected",t.toString())}setAriaChecked(e,t){e.setAttribute("aria-checked",t.toString())}setAriaHidden(e,t){e.setAttribute("aria-hidden",t.toString())}focusElement(e,t){try{e.focus(t),this.focusStack.push(e)}catch(a){re.warn("Failed to focus element","ACCESSIBILITY",a)}}restoreFocus(){const e=this.focusStack.pop();e&&document.contains(e)&&this.focusElement(e)}trapFocus(e){const t=this.getFocusableElements(e);t.forEach((e,t)=>{this.trapFocusElements.push({element:e,tabIndex:t,originalTabIndex:e.tabIndex})}),t.length>0&&this.focusElement(t[0]),e.addEventListener("keydown",e=>{if("Tab"===e.key){const a=t[0],n=t[t.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),this.focusElement(n)):document.activeElement===n&&(e.preventDefault(),this.focusElement(a))}"Escape"===e.key&&this.releaseFocusTrap()}),e.setAttribute("data-focus-trap-active","true")}releaseFocusTrap(){this.trapFocusElements.forEach(({element:e,originalTabIndex:t})=>{void 0!==t&&(e.tabIndex=t)}),this.trapFocusElements=[],document.querySelectorAll("[data-focus-trap-active]").forEach(e=>{e.removeAttribute("data-focus-trap-active")}),this.restoreFocus()}getFocusableElements(e){const t=["button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","a[href]",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(", ");return Array.from(e.querySelectorAll(t)).filter(e=>{const t=e;return null!==t.offsetParent&&!t.hasAttribute("aria-hidden")})}announceToScreenReader(e,t="polite"){const a=document.createElement("div");a.setAttribute("aria-live",t),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=e,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},1e3)}getElementDescription(e){const t=e.getAttribute("aria-label");if(t)return t;const a=e.textContent?.trim();if(a)return a;if("IMG"===e.tagName){const t=e.alt;if(t)return t}const n=e.getAttribute("title");return n||`${e.getAttribute("role")||e.tagName.toLowerCase()} element`}registerKeyboardShortcut(e,t,a){document.addEventListener("keydown",n=>{this.matchesShortcut(n,e)&&(n.preventDefault(),t(n),xe.trackEvent("keyboard_shortcut_used",{shortcut:e,description:a}))})}matchesShortcut(e,t){const a=t.toLowerCase().split("+"),n=a.pop(),i={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey};for(const r of a)if(!i[r])return!1;return e.key.toLowerCase()===n}calculateLuminance(e,t,a){const[n,i,r]=[e,t,a].map(e=>e/255),[s,l,c]=[n,i,r].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*s+.7152*l+.0722*c}calculateContrastRatio(e,t){const a=this.hexToRgb(e),n=this.hexToRgb(t);if(!a||!n)return 1;const i=this.calculateLuminance(a.r,a.g,a.b),r=this.calculateLuminance(n.r,n.g,n.b);return(Math.max(i,r)+.05)/(Math.min(i,r)+.05)}checkColorContrast(e,t){return this.calculateContrastRatio(e,t)}hexToRgb(e){return 3===(e=e.replace("#","")).length&&(e=e.split("").map(e=>e+e).join("")),6===e.length&&/^[0-9A-Fa-f]{6}$/.test(e)?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16)}:null}meetsContrastRequirements(e,t,a="AA",n="normal"){return this.calculateContrastRatio(e,t)>={AA:{normal:4.5,large:3},AAA:{normal:7,large:4.5}}[a][n]}suggestAccessibleColors(e,t,a="AA"){const n=[],i=this.hexToRgb(e),r=this.hexToRgb(t);return i&&r?([-60,-40,-20,20,40,60,80,100].forEach(i=>{const r=this.adjustBrightness(e,i),s=this.calculateContrastRatio(r,t);this.meetsContrastRequirements(r,t,a)&&n.push({foreground:r,background:t,ratio:s})}),n.sort((e,t)=>t.ratio-e.ratio).slice(0,5)):n}adjustBrightness(e,t){const a=this.hexToRgb(e);if(!a)return e;const n=t/100,i=e=>n>0?Math.min(255,e+(255-e)*n):Math.max(0,e+e*n),r=Math.round(i(a.r)),s=Math.round(i(a.g)),l=Math.round(i(a.b));return`#${r.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}savePreferences(){try{localStorage.setItem("accessibility_preferences",JSON.stringify(this.preferences))}catch(e){re.warn("Failed to save accessibility preferences","ACCESSIBILITY",e)}}loadPreferences(){try{const e=localStorage.getItem("accessibility_preferences");if(e){const t=JSON.parse(e);this.preferences={...this.preferences,...t}}}catch(e){re.warn("Failed to load accessibility preferences","ACCESSIBILITY",e)}}destroy(){this.mediaQueryListeners.forEach(e=>{e.removeEventListener("change",()=>{})}),this.mediaQueryListeners=[],this.releaseFocusTrap(),this.focusStack=[]}},Be=({isOpen:e,onClose:t})=>{const[a,n]=i.useState({reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0}),[r,s]=i.useState(!1);i.useEffect(()=>{if(e){const e=Oe.getPreferences();n(e),Oe.announceToScreenReader("Accessibility settings dialog opened");const t=document.querySelector(".accessibility-modal button");t&&Oe.focusElement(t)}},[e]);const l=async(e,t)=>{s(!0);try{const i={...a,[e]:t};n(i),Oe.updatePreference(e,t);const r={reducedMotion:"Reduced motion",highContrast:"High contrast",largeText:"Large text",screenReader:"Screen reader optimizations",keyboardNavigation:"Keyboard navigation"};Oe.announceToScreenReader(`${r[e]} ${t?"enabled":"disabled"}`,"assertive"),xe.trackEvent("accessibility_preference_changed",{preference:e,value:t,source:"settings_modal"})}catch(i){xe.reportError(i,"accessibility_preference_update_error"),n(a=>({...a,[e]:!t})),Oe.announceToScreenReader("Failed to update preference. Please try again.","assertive")}finally{s(!1)}},c=()=>{Oe.announceToScreenReader("Accessibility settings dialog closed"),Oe.restoreFocus(),t()};return e?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"accessibility-modal-backdrop",onClick:c,"aria-hidden":"true"}),H.jsx("div",{className:"accessibility-modal "+(r?"loading":""),role:"dialog","aria-modal":"true","aria-labelledby":"accessibility-settings-title","aria-describedby":"accessibility-settings-description",onKeyDown:e=>{"Escape"===e.key&&c()},children:H.jsxs("div",{className:"accessibility-modal-content",children:[H.jsxs("div",{className:"accessibility-modal-header",children:[H.jsx("h2",{id:"accessibility-settings-title",className:"accessibility-modal-title",children:"Accessibility Settings"}),H.jsx("button",{onClick:c,className:"accessibility-modal-close","aria-label":"Close accessibility settings",children:H.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H.jsx("p",{id:"accessibility-settings-description",className:"accessibility-modal-description",children:"Customize your accessibility preferences to improve your experience with the application."}),H.jsxs("div",{className:"accessibility-settings-list",children:[H.jsxs("div",{className:"accessibility-setting-item",children:[H.jsxs("div",{className:"accessibility-setting-info",children:[H.jsx("label",{className:"accessibility-setting-label",children:"Reduced Motion"}),H.jsx("p",{className:"accessibility-setting-description",children:"Minimize animations and transitions for a calmer experience."})]}),H.jsx("button",{onClick:()=>l("reducedMotion",!a.reducedMotion),className:"accessibility-toggle "+(a.reducedMotion?"active":""),role:"switch","aria-checked":a.reducedMotion,disabled:r,children:H.jsx("span",{className:"accessibility-toggle-thumb"})})]}),H.jsxs("div",{className:"accessibility-setting-item",children:[H.jsxs("div",{className:"accessibility-setting-info",children:[H.jsx("label",{className:"accessibility-setting-label",children:"High Contrast"}),H.jsx("p",{className:"accessibility-setting-description",children:"Increase color contrast for better visibility"})]}),H.jsx("button",{onClick:()=>l("highContrast",!a.highContrast),className:"accessibility-toggle "+(a.highContrast?"active":""),role:"switch","aria-checked":a.highContrast,disabled:r,children:H.jsx("span",{className:"accessibility-toggle-thumb"})})]}),H.jsxs("div",{className:"accessibility-setting-item",children:[H.jsxs("div",{className:"accessibility-setting-info",children:[H.jsx("label",{className:"accessibility-setting-label",children:"Large Text"}),H.jsx("p",{className:"accessibility-setting-description",children:"Increase text size throughout the application"})]}),H.jsx("button",{onClick:()=>l("largeText",!a.largeText),className:"accessibility-toggle "+(a.largeText?"active":""),role:"switch","aria-checked":a.largeText,disabled:r,children:H.jsx("span",{className:"accessibility-toggle-thumb"})})]}),H.jsxs("div",{className:"accessibility-setting-item",children:[H.jsxs("div",{className:"accessibility-setting-info",children:[H.jsx("label",{className:"accessibility-setting-label",children:"Screen Reader Optimizations"}),H.jsx("p",{className:"accessibility-setting-description",children:"Optimize interface for screen reader users"})]}),H.jsx("button",{onClick:()=>l("screenReader",!a.screenReader),className:"accessibility-toggle "+(a.screenReader?"active":""),role:"switch","aria-checked":a.screenReader,disabled:r,children:H.jsx("span",{className:"accessibility-toggle-thumb"})})]}),H.jsxs("div",{className:"accessibility-setting-item",children:[H.jsxs("div",{className:"accessibility-setting-info",children:[H.jsx("label",{className:"accessibility-setting-label",children:"Enhanced Keyboard Navigation"}),H.jsx("p",{className:"accessibility-setting-description",children:"Show focus indicators and enable keyboard shortcuts"})]}),H.jsx("button",{onClick:()=>l("keyboardNavigation",!a.keyboardNavigation),className:"accessibility-toggle "+(a.keyboardNavigation?"active":""),role:"switch","aria-checked":a.keyboardNavigation,disabled:r,children:H.jsx("span",{className:"accessibility-toggle-thumb"})})]})]}),H.jsxs("div",{className:"accessibility-modal-actions",children:[H.jsx("button",{onClick:()=>{const e={reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0};n(e),Object.entries(e).forEach(([e,t])=>{Oe.updatePreference(e,t)}),Oe.announceToScreenReader("Accessibility settings reset to defaults","assertive"),xe.trackEvent("accessibility_settings_reset",{source:"settings_modal"})},disabled:r,className:"accessibility-modal-reset",children:"Reset to Defaults"}),H.jsxs("div",{className:"accessibility-modal-buttons",children:[H.jsx("button",{onClick:c,disabled:r,className:"accessibility-modal-cancel",children:"Cancel"}),H.jsx("button",{onClick:c,disabled:r,className:"accessibility-modal-done",children:r?"Saving...":"Done"})]})]}),H.jsxs("div",{className:"accessibility-shortcuts",children:[H.jsx("h3",{className:"accessibility-shortcuts-title",children:"Keyboard Shortcuts"}),H.jsxs("div",{className:"accessibility-shortcuts-list",children:[H.jsxs("div",{className:"accessibility-shortcut",children:[H.jsx("span",{children:"Close modal"}),H.jsx("kbd",{className:"accessibility-kbd",children:"Esc"})]}),H.jsxs("div",{className:"accessibility-shortcut",children:[H.jsx("span",{children:"Navigate settings"}),H.jsx("kbd",{className:"accessibility-kbd",children:"Tab"})]}),H.jsxs("div",{className:"accessibility-shortcut",children:[H.jsx("span",{children:"Toggle setting"}),H.jsx("kbd",{className:"accessibility-kbd",children:"Space"})]}),H.jsxs("div",{className:"accessibility-shortcut",children:[H.jsx("span",{children:"Activate buttons"}),H.jsx("kbd",{className:"accessibility-kbd",children:"Enter"})]})]})]})]})})]}):null},je=({currentPage:e})=>{const{isConnected:t,isLoading:a,login:n,logout:r,account:l}=Q(),[c,o]=i.useState(!1),[d,h]=i.useState(!1),[u,m]=i.useState(0),[p,f]=i.useState(!1),[v,y]=i.useState(!1),[g,b]=i.useState(!1),[N,w]=i.useState(()=>{if(l){const e=localStorage.getItem(`userSettings_${l}`);if(e){const t=JSON.parse(e);return void 0===t.darkMode||t.darkMode}}const e=localStorage.getItem("darkMode");return!e||JSON.parse(e)}),{settings:k,updateSetting:x}=ke(),[C,A]=i.useState("0.0000"),[_,S]=i.useState([]),[P,T]=i.useState(0),[$,F]=i.useState(!1),[E,I]=i.useState(!1),[M,L]=i.useState(!1),W=i.useRef(null),R=i.useRef(null);i.useEffect(()=>{const e=()=>{h(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),i.useEffect(()=>{if(document.documentElement.setAttribute("data-theme",N?"dark":"light"),localStorage.setItem("darkMode",JSON.stringify(N)),l){const e=localStorage.getItem(`userSettings_${l}`);if(e){const t={...JSON.parse(e),darkMode:N};localStorage.setItem(`userSettings_${l}`,JSON.stringify(t))}}},[N,l]);const O=()=>{const e=!N;if(w(e),l){const t=localStorage.getItem(`userSettings_${l}`);if(t){const a={...JSON.parse(t),darkMode:e};localStorage.setItem(`userSettings_${l}`,JSON.stringify(a))}else{const t={emailNotifications:!0,priceAlerts:!0,marketingEmails:!1,darkMode:e,language:"en",currency:"WAX"};localStorage.setItem(`userSettings_${l}`,JSON.stringify(t))}}};i.useEffect(()=>{const e=()=>{m(be.getCartCount())};return e(),be.addListener(e),()=>be.removeListener(e)},[]);const B=()=>{o(!c)},j=()=>{o(!1)},D=()=>{y(!1)},U=i.useCallback(async(e=!1)=>{if(l&&t)try{const t=await Ie.getWaxBalance(l,e);A(t),T(Date.now())}catch(a){se.error("Failed to fetch WAX balance","Navigation",a)}},[l,t]),X=i.useCallback(async()=>{if(l&&t)try{const e=await Ee.checkUserBadges(l);S(e.badges)}catch(e){se.error("Failed to check user badges","Navigation",e)}},[l,t]);return i.useEffect(()=>{const e=e=>{W.current&&!W.current.contains(e.target)&&D(),R.current&&!R.current.contains(e.target)&&I(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),i.useEffect(()=>{t&&l?(U(),X()):(A("0.0000"),S([]))},[t,l,U,X]),H.jsxs(H.Fragment,{children:[H.jsx("a",{href:"#main-content",className:"a11y-skip-link",children:"Skip to main content"}),H.jsx("a",{href:"#navigation",className:"a11y-skip-link",children:"Skip to navigation"}),H.jsx("nav",{className:"navbar "+(d?"scrolled":""),role:"navigation","aria-label":"Main navigation",id:"navigation",children:H.jsxs("div",{className:"navbar-container",children:[H.jsxs(s,{to:"/marketplace",className:"navbar-logo","aria-label":"PxMarket - Go to marketplace home",children:[H.jsx("img",{src:"https://pixeljourney.xyz/img/logo.png",alt:"PxMarket logo",className:"logo-image"}),H.jsx("span",{className:"logo-text",children:"PxMarket"})]}),H.jsxs("div",{className:"navbar-nav",role:"menubar","aria-label":"Main menu",children:[H.jsx(s,{to:"/rwax",className:"nav-link "+("rwax"===e?"active":""),role:"menuitem","aria-current":"rwax"===e?"page":void 0,children:"RWAX"}),H.jsx(s,{to:"/collections",className:"nav-link "+("collections"===e?"active":""),role:"menuitem","aria-current":"collections"===e?"page":void 0,children:"Collections"}),H.jsxs("div",{className:"nav-dropdown",role:"menuitem",ref:R,children:[H.jsxs("button",{className:"nav-link dropdown-toggle "+(E?"active":""),onClick:()=>I(!E),"aria-expanded":E,"aria-haspopup":"true",children:["More",H.jsx("svg",{className:"dropdown-arrow",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E&&H.jsxs("div",{className:"dropdown-menu",role:"menu",children:[H.jsxs("div",{className:"dropdown-section",children:[H.jsx("h4",{className:"dropdown-section-title",children:"Marketplace"}),H.jsx(s,{to:"/auctions",className:"dropdown-item "+("auctions"===e?"active":""),role:"menuitem",onClick:()=>I(!1),children:"Auctions"}),H.jsx(s,{to:"/activity",className:"dropdown-item "+("activity"===e?"active":""),role:"menuitem",onClick:()=>I(!1),children:"Activity"})]}),H.jsxs("div",{className:"dropdown-section",children:[H.jsx("h4",{className:"dropdown-section-title",children:"Tools & Features"}),H.jsx(s,{to:"/pxcraft",className:"dropdown-item "+("pxcraft"===e?"active":""),role:"menuitem",onClick:()=>I(!1),children:"PxCraft"}),H.jsx(s,{to:"/pxswap",className:"dropdown-item "+("pxswap"===e?"active":""),role:"menuitem",onClick:()=>I(!1),children:"PxSwap"}),H.jsx(s,{to:"/journeymap",className:"dropdown-item "+("journeymap"===e?"active":""),role:"menuitem",onClick:()=>I(!1),children:"JourneyMap"}),H.jsx(s,{to:"/staking",className:"dropdown-item "+("pxstaking"===e?"active":""),role:"menuitem",onClick:()=>I(!1),children:"PxStaking"})]}),H.jsxs("div",{className:"dropdown-section social-section",children:[H.jsx("h4",{className:"dropdown-section-title",children:"Community"}),H.jsxs("a",{href:"http://discord.gg/pixel-journey-1130670500776005734",target:"_blank",rel:"noopener noreferrer",className:"dropdown-item nav-social-link",role:"menuitem",children:[H.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})}),"Join Discord"]}),H.jsxs("a",{href:"https://x.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"dropdown-item nav-social-link",role:"menuitem",children:[H.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"Follow on X"]})]})]})]}),H.jsx(s,{to:"/learn",className:"nav-link "+("learn"===e?"active":""),role:"menuitem","aria-current":"learn"===e?"page":void 0,children:"Learn"}),H.jsx(s,{to:"/rewards",className:"nav-link "+("rewards"===e?"active":""),role:"menuitem","aria-current":"rewards"===e?"page":void 0,children:"Rewards"})]}),H.jsxs("div",{className:"navbar-actions",children:[H.jsx("button",{onClick:()=>b(!0),className:"accessibility-btn","aria-label":"Open accessibility settings",title:"Accessibility Settings",children:H.jsx("svg",{className:"accessibility-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})})}),t&&u>0&&H.jsxs("button",{onClick:()=>f(!0),className:"cart-btn","aria-label":`Open Shopping Cart (${u} items)`,"aria-describedby":"cart-count",children:[H.jsxs("svg",{className:"cart-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[H.jsx("circle",{cx:"9",cy:"21",r:"1"}),H.jsx("circle",{cx:"20",cy:"21",r:"1"}),H.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),H.jsx("span",{className:"cart-badge",id:"cart-count","aria-label":`${u} items in cart`,children:u}),H.jsx("span",{className:"cart-text",children:"Cart"})]}),H.jsxs("div",{className:"wallet-container",ref:W,children:[H.jsx("button",{className:"wallet-btn "+(t?"connected":""),onClick:t?()=>{y(!v),!v&&t&&l&&Date.now()-P>3e4&&U()}:n,disabled:a,"aria-label":t?`Wallet connected: ${l}. Click to open wallet menu`:"Connect wallet","aria-expanded":t&&v,"aria-haspopup":"menu",children:a?H.jsx("span",{className:"loading-spinner",children:"\u27f3"}):t?H.jsxs(H.Fragment,{children:[H.jsx("svg",{className:"wallet-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),l||"Connected"]}):"Connect"}),t&&v&&H.jsxs("div",{className:"wallet-dropdown",role:"menu","aria-label":"Wallet menu",onKeyDown:e=>{"Escape"===e.key&&(D(),Oe.announceToScreenReader("Wallet menu closed"))},children:[H.jsx("div",{className:"wallet-dropdown-header",role:"group","aria-label":"Wallet information",children:H.jsx("div",{className:"wallet-account","aria-label":`Wallet account: ${l}`,children:l})}),H.jsxs(s,{to:"/inventory",className:"wallet-inventory-btn","aria-label":"Open Inventory",onClick:()=>y(!1),role:"menuitem",children:[H.jsxs("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[H.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),H.jsx("path",{d:"M9 9h6v6H9z"})]}),H.jsx("span",{children:"My Inventory"})]}),H.jsxs(s,{to:"/profile",className:"wallet-inventory-btn","aria-label":"View Profile",onClick:()=>y(!1),role:"menuitem",children:[H.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),H.jsx("span",{children:"My Profile"})]}),H.jsxs(s,{to:"/watchlist",className:"wallet-inventory-btn","aria-label":"View Watchlist",onClick:()=>y(!1),role:"menuitem",children:[H.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),H.jsx("span",{children:"My Watchlist"})]}),H.jsxs("div",{className:"wallet-balance",role:"group","aria-label":"Wallet balance information",children:[H.jsx("span",{className:"balance-label",children:"WAX Balance:"}),H.jsx("span",{className:"nav-balance-amount","aria-label":`Balance: ${C} WAX`,children:C})]}),H.jsxs("div",{className:"wallet-badges",role:"group","aria-label":"User badges",children:[H.jsxs("div",{className:"badges-header",onClick:()=>L(!M),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0"},children:[H.jsx("span",{className:"badges-label",children:"PxBadges:"}),H.jsx("span",{style:{fontSize:"12px",color:"#888"},children:M?"\u25bc":"\u25b6"})]}),M?H.jsx("div",{className:"badges-expanded",style:{display:"flex",flexDirection:"column",gap:"8px"},children:Ee.getAllBadgeDefinitions().map(e=>{const t=_.some(t=>t.id===e.id);return H.jsxs("div",{className:"badge-item "+(t?"earned":"unearned"),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",borderRadius:"6px",background:t?`${e.color}15`:"rgba(128, 128, 128, 0.05)",border:`1px solid ${t?e.borderColor:"rgba(128, 128, 128, 0.1)"}`},children:[H.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[H.jsx("span",{style:{fontSize:"16px",opacity:t?1:.5},children:e.icon}),H.jsxs("div",{children:[H.jsxs("div",{style:{fontSize:"12px",fontWeight:"500",color:t?e.color:"#666"},children:[e.name," ",t&&"\u2713"]}),H.jsx("div",{style:{fontSize:"10px",color:"#888"},children:e.requirements})]})]}),!t&&H.jsx("button",{onClick:()=>{"pxj-whale"===e.id||"pxj-holder"===e.id?window.open("https://waxonedge.app/swap/WAX_eosio.token/PXJ_pixeljourney","_blank"):"pixal-pfp"===e.id?window.location.href="/marketplace?collection=pixeljourney&template=781515":"waxrock"===e.id?window.location.href="/marketplace?category=waxrock":"ingredients"===e.id?window.location.href="/marketplace?category=ingredients":window.location.href="/marketplace?collection=pixeljourney"},style:{fontSize:"10px",padding:"4px 8px",background:e.color,color:"white",border:"none",borderRadius:"4px",cursor:"pointer",transition:"opacity 0.2s"},onMouseEnter:e=>e.target.style.opacity="0.8",onMouseLeave:e=>e.target.style.opacity="1",children:"Buy"})]},e.id)})}):H.jsxs("div",{className:"badges-collapsed",style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[Ee.getAllBadgeDefinitions().filter(e=>_.some(t=>t.id===e.id)).map(e=>H.jsx("span",{className:"badge-icon earned",style:{fontSize:"16px",padding:"4px",borderRadius:"4px",background:`${e.color}20`,color:e.color,border:`1px solid ${e.borderColor}`,cursor:"pointer"},title:`${e.name}: ${e.description} \u2713 Earned`,children:e.icon},e.id)),0===_.length&&H.jsx("span",{style:{fontSize:"12px",color:"#888",fontStyle:"italic"},children:"No badges earned yet"})]})]}),H.jsx("div",{className:"wallet-settings",children:H.jsx("div",{className:"settings-menu",children:H.jsxs("div",{className:"settings-section",children:[H.jsxs("div",{className:"settings-header",onClick:()=>F(!$),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0"},children:[H.jsx("h4",{children:"Display Options"}),H.jsx("span",{style:{fontSize:"12px",color:"#888"},children:$?"\u25bc":"\u25b6"})]}),$?H.jsxs("div",{className:"filter-options",children:[H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.showOtherCollections,onChange:e=>x("showOtherCollections",e.target.checked)}),H.jsx("span",{children:"Show other collections"})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.showWhitelistedOnly,onChange:e=>x("showWhitelistedOnly",e.target.checked)}),H.jsx("span",{children:"Displays only whitelisted collections in overviews"})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.enableAnimatedNFTs,onChange:e=>x("enableAnimatedNFTs",e.target.checked)}),H.jsx("span",{children:"Enables animated NFTs to play in overviews"})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.showExplicitContent,onChange:e=>x("showExplicitContent",e.target.checked)}),H.jsx("span",{children:"Enables explicit content to be shown in overviews"})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.showChatButton,onChange:e=>x("showChatButton",e.target.checked)}),H.jsx("span",{children:"Show chat button"})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.blockNSFW,onChange:e=>x("blockNSFW",e.target.checked)}),H.jsx("span",{children:"Blocks NSFW collections from the platform"})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.blockAI,onChange:e=>x("blockAI",e.target.checked)}),H.jsx("span",{children:"Blocks AI collections from the platform"})]}),H.jsxs("div",{className:"theme-toggle-option",children:[H.jsx("span",{children:"Dark Mode"}),H.jsx("button",{className:"theme-toggle "+(N?"active":""),onClick:O,children:H.jsxs("div",{className:"toggle-slider",children:[H.jsxs("svg",{className:"sun-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"5"}),H.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),H.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),H.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),H.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),H.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),H.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),H.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),H.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),H.jsx("svg",{className:"moon-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})]})})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.showPricesInUSD,onChange:e=>x("showPricesInUSD",e.target.checked)}),H.jsx("span",{children:"Show Prices in USD"})]}),H.jsxs("div",{className:"currency-selection",children:[H.jsx("label",{children:"Currency Comparison:"}),H.jsxs("select",{value:k.selectedCurrency,onChange:e=>x("selectedCurrency",e.target.value),className:"currency-select",children:[H.jsx("option",{value:"USD",children:"USD - US Dollar"}),H.jsx("option",{value:"EUR",children:"EUR - Euro"}),H.jsx("option",{value:"DKK",children:"DKK - Danish Krone"}),H.jsx("option",{value:"AED",children:"AED - UAE Dirham"}),H.jsx("option",{value:"INR",children:"INR - Indian Rupee"}),H.jsx("option",{value:"RUB",children:"RUB - Russian Ruble"}),H.jsx("option",{value:"CNY",children:"CNY - Chinese Yuan"}),H.jsx("option",{value:"JPY",children:"JPY - Japanese Yen"}),H.jsx("option",{value:"BTC",children:"BTC - Bitcoin"}),H.jsx("option",{value:"ETH",children:"ETH - Ethereum"})]})]}),H.jsxs("label",{className:"filter-option",children:[H.jsx("input",{type:"checkbox",checked:k.showRarityRankings,onChange:e=>x("showRarityRankings",e.target.checked)}),H.jsx("span",{children:"Show Rarity Rankings"})]})]}):H.jsxs("div",{className:"theme-toggle-option",style:{marginTop:"8px"},children:[H.jsx("span",{children:"Dark Mode"}),H.jsx("button",{className:"theme-toggle "+(N?"active":""),onClick:O,children:H.jsxs("div",{className:"toggle-slider",children:[H.jsxs("svg",{className:"sun-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"5"}),H.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),H.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),H.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),H.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),H.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),H.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),H.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),H.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),H.jsx("svg",{className:"moon-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})]})})]})]})})}),H.jsxs("button",{className:"logout-btn",onClick:r,role:"menuitem","aria-label":"Logout from wallet",children:[H.jsx("span",{className:"logout-icon","aria-hidden":"true",children:"\ud83d\udeaa"}),"Logout"]})]})]}),H.jsx("button",{onClick:B,className:"mobile-menu-btn "+(c?"active":""),"aria-label":c?"Close Menu":"Open Menu","aria-expanded":c,"aria-controls":"mobile-menu",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),B(),Oe.announceToScreenReader(c?"Mobile menu closed":"Mobile menu opened"))},children:H.jsxs("div",{className:"hamburger","aria-hidden":"true",children:[H.jsx("span",{}),H.jsx("span",{}),H.jsx("span",{})]})})]})]})}),H.jsxs("div",{className:"mobile-menu "+(c?"open":""),id:"mobile-menu",role:"navigation","aria-expanded":c,"aria-label":"Mobile navigation menu",onKeyDown:e=>{"Escape"===e.key&&(j(),Oe.announceToScreenReader("Mobile menu closed"))},children:[H.jsxs("nav",{className:"mobile-nav-links",role:"navigation","aria-label":"Mobile menu links",children:[H.jsxs("div",{className:"mobile-nav-section",children:[H.jsx("h3",{className:"mobile-nav-section-title",children:"Main"}),H.jsxs("div",{className:"mobile-nav-grid",children:[H.jsx(s,{to:"/",onClick:j,className:"mobile-nav-link "+("marketplace"===e||""===e?"active":""),children:"Marketplace"}),H.jsx(s,{to:"/rwax",onClick:j,className:"mobile-nav-link "+("rwax"===e?"active":""),children:"RWAX"}),H.jsx(s,{to:"/collections",onClick:j,className:"mobile-nav-link "+("collections"===e?"active":""),children:"Collections"}),H.jsx(s,{to:"/learn",onClick:j,className:"mobile-nav-link "+("learn"===e?"active":""),children:"Learn"}),H.jsx(s,{to:"/rewards",onClick:j,className:"mobile-nav-link "+("rewards"===e?"active":""),children:"Rewards"})]})]}),H.jsxs("div",{className:"mobile-nav-section",children:[H.jsx("h3",{className:"mobile-nav-section-title",children:"Trading & Tools"}),H.jsxs("div",{className:"mobile-nav-grid",children:[H.jsx(s,{to:"/auctions",onClick:j,className:"mobile-nav-link "+("auctions"===e?"active":""),children:"Auctions"}),H.jsx(s,{to:"/activity",onClick:j,className:"mobile-nav-link "+("activity"===e?"active":""),children:"Activity"}),H.jsx(s,{to:"/pxcrafting",onClick:j,className:"mobile-nav-link "+("pxcrafting"===e?"active":""),children:"PxCraft"}),H.jsx(s,{to:"/pxswap",onClick:j,className:"mobile-nav-link "+("pxswap"===e?"active":""),children:"PxSwap"}),H.jsx(s,{to:"/journeymap",onClick:j,className:"mobile-nav-link "+("journeymap"===e?"active":""),children:"JourneyMap"}),H.jsx(s,{to:"/staking",onClick:j,className:"mobile-nav-link "+("pxstaking"===e?"active":""),children:"PxStaking"})]})]}),H.jsxs("div",{className:"mobile-nav-section",children:[H.jsx("h3",{className:"mobile-nav-section-title",children:"Community"}),H.jsxs("div",{className:"mobile-social-section",children:[H.jsxs("a",{href:"http://discord.gg/pixel-journey-1130670500776005734",target:"_blank",rel:"noopener noreferrer",className:"mobile-social-link",onClick:j,children:[H.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028 14.09 14.09 0 0 0 1.226-1.994.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})}),"Discord"]}),H.jsxs("a",{href:"https://x.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"mobile-social-link",onClick:j,children:[H.jsx("svg",{className:"social-icon",fill:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})}),"X (Twitter)"]})]})]})]}),H.jsxs("div",{className:"mobile-menu-actions",children:[t&&u>0&&H.jsxs("button",{onClick:()=>{f(!0),j()},className:"mobile-cart-btn","aria-label":`Open Shopping Cart (${u} items)`,children:[H.jsxs("svg",{className:"cart-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[H.jsx("circle",{cx:"9",cy:"21",r:"1"}),H.jsx("circle",{cx:"20",cy:"21",r:"1"}),H.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),"Shopping Cart (",u,")"]}),t&&H.jsxs(H.Fragment,{children:[H.jsxs(s,{to:"/inventory",onClick:j,className:"mobile-inventory-btn",children:[H.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"My Inventory"]}),H.jsxs(s,{to:"/profile",onClick:j,className:"mobile-inventory-btn",children:[H.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"My Profile"]}),H.jsxs(s,{to:"/watchlist",onClick:j,className:"mobile-inventory-btn",children:[H.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),"My Watchlist"]})]}),H.jsx("div",{className:"mobile-auth-section",children:t?H.jsxs("button",{onClick:()=>{r(),j(),Oe.announceToScreenReader("Logged out successfully")},className:"mobile-auth-btn logout-btn",children:[H.jsx("svg",{className:"auth-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Logout"]}):H.jsxs("button",{onClick:()=>{n(),j(),Oe.announceToScreenReader("Login initiated")},className:"mobile-auth-btn login-btn",children:[H.jsx("svg",{className:"auth-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Login"]})})]})]}),c&&H.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[998]",onClick:j}),H.jsx(Re,{isOpen:p,onClose:()=>f(!1)}),H.jsx(Be,{isOpen:g,onClose:()=>b(!1)})]})},De=()=>H.jsxs("div",{className:"landing-page",children:[H.jsx("div",{className:"hero-section",children:H.jsxs("div",{className:"hero-content",children:[H.jsxs("h1",{className:"hero-title",children:["Welcome to ",H.jsx("span",{className:"brand-highlight",children:"PxMarket"})]}),H.jsx("p",{className:"hero-subtitle",children:"by Pixel Journey"}),H.jsx("p",{className:"hero-description",children:"Discover, trade, and collect unique digital assets in the ultimate NFT marketplace experience."})]})}),H.jsx("div",{className:"cta-section",children:H.jsxs("div",{className:"cta-container",children:[H.jsxs("div",{className:"cta-card marketplace-card",children:[H.jsx("div",{className:"cta-icon",children:"\ud83c\udfea"}),H.jsx("h2",{className:"cta-title",children:"Explore Marketplace"}),H.jsx("p",{className:"cta-description",children:"Browse thousands of unique NFTs, discover rare collectibles, and find your next digital (pixel?!) treasure."}),H.jsx(s,{to:"/marketplace",className:"cta-button primary",children:"Enter Marketplace"})]}),H.jsxs("div",{className:"cta-card rwax-card",children:[H.jsx("div",{className:"cta-icon",children:"\ud83c\udfad"}),H.jsx("h2",{className:"cta-title",children:"Get Your Pixal PFP via R-WAX"}),H.jsx("p",{className:"cta-description",children:"Pick up your unique pixel-perfect Pixal Profile Picture using WPIXAL on the R-WAX Markets and join the Pixel Journey community!"}),H.jsx(s,{to:"/rwax",className:"cta-button secondary",children:"Browse RWAX Pixals"})]})]})}),H.jsx("div",{className:"features-section",children:H.jsxs("div",{className:"features-container",children:[H.jsxs("div",{className:"feature-item",children:[H.jsx("div",{className:"feature-icon",children:"\u26a1"}),H.jsx("h3",{children:"Lightning Fast"}),H.jsx("p",{children:"Instant transactions on the WAX blockchain"})]}),H.jsxs("div",{className:"feature-item",children:[H.jsx("div",{className:"feature-icon",children:"\ud83d\udd12"}),H.jsx("h3",{children:"Secure Trading"}),H.jsx("p",{children:"Safe and transparent blockchain transactions"})]}),H.jsxs("div",{className:"feature-item",children:[H.jsx("div",{className:"feature-icon",children:"\ud83c\udf1f"}),H.jsx("h3",{children:"Premium Quality"}),H.jsx("p",{children:"Curated collection of high-quality digital assets"})]})]})})]}),Ue=new class{constructor(){t(this,"serviceWorkerRegistration",null),t(this,"pushSubscription",null),t(this,"vapidPublicKey",""),t(this,"isInitialized",!1),t(this,"permissionState",{permission:"default",supported:!1,serviceWorkerReady:!1,subscribed:!1}),this.checkSupport()}checkSupport(){this.permissionState.supported="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,this.permissionState.supported&&(this.permissionState.permission=Notification.permission)}async initialize(){if(this.isInitialized)return!0;try{return this.permissionState.supported?(await this.registerServiceWorker(),await this.checkExistingSubscription(),this.isInitialized=!0,xe.trackEvent("push_notification_service_initialized",{supported:this.permissionState.supported,permission:this.permissionState.permission,subscribed:this.permissionState.subscribed}),!0):(se.warn("Push notifications not supported in this browser"),!1)}catch(e){return se.error("Failed to initialize push notification service","PushNotificationService.initialize",e),xe.reportError(e,"push_notification_init_error"),!1}}async registerServiceWorker(){try{const e="localhost"===location.hostname||"127.0.0.1"===location.hostname||"http:"===location.protocol?"/sw-dev.js":"/sw.js";this.serviceWorkerRegistration=await navigator.serviceWorker.register(e,{scope:"/"}),await navigator.serviceWorker.ready,this.permissionState.serviceWorkerReady=!0,se.info(`Service Worker registered successfully: ${e}`),navigator.serviceWorker.addEventListener("message",this.handleServiceWorkerMessage.bind(this))}catch(e){throw se.error("Failed to register service worker","PushNotificationService.registerServiceWorker",e),e}}handleServiceWorkerMessage(e){const{type:t,data:a}=e.data||{};switch(t){case"NOTIFICATION_CLICKED":xe.trackEvent("notification_clicked",a);break;case"NOTIFICATION_CLOSED":xe.trackEvent("notification_closed",a);break;default:se.debug("Unknown service worker message:",t)}}async checkExistingSubscription(){if(this.serviceWorkerRegistration)try{this.pushSubscription=await this.serviceWorkerRegistration.pushManager.getSubscription(),this.permissionState.subscribed=!!this.pushSubscription,this.pushSubscription&&(se.info("Existing push subscription found"),await this.validateSubscription())}catch(e){se.error("Failed to check existing subscription","PushNotificationService.checkExistingSubscription",e)}}async requestPermission(){if(!this.permissionState.supported)throw new Error("Push notifications not supported");try{const e=await Notification.requestPermission();return this.permissionState.permission=e,xe.trackEvent("notification_permission_requested",{permission:e,previousPermission:this.permissionState.permission}),e}catch(e){throw ee.logError("PushNotificationService.requestPermission",e),xe.reportError(e,"notification_permission_error"),e}}async subscribe(e){if(this.isInitialized||await this.initialize(),!this.serviceWorkerRegistration)throw new Error("Service worker not registered");if("granted"!==this.permissionState.permission&&"granted"!==await this.requestPermission())throw new Error("Notification permission denied");try{this.pushSubscription&&await this.unsubscribe();const t={userVisibleOnly:!0,applicationServerKey:this.vapidPublicKey?this.urlBase64ToUint8Array(this.vapidPublicKey):void 0};this.pushSubscription=await this.serviceWorkerRegistration.pushManager.subscribe(t),this.permissionState.subscribed=!0;const a={endpoint:this.pushSubscription.endpoint,keys:{p256dh:this.arrayBufferToBase64(this.pushSubscription.getKey("p256dh")),auth:this.arrayBufferToBase64(this.pushSubscription.getKey("auth"))},userId:e,subscriptionTime:Date.now()};return localStorage.setItem("push_subscription",JSON.stringify(a)),await this.sendSubscriptionToServer(a),xe.trackEvent("push_notification_subscribed",{userId:e,endpoint:this.pushSubscription.endpoint}),se.info("Push notification subscription successful"),this.pushSubscription}catch(t){throw se.error("Failed to subscribe to push notifications","PushNotificationService.subscribe",t),xe.reportError(t,"push_subscription_error",{userId:e}),t}}async unsubscribe(){if(!this.pushSubscription)return!0;try{const e=await this.pushSubscription.unsubscribe();return e&&(this.pushSubscription=null,this.permissionState.subscribed=!1,localStorage.removeItem("push_subscription"),await this.removeSubscriptionFromServer(),xe.trackEvent("push_notification_unsubscribed"),se.info("Push notification unsubscribed successfully")),e}catch(e){return ee.logError("PushNotificationService.unsubscribe",e),xe.reportError(e,"push_unsubscription_error"),!1}}async showLocalNotification(e){if(!this.permissionState.supported||"granted"!==this.permissionState.permission)throw new Error("Notifications not available");try{const t={body:e.body,icon:e.icon||"/logo.png",badge:e.badge||"/logo.png",tag:e.tag,data:e.data,requireInteraction:e.requireInteraction||!1,silent:e.silent||!1},a=new Notification(e.title,t);a.onclick=()=>{xe.trackEvent("local_notification_clicked",{tag:e.tag,title:e.title}),a.close()},a.onclose=()=>{xe.trackEvent("local_notification_closed",{tag:e.tag,title:e.title})},xe.trackEvent("local_notification_shown",{tag:e.tag,title:e.title})}catch(t){throw se.error("Failed to show local notification","PushNotificationService.showLocalNotification",t),xe.reportError(t,"local_notification_error",{title:e.title}),t}}urlBase64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(t),n=new Uint8Array(a.length);for(let i=0;i<a.length;++i)n[i]=a.charCodeAt(i);return n}arrayBufferToBase64(e){const t=new Uint8Array(e);let a="";for(let n=0;n<t.byteLength;n++)a+=String.fromCharCode(t[n]);return window.btoa(a)}getAuthToken(){return localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")||""}getNotificationPreferences(){const e=localStorage.getItem("notification_preferences");if(e)try{return JSON.parse(e)}catch(t){se.warn("Failed to parse notification preferences:","pushNotificationService.getNotificationPreferences",t)}return{priceAlerts:!0,auctionUpdates:!0,newListings:!1,marketTrends:!1,systemNotifications:!0}}async validateSubscription(){if(!this.pushSubscription)return!1;try{const e={endpoint:this.pushSubscription.endpoint,keys:{p256dh:this.arrayBufferToBase64(this.pushSubscription.getKey("p256dh")),auth:this.arrayBufferToBase64(this.pushSubscription.getKey("auth"))}},t=await fetch("/api/push/validate-subscription",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({subscription:e})});if(!t.ok)throw new Error(`Validation failed: ${t.status} ${t.statusText}`);return!0===(await t.json()).valid}catch(e){return se.warn("Subscription validation failed:","pushNotificationService.validateSubscription",e),!1}}async sendSubscriptionToServer(e){try{const t=await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({...e,userAgent:navigator.userAgent,timestamp:Date.now(),preferences:this.getNotificationPreferences()})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(`Failed to save subscription: ${t.status} ${t.statusText} - ${e.message||"Unknown error"}`)}const a=await t.json();se.info("Subscription successfully saved to server:",a.subscriptionId),localStorage.setItem("push_subscription_id",a.subscriptionId)}catch(t){throw se.error("Failed to send subscription to server:","pushNotificationService.sendSubscriptionToServer",t,{endpoint:e.endpoint,userId:e.userId}),t}}async removeSubscriptionFromServer(){try{const e=localStorage.getItem("push_subscription_id"),t=localStorage.getItem("push_subscription");if(!e&&!t)return void se.info("No subscription to remove from server");const a=await fetch("/api/push/unsubscribe",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({subscriptionId:e,endpoint:this.pushSubscription?.endpoint,timestamp:Date.now()})});if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(`Failed to remove subscription: ${a.status} ${a.statusText} - ${e.message||"Unknown error"}`)}localStorage.removeItem("push_subscription_id"),se.info("Subscription successfully removed from server")}catch(e){se.error("Failed to remove subscription from server:","pushNotificationService.removeSubscriptionFromServer",e)}}getPermissionState(){return{...this.permissionState}}isSubscribed(){return this.permissionState.subscribed}getSubscription(){return this.pushSubscription}setVapidKey(e){this.vapidPublicKey=e}async testNotification(){await this.showLocalNotification({title:"PxMarket Test Notification",body:"Push notifications are working correctly!",tag:"test-notification",data:{test:!0}})}async sendPriceAlert(e,t,a){await this.showLocalNotification({title:"Price Alert",body:`${e} is now ${t} (target: ${a})`,tag:"price-alert",icon:"/logo.png",requireInteraction:!0,data:{type:"price_alert",assetName:e,currentPrice:t,targetPrice:a}})}async sendTransactionNotification(e,t,a){await this.showLocalNotification({title:"success"===e?"Transaction Successful":"Transaction Failed",body:t,tag:`transaction-${e}`,icon:"/logo.png",data:{type:"transaction",status:e,transactionId:a}})}},Xe=new class{constructor(){t(this,"watchlist",[]),t(this,"priceAlerts",{}),t(this,"notifications",{browser:!0,email:!1,sound:!0}),t(this,"listeners",[]),t(this,"priceCheckInterval",null),t(this,"STORAGE_KEY","pixeljourney_watchlist"),t(this,"ALERTS_KEY","pixeljourney_price_alerts"),t(this,"NOTIFICATIONS_KEY","pixeljourney_notifications"),t(this,"priceCache",{}),t(this,"CACHE_DURATION",12e4),t(this,"endpointFailures",{}),t(this,"MAX_FAILURES",3),t(this,"FAILURE_WINDOW",3e5),t(this,"DISABLE_DURATION",9e5),this.loadFromStorage(),this.startPriceMonitoring(),this.requestNotificationPermission()}loadFromStorage(){try{this.watchlist=ge.getJSON(this.STORAGE_KEY,[]),this.priceAlerts=ge.getJSON(this.ALERTS_KEY,{}),this.notifications=ge.getJSON(this.NOTIFICATIONS_KEY,{browser:!0,email:!1,sound:!0})}catch(e){ee.logError("WatchlistService.loadFromStorage",e,{storageKeys:[this.STORAGE_KEY,this.ALERTS_KEY,this.NOTIFICATIONS_KEY]})}}saveToStorage(){try{ge.setJSON(this.STORAGE_KEY,this.watchlist)&&ge.setJSON(this.ALERTS_KEY,this.priceAlerts)&&ge.setJSON(this.NOTIFICATIONS_KEY,this.notifications)||ee.logError("WatchlistService.saveToStorage",new Error("Failed to save to storage"),{watchlistSize:this.watchlist.length,alertsCount:Object.keys(this.priceAlerts).length}),this.notifyListeners()}catch(e){ee.logError("WatchlistService.saveToStorage",e,{watchlistSize:this.watchlist.length,alertsCount:Object.keys(this.priceAlerts).length})}}async requestNotificationPermission(){"Notification"in window&&"default"===Notification.permission&&await Notification.requestPermission()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.listeners.forEach(e=>e([...this.watchlist]))}async addToWatchlist(e){if(-1!==this.watchlist.findIndex(t=>t.nft.asset_id===e.asset_id))return!1;const t={nft:e,alertType:"any",addedAt:Date.now(),lastPrice:e.price?parseFloat(e.price):0};return this.watchlist.push(t),this.saveToStorage(),this.notifyListeners(),!0}async removeFromWatchlist(e){this.watchlist=this.watchlist.filter(t=>t.nft.asset_id!==e),delete this.priceAlerts[e],this.saveToStorage(),this.notifyListeners()}async getWatchlist(){return[...this.watchlist]}isInWatchlist(e){return this.watchlist.some(t=>t.nft.asset_id===e)}async setPriceAlert(e,t){this.priceAlerts[e]={...t,lastTriggered:void 0},this.saveToStorage()}async removePriceAlert(e){delete this.priceAlerts[e],this.saveToStorage()}getPriceAlert(e){return this.priceAlerts[e]}updateNotificationSettings(e){this.notifications={...this.notifications,...e},this.saveToStorage()}getNotificationSettings(){return{...this.notifications}}isEndpointDisabled(e){const t=this.endpointFailures[e];return!(!t||!t.disabled||Date.now()-t.lastFailure>this.DISABLE_DURATION&&(t.disabled=!1,t.count=0,1))}recordEndpointFailure(e){const t=Date.now(),a=this.endpointFailures[e]||{count:0,lastFailure:0,disabled:!1};t-a.lastFailure>this.FAILURE_WINDOW&&(a.count=0),a.count++,a.lastFailure=t,a.count>=this.MAX_FAILURES&&(a.disabled=!0,se.warn(`Endpoint ${e} disabled due to ${a.count} failures`,"WatchlistService.recordEndpointFailure")),this.endpointFailures[e]=a}recordEndpointSuccess(e){const t=this.endpointFailures[e];t&&(t.count=0,t.disabled=!1)}notifyEndpointsDisabled(){const e=localStorage.getItem("watchlist_endpoints_disabled_notification"),t=Date.now();e&&t-parseInt(e)<9e5||(localStorage.setItem("watchlist_endpoints_disabled_notification",t.toString()),window.dispatchEvent(new CustomEvent("watchlistEndpointsDisabled",{detail:{message:"Price monitoring temporarily disabled due to API issues. Will retry automatically.",disabledEndpoints:Object.keys(this.endpointFailures).filter(e=>this.endpointFailures[e].disabled),retryTime:Math.max(...Object.values(this.endpointFailures).map(e=>e.lastFailure+this.DISABLE_DURATION))}})))}getEndpointStatus(){const e={};for(const[t,a]of Object.entries(this.endpointFailures))e[t]={healthy:!a.disabled,failures:a.count,disabledUntil:a.disabled?a.lastFailure+this.DISABLE_DURATION:void 0};return e}startPriceMonitoring(){this.priceCheckInterval=setInterval(()=>{this.checkPriceAlerts()},18e4),setTimeout(()=>{this.checkPriceAlerts()},6e4)}stopPriceMonitoring(){this.priceCheckInterval&&(clearInterval(this.priceCheckInterval),this.priceCheckInterval=null)}async checkPriceAlerts(){if(0!==this.watchlist.length){if(["atomichub","neftyblocks"].every(e=>this.isEndpointDisabled(e)))return se.warn("All price endpoints are disabled, skipping price check","WatchlistService.checkPrices"),void this.notifyEndpointsDisabled();try{const e=Object.values(this.endpointFailures).filter(e=>e.disabled).length,t=e>0?2:3,a=[];for(let n=0;n<this.watchlist.length;n+=t)a.push(this.watchlist.slice(n,n+t));for(let n=0;n<a.length;n++){const t=a[n];n>0&&await new Promise(e=>setTimeout(e,2e3));const i=t.map(async e=>{try{const t=await this.fetchCurrentPrice(e),a=e.lastPrice>0?(t-e.lastPrice)/e.lastPrice*100:0;e.lastPrice=t,e.priceChange=a;const n=this.priceAlerts[e.nft.asset_id];return n&&n.enabled&&t>0&&await this.checkAlertCondition(e,n,t),e}catch(t){return ee.logError("WatchlistService.checkPriceAlerts.priceCheck",t,{assetId:e.nft.asset_id,nftName:e.nft.name}),e}});if(await Promise.allSettled(i),a.indexOf(t)<a.length-1){const t=e>0?2e3:1e3;await new Promise(e=>setTimeout(e,t))}}this.saveToStorage()}catch(e){ee.logError("WatchlistService.checkPriceAlerts",e,{watchlistSize:this.watchlist.length,disabledEndpoints:Object.keys(this.endpointFailures).filter(e=>this.endpointFailures[e].disabled)})}}}async fetchCurrentPrice(e){const t=e.nft.asset_id,a=Date.now(),n=this.priceCache[t];if(n&&a-n.timestamp<this.CACHE_DURATION)return n.price;const i=await this.getCurrentPrice(t);return this.priceCache[t]={price:i,timestamp:a},i}async getCurrentPrice(e){try{const a=["atomichub","neftyblocks"];for(const n of a)if(!this.isEndpointDisabled(n))try{let t=0;switch(n){case"atomichub":t=await this.fetchAtomicHubPrice(e);break;case"neftyblocks":t=await this.fetchNeftyBlocksPrice(e)}if(t>0)return this.recordEndpointSuccess(n),t}catch(t){this.recordEndpointFailure(n),se.warn(`Failed to fetch price from ${n}:`,"WatchlistService.getCurrentPrice",{endpoint:n,error:t})}return se.warn("All price endpoints failed, using template floor price fallback","WatchlistService.getCurrentPrice"),await this.fetchTemplateFloorPrice(e)}catch(t){ee.logError("WatchlistService.getCurrentPrice",t,{assetId:e});const a=this.watchlist.find(t=>t.nft.asset_id===e);return a?.lastPrice||0}}async fetchAtomicHubPrice(e){const t="atomichub";try{const{apiService:a}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),n=`${a.atomicMarketAPI}/atomicmarket/v1/sales?state=1&asset_id=${e}&limit=1`,i=await a.fetchWithRetry(n),r=await i.json();if(r.success&&r.data&&r.data.length>0){const e=r.data[0];if(e.price&&e.price.amount)return this.recordEndpointSuccess(t),parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}return 0}catch(a){return this.recordEndpointFailure(t),ee.logError("WatchlistService.fetchAtomicHubPrice",a,{assetId:e,endpoint:t,failureCount:this.endpointFailures[t]?.count||0}),0}}async fetchNeftyBlocksPrice(e){const t="neftyblocks";try{const{apiService:a}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),n=`https://aa-wax-public1.neftyblocks.com/atomicmarket/v1/sales?state=1&asset_id=${e}&limit=1`,i=await a.fetchWithRetry(n),r=await i.json();if(r.success&&r.data&&r.data.length>0){const e=r.data[0];if(e.price&&e.price.amount)return this.recordEndpointSuccess(t),parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}return 0}catch(a){return this.recordEndpointFailure(t),ee.logError("WatchlistService.fetchNeftyBlocksPrice",a,{assetId:e,endpoint:t,failureCount:this.endpointFailures[t]?.count||0}),0}}async fetchTemplateFloorPrice(e){try{const{apiService:t}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),a=`${t.atomicAssetsAPI}/atomicassets/v1/assets/${e}`,n=await t.fetchWithRetry(a),i=await n.json();if(i.success&&i.data&&i.data.template){const e=i.data.template.template_id,a=`${t.atomicMarketAPI}/atomicmarket/v1/sales?state=1&template_id=${e}&sort=price&order=asc&limit=1`,n=await t.fetchWithRetry(a),r=await n.json();if(r.success&&r.data&&r.data.length>0){const e=r.data[0];if(e.price&&e.price.amount)return parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}}return 0}catch{return 0}}async checkAlertCondition(e,t,a){const n=Date.now();if(t.lastTriggered&&n-t.lastTriggered<36e5)return;let i=!1,r="";switch(t.alertType){case"below":a<=t.targetPrice&&(i=!0,r=`${e.nft.name} price dropped to ${a.toFixed(2)} WAX (target: ${t.targetPrice} WAX)`);break;case"above":a>=t.targetPrice&&(i=!0,r=`${e.nft.name} price rose to ${a.toFixed(2)} WAX (target: ${t.targetPrice} WAX)`);break;case"any":{const t=Math.abs(e.priceChange||0);if(t>=5){i=!0;const n=(e.priceChange||0)>0?"increased":"decreased";r=`${e.nft.name} price ${n} by ${t.toFixed(1)}% to ${a.toFixed(2)} WAX`}break}}i&&(await this.triggerAlert(e,r),t.lastTriggered=n)}async triggerAlert(e,t){this.notifications.browser&&"Notification"in window&&"granted"===Notification.permission&&new Notification("Price Alert - Pixel Journey",{body:t,icon:e.nft.image||"/logo.png",tag:`price-alert-${e.nft.asset_id}`,requireInteraction:!0}),this.notifications.sound&&this.playNotificationSound();try{await Ue.sendPriceAlert(e.nft.name,`${e.lastPrice} WAX`,t)}catch(a){se.warn("Failed to send push notification for price alert:","WatchlistService.sendPriceAlert",{error:a})}window.dispatchEvent(new CustomEvent("priceAlert",{detail:{item:e,message:t}}))}playNotificationSound(){try{const e=new Audio("/notification.mp3");e.volume=.3,e.play().catch(e=>{se.debug("Could not play notification sound:","WatchlistService.playNotificationSound",{error:e})})}catch(e){se.debug("Notification sound not available:","WatchlistService.playNotificationSound",{error:e})}}getWatchlistStats(){const e=this.watchlist.length,t=Object.keys(this.priceAlerts).filter(e=>this.priceAlerts[e].enabled).length,a=this.watchlist.map(e=>e.priceChange||0).filter(e=>0!==e);return{totalItems:e,activeAlerts:t,averagePriceChange:a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0}}clearWatchlist(){this.watchlist=[],this.priceAlerts={},this.saveToStorage()}subscribe(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}exportWatchlist(){return JSON.stringify({watchlist:this.watchlist,priceAlerts:this.priceAlerts,exportedAt:Date.now()},null,2)}importWatchlist(e){try{const t=JSON.parse(e);return!(!t.watchlist||!Array.isArray(t.watchlist)||(this.watchlist=t.watchlist,this.priceAlerts=t.priceAlerts||{},this.saveToStorage(),0))}catch(t){return ee.logError("WatchlistService.importWatchlist",t,{dataLength:e.length}),!1}}};function ze(e,t){var a;void 0===t&&(t="0");var n=0,i=-1;"-"==e[0]&&(Ge(e=e.substring(1))||(n++,i=1,e.length)),"-"==t[0]&&(Ge(t=t.substring(1))||(n++,i=2,t.length)),e=Je(e),t=Je(t),e=(a=qe(Je(e),Je(t)))[0],t=a[1],1==n&&(1===i?e=He(e):2===i&&(t=He(t)));var r=Ve(e,t);return n?2==n?"-"+Je(r):e.length<r.length?Je(r.substring(1)):"-"+Je(He(r)):Je(r)}function He(e){if(Ge(e))return e;for(var t="",a=e.length,n=e.split(".")[1],i=n?n.length:0,r=0;r<a;r++)e[r]>="0"&&e[r]<="9"?t+=9-parseInt(e[r]):t+=e[r];return Ve(t,i>0?"0."+new Array(i).join("0")+"1":"1")}function Je(e){var t=e.split(".");for(t[0]||(t[0]="0");"0"==t[0][0]&&t[0].length>1;)t[0]=t[0].substring(1);return t[0]+(t[1]?"."+t[1]:"")}function qe(e,t){var a=e.split("."),n=t.split("."),i=a[0].length,r=n[0].length;return i>r?n[0]=new Array(Math.abs(i-r)+1).join("0")+(n[0]?n[0]:""):a[0]=new Array(Math.abs(i-r)+1).join("0")+(a[0]?a[0]:""),i=a[1]?a[1].length:0,r=n[1]?n[1].length:0,(i||r)&&(i>r?n[1]=(n[1]?n[1]:"")+new Array(Math.abs(i-r)+1).join("0"):a[1]=(a[1]?a[1]:"")+new Array(Math.abs(i-r)+1).join("0")),[e=a[0]+(a[1]?"."+a[1]:""),t=n[0]+(n[1]?"."+n[1]:"")]}function Ve(e,t){var a;e=(a=qe(e,t))[0],t=a[1];for(var n="",i=0,r=e.length-1;r>=0;r--)if("."!==e[r]){var s=parseInt(e[r])+parseInt(t[r])+i;n=s%10+n,i=Math.floor(s/10)}else n="."+n;return i?i.toString()+n:n}function Ge(e){return/^0[0]*[.]{0,1}[0]*$/.test(e)}function Ye(e){return"number"!=typeof e&&"bigint"!=typeof e||(e=e.toString()),"-"==e[0]?e.substring(1):e}var Ke,Qe;function Ze(e,t,a){if(void 0===t&&(t=0),void 0===a&&(a=Ke.HALF_EVEN),a===Ke.UNNECESSARY)throw new Error("UNNECESSARY Rounding Mode has not yet been implemented");"number"!=typeof e&&"bigint"!=typeof e||(e=e.toString());var n=!1;"-"===e[0]&&(n=!0,e=e.substring(1));var i=e.split("."),r=i[0],s=i[1];if(t<0){if(t=-t,r.length<=t)return"0";var l=r.substr(0,r.length-t);return(n?"-":"")+(l=Ze(e=l+"."+r.substr(r.length-t)+s,0,a))+new Array(t+1).join("0")}if(0==t)return r.length,et(i[1],r,n,a)&&(r=tt(r)),(n&&parseInt(r)?"-":"")+r;if(!i[1])return(n?"-":"")+r+"."+new Array(t+1).join("0");if(i[1].length<t)return(n?"-":"")+r+"."+i[1]+new Array(t-i[1].length+1).join("0");s=i[1].substring(0,t);var c=i[1].substring(t);return c&&et(c,s,n,a)&&(s=tt(s)).length>t?(n?"-":"")+tt(r,parseInt(s[0]))+"."+s.substring(1):(n&&(parseInt(r)||parseInt(s))?"-":"")+r+"."+s}function et(e,t,a,n){if(!e||e===new Array(e.length+1).join("0"))return!1;if(n===Ke.DOWN||!a&&n===Ke.FLOOR||a&&n===Ke.CEILING)return!1;if(n===Ke.UP||a&&n===Ke.FLOOR||!a&&n===Ke.CEILING)return!0;var i="5"+new Array(e.length).join("0");if(e>i)return!0;if(e<i)return!1;switch(n){case Ke.HALF_DOWN:return!1;case Ke.HALF_UP:return!0;case Ke.HALF_EVEN:default:return parseInt(t[t.length-1])%2==1}}function tt(e,t){void 0===t&&(t=0),t||(t=1),"number"==typeof e&&e.toString();for(var a="",n=e.length-1;n>=0;n--){var i=parseInt(e[n])+t;10==i?(t=1,i=0):t=0,a+=i}return t&&(a+=t),a.split("").reverse().join("")}function at(e){var t="-"===e[0];for(t&&(e=e.substr(1));"0"==e[0];)e=e.substr(1);if(-1!=e.indexOf("."))for(;"0"==e[e.length-1];)e=e.substr(0,e.length-1);return""==e||"."==e?e="0":"."==e[e.length-1]&&(e=e.substr(0,e.length-1)),"."==e[0]&&(e="0"+e),t&&"0"!=e&&(e="-"+e),e}function nt(e,t){e=e.toString(),t=t.toString();var a=0;"-"==e[0]&&(a++,e=e.substr(1)),"-"==t[0]&&(a++,t=t.substr(1)),e=at(e),t=at(t);var n=0,i=0;-1!=e.indexOf(".")&&(n=e.length-e.indexOf(".")-1),-1!=t.indexOf(".")&&(i=t.length-t.indexOf(".")-1);var r=n+i;if(e=at(e.replace(".","")),t=at(t.replace(".","")),e.length<t.length){var s=e;e=t,t=s}if("0"==t)return"0";for(var l,c,o=t.length,d=0,h=[],u=o-1,m="",p=0;p<o;p++)h[p]=e.length-1;for(p=0;p<2*e.length;p++){for(var f=0,v=t.length-1;v>=u&&v>=0;v--)h[v]>-1&&h[v]<e.length&&(f+=parseInt(e[h[v]--])*parseInt(t[v]));f+=d,d=Math.floor(f/10),m=f%10+m,u--}return m=at((l=m,0==(c=r)?l:(l=c>=l.length?new Array(c-l.length+1).join("0")+l:l).substr(0,l.length-c)+"."+l.substr(l.length-c,c))),1==a&&(m="-"+m),m}function it(e,t,a,n){if(void 0===a&&(a=8),void 0===n&&(n=Ke.HALF_EVEN),0==t)throw new Error("Cannot divide by 0");if(e=e.toString(),t=t.toString(),e=e.replace(/(\.\d*?[1-9])0+$/g,"$1").replace(/\.0+$/,""),t=t.replace(/(\.\d*?[1-9])0+$/g,"$1").replace(/\.0+$/,""),0==e)return"0";var i=0;"-"==t[0]&&(t=t.substring(1),i++),"-"==e[0]&&(e=e.substring(1),i++);var r=t.indexOf(".")>0?t.length-t.indexOf(".")-1:-1;if(t=Je(t.replace(".","")),r>=0){var s=e.indexOf(".")>0?e.length-e.indexOf(".")-1:-1;if(-1==s)e=Je(e+new Array(r+1).join("0"));else if(r>s)e=Je((e=e.replace(".",""))+new Array(r-s+1).join("0"));else if(r<s){var l=(e=e.replace(".","")).length-s+r;e=Je(e.substring(0,l)+"."+e.substring(l))}else r==s&&(e=Je(e.replace(".","")))}var c=0,o=t.length,d="",h=e.indexOf(".")>-1&&e.indexOf(".")<o?e.substring(0,o+1):e.substring(0,o);if(e=e.indexOf(".")>-1&&e.indexOf(".")<o?e.substring(o+1):e.substring(o),h.indexOf(".")>-1){var u=h.length-h.indexOf(".")-1;o>(h=h.replace(".","")).length&&(u+=o-h.length,h+=new Array(o-h.length+1).join("0")),c=u,d="0."+new Array(u).join("0")}for(a+=2;c<=a;){for(var m=0;parseInt(h)>=parseInt(t);)h=ze(h,"-"+t),m++;d+=m,e?("."==e[0]&&(d+=".",c++,e=e.substring(1)),h+=e.substring(0,1),e=e.substring(1)):(c||(d+="."),c++,h+="0")}return(1==i?"-":"")+Je(Ze(d,a-2,n))}function rt(e,t){return ze(e=e.toString(),t=st(t=t.toString()))}function st(e){return"-"==e[0]?e.substr(1):"-"+e}function lt(e,t){if(0==t)throw new Error("Cannot divide by 0");e=e.toString(),t=t.toString(),ct(e),ct(t);var a="";return"-"==e[0]&&(a="-",e=e.substr(1)),"-"==t[0]&&(t=t.substr(1)),a+rt(e,nt(t,Ze(it(e,t),0,Ke.FLOOR)))}function ct(e){if(-1!=e.indexOf("."))throw new Error("Modulus of non-integers not supported")}function ot(e,t){var a,n,i=!1;if(a=[e,t].map(function(e){return at(e)}),e=a[0],t=a[1],"-"==e[0]&&"-"!=t[0])return-1;if("-"!=e[0]&&"-"==t[0])return 1;if("-"==e[0]&&"-"==t[0]&&(e=e.substr(1),t=t.substr(1),i=!0),e=(n=qe(e,t))[0],t=n[1],0==e.localeCompare(t))return 0;for(var r=0;r<e.length;r++)if(e[r]!=t[r])return e[r]>t[r]?i?-1:1:i?1:-1;return 0}(Qe=Ke||(Ke={}))[Qe.CEILING=0]="CEILING",Qe[Qe.DOWN=1]="DOWN",Qe[Qe.FLOOR=2]="FLOOR",Qe[Qe.HALF_DOWN=3]="HALF_DOWN",Qe[Qe.HALF_EVEN=4]="HALF_EVEN",Qe[Qe.HALF_UP=5]="HALF_UP",Qe[Qe.UNNECESSARY=6]="UNNECESSARY",Qe[Qe.UP=7]="UP";var dt=function(){function e(t){void 0===t&&(t="0"),this.value=e.validate(t)}return e.validate=function(e){if(e){if(e=e.toString(),isNaN(e))throw Error("Parameter is not a number: "+e);"+"==e[0]&&(e=e.substring(1))}else e="0";if(e.startsWith(".")?e="0"+e:e.startsWith("-.")&&(e="-0"+e.substr(1)),/e/i.test(e)){var t=e.split(/[eE]/),a=t[0],n=t[1],i="";"-"==(a=Je(a))[0]&&(i="-",a=a.substring(1)),a.indexOf(".")>=0?(n=parseInt(n)+a.indexOf("."),a=a.replace(".","")):n=parseInt(n)+a.length,e=a.length<n?i+a+new Array(n-a.length+1).join("0"):a.length>=n&&n>0?i+Je(a.substring(0,n))+(a.length>n?"."+a.substring(n):""):i+"0."+new Array(1-n).join("0")+a}return e},e.prototype.getValue=function(){return this.value},e.prototype.setValue=function(t){this.value=e.validate(t)},e.getPrettyValue=function(t,a,n){void 0===a&&(a=3),void 0===n&&(n=",");var i="-"==(t=e.validate(t)).charAt(0);i&&(t=t.substring(1));for(var r=t.indexOf("."),s="",l=r=r>0?r:t.length;l>0;)l<a?(a=l,l=0):l-=a,s=t.substring(l,l+a)+(l<r-a&&l>=0?n:"")+s;return(i?"-":"")+s+t.substring(r)},e.prototype.getPrettyValue=function(t,a){return void 0===t&&(t=3),void 0===a&&(a=","),e.getPrettyValue(this.value,t,a)},e.round=function(t,a,n){if(void 0===a&&(a=0),void 0===n&&(n=Ke.HALF_EVEN),t=e.validate(t),isNaN(a))throw Error("Precision is not a number: "+a);return Ze(t,a,n)},e.prototype.round=function(t,a){if(void 0===t&&(t=0),void 0===a&&(a=Ke.HALF_EVEN),isNaN(t))throw Error("Precision is not a number: "+t);return new e(Ze(this.value,t,a))},e.abs=function(t){return Ye(t=e.validate(t))},e.prototype.abs=function(){return new e(Ye(this.value))},e.floor=function(t){return-1===(t=e.validate(t)).indexOf(".")?t:e.round(t,0,Ke.FLOOR)},e.prototype.floor=function(){return-1===this.value.indexOf(".")?new e(this.value):new e(this.value).round(0,Ke.FLOOR)},e.ceil=function(t){return-1===(t=e.validate(t)).indexOf(".")?t:e.round(t,0,Ke.CEILING)},e.prototype.ceil=function(){return-1===this.value.indexOf(".")?new e(this.value):new e(this.value).round(0,Ke.CEILING)},e.add=function(t,a){return ze(t=e.validate(t),a=e.validate(a))},e.prototype.add=function(t){return new e(ze(this.value,t.getValue()))},e.subtract=function(t,a){return rt(t=e.validate(t),a=e.validate(a))},e.prototype.subtract=function(t){return new e(rt(this.value,t.getValue()))},e.multiply=function(t,a){return nt(t=e.validate(t),a=e.validate(a))},e.prototype.multiply=function(t){return new e(nt(this.value,t.getValue()))},e.divide=function(t,a,n,i){return it(t=e.validate(t),a=e.validate(a),n,i)},e.prototype.divide=function(t,a,n){return new e(it(this.value,t.getValue(),a,n))},e.modulus=function(t,a){return lt(t=e.validate(t),a=e.validate(a))},e.prototype.modulus=function(t){return new e(lt(this.value,t.getValue()))},e.compareTo=function(t,a){return ot(t=e.validate(t),a=e.validate(a))},e.prototype.compareTo=function(e){return ot(this.value,e.getValue())},e.negate=function(t){return st(t=e.validate(t))},e.prototype.negate=function(){return new e(st(this.value))},e.stripTrailingZero=function(t){return at(t=e.validate(t))},e.prototype.stripTrailingZero=function(){return new e(at(this.value))},e.RoundingModes=Ke,e}();class ht extends x{constructor(){super(...arguments),this.default_block_cpu_limit=S.from(2e5),this.default_block_net_limit=S.from(1048576e3)}get allocated(){return 1-Number(this.weight_ratio.dividing(this.target_weight_ratio))/100}get reserved(){return this.utilization.dividing(this.weight)}get symbol(){return this.min_price.symbol}utilization_increase(e){const t=At(e),a=At(this.weight),n=At(Math.pow(10,15));return w.from(t.multiply(a).divide(n,15).ceil().getValue())}price_function(e){const{weight:t}=this;let a=this.min_price.value;const n=Number(this.exponent)-1;if(n<=0)return this.max_price.value;{const i=At(e).divide(At(t),18);a+=(this.max_price.value-this.min_price.value)*Math.pow(Number(i.getValue()),n)}return a}price_integral_delta(e,t){const a=C.fromUnits(this.max_price.units.subtracting(this.min_price.units),this.symbol).value/this.exponent.value,n=Number(e.dividing(this.weight)),i=Number(t.dividing(this.weight));return this.min_price.value*i-this.min_price.value*n+a*Math.pow(i,this.exponent.value)-a*Math.pow(n,this.exponent.value)}fee(e,t){const{utilization:a,weight:n}=this;let i=A.from(a);const r=i.adding(e);let s=0;if(i.lt(t)){const a=Math.min(Number(e),Number(t.subtracting(i)));s+=Number(At(this.price_function(t)*a).divide(At(n)).getValue()),i=t}return i.lt(r)&&(s+=this.price_integral_delta(i,r)),s}determine_adjusted_utilization(e){const{decay_secs:t,utilization:a,utilization_timestamp:n}=this;let{adjusted_utilization:i}=this;if(a.lt(i)){const r=e&&e.timestamp?e.timestamp:new Date,s=P.from(r).toMilliseconds()/1e3,l=i.subtracting(a).toNumber();let c=l*Math.exp(-(s-n.toMilliseconds())/Number(t));c=Math.min(Math.max(c,0),l),i=a.adding(c)}return i}}_([x.field("uint8")],ht.prototype,"version",void 0),_([x.field("int64")],ht.prototype,"weight",void 0),_([x.field("int64")],ht.prototype,"weight_ratio",void 0),_([x.field("int64")],ht.prototype,"assumed_stake_weight",void 0),_([x.field("int64")],ht.prototype,"initial_weight_ratio",void 0),_([x.field("int64")],ht.prototype,"target_weight_ratio",void 0),_([x.field("time_point_sec")],ht.prototype,"initial_timestamp",void 0),_([x.field("time_point_sec")],ht.prototype,"target_timestamp",void 0),_([x.field("float64")],ht.prototype,"exponent",void 0),_([x.field("uint32")],ht.prototype,"decay_secs",void 0),_([x.field("asset")],ht.prototype,"min_price",void 0),_([x.field("asset")],ht.prototype,"max_price",void 0),_([x.field("int64")],ht.prototype,"utilization",void 0),_([x.field("int64")],ht.prototype,"adjusted_utilization",void 0),_([x.field("time_point_sec")],ht.prototype,"utilization_timestamp",void 0);let ut=class extends ht{constructor(){super(...arguments),this.per_day=e=>this.us_per_day(e),this.frac=(e,t)=>this.frac_by_us(e,t),this.frac_by_ms=(e,t)=>this.frac_by_us(e,1e3*t),this.price_per=(e,t=1e3,a)=>this.price_per_us(e,t,a),this.price_per_ms=(e,t=1,a)=>this.price_per_us(e,1e3*t,a)}ms_per_day(e){return this.us_per_day(e)/1e3}us_per_day(e){const t=e&&e.virtual_block_cpu_limit?e.virtual_block_cpu_limit:this.default_block_cpu_limit;return 2*Number(t)*60*60*24}weight_to_us(e,t){return w.from(w.from(t).multiplying(A.from(e)).dividing(kt,"ceil"))}us_to_weight(e,t){return A.from(t).multiplying(kt).dividing(e,"floor")}frac_by_us(e,t){const a=At(this.us_to_weight(e.cpu,t)),n=At(this.weight),i=At(Math.pow(10,15)),r=a.divide(n,15).multiply(i);return A.from(r.getValue())}price_per_us(e,t=1e3,a){const n=w.from(this.frac(e,t)),i=this.utilization_increase(n),r=this.determine_adjusted_utilization(a),s=this.fee(i,r),l=Math.pow(10,this.max_price.symbol.precision),c=s*l,o=Math.ceil(c)/l,d=C.fromFloat(s,this.symbol);if(c<1)throw new Error(`Price (${String(d)}) for requested CPU amount (${t}us) below required precision, increase requested amount.`);if(a&&a.min_payment&&a.min_payment.units.gt(d.units))throw new Error(`Price (${String(d)}) for requested CPU amount (${t}us) below minimum required payment (${String(a.min_payment)}), increase requested CPU amount.`);return o}};ut=_([x.type("powerupstateresourcecpu")],ut);let mt=class extends ht{constructor(){super(...arguments),this.per_day=e=>this.bytes_per_day(e),this.frac=(e,t)=>this.frac_by_bytes(e,t),this.frac_by_kb=(e,t)=>this.frac_by_bytes(e,1e3*t),this.price_per=(e,t=1e3,a)=>this.price_per_byte(e,t,a),this.price_per_kb=(e,t=1,a)=>this.price_per_byte(e,1e3*t,a)}kb_per_day(e){return this.bytes_per_day(e)/1e3}bytes_per_day(e){const t=e&&e.virtual_block_net_limit?e.virtual_block_net_limit:this.default_block_net_limit;return 2*Number(t)*60*60*24}weight_to_bytes(e,t){return w.from(w.from(t).multiplying(A.from(e)).dividing(kt,"ceil"))}bytes_to_weight(e,t){return A.from(t).multiplying(kt).dividing(A.from(e),"floor")}frac_by_bytes(e,t){const a=At(this.bytes_to_weight(e.net,t)),n=At(this.weight),i=At(Math.pow(10,15)),r=a.divide(n,15).multiply(i);return A.from(r.getValue())}price_per_byte(e,t=1e3,a){const n=w.from(this.frac(e,t)),i=this.utilization_increase(n),r=this.determine_adjusted_utilization(a),s=this.fee(i,r),l=Math.pow(10,this.max_price.symbol.precision);return Math.ceil(s*l)/l}};mt=_([x.type("powerupstateresourcenet")],mt);let pt=class extends x{};_([x.field("uint8")],pt.prototype,"version",void 0),_([x.field(mt)],pt.prototype,"net",void 0),_([x.field(ut)],pt.prototype,"cpu",void 0),_([x.field("uint32")],pt.prototype,"powerup_days",void 0),_([x.field("asset")],pt.prototype,"min_powerup_fee",void 0),pt=_([x.type("powerupstate")],pt);class ft{constructor(e){this.parent=e}async get_state(){return(await this.parent.api.v1.chain.get_table_rows({code:"eosio",scope:"",table:"powup.state",type:pt})).rows[0]}}let vt=class extends x{};_([x.field("asset")],vt.prototype,"balance",void 0),_([x.field("float64")],vt.prototype,"weight",void 0),vt=_([x.type("connector")],vt);let yt=class extends x{};_([x.field("asset")],yt.prototype,"supply",void 0),_([x.field(vt)],yt.prototype,"base",void 0),_([x.field(vt)],yt.prototype,"quote",void 0),yt=_([x.type("exchange_state")],yt);let gt=class extends yt{price_per(e){const t=this.base.balance.units,a=this.quote.balance.units;return C.fromUnits(this.get_input(t,a,A.from(e)),this.quote.balance.symbol)}price_per_kb(e){return this.price_per(1e3*e)}get_input(e,t,a){return t.multiplying(a).dividing(e.subtracting(a),"ceil")}};gt=_([x.type("ramstate")],gt);class bt{constructor(e){this.parent=e}async get_state(){return(await this.parent.api.v1.chain.get_table_rows({code:"eosio",scope:"eosio",table:"rammarket",type:gt})).rows[0]}}let Nt=class extends x{get reserved(){return Number(this.total_lent.units)/Number(this.total_lendable.units)}get symbol(){return this.total_lent.symbol}get precision(){return this.total_lent.symbol.precision}get value(){const e=At(this.total_lent.units),t=At(this.total_unlent.units),a=At(this.total_rex.units);return Number(e.add(t).divide(a,18).getValue())}exchange(e){const t=At(e.units),a=At(this.total_lendable.units),n=At(this.total_rex.units),i=t.multiply(a).divide(n,this.precision);return C.fromUnits(Number(i.getValue()),this.symbol)}cpu_price_per_ms(e,t=1){return this.cpu_price_per_us(e,1e3*t)}cpu_price_per_us(e,t=1e3){return this.price_per(e,t,e.cpu)}net_price_per_kb(e,t=1){return this.net_price_per_byte(e,1e3*t)}net_price_per_byte(e,t=1e3){return this.price_per(e,t,e.net)}price_per(e,t=1e3,a=e.cpu){const n=C.fromUnits(1e4,this.symbol),i=Number(n.units)/(this.total_rent.value/this.total_unlent.value)*(Number(a)/kt);return Number(n.units)/i*t/Math.pow(10,this.precision)}};_([x.field("uint8")],Nt.prototype,"version",void 0),_([x.field("asset")],Nt.prototype,"total_lent",void 0),_([x.field("asset")],Nt.prototype,"total_unlent",void 0),_([x.field("asset")],Nt.prototype,"total_rent",void 0),_([x.field("asset")],Nt.prototype,"total_lendable",void 0),_([x.field("asset")],Nt.prototype,"total_rex",void 0),_([x.field("asset")],Nt.prototype,"namebid_proceeds",void 0),_([x.field("uint64")],Nt.prototype,"loan_num",void 0),Nt=_([x.type("rexstate")],Nt);class wt{constructor(e){this.parent=e}async get_state(){return(await this.parent.api.v1.chain.get_table_rows({code:"eosio",scope:"eosio",table:"rexpool",type:Nt})).rows[0]}}const kt=new k(1e8);class xt{constructor(e){if(this.sampleAccount="greymassfuel",this.symbol="4,EOS",this.v1={powerup:new ft(this),ram:new bt(this),rex:new wt(this)},e.sampleAccount&&(this.sampleAccount=e.sampleAccount),e.symbol&&(this.symbol=e.symbol),e.api)this.api=e.api;else{if(!e.url)throw new Error("Missing url or api client");this.api=new b({provider:new N(e.url,e)})}}async getSampledUsage(){const e=await this.api.v1.chain.get_account(this.sampleAccount),t=w.from(e.cpu_limit.max.value.mul(kt)),a=w.from(e.net_limit.max.value.mul(kt)),n=w.from(e.cpu_weight.value),i=w.from(e.net_weight.value);return{account:e,cpu:Ct(t.value,n.value),net:Ct(a.value,i.value)}}}function Ct(e,t){let a=e.div(t);const n=new k(0),i=new k(1);return e.mod(t).gt(n)&&a.gt(i)&&(a=a.sub(i)),w.from(a)}function At(e){return new dt(String(e))}xt.V="Resources";let _t=class extends x{};_([x.field(I)],_t.prototype,"payer",void 0),_([x.field(I)],_t.prototype,"receiver",void 0),_([x.field(M)],_t.prototype,"days",void 0),_([x.field(A)],_t.prototype,"net_frac",void 0),_([x.field(A)],_t.prototype,"cpu_frac",void 0),_([x.field(C)],_t.prototype,"max_payment",void 0),_t=_([x.type("powerup")],_t);let St=class extends x{};_([x.field(I)],St.prototype,"payer",void 0),_([x.field(I)],St.prototype,"receiver",void 0),_([x.field(M)],St.prototype,"bytes",void 0),St=_([x.type("buyrambytes")],St);var Pt,Tt,$t={en:{checking:"Checking transaction",fee:{title:"Accept Transaction Fee?",body:"Additional resources ({{resource}}) are required for your account to perform this transaction. Would you like to automatically purchase these resources from the network and proceed?",cost:"Cost of {{resource}}"},resolving:"Resolving transaction"},ko:{checking:"\uac70\ub798 \ud655\uc778",fee:{title:"\uac70\ub798 \uc218\uc218\ub8cc\ub97c \uc218\ub77d\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",body:"\uacc4\uc815\uc5d0\uc11c \uc774 \uac70\ub798\ub97c \uc218\ud589\ud558\ub824\uba74 \ucd94\uac00 \ub9ac\uc18c\uc2a4({{resource}})\uac00 \ud544\uc694\ud569\ub2c8\ub2e4. \ub124\ud2b8\uc6cc\ud06c\uc5d0\uc11c \uc774\ub7ec\ud55c \ub9ac\uc18c\uc2a4\ub97c \uc790\ub3d9\uc73c\ub85c \uad6c\ub9e4\ud558\uace0 \uacc4\uc18d \uc9c4\ud589\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?",cost:"{{resource}}\uc758 \ube44\uc6a9"},resolving:"\ud2b8\ub79c\uc7ad\uc158 \ud574\uacb0"},"zh-Hans":{checking:"\u6b63\u5728\u68c0\u67e5\u4ea4\u6613",fee:{title:"\u63a5\u53d7\u4ea4\u6613\u8d39\u7528\uff1f",body:"\u60a8\u7684\u5e10\u6237\u9700\u8981\u5176\u4ed6\u8d44\u6e90 \uff08{{resource}}\uff09 \u624d\u80fd\u6267\u884c\u6b64\u4ea4\u6613\u3002\u662f\u5426\u8981\u81ea\u52a8\u4ece\u7f51\u7edc\u8d2d\u4e70\u8fd9\u4e9b\u8d44\u6e90\u5e76\u7ee7\u7eed\uff1f",cost:"{{resource}} \u7684\u6210\u672c"},resolving:"\u6b63\u5728\u89e3\u6790\u4ea4\u6613"},"zh-Hant":{checking:"\u6b63\u5728\u6aa2\u67e5\u4ea4\u6613",fee:{title:"\u63a5\u53d7\u4ea4\u6613\u8cbb\u7528\uff1f",body:"\u60a8\u7684\u5e33\u6236\u9700\u8981\u5176\u4ed6\u8cc7\u6e90 \uff08{{resource}}\uff09 \u624d\u80fd\u57f7\u884c\u6b64\u4ea4\u6613\u3002\u662f\u5426\u8981\u81ea\u52d5\u5f9e\u7db2\u8def\u8cfc\u8cb7\u9019\u4e9b\u8cc7\u6e90\u4e26\u7e7c\u7e8c\uff1f",cost:"{{resource}} \u7684\u6210\u672c"},resolving:"\u6b63\u5728\u89e3\u6790\u4ea4\u6613"}};(Tt=Pt||(Pt={}))[Tt.BuyRAM=0]="BuyRAM",Tt[Tt.PowerUp=1]="PowerUp";const Ft={aca376f206b8fc25a6ed44dbdc66547c36c6c33e3a119ffbeaef943642f0e906:{features:[Pt.BuyRAM,Pt.PowerUp],sampleAccount:"eosio.reserv",symbol:C.Symbol.from("4,EOS")},"73e4385a2708e6d7048834fbc1079f2fabb17b3c125b146af438971e90716c4d":{features:[Pt.BuyRAM,Pt.PowerUp],sampleAccount:"eosio.reserv",symbol:C.Symbol.from("4,EOS")},"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4":{features:[Pt.BuyRAM,Pt.PowerUp],sampleAccount:"boost.wax",symbol:C.Symbol.from("8,WAX")}},Et=1.5;class It extends T{constructor(){super(...arguments),this.id="transact-plugin-autocorrect",this.translations=$t,this.sample=null,this.price=null,this.resources=[],this.iterations=0}register(e){if(!e.ui)throw new Error("The TransactPluginAutoCorrect plugin requires a UI to be present.");e.addHook($.beforeSign,async(e,t)=>this.run(e,t))}async run(e,t){if(!t.ui)return{request:e};this.price=null,this.resources=[],this.iterations=0;const a=t.ui.getTranslate(this.id),n=t.ui.prompt({title:a("checking",{default:"Checking transaction"}),body:"",elements:[]}).catch(t=>{if(t)throw t;return{request:e}}),i=await t.client.v1.chain.get_account(t.permissionLevel.actor),r=this.correct(e,t,i),s=await Promise.race([n,r]);if(s===e&&!this.price)return{request:e};const l=Array.from(new Set(this.resources)).join("/");return t.ui.prompt({title:a("fee.title",{default:"Accept Transaction Fee?"}),body:a("fee.body",{default:"Additional resources ({{resource}}) are required for your account to perform this transaction. Would you like to automatically purchase these resources from the network and proceed?",resource:l}),elements:[{type:"asset",data:{label:a("fee.cost",{default:"Cost of {{resource}}",resource:l}),value:this.price}},{type:"accept"}]}).then(()=>({request:s})).catch(t=>{if(t)throw t;return{request:e}})}async correct(e,t,a){if(this.iterations++,this.iterations>3)throw new Error("Too many iterations. Please report this bug if you see it.");const n=Ft[String(t.chain.id)];if(!n||!t.ui)return e;const i=new xt({api:t.client,sampleAccount:n.sampleAccount}),r=await t.resolve(e);return t.client.v1.chain.compute_transaction(r.transaction).then(s=>{const l=function(e){return e.error?e.error:e.processed.except?e.processed.except:null}(s);if(l&&l.stack&&"object"==typeof l.stack[0])switch(l.name){case"tx_net_usage_exceeded":{const{net_usage:e}=l.stack[0].data,s=e*Et;if(n.features.includes(Pt.PowerUp))return this.powerup(t,r,a,i,0,s);break}case"tx_cpu_usage_exceeded":{const{billed:e,billable:s}=l.stack[0].data,c=(e-s)*Et;if(n.features.includes(Pt.PowerUp))return this.powerup(t,r,a,i,c,0);break}case"ram_usage_exceeded":{const{available:e,needs:s}=l.stack[0].data,c=(s-e)*Et;if(n.features.includes(Pt.BuyRAM))return this.buyram(t,r,a,i,c);break}}return e}).catch(s=>{if(s.error)switch(s.error.name){case"tx_net_usage_exceeded":{const[,e]=s.error.details[0].message.match(/transaction net usage is too high: (\d+) > (\d+)/),l=Number(e)*Et;if(n.features.includes(Pt.PowerUp))return this.powerup(t,r,a,i,0,l);break}case"tx_cpu_usage_exceeded":{const[,e]=s.error.details[0].message.match(/billed CPU time \((\d+) us\) is greater than the maximum billable CPU time for the transaction/),l=Number(e)*Et;if(n.features.includes(Pt.PowerUp))return this.powerup(t,r,a,i,l,0);break}case"ram_usage_exceeded":{const[,,e,l]=s.error.details[0].message.match(/account (\w.+) has insufficient ram; needs (\d+) bytes has (\d+) bytes/),c=(Number(e)-Number(l))*Et+2;if(n.features.includes(Pt.BuyRAM))return this.buyram(t,r,a,i,c);break}}return e})}async buyram(e,t,a,n,i){const r=Ft[String(e.chain.id)],s=await n.v1.ram.get_state();this.sample||(this.sample=await n.getSampledUsage());const l=C.from(s.price_per(i).value,r.symbol);this.price?this.price.units.add(l.units):this.price=l,this.resources.push("RAM");const c=F.from({account:"eosio",name:"buyrambytes",authorization:[t.signer],data:St.from({payer:t.signer.actor,receiver:t.signer.actor,bytes:i})}),o=E(t.request,c);return this.correct(o,e,a)}async powerup(e,t,a,n,i,r){const s=Ft[String(e.chain.id)],l=await n.v1.powerup.get_state();this.sample||(this.sample=await n.getSampledUsage()),i<2500&&(i=2500),r<1e4&&(r=1e4);const c=C.from(Number(l.cpu.price_per(this.sample,i))+Number(l.net.price_per(this.sample,r))*Et,s.symbol);this.price?this.price.units.add(c.units):this.price=c,this.resources.push("CPU","NET");const o=F.from({account:"eosio",name:"powerup",authorization:[t.signer],data:_t.from({payer:t.signer.actor,receiver:t.signer.actor,days:1,net_frac:l.net.frac(this.sample,r),cpu_frac:l.cpu.frac(this.sample,i),max_payment:c})});let d=E(t.request,o);const h=410;if(Number(a.ram_quota)-Number(a.ram_usage)<h){const i=Ft[String(e.chain.id)],r=await n.v1.ram.get_state();this.sample||(this.sample=await n.getSampledUsage());const s=F.from({account:"eosio",name:"buyrambytes",authorization:[t.signer],data:St.from({payer:t.signer.actor,receiver:t.signer.actor,bytes:h})});a.ram_quota.add(h),d=E(d,s);const l=C.from(r.price_per(h).value,i.symbol);this.price.units.add(l.units),this.resources.push("RAM")}return this.correct(d,e,a)}}const Mt=new class{constructor(){t(this,"transactions",new Map),t(this,"listeners",new Set),t(this,"retryTimeouts",new Map)}async executeTransaction(e,t,a={}){const n=this.generateTransactionId(),i=Lt.getAccountName();if(!i)throw new Error("Wallet not connected");const r={id:n,type:e,status:"pending",timestamp:Date.now(),account:i,actions:t,metadata:a.metadata,retryCount:0,maxRetries:a.maxRetries??3};this.transactions.set(n,r),this.emitEvent("transaction_started",r);try{this.updateTransactionStatus(n,"processing");const s=await this.performTransaction(t,a.timeout);if(r.transactionId=s.transactionId,r.blockNum=s.blockNum,r.cpuUsage=s.cpuUsage,r.netUsage=s.netUsage,s.success)return a.skipConfirmation||(this.updateTransactionStatus(n,"confirming"),await this.waitForConfirmation(s.transactionId)),this.updateTransactionStatus(n,"success"),se.info("Transaction successful","TransactionService",{transactionId:s.transactionId,type:e,account:i}),s;throw new Error(s.error||"Transaction failed")}catch(s){const t=s instanceof Error?s.message:"Unknown error";return r.error=t,se.error("Transaction failed","TransactionService",s instanceof Error?s:new Error(t),{transactionId:n,type:e,account:i}),r.maxRetries>0&&r.retryCount<r.maxRetries?this.retryTransaction(n,a):(this.updateTransactionStatus(n,"failed"),{success:!1,error:t})}}async retryTransaction(e,t){const a=this.transactions.get(e);if(!a)throw new Error("Transaction not found");a.retryCount=(a.retryCount||0)+1,this.emitEvent("transaction_retry",a);const n=t.retryDelay??2e3*a.retryCount;await new Promise(t=>{const a=setTimeout(t,n);this.retryTimeouts.set(e,a)}),this.retryTimeouts.delete(e);const i=this.generateTransactionId(),r={...a,id:i,status:"pending",timestamp:Date.now(),error:void 0,transactionId:void 0,blockNum:void 0,cpuUsage:void 0,netUsage:void 0};this.transactions.set(i,r),this.emitEvent("transaction_started",r);try{this.updateTransactionStatus(i,"processing");const e=await this.performTransaction(a.actions,t.timeout);if(r.transactionId=e.transactionId,r.blockNum=e.blockNum,r.cpuUsage=e.cpuUsage,r.netUsage=e.netUsage,e.success)return t.skipConfirmation||(this.updateTransactionStatus(i,"confirming"),await this.waitForConfirmation(e.transactionId)),this.updateTransactionStatus(i,"success"),se.info("Transaction retry successful","TransactionService",{transactionId:e.transactionId,type:a.type,account:a.account,retryCount:a.retryCount}),e;throw new Error(e.error||"Transaction failed")}catch(s){const n=s instanceof Error?s.message:"Unknown error";return r.error=n,se.error("Transaction retry failed","TransactionService",s instanceof Error?s:new Error(n),{transactionId:i,type:a.type,account:a.account,retryCount:a.retryCount}),a.maxRetries>0&&a.retryCount<a.maxRetries?this.retryTransaction(e,t):(this.updateTransactionStatus(i,"failed"),{success:!1,error:n})}}cancelTransaction(e){const t=this.transactions.get(e);if(!t||"pending"!==t.status)return!1;const a=this.retryTimeouts.get(e);return a&&(clearTimeout(a),this.retryTimeouts.delete(e)),this.updateTransactionStatus(e,"cancelled"),!0}getTransaction(e){return this.transactions.get(e)}getTransactionsByAccount(e){return Array.from(this.transactions.values()).filter(t=>t.account===e).sort((e,t)=>t.timestamp-e.timestamp)}getTransactionsByType(e){return Array.from(this.transactions.values()).filter(t=>t.type===e).sort((e,t)=>t.timestamp-e.timestamp)}getPendingTransactions(){return Array.from(this.transactions.values()).filter(e=>["pending","processing","confirming"].includes(e.status)).sort((e,t)=>t.timestamp-e.timestamp)}clearOldTransactions(){const e=Array.from(this.transactions.values()).sort((e,t)=>t.timestamp-e.timestamp);e.length>100&&e.slice(100).forEach(e=>this.transactions.delete(e.id))}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}clearListeners(){this.listeners.clear()}generateTransactionId(){return`tx_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}updateTransactionStatus(e,t){const a=this.transactions.get(e);a&&(a.status=t,this.emitEvent(`transaction_${t}`,a))}emitEvent(e,t){const a={type:e,transaction:t,timestamp:Date.now()};this.listeners.forEach(e=>{try{e(a)}catch(t){se.error("Transaction listener error","TransactionService",t instanceof Error?t:new Error(String(t)))}})}async performTransaction(e,t){try{const t=await Lt.transact(e);if(t&&"object"==typeof t){const e=t;return{success:!0,transactionId:e.transaction_id||e.id,blockNum:e.block_num,cpuUsage:e.cpu_usage_us,netUsage:e.net_usage_words}}return{success:!0}}catch(a){return{success:!1,error:a instanceof Error?a.message:"Transaction failed"}}}async waitForConfirmation(e){await new Promise(e=>setTimeout(e,3e3))}},Lt=new class{constructor(){t(this,"sessionKit",null),t(this,"currentSession",null),t(this,"listeners",[]),this.initializeSessionKit(),this.restoreSession()}initializeSessionKit(){try{const e={appName:"PxMarket2",chains:[{id:"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4",url:ue.WAX_CHAIN.GREYMASS}],ui:new L,walletPlugins:[new v,new y,new g]},t={transactPlugins:[new It]};this.sessionKit=new W(e,t)}catch(e){ee.logError("WharfKitService.initialize",e)}}async restoreSession(){if(this.sessionKit)try{const e=await this.sessionKit.restore();e&&(this.currentSession=e,this.notifyListeners())}catch(e){ee.logError("WharfKitService.restoreSession",e)}}async login(){if(!this.sessionKit)return ee.logError("WharfKitService.login",new Error("SessionKit not initialized")),null;try{const e=await this.sessionKit.login();if(e.session)return this.currentSession=e.session,this.notifyListeners(),this.currentSession}catch(e){throw ee.logError("WharfKitService.login",e),e}return null}async logout(){if(this.sessionKit&&this.currentSession)try{await this.sessionKit.logout(this.currentSession),this.currentSession=null,this.notifyListeners()}catch(e){throw ee.logError("WharfKitService.logout",e),e}}isLoggedIn(){return null!==this.currentSession}getSession(){return this.currentSession}getActor(){return this.currentSession?.actor.toString()||null}getAccountName(){return this.currentSession?.actor.toString()||null}async transact(e){if(!this.currentSession)throw new Error("No active session. Please login first.");try{re.debug("Sending transaction with actions","WHARFKIT",{actionsCount:e.length});const t=await this.currentSession.transact({actions:e},{broadcast:!0,expireSeconds:120});return re.info("Transaction successful","WHARFKIT",{result:t}),t}catch(t){throw ee.logError("WharfKitService.transact",t,{actions:e}),t}}async purchaseNFT(e,t){if(!this.currentSession)throw new Error("Please login to purchase NFTs");const a=[{account:"eosio.token",name:"transfer",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{from:this.currentSession?.actor.toString()||"",to:"atomicmarket",quantity:`${parseFloat(t).toFixed(8)} WAX`,memo:"deposit"}},{account:"atomicmarket",name:"purchasesale",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{buyer:this.currentSession?.actor.toString()||"",sale_id:e,intended_delphi_median:0,taker_marketplace:"market.pxj"}}];return re.debug("Crafting transaction actions","WHARFKIT",{actionsCount:a.length}),this.transact(a)}async batchPurchaseNFTs(e){if(!this.currentSession)throw new Error("Please login to purchase NFTs");if(0===e.length)throw new Error("No items to purchase");const t=[],a=e.reduce((e,t)=>e+parseFloat(t.price),0);return t.push({account:"eosio.token",name:"transfer",authorization:[{actor:this.currentSession.actor.toString(),permission:"active"}],data:{from:this.currentSession.actor.toString(),to:"atomicmarket",quantity:`${a.toFixed(8)} WAX`,memo:"deposit"}}),e.forEach(e=>{t.push({account:"atomicmarket",name:"purchasesale",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{buyer:this.currentSession?.actor.toString()||"",sale_id:e.saleId,intended_delphi_median:0,taker_marketplace:"market.pxj"}})}),this.transact(t)}async transferTokens(e,t,a="PXJ",n=""){if(!this.currentSession)throw new Error("Please login to transfer tokens");const i=((e,t,a,n="WAX",i="")=>{let r;switch(n){case"WAX":default:r="eosio.token";break;case"RWAX":r="token.rwax";break;case"PXJ":r="pixeljourney"}return[{account:r,name:"transfer",authorization:[{actor:e,permission:"active"}],data:{from:e,to:t,quantity:`${a} ${n}`,memo:i}}]})(this.currentSession.actor.toString(),e,t,a,n);return re.debug("Token transfer transaction actions","WHARFKIT",{actionsCount:i.length,to:e,amount:t,currency:a,memo:n}),this.transact(i)}async bulkTransferNFT(e,t,a=""){if(!this.currentSession)throw new Error("Please login to transfer NFTs");if(!t||0===t.length)throw new Error("No assets to transfer");const n=t.map(t=>({account:"atomicassets",name:"transfer",authorization:[{actor:this.currentSession.actor.toString(),permission:"active"}],data:{from:this.currentSession.actor.toString(),to:e,asset_ids:[t],memo:a}}));return re.debug("Bulk NFT transfer transaction actions","WHARFKIT",{actionsCount:n.length,recipient:e,assetIds:t.length,memo:a}),this.transact(n)}async executeCraftingTransaction(e){if(!this.currentSession)throw new Error("No active session");const t=[],a=this.currentSession.actor.toString(),n={craft_green:1832,craft_orange:1833,craft_purple:1834,craft_amber:1835,craft_chartreuse:1836,craft_violet:1837,craft_teal:1838,craft_vermillion:1839,craft_magenta:1841}[e.recipe];if(!n)throw new Error(`Unknown recipe: ${e.recipe}`);const i=e.pxjCost;t.push({account:"nft.hive",name:"boost",authorization:[{actor:a,permission:"active"}],data:{booster:a}});for(let r=0;r<e.quantity;r++){const s=[];for(const t of e.ingredientAssets){const a=t.assetIds.length/e.quantity,n=r*a,i=n+a;s.push(...t.assetIds.slice(n,i))}s.length>0&&t.push({account:"atomicassets",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"nfthivecraft",asset_ids:s,memo:"craft"}}),i>0&&t.push({account:"pixeljourney",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"nfthivecraft",quantity:`${i.toFixed(8)} PXJ`,memo:"craft"}}),t.push({account:"nfthivecraft",name:"craft",authorization:[{actor:a,permission:"active"}],data:{craft_id:n,user_name:a,collection_name:"pixeljourney",timestamp:Date.now().toString(),asset_ids:s,tokens:[`${i.toFixed(8)} PXJ`]}})}return this.transact(t)}subscribe(e){return this.listeners.push(e),e(this.getWalletContext()),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}notifyListeners(){const e=this.getWalletContext();this.listeners.forEach(t=>t(e))}getWalletContext(){return{isConnected:this.isLoggedIn(),account:this.getAccountName(),session:this.currentSession,login:this.login.bind(this),logout:this.logout.bind(this),transact:this.transact.bind(this),purchaseNFT:this.purchaseNFT.bind(this),batchPurchaseNFTs:this.batchPurchaseNFTs.bind(this),executeCraftingTransaction:this.executeCraftingTransaction.bind(this),isLoading:!1,executeTransaction:this.executeTransaction.bind(this),getTransaction:void 0,cancelTransaction:void 0,getTransactionHistory:void 0,transferNFT:void 0,bulkTransferNFT:this.bulkTransferNFT.bind(this),transferTokens:this.transferTokens.bind(this)}}async executeTransaction(e,t){if(!this.currentSession)throw new Error("No active session. Please login first.");try{let a=[];switch(e){case"nft_purchase":if(!t.saleId||!t.price)throw new Error("Missing saleId or price for NFT purchase");a=((e,t,a,n="WAX",i="atomicmarket")=>{const r=[],s="WAX"===n?"eosio.token":"token.rwax";return r.push({account:s,name:"transfer",authorization:[{actor:e,permission:"active"}],data:{from:e,to:i,quantity:`${a} ${n}`,memo:"deposit"}}),r.push({account:i,name:"purchasesale",authorization:[{actor:e,permission:"active"}],data:{buyer:e,sale_id:t,intended_delphi_median:0,taker_marketplace:"market.pxj"}}),r})(this.currentSession.actor.toString(),t.saleId,t.price);break;case"crafting":{const e=await this.executeCraftingTransaction(t);return e&&"object"==typeof e&&"transaction_id"in e?e.transaction_id:"crafting_completed"}default:throw new Error(`Transaction type '${e}' not supported yet`)}const n=await Mt.executeTransaction(e,a);if(n.success&&n.transactionId)return n.transactionId;throw new Error(n.error||"Transaction failed")}catch(a){throw re.error("Transaction execution failed","WharfKitService.executeTransaction",a instanceof Error?a:new Error(String(a)),{type:e,data:t}),a}}getAPIClient(){return new b({url:ue.WAX_CHAIN.GREYMASS})}},Wt=Object.freeze(Object.defineProperty({__proto__:null,wharfKitService:Lt},Symbol.toStringTag,{value:"Module"})),Rt=r.memo(({imageUrl:e,videoUrl:t,alt:a,className:n="",controls:i=!0,muted:r=!0,loop:s=!1,autoPlay:l=!1,loading:c="lazy",enableAnimations:o=!0})=>{const d=e=>e?"string"!=typeof e?null:e.startsWith("http")?e:e.startsWith("Qm")?`${ue.IPFS.GATEWAYS[0]}${e}`:e:null,h=d(t),u=d(e),m=()=>`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#f3f4f6"/>\n      <text x="100" y="90" text-anchor="middle" font-family="Arial" font-size="14" fill="#6b7280">NFT</text>\n      <text x="100" y="110" text-anchor="middle" font-family="Arial" font-size="12" fill="#9ca3af">No Image</text>\n      <text x="100" y="130" text-anchor="middle" font-family="Arial" font-size="10" fill="#d1d5db">Available</text>\n    </svg>')}`,p=u||m();return h&&o?H.jsxs("video",{className:n,controls:i,muted:r,loop:s,autoPlay:l,poster:u||void 0,onError:e=>{const t=e.target,i=document.createElement("img");i.src=p,i.alt=a,i.className=n,i.loading=c,t.parentNode?.replaceChild(i,t)},children:[H.jsx("source",{src:h,type:"video/mp4"}),H.jsx("source",{src:h,type:"video/webm"}),"Your browser does not support the video tag."]}):h&&!o?H.jsx("img",{src:p,alt:a,className:n,loading:c,onError:e=>{const t=e.target,a=m();t.src!==a&&(t.src=a)}}):H.jsx("img",{src:p,alt:a,className:n,loading:c,onError:e=>{const t=e.target,a=m();t.src!==a&&(t.src=a)}})});function Ot({isOpen:e,onClose:t,nft:a}){const{session:n,isConnected:r,account:s}=Q(),{settings:l}=ke(),{showSuccess:c,showError:o}=We(),[d,h]=i.useState("wax"),[u,m]=i.useState(""),[p,f]=i.useState(""),[v,y]=i.useState([]),[g,b]=i.useState([]),[N,w]=i.useState(!1),[k,x]=i.useState(!1),[C,A]=i.useState(!1);return i.useEffect(()=>{e&&r&&(async()=>{if(s)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/assets?owner=${s}&collection_name=pixeljourney&limit=1`),t=await e.json();A(t.data&&t.data.length>0)}catch(e){}})()},[e,r,s]),i.useEffect(()=>{e&&"nft"===d&&(async()=>{if(s&&"nft"===d){x(!0);try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/assets?owner=${s}&limit=100`),t=await e.json(),a=t.data?.map(e=>{const t=e.data?.img||e.data?.image,a=e.data?.video;let n="https://pixeljourney.xyz/img/toppixals/10.webp",i=null;return a&&"string"==typeof a&&(i=a.startsWith("http")?a:`${ue.IPFS.GATEWAYS[0]}${a}`),t&&"string"==typeof t&&(n=t.startsWith("http")?t:`${ue.IPFS.GATEWAYS[0]}${t}`),{asset_id:e.asset_id||"",name:e.name||`${e.collection?.collection_name||"Unknown"} #${e.asset_id||"N/A"}`,image:n,video:i,collection:e.collection?.collection_name||"Unknown",template_mint:void 0,max_supply:e.template?.max_supply||void 0}})||[];y(a)}catch(e){}finally{x(!1)}}})()},[e,d,s]),e&&a?H.jsx("div",{className:"modal-backdrop",onClick:t,children:H.jsxs("div",{className:"modal-content send-offer-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h3",{children:["Send Offer for ",a.name]}),H.jsx("button",{className:"modal-close",onClick:t,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"target-nft-preview",children:[H.jsx(Rt,{imageUrl:a.image,alt:a.name,enableAnimations:l.enableAnimatedNFTs}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h4",{children:a.name}),H.jsxs("p",{children:["Collection: ","string"==typeof a.collection?a.collection:a.collection?.collection_name||a.collection?.name||"Unknown"]}),a.price&&H.jsxs("p",{children:["Listed Price: ",a.price," WAX"]})]})]}),H.jsxs("div",{className:"offer-type-selection",children:[H.jsx("h4",{children:"Choose Offer Type"}),H.jsxs("div",{className:"offer-type-buttons",children:[H.jsxs("button",{className:"offer-type-btn "+("wax"===d?"active":""),onClick:()=>h("wax"),children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("path",{d:"M12 6v6l4 2"})]}),"WAX Offer"]}),H.jsxs("button",{className:"offer-type-btn "+("nft"===d?"active":""),onClick:()=>h("nft"),children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),H.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),H.jsx("polyline",{points:"21,15 16,10 5,21"})]}),"NFT Trade"]})]})]}),"wax"===d&&H.jsx("div",{className:"wax-offer-form",children:H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"waxAmount",children:"WAX Amount"}),H.jsx("input",{id:"waxAmount",type:"number",step:"0.0001",min:"0",value:u,onChange:e=>m(e.target.value),placeholder:"Enter WAX amount",className:"form-input"})]})}),"nft"===d&&H.jsxs("div",{className:"nft-trade-form",children:[H.jsx("h4",{children:"Select NFTs to Trade"}),k?H.jsxs("div",{className:"loading-inventory",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading your NFTs..."})]}):H.jsx("div",{className:"user-nfts-grid",children:v.map(e=>H.jsxs("div",{className:"user-nft-item "+(g.includes(e.asset_id)?"selected":""),onClick:()=>{return t=e.asset_id,void b(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[H.jsx(Rt,{imageUrl:e.image,videoUrl:e.video,alt:e.name,enableAnimations:l.enableAnimatedNFTs}),H.jsxs("div",{className:"nft-details",children:[H.jsx("p",{className:"nft-name",children:e.name}),H.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"})]}),g.includes(e.asset_id)&&H.jsx("div",{className:"selection-indicator",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("polyline",{points:"20,6 9,17 4,12"})})})]},e.asset_id))})]}),C&&H.jsxs("div",{className:"custom-memo-section",children:[H.jsxs("div",{className:"pixal-holder-badge",children:[H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("polygon",{points:"12,2 15.09,8.26 22,9 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9 8.91,8.26"})}),"Pixal PFP Holder"]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"customMemo",children:"Custom Memo (Optional)"}),H.jsx("textarea",{id:"customMemo",value:p,onChange:e=>f(e.target.value),placeholder:"Add a custom message to your offer...",className:"form-textarea",rows:3})]})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"btn-secondary",onClick:t,children:"Cancel"}),H.jsx("button",{className:"btn-primary",onClick:()=>{"wax"===d?(async()=>{if(s&&a&&u&&n){w(!0);try{const e=p||"Trade Offer sent via PxMarket - market.pixeljourney.xyz",i=[{account:"eosio.token",name:"transfer",authorization:[{actor:s,permission:"active"}],data:{from:s,to:"atomicmarket",quantity:`${parseFloat(u).toFixed(8)} WAX`,memo:"deposit"}},{account:"atomicmarket",name:"createbuyo",authorization:[{actor:s,permission:"active"}],data:{buyer:s,recipient:a.owner||a.seller,price:`${parseFloat(u).toFixed(8)} WAX`,asset_ids:[a.asset_id],memo:e,maker_marketplace:"market.pxj"}}];await n.transact({actions:i}),c("WAX offer sent successfully!"),t()}catch(e){o("Failed to send WAX offer. Please try again.")}finally{w(!1)}}})():(async()=>{if(s&&a&&0!==g.length&&n){w(!0);try{const e=p||"NFT Trade Offer sent via PxMarket - market.pixeljourney.xyz",i=[{account:"atomicassets",name:"createoffer",authorization:[{actor:s,permission:"active"}],data:{sender:s,recipient:a.owner||a.seller,sender_asset_ids:g,recipient_asset_ids:[a.asset_id],memo:e}}];await n.transact({actions:i}),c("NFT trade offer sent successfully!"),t()}catch(e){o("Failed to send NFT offer. Please try again.")}finally{w(!1)}}})()},disabled:N||!r||"wax"===d&&!u||"nft"===d&&0===g.length,children:N?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"spinner-small"}),"Sending..."]}):`Send ${"wax"===d?"WAX":"NFT"} Offer`})]})]})}):null}Rt.displayName="MediaRenderer";const Bt=new class{constructor(){t(this,"defaultConfig",{width:1200,height:630,backgroundColor:"#1a1a2e",textColor:"#ffffff",accentColor:"#ffd700"})}generateAchievementShareImage(e,t,a,n,i={}){const{width:r,height:s,textColor:l,accentColor:c}={...this.defaultConfig,...i},o=e.filter(e=>e.unlockedAt).sort((e,t)=>{const a={legendary:4,epic:3,rare:2,common:1};return(a[t.rarity||"common"]||1)-(a[e.rarity||"common"]||1)}).slice(0,3),d=`\n      <svg width="${r}" height="${s}" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#16213e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />\n          </linearGradient>\n          <linearGradient id="titleGradient" x1="0%" y1="0%" x2="100%" y2="0%">\n            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n        \n        \x3c!-- Background --\x3e\n        <rect width="100%" height="100%" fill="url(#bgGradient)"/>\n        \n        \x3c!-- Header --\x3e\n        <text x="${r/2}" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="48" font-weight="bold" fill="url(#titleGradient)" text-anchor="middle">\n          ${n}'s Achievements\n        </text>\n        \n        \x3c!-- Stats Section --\x3e\n        <g transform="translate(${r/2-300}, 150)">\n          \x3c!-- Total Badges --\x3e\n          <rect x="0" y="0" width="180" height="120" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="90" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="${c}" text-anchor="middle">${t}</text>\n          <text x="90" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Total</text>\n          <text x="90" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Badges</text>\n          \n          \x3c!-- Legendary Badges --\x3e\n          <rect x="210" y="0" width="180" height="120" rx="15" fill="rgba(255,140,0,0.2)" stroke="#ff8c00" stroke-width="2"/>\n          <text x="300" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="#ff8c00" text-anchor="middle">${a}</text>\n          <text x="300" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Legendary</text>\n          <text x="300" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Badges</text>\n          \n          \x3c!-- Progress --\x3e\n          <rect x="420" y="0" width="180" height="120" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="510" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="${c}" text-anchor="middle">${e.filter(e=>e.progress&&!e.unlockedAt).length}</text>\n          <text x="510" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">In</text>\n          <text x="510" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Progress</text>\n        </g>\n        \n        \x3c!-- Top Badges Section --\x3e\n        ${o.length>0?`\n        <text x="${r/2}" y="350" font-family="system-ui" font-size="24" font-weight="600" fill="${l}" text-anchor="middle">\n          Featured Achievements\n        </text>\n        \n        <g transform="translate(${r/2-150*o.length}, 380)">\n          ${o.map((e,t)=>{const a=300*t,n="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="280" height="180" rx="15" fill="rgba(255,255,255,0.1)" stroke="${n}" stroke-width="2"/>\n              <text x="140" y="30" font-family="system-ui" font-size="32" text-anchor="middle">${e.icon}</text>\n              <text x="140" y="70" font-family="system-ui" font-size="18" font-weight="600" fill="${n}" text-anchor="middle">${e.name}</text>\n              <text x="140" y="100" font-family="system-ui" font-size="14" fill="#b0b0b0" text-anchor="middle">${e.rarity?.toUpperCase()||"COMMON"}</text>\n              ${e.tier?`<text x="140" y="130" font-family="system-ui" font-size="12" fill="#888" text-anchor="middle">Tier ${e.tier}</text>`:""}\n              <text x="140" y="160" font-family="system-ui" font-size="10" fill="#666" text-anchor="middle">${e.unlockedAt?new Date(e.unlockedAt).toLocaleDateString():""}</text>\n            </g>\n            `}).join("")}\n        </g>\n        `:""}\n        \n        \x3c!-- Footer --\x3e\n        <text x="${r/2}" y="${s-40}" font-family="system-ui" font-size="18" fill="#888" text-anchor="middle">\n          Pixel Journey Ecosystem \u2022 PxMarket\n        </text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(d)}`}generateInventoryShareImage(e,t,a,n={}){const{width:i,height:r,textColor:s,accentColor:l}={...this.defaultConfig,...n},c=e.sort((e,t)=>{const a={legendary:4,epic:3,rare:2,common:1};return(a[t.rarity]||1)-(a[e.rarity]||1)}).slice(0,6),o=`\n      <svg width="${i}" height="${r}" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#16213e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />\n          </linearGradient>\n          <linearGradient id="titleGradient" x1="0%" y1="0%" x2="100%" y2="0%">\n            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n        \n        \x3c!-- Background --\x3e\n        <rect width="100%" height="100%" fill="url(#bgGradient)"/>\n        \n        \x3c!-- Header --\x3e\n        <text x="${i/2}" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="48" font-weight="bold" fill="url(#titleGradient)" text-anchor="middle">\n          ${a}'s Collection\n        </text>\n        \n        \x3c!-- Stats --\x3e\n        <g transform="translate(${i/2-200}, 130)">\n          <rect x="0" y="0" width="180" height="100" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="90" y="35" font-family="system-ui" font-size="32" font-weight="bold" fill="${l}" text-anchor="middle">${e.length}</text>\n          <text x="90" y="60" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Selected</text>\n          <text x="90" y="80" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Items</text>\n          \n          <rect x="220" y="0" width="180" height="100" rx="15" fill="rgba(0,212,255,0.2)" stroke="#00d4ff" stroke-width="2"/>\n          <text x="310" y="35" font-family="system-ui" font-size="24" font-weight="bold" fill="#00d4ff" text-anchor="middle">${t}</text>\n          <text x="310" y="60" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Total</text>\n          <text x="310" y="80" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Value</text>\n        </g>\n        \n        \x3c!-- Items Grid --\x3e\n        ${c.length>0?`\n        <text x="${i/2}" y="290" font-family="system-ui" font-size="24" font-weight="600" fill="${s}" text-anchor="middle">\n          Featured Items\n        </text>\n        \n        <g transform="translate(${i/2-120*Math.min(c.length,3)}, 320)">\n          ${c.slice(0,3).map((e,t)=>{const a=240*t,n="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="220" height="160" rx="15" fill="rgba(255,255,255,0.1)" stroke="${n}" stroke-width="2"/>\n              <rect x="10" y="10" width="60" height="60" rx="8" fill="rgba(0,0,0,0.3)" stroke="${n}" stroke-width="1"/>\n              <text x="40" y="50" font-family="system-ui" font-size="24" text-anchor="middle">\ud83c\udfa8</text>\n              <text x="90" y="30" font-family="system-ui" font-size="16" font-weight="600" fill="${s}">${e.name.length>15?e.name.substring(0,15)+"...":e.name}</text>\n              <text x="90" y="50" font-family="system-ui" font-size="14" fill="#b0b0b0">${e.collection}</text>\n              <text x="90" y="70" font-family="system-ui" font-size="12" fill="${n}">${e.rarity.toUpperCase()}</text>\n              ${e.quantity>1?`<text x="200" y="30" font-family="system-ui" font-size="14" fill="${l}" text-anchor="end">x${e.quantity}</text>`:""}\n            </g>\n            `}).join("")}\n        </g>\n        \n        ${c.length>3?`\n        <g transform="translate(${i/2-120*Math.min(c.length-3,3)}, 500)">\n          ${c.slice(3,6).map((e,t)=>{const a=240*t,n="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="220" height="100" rx="15" fill="rgba(255,255,255,0.1)" stroke="${n}" stroke-width="2"/>\n              <rect x="10" y="10" width="40" height="40" rx="6" fill="rgba(0,0,0,0.3)" stroke="${n}" stroke-width="1"/>\n              <text x="30" y="35" font-family="system-ui" font-size="16" text-anchor="middle">\ud83c\udfa8</text>\n              <text x="65" y="25" font-family="system-ui" font-size="14" font-weight="600" fill="${s}">${e.name.length>12?e.name.substring(0,12)+"...":e.name}</text>\n              <text x="65" y="45" font-family="system-ui" font-size="12" fill="${n}">${e.rarity.toUpperCase()}</text>\n              ${e.quantity>1?`<text x="200" y="25" font-family="system-ui" font-size="12" fill="${l}" text-anchor="end">x${e.quantity}</text>`:""}\n            </g>\n            `}).join("")}\n        </g>\n        `:""}\n        `:""}\n        \n        \x3c!-- Footer --\x3e\n        <text x="${i/2}" y="${r-40}" font-family="system-ui" font-size="18" fill="#888" text-anchor="middle">\n          Pixel Journey Ecosystem \u2022 PxMarket\n        </text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(o)}`}downloadImage(e,t){const a=document.createElement("a");a.download=t,a.href=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}async convertToPNG(e,t=1200,a=630){return new Promise((n,i)=>{const r=new Image;r.onload=()=>{const e=document.createElement("canvas");e.width=t,e.height=a;const s=e.getContext("2d");s?(s.drawImage(r,0,0,t,a),n(e.toDataURL("image/png"))):i(new Error("Could not get canvas context"))},r.onerror=i,r.src=e})}},jt=(e,t,a,n,i)=>Bt.generateAchievementShareImage(e,t,a,n,i),Dt=(e,t,a,n)=>Bt.generateInventoryShareImage(e,t,a,n),Ut=(e,t)=>Bt.downloadImage(e,t),Xt=({isOpen:e,onClose:t,title:a,description:n,imageUrl:r,shareUrl:s,defaultShareText:l,type:c="nft",badges:o,totalBadges:d,legendaryCount:h,username:u,selectedItems:m,totalValue:p})=>{const[f,v]=i.useState(!1),[y,g]=i.useState(""),[b,N]=i.useState(!1),{showSuccess:w}=We(),k=()=>{let e=[];switch(c){case"nft":e=[`\ud83c\udfa8 Check out this amazing NFT: ${a}! \u2728`,`\ud83d\udd25 Discovered this incredible ${a} NFT! \ud83d\ude80`,`\u2728 Look at this stunning ${a}! NFT art at its finest \ud83c\udfad`,`\ud83c\udf1f Found a gem! ${a} is absolutely beautiful \ud83d\udc8e`,`\ud83c\udfaf This ${a} NFT caught my eye! Amazing artwork \ud83c\udfa8`,`\ud83d\udcab Showcasing ${a} - a true masterpiece! \ud83d\uddbc\ufe0f`,`\ud83d\ude80 Blown away by this ${a} NFT! \u2b50`,`\ud83c\udfaa Step right up and see ${a}! Fantastic NFT art \ud83c\udf8a`];break;case"collection":e=[`\ud83c\udfdb\ufe0f Explore the amazing ${a} collection! \ud83c\udfa8`,`\ud83d\udd25 This ${a} collection is absolutely fire! \ud83d\ude80`,`\u2728 Dive into the world of ${a}! Incredible NFT collection \ud83c\udf1f`,`\ud83d\udc8e Discovered this gem of a collection: ${a}! \ud83c\udfad`,`\ud83c\udfaf ${a} collection has some amazing pieces! \ud83d\uddbc\ufe0f`,`\ud83c\udf08 The ${a} collection is a work of art! \u2728`,`\ud83d\ude80 Check out the stunning ${a} collection! \u2b50`,`\ud83c\udfaa Welcome to ${a} - an NFT wonderland! \ud83c\udf8a`];break;case"template":e=[`\ud83c\udfa8 Check out this ${a} template! Perfect for collectors \u2728`,`\ud83d\udd25 This ${a} template is incredible! \ud83d\ude80`,`\u2728 Found an amazing ${a} template! \ud83c\udfad`,`\ud83c\udf1f ${a} template - a collector's dream! \ud83d\udc8e`,`\ud83c\udfaf This ${a} template caught my attention! \ud83c\udfa8`,`\ud83d\udcab Showcasing the ${a} template! \ud83d\uddbc\ufe0f`,`\ud83d\ude80 Amazing ${a} template available! \u2b50`,`\ud83c\udfaa Don't miss this ${a} template! \ud83c\udf8a`];break;case"achievement":e=["\ud83c\udfc6 Just unlocked some amazing achievements! \ud83c\udf89","\ud83d\udd25 Check out my gaming achievements! \ud83d\ude80","\u2728 Proud of my latest achievements! \ud83c\udfad","\ud83c\udf1f Achievement unlocked! Gaming milestones reached \ud83d\udc8e","\ud83c\udfaf Showcasing my gaming achievements! \ud83c\udfa8","\ud83d\udcab Level up! New achievements earned! \ud83d\uddbc\ufe0f","\ud83d\ude80 Gaming achievements on display! \u2b50","\ud83c\udfaa Celebrating my gaming milestones! \ud83c\udf8a"];break;default:e=[l]}return e[Math.floor(Math.random()*e.length)]},[x,C]=i.useState(()=>l||k()),A=l||x,_=s||window.location.href;if(!e)return null;const S=async e=>{try{await navigator.clipboard.writeText(e),v(!0),setTimeout(()=>v(!1),2e3)}catch(t){se.error("Failed to copy to clipboard","ShareModal",t,{type:c,shareText:y})}};return H.jsx("div",{className:"social-share-overlay",onClick:t,children:H.jsxs("div",{className:"social-share-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"share-header",children:[H.jsxs("h3",{children:["Share ","collection"===c?"Collection":"template"===c?"Template":"achievement"===c?"Achievement":"NFT"]}),H.jsx("button",{className:"close-btn",onClick:t,children:H.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H.jsxs("div",{className:"share-content",children:[r&&H.jsxs("div",{className:"nft-preview share-modal-preview",children:[H.jsx("img",{src:r,alt:a,className:"nft-image"}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h4",{children:a}),n&&H.jsx("p",{children:n})]})]}),H.jsxs("div",{className:"share-text-section",children:[H.jsxs("div",{className:"share-text-header",children:[H.jsx("label",{htmlFor:"share-text",children:"Customize your message:"}),!l&&H.jsx("button",{className:"refresh-message-btn",onClick:()=>{l||C(k())},title:"Generate new random message",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),H.jsx("textarea",{id:"share-text",value:y,onChange:e=>g(e.target.value),placeholder:A,className:"share-textarea",rows:3})]}),H.jsxs("div",{className:"share-url-section",children:[H.jsx("label",{children:"Share URL:"}),H.jsxs("div",{className:"url-input-container",children:[H.jsx("input",{type:"text",value:_,readOnly:!0,className:"url-input"}),H.jsxs("button",{className:"copy-btn "+(f?"copied":""),onClick:()=>S(_),children:[f?H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):H.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),H.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),f?"Copied!":"Copy"]})]})]}),H.jsxs("div",{className:"social-buttons",children:[H.jsxs("button",{className:"social-btn twitter",onClick:()=>{const e="collection"===c?"NFTCollection,WAX,PixelJourney":"template"===c?"NFTTemplate,WAX,PixelJourney":"achievement"===c?"Achievement,Gaming,PixelJourney":"NFT,WAX,PixelJourney",t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(y||A)}&url=${encodeURIComponent(_)}&hashtags=${e}`;window.open(t,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),"Twitter"]}),H.jsxs("button",{className:"social-btn facebook",onClick:()=>{const e=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(_)}`;window.open(e,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),H.jsxs("button",{className:"social-btn reddit",onClick:()=>{const e=y||A,t=`https://reddit.com/submit?url=${encodeURIComponent(_)}&title=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),H.jsxs("button",{className:"social-btn discord",onClick:()=>{S(`${y||A}\n${_}`),w("Share text copied to clipboard! You can now paste it in Discord.","Copied to Clipboard")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})}),"Discord"]}),H.jsxs("button",{className:"social-btn telegram",onClick:()=>{const e=y||A,t=`https://t.me/share/url?url=${encodeURIComponent(_)}&text=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Telegram"]}),H.jsxs("button",{className:"social-btn email",onClick:()=>{const e=`${y||A}\n\nView it here: ${_}`,t=`mailto:?subject=${encodeURIComponent(`Check out: ${a}`)}&body=${encodeURIComponent(e)}`;window.location.href=t},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]})]}),("achievement"===c||"inventory"===c)&&u&&H.jsxs("div",{className:"share-image-section",children:[H.jsx("h4",{children:"Generate Share Image"}),H.jsxs("div",{className:"image-buttons",children:[H.jsx("button",{className:"generate-btn svg",onClick:async()=>{if(u)try{let e,t;if(N(!0),"achievement"===c&&o&&void 0!==d&&void 0!==h)e=jt(o,d,h,u),t=`${u}-achievements-${Date.now()}.svg`;else{if("inventory"!==c||!m||!p)return;e=Dt(m,p,u),t=`${u}-inventory-${Date.now()}.svg`}Ut(e,t)}catch(e){se.error("Error generating share image","ShareModal",e,{type:c,username:u})}finally{N(!1)}},disabled:b,children:b?"Generating...":"Download SVG"}),H.jsx("button",{className:"generate-btn png",onClick:async()=>{if(u)try{let e,t;if(N(!0),"achievement"===c&&o&&void 0!==d&&void 0!==h)e=jt(o,d,h,u),t=`${u}-achievements-${Date.now()}.png`;else{if("inventory"!==c||!m||!p)return;e=Dt(m,p,u),t=`${u}-inventory-${Date.now()}.png`}const a=await(e=>Bt.convertToPNG(e,void 0,void 0))(e);Ut(a,t)}catch(e){se.error("Error generating PNG share image","ShareModal",e,{type:c,username:u})}finally{N(!1)}},disabled:b,children:b?"Generating...":"Download PNG"})]})]})]})]})})},zt=new class{constructor(){t(this,"CHAT_ACCOUNT","chat.pxj"),t(this,"PXJ_CONTRACT","pixeljourney"),t(this,"PXJ_SYMBOL","PXJ"),t(this,"BASE_COST_PIXAL_HOLDER",100),t(this,"BASE_COST_NON_HOLDER",1e4),t(this,"SPONSORED_COST_PIXAL_HOLDER",1e4),t(this,"SPONSORED_COST_NON_HOLDER",25e3),t(this,"MIN_MESSAGE_COST",100),t(this,"messageCache",new Map),t(this,"userRateLimit",new Map),t(this,"blacklistedAccounts",new Set),t(this,"moderationSettings",{blacklistedAccounts:[],bannedWords:["spam","scam","hack","phishing"],trustedDomains:["wax.io","atomichub.io","wax.bloks.io","pixeljourney.io"],maxMessageLength:240,minTimeBetweenMessages:5}),t(this,"userLastMessageTime",new Map)}async calculateMessageCost(e,t,a=!1){const n=e.length,i=await this.checkPixalPFPOwnership(t);if(a){const e=i?this.SPONSORED_COST_PIXAL_HOLDER:this.SPONSORED_COST_NON_HOLDER;return{baseCost:e,characterCost:0,totalCost:e,hasPixalPFP:i,discount:i?60:0,isSponsored:!0}}const r=i?this.BASE_COST_PIXAL_HOLDER:this.BASE_COST_NON_HOLDER;let s=1;n>50&&(s=1+(n-50)/50);const l=Math.floor(r*(s-1)),c=Math.max(this.MIN_MESSAGE_COST,r+l),o=i?5e4:c;return{baseCost:r,characterCost:l,totalCost:i?Math.min(c,o):c,hasPixalPFP:i,discount:i?99:0,isSponsored:!1}}async checkPixalPFPOwnership(e){try{const t=await $e.getUserInventory(e);return!(!t||0===t.length)&&t.some(e=>"781515"===e.template_id)}catch(t){return ee.logError("ChatService.checkPixalPFPOwnership",t,{userAccount:e}),!1}}async sendMessage(e,t,a,n=!1){this.validateMessageForSending(e,t);let i=(await this.calculateMessageCost(e,t)).totalCost,r=e;n&&(i=await this.checkPixalPFPOwnership(t)?this.SPONSORED_COST_PIXAL_HOLDER:this.SPONSORED_COST_NON_HOLDER,r=`::sponsored:: ${e}`),a&&(r=`::col:${a}:: ${r}`),this.userLastMessageTime.set(t,Date.now());const s={account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.CHAT_ACCOUNT,quantity:`${i.toFixed(8)} ${this.PXJ_SYMBOL}`,memo:r}};try{const e=await Lt.transact([s]);let a=null;if(e&&(a=e.transaction_id||e.id||e.processed?.id||e.processed?.transaction_id||e.response&&e.response.transaction_id||e.transaction&&e.transaction.id),a)return this.updateRateLimit(t),this.messageCache.clear(),a;throw se.warn("Unexpected transaction result format","ChatService.sendMessage",{result:e}),new Error("Transaction completed but transaction ID not found in response")}catch(l){throw l instanceof Error&&l.message.includes("transaction ID not found")&&se.warn("Transaction may have succeeded but response format was unexpected","ChatService.sendMessage",{error:l}),ee.logError("ChatService.sendMessage",l,{messageLength:e.length}),new Error(`Failed to send message: ${l instanceof Error?l.message:"Unknown error"}`)}}async getMessages(e={},t=50,a=0){const n=JSON.stringify({filters:e,limit:t,offset:a});if(this.messageCache.has(n))return this.messageCache.get(n);try{const i=await $e.getAccountTransfers(this.CHAT_ACCOUNT,this.PXJ_CONTRACT,this.PXJ_SYMBOL,t,a);if(!i||0===i.length)return[];const r=[];for(const t of i){const a=this.parseTransferToMessage(t);a&&this.applyFilters(a,e)&&!this.isMessageBlockedByModeration(a)&&r.push(a)}return r.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),this.messageCache.set(n,r),r}catch(i){return ee.logError("ChatService.loadMessages",i),[]}}parseTransferToMessage(e){try{const t=String(e.memo||""),a=e.from,n=e.quantity,i=e.timestamp,r=e.transaction_id;if(this.blacklistedAccounts.has(a))return null;let s,l=t,c=!1,o="normal";if(t.startsWith("::sponsored::")){parseFloat(n.split(" ")[0])>=1e3?(c=!0,o="sponsored",l=t.replace("::sponsored::","").trim()):l=t.replace("::sponsored::","").trim()}const d=t.match(/::col:([^:]+)::/);return d&&(s=d[1],l=l.replace(d[0],"").trim()),parseFloat(n.split(" ")[0])>=10&&(o="premium"),{id:`${r}_${a}`,sender:a,message:l,timestamp:i,pxjAmount:n,transactionId:r,isSponsored:c,collectionTag:s,messageType:o,characterCount:l.length}}catch(t){const a=t instanceof Error?t:new Error("Failed to parse transfer to message");return ee.logError("ChatService.parseTransferToMessage",a,{transfer:e?.transaction_id||"unknown"}),null}}applyFilters(e,t){return(!t.collection||e.collectionTag===t.collection)&&(!(t.minPxjAmount&&parseFloat(e.pxjAmount.split(" ")[0])<t.minPxjAmount)&&(!(t.maxPxjAmount&&parseFloat(e.pxjAmount.split(" ")[0])>t.maxPxjAmount)&&!(t.hideSpam&&this.isSpamMessage(e)||t.showOnlySponsored&&!e.isSponsored)))}isSpamMessage(e){const t=e.message.toLowerCase();return this.moderationSettings.bannedWords.some(e=>t.includes(e))}updateRateLimit(e){const t=Date.now(),a=this.userRateLimit.get(e)||[];a.push(t),this.userRateLimit.set(e,a)}blacklistAccount(e){this.blacklistedAccounts.add(e)}unblacklistAccount(e){this.blacklistedAccounts.delete(e)}clearCache(){this.messageCache.clear()}async getUserAvatar(e){try{const t=(await $e.getUserInventory(e)).filter(e=>"pixeljourney"===e.collection&&"Pixal"===e.schema);if(t&&t.length>0){const e=t[0];if(e.traits&&e.traits.img&&"string"==typeof e.traits.img)return`${ue.IPFS.GATEWAYS[0]}${e.traits.img.startsWith("Qm"),e.traits.img}`}return`${ue.AVATAR.DICEBEAR}?seed=${e}`}catch(t){const a=t instanceof Error?t:new Error("Failed to get user avatar");return ee.logError("ChatService.getUserAvatar",a,{userAccount:e}),`${ue.AVATAR.DICEBEAR}?seed=${e}`}}validateMessageForSending(e,t){if(this.moderationSettings.blacklistedAccounts.includes(t))throw new Error("Account is blacklisted from sending messages.");if(e.length>this.moderationSettings.maxMessageLength)throw new Error(`Message too long. Maximum ${this.moderationSettings.maxMessageLength} characters allowed.`);const a=e.toLowerCase();for(const i of this.moderationSettings.bannedWords)if(a.includes(i.toLowerCase()))throw new Error("Message contains prohibited content.");const n=this.userLastMessageTime.get(t);if(n){const e=(Date.now()-n)/1e3;if(e<this.moderationSettings.minTimeBetweenMessages)throw new Error(`Please wait ${this.moderationSettings.minTimeBetweenMessages-Math.floor(e)} more seconds before sending another message.`)}this.verifyLinksInMessage(e)}isMessageBlockedByModeration(e){if(this.moderationSettings.blacklistedAccounts.includes(e.sender))return!0;const t=e.message.toLowerCase();for(const a of this.moderationSettings.bannedWords)if(t.includes(a.toLowerCase()))return!0;return!1}verifyLinksInMessage(e){const t=e.match(/(https?:\/\/[^\s]+)/g);if(t)for(const n of t)try{const e=new URL(n).hostname.toLowerCase();if(!this.moderationSettings.trustedDomains.some(t=>e===t.toLowerCase()||e.endsWith("."+t.toLowerCase())))throw new Error(`Links to ${e} are not allowed. Only trusted domains are permitted.`)}catch(a){if(a instanceof Error&&a.message.includes("not allowed"))throw a;throw new Error("Invalid URL detected in message.")}}updateModerationSettings(e){this.moderationSettings={...this.moderationSettings,...e}}getModerationSettings(){return{...this.moderationSettings}}},Ht=["strong","em","b","i","u","br","p","span"],Jt={span:["class"],p:["class"]};function qt(e){const t=document.createElement("div");return t.innerHTML=e,Vt(t),t.innerHTML}function Vt(e){const t=Array.from(e.children);for(const a of t){const e=a.tagName.toLowerCase();if(!Ht.includes(e)){const e=document.createTextNode(a.textContent||"");a.parentNode?.replaceChild(e,a);continue}const t=Jt[e]||[],n=Array.from(a.attributes);for(const i of n)t.includes(i.name)||a.removeAttribute(i.name);Vt(a)}}function Gt(e){return qt(function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}(e).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"))}const Yt=({isOpen:e,onClose:t,nft:a})=>{const{account:n,session:r}=Q(),{showSuccess:s,showError:l}=We(),c=i.useRef(null),[o,d]=i.useState([]),[h,u]=i.useState(""),[m,p]=i.useState(!1),[f,v]=i.useState(!1),[y,g]=i.useState(null),[b,N]=i.useState(!1),w=`listing:${a.sale_id||a.asset_id}`,k=i.useCallback(()=>{c.current?.scrollIntoView({behavior:"smooth"})},[]),x=i.useCallback(async(e=!1)=>{if(e||!(o.length>0)){p(!0);try{const e=await zt.getMessages({collection:w,hideSpam:!0},50);d(e)}catch(t){l("Failed to load messages")}finally{p(!1)}}},[w,o.length,l]),C=i.useCallback(async()=>{if(n&&h.trim())try{const e=await zt.calculateMessageCost(h,n);g(e)}catch(e){}else g(null)},[n,h]),A=async()=>{if(n&&h.trim()&&r)if(a.seller)if(a.seller!==r.actor?.toString()){v(!0);try{const e=`${w} :${a.seller}: ${h.trim()}`,t=await zt.sendMessage(e,n);s("Message sent!",`Transaction: ${t.substring(0,8)}...`),u(""),g(null),setTimeout(()=>{x(!0)},2e3)}catch(e){const t=e instanceof Error?e.message:"Unknown error";t.includes("transaction ID not found")?l("Message Status Unclear","Your message may have been sent successfully. Please check your transaction history or refresh the chat to confirm."):l("Failed to send message",t)}finally{v(!1)}}else l("You cannot message yourself");else l("Seller information not available");else l("Please connect your wallet to send messages")};return i.useEffect(()=>{e&&x()},[e,x]),i.useEffect(()=>{const e=setTimeout(C,300);return()=>clearTimeout(e)},[C]),i.useEffect(()=>{k()},[o,k]),i.useEffect(()=>{const a=e=>{"Escape"===e.key&&t()};if(e)return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[e,t]),e?H.jsx("div",{className:"listing-chat-modal-backdrop",onClick:t,children:H.jsxs("div",{className:"listing-chat-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"listing-chat-header",children:[H.jsx("div",{className:"listing-chat-header-left",children:H.jsxs("div",{className:"listing-info",children:[H.jsx("img",{src:a.image||"/placeholder-nft.png",alt:a.name,className:"listing-nft-image"}),H.jsxs("div",{className:"listing-details",children:[H.jsx("h3",{className:"listing-title",children:a.name}),H.jsxs("p",{className:"listing-seller",children:["Seller: ",a.seller]}),a.price&&H.jsx("p",{className:"listing-price",children:a.price})]})]})}),H.jsxs("div",{className:"listing-chat-header-right",children:[H.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>x(!0),disabled:m,title:"Refresh messages",children:H.jsx("span",{className:"chat_refresh-icon "+(m?"chat_refresh-icon--spinning":""),children:"\ud83d\udd04"})}),H.jsx("button",{className:"chat_btn chat_btn--icon",onClick:t,title:"Close chat",children:"\u2715"})]})]}),H.jsxs("div",{className:"listing-chat-messages",children:[m&&0===o.length?H.jsx("div",{className:"chat_loading",children:"Loading messages..."}):0===o.length?H.jsxs("div",{className:"chat_empty",children:[H.jsx("p",{children:"No messages yet for this listing."}),H.jsx("p",{children:"Be the first to start the conversation!"})]}):o.map(e=>H.jsxs("div",{className:`chat_message chat_message--${e.messageType||"normal"}`,children:[H.jsxs("div",{className:"chat_message-header",children:[H.jsx("div",{className:"chat_message-avatar",children:H.jsx("img",{src:`https://wax.atomichub.io/v1/accounts/${e.sender}/avatar`,alt:e.sender,className:"chat_avatar",onError:e=>{e.target.src="/default-avatar.png"}})}),H.jsxs("div",{className:"chat_message-info",children:[H.jsx("span",{className:"chat_sender",children:e.sender}),H.jsx("span",{className:"chat_timestamp",children:new Date(e.timestamp).toLocaleString()}),e.pxjAmount&&H.jsx("span",{className:"chat_amount",children:e.pxjAmount})]}),H.jsx("div",{className:"chat_message-actions",children:e.transactionId&&H.jsx("a",{href:`https://waxblock.io/transaction/${e.transactionId}`,target:"_blank",rel:"noopener noreferrer",className:"chat_tx-link",title:"View transaction",children:"\ud83d\udd17"})})]}),H.jsx("div",{className:"chat_message-content",dangerouslySetInnerHTML:{J:Gt(e.message)}})]},e.id)),H.jsx("div",{ref:c})]}),H.jsxs("div",{className:"listing-chat-input-section",children:[y&&H.jsxs("div",{className:"chat_cost-info",children:[H.jsxs("div",{className:"chat_cost-display",children:[H.jsxs("span",{children:["Message Cost: ",H.jsxs("span",{className:"chat_cost-amount",children:[(y.totalCost/1e4).toFixed(4)," PXJ"]})]}),H.jsx("button",{className:"chat_info-btn",onClick:()=>N(!b),title:"View price breakdown",children:"\u2139\ufe0f"})]}),y.hasPixalPFP&&H.jsxs("span",{className:"chat_discount",children:["Pixal PFP Discount: ",y.discount,"%"]}),H.jsxs("span",{className:"chat_char-count",children:[h.length,"/240 chars"]}),b&&H.jsx("div",{className:"chat_price-tooltip",children:H.jsxs("div",{className:"chat_price-content",children:[H.jsx("h4",{children:"Price Breakdown"}),H.jsxs("div",{className:"price-factor",children:[H.jsx("span",{children:"Base Cost:"}),H.jsxs("span",{children:[(y.baseCost/1e4).toFixed(4)," PXJ"]})]}),H.jsxs("div",{className:"price-factor",children:[H.jsxs("span",{children:["Character Cost (",h.length," chars):"]}),H.jsxs("span",{children:[((y.totalCost-y.baseCost)/1e4).toFixed(4)," PXJ"]})]}),y.hasPixalPFP&&H.jsxs("div",{className:"price-factor discount",children:[H.jsxs("span",{children:["Pixal PFP Discount (",y.discount,"%):"]}),H.jsxs("span",{children:["-",((y.baseCost+(y.totalCost-y.baseCost))*(y.discount/100)/1e4).toFixed(4)," PXJ"]})]}),H.jsxs("div",{className:"price-factor total",children:[H.jsx("span",{children:"Total:"}),H.jsxs("span",{children:[(y.totalCost/1e4).toFixed(4)," PXJ"]})]})]})})]}),H.jsxs("div",{className:"listing-chat-input-wrapper",children:[H.jsx("textarea",{className:"listing-chat-input",value:h,onChange:e=>u(e.target.value),placeholder:`Send a message about ${a.name}...`,maxLength:240,rows:3,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),A())}}),H.jsx("button",{className:"listing-chat-send-btn",onClick:A,disabled:!h.trim()||f||!n,children:f?"\u23f3":"\ud83d\udce4"})]}),!n&&H.jsx("div",{className:"listing-chat-connect-notice",children:"Please connect your wallet to send messages"})]})]})}):null},Kt=e=>{const t=ue.IPFS.GATEWAYS;return`${t[Math.floor(Math.random()*t.length)]}${e}`},Qt=e=>{if(!e)return;if(e.image&&"string"==typeof e.image)return e.image;let t;return e.data&&"object"==typeof e.data&&"img"in e.data&&(t=e.data.img),t||(t=e.template?.immutable_data?.img||e.img),t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Kt(t):t:void 0},Zt=e=>{if(!e)return null;if(e.video&&"string"==typeof e.video)return e.video;let t;return e.data&&"object"==typeof e.data&&"video"in e.data&&(t=e.data.video),t||(t=e.template?.immutable_data?.video||e.video),t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Kt(t):t:null},ea=e=>{if(!e)return;const t=e.immutable_data?.img||e.data?.img||e.img||e.template?.immutable_data?.img;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Kt(t):t:void 0},ta=e=>{if(!e)return null;const t=e.immutable_data?.video||e.data?.video||e.video||e.template?.immutable_data?.video;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Kt(t):t:null},aa=e=>{const t=e?.assets?.[0];return Qt(t)},na=e=>{const t=e?.assets?.[0];return Zt(t)},ia=({nft:e,isOpen:t,onClose:a,usdPrice:n})=>{const r=l(),{settings:s}=ke(),[c,o]=i.useState("$0.00"),[d,h]=i.useState(!1),[u,m]=i.useState(!1),[p,f]=i.useState(!1),[v,y]=i.useState(!1),[g,b]=i.useState(!1),[N,w]=i.useState(null),{isConnected:k,purchaseNFT:x,login:C}=Q(),{showSuccess:A,showError:_,showWarning:S}=We(),[P,T]=i.useState(null),[$,F]=i.useState([]),[E,I]=i.useState([]);i.useEffect(()=>{(async()=>{try{const e=Lt.getSession();w(e?{...e,actor:e.actor}:null)}catch(e){se.info("No active session","NFTDetailsModal",e)}})()},[]),i.useEffect(()=>{t&&e&&(M(),L(),W())},[t,e]);const M=async()=>{if(e?.collection)try{const t=await $e.getCollectionStats(e.collection);t&&T({floorPrice:t.floor_price||"0",volume24h:t.volume_24h||"0",totalSales:t.sales||"0",avgPrice:t.averagePrice||"0"})}catch(t){se.error("Error fetching collection stats","NFTDetailsModal",t)}},L=async()=>{if(e?.collection)try{const t=await $e.getSales({collection_name:e.collection,state:"3",limit:5,sort:"updated",order:"desc"});if(t.success&&t.data){const e=t.data.map(e=>({type:"sale",price:`${(parseFloat(e.price?.amount||"0")/Math.pow(10,e.price?.token_precision||8)).toFixed(4)} ${e.price?.token_symbol||"WAX"}`,time:new Date(1e3*parseInt(e.updated_at_time)).toLocaleString()}));F(e)}}catch(t){se.error("Error fetching recent activity","NFTDetailsModal",t)}},W=async()=>{if(e?.collection)try{const t=await $e.getCollectionPriceHistory(e.collection,"7d");I(t)}catch(t){se.error("Error fetching price history","NFTDetailsModal",t),I([])}};i.useEffect(()=>{e&&!n&&e.price&&ve.convertWaxToUSDAsync(e.price).then(o)},[e,n]),i.useEffect(()=>{(async()=>{if(e){const t=be.getCart();h(t.some(t=>t.nft.asset_id===e.asset_id));const a=await Xe.getWatchlist();m(a.some(t=>t.nft.asset_id===e.asset_id))}})()},[e]),i.useEffect(()=>{const t=()=>{if(e){const t=be.getCart();h(t.some(t=>t.nft.asset_id===e.asset_id))}};be.addListener(t);const a=Xe.subscribe(async()=>{if(e){const t=await Xe.getWatchlist();m(t.some(t=>t.nft.asset_id===e.asset_id))}});return()=>{be.removeListener(t),a()}},[e]);const R=()=>{e&&(a(),r(`/assets/${e.asset_id}`))};return t&&e?H.jsxs("div",{className:"modal-backdrop",onClick:e=>{e.target===e.currentTarget&&a()},children:[H.jsxs("div",{className:"modal-content nft-details-modal",children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{className:"modal-title",children:e.name}),H.jsx("button",{className:"modal-close",onClick:a,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsx("div",{className:"modal-body",children:H.jsx("div",{className:"nft-details-container",children:H.jsxs("div",{className:"nft-details-top",children:[H.jsx("div",{className:"nft-media-section",children:H.jsxs("div",{className:"nft-media-container",children:[H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name,className:"nft-media",controls:!0,loop:!0,muted:!0,enableAnimations:s.enableAnimatedNFTs}),(e.template_mint||e.max_supply)&&H.jsxs("div",{className:"mint-info",children:["Mint: ",void 0!==e.template_mint&&null!==e.template_mint?e.template_mint:"?"," / ","0"===e.max_supply||void 0===e.max_supply||null===e.max_supply?"\u221e":e.max_supply]})]})}),H.jsxs("div",{className:"nft-info-section",children:[H.jsxs("div",{className:"info-card",children:[H.jsx("h3",{className:"info-title",children:"Basic Information"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Collection:"}),H.jsx("span",{className:"info-value info-link",onClick:()=>{e&&(a(),r(`/collections/${e.collection}`))},title:"View collection on AtomicHub",children:e.collection})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Schema:"}),H.jsx("span",{className:"info-value info-link",onClick:()=>{e&&window.open(`https://wax.atomichub.io/explorer/schema/wax-mainnet/${e.collection}/${e.schema}`,"_blank")},title:"View schema on AtomicHub",children:e.schema})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Asset ID:"}),H.jsx("span",{className:"info-value info-link",onClick:R,title:"View asset on AtomicHub",children:e.asset_id})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Seller:"}),H.jsx("span",{className:"info-value info-link",onClick:()=>{e&&e.seller&&(a(),r(`/user-profile-lookup?user=${encodeURIComponent(e.seller)}`))},title:"View seller profile",children:e.seller})]})]})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h3",{className:"info-title",children:"Price Information"}),H.jsxs("div",{className:"price-display",children:[H.jsx("div",{className:"price-main",children:e.price}),H.jsx("div",{className:"price-usd",children:n||c})]})]}),e.traits&&Object.keys(e.traits).length>0&&H.jsxs("div",{className:"info-card",children:[H.jsx("h3",{className:"info-title",children:"Attributes"}),H.jsx("div",{className:"attributes-grid",children:(O=e.traits,Object.entries(O).filter(([e,t])=>"img"!==e&&"video"!==e&&"name"!==e&&null!=t)).map(([e,t])=>H.jsxs("div",{className:"attribute-item",children:[H.jsx("div",{className:"attribute-label",children:e}),H.jsx("div",{className:"attribute-value",children:String(t)})]},e))})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h3",{className:"info-title",children:"Statistics"}),H.jsx("div",{className:"nft-statistics",children:H.jsxs("div",{className:"stats-grid",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-label",children:"Floor Price"}),H.jsx("span",{className:"stat-value",children:P?`${parseFloat(P.floorPrice).toFixed(4)} WAX`:"Loading..."})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-label",children:"24h Volume"}),H.jsx("span",{className:"stat-value",children:P?`${parseFloat(P.volume24h).toFixed(2)} WAX`:"Loading..."})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-label",children:"Total Sales"}),H.jsx("span",{className:"stat-value",children:P?P.totalSales:"Loading..."})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-label",children:"Avg Sale Price"}),H.jsx("span",{className:"stat-value",children:P?`${parseFloat(P.avgPrice).toFixed(4)} WAX`:"Loading..."})]})]})})]})]}),H.jsx("div",{className:"nft-details-bottom",children:H.jsxs("div",{className:"info-card",children:[H.jsx("h3",{className:"info-title",children:"Price History & Activity"}),H.jsxs("div",{className:"nft-statistics",children:[H.jsxs("div",{className:"price-history-section",children:[H.jsx("h4",{className:"price-history-title",children:"Recent Price History"}),H.jsx("div",{className:"price-history-chart",children:E.length>0?H.jsxs("div",{className:"chart-placeholder",children:[H.jsxs("svg",{viewBox:"0 0 400 120",className:"price-chart",children:[[0,1,2,3,4].map(e=>H.jsx("line",{x1:"20",y1:20+20*e,x2:"380",y2:20+20*e,stroke:"var(--border-color)",strokeWidth:"1",opacity:"0.3"},`grid-${e}`)),E.length>1&&H.jsx("polyline",{fill:"none",stroke:"var(--accent-color)",strokeWidth:"2",points:E.map((e,t)=>{const a=20+t/(E.length-1)*360,n=Math.max(...E.map(e=>e.price)),i=Math.min(...E.map(e=>e.price)),r=n-i||1;return`${a},${100-(e.price-i)/r*60}`}).join(" ")}),E.map((e,t)=>{const a=20+t/(E.length-1)*360,n=Math.max(...E.map(e=>e.price)),i=Math.min(...E.map(e=>e.price)),r=n-i||1,s=100-(e.price-i)/r*60;return H.jsx("circle",{cx:a,cy:s,r:"3",fill:"var(--accent-color)"},t)})]}),H.jsxs("div",{className:"chart-labels",children:[H.jsx("span",{children:E.length>0?new Date(E[0].timestamp).toLocaleDateString():"7d ago"}),H.jsx("span",{children:E.length>0?new Date(E[E.length-1].timestamp).toLocaleDateString():"Now"})]})]}):H.jsx("div",{className:"chart-placeholder",children:H.jsx("div",{className:"loading-chart",children:"Loading price history..."})})})]}),H.jsxs("div",{className:"trading-activity",children:[H.jsx("h4",{className:"activity-title",children:"Recent Activity"}),H.jsx("div",{className:"activity-list",children:$.length>0?$.map((e,t)=>H.jsxs("div",{className:"activity-item",children:[H.jsx("span",{className:`activity-type ${e.type}`,children:"sale"===e.type?"Sale":"Listed"}),H.jsx("span",{className:"activity-price",children:e.price}),H.jsx("span",{className:"activity-time",children:e.time})]},t)):H.jsxs("div",{className:"activity-item",children:[H.jsx("span",{className:"activity-type",children:"Loading..."}),H.jsx("span",{className:"activity-price",children:"-"}),H.jsx("span",{className:"activity-time",children:"-"})]})})]})]})]})})]})})}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("div",{className:"modal-actions-left",children:e.sale_id?H.jsxs(H.Fragment,{children:[H.jsxs("button",{className:"listing-btn-buy-now",onClick:async()=>{if(!k)try{await C()}catch(t){return void se.error("Login failed","NFTDetailsModal",t)}if(e.sale_id)if(e.sale_id&&e.price)try{const t=e.price.replace(" WAX","");await x(e.sale_id,t),A("Purchase successful!"),a()}catch(t){se.error("Purchase failed","NFTDetailsModal",t),_("Purchase failed. Please try again.")}else _("NFT is not available for purchase");else S("This NFT is not for sale")},title:`Buy now for ${e.price} WAX`,children:[H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:H.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Buy Now"]}),H.jsxs("button",{className:"btn-secondary",onClick:()=>y(!0),title:"Make Offer",children:[H.jsx("svg",{viewBox:"0 -8 72 72",fill:"currentColor",style:{width:"24px",height:"24px",marginRight:"8px"},children:H.jsx("path",{d:"M64,12.78v17s-3.63.71-4.38.81-3.08.85-4.78-.78C52.22,27.25,42.93,18,42.93,18a3.54,3.54,0,0,0-4.18-.21c-2.36,1.24-5.87,3.07-7.33,3.78a3.37,3.37,0,0,1-5.06-2.64,3.44,3.44,0,0,1,2.1-3c3.33-2,10.36-6,13.29-7.52,1.78-1,3.06-1,5.51,1C50.27,12,53,14.27,53,14.27a2.75,2.75,0,0,0,2.26.43C58.63,14,64,12.78,64,12.78ZM27,41.5a3,3,0,0,0-3.55-4.09,3.07,3.07,0,0,0-.64-3,3.13,3.13,0,0,0-3-.75,3.07,3.07,0,0,0-.65-3,3.38,3.38,0,0,0-4.72.13c-1.38,1.32-2.27,3.72-1,5.14s2.64.55,3.72.3c-.3,1.07-1.2,2.07-.09,3.47s2.64.55,3.72.3c-.3,1.07-1.16,2.16-.1,3.46s2.84.61,4,.25c-.45,1.15-1.41,2.39-.18,3.79s4.08.75,5.47-.58a3.32,3.32,0,0,0,.3-4.68A3.18,3.18,0,0,0,27,41.5Zm25.35-8.82L41.62,22a3.53,3.53,0,0,0-3.77-.68c-1.5.66-3.43,1.56-4.89,2.24a8.15,8.15,0,0,1-3.29,1.1,5.59,5.59,0,0,1-3-10.34C29,12.73,34.09,10,34.09,10a6.46,6.46,0,0,0-5-2C25.67,8,18.51,12.7,18.51,12.7a5.61,5.61,0,0,1-4.93.13L8,10.89v19.4s1.59.46,3,1a6.33,6.33,0,0,1,1.56-2.47,6.17,6.17,0,0,1,8.48-.06,5.4,5.4,0,0,1,1.34,2.37,5.49,5.49,0,0,1,2.29,1.4A5.4,5.4,0,0,1,26,34.94a5.47,5.47,0,0,1,3.71,4,5.38,5.38,0,0,1,2.39,1.43,5.65,5.65,0,0,1,1.48,4.89a0,0,0,0,1,0,0s.8.9,1.29,1.39a2.46,2.46,0,0,0,3.48-3.48s2,2.48,4.28,1c2-1.4,1.69-3.06.74-4a3.19,3.19,0,0,0,4.77.13,2.45,2.45,0,0,0,.13-3.3s1.33,1.81,4,.12c1.89-1.6,1-3.43,0-4.39Z"})}),"Make Offer"]}),H.jsx("button",{className:"btn-secondary "+(d?"in-cart":""),onClick:()=>{d?be.removeFromCart(e.asset_id):be.addToCart(e)||S("Item is already in your cart!")},title:d?"Remove from cart":"Add to cart",children:H.jsxs("div",{className:"cart-icon-container",children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"cart-icon",children:[H.jsx("circle",{cx:"9",cy:"21",r:"1"}),H.jsx("circle",{cx:"20",cy:"21",r:"1"}),H.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"cart-action-icon",children:d?H.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}):H.jsxs(H.Fragment,{children:[H.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),H.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})]}):H.jsxs("button",{className:"btn-disabled",disabled:!0,children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("line",{x1:"4.93",y1:"4.93",x2:"19.07",y2:"19.07"})]}),"Not Available"]})}),H.jsxs("div",{className:"modal-actions-right",children:[H.jsx("button",{className:"btn-icon btn-external",onClick:R,title:"View full asset details page",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),H.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),e?.seller&&H.jsx("button",{className:"btn-icon btn-message",onClick:()=>{b(!0)},title:"Send Direct Message (1000 PXJ)",disabled:!N||e.seller===N?.actor,children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),H.jsx("button",{className:"btn-icon "+(u?"in-watchlist":""),onClick:async()=>{u?await Xe.removeFromWatchlist(e.asset_id):await Xe.addToWatchlist(e)||S("Item is already in your watchlist!")},title:u?"Remove from watchlist":"Add to watchlist",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:u?H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:"currentColor"}):H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),H.jsx("button",{className:"btn-icon",onClick:()=>f(!0),title:"Share",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),H.jsx("polyline",{points:"16,6 12,2 8,6"}),H.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})}),H.jsx("button",{className:"btn-icon",onClick:a,title:"Close",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]})]}),p&&H.jsx(Xt,{isOpen:p,onClose:()=>f(!1),title:e?.name||"NFT",description:`Check out this amazing NFT: ${e?.name||"Unnamed NFT"}`,imageUrl:Qt(e),shareUrl:`${window.location.origin}/assets/${e?.asset_id}`,defaultShareText:`Check out this NFT: ${e?.name||"Unnamed NFT"} on PxMarket! \ud83c\udfae\u2728 View it at market.pixeljourney.xyz`,type:"nft"}),H.jsx(Ot,{isOpen:v,onClose:()=>y(!1),nft:e}),e&&H.jsx(Yt,{isOpen:g,onClose:()=>b(!1),nft:e})]}):null;var O},ra=({isOpen:e,onClose:t,initialNFTs:a=[]})=>{const[n,r]=i.useState(a),[s,l]=i.useState(""),[c,o]=i.useState([]),[d,h]=i.useState(!1),{showWarning:u}=We(),[m,p]=i.useState({showPrice:!0,showRarity:!0,showAttributes:!0,showCollection:!0,showSeller:!0});i.useEffect(()=>{a.length>0&&r(a)},[a]);const f=e=>{if(!e)return"#666";switch(e.toLowerCase()){case"common":return"#9CA3AF";case"rare":return"#3B82F6";case"epic":return"#8B5CF6";case"legendary":return"#F59E0B";case"mythic":return"#EF4444";default:return"#666"}},v=(e,t)=>e.traits&&e.traits[t]||"N/A";return e?H.jsx("div",{className:"nft-comparison-overlay",children:H.jsxs("div",{className:"nft-comparison-modal",children:[H.jsxs("div",{className:"comparison-header",children:[H.jsx("h2",{children:"NFT Comparison Tool"}),H.jsx("button",{className:"close-btn",onClick:t,children:H.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H.jsxs("div",{className:"comparison-content",children:[H.jsxs("div",{className:"search-section",children:[H.jsxs("div",{className:"search-input-container",children:[H.jsx("input",{type:"text",placeholder:"Search NFTs to add to comparison...",value:s,onChange:e=>{l(e.target.value),(async e=>{if(e.trim()){h(!0);try{const[t,a,n]=await Promise.all([$e.getWaxRockPixals(20),$e.getFriedFactoryNFTs(20),$e.getCryptoMuffinsNFTs(20)]),i=[...t,...a,...n].filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.collection.toLowerCase().includes(e.toLowerCase()));o(i.slice(0,10))}catch(t){o([])}finally{h(!1)}}else o([])})(e.target.value)},className:"search-input"}),d&&H.jsx("div",{className:"search-loading",children:"Searching..."})]}),c.length>0&&H.jsx("div",{className:"search-results",children:c.map(e=>H.jsxs("div",{className:"search-result-item",onClick:()=>(e=>{n.length>=4?u("You can compare up to 4 NFTs at once","Comparison Limit"):n.find(t=>t.asset_id===e.asset_id)?u("This NFT is already in the comparison","Duplicate NFT"):(r([...n,e]),l(""),o([]))})(e),children:[H.jsx("img",{src:e.image,alt:e.name,className:"result-image"}),H.jsxs("div",{className:"result-info",children:[H.jsx("div",{className:"result-name",children:e.name}),H.jsx("div",{className:"result-collection",children:e.collection}),H.jsx("div",{className:"result-price",children:e.price})]})]},e.asset_id))})]}),H.jsxs("div",{className:"metrics-toggle",children:[H.jsx("h3",{children:"Show Comparison Metrics:"}),H.jsx("div",{className:"toggle-buttons",children:Object.entries(m).map(([e,t])=>H.jsx("button",{className:"toggle-btn "+(t?"active":""),onClick:()=>{return t=e,void p(e=>({...e,[t]:!e[t]}));var t},children:e.replace("show","").replace(/([A-Z])/g," $1").trim()},e))})]}),n.length>0?H.jsx("div",{className:"comparison-table",children:H.jsxs("div",{className:"comparison-grid",children:[H.jsxs("div",{className:"comparison-row header-row",children:[H.jsx("div",{className:"metric-label",children:"NFT"}),n.map(e=>H.jsx("div",{className:"nft-column",children:H.jsxs("div",{className:"nft-header",children:[H.jsx("img",{src:e.image,alt:e.name,className:"nft-image"}),H.jsxs("div",{className:"nft-info",children:[H.jsx("div",{className:"nft-name",children:e.name}),H.jsxs("div",{className:"nft-id",children:["#",e.asset_id]})]}),H.jsx("button",{className:"remove-nft-btn",onClick:()=>{return t=e.asset_id,void r(n.filter(e=>e.asset_id!==t));var t},title:"Remove from comparison",children:"\xd7"})]})},e.asset_id))]}),m.showPrice&&H.jsxs("div",{className:"comparison-row",children:[H.jsx("div",{className:"metric-label",children:"Price"}),n.map(e=>H.jsx("div",{className:"metric-value price",children:e.price},e.asset_id))]}),m.showRarity&&H.jsxs("div",{className:"comparison-row",children:[H.jsx("div",{className:"metric-label",children:"Rarity"}),n.map(e=>H.jsx("div",{className:"metric-value rarity",children:H.jsx("span",{className:"rarity-badge",style:{backgroundColor:f(String(e.traits?.rarity||"Unknown"))},children:e.traits?.rarity||"Unknown"})},e.asset_id))]}),m.showCollection&&H.jsxs("div",{className:"comparison-row",children:[H.jsx("div",{className:"metric-label",children:"Collection"}),n.map(e=>H.jsx("div",{className:"metric-value",children:e.collection},e.asset_id))]}),m.showSeller&&H.jsxs("div",{className:"comparison-row",children:[H.jsx("div",{className:"metric-label",children:"Seller"}),n.map(e=>H.jsx("div",{className:"metric-value",children:e.seller},e.asset_id))]}),m.showAttributes&&(()=>{const e=new Set;return n.forEach(t=>{t.traits&&Object.keys(t.traits).forEach(t=>{"rarity"!==t&&e.add(t)})}),Array.from(e)})().map(e=>H.jsxs("div",{className:"comparison-row",children:[H.jsx("div",{className:"metric-label",children:e}),n.map(t=>H.jsx("div",{className:"metric-value",children:v(t,e)},t.asset_id))]},e))]})}):H.jsxs("div",{className:"empty-comparison",children:[H.jsx("div",{className:"empty-icon",children:"\ud83d\udcca"}),H.jsx("h3",{children:"No NFTs to Compare"}),H.jsx("p",{children:"Search and add NFTs above to start comparing their attributes, prices, and more."})]})]})]})}):null},sa=({nft:e,isOpen:t,onClose:a})=>{const[n,r]=i.useState(!1),[s,l]=i.useState(""),{showSuccess:c}=We(),o=[`\ud83c\udfa8 Check out this amazing NFT: ${e.name} from ${e.collection}! \u2728`,`\ud83d\udd25 Discovered this incredible ${e.name} NFT! Part of the ${e.collection} collection \ud83d\ude80`,`\u2728 Look at this stunning ${e.name} from ${e.collection}! NFT art at its finest \ud83c\udfad`,`\ud83c\udf1f Found a gem! ${e.name} from the ${e.collection} collection is absolutely beautiful \ud83d\udc8e`,`\ud83c\udfaf This ${e.name} NFT caught my eye! Amazing work from ${e.collection} \ud83c\udfa8`,`\ud83d\udcab Showcasing ${e.name} - a masterpiece from ${e.collection}! \ud83d\uddbc\ufe0f`,`\ud83d\ude80 Blown away by this ${e.name} NFT! ${e.collection} never disappoints \u2b50`,`\ud83c\udfaa Step right up and see ${e.name}! Another fantastic piece from ${e.collection} \ud83c\udf8a`],d=()=>{const e=Math.floor(Math.random()*o.length);return o[e]},[h,u]=i.useState(()=>d());if(!t)return null;const m=window.location.pathname;let p=`${window.location.origin}/assets/${e.asset_id}`;m.includes("/listings/")&&(p=window.location.href);const f=async e=>{try{await navigator.clipboard.writeText(e),r(!0),setTimeout(()=>r(!1),2e3)}catch(t){se.error("Failed to copy to clipboard","SocialShare.copyToClipboard",t)}};return H.jsx("div",{className:"social-share-overlay",onClick:a,children:H.jsxs("div",{className:"social-share-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"share-header",children:[H.jsx("h3",{children:"Share NFT"}),H.jsx("button",{className:"close-btn",onClick:a,children:H.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H.jsxs("div",{className:"share-content",children:[H.jsxs("div",{className:"nft-preview",children:[H.jsx("img",{src:e.image,alt:e.name,className:"nft-image"}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h4",{children:e.name}),H.jsx("p",{children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),H.jsx("span",{className:"nft-price",children:e.price})]})]}),H.jsxs("div",{className:"share-text-section",children:[H.jsxs("div",{className:"share-text-header",children:[H.jsx("label",{htmlFor:"share-text",children:"Customize your message:"}),H.jsx("button",{className:"refresh-message-btn",onClick:()=>{u(d())},title:"Generate new random message",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),H.jsx("textarea",{id:"share-text",value:s,onChange:e=>l(e.target.value),placeholder:h,className:"share-textarea",rows:3})]}),H.jsxs("div",{className:"share-url-section",children:[H.jsx("label",{children:"Share URL:"}),H.jsxs("div",{className:"url-input-container",children:[H.jsx("input",{type:"text",value:p,readOnly:!0,className:"url-input"}),H.jsxs("button",{className:"copy-btn "+(n?"copied":""),onClick:()=>f(p),children:[n?H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):H.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),H.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),n?"Copied!":"Copy"]})]})]}),H.jsxs("div",{className:"social-buttons",children:[H.jsxs("button",{className:"social-btn twitter",onClick:()=>{const e=`https://twitter.com/intent/tweet?text=${encodeURIComponent(s||h)}&url=${encodeURIComponent(p)}&hashtags=NFT,WAX,PixelJourney`;window.open(e,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),"Twitter"]}),H.jsxs("button",{className:"social-btn facebook",onClick:()=>{const e=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(p)}`;window.open(e,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),H.jsxs("button",{className:"social-btn reddit",onClick:()=>{const e=s||h,t=`https://reddit.com/submit?url=${encodeURIComponent(p)}&title=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),H.jsxs("button",{className:"social-btn discord",onClick:()=>{f(`${s||h}\n${p}`),c("Share text copied to clipboard! You can now paste it in Discord.","Copied to Clipboard")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})}),"Discord"]}),H.jsxs("button",{className:"social-btn telegram",onClick:()=>{const e=s||h,t=`https://t.me/share/url?url=${encodeURIComponent(p)}&text=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Telegram"]}),H.jsxs("button",{className:"social-btn email",onClick:()=>{const t=`Check out this NFT: ${e.name}`,a=`${s||h}\n\nView it here: ${p}`,n=`mailto:?subject=${encodeURIComponent(t)}&body=${encodeURIComponent(a)}`;window.location.href=n},children:[H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]})]})]})]})})},la=({title:e,message:t,onRetry:a,showRetry:n=!0,error:i,errorConfig:r,errorType:s,isRetrying:l=!1,retryCount:c=0,maxRetries:o=3})=>{let d;d=r||(s?ee.getMessage(s):i?ee.formatError(i):{title:e||"Oh no! Something went wrong",message:t||"We're having trouble loading the data right now. Please try again in a moment.",action:"Try Again"});const h=e||d.title,u=t||d.message,m=l?"Retrying...":d.action||"Try Again";return H.jsx("div",{className:"error-message "+(l?"retrying":""),children:H.jsxs("div",{className:"error-content",children:[H.jsx("div",{className:"error-icon "+(l?"spinning":""),children:(()=>{if(l)return"\ud83d\udd04";switch(s){case"NETWORK_ERROR":return"\ud83d\udce1";case"TIMEOUT_ERROR":return"\u23f1\ufe0f";case"API_ERROR":return"\u26a0\ufe0f";case"LOAD_FAILED":return"\ud83d\udcc2";default:return"\ud83d\ude05"}})()}),H.jsx("h3",{className:"error-title",children:h}),H.jsx("p",{className:"error-text",children:u}),c>0&&!l&&H.jsx("div",{className:"retry-status",children:H.jsxs("span",{className:"retry-count",children:["Attempt ",c," of ",o]})}),n&&a&&H.jsxs("button",{className:"error-retry-btn "+(l?"retrying":""),onClick:a,disabled:l||c>=o,children:[l&&H.jsx("span",{className:"retry-spinner"}),m]}),c>=o&&H.jsxs("div",{className:"max-retries-reached",children:[H.jsx("p",{children:"Maximum retry attempts reached. Please refresh the page or try again later."}),H.jsx("button",{className:"error-refresh-btn",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})})},ca="pixeljourney_search_history",oa=({searchTerm:e,onSearchChange:t,suggestions:a=[],placeholder:n="Search NFTs, collections, schemas...",showFilters:r=!1,onFilterChange:s,className:l=""})=>{const[c,o]=i.useState(!1),[d,h]=i.useState([]),[u,m]=i.useState({priceRange:{min:"",max:""},rarities:[],collections:[],schemas:[],sortBy:"relevance"}),[p,f]=i.useState(!1),v=i.useRef(null),y=i.useRef(null),[g,b]=i.useState(-1);i.useEffect(()=>{const e=localStorage.getItem(ca);if(e)try{h(JSON.parse(e))}catch(t){}},[]);const N=i.useCallback(e=>{if(!e.trim()||e.length<2)return;const t=[e,...d.filter(t=>t!==e)].slice(0,10);h(t),localStorage.setItem(ca,JSON.stringify(t))},[d]),w=i.useCallback(()=>{h([]),localStorage.removeItem(ca)},[]),k=i.useCallback(e=>{t(e),b(-1),e.length>=2?o(!0):o(!1)},[t]),x=i.useCallback(()=>{e.trim()&&(N(e.trim()),o(!1),v.current?.blur())},[e,N]),C=i.useCallback(e=>{k(e.text),N(e.text),o(!1)},[k,N]),A=i.useCallback(e=>{if(!c)return;const t=[...d.map(e=>({text:e,type:"history"})),...a];switch(e.key){case"ArrowDown":e.preventDefault(),b(e=>e<t.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),b(e=>e>-1?e-1:-1);break;case"Enter":e.preventDefault(),g>=0&&t[g]?C(t[g]):x();break;case"Escape":o(!1),b(-1),v.current?.blur()}},[c,d,a,g,C,x]),_=i.useCallback(e=>{const t={...u,...e};m(t),s?.(t)},[u,s]);i.useEffect(()=>{const e=e=>{y.current&&!y.current.contains(e.target)&&v.current&&!v.current.contains(e.target)&&(o(!1),b(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const S=[...d.map(e=>({text:e,type:"history"})),...a];return H.jsxs("div",{className:`advanced-search ${l}`,children:[H.jsxs("div",{className:"search-container",children:[H.jsxs("div",{className:"search-input-wrapper",children:[H.jsx("svg",{className:"search-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),H.jsx("input",{ref:v,type:"text",value:e,onChange:e=>k(e.target.value),onKeyDown:A,onFocus:()=>{(e.length>=2||d.length>0)&&o(!0)},placeholder:n,className:"search-input","aria-label":"Search for NFTs, collections, or schemas","aria-describedby":c?"search-suggestions":void 0,"aria-expanded":c,"aria-autocomplete":"list",role:"combobox"}),e&&H.jsx("button",{className:"clear-search",onClick:()=>{k(""),o(!1)},title:"Clear search","aria-label":"Clear search input",type:"button",children:H.jsx("span",{"aria-hidden":"true",children:"\u2715"})}),r&&H.jsx("button",{className:"filter-toggle "+(p?"active":""),onClick:()=>f(!p),title:"Advanced filters","aria-label":p?"Hide advanced filters":"Show advanced filters","aria-expanded":p,type:"button",children:H.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]}),c&&S.length>0&&H.jsxs("div",{ref:y,className:"search-suggestions",id:"search-suggestions",role:"listbox","aria-label":"Search suggestions",children:[d.length>0&&H.jsxs("div",{className:"suggestions-section",children:[H.jsxs("div",{className:"suggestions-header",children:[H.jsx("span",{id:"recent-searches-label",children:"Recent searches"}),H.jsx("button",{onClick:w,className:"clear-history","aria-label":"Clear search history",type:"button",children:"Clear"})]}),H.jsx("div",{role:"group","aria-labelledby":"recent-searches-label",children:d.map((e,t)=>H.jsxs("div",{className:"suggestion-item history "+(g===t?"selected":""),onClick:()=>C({text:e,type:"history"}),role:"option","aria-selected":g===t,tabIndex:-1,children:[H.jsx("svg",{className:"suggestion-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),H.jsx("span",{children:e})]},`history-${t}`))})]}),a.length>0&&H.jsxs("div",{className:"suggestions-section",children:[d.length>0&&H.jsx("div",{className:"suggestions-divider"}),H.jsx("div",{className:"suggestions-header",children:H.jsx("span",{children:"Suggestions"})}),a.map((e,t)=>{const a=d.length+t;return H.jsxs("div",{className:`suggestion-item ${e.type} ${g===a?"selected":""}`,onClick:()=>C(e),children:[H.jsxs("svg",{className:"suggestion-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:["name"===e.type&&H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"}),"collection"===e.type&&H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}),"schema"===e.type&&H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]}),H.jsx("span",{children:e.text}),e.count&&H.jsx("span",{className:"suggestion-count",children:e.count})]},`suggestion-${t}`)})]})]})]}),r&&p&&H.jsxs("div",{className:"advanced-filters",children:[H.jsxs("div",{className:"filters-grid",children:[H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{className:"filter-label",children:"Price Range (WAX)"}),H.jsxs("div",{className:"price-range",children:[H.jsx("input",{type:"number",placeholder:"Min",value:u.priceRange.min,onChange:e=>_({priceRange:{...u.priceRange,min:e.target.value}}),className:"price-input"}),H.jsx("span",{className:"price-separator",children:"to"}),H.jsx("input",{type:"number",placeholder:"Max",value:u.priceRange.max,onChange:e=>_({priceRange:{...u.priceRange,max:e.target.value}}),className:"price-input"})]})]}),H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{className:"filter-label",children:"Sort By"}),H.jsxs("select",{value:u.sortBy,onChange:e=>_({sortBy:e.target.value}),className:"filter-select",children:[H.jsx("option",{value:"relevance",children:"Relevance"}),H.jsx("option",{value:"price_asc",children:"Price: Low to High"}),H.jsx("option",{value:"price_desc",children:"Price: High to Low"}),H.jsx("option",{value:"name_asc",children:"Name: A to Z"}),H.jsx("option",{value:"name_desc",children:"Name: Z to A"}),H.jsx("option",{value:"newest",children:"Newest First"}),H.jsx("option",{value:"oldest",children:"Oldest First"})]})]})]}),H.jsx("div",{className:"filter-actions",children:H.jsx("button",{onClick:()=>{const e={priceRange:{min:"",max:""},rarities:[],collections:[],schemas:[],sortBy:"relevance"};m(e),s?.(e)},className:"filter-reset",children:"Reset Filters"})})]})]})},da=r.memo(()=>{const e=l(),{settings:t}=ke(),{showSuccess:a,showError:n,showWarning:r}=We(),[s,c]=i.useState([]),[o,d]=i.useState("idle"),[h,u]=i.useState(""),[m,p]=i.useState("pixals"),[f,v]=i.useState({}),[y,g]=i.useState(null),[b,N]=i.useState(!1),[w,k]=i.useState(new Set),[x,C]=i.useState(new Set),[A,_]=i.useState(1),[S,P]=i.useState(1),[T,$]=i.useState([]),[F,E]=i.useState(!1),[I,M]=i.useState({min:"",max:""}),[L,W]=i.useState(new Set),[R,O]=i.useState("price_asc"),[B,j]=i.useState({start:"",end:""}),[D,U]=i.useState([]),[X,z]=i.useState([]),[J,q]=i.useState([]),[V,G]=i.useState(new Set),[Y,K]=i.useState(new Map),[Z,te]=i.useState(new Map),[ae,ne]=i.useState(new Set),[ie,re]=i.useState(new Set),[le,ce]=i.useState(!1),[oe,de]=i.useState(!1),[he,ue]=i.useState(null),[me,pe]=i.useState(!1),[fe,ye]=i.useState(null),[ge,Ne]=i.useState(!1),[we,xe]=i.useState(null),[Ce,Ae]=i.useState(!1),[_e,Se]=i.useState(new Set),[Pe,Te]=i.useState(null),[Fe,Ee]=i.useState(!1),Ie=i.useCallback(e=>{Se(t=>{const a=new Set(t);return a.has(e)?a.delete(e):(a.clear(),a.add(e)),a})},[]),Me=i.useCallback(()=>{Se(new Set)},[]),Le=i.useCallback((e,t,a)=>{const n=t||e,i=t?"video":"image";let r=n;n.startsWith("Qm")||n.startsWith("baf")?r=`https://ipfs.io/ipfs/${n}`:n.startsWith("/ipfs/")?r=`https://ipfs.io${n}`:n.startsWith("ipfs://")&&(r=n.replace("ipfs://","https://ipfs.io/ipfs/")),Te({url:r,name:a,type:i}),Ee(!0)},[]);i.useEffect(()=>{const e=()=>{Me()};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[Me]);const Re=async(e,t=1)=>{1===t?(d("loading"),_(1),$([])):ce(!0);try{let a=[];const n=50;switch(e){case"pixals":default:a=await $e.getCheapestPixals(n,t);break;case"waxrocks":a=await $e.getWaxRockPixals(n,t);break;case"ingredients":a=await $e.getPixelIngredients(n,t);break;case"bundles":a=await $e.getBundleListings(n,t);break;case"friedfactory":a=await $e.getFriedFactoryNFTs(n,t);break;case"cryptomuffins":a=await $e.getCryptoMuffinsNFTs(n,t);break;case"akufishheads":case"partners":a=await $e.getPartnerListings(n,t);break;case"pxapproved":a=await $e.getPxApprovedListings(n,t);break;case"ah_verified":a=await $e.getAHVerifiedListings(n,t);break;case"all_wax":a=await $e.getAllWaxListings(n,t)}1===t?$(a):($(e=>[...e,...a]),_(t)),a.length<n?P(t):P(t+1),d("success"),ce(!1)}catch(a){const e=a instanceof Error?a:new Error("Failed to load marketplace data");ee.logError("Marketplace.loadMarketplaceData",e,{category:m,page:t,limit:50}),d("error"),ce(!1)}},Oe=i.useCallback(async()=>{try{const e=(await $e.getCollectionSchemas("pixeljourney")).map(e=>e.schema_name);q(e)}catch(e){se.error("Failed to load available schemas","Marketplace",e),q([])}},[]);i.useEffect(()=>{Re(m),Oe()},[m,Oe]);const Be=i.useCallback(async e=>{const t={},a=e.filter(e=>e.price&&!f[e.asset_id]);if(0!==a.length){for(let e=0;e<a.length;e+=10){const n=a.slice(e,e+10);(await Promise.allSettled(n.map(async e=>{const t=await ve.convertWaxToUSDAsync(e.price);return{assetId:e.asset_id,price:t}}))).forEach(e=>{"fulfilled"===e.status&&e.value&&(t[e.value.assetId]=e.value.price)}),e+10<a.length&&await new Promise(e=>setTimeout(e,50))}v(e=>({...e,...t}))}},[]);i.useEffect(()=>{s.length>0&&Be(s)},[s,Be]);const je=i.useCallback(e=>{if(!e||e.length<2)return void U([]);const t=new Map,a=e.toLowerCase();T.forEach(e=>{if(e.name.toLowerCase().includes(a)){const a=`name:${e.name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.name,type:"name",count:1})}if(e.collection.toLowerCase().includes(a)){const a=`collection:${e.collection}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.collection,type:"collection",count:1})}});const n=Array.from(t.values()).sort((e,t)=>(t.count||0)-(e.count||0)).slice(0,8);U(n)},[T]),De=i.useCallback(e=>{M(e.priceRange),O(e.sortBy)},[]);i.useEffect(()=>{je(h)},[h,je]),i.useEffect(()=>{const e=()=>{const e=be.getCart();k(new Set(e.map(e=>e.nft.asset_id)))};return e(),be.addListener(e),()=>be.removeListener(e)},[]),i.useEffect(()=>{(async()=>{const e=await Xe.getWatchlist();re(new Set(e.map(e=>e.nft.asset_id)))})(),Xe.addListener(e=>{re(new Set(e.map(e=>e.nft.asset_id)))})},[]);const Ue=i.useCallback(()=>{A<S&&!le&&Re(m,A+1)},[m,A,S,le]),ze=()=>{E(!1)},He=i.useCallback(e=>{const t=new Set(L);if(t.has(e))t.delete(e);else{t.add(e);const a=new Set(ae);a.add("schemas"),ne(a)}W(t)},[L,ae]),Je=i.useCallback(e=>{const t=new Set(V);if(t.has(e))t.delete(e);else{t.add(e);const a=new Set(ae);a.add("collections"),ne(a)}G(t)},[V,ae]),qe=i.useCallback((e,t)=>{const a=new Map(Y),n=a.get(e)||new Set,i=new Set(n);if(i.has(t)?i.delete(t):i.add(t),i.size>0){a.set(e,i);const t=new Set(ae);t.add("attributes"),ne(t)}else a.delete(e);K(a)},[Y,ae]),Ve=i.useCallback(e=>{const t=new Set(ae);t.has(e)?t.delete(e):t.add(e),ne(t)},[ae]),Ge=i.useMemo(()=>{let e=[...T];if(h){const t=h.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.collection.toLowerCase().includes(t)||e.schema&&e.schema.toLowerCase().includes(t))}return(I.min||I.max)&&(e=e.filter(e=>{if(!e.price)return!1;const t=parseFloat(e.price),a=I.min?parseFloat(I.min):0,n=I.max?parseFloat(I.max):1/0;return t>=a&&t<=n})),L.size>0&&(e=e.filter(e=>e.schema&&L.has(e.schema))),V.size>0&&(e=e.filter(e=>V.has(e.collection))),Y.size>0&&(e=e.filter(e=>{if(!e.data||!e.data.attributes||!Array.isArray(e.data.attributes))return!1;for(const[t,a]of Y){const n=e.data.attributes.find(e=>e.key===t);if(!n||!a.has(n.value))return!1}return!0})),e.sort((e,t)=>{switch(R){case"price_asc":return parseFloat(e.price||"0")-parseFloat(t.price||"0");case"price_desc":return parseFloat(t.price||"0")-parseFloat(e.price||"0");case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"newest":return new Date(t.created_at_time||0).getTime()-new Date(e.created_at_time||0).getTime();case"oldest":return new Date(e.created_at_time||0).getTime()-new Date(t.created_at_time||0).getTime();default:return 0}}),e},[T,h,I,L,V,Y,R]);i.useEffect(()=>{c(Ge)},[Ge]),i.useEffect(()=>{const e=new Map;let t=T;V.size>0&&(t=t.filter(e=>V.has(e.collection))),L.size>0&&(t=t.filter(e=>e.schema&&L.has(e.schema))),t.forEach(t=>{t.data&&t.data.attributes&&Array.isArray(t.data.attributes)&&t.data.attributes.forEach(t=>{e.has(t.key)||e.set(t.key,[]);const a=e.get(t.key);a.includes(t.value)||a.push(t.value)})}),e.forEach((e,t)=>{e.sort()}),te(e),K(t=>{const a=new Map;return t.forEach((t,n)=>{if(e.has(n)){const i=e.get(n),r=new Set;t.forEach(e=>{i.includes(e)&&r.add(e)}),r.size>0&&a.set(n,r)}}),a})},[T,V,L]),i.useEffect(()=>{if(V.size>0){const e=[...new Set(T.filter(e=>V.has(e.collection)).map(e=>e.schema).filter(e=>e))].sort();q(e),W(t=>{const a=new Set;return t.forEach(t=>{e.includes(t)&&a.add(t)}),a})}else{const e=[...new Set(T.map(e=>e.schema).filter(e=>e))].sort();q(e)}},[T,V]);const Ye=i.useCallback(e=>{let t=[...e];return(I.min||I.max)&&(t=t.filter(e=>{if(!e.price)return!1;const t=parseFloat(e.price.replace(" WAX","")),a=I.min?parseFloat(I.min):0,n=I.max?parseFloat(I.max):1/0;return t>=a&&t<=n})),L.size>0&&(t=t.filter(e=>L.has(e.schema))),V.size>0&&(t=t.filter(e=>V.has(e.collection))),B.start||B.end,t.sort((e,t)=>{const a=e.price?parseFloat(e.price.replace(" WAX","")):0,n=t.price?parseFloat(t.price.replace(" WAX","")):0;switch(R){case"price_asc":return a-n;case"price_desc":return n-a;case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);default:return 0}}),t},[I,L,V,R]);i.useEffect(()=>{const e=Array.from(new Set(T.map(e=>e.collection)));z(e)},[T]),i.useEffect(()=>{let e=T.filter(e=>e.name.toLowerCase().includes(h.toLowerCase())||("string"==typeof e.collection?e.collection.toLowerCase():"").includes(h.toLowerCase()));e=Ye(e),c(e)},[T,h,I,L,V,B,R,Ye]);const{purchaseNFT:Ke}=Q(),Qe=i.useCallback(async e=>{try{if(!Lt.isLoggedIn())return void r("Please connect your wallet to purchase NFTs");if(se.debug("Purchasing NFT","Marketplace",{nft:e}),!e.sale_id||!e.price)return void n("Purchase Error","NFT is not available for purchase");await Ke(e.sale_id,e.price.replace(" WAX","")),a(`Successfully purchased ${e.name}!`),Re(m)}catch(t){se.error("Purchase failed","Marketplace",t instanceof Error?t:new Error(String(t))),n(`Purchase failed: ${t instanceof Error?t.message:"Unknown error"}`)}},[m,r,a,n,Re]),Ze=i.useCallback(t=>{e(`/user-profile-lookup?user=${encodeURIComponent(t)}`)},[e]),et=i.useCallback(t=>{e(`/collections/${encodeURIComponent(t)}`)},[e]),tt=i.useCallback(t=>{x.size>0?at(t.asset_id):t.sale_id?e(`/listings/${t.sale_id}`):e(`/assets/${t.asset_id}`)},[e,x.size]),at=i.useCallback(e=>{const t=new Set(x);t.has(e)?t.delete(e):t.add(e),C(t)},[x]),nt=i.useCallback(()=>{x.size===s.length?C(new Set):C(new Set(s.map(e=>e.asset_id)))},[x,s]),it=i.useCallback(()=>{s.filter(e=>x.has(e.asset_id)).forEach(e=>{w.has(e.asset_id)||be.addToCart(e)}),C(new Set)},[s,x,w]);return H.jsxs("div",{className:"marketplace",children:[H.jsxs("div",{className:"container",children:[H.jsx("div",{className:"marketplace-header",children:H.jsx("div",{className:"marketplace-header-content",children:H.jsxs("div",{className:"marketplace-header-text",children:[H.jsx("h1",{className:"marketplace-title",children:"Pixel Journey Marketplace"}),H.jsx("p",{className:"marketplace-subtitle",children:"Discover, collect, and trade unique digital assets from the Pixel Journey ecosystem. This marketplace serves all WAX users, with full market access unlocked for Pixal PFP holders."})]})})}),H.jsxs("div",{className:"marketplace-filters",children:[H.jsx(oa,{searchTerm:h,onSearchChange:u,suggestions:D,placeholder:"Search items, collections...",showFilters:!0,onFilterChange:De,className:"marketplace-search"}),H.jsxs("div",{className:"marketplace-controls",children:[H.jsxs("div",{className:"category-tabs-container",children:[H.jsx("h3",{className:"category-section-title",children:"Listings"}),H.jsx("div",{className:"category-tabs-wrapper",children:H.jsxs("div",{className:"category-tabs",children:[H.jsx("button",{className:"category-tab "+("pixals"===m?"active":""),onClick:()=>p("pixals"),"aria-label":"Filter by Pixals category","aria-pressed":"pixals"===m,children:"Pixals"}),H.jsx("button",{className:"category-tab "+("waxrocks"===m?"active":""),onClick:()=>p("waxrocks"),"aria-label":"Filter by WaxRocks category","aria-pressed":"waxrocks"===m,children:"WaxRocks"}),H.jsx("button",{className:"category-tab "+("ingredients"===m?"active":""),onClick:()=>p("ingredients"),"aria-label":"Filter by Ingredients category","aria-pressed":"ingredients"===m,children:"Ingredients"}),H.jsx("button",{className:"category-tab "+("bundles"===m?"active":""),onClick:()=>p("bundles"),"aria-label":"Filter by Bundles category","aria-pressed":"bundles"===m,children:"\ud83d\udce6 Bundles"}),H.jsxs("select",{className:"others-select",value:["friedfactory","cryptomuffins","akufishheads","partners","pxapproved","ah_verified","all_wax"].includes(m)?m:"others",onChange:e=>{const t=e.target.value;"others"!==t&&p(t)},"aria-label":"Select additional marketplace categories",children:[H.jsx("option",{value:"others",children:"Others"}),H.jsxs("optgroup",{label:"Marketplace",children:[H.jsx("option",{value:"pxapproved",children:"PxApproved"}),H.jsx("option",{value:"ah_verified",children:"All AH Verified (Pixals holders+ only)"}),H.jsx("option",{value:"all_wax",children:"All Wax Listings (Pixals holders+ only)"})]}),H.jsxs("optgroup",{label:"Partners",children:[H.jsx("option",{value:"friedfactory",children:"Fried Factory"}),H.jsx("option",{value:"cryptomuffins",children:"CryptoMuffins"}),H.jsx("option",{value:"akufishheads",children:"Aku Fish Heads"})]})]})]})})]}),H.jsxs("div",{className:"filter-sort-section",children:[H.jsx("h3",{className:"filter-sort-title",children:"Filter & Sort"}),H.jsxs("div",{className:"filter-sort-controls",children:[H.jsxs("select",{className:"sort-dropdown",value:R,onChange:e=>O(e.target.value),children:[H.jsx("option",{value:"price_asc",children:"Price: Low to High"}),H.jsx("option",{value:"price_desc",children:"Price: High to Low"}),H.jsx("option",{value:"name_asc",children:"Name: A to Z"}),H.jsx("option",{value:"name_desc",children:"Name: Z to A"}),H.jsx("option",{value:"date_newest",children:"Newest Listings"}),H.jsx("option",{value:"date_oldest",children:"Oldest Listings"})]}),H.jsx("button",{className:"filter-toggle-btn",onClick:()=>{E(!F)},title:"Advanced Filters",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]})]})]})]}),"loading"===o&&H.jsx("div",{className:"loading-grid",children:Array.from({length:8}).map((e,t)=>H.jsxs("div",{className:"nft-card loading",children:[H.jsx("div",{className:"nft-image-placeholder"}),H.jsxs("div",{className:"nft-info",children:[H.jsx("div",{className:"loading-text"}),H.jsx("div",{className:"loading-text short"})]})]},t))}),"error"===o&&H.jsx(la,{errorType:"LOAD_FAILED",onRetry:()=>Re(m),showRetry:!0}),x.size>0&&H.jsxs("div",{className:"bulk-actions-bar",children:[H.jsx("div",{className:"bulk-actions-info",children:H.jsxs("span",{children:[x.size," item",1!==x.size?"s":""," selected"]})}),H.jsxs("div",{className:"bulk-actions-buttons",children:[H.jsx("button",{className:"bulk-btn bulk-cart",onClick:it,"aria-label":`Add ${x.size} selected items to cart`,children:"Add Selected to Cart"}),H.jsxs("button",{className:"bulk-btn bulk-compare",onClick:()=>de(!0),disabled:x.size<2||x.size>4,title:x.size<2?"Select 2-4 items to compare":x.size>4?"Maximum 4 items can be compared":"Compare selected items","aria-label":`Compare ${x.size} selected items`,children:["Compare (",x.size,")"]}),H.jsx("button",{className:"bulk-btn bulk-clear",onClick:()=>C(new Set),"aria-label":"Clear all selected items",children:"Clear Selection"})]})]}),"success"===o&&s.length>0&&H.jsxs("div",{className:"select-all-container",children:[H.jsx("button",{className:"select-all-btn",onClick:nt,"aria-label":x.size===s.length?`Deselect all ${s.length} items`:`Select all ${s.length} items`,children:x.size===s.length?"Deselect All":"Select All"}),A<S&&H.jsx("button",{className:"load-more-btn load-more-top",onClick:Ue,disabled:le,"aria-label":le?"Loading more items":"Load more marketplace items",children:le?"Loading...":"Load More"})]}),"success"===o&&H.jsx("div",{className:"nft-grid",children:s.map(e=>H.jsxs("div",{className:"nft-card "+(x.has(e.asset_id)?"selected":""),children:[H.jsx("div",{className:"nft-select-checkbox",children:H.jsx("input",{type:"checkbox",checked:x.has(e.asset_id),onChange:()=>at(e.asset_id),className:"select-checkbox"})}),H.jsxs("div",{className:"nft-image-container",children:[H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),className:"nft-image",alt:e.name,autoPlay:!0,loop:!0,enableAnimations:t.enableAnimatedNFTs}),H.jsx("div",{className:"zoom-overlay",onClick:()=>Le(Qt(e)||"",Zt(e)||"",e.name||`Asset #${e.asset_id}`),title:"Click to zoom",children:H.jsxs("svg",{className:"zoom-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"11",cy:"11",r:"8"}),H.jsx("path",{d:"m21 21-4.35-4.35"}),H.jsx("path",{d:"M11 8v6M8 11h6"})]})}),(e.template_mint||void 0!==e.max_supply)&&H.jsxs("div",{className:"mint-badge",children:[void 0!==e.template_mint&&null!==e.template_mint?e.template_mint:"?","/","0"===e.max_supply||void 0===e.max_supply||null===e.max_supply?"\u221e":e.max_supply]})]}),H.jsxs("div",{className:"nft-info",children:[H.jsxs("div",{className:"nft-header",children:[H.jsx("h3",{className:"nft-name",children:H.jsx("span",{className:"asset-link",onClick:()=>tt(e),children:e.name})}),H.jsx("p",{className:"nft-collection",children:H.jsx("span",{className:"collection-link",onClick:()=>et(e.collection),children:e.collection})})]}),H.jsxs("div",{className:"nft-price-container",children:[H.jsxs("div",{className:"nft-prices-div",children:[H.jsx("div",{className:"nft-price",children:e.price}),H.jsx("div",{className:"nft-price-usd",children:f[e.asset_id]||"$0.00"})]}),e.seller&&H.jsxs("p",{className:"nft-seller",children:["\ud83e\uddd1\u200d\ud83d\udcbc ",H.jsx("span",{className:"seller-link",onClick:()=>Ze(e.seller),children:e.seller})]})]}),H.jsxs("div",{className:"nft-actions",children:[H.jsxs("div",{className:"nft-actions-row nft-actions-main",children:[H.jsxs("button",{className:"btn-buy-now",onClick:()=>Qe(e),title:"Buy now","aria-label":`Buy ${e.name} for ${e.price}`,type:"button",children:[H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:H.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Buy Now"]}),H.jsxs("button",{className:"details-btn",onClick:()=>{g(e),N(!0)},title:"View Details","aria-label":`View details for ${e.name}`,type:"button",children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[H.jsx("circle",{cx:"11",cy:"11",r:"8"}),H.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Info"]})]}),H.jsxs("div",{className:"nft-actions-row nft-actions-icons",children:[H.jsx("button",{className:"btn-cart "+(w.has(e.asset_id)?"in-cart":""),onClick:()=>{w.has(e.asset_id)?be.removeFromCart(e.asset_id):be.addToCart(e)||r("Item is already in your cart!")},title:w.has(e.asset_id)?"Remove from cart":"Add to cart","aria-label":w.has(e.asset_id)?`Remove ${e.name} from cart`:`Add ${e.name} to cart`,type:"button",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:w.has(e.asset_id)?H.jsxs(H.Fragment,{children:[H.jsx("polyline",{points:"3,6 5,6 21,6"}),H.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]}):H.jsxs(H.Fragment,{children:[H.jsx("circle",{cx:"9",cy:"21",r:"1"}),H.jsx("circle",{cx:"20",cy:"21",r:"1"}),H.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})})}),H.jsx("button",{className:"btn-make-offer",onClick:t=>{t.stopPropagation(),ye(e),Ne(!0)},title:"Offer",type:"button",children:H.jsx("svg",{viewBox:"0 -8 72 72",fill:"currentColor",children:H.jsx("path",{d:"M64,12.78v17s-3.63.71-4.38.81-3.08.85-4.78-.78C52.22,27.25,42.93,18,42.93,18a3.54,3.54,0,0,0-4.18-.21c-2.36,1.24-5.87,3.07-7.33,3.78a3.37,3.37,0,0,1-5.06-2.64,3.44,3.44,0,0,1,2.1-3c3.33-2,10.36-6,13.29-7.52,1.78-1,3.06-1,5.51,1C50.27,12,53,14.27,53,14.27a2.75,2.75,0,0,0,2.26.43C58.63,14,64,12.78,64,12.78ZM27,41.5a3,3,0,0,0-3.55-4.09,3.07,3.07,0,0,0-.64-3,3.13,3.13,0,0,0-3-.75,3.07,3.07,0,0,0-.65-3,3.38,3.38,0,0,0-4.72.13c-1.38,1.32-2.27,3.72-1,5.14s2.64.55,3.72.3c-.3,1.07-1.2,2.07-.09,3.47s2.64.55,3.72.3c-.3,1.07-1.16,2.16-.1,3.46s2.84.61,4,.25c-.45,1.15-1.41,2.39-.18,3.79s4.08.75,5.47-.58a3.32,3.32,0,0,0,.3-4.68A3.18,3.18,0,0,0,27,41.5Zm25.35-8.82L41.62,22a3.53,3.53,0,0,0-3.77-.68c-1.5.66-3.43,1.56-4.89,2.24a8.15,8.15,0,0,1-3.29,1.1,5.59,5.59,0,0,1-3-10.34C29,12.73,34.09,10,34.09,10a6.46,6.46,0,0,0-5-2C25.67,8,18.51,12.7,18.51,12.7a5.61,5.61,0,0,1-4.93.13L8,10.89v19.4s1.59.46,3,1a6.33,6.33,0,0,1,1.56-2.47,6.17,6.17,0,0,1,8.48-.06,5.4,5.4,0,0,1,1.34,2.37,5.49,5.49,0,0,1,2.29,1.4A5.4,5.4,0,0,1,26,34.94a5.47,5.47,0,0,1,3.71,4,5.38,5.38,0,0,1,2.39,1.43,5.65,5.65,0,0,1,1.48,4.89a0,0,0,0,1,0,0s.8.9,1.29,1.39a2.46,2.46,0,0,0,3.48-3.48s2,2.48,4.28,1c2-1.4,1.69-3.06.74-4a3.19,3.19,0,0,0,4.77.13,2.45,2.45,0,0,0,.13-3.3s1.33,1.81,4,.12c1.89-1.6,1-3.43,0-4.39Z"})})}),H.jsx("button",{className:"btn-message",onClick:()=>(xe(e),void Ae(!0)),title:"Send Direct Message (1000 PXJ)",disabled:!e.seller,children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),H.jsxs("div",{className:"other-actions-dropdown",children:[H.jsx("button",{className:"btn-other-actions",onClick:t=>{t.stopPropagation(),Ie(e.asset_id)},title:"More Actions",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"1"}),H.jsx("circle",{cx:"19",cy:"12",r:"1"}),H.jsx("circle",{cx:"5",cy:"12",r:"1"})]})}),H.jsxs("div",{className:"other-actions-menu "+(_e.has(e.asset_id)?"open":""),children:[H.jsxs("button",{className:"other-actions-item",onClick:t=>{t.stopPropagation(),tt(e),Me()},children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),H.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"View Full Listing"]}),H.jsxs("button",{className:"other-actions-item",onClick:t=>{t.stopPropagation(),ue(e),pe(!0),Me()},children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),H.jsx("polyline",{points:"16,6 12,2 8,6"}),H.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]}),"Share NFT"]}),H.jsxs("button",{className:"other-actions-item "+(ie.has(e.asset_id)?"in-watchlist":""),onClick:async t=>{t.stopPropagation(),ie.has(e.asset_id)?await Xe.removeFromWatchlist(e.asset_id):await Xe.addToWatchlist(e)||r("Item is already in your watchlist!"),Me()},children:[H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:ie.has(e.asset_id)?H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:"currentColor"}):H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),ie.has(e.asset_id)?"Remove from Watchlist":"Add to Watchlist"]})]})]})]})]})]})]},e.asset_id))}),"success"===o&&0===s.length&&H.jsxs("div",{className:"marketplace-empty",children:[H.jsx("svg",{className:"empty-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),H.jsx("h3",{children:"No items found"}),H.jsx("p",{children:"Try adjusting your search or filter criteria"})]}),"success"===o&&A<S&&H.jsxs("div",{className:"load-more-container",children:[H.jsx("button",{className:"load-more-btn",onClick:()=>Re(m,A+1),disabled:le,children:le?"Loading...":"Load More"}),H.jsxs("div",{className:"pagination-info",children:["Showing ",s.length," items \u2022 Loaded ",A," of ",S>A?S+"+":S," pages"]})]}),"success"===o&&A>=S&&s.length>0&&H.jsx("div",{className:"load-more-container",children:H.jsxs("div",{className:"pagination-info",children:["Showing all ",s.length," items"]})})]}),F&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"filter-sidebar-overlay",onClick:ze}),H.jsxs("div",{className:"filter-sidebar",children:[H.jsxs("div",{className:"filter-sidebar-header",children:[H.jsx("h3",{children:"Advanced Filters"}),H.jsx("button",{className:"close-sidebar-btn",onClick:ze,children:H.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H.jsxs("div",{className:"filter-section",children:[H.jsxs("div",{className:"filter-section-header",onClick:()=>Ve("collections"),children:[H.jsx("h4",{children:"Collections"}),H.jsx("button",{className:"collapse-toggle",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ae.has("collections")?"collapsed":"",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ae.has("collections")&&H.jsx("div",{className:"collection-checkboxes",children:X.slice(0,8).map(e=>H.jsxs("div",{className:"collection-item",children:[H.jsxs("label",{className:"collection-checkbox",children:[H.jsx("input",{type:"checkbox",checked:V.has(e),onChange:()=>Je(e)}),H.jsx("span",{className:"checkmark"}),e]}),H.jsx("a",{href:`/analytics/${encodeURIComponent(e)}`,className:"analytics-link",title:`View ${e} analytics`,onClick:e=>e.stopPropagation(),children:"\ud83d\udcca"})]},e))})]}),H.jsxs("div",{className:"filter-section",children:[H.jsxs("div",{className:"filter-section-header",onClick:()=>Ve("schemas"),children:[H.jsx("h4",{children:"Schema Type"}),H.jsx("button",{className:"collapse-toggle",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ae.has("schemas")?"collapsed":"",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ae.has("schemas")&&H.jsx("div",{className:"schema-checkboxes",children:J.length>0?J.map(e=>H.jsxs("label",{className:"schema-checkbox",children:[H.jsx("input",{type:"checkbox",checked:L.has(e),onChange:()=>He(e)}),H.jsx("span",{className:"checkmark"}),e.charAt(0).toUpperCase()+e.slice(1)]},e)):H.jsx("div",{className:"loading-schemas",children:"Loading schemas..."})})]}),H.jsxs("div",{className:"filter-section",children:[H.jsxs("div",{className:"filter-section-header",onClick:()=>Ve("price"),children:[H.jsx("h4",{children:"Price Range (WAX)"}),H.jsx("button",{className:"collapse-toggle",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ae.has("price")?"collapsed":"",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ae.has("price")&&H.jsxs("div",{className:"price-range-inputs",children:[H.jsx("input",{type:"number",placeholder:"Min",value:I.min,onChange:e=>M(t=>({...t,min:e.target.value})),className:"price-input"}),H.jsx("span",{children:"to"}),H.jsx("input",{type:"number",placeholder:"Max",value:I.max,onChange:e=>M(t=>({...t,max:e.target.value})),className:"price-input"})]})]}),H.jsxs("div",{className:"filter-section",children:[H.jsxs("div",{className:"filter-section-header",onClick:()=>Ve("attributes"),children:[H.jsx("h4",{children:"Attribute Filters"}),H.jsx("button",{className:"collapse-toggle",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:ae.has("attributes")?"collapsed":"",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!ae.has("attributes")&&H.jsxs("div",{className:"attribute-filters",children:[Array.from(Z.entries()).map(([e,t])=>H.jsxs("div",{className:"attribute-group",children:[H.jsx("h5",{className:"attribute-type",children:e}),H.jsx("div",{className:"attribute-values",children:t.map(t=>H.jsxs("label",{className:"attribute-checkbox",children:[H.jsx("input",{type:"checkbox",checked:Y.get(e)?.has(t)||!1,onChange:()=>qe(e,t)}),H.jsx("span",{className:"checkmark"}),t]},t))})]},e)),0===Z.size&&H.jsx("div",{className:"no-attributes",children:"No attributes available"})]})]}),H.jsxs("div",{className:"filter-section",children:[H.jsx("h4",{children:"Date Range"}),H.jsxs("div",{className:"date-range-inputs",children:[H.jsx("input",{type:"date",value:B.start,onChange:e=>j(t=>({...t,start:e.target.value})),className:"date-input",placeholder:"Start Date"}),H.jsx("span",{children:"to"}),H.jsx("input",{type:"date",value:B.end,onChange:e=>j(t=>({...t,end:e.target.value})),className:"date-input",placeholder:"End Date"})]})]}),H.jsxs("div",{className:"filter-section",children:[H.jsx("h4",{children:"Sort By"}),H.jsxs("select",{value:R,onChange:e=>O(e.target.value),className:"sort-select",children:[H.jsx("option",{value:"price_asc",children:"Price: Low to High"}),H.jsx("option",{value:"price_desc",children:"Price: High to Low"}),H.jsx("option",{value:"name_asc",children:"Name: A to Z"}),H.jsx("option",{value:"name_desc",children:"Name: Z to A"}),H.jsx("option",{value:"date_newest",children:"Newest Listings"}),H.jsx("option",{value:"date_oldest",children:"Oldest Listings"})]})]}),H.jsxs("div",{className:"filter-actions",children:[H.jsx("button",{className:"clear-filters-btn",onClick:()=>{M({min:"",max:""}),W(new Set),G(new Set),K(new Map),j({start:"",end:""}),O("price_asc")},children:"Clear All"}),H.jsx("button",{className:"apply-filters-btn",onClick:ze,children:"Apply Filters"})]})]})]}),H.jsx(ia,{nft:y,isOpen:b,onClose:()=>{N(!1),g(null)}}),H.jsx(ra,{initialNFTs:s.filter(e=>x.has(e.asset_id)),isOpen:oe,onClose:()=>de(!1)}),he&&H.jsx(sa,{nft:he,isOpen:me,onClose:()=>{pe(!1),ue(null)}}),fe&&H.jsx(Ot,{nft:fe,isOpen:ge,onClose:()=>{Ne(!1),ye(null)}}),we&&H.jsx(Yt,{nft:we,isOpen:Ce,onClose:()=>{Ae(!1),xe(null)}}),Fe&&Pe&&H.jsx("div",{className:"image-zoom-modal",onClick:()=>Ee(!1),children:H.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsx("button",{className:"zoom-modal-close",onClick:()=>Ee(!1),"aria-label":"Close zoom modal",children:"\xd7"}),"video"===Pe.type?H.jsx("video",{src:Pe.url,className:"zoom-modal-video",controls:!0,autoPlay:!0,loop:!0,muted:!0}):H.jsx("img",{src:Pe.url,alt:Pe.name,className:"zoom-modal-image"}),H.jsx("div",{className:"zoom-modal-title",children:Pe.name})]})})]})}),ha=({onPageChange:e})=>H.jsxs("div",{className:"rewards-container",children:[H.jsxs("div",{className:"rewards-header",children:[H.jsx("h1",{className:"rewards-title",children:"Trading Rewards"}),H.jsx("p",{className:"rewards-subtitle",children:"Earn PXJ tokens and Pixel Ingredients for every trade you make on Pixel Market"})]}),H.jsxs("div",{className:"rewards-content",children:[H.jsxs("div",{className:"reward-card",children:[H.jsx("div",{className:"reward-icon pxj-icon",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("path",{d:"M12 6v6l4 2"})]})}),H.jsx("h3",{className:"reward-title",children:"PXJ Token Rewards"}),H.jsx("p",{className:"reward-description",children:"Earn PXJ tokens based on your trading volume. The more you trade, the more you earn!"}),H.jsxs("ul",{className:"reward-benefits",children:[H.jsx("li",{children:"0.1% of trade value in PXJ tokens"}),H.jsx("li",{children:"Bonus multipliers for high-volume traders"}),H.jsx("li",{children:"Weekly bonus distributions"}),H.jsx("li",{children:"Governance voting rights"})]})]}),H.jsxs("div",{className:"reward-card",children:[H.jsx("div",{className:"reward-icon ingredient-icon",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),H.jsx("h3",{className:"reward-title",children:"Pixel Ingredients"}),H.jsxs("p",{className:"reward-description",children:["Collect rare Pixel Ingredients that can be used for crafting and enhancing your NFTs. ",H.jsx("strong",{children:"Available to Pixal PFP holders and Fried Factory trait holders only."})]}),H.jsxs("ul",{className:"reward-benefits",children:[H.jsx("li",{children:"Random ingredient drops with each trade"}),H.jsx("li",{children:"Rare ingredients for large transactions"}),H.jsx("li",{children:"Craft unique items and upgrades"}),H.jsx("li",{children:"Trade ingredients with other players"})]})]}),H.jsxs("div",{className:"reward-card full-width",children:[H.jsx("div",{className:"reward-icon volume-icon",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M3 3v18h18"}),H.jsx("path",{d:"M7 12l4-4 4 4 6-6"})]})}),H.jsx("h3",{className:"reward-title",children:"Volume-Based Bonuses"}),H.jsx("p",{className:"reward-description",children:"Unlock additional rewards and benefits as your trading volume increases."}),H.jsxs("div",{className:"volume-tiers",children:[H.jsxs("div",{className:"tier",children:[H.jsx("h4",{children:"Bronze Trader"}),H.jsx("p",{children:"1+ WAX volume"}),H.jsx("span",{className:"tier-bonus",children:"1x rewards"})]}),H.jsxs("div",{className:"tier",children:[H.jsx("h4",{children:"Silver Trader"}),H.jsx("p",{children:"100+ WAX volume"}),H.jsx("span",{className:"tier-bonus",children:"1.5x rewards"})]}),H.jsxs("div",{className:"tier",children:[H.jsx("h4",{children:"Gold Trader"}),H.jsx("p",{children:"1,000+ WAX volume"}),H.jsx("span",{className:"tier-bonus",children:"2x rewards"})]}),H.jsxs("div",{className:"tier",children:[H.jsx("h4",{children:"Diamond Trader"}),H.jsx("p",{children:"10,000+ WAX volume"}),H.jsx("span",{className:"tier-bonus",children:"3x rewards"})]})]})]})]}),H.jsxs("div",{className:"rewards-cta",children:[H.jsx("h3",{children:"Start Trading Today!"}),H.jsx("p",{children:"Connect your wallet and start earning rewards with every transaction."}),H.jsxs("button",{className:"cta-button",onClick:()=>e?.("marketplace"),children:[H.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),"Go to Marketplace"]})]})]}),ua=({nft:e,isOpen:t,onClose:a,onSuccess:n,bundleNfts:r=[]})=>{const[s,l]=i.useState(""),[c,o]=i.useState(!1),[d,h]=i.useState(""),[u,m]=i.useState(!1),{session:p}=Q(),{showSuccess:f,showError:v}=We(),y={symbol:"WAX",contract:"eosio.token",precision:8},g=()=>{u||(l(""),o(!1),h(""),a())};return t&&e?H.jsx("div",{className:"modal-overlay",onClick:g,children:H.jsxs("div",{className:"modal-content listing-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"List NFT for Sale"}),H.jsx("button",{className:"modal-close",onClick:g,disabled:u,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"nft-preview enhanced-preview",children:[H.jsx("div",{className:"nft-image",children:H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name||`Asset #${e.asset_id}`,className:"nft-media"})}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h3",{children:e.name}),H.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),H.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&H.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]}),c&&r.length>0&&H.jsxs("p",{className:"bundle-info",children:["+ ",r.length," additional NFT",r.length>1?"s":""]})]})]}),r.length>0&&H.jsxs("div",{className:"bundle-section",children:[H.jsx("div",{className:"bundle-toggle",children:H.jsxs("label",{className:"checkbox-label",children:[H.jsx("input",{type:"checkbox",checked:c,onChange:e=>o(e.target.checked),disabled:u}),H.jsx("span",{className:"checkmark"}),"Create Bundle with ",r.length," additional NFT",r.length>1?"s":""]})}),c&&H.jsxs("div",{className:"bundle-details",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"bundleName",children:"Bundle Name *"}),H.jsx("input",{type:"text",id:"bundleName",value:d,onChange:e=>h(e.target.value),placeholder:"Enter bundle name",disabled:u,className:"bundle-name-input"})]}),H.jsxs("div",{className:"bundle-preview",children:[H.jsx("h4",{children:"Bundle Contents:"}),H.jsxs("div",{className:"bundle-nfts",children:[H.jsxs("div",{className:"bundle-nft-item main-nft",children:[H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name||`Asset #${e.asset_id}`,className:"bundle-nft-image"}),H.jsx("span",{children:e.name})]}),r.slice(0,3).map(e=>H.jsxs("div",{className:"bundle-nft-item",children:[H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name||`Asset #${e.asset_id}`,className:"bundle-nft-image"}),H.jsx("span",{children:e.name})]},e.asset_id)),r.length>3&&H.jsxs("div",{className:"bundle-more",children:["+",r.length-3," more"]})]})]})]})]}),H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!e||!p||!s)return void v("Please fill in all required fields");if(c&&!d.trim())return void v("Please enter a bundle name");const i=parseFloat(s);if(isNaN(i)||i<=0)v("Please enter a valid price");else{m(!0);try{const t=y,s=`${i.toFixed(t.precision)} ${t.symbol}`,o=c&&r.length>0?[e.asset_id,...r.map(e=>e.asset_id)]:[e.asset_id],d={account:"atomicmarket",name:"announcesale",authorization:[{actor:p.actor,permission:p.permission}],data:{seller:p.actor,asset_ids:o,listing_price:s,settlement_symbol:`${t.precision},${t.symbol}`,maker_marketplace:"market.pxj"}};await p.transact({actions:[d]})&&(f((c?"Bundle":"NFT")+" listed successfully!"),n?.(),a(),l(""))}catch(o){se.error("Listing failed","ListingModal",o instanceof Error?o:new Error(String(o))),v(`Listing failed: ${o instanceof Error?o.message:"Unknown error"}`)}finally{m(!1)}}},className:"modal-form listing-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"price",children:"Price *"}),H.jsxs("div",{className:"price-input-group",children:[H.jsx("input",{type:"number",id:"price",value:s,onChange:e=>l(e.target.value),placeholder:"0.00",step:"0.0001",min:"0",required:!0,disabled:u,className:"price-input"}),H.jsxs("div",{className:"currency-display",children:[H.jsx("span",{className:"currency-symbol",children:y.symbol}),H.jsx("span",{className:"currency-note",children:"(AtomicMarket only supports WAX)"})]})]})]}),H.jsxs("div",{className:"listing-info",children:[H.jsxs("p",{className:"info-text",children:[H.jsx("strong",{children:"Marketplace:"})," AtomicMarket"]}),H.jsxs("p",{className:"info-text",children:[H.jsx("strong",{children:"Marketplace Fee:"})," 2%"]}),H.jsxs("p",{className:"info-text",children:[H.jsx("strong",{children:"Collection Fee:"})," Varies by collection"]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:g,disabled:u,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary",disabled:u||!s,children:u?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"spinner"}),"Listing..."]}):"List for Sale"})]})]})]})]})}):null},ma=({nft:e,isOpen:t,onClose:a,onSuccess:n})=>{const[r,s]=i.useState(""),[l,c]=i.useState(""),[o,d]=i.useState(!1),{session:h,transferNFT:u}=Q(),{showSuccess:m,showError:p}=We(),f=e=>/^[a-z1-5]{12}$/.test(e),v=()=>{o||(s(""),c(""),a())};return t&&e?H.jsx("div",{className:"modal-overlay",onClick:v,children:H.jsxs("div",{className:"modal-content transfer-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Transfer NFT"}),H.jsx("button",{className:"modal-close",onClick:v,disabled:o,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"nft-preview",children:[H.jsx("div",{className:"nft-image",children:e.video?H.jsx("video",{src:e.video.startsWith("http")?e.video:`https://ipfs.io/ipfs/${e.video}`,muted:!0,loop:!0,autoPlay:!0}):e.img?H.jsx("img",{src:e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name}):H.jsx("div",{className:"no-image",children:"No Image"})}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h3",{children:e.name}),H.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),H.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&H.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]})]})]}),H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e&&h&&r.trim())if(f(r.trim())){d(!0);try{if(!u)throw new Error("NFT transfer service is not available");await u(e.asset_id,r.trim())&&(m("Transfer Successful","NFT transferred successfully!"),n?.(),a(),s(""),c(""))}catch(i){se.error("Transfer failed","TransferModal",i),p("Transfer Failed",i instanceof Error?i.message:"Unknown error occurred")}finally{d(!1)}}else p("Invalid Account Name","Please enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)");else p("Validation Error","Please fill in all required fields")},className:"modal-form transfer-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"recipient",children:"Recipient WAX Account *"}),H.jsx("input",{type:"text",id:"recipient",value:r,onChange:e=>s(e.target.value.toLowerCase()),placeholder:"e.g. pixeljourney",maxLength:12,required:!0,disabled:o,className:"recipient-input"}),H.jsx("small",{className:"input-help",children:"Enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),H.jsx("input",{type:"text",id:"memo",value:l,onChange:e=>c(e.target.value),placeholder:"Optional transfer message",maxLength:256,disabled:o,className:"memo-input"})]}),H.jsxs("div",{className:"transfer-warning",children:[H.jsx("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),H.jsxs("div",{className:"warning-text",children:[H.jsx("strong",{children:"Warning:"})," This action cannot be undone. Make sure you trust the recipient and have entered the correct account name."]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:v,disabled:o,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary transfer-btn",disabled:o||!r.trim()||!f(r.trim()),children:o?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"spinner"}),"Transferring..."]}):"Transfer NFT"})]})]})]})]})}):null},pa=({nft:e,isOpen:t,onClose:a,onSuccess:n})=>{const[r,s]=i.useState(""),[l,c]=i.useState(!1),[o,d]=i.useState("warning"),{session:h}=Q(),{showError:u,showSuccess:m}=We(),p="BURN",f=()=>{s(""),d("warning")},v=()=>{l||(f(),a())};return t&&e?H.jsx("div",{className:"modal-overlay",onClick:v,children:H.jsxs("div",{className:"modal-content burn-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"\ud83d\udd25 Burn NFT"}),H.jsx("button",{className:"modal-close",onClick:v,disabled:l,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"nft-preview",children:[H.jsx("div",{className:"nft-image",children:e.video?H.jsx("video",{src:e.video.startsWith("http")?e.video:`https://ipfs.io/ipfs/${e.video}`,muted:!0,loop:!0,autoPlay:!0}):e.img?H.jsx("img",{src:e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name}):H.jsx("div",{className:"no-image",children:"No Image"})}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h3",{children:e.name}),H.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),H.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&H.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]})]})]}),"warning"===o&&H.jsxs("div",{className:"burn-warning-step",children:[H.jsxs("div",{className:"danger-warning",children:[H.jsx("div",{className:"warning-icon",children:"\ud83d\udea8"}),H.jsxs("div",{className:"warning-content",children:[H.jsx("h3",{children:"PERMANENT ACTION WARNING"}),H.jsxs("ul",{className:"warning-list",children:[H.jsxs("li",{children:["This action will ",H.jsx("strong",{children:"permanently destroy"})," your NFT"]}),H.jsxs("li",{children:["The NFT will be ",H.jsx("strong",{children:"completely removed"})," from the blockchain"]}),H.jsxs("li",{children:["This action ",H.jsx("strong",{children:"cannot be undone or reversed"})]}),H.jsxs("li",{children:["You will ",H.jsx("strong",{children:"not receive any compensation"})]}),H.jsxs("li",{children:["The NFT will ",H.jsx("strong",{children:"disappear forever"})]})]})]})]}),H.jsxs("div",{className:"burn-reasons",children:[H.jsx("h4",{children:"Common reasons for burning NFTs:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Reducing supply to increase rarity"}),H.jsx("li",{children:"Participating in burn-to-earn mechanics"}),H.jsx("li",{children:"Collection cleanup or rebranding"}),H.jsx("li",{children:"Accidental duplicate mints"})]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:v,children:"Cancel"}),H.jsx("button",{type:"button",className:"btn-danger",onClick:()=>{d("confirm")},children:"I Understand, Proceed"})]})]}),"confirm"===o&&H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e&&h){if(me.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&me.isValidWaxRock(t))return void u(`This is a rare WaxRock Pixal PFP (${t}) and cannot be burned. WaxRock Pixals are protected from burning and recycling on our platform.`,"Protected NFT",8e3)}if(r.toUpperCase()===p){c(!0);try{const t={account:"atomicassets",name:"burnasset",authorization:[{actor:h.actor,permission:h.permission}],data:{asset_owner:h.actor,asset_id:e.asset_id}};await h.transact({actions:[t]})&&(m("NFT burned successfully!","Burn Complete"),n?.(),a(),f())}catch(i){se.error("Burn failed","BurnModal",i),u(`Burn failed: ${i instanceof Error?i.message:"Unknown error"}`,"Burn Failed")}finally{c(!1)}}else u(`Please type "${p}" to confirm`,"Confirmation Required")}else u("Session error. Please try again.","Connection Error")},className:"modal-form burn-confirm-step",children:[H.jsxs("div",{className:"final-warning",children:[H.jsx("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),H.jsxs("p",{children:[H.jsx("strong",{children:"FINAL WARNING:"})," You are about to permanently destroy this NFT. This action cannot be undone."]})]}),H.jsxs("div",{className:"form-group",children:[H.jsxs("label",{htmlFor:"confirmText",children:["Type ",H.jsxs("strong",{children:['"',p,'"']})," to confirm:"]}),H.jsx("input",{type:"text",id:"confirmText",value:r,onChange:e=>s(e.target.value),placeholder:`Type "${p}" here`,required:!0,disabled:l,className:"confirm-input",autoComplete:"off"})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d("warning"),disabled:l,children:"Back"}),H.jsx("button",{type:"submit",className:"btn-danger burn-btn",disabled:l||r.toUpperCase()!==p,children:l?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"spinner"}),"Burning..."]}):"\ud83d\udd25 Burn NFT Forever"})]})]})]})]})}):null},fa=({nfts:e,isOpen:t,onClose:a,onSuccess:n})=>{const[r,s]=i.useState({}),[l,c]=i.useState(""),[o,d]=i.useState(!1),[h,u]=i.useState(0),[m,p]=i.useState({}),[f,v]=i.useState(!1),[y,g]=i.useState(!0),[b,N]=i.useState("name_asc"),{session:w}=Q(),{showSuccess:k,showError:x}=We(),C=(e,t)=>{s(a=>({...a,[e]:t}))},A=i.useCallback(async()=>{if(!e.length||!t)return;v(!0);const a={},n=async(e,t=3)=>{try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),n=await fetch(e,{signal:t.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(a),!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);return await n.json()}catch(a){if(t>0&&a instanceof Error&&!a.name.includes("AbortError"))return se.warn(`Retrying API call (${3-t+1}/3)`,"BulkListingModal.fetchWithRetry",{error:a.message,url:e}),await new Promise(e=>setTimeout(e,1e3*(3-t+1))),n(e,t-1);throw a}};try{const t=e.reduce((e,t)=>{const a=t.collection.collection_name;return e[a]||(e[a]=[]),e[a].push(t),e},{}),l=Object.entries(t);let c=0;for(const[e,o]of l){try{const t=`${$e.atomicMarketAPI}/atomicmarket/v1/sales?state=3&collection_name=${e}&limit=100&order=desc&sort=updated`;let s=null;try{s=await n(t)}catch(i){se.error(`Primary API failed for ${e}, trying fallback:`,"BulkListingModal.fetchPriceSuggestions",i);try{const t=`${$e.atomicMarketAPI}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=50&order=desc`;s=await n(t,1)}catch(r){se.error(`Fallback API also failed for ${e}:`,"BulkListingModal.fetchPriceSuggestions",r),_(o,a);continue}}if((e=>"object"==typeof e&&null!==e&&"success"in e&&"data"in e&&Array.isArray(e.data))(s)&&s.success&&s.data.length>0){const e=s.data.filter(e=>e.price?.amount).map(e=>{const t=parseFloat(e.price.amount),a=e.price.token_precision||8;return t/Math.pow(10,a)}).filter(e=>e>0&&e<1e4);if(e.length>0){const t=e.sort((e,t)=>e-t),n=Math.floor(.25*t.length),i=Math.floor(.75*t.length),r=t[i]-t[n],s=t[n]-1.5*r,l=t[i]+1.5*r,d=t.filter(e=>e>=s&&e<=l);if(d.length>0){const e=Math.min(...d),t=d.reduce((e,t)=>e+t,0)/d.length,n=d[Math.floor(d.length/2)];let i,r;i=d.length>=10?Math.max(1.03*e,.98*n):Math.max(1.05*e,.95*t),r=d.length>=20?"high":d.length>=10?"medium":"low",o.forEach(n=>{a[n.asset_id]={floorPrice:e,averagePrice:t,suggestedPrice:i,confidence:r,sampleSize:d.length}}),c++}else _(o,a)}else _(o,a)}else _(o,a)}catch(s){se.error(`Failed to process collection ${e}:`,"BulkListingModal.fetchPriceSuggestions",s),_(o,a)}l.indexOf([e,o])<l.length-1&&await new Promise(e=>setTimeout(e,500))}0===c?x("Price Analysis","Unable to fetch current market data. Using default pricing suggestions."):c<l.length&&se.warn(`Price data available for ${c}/${l.length} collections`),p(a)}catch(s){se.error("Error fetching price suggestions:","BulkListingModal.fetchPriceSuggestions",s),x("Price Analysis Failed","Unable to analyze market prices. Please set prices manually."),e.forEach(e=>{a[e.asset_id]={floorPrice:1,averagePrice:2,suggestedPrice:1.5,confidence:"low",sampleSize:0}}),p(a)}finally{v(!1)}},[e,t,x]),_=(e,t)=>{e.forEach(e=>{t[e.asset_id]={floorPrice:1,averagePrice:2,suggestedPrice:1.5,confidence:"low",sampleSize:0}})};i.useEffect(()=>{t&&e.length>0&&A()},[t,e,A]);const S=i.useMemo(()=>{const t=[...e];switch(b){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));case"price_asc":return t.sort((e,t)=>parseFloat(r[e.asset_id]||"0")-parseFloat(r[t.asset_id]||"0"));case"price_desc":return t.sort((e,t)=>{const a=parseFloat(r[e.asset_id]||"0");return parseFloat(r[t.asset_id]||"0")-a});default:return t}},[e,b,r]);i.useEffect(()=>{y&&e.length>0&&A()},[y,e,A]);const P=()=>e.reduce((e,t)=>{const a=parseFloat(r[t.asset_id]||"0");return e+(isNaN(a)?0:a)},0);return t?H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal-content bulk-listing-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Bulk List NFTs"}),H.jsx("button",{className:"modal-close",onClick:a,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"listing-summary",children:[H.jsx("h3",{children:"Listing Summary"}),H.jsxs("p",{children:["You are about to list ",H.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})]}),H.jsxs("p",{className:"total-value",children:["Total Value: ",H.jsx("strong",{children:ae(P())})]})]}),H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!w||0===e.length)return void x("Validation Error","Please connect your wallet and select NFTs to list");const i=e.filter(e=>{const t=r[e.asset_id];return!t||isNaN(parseFloat(t))||parseFloat(t)<=0});if(i.length>0)x("Invalid Prices",`Please set valid prices for all NFTs. ${i.length} NFT(s) have invalid prices.`);else{d(!0),u(0);try{const t=e.map(e=>{const t=`${parseFloat(r[e.asset_id]).toFixed(8)} WAX`;return{account:"atomicmarket",name:"announcesale",authorization:[{actor:w.actor,permission:w.permission}],data:{seller:w.actor,asset_ids:[e.asset_id],listing_price:t,settlement_symbol:"8,WAX",maker_marketplace:"market.pxj"}}}),i=5,l=[];for(let e=0;e<t.length;e+=i)l.push(t.slice(e,e+i));let o=0;for(const e of l)await w.transact({actions:e})&&(o++,u(o/l.length*100));k("Listing Successful",`Successfully listed ${e.length} NFT(s) on the marketplace!`),n?.(),a(),s({}),c("")}catch(l){se.error("Bulk listing failed:","BulkListingModal.handleSubmit",l),x("Listing Failed",l instanceof Error?l.message:"Unknown error occurred")}finally{d(!1),u(0)}}},className:"listing-form",children:[H.jsxs("div",{className:"smart-pricing-section",children:[H.jsxs("div",{className:"pricing-header",children:[H.jsx("h4",{children:"Smart Pricing Tools"}),H.jsx("button",{type:"button",className:"toggle-suggestions",onClick:()=>g(!y),children:y?"\ud83d\udcca Hide Analysis":"\ud83d\udcca Show Analysis"})]}),y&&H.jsx("div",{className:"price-analysis",children:f?H.jsxs("div",{className:"loading-suggestions",children:[H.jsx("div",{className:"spinner"}),H.jsx("span",{children:"Analyzing market data..."})]}):H.jsxs("div",{className:"suggestion-controls",children:[H.jsx("button",{type:"button",className:"btn-suggestion suggested",onClick:()=>{const t={};e.forEach(e=>{const a=m[e.asset_id];a&&(t[e.asset_id]=ne(a.suggestedPrice,4))}),s(t)},disabled:o||0===Object.keys(m).length,title:"Apply AI-recommended prices based on market analysis",children:"\ud83c\udfaf Apply Suggested Prices"}),H.jsx("button",{type:"button",className:"btn-suggestion floor",onClick:()=>{const t={};e.forEach(e=>{const a=m[e.asset_id];a&&(t[e.asset_id]=ne(.99*a.floorPrice,4))}),s(t)},disabled:o||0===Object.keys(m).length,title:"Price 1% below current floor prices for quick sales",children:"\u26a1 Quick Sale (Floor -1%)"})]})}),H.jsxs("div",{className:"bulk-price-controls",children:[H.jsx("h5",{children:"Manual Bulk Pricing"}),H.jsxs("div",{className:"bulk-input-group",children:[H.jsx("input",{type:"number",value:l,onChange:e=>c(e.target.value),placeholder:"Set same price for all",step:"0.0001",min:"0",disabled:o}),H.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{if(!l)return;const t={};e.forEach(e=>{t[e.asset_id]=l}),s(t)},disabled:!l||o,children:"Apply to All"})]})]})]}),H.jsxs("div",{className:"nft-pricing-list",children:[H.jsxs("div",{className:"pricing-header",children:[H.jsx("h4",{children:"Individual Pricing"}),e.length>1&&H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"nft-sort",children:"Sort by:"}),H.jsxs("select",{id:"nft-sort",className:"sort-select",value:b,onChange:e=>N(e.target.value),children:[H.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),H.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),H.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),H.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),H.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),H.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"}),H.jsx("option",{value:"price_asc",children:"Price (Low-High)"}),H.jsx("option",{value:"price_desc",children:"Price (High-Low)"})]})]})]}),H.jsx("div",{className:"bulk-listing-pricing-list-container",children:S.map(e=>{const t=m[e.asset_id];return H.jsxs("div",{className:"bulk-listing-nft-pricing-item",children:[H.jsxs("div",{className:"bulk-listing-nft-info",children:[H.jsx("div",{className:"bulk-listing-nft-image",children:H.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}})}),H.jsxs("div",{className:"bulk-listing-nft-details",children:[H.jsx("span",{className:"bulk-listing-nft-name",children:e.name}),H.jsx("span",{className:"bulk-listing-nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),e.mint_number&&H.jsxs("span",{className:"bulk-listing-nft-mint",children:["#",e.mint_number]}),t&&H.jsxs("div",{className:"bulk-listing-price-suggestions",children:[H.jsxs("div",{className:"bulk-listing-suggestion-row",children:[H.jsx("span",{className:"bulk-listing-suggestion-label",children:"Floor:"}),H.jsx("span",{className:"bulk-listing-suggestion-value",children:ae(t.floorPrice)})]}),H.jsxs("div",{className:"bulk-listing-suggestion-row",children:[H.jsx("span",{className:"bulk-listing-suggestion-label",children:"Avg:"}),H.jsx("span",{className:"bulk-listing-suggestion-value",children:ae(t.averagePrice)})]}),H.jsxs("div",{className:"bulk-listing-suggestion-row",children:[H.jsx("span",{className:"bulk-listing-suggestion-label",children:"Suggested:"}),H.jsx("span",{className:`bulk-listing-suggestion-value confidence-${t.confidence}`,children:ae(t.suggestedPrice)}),H.jsx("span",{className:"bulk-listing-confidence-badge",children:t.confidence})]}),H.jsxs("div",{className:"bulk-listing-sample-size",children:["Based on ",t.sampleSize," recent sales"]})]})]})]}),H.jsxs("div",{className:"bulk-listing-price-input-section",children:[H.jsxs("div",{className:"bulk-listing-price-input",children:[H.jsx("input",{type:"number",value:r[e.asset_id]||"",onChange:t=>C(e.asset_id,t.target.value),placeholder:"Price in WAX",step:"0.0001",min:"0",required:!0,disabled:o}),H.jsx("span",{className:"currency-label",children:"WAX"})]}),t&&H.jsxs("div",{className:"bulk-listing-quick-price-buttons",children:[H.jsx("button",{type:"button",className:"bulk-listing-quick-price-btn suggested",onClick:()=>C(e.asset_id,ne(t.suggestedPrice,4)),disabled:o,title:"Use suggested price",children:"\ud83d\udca1"}),H.jsx("button",{type:"button",className:"bulk-listing-quick-price-btn floor",onClick:()=>C(e.asset_id,ne(.99*t.floorPrice,4)),disabled:o,title:"Use floor price -1%",children:"\u26a1"})]})]})]},e.asset_id)})})]}),o&&H.jsxs("div",{className:"listing-progress",children:[H.jsx("div",{className:"progress-bar",children:H.jsx("div",{className:"progress-fill",style:{width:`${h}%`}})}),H.jsxs("p",{children:["Listing NFTs... ",Math.round(h),"% complete"]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:o,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary",disabled:o||0===P(),children:o?"Listing...":`List ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},va=({nfts:e,isOpen:t,onClose:a,onSuccess:n})=>{const[r,s]=i.useState(""),[l,c]=i.useState(""),[o,d]=i.useState(!1),[h,u]=i.useState(0),[m,p]=i.useState("name_asc"),{session:f,bulkTransferNFT:v}=Q(),{showError:y,showSuccess:g}=We(),b=i.useMemo(()=>{const t=[...e];switch(m){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));default:return t}},[e,m]);return t?H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal-content bulk-transfer-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Bulk Transfer NFTs"}),H.jsx("button",{className:"modal-close",onClick:a,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"transfer-summary",children:[H.jsx("h3",{children:"Transfer Summary"}),H.jsxs("p",{children:["You are about to transfer ",H.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})]}),H.jsxs("div",{className:"collection-breakdown",children:[H.jsx("h4",{children:"Collection Breakdown"}),Object.entries(e.reduce((e,t)=>{const a=t.collection.collection_name;return e[a]=(e[a]||0)+1,e},{})).map(([e,t])=>H.jsxs("div",{className:"collection-item",children:[H.jsx("span",{className:"collection-name",children:e}),H.jsxs("span",{className:"collection-count",children:[t," NFT",1!==t?"s":""]})]},e))]}),H.jsxs("div",{className:"rarity-breakdown",children:[H.jsx("h4",{children:"Rarity Distribution"}),Object.entries(e.reduce((e,t)=>{const a=t.template?.immutable_data?.rarity||t.data?.rarity||"Unknown";return e[a.toString()]=(e[a.toString()]||0)+1,e},{})).map(([e,t])=>H.jsxs("div",{className:"rarity-item",children:[H.jsx("span",{className:"rarity-name",children:e}),H.jsx("span",{className:"rarity-count",children:t})]},e))]}),H.jsxs("div",{className:"nft-preview-section",children:[H.jsxs("div",{className:"preview-header",children:[H.jsx("h4",{children:"NFT Preview"}),e.length>1&&H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"transfer-sort",children:"Sort by:"}),H.jsxs("select",{id:"transfer-sort",className:"sort-select",value:m,onChange:e=>p(e.target.value),children:[H.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),H.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),H.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),H.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),H.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),H.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),H.jsxs("div",{className:"nft-preview-list",children:[b.slice(0,5).map(e=>H.jsxs("div",{className:"nft-preview-item",children:[H.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),H.jsx("div",{className:"nft-info-bulk",children:H.jsxs("div",{className:"nft-details",children:[H.jsx("span",{className:"nft-name",children:e.name}),H.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),H.jsxs("span",{className:"nft-mint",children:["#",e.mint_number||"N/A"]}),H.jsxs("span",{className:"nft-id",children:["ID: ",e.asset_id]})]})})]},e.asset_id)),e.length>5&&H.jsxs("div",{className:"nft-preview-more",children:["+",e.length-5," more NFTs"]})]})]})]}),H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!f||!r.trim()||0===e.length)return void y("Please fill in all required fields","Validation Error");const i=r.trim().toLowerCase();if(i.length<1||i.length>12)y("Account name must be between 1 and 12 characters","Validation Error");else if(/^[a-z1-5.]+$/.test(i)){d(!0),u(0);try{if(!v)throw se.error("bulkTransferNFT service not available","BulkTransferModal"),new Error("Bulk transfer service not available");const t=e.map(e=>e.asset_id);await v(i,t,l||"Bulk transfer from PxMarket"),u(100),g(`Successfully transferred ${e.length} NFT(s) to ${i}!`,"Transfer Complete"),n?.(),a(),s(""),c("")}catch(o){se.error("Bulk transfer failed","BulkTransferModal.handleSubmit",o,{nftCount:e.length,recipient:r}),y(`Transfer failed: ${o instanceof Error?o.message:"Unknown error"}`,"Transfer Failed")}finally{d(!1),u(0)}}else y("Account name can only contain lowercase letters, numbers 1-5, and dots","Validation Error")},className:"transfer-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"recipient",children:"Recipient Account *"}),H.jsx("input",{type:"text",id:"recipient",value:r,onChange:e=>s(e.target.value),placeholder:"Enter WAX account name",required:!0,disabled:o,maxLength:12}),H.jsx("small",{className:"form-help",children:"Enter a valid WAX account name (1-12 characters, lowercase letters, numbers 1-5, dots)"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),H.jsx("input",{type:"text",id:"memo",value:l,onChange:e=>c(e.target.value),placeholder:"Optional transfer memo",disabled:o,maxLength:256})]}),o&&H.jsxs("div",{className:"transfer-progress",children:[H.jsx("div",{className:"progress-bar",children:H.jsx("div",{className:"progress-fill",style:{width:`${h}%`}})}),H.jsxs("p",{children:["Transferring... ",Math.round(h),"% complete"]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:o,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary",disabled:o||!r.trim(),children:o?"Transferring...":`Transfer ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},ya=({nfts:e,isOpen:t,onClose:a,onSuccess:n})=>{const[s,l]=i.useState(()=>e.map(e=>({nft:e,recipient:""}))),[c,o]=i.useState(""),[d,h]=i.useState(""),[u,m]=i.useState(!1),[p,f]=i.useState(0),[v,y]=i.useState(10),[g,b]=i.useState("name_asc"),{session:N}=Q(),{showSuccess:w,showError:k}=We(),x=i.useMemo(()=>{const e=[...s];switch(g){case"name_asc":return e.sort((e,t)=>(e.nft.name||"").localeCompare(t.nft.name||""));case"name_desc":return e.sort((e,t)=>(t.nft.name||"").localeCompare(e.nft.name||""));case"collection_asc":return e.sort((e,t)=>e.nft.collection.collection_name.localeCompare(t.nft.collection.collection_name));case"collection_desc":return e.sort((e,t)=>t.nft.collection.collection_name.localeCompare(e.nft.collection.collection_name));case"mint_asc":return e.sort((e,t)=>(e.nft.mint_number||0)-(t.nft.mint_number||0));case"mint_desc":return e.sort((e,t)=>(t.nft.mint_number||0)-(e.nft.mint_number||0));default:return e}},[s,g]);if(r.useEffect(()=>{l(e.map(e=>({nft:e,recipient:""})))},[e]),!t)return null;const C=s.filter(e=>e.recipient.trim()),A=C.length===s.length;return H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal-content distribute-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Distribute NFTs"}),H.jsx("button",{className:"modal-close",onClick:a,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"distribute-summary",children:[H.jsx("h3",{children:"Distribution Summary"}),H.jsxs("p",{children:["You are about to distribute ",H.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})," to individual recipients"]}),H.jsxs("div",{className:"bulk-addresses-section",children:[H.jsx("h4",{children:"Bulk Address Input"}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"bulk-addresses",children:"Comma-separated addresses (optional)"}),H.jsx("textarea",{id:"bulk-addresses",className:"form-control",value:c,onChange:e=>(e=>{if(o(e),e.trim()){const t=e.split(",").map(e=>e.trim()).filter(e=>e);t.length>0&&l(e=>e.map((e,a)=>({...e,recipient:t[a%t.length]||""})))}})(e.target.value),placeholder:"pixeljourney,market.pxj,council.pxj",rows:3}),H.jsxs("div",{className:"bulk-actions",children:[H.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{if(!c.trim())return void k("No addresses provided","Please enter comma-separated addresses first");const e=c.split(",").map(e=>e.trim()).filter(e=>e);0!==e.length?l(t=>t.map(t=>({...t,recipient:e[Math.floor(Math.random()*e.length)]}))):k("Invalid addresses","Please provide valid comma-separated addresses")},disabled:!c.trim(),children:"\ud83c\udfb2 Randomize Distribution"}),H.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(e=>e.map(e=>({...e,recipient:""}))),o("")},children:"\ud83d\uddd1\ufe0f Clear All"})]})]})]}),H.jsxs("div",{className:"batch-config",children:[H.jsx("h4",{children:"Transaction Settings"}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"batch-size",children:"NFTs per transaction (5-200)"}),H.jsx("input",{type:"number",id:"batch-size",className:"form-control",value:v,onChange:e=>y(Math.max(5,Math.min(200,parseInt(e.target.value)||10))),min:5,max:200}),H.jsx("small",{children:"Larger batches are more efficient but may fail if too large"})]})]})]}),H.jsxs("div",{className:"distribution-list",children:[H.jsxs("div",{className:"distribution-header",children:[H.jsxs("h4",{children:["Individual Recipients (",C.length,"/",s.length," configured)"]}),e.length>1&&H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"distribute-sort",children:"Sort by:"}),H.jsxs("select",{id:"distribute-sort",className:"sort-select",value:g,onChange:e=>b(e.target.value),children:[H.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),H.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),H.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),H.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),H.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),H.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),H.jsx("div",{className:"distribution-items",children:x.map(({nft:e,recipient:t})=>H.jsxs("div",{className:"distribution-item",children:[H.jsxs("div",{className:"nft-preview",children:[H.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),H.jsxs("div",{className:"nft-info",children:[H.jsx("span",{className:"nft-name",children:e.name}),H.jsx("span",{className:"nft-collection",children:e.collection.collection_name}),H.jsxs("span",{className:"nft-mint",children:["#",e.mint_number||"N/A"]})]})]}),H.jsx("div",{className:"recipient-input",children:H.jsx("input",{type:"text",className:"form-control",value:t,onChange:t=>((e,t)=>{l(a=>a.map(a=>a.nft.asset_id===e?{...a,recipient:t}:a))})(e.asset_id,t.target.value),placeholder:"Recipient account name"})})]},e.asset_id))})]}),H.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!N)return void k("Wallet Required","Please connect your wallet first");const t=s.filter(e=>!e.recipient.trim());if(t.length>0)k("Missing Recipients",`Please specify recipients for all ${t.length} NFT(s)`);else{m(!0),f(0);try{const e=s.length;let t=0;for(let a=0;a<s.length;a+=v){const n=s.slice(a,a+v),i=n.map(({nft:e,recipient:t})=>({account:"atomicassets",name:"transfer",authorization:[{actor:N.actor.toString(),permission:"active"}],data:{from:N.actor.toString(),to:t.trim(),asset_ids:[e.asset_id],memo:d||"Distributed via PxMarket"}})),r=await N.transact({actions:i},{expireSeconds:30});t+=n.length,f(t/e*100),se.info("Batch distribution completed","DistributeModal",{batchSize:n.length,completed:t,total:e,transactionId:r.transaction})}w("Distribution Complete",`Successfully distributed ${e} NFT${1!==e?"s":""}`),n?.(),a()}catch(i){se.error("Distribution failed","DistributeModal",i),k("Distribution Failed",i instanceof Error?i.message:"Unknown error occurred")}finally{m(!1),f(0)}}},className:"distribute-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"memo",children:"Memo (optional)"}),H.jsx("input",{type:"text",id:"memo",className:"form-control",value:d,onChange:e=>h(e.target.value),placeholder:"Optional transfer memo",maxLength:256})]}),u&&H.jsxs("div",{className:"progress-container",children:[H.jsx("div",{className:"progress-bar",children:H.jsx("div",{className:"progress-fill",style:{width:`${p}%`}})}),H.jsxs("p",{children:["Distributing NFTs... ",Math.round(p),"%"]})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"button",className:"btn btn-secondary",onClick:a,disabled:u,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u||!A,children:u?"Distributing...":`Distribute ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})})},ga=({nfts:e,isOpen:t,onClose:a,onSuccess:n})=>{const[r,s]=i.useState(!1),[l,c]=i.useState(0),[o,d]=i.useState(""),{session:h}=Q(),{showError:u,showSuccess:m,showWarning:p}=We();return t?H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal-content bulk-burn-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Bulk Burn NFTs"}),H.jsx("button",{className:"modal-close",onClick:a,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"burn-warning",children:[H.jsx("div",{className:"warning-icon",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),H.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),H.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),H.jsx("h3",{children:"\u26a0\ufe0f Warning: This action cannot be undone!"}),H.jsxs("p",{children:["You are about to permanently burn ",H.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]}),". This will completely destroy these assets and they cannot be recovered."]})]}),H.jsxs("div",{className:"nfts-to-burn",children:[H.jsx("h4",{children:"NFTs to be burned:"}),H.jsx("div",{className:"burn-list-container",children:e.map(e=>H.jsxs("div",{className:"burn-nft-item",children:[H.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),H.jsxs("div",{className:"nft-details",children:[H.jsx("span",{className:"nft-name",children:e.name}),H.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),e.mint_number&&H.jsxs("span",{className:"nft-mint",children:["#",e.mint_number]}),H.jsxs("span",{className:"nft-id",children:["ID: ",e.asset_id]})]})]},e.asset_id))})]}),H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!h||0===e.length)return void u("Please connect your wallet and select NFTs to burn","Wallet Required");const i=[],r=e.filter(e=>{if(me.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&me.isValidWaxRock(t))return i.push(e),!1}return!0});if(i.length>0){const e=i.map(e=>`${e.name} (${e.data?.WaxRock})`).join(", ");if(p(`${i.length} WaxRock Pixal PFP(s) were excluded from burning for protection: ${e}. WaxRock Pixals are protected from burning and recycling on our platform.`,"Protected NFTs Excluded",8e3),0===r.length)return void u("No NFTs remaining to burn after excluding WaxRock Pixals.","No Burnable NFTs")}if("BURN"===o){s(!0),c(0);try{const e=r.map(e=>({account:"atomicassets",name:"burnasset",authorization:[{actor:h.actor,permission:h.permission}],data:{asset_owner:h.actor,asset_id:e.asset_id}})),t=10,i=[];for(let a=0;a<e.length;a+=t)i.push(e.slice(a,a+t));let s=0;for(const a of i)await h.transact({actions:a})&&(s++,c(s/i.length*100));m(`Successfully burned ${r.length} NFT(s)!`,"Burn Complete"),n?.(),a(),d("")}catch(l){se.error("Bulk burn failed","BulkBurnModal.handleSubmit",l,{nftCount:r.length}),u(`Burn failed: ${l instanceof Error?l.message:"Unknown error"}`,"Burn Failed")}finally{s(!1),c(0)}}else u('Please type "BURN" to confirm this action',"Confirmation Required")},className:"burn-form",children:[H.jsxs("div",{className:"confirmation-section",children:[H.jsxs("label",{htmlFor:"confirmText",children:["Type ",H.jsx("strong",{children:'"BURN"'})," to confirm this action:"]}),H.jsx("input",{id:"confirmText",type:"text",value:o,onChange:e=>d(e.target.value.toUpperCase()),placeholder:"Type BURN to confirm",disabled:r,required:!0})]}),r&&H.jsxs("div",{className:"burn-progress",children:[H.jsx("div",{className:"progress-bar",children:H.jsx("div",{className:"progress-fill",style:{width:`${l}%`}})}),H.jsxs("p",{children:["Burning NFTs... ",Math.round(l),"% complete"]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:a,disabled:r,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-danger",disabled:r||"BURN"!==o,children:r?"Burning...":`\ud83d\udd25 Burn ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},ba=[{id:781515,pxj:1,wuf:22,pxjUpgrade:0,name:"Pixal PFP",type:"pixals"},{id:820134,pxj:2.22,wuf:5,pxjUpgrade:0,name:"Pixel Ingredient Pack",type:"pixelpack"},{id:858568,pxj:142,wuf:142,pxjUpgrade:0,name:"Black (Primary)",type:"primary"},{id:858569,pxj:.42,wuf:1,pxjUpgrade:0,name:"Blue (Primary)",type:"primary"},{id:858570,pxj:.42,wuf:1,pxjUpgrade:0,name:"Red (Primary)",type:"primary"},{id:858571,pxj:.42,wuf:1,pxjUpgrade:0,name:"Yellow (Primary)",type:"primary"},{id:858572,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Green (Secondary)",type:"secondary"},{id:858573,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Orange (Secondary)",type:"secondary"},{id:858574,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Purple (Secondary)",type:"secondary"},{id:858575,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Amber (Tertiary)",type:"tertiary"},{id:858576,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Chartreuse (Tertiary)",type:"tertiary"},{id:858577,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Violet (Tertiary)",type:"tertiary"},{id:858578,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Teal (Tertiary)",type:"tertiary"},{id:858580,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Vermillion (Tertiary)",type:"tertiary"},{id:859273,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Magenta (Tertiary)",type:"tertiary"}],Na=[{id:"craft_green",name:"Green (Secondary)",description:"Craft Green from Yellow + Blue + 25,000 PXJ",resultTemplateId:858572,ingredients:[{templateId:858571,quantity:1,name:"Yellow (Primary)"},{templateId:858569,quantity:1,name:"Blue (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_orange",name:"Orange (Secondary)",description:"Craft Orange from Red + Yellow + 25,000 PXJ",resultTemplateId:858573,ingredients:[{templateId:858570,quantity:1,name:"Red (Primary)"},{templateId:858571,quantity:1,name:"Yellow (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_purple",name:"Purple (Secondary)",description:"Craft Purple from Red + Blue + 25,000 PXJ",resultTemplateId:858574,ingredients:[{templateId:858570,quantity:1,name:"Red (Primary)"},{templateId:858569,quantity:1,name:"Blue (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_amber",name:"Amber (Tertiary)",description:"Craft Amber from Orange + Green + 150,000 PXJ",resultTemplateId:858575,ingredients:[{templateId:858573,quantity:1,name:"Orange (Secondary)"},{templateId:858572,quantity:1,name:"Green (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_chartreuse",name:"Chartreuse (Tertiary)",description:"Craft Chartreuse from Green + Purple + 150,000 PXJ",resultTemplateId:858576,ingredients:[{templateId:858572,quantity:1,name:"Green (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_violet",name:"Violet (Tertiary)",description:"Craft Violet from Purple + Orange + 150,000 PXJ",resultTemplateId:858577,ingredients:[{templateId:858574,quantity:1,name:"Purple (Secondary)"},{templateId:858573,quantity:1,name:"Orange (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_teal",name:"Teal (Tertiary)",description:"Craft Teal from Green + Purple + 150,000 PXJ",resultTemplateId:858578,ingredients:[{templateId:858572,quantity:1,name:"Green (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_vermillion",name:"Vermillion (Tertiary)",description:"Craft Vermillion from Orange + Purple + 150,000 PXJ",resultTemplateId:858580,ingredients:[{templateId:858573,quantity:1,name:"Orange (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_magenta",name:"Magenta (Tertiary)",description:"Craft Magenta from Purple + Orange + 150,000 PXJ",resultTemplateId:859273,ingredients:[{templateId:858574,quantity:1,name:"Purple (Secondary)"},{templateId:858573,quantity:1,name:"Orange (Secondary)"}],pxjCost:15e4,tier:"tertiary"}],wa=e=>ba.find(t=>t.id===e),ka=new class{constructor(){t(this,"cache",[]),t(this,"balanceCache",{pxj:0,wuf:0}),t(this,"lastFetch",0),t(this,"CACHE_DURATION",3e4),t(this,"virtualLibrary",new Map),t(this,"virtualLibraryTimestamp",new Map),t(this,"VIRTUAL_LIBRARY_CACHE_DURATION",3e5),t(this,"backgroundLoadingPromises",new Map),t(this,"isBackgroundLoading",new Set)}async fetchInventory(e){const t=Date.now();if(this.cache.length>0&&t-this.lastFetch<this.CACHE_DURATION)return this.cache;try{const a=await fetch(`${$e.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&burned=false&limit=1000&page=1&order=desc&sort=asset_id`);if(!a.ok)throw new Error(`Failed to fetch inventory: ${a.statusText}`);const n=(await a.json()).data||[],i=new Map;for(const e of n){const t=parseInt(e.template.template_id),a=ba.find(e=>e.id===t);a&&["primary","secondary","tertiary"].includes(a.type)&&(i.has(t)||i.set(t,{templateId:t,name:a.name,assetIds:[],tier:a.type}),i.get(t).assetIds.push(e.asset_id))}return this.cache=Array.from(i.values()).map(e=>({...e,quantity:e.assetIds.length})),this.lastFetch=t,this.cache}catch(a){return ee.logError("InventoryService.fetchInventory",a,{account:e}),this.cache=[],[]}}async fetchBalances(e){try{let a=0,n=0;try{const t=await $e.getWaxCurrencyBalance(e,"pixeljourney","PXJ");t&&t.length>0&&(a=parseFloat(t[0].balance.split(" ")[0]))}catch(t){ee.logError("InventoryService.getPXJBalance",t,{account:e})}try{const t=await $e.getWaxCurrencyBalance(e,"wuffi","WUF");t&&t.length>0&&(n=parseFloat(t[0].balance.split(" ")[0]))}catch(t){ee.logError("InventoryService.getWUFBalance",t,{account:e})}return this.balanceCache={pxj:a,wuf:n},this.balanceCache}catch(t){ee.logError("InventoryService.fetchBalances",t,{account:e});const a={pxj:0,wuf:0};return this.balanceCache=a,a}}getIngredientQuantity(e){const t=this.cache.find(t=>t.templateId===e);return t?t.quantity:0}getIngredientAssetIds(e,t){const a=this.cache.find(t=>t.templateId===e);return!a||a.quantity<t?[]:a.assetIds.slice(0,t)}canCraftRecipe(e,t){for(const a of e)if(this.getIngredientQuantity(a.templateId)<a.quantity)return!1;return!(this.balanceCache.pxj<t)}getMaxCraftableQuantity(e,t){let a=1/0;for(const i of e){const e=this.getIngredientQuantity(i.templateId),t=i.quantity,n=Math.floor(e/t);a=Math.min(a,n)}const n=Math.floor(this.balanceCache.pxj/t);return Math.min(a,n)}updateInventoryAfterCraft(e,t){for(const a of e){const e=this.cache.find(e=>e.templateId===a.templateId);e&&(e.quantity=Math.max(0,e.quantity-a.quantity),e.assetIds=e.assetIds.slice(a.quantity))}this.balanceCache.pxj=Math.max(0,this.balanceCache.pxj-t)}async startBackgroundInventoryLoad(e){if(!e||this.isBackgroundLoading.has(e))return;const t=this.virtualLibraryTimestamp.get(e)||0;if(!(Date.now()-t<this.VIRTUAL_LIBRARY_CACHE_DURATION)){this.isBackgroundLoading.add(e);try{se.debug(`Starting background inventory load for ${e}`,"InventoryService.startBackgroundInventoryLoad");const t=this.loadFullInventoryInBackground(e);this.backgroundLoadingPromises.set(e,t),await t,se.info(`Background inventory load completed for ${e}`,"InventoryService.startBackgroundInventoryLoad")}catch(a){ee.logError("InventoryService.startBackgroundInventoryLoad",a,{account:e})}finally{this.isBackgroundLoading.delete(e),this.backgroundLoadingPromises.delete(e)}}}convertNFTAssetToInventoryNFT(e){return{asset_id:e.asset_id,name:e.name,img:e.image,video:e.video,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:e.max_supply||"0",immutable_data:{img:e.image,video:e.video}},data:{...e.traits,rarity:e.rarity},mint_number:e.template_mint}}async loadFullInventoryInBackground(e){const t=[];let a=1,n=!0;for(;n;)try{const i=await $e.getUserInventoryWithFilter(e,a,100,"all");if(i&&i.assets&&i.assets.length>0){const e=i.assets.map(e=>this.convertNFTAssetToInventoryNFT(e));t.push(...e),n=i.hasMore,a++,await new Promise(e=>setTimeout(e,100))}else n=!1}catch(i){ee.logError("InventoryService.loadFullInventoryInBackground",i,{account:e,page:a}),n=!1}this.virtualLibrary.set(e,t),this.virtualLibraryTimestamp.set(e,Date.now()),se.info(`Loaded ${t.length} NFTs into virtual library for ${e}`,"InventoryService.loadFullInventoryInBackground")}async getInventoryPage(e,t,a=50){const n=this.virtualLibrary.get(e),i=this.virtualLibraryTimestamp.get(e)||0,r=Date.now();if(n&&r-i<this.VIRTUAL_LIBRARY_CACHE_DURATION){const e=(t-1)*a,i=e+a;return{data:n.slice(e,i),hasMore:i<n.length,totalCount:n.length}}try{const n=await $e.getUserInventoryWithFilter(e,t,a,"all");return{data:n?.assets?n.assets.map(e=>this.convertNFTAssetToInventoryNFT(e)):[],hasMore:n?.hasMore||!1,totalCount:n?.total||0}}catch(s){return ee.logError("InventoryService.getInventoryPage",s,{account:e,page:t,limit:a}),{data:[],hasMore:!1,totalCount:0}}}isBackgroundLoadingInProgress(e){return this.isBackgroundLoading.has(e)}getVirtualLibraryStats(e){return{itemCount:this.virtualLibrary.get(e)?.length||0,lastUpdate:this.virtualLibraryTimestamp.get(e)||null,isLoading:this.isBackgroundLoading.has(e)}}clearCache(){this.cache=[],this.balanceCache={pxj:0,wuf:0},this.lastFetch=0}clearVirtualLibrary(e){e?(this.virtualLibrary.delete(e),this.virtualLibraryTimestamp.delete(e),this.isBackgroundLoading.delete(e),this.backgroundLoadingPromises.delete(e)):(this.virtualLibrary.clear(),this.virtualLibraryTimestamp.clear(),this.isBackgroundLoading.clear(),this.backgroundLoadingPromises.clear())}getCachedInventory(){return this.cache}getCachedBalances(){return this.balanceCache}},xa=({isOpen:e,onClose:t,ingredient:a})=>{const{account:n,session:r,transferTokens:s,executeCraftingTransaction:l}=Q();ke();const{showError:o,showSuccess:d,showWarning:h}=We(),[u,m]=i.useState("craft"),[p,f]=i.useState(null),[v,y]=i.useState([]),[g,b]=i.useState(!1),[N,w]=i.useState([]),[k,x]=i.useState({pxj:0,wuf:0}),[C,A]=i.useState(!1),[_,S]=i.useState(1),[P,T]=i.useState(0),[$,F]=i.useState("name_asc"),E=i.useCallback(async()=>{if(n){A(!0);try{const[e,t]=await Promise.all([ka.fetchInventory(n),ka.fetchBalances(n)]);w(e),x(t)}catch(e){o("Failed to load inventory data",e instanceof Error?e.message:"Unknown error")}finally{A(!1)}}else o("Wallet Required","Please connect your wallet first")},[n,o]);i.useEffect(()=>{e&&n&&E()},[e,n,E]);const I=e=>{const t=N.find(t=>t.templateId===e);return t?t.quantity:0},M=e=>{if(!e)return 0;let t=1/0;for(const n of e.ingredients){const e=I(n.templateId),a=n.quantity,i=Math.floor(e/a);t=Math.min(t,i)}const a=Math.floor(k.pxj/e.pxjCost);return Math.min(t,a)};i.useEffect(()=>{if(p){const e=M(p);T(e),S(Math.min(_,e))}},[p,N,k.pxj,M,_]);const L=i.useMemo(()=>{const e=[...N];switch($){case"name_asc":return e.sort((e,t)=>e.name.localeCompare(t.name));case"name_desc":return e.sort((e,t)=>t.name.localeCompare(e.name));case"quantity_asc":return e.sort((e,t)=>e.quantity-t.quantity);case"quantity_desc":return e.sort((e,t)=>t.quantity-e.quantity);case"type_asc":return e.sort((e,t)=>{const a=wa(e.templateId),n=wa(t.templateId),i=a?.type||"Unknown",r=n?.type||"Unknown";return i.localeCompare(r)});case"type_desc":return e.sort((e,t)=>{const a=wa(e.templateId),n=wa(t.templateId),i=a?.type||"Unknown";return(n?.type||"Unknown").localeCompare(i)});default:return e}},[N,$]),W=(e,t=1)=>{for(const n of e.ingredients)if(I(n.templateId)<n.quantity*t)return!1;const a=e.pxjCost*t;return!(k.pxj<a)},R=async()=>{if(!a||!n||!r)return void o("Missing Requirements","Ingredient and wallet connection required for upgrading");const e="template"in a?a.template?.template_id:a.id,i=wa("string"==typeof e?parseInt(e):e);if(i&&0!==i.pxjUpgrade)if(k.pxj<i.pxjUpgrade)o("Insufficient PXJ",`You need ${i.pxjUpgrade.toLocaleString()} PXJ to upgrade this ingredient`);else{b(!0);try{if(!s)return void o("Upgrade Error","Transfer service not available");await s("upgradepool",i.pxjUpgrade.toString(),"PXJ",`Upgrade ${i.name}`)&&(d("Upgrade Complete!",`Successfully upgraded ${i.name}`),E(),t())}catch(l){o("Upgrade Failed",l instanceof Error?l.message:"Unknown error occurred")}finally{b(!1)}}else o("Cannot Upgrade","This ingredient cannot be upgraded")};return e?c.createPortal(H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"crafting-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Pixel Ingredient Crafting"}),H.jsx("button",{className:"close-btn",onClick:t,children:"\xd7"})]}),H.jsxs("div",{className:"modal-tabs",children:[H.jsx("button",{className:"tab-btn "+("craft"===u?"active":""),onClick:()=>m("craft"),children:"Craft New"}),H.jsx("button",{className:"tab-btn "+("upgrade"===u?"active":""),onClick:()=>m("upgrade"),disabled:!a,children:"Upgrade Existing"})]}),H.jsx("div",{className:"modal-content",children:"craft"===u?H.jsxs("div",{className:"craft-tab",children:[H.jsxs("div",{className:"craft-layout",children:[H.jsxs("div",{className:"recipe-selection",children:[H.jsx("h3",{children:"Select Recipe"}),H.jsxs("div",{className:"recipe-categories",children:[H.jsxs("div",{className:"recipe-category",children:[H.jsx("h4",{children:"Secondary Ingredients"}),Na.filter(e=>"secondary"===e.tier).map(e=>H.jsxs("div",{className:`recipe-item ${p?.id===e.id?"selected":""} ${W(e)?"":"disabled"}`,onClick:()=>f(e),children:[H.jsx("div",{className:"recipe-name",children:e.name}),H.jsxs("div",{className:"recipe-cost",children:[e.pxjCost.toLocaleString()," PXJ"]}),H.jsx("div",{className:"recipe-ingredients",children:e.ingredients.map((e,t)=>H.jsxs("span",{className:I(e.templateId)>=e.quantity?"available":"unavailable",children:[e.name," (",I(e.templateId),"/",e.quantity,")"]},t))})]},e.id))]}),H.jsxs("div",{className:"recipe-category",children:[H.jsx("h4",{children:"Tertiary Ingredients"}),Na.filter(e=>"tertiary"===e.tier).map(e=>H.jsxs("div",{className:`recipe-item ${p?.id===e.id?"selected":""} ${W(e)?"":"disabled"}`,onClick:()=>f(e),children:[H.jsx("div",{className:"recipe-name",children:e.name}),H.jsxs("div",{className:"recipe-cost",children:[e.pxjCost.toLocaleString()," PXJ"]}),H.jsx("div",{className:"recipe-ingredients",children:e.ingredients.map((e,t)=>H.jsxs("span",{className:I(e.templateId)>=e.quantity?"available":"unavailable",children:[e.name," (",I(e.templateId),"/",e.quantity,")"]},t))})]},e.id))]})]})]}),H.jsxs("div",{className:"craft-controls",children:[p&&H.jsxs("div",{className:"selected-recipe",children:[H.jsx("h3",{children:p.name}),H.jsx("p",{children:p.description}),H.jsxs("div",{className:"quantity-controls",children:[H.jsx("label",{children:"Quantity:"}),H.jsxs("div",{className:"quantity-input",children:[H.jsx("button",{onClick:()=>S(Math.max(1,_-1)),disabled:_<=1,children:"-"}),H.jsx("input",{type:"number",value:_,onChange:e=>S(Math.min(P,Math.max(1,parseInt(e.target.value)||1))),min:"1",max:P}),H.jsx("button",{onClick:()=>S(Math.min(P,_+1)),disabled:_>=P,children:"+"})]}),H.jsxs("span",{className:"max-craftable",children:["Max: ",P]})]}),H.jsx("div",{className:"total-cost",children:H.jsxs("strong",{children:["Total Cost: ",(p.pxjCost*_).toLocaleString()," PXJ"]})}),H.jsx("button",{className:"add-to-queue-btn",onClick:()=>{if(!p||_<=0)return;if(!W(p,_))return void h("Insufficient Resources","You don't have enough ingredients or PXJ for this craft.");const e=v.findIndex(e=>e.recipe.id===p.id);if(e>=0){const t=[...v];t[e].quantity+=_,y(t)}else y([...v,{recipe:p,quantity:_}]);d("Added to Queue",`Added ${_}x ${p.name} to crafting queue`),S(1)},disabled:!W(p,_)||_<=0,children:"Add to Queue"})]}),H.jsxs("div",{className:"inventory-section",children:[H.jsxs("div",{className:"inventory-header",children:[H.jsx("h3",{children:"Your Inventory"}),!C&&N.length>0&&H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"inventory-sort",children:"Sort by:"}),H.jsxs("select",{id:"inventory-sort",className:"sort-select",value:$,onChange:e=>F(e.target.value),children:[H.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),H.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),H.jsx("option",{value:"quantity_asc",children:"Quantity (Low-High)"}),H.jsx("option",{value:"quantity_desc",children:"Quantity (High-Low)"}),H.jsx("option",{value:"type_asc",children:"Type (A-Z)"}),H.jsx("option",{value:"type_desc",children:"Type (Z-A)"})]})]})]}),C?H.jsxs("div",{className:"loading-inventory",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("span",{children:"Loading inventory..."})]}):H.jsx("div",{className:"inventory-grid",children:0===L.length?H.jsx("div",{className:"no-inventory",children:H.jsxs("div",{className:"empty-state",children:[H.jsx("span",{children:"No ingredients found"}),H.jsx("button",{className:"refresh-btn",onClick:E,disabled:C,children:"Refresh Inventory"})]})}):L.map(e=>{const t=wa(e.templateId);return H.jsxs("div",{className:"inventory-item",children:[H.jsx("div",{className:"item-name",children:e.name}),H.jsxs("div",{className:"item-quantity",children:["Qty: ",e.quantity]}),H.jsx("div",{className:"item-tier",children:t?.type||"Unknown"})]},e.templateId)})})]})]})]}),H.jsxs("div",{className:"crafting-queue",children:[H.jsxs("div",{className:"queue-header",children:[H.jsxs("h3",{children:["Crafting Queue (",v.length,")"]}),v.length>0&&H.jsx("button",{className:"clear-queue-btn",onClick:()=>{y([])},children:"Clear All"})]}),v.length>0?H.jsxs("div",{className:"queue-items",children:[v.map((e,t)=>H.jsxs("div",{className:"queue-item",children:[H.jsxs("div",{className:"queue-item-info",children:[H.jsx("span",{className:"item-name",children:e.recipe.name}),H.jsxs("span",{className:"item-quantity",children:["x",e.quantity]}),H.jsxs("span",{className:"item-cost",children:[(e.recipe.pxjCost*e.quantity).toLocaleString()," PXJ"]})]}),H.jsx("button",{className:"remove-item-btn",onClick:()=>{return t=e.recipe.id,void y(v.filter(e=>e.recipe.id!==t));var t},children:"Remove"})]},t)),H.jsx("div",{className:"queue-total",children:H.jsxs("strong",{children:["Total: ",v.reduce((e,t)=>e+t.recipe.pxjCost*t.quantity,0).toLocaleString()," PXJ"]})}),H.jsx("button",{className:"execute-queue-btn",onClick:async()=>{if(0===v.length)return void h("Empty Queue","No items in crafting queue");if(!n||!r)return void o("Wallet Required","Please connect your wallet to craft ingredients");if(g)return;b(!0);let e=0;try{for(const t of v){const{recipe:n,quantity:i}=t,r=[];let s=!0;for(const e of n.ingredients){const t=e.quantity*i,a=ka.getIngredientAssetIds(e.templateId,t);if(a.length<t){o("Insufficient Ingredients",`Not enough ${e.name} available`),s=!1;break}r.push({templateId:e.templateId,assetIds:a})}if(s)try{if(!l){o("Crafting Error","Crafting service not available");continue}const t={recipe:n.id,quantity:i,ingredientAssets:r,pxjCost:n.pxjCost};if(await l(t)){e++;const t=n.ingredients.map(e=>({templateId:e.templateId,quantity:e.quantity*i}));ka.updateInventoryAfterCraft(t,n.pxjCost*i),d("Craft Successful!",`Successfully crafted ${i}x ${n.name}`)}else o("Craft Failed",`Failed to craft ${n.name}`)}catch(a){o("Craft Failed",a instanceof Error?a.message:"Unknown crafting error")}}e>0&&(d("Crafting Complete!",`Successfully crafted ${e} recipe(s)`),y([]),E(),t())}catch(i){o("Crafting Failed",i instanceof Error?i.message:"Unknown error occurred")}finally{b(!1)}},disabled:g,children:g?"Crafting...":"Craft All"})]}):H.jsx("div",{className:"empty-queue",children:H.jsx("p",{children:"No items in queue. Select a recipe and add it to start crafting."})})]})]}):H.jsx("div",{className:"upgrade-tab",children:a?H.jsx("div",{className:"upgrade-content",children:H.jsxs("div",{className:"ingredient-info",children:[H.jsxs("h3",{children:["Upgrade: ",a.name]}),H.jsxs("p",{children:["Template ID: ","template"in a?a.template?.template_id:a.id]}),(()=>{const e="template"in a?a.template?.template_id:a.id,t=wa("string"==typeof e?parseInt(e):e);return t?0===t.pxjUpgrade?H.jsx("p",{className:"no-upgrade",children:"This ingredient cannot be upgraded."}):H.jsxs("div",{className:"upgrade-details",children:[H.jsx("div",{className:"upgrade-cost",children:H.jsxs("strong",{children:["Upgrade Cost: ",t.pxjUpgrade.toLocaleString()," PXJ"]})}),H.jsxs("div",{className:"balance-info",children:["Your PXJ Balance: ",k.pxj.toLocaleString()]}),H.jsx("button",{className:"upgrade-btn",onClick:R,disabled:g||k.pxj<t.pxjUpgrade,children:g?"Upgrading...":"Upgrade Ingredient"})]}):H.jsx("p",{children:"Template not found"})})()]})}):H.jsx("div",{className:"no-ingredient",children:H.jsx("p",{children:"No ingredient selected for upgrade. Please select an ingredient from your inventory."})})})}),H.jsx("div",{className:"modal-footer",children:H.jsx("div",{className:"resource-display",children:H.jsx("div",{className:"pxj-balance",children:H.jsxs("strong",{children:["PXJ Balance: ",k.pxj.toLocaleString()]})})})})]})}),document.body):null},Ca=new class{constructor(){t(this,"atomicMarketContract","atomicmarket")}get atomicMarketAPI(){return $e.getCurrentAtomicEndpoint()}async placeBuyOffer(e,t,a,n=""){if(!e)throw new Error("Please connect your wallet first");const i=parseFloat(a);if(isNaN(i)||i<=0)throw new Error("Please enter a valid offer amount");try{const r=`${i.toFixed(8)} WAX`,s=await fetch(`${this.atomicMarketAPI}/atomicassets/v1/assets/${t}`);if(!s.ok)throw new Error("Failed to fetch asset details");const l=await s.json();if(!l.success||!l.data)throw new Error("Asset not found");const c=l.data.owner,o={account:this.atomicMarketContract,name:"announceoffer",authorization:[{actor:e.actor,permission:e.permission}],data:{buyer:e.actor,recipient:c,asset_ids:[t],price:r,memo:n||"Buy offer from PxMarket - market.pixeljourney.xyz",maker_marketplace:"market.pxj"}},d=await e.transact({actions:[o]});return{success:!0,transaction_id:d?.transaction_id||d?.id||"",message:`Buy offer of ${a} WAX placed successfully!`}}catch(r){throw ee.logError("OfferService.placeBuyOffer",r,{assetId:t,offerAmount:a,actor:e.actor}),new Error(`Failed to place buy offer: ${r instanceof Error?r.message:"Transaction failed or was rejected"}`)}}async getBuyOffersForAsset(e){try{const t=await fetch(`${this.atomicMarketAPI}/atomicmarket/v1/buyoffers?asset_id=${e}&state=0&sort=price&order=desc&limit=50`);if(!t.ok)throw new Error("Failed to fetch buy offers");const a=await t.json();return a.success&&a.data?a.data:[]}catch(t){return ee.logError("OfferService.getBuyOffersForAsset",t,{assetId:e}),[]}}async getUserBuyOffers(e,t){try{let a=`${this.atomicMarketAPI}/atomicmarket/v1/buyoffers?buyer=${e}&sort=created&order=desc&limit=100`;void 0!==t&&(a+=`&state=${t}`);const n=await fetch(a);if(!n.ok)throw new Error("Failed to fetch user buy offers");const i=await n.json();return i.success&&i.data?i.data:[]}catch(a){return ee.logError("OfferService.getUserBuyOffers",a,{account:e,state:t}),[]}}async cancelBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"canceloffer",authorization:[{actor:e.actor,permission:e.permission}],data:{offer_id:t}},n=await e.transact({actions:[a]});return{success:!0,transaction_id:n?.transaction_id||n?.id||"",message:"Buy offer cancelled successfully!"}}catch(a){throw ee.logError("OfferService.cancelBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to cancel buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}async acceptBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"acceptoffer",authorization:[{actor:e.actor,permission:e.permission}],data:{offer_id:t}},n=await e.transact({actions:[a]});return{success:!0,transaction_id:n?.transaction_id||n?.id||"",message:"Buy offer accepted successfully!"}}catch(a){throw ee.logError("OfferService.acceptBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to accept buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}async declineBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"declineoffer",authorization:[{actor:e.actor,permission:e.permission}],data:{offer_id:t}},n=await e.transact({actions:[a]});return{success:!0,transaction_id:n?.transaction_id||n?.id||"",message:"Buy offer declined successfully!"}}catch(a){throw ee.logError("OfferService.declineBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to decline buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}formatPrice(e){return`${(parseFloat(e.amount)/Math.pow(10,e.token_precision)).toFixed(Math.min(4,e.token_precision))} ${e.token_symbol}`}getOfferStateText(e){switch(e){case 0:return"Pending";case 1:return"Invalid";case 2:return"Accepted";case 3:return"Declined";case 4:return"Cancelled";default:return"Unknown"}}},Aa=({isOpen:e,onClose:t,nft:a})=>{const{account:n,session:r}=Q(),{settings:s}=ke(),{showSuccess:l,showError:c}=We(),[o,d]=i.useState([]),[h,u]=i.useState(!1),[m,p]=i.useState(null),f=i.useCallback(async()=>{if(a){u(!0);try{const e=await $e.getAssetOffers(a.asset_id);if(e&&e.length>0){const t=e.map(e=>({id:e.id,buyer:e.buyer,price:(parseFloat(e.price)/1e8).toFixed(8),symbol:e.token,timestamp:e.created,memo:e.memo})).sort((e,t)=>parseFloat(t.price)-parseFloat(e.price));d(t)}else d([])}catch(e){d([])}finally{u(!1)}}},[a]);i.useEffect(()=>{e&&a&&f()},[e,a,f]);const v=e=>{const t=new Date,a=new Date(e),n=t.getTime()-a.getTime(),i=Math.floor(n/36e5),r=Math.floor(i/24);if(r>0)return`${r} day${r>1?"s":""} ago`;if(i>0)return`${i} hour${i>1?"s":""} ago`;{const e=Math.floor(n/6e4);return`${e} minute${e>1?"s":""} ago`}};return e&&a?H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"modal-content view-offers-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"View Offers"}),H.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),H.jsxs("div",{className:"offers-content",children:[H.jsxs("div",{className:"view-offers-nft-info",children:[H.jsx("div",{className:"nft-image",children:H.jsx(Rt,{imageUrl:a.img,alt:a.name,enableAnimations:s.enableAnimatedNFTs})}),H.jsxs("div",{className:"nft-details",children:[H.jsx("h3",{children:a.name}),H.jsxs("div",{className:"nft-id",children:["#",a.asset_id]}),H.jsxs("div",{className:"collection-info",children:["string"==typeof a.collection?a.collection:a.collection?.name||a.collection?.collection_name||"Unknown"," \u2022 ",a.schema.schema_name]})]})]}),H.jsxs("div",{className:"offers-section",children:[H.jsxs("div",{className:"offers-header",children:[H.jsxs("h3",{children:["Active Offers (",o.length,")"]}),H.jsxs("button",{className:"refresh-btn",onClick:f,disabled:h,children:[h?"\ud83d\udd04":"\u21bb"," Refresh"]})]}),h?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading offers..."})]}):0===o.length?H.jsxs("div",{className:"empty-offers",children:[H.jsx("div",{className:"empty-icon",children:"\ud83d\udced"}),H.jsx("h4",{children:"No Offers Yet"}),H.jsx("p",{children:"This NFT hasn't received any offers yet. List it on the marketplace to attract buyers!"})]}):H.jsx("div",{className:"offers-list",children:o.map((e,i)=>H.jsxs("div",{className:"offer-card "+(0===i?"highest-offer":""),children:[H.jsxs("div",{className:"offer-header",children:[H.jsxs("div",{className:"buyer-info",children:[H.jsx("strong",{children:e.buyer}),0===i&&H.jsx("span",{className:"highest-badge",children:"\ud83c\udfc6 Highest"})]}),H.jsx("div",{className:"offer-time",children:v(e.timestamp)})]}),H.jsxs("div",{className:"offer-price",children:[H.jsx("span",{className:"price-amount",children:parseFloat(e.price).toFixed(2)}),H.jsx("span",{className:"price-symbol",children:e.symbol})]}),e.memo&&H.jsx("div",{className:"offer-memo",children:H.jsxs("em",{children:['"',e.memo,'"']})}),H.jsx("div",{className:"offer-actions",children:H.jsx("button",{className:"accept-btn",onClick:()=>(async e=>{if(n&&r&&a){if(window.confirm(`Accept offer of ${e.price} ${e.symbol} from ${e.buyer}?\n\nThis action cannot be undone.`)){p(e.id);try{if(!r)return void c("Wallet Not Connected","Please connect your wallet to accept offers.");await Ca.acceptBuyOffer(r,e.id),l("Offer Accepted!",`${e.price} ${e.symbol} will be transferred to your account.`),t()}catch(i){c("Failed to Accept Offer",i instanceof Error?i.message:"Failed to accept the offer. Please try again.")}finally{p(null)}}}else c("Please connect your wallet first","Wallet Required")})(e),disabled:null!==m,children:m===e.id?"Accepting...":"Accept Offer"})})]},e.id))})]})]}),H.jsx("div",{className:"modal-footer",children:H.jsx("button",{className:"btn-secondary",onClick:t,children:"Close"})})]})}):null};class _a{static async recyclePixal(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.BLEND_CONTRACT,name:"openbal",authorization:[{actor:t,permission:"active"}],data:{owner:t,token_symbol:"8,PXJ"}},{account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,quantity:this.RECYCLE_COST,memo:"deposit"}},{account:this.BLEND_CONTRACT,name:"announcedepo",authorization:[{actor:t,permission:"active"}],data:{owner:t,count:1}},{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"deposit"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.RECYCLE_BLEND_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async unpackPixelIngredientPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"unpack"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.PACK_RECIPE_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async unpackGenericPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"unpack"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.GENERIC_PACK_BLEND_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async getBlockInfo(){try{const t=[ue.WAX_CHAIN.EOSRIO,ue.WAX_CHAIN.WAXSWEDEN,ue.WAX_CHAIN.GREYMASS];for(const a of t)try{const e=await fetch(`${a}/v1/chain/get_info`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)continue;const t=await e.json(),n=t.head_block_id,i=65535&t.last_irreversible_block_num,r=n.match(/.{2}/g)?.slice(4,8)||["00","00","00","00"];return{ref_block_num:i,ref_block_prefix:parseInt(r.reverse().join(""),16)}}catch(e){re.warn("Failed to fetch block info from endpoint","NEFTY_BLEND",{endpoint:a,error:e});continue}throw new Error("All WAX endpoints failed")}catch(t){ee.logError("NeftyBlendService.getBlockInfo",t);const e=Date.now();return{ref_block_num:e/500&65535,ref_block_prefix:4294967295&e}}}static getExpirationTime(){return new Date((new Date).getTime()+18e5).toISOString().slice(0,-5)}static async executeRecycle(e,t){try{if(!t||!t.transact)throw new Error("Wallet not connected or does not support transactions");const a=await t.transact({actions:e.actions});return re.info("Recycle transaction successful","NEFTY_BLEND",{result:a}),!0}catch(a){throw ee.logError("NeftyBlendService.executeRecycle",a,{blendId:this.RECYCLE_BLEND_ID,recycleCost:this.RECYCLE_COST,actionsCount:e.actions.length,walletActor:t.actor}),a}}static async executeUnpack(e,t){try{if(!t||!t.transact)throw new Error("Wallet not connected or does not support transactions");const a=await t.transact({actions:e.actions});return re.info("Unpack transaction successful","NEFTY_BLEND",{result:a}),a}catch(a){throw ee.logError("NeftyBlendService.executeUnpack",a,{actionsCount:e.actions.length,walletActor:t.actor}),a}}static isPackNFT(e){if(!e||!e.template)return!1;const t=(e.template.name||"").toLowerCase(),a=["pack","container","box","chest"].some(e=>t.includes(e)),n=e.template?.template_id===this.PACK_TEMPLATE_ID;return a||n}static getPackType(e){return this.isPackNFT(e)?e.template?.template_id===this.PACK_TEMPLATE_ID?"pixel_ingredient":"generic":null}static async unpackPixelPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"neftyblocksp",asset_ids:[e],memo:"unbox"}}],transaction_extensions:[]}}static async unpackPixelPacksBulk(e,t){const a=[];for(let n=0;n<e.length;n+=20){const i=e.slice(n,n+20),r=await this.getBlockInfo(),s={expiration:this.getExpirationTime(),ref_block_num:r.ref_block_num,ref_block_prefix:r.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:i.map(e=>({account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"neftyblocksp",asset_ids:[e],memo:"unbox"}})),transaction_extensions:[]};a.push(s)}return a}static isPixelPack(e){return e.template?.template_id===this.PACK_TEMPLATE_ID}}t(_a,"BLEND_CONTRACT","blend.nefty"),t(_a,"ATOMIC_ASSETS_CONTRACT","atomicassets"),t(_a,"PXJ_CONTRACT","pixeljourney"),t(_a,"RECYCLE_BLEND_ID",37700),t(_a,"RECYCLE_COST","12000.00000000 PXJ"),t(_a,"PACK_TEMPLATE_ID","820134"),t(_a,"PACK_RECIPE_ID",37701),t(_a,"GENERIC_PACK_BLEND_ID",37702);const Sa=({isOpen:e,onClose:t,selectedNFTs:a,userAccount:n,walletSession:r,onUnpackComplete:s})=>{const[l,c]=i.useState(!1),{showError:o,showSuccess:d}=We(),h=a.filter(e=>_a.isPackNFT(e));if(!e)return null;const u=h.length>0;return H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"modal-content unpack-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Unpack NFT"}),H.jsx("button",{className:"modal-close",onClick:t,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"unpack-nft-info",children:[H.jsxs("h3",{children:["Selected Pack NFTs (",h.length,")"]}),h.map(e=>H.jsxs("div",{className:"nft-item",children:[H.jsx("div",{className:"nft-image",children:H.jsx("img",{src:e.img,alt:e.name})}),H.jsxs("div",{className:"nft-details",children:[H.jsx("h4",{children:e.name}),H.jsx("p",{className:"collection-name",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),H.jsx("p",{className:"schema-name",children:e.schema.schema_name}),e.mint_number&&H.jsxs("p",{className:"mint-number",children:["Mint #",e.mint_number]})]})]},e.asset_id))]}),u?H.jsxs("div",{className:"unpack-info",children:[H.jsxs("div",{className:"info-box",children:[H.jsx("h4",{children:"\ud83d\udce6 Pack Contents"}),H.jsxs("div",{className:"pack-contents",children:[H.jsx("p",{children:"These packs contain random rewards that will be revealed upon unpacking."}),H.jsx("p",{className:"warning",children:"\u26a0\ufe0f Unpacking will burn these packs permanently!"})]})]}),H.jsx("button",{className:"unpack-btn",onClick:async()=>{if(!n||!r)return void o("Wallet not connected","Connection Required");if(0===h.length)return void o("No pack NFTs selected","No Packs Selected");c(!0);const e=[];try{for(const t of h){let a;a="pixel_ingredient"===_a.getPackType(t)?await _a.unpackPixelIngredientPack(t.asset_id,n):await _a.unpackGenericPack(t.asset_id,n);const i=await _a.executeUnpack(a,r);e.push({nft:t,transaction:i,success:!0})}d("Packs unpacked successfully!","Unpack Complete"),s()}catch(t){o("Failed to unpack NFTs. Please try again.","Unpack Failed")}finally{c(!1)}},disabled:l||!r,children:l?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"loading-spinner small"}),"Unpacking..."]}):`\ud83d\udce6 Unpack ${h.length} Pack${h.length>1?"s":""}`})]}):H.jsx("div",{className:"cannot-unpack",children:H.jsxs("div",{className:"info-box error",children:[H.jsx("h4",{children:"\u274c Cannot Unpack"}),H.jsx("p",{children:"No pack NFTs selected for unpacking."}),H.jsx("p",{children:"Only packs, chests, boxes, and containers can be unpacked."})]})})]})]})})},Pa=({children:e})=>{const[t,a]=i.useState({isConnected:!1,account:null,session:null,login:async()=>null,logout:async()=>{},transact:async()=>null,purchaseNFT:async()=>null,batchPurchaseNFTs:async()=>null,executeCraftingTransaction:async()=>null,executeTransaction:async()=>{throw new Error("Wallet not connected")},isLoading:!0});return i.useEffect(()=>Lt.subscribe(e=>{a(e)}),[]),H.jsx(K.Provider,{value:t,children:e})},Ta=()=>{const e=i.useContext(K);if(void 0===e)throw new Error("useWallet must be used within a WalletProvider");return e},$a=({nfts:e,isOpen:t,onClose:a,onSuccess:n})=>{const{showSuccess:r,showError:s}=We(),l=Ta(),[c,o]=i.useState(""),[d,h]=i.useState(0),[u,m]=i.useState(1),[p,f]=i.useState(0),[v,y]=i.useState(0),[g,b]=i.useState(""),[N,w]=i.useState(!1),[k,x]=i.useState("name_asc");i.useEffect(()=>{t&&(o(""),h(0),m(1),f(0),y(0),b(""),w(!1))},[t]);const C=i.useMemo(()=>{const t=[...e];switch(k){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));default:return t}},[e,k]),A=()=>7*d*24*3600+24*u*3600+3600*p+60*v,_=(e,t)=>{const a=Math.max(0,Math.min(t,S(e)));switch(e){case"weeks":h(a);break;case"days":m(a);break;case"hours":f(a);break;case"minutes":y(a)}},S=e=>{switch(e){case"weeks":return 4;case"days":return 30;case"hours":return 23;case"minutes":return 59;default:return 0}},P=()=>{const e=[];return d>0&&e.push(`${d}w`),u>0&&e.push(`${u}d`),p>0&&e.push(`${p}h`),v>0&&e.push(`${v}m`),e.length>0?e.join(" "):"0m"};return t?H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal-content bulk-auction-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Create Bulk Auction"}),H.jsx("button",{className:"modal-close",onClick:a,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"selected-nfts-section",children:[H.jsxs("div",{className:"selected-nfts-header",children:[H.jsxs("h3",{children:["Selected NFTs (",e.length,")"]}),e.length>1&&H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"auction-sort",children:"Sort by:"}),H.jsxs("select",{id:"auction-sort",className:"sort-select",value:k,onChange:e=>x(e.target.value),children:[H.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),H.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),H.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),H.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),H.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),H.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),H.jsxs("div",{className:"selected-nfts-grid",children:[C.slice(0,6).map(e=>H.jsxs("div",{className:"selected-nft-item",children:[H.jsx("div",{className:"nft-image-container",children:H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name||`Asset #${e.asset_id}`,className:"nft-image"})}),H.jsxs("div",{className:"nft-info",children:[H.jsx("span",{className:"nft-name",children:e.name}),H.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"})]})]},e.asset_id)),e.length>6&&H.jsxs("div",{className:"more-nfts-indicator",children:["+",e.length-6," more"]})]})]}),H.jsxs("div",{className:"auction-settings",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"startingPrice",children:"Starting Price (WAX)"}),H.jsx("input",{type:"number",id:"startingPrice",value:c,onChange:e=>o(e.target.value),placeholder:"Enter starting price",min:"0",step:"0.01",disabled:N})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Auction Duration"}),H.jsxs("div",{className:"duration-inputs",children:[H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Weeks"}),H.jsx("input",{type:"number",className:"duration-input",value:d,onChange:e=>_("weeks",parseInt(e.target.value)||0),min:"0",max:S("weeks"),disabled:N})]}),H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Days"}),H.jsx("input",{type:"number",className:"duration-input",value:u,onChange:e=>_("days",parseInt(e.target.value)||0),min:"0",max:S("days"),disabled:N})]}),H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Hours"}),H.jsx("input",{type:"number",className:"duration-input",value:p,onChange:e=>_("hours",parseInt(e.target.value)||0),min:"0",max:S("hours"),disabled:N})]}),H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Minutes"}),H.jsx("input",{type:"number",className:"duration-input",value:v,onChange:e=>_("minutes",parseInt(e.target.value)||0),min:"0",max:S("minutes"),disabled:N})]})]}),H.jsxs("div",{className:"duration-summary",children:[H.jsx("span",{className:"duration-display",children:P()}),H.jsxs("span",{className:"duration-total",children:["(",A().toLocaleString(),"s)"]})]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"auctionMemo",children:"Memo (Optional)"}),H.jsx("textarea",{id:"auctionMemo",value:g,onChange:e=>b(e.target.value),placeholder:"Add a note about this auction batch...",rows:3,maxLength:256,disabled:N})]})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"cancel-btn",onClick:a,disabled:N,children:"Cancel"}),H.jsx("button",{className:"create-btn",onClick:async()=>{if(!c||parseFloat(c)<=0)return void s("Invalid Price","Please enter a valid starting price");const t=A();if(t<3600)s("Invalid Duration","Auction duration must be at least 1 hour");else if(t>2592e3)s("Invalid Duration","Auction duration cannot exceed 30 days");else{w(!0);try{const i=`${parseFloat(c).toFixed(8)} WAX`,s=e.map(e=>({account:"atomicmarket",name:"announceauct",authorization:[{actor:l.account||"",permission:"active"}],data:{seller:l.account||"",asset_ids:[parseInt(e.asset_id)],starting_bid:i,duration:t,maker_marketplace:"market.pxj"}}));await l.transact(s);const o=P();r("Bulk Auction Created",`Successfully created auctions for ${e.length} NFT${1!==e.length?"s":""} with starting price ${c} WAX and duration ${o}. Remember to transfer your assets to the atomicmarket contract to activate the auctions.`),n(),a()}catch(i){s("Auction Creation Failed",i instanceof Error?i.message:"Failed to create bulk auctions. Please try again.")}finally{w(!1)}}},disabled:N||!c||parseFloat(c)<=0||A()<3600,children:N?"Creating...":`Create ${e.length} Auction${1!==e.length?"s":""}`})]})]})}):null},Fa=new class{constructor(){t(this,"WAX_API_BASE","https://wax.eosrio.io/v1/chain"),t(this,"ATOMIC_API_BASE","https://wax-api.hivebp.io/api")}async getFeeTokens(){for(let t=1;t<=3;t++)try{const e=new AbortController,t=setTimeout(()=>e.abort(),1e4),a=await fetch(`${this.WAX_API_BASE}/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"rwax",scope:"rwax",table:"feetokens",json:!0,limit:100}),signal:e.signal});if(clearTimeout(t),!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const n=await a.json();if(!n.rows||!Array.isArray(n.rows))return se.error("Invalid fee tokens response structure:",n),[];const i=["honey-honeyhiveio","lswax-liquidstaked"],r=await this.fetchAlcorTokenRates(i),s=await Promise.all(n.rows.map(async e=>{const t=e.fee.match(/([0-9.]+)\s+([A-Z]+)/),a=t?t[2]:"UNKNOWN",n=t?t[1]:"0";let i;if("WAX"!==a)try{i=await this.calculateLiveWaxValue(a,n,r)}catch(s){if(se.warn(`Failed to get live WAX value for ${a}, using exchange rate fallback`,"RWaxService.getFeeTokens"),e.exchange_rate){const t=parseFloat(e.exchange_rate),a=parseFloat(n);isNaN(t)||isNaN(a)||(i=(a/t).toFixed(8))}}return{fee:e.fee,contract:e.contract,exchange_rate:e.exchange_rate,symbol:a,amount:n,wax_value:i}}));return se.info(`Successfully fetched ${s.length} fee tokens with live WAX conversions`),s}catch(e){if(se.error(`Attempt ${t} failed to fetch fee tokens:`,e instanceof Error?e.message:String(e)),3===t)throw new Error(`Failed to fetch fee tokens after 3 attempts: ${e}`);await new Promise(e=>setTimeout(e,1e3))}return[]}async fetchAlcorTokenRates(e){try{const t=`https://wax.alcor.exchange/api/v2/tokens/${e.join(",")}`,a=await fetch(t),n=await a.json(),i=new Map;return n.forEach(e=>{const t=`${e.symbol.toLowerCase()}-${e.contract}`;i.set(t,parseFloat(e.system_price)||0)}),i}catch(t){return se.error("Failed to fetch Alcor V2 rates:","RWaxService.fetchAlcorTokenRates",t),new Map}}async calculateLiveWaxValue(e,t,a){const n=parseFloat(t);if(isNaN(n))throw new Error(`Invalid amount: ${t}`);try{switch(e.toUpperCase()){case"WPIXAL":return(n*await ve.getWpixalPriceWAX()).toFixed(8);case"PXJ":{const e=await ve.getPxjPriceUSD(),t=await ve.getWaxPriceUSD();if(t>0)return(n*e/t).toFixed(8);throw new Error("WAX price is zero")}case"HONEY":{const e=a?.get("honey-honeyhiveio")||0;if(e>0)return(n*e).toFixed(8);throw new Error("HONEY/WAX rate not available")}case"LSWAX":{const e=a?.get("lswax-liquidstaked")||0;return e>0?(n*e).toFixed(8):(1.1616*n).toFixed(8)}default:throw se.warn(`Unknown token symbol for live conversion: ${e}`,"RWaxService.calculateLiveWaxValue"),new Error(`Unsupported token: ${e}`)}}catch(i){throw se.error(`Failed to calculate live WAX value for ${e}:`,"RWaxService.calculateLiveWaxValue",i),i}}async getAssetPoolInfo(e){for(let a=1;a<=3;a++)try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),n=await fetch(`${this.WAX_API_BASE}/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"rwax",scope:"WPIXAL",table:"assetpools",json:!0,limit:1,lower_bound:e,upper_bound:e,key_type:"i64"}),signal:t.signal});if(clearTimeout(a),!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();if(!i.rows||!Array.isArray(i.rows)||0===i.rows.length)return null;const r=i.rows[0];return{assetId:r.asset_id,issuedTokens:r.issued_tokens}}catch(t){if(se.error(`Attempt ${a} failed to fetch asset pool info for ${e}:`,t instanceof Error?t.message:String(t)),3===a)return se.error(`Failed to fetch asset pool info after 3 attempts: ${t}`),null;await new Promise(e=>setTimeout(e,1e3))}return null}async getTokenizedAssets(e=36,t=0,a="rarity_score_desc",n=""){let i=null;for(let s=1;s<=3;s++)try{const i=new URLSearchParams({term:"",owner:"rwax",collection:"pixeljourney",schema:"pixals",category:"",recent:"",order_by:a,limit:e.toString(),search_type:"inventory",offer_type:"sales",min_price:"0",max_price:"0",offset:t.toString(),verified:"all",favorites:"false",user:"pixeljourney",contract:"",attributes:n,only:"rwax",rwax_contract:"pixeljourney",rwax_symbol:"WPIXAL"}),r=`${this.ATOMIC_API_BASE}/assets?${i.toString()}`;se.info(`Fetching tokenized assets from: ${r}`,"RWaxService");const s=await fetch(r,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const l=await s.json();return se.debug("RWAX API Response received","RWaxService.getTokenizedAssets",{dataLength:Array.isArray(l)?l.length:"not array"}),Array.isArray(l)?l:[]}catch(r){if(i=r instanceof Error?r:new Error(String(r)),se.error(`Attempt ${s}/3 failed:`,"RWaxService.getTokenizedAssets",i),3===s)return se.warn("API failed, returning test data with original structure","RWaxService.getTokenizedAssets"),[{assetId:1099932947523,name:"Pixal 09106",schema:"pixals",owner:"rwax",burned:!1,mint:9106,contract:"atomicassets",collection:{collectionName:"pixeljourney",displayName:"Pixel Journey",collectionImage:"QmVnrLdB1xQ9EMzgw5srW6u8WKQpTjmYz6fBi2g7ic8iob",verification:!0,blacklisted:!1},transferable:!0,burnable:!0,mutableData:[],immutableData:[{key:"Background",value:["string","Nefty Spot"]},{key:"Body",value:["string","Pink-Blue Overalls"]},{key:"Eyes",value:["string","Kawaii Green"]},{key:"Head",value:["string","Grey"]},{key:"img",value:["string","Qma9rcg1NHxhvG5CMDecS3bo14gpQSr6QFieUXsFPrG14T"]},{key:"name",value:["string","Pixal 09106"]}],rarityScore:419.80619503583694,attributesFloor:501,rwax:{symbol:"WPIXAL",contract:"pixeljourney",decimals:8,tokenName:"Wrapped Pixal",redeemAmount:1.09997216},image:"Qma9rcg1NHxhvG5CMDecS3bo14gpQSr6QFieUXsFPrG14T",template:{templateId:781515}},{assetId:1099931322703,name:"Pixal 06238",schema:"pixals",owner:"rwax",burned:!1,mint:6238,contract:"atomicassets",collection:{collectionName:"pixeljourney",displayName:"Pixel Journey",verification:!0,blacklisted:!1},transferable:!0,burnable:!0,mutableData:[],immutableData:[{key:"Background",value:["string","Blue Sky"]},{key:"Body",value:["string","Red Shirt"]},{key:"Eyes",value:["string","Brown"]},{key:"Head",value:["string","Black Hair"]},{key:"img",value:["string","QmTestImage2"]},{key:"name",value:["string","Pixal 06238"]}],rarityScore:350.5,attributesFloor:400,rwax:{symbol:"WPIXAL",contract:"pixeljourney",decimals:8,tokenName:"Wrapped Pixal",redeemAmount:1.25},image:"QmTestImage2",template:{templateId:781516}}].slice(t,t+e)}throw i||new Error("Failed to fetch tokenized assets")}async getAssetWPIXALAmount(e){try{const t=`${this.WAX_API_BASE}/get_table_rows`,a={code:"pixeljourney",index_position:"primary",json:!0,key_type:"i64",limit:1,reverse:!1,lower_bound:e,upper_bound:e,scope:"pixeljourney",show_payer:!1,table:"assetpools",table_key:""},n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!n.ok)throw new Error(`Failed to fetch WPIXAL amount: ${n.statusText}`);const i=await n.json();return i.rows&&i.rows.length>0?i.rows[0].issued_tokens:"0.00000000 WPIXAL"}catch(t){return se.error("Error fetching WPIXAL amount:","RWaxService.getAssetWPIXALAmount",t instanceof Error?t:new Error(String(t))),"0.00000000 WPIXAL"}}async getUserPixalAssets(e,t=36,a=0){let n=null;for(let r=1;r<=3;r++)try{const n=`https://wax.api.atomicassets.io/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&schema_name=pixals&limit=${t}&page=${Math.floor(a/t)+1}&order=desc&sort=asset_id`;se.info(`Fetching user assets from: ${n}`,"RWaxService");const i=await fetch(n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const r=await i.json();return r&&r.data&&Array.isArray(r.data)?r.data.map(e=>{let t="";const a=[e.data?.img,e.data?.image,e.immutable_data?.img,e.immutable_data?.image,e.template?.immutable_data?.img,e.template?.immutable_data?.image];for(const n of a)if(n&&"string"==typeof n){t=n;break}return t&&!t.startsWith("http")&&(t.startsWith("Qm")||t.startsWith("/ipfs/")?t=`https://ipfs.io/ipfs/${t.replace("/ipfs/","")}`:t.startsWith("ipfs://")&&(t=t.replace("ipfs://","https://ipfs.io/ipfs/"))),{assetId:parseInt(e.asset_id)||0,name:e.name||e.data?.name||e.immutable_data?.name||`Pixal #${e.asset_id}`,image:t,schema:e.schema?.schema_name||e.schema_name||"pixals",owner:e.owner||"",burned:e.burned||!1,mint:e.template_mint||0,contract:e.contract||"atomicassets",collection:{collectionName:e.collection?.collection_name||e.collection_name||"pixeljourney",displayName:e.collection?.name||e.collection?.collection_name||"Pixel Journey",verification:e.collection?.authorized_accounts?.length>0||!0,blacklisted:!1},transferable:!1!==e.transferable,burnable:!1!==e.burnable,mutableData:Array.isArray(e.mutable_data)?e.mutable_data:[],immutableData:Array.isArray(e.immutable_data)?e.immutable_data:[],template:{templateId:parseInt(e.template?.template_id||e.template_id||"0")}}}):(se.error("Invalid user assets API response structure:",r),[])}catch(i){if(n=i instanceof Error?i:new Error(String(i)),se.error(`Attempt ${r}/3 failed:`,"RWaxService.getUserPixalAssets",n),3===r)return se.error("All attempts failed, returning empty array","RWaxService.getUserPixalAssets"),[];await new Promise(e=>setTimeout(e,1e3*r))}return[]}async executeTokenization(e,t){try{const{wharfKitService:a}=await f(async()=>{const{wharfKitService:e}=await Promise.resolve().then(()=>Wt);return{wharfKitService:e}},void 0);if(!a.isLoggedIn())throw new Error("Wallet not connected");const n=a.getAccountName();if(!n)throw new Error("No account found");const i=[{account:"nft.hive",name:"boost",authorization:[{actor:n,permission:"active"}],data:{booster:n}},{account:t.contract,name:"transfer",authorization:[{actor:n,permission:"active"}],data:{from:n,to:"rwax",quantity:t.fee,memo:"payfee"}},{account:"atomicassets",name:"transfer",authorization:[{actor:n,permission:"active"}],data:{from:n,to:"rwax",asset_ids:e,memo:"deposit"}},{account:"rwax",name:"tokenizenfts",authorization:[{actor:n,permission:"active"}],data:{user:n,asset_ids:e,fee_currency:`8,${t.symbol}`}}],r=await a.transact(i);return se.info("Tokenization transaction executed successfully","RWaxService.executeTokenization",{result:r}),r}catch(a){throw se.error("Error executing tokenization:","RWaxService.executeTokenization",a instanceof Error?a:new Error(String(a))),a}}async executeRedemption(e,t,a){try{const{wharfKitService:n}=await f(async()=>{const{wharfKitService:e}=await Promise.resolve().then(()=>Wt);return{wharfKitService:e}},void 0);if(!n.isLoggedIn())throw new Error("Wallet not connected");const i=n.getAccountName();if(!i)throw new Error("No account found");const r=[{account:"nft.hive",name:"boost",authorization:[{actor:i,permission:"active"}],data:{booster:i}},{account:a.contract,name:"transfer",authorization:[{actor:i,permission:"active"}],data:{from:i,to:"rwax",quantity:a.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:i,permission:"active"}],data:{from:i,to:"rwax",quantity:t,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:i,permission:"active"}],data:{redeemer:i,contract:"pixeljourney",quantity:t,asset_id:e,fee_currency:`8,${a.symbol}`}}],s=await n.transact(r);return se.info("Redemption transaction executed successfully","RWaxService.executeRedemption",{result:s}),s}catch(n){throw se.error("Error executing redemption:","RWaxService.executeRedemption",n instanceof Error?n:new Error(String(n))),n}}};function Ea(e){const t=ue.IPFS.GATEWAYS;return`${t[Math.floor(Math.random()*t.length)]}${e.replace(/^\/?(ipfs\/)?/,"")}`}const Ia=({isOpen:e,onClose:t,onSuccess:a,nft:n})=>{const[r,s]=i.useState([]),[l,o]=i.useState(null),[d,h]=i.useState(!1),{showError:u}=We();i.useEffect(()=>{e&&m()},[e]);const m=async()=>{try{h(!0);const e=await Fa.getFeeTokens();s(e);const t=e.find(e=>"WAX"===e.symbol);t&&o(t)}catch(e){se.error("Failed to load fee tokens","TokenizeFeeModal.loadFeeTokens",e),u("Failed to load fee tokens")}finally{h(!1)}},p=()=>{o(null),t()};return e?c.createPortal(H.jsx("div",{className:"modal-overlay",onClick:p,children:H.jsxs("div",{className:"modal-content tokenize-fee-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"\ud83e\ude99 Tokenize into WPIXAL"}),H.jsx("button",{className:"close-button",onClick:p,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[n&&H.jsxs("div",{className:"tokenize-asset-preview",children:[H.jsx("img",{src:(f=n.img,f?f.startsWith("http://")||f.startsWith("https://")||f.startsWith("data:")||f.startsWith("blob:")?f:f.startsWith("ipfs://")?Ea(f.replace("ipfs://","")):f.includes("/ipfs/")?Ea(f.split("/ipfs/")[1]):(f.startsWith("Qm")&&f.length>40||f.length>40&&/^[a-zA-Z0-9]+$/.test(f),Ea(f)):""),alt:n.name,className:"tokenize-asset-image",onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),H.jsx("h3",{children:n.name}),H.jsx("p",{className:"tokenize-description",children:"This will tokenize your Pixal PFP into WPIXAL tokens on the RWAX platform."})]}),d?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading fee options..."})]}):H.jsxs("div",{className:"fee-selection",children:[H.jsx("h4",{children:"Select Fee Token:"}),H.jsx("div",{className:"fee-options",children:r.map((e,t)=>H.jsxs("div",{className:"fee-option "+(l===e?"selected":""),onClick:()=>o(e),children:[H.jsxs("div",{className:"fee-info",children:[H.jsx("span",{className:"fee-amount",children:e.fee}),H.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&H.jsxs("div",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"cancel-button",onClick:p,children:"Cancel"}),H.jsx("button",{className:"confirm-button tokenize-confirm",onClick:async()=>{if(l&&n)try{h(!0),await Fa.executeTokenization([n.asset_id],l),a?.(),p()}catch(e){se.error("Failed to tokenize asset","TokenizeFeeModal.handleConfirm",e),u("Failed to tokenize asset")}finally{h(!1)}},disabled:!l||d,children:"Tokenize Asset"})]})]})}),document.body):null;var f},Ma=new class{constructor(){t(this,"MAX_BATCH_SIZE",10),t(this,"RETRY_ATTEMPTS",3),t(this,"RETRY_DELAY",1e3),t(this,"FARMS_CONTRACT","farms.waxdao"),t(this,"TOKEN_FARMS_CONTRACT","tf.waxdao"),t(this,"PXJ_CONTRACT","pixeljourney"),t(this,"WUF_CONTRACT","wuffi"),t(this,"PXJ_FARM_NAME","pxjfarm1")}async stakeNFTsPixelJourney(e,t,a="pixeljourney"){try{const n={account:this.FARMS_CONTRACT,name:"stakenfts",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farmname:a,assets_to_stake:t}},i=await this.executeTransactionWithRetry(e,[n]);return i.success&&re.info("NFTs Staked Successfully","StakingService",{user:e.actor.toString(),farm_name:a,asset_count:t.length,asset_ids:t,transaction_id:i.transaction_id}),i}catch(n){return re.error("stakeNFTsPixelJourney failed","StakingService",n,{asset_ids:t,farm_name:a}),{success:!1,error:n instanceof Error?n.message:"Unknown error",transaction_id:"",gas_used:0}}}async unstakeNFTsPixelJourney(e,t,a="pixeljourney"){try{const n={account:this.FARMS_CONTRACT,name:"unstake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farmname:a,asset_ids:t}},i=await this.executeTransactionWithRetry(e,[n]);return i.success&&re.info("NFTs Unstaked Successfully","StakingService",{user:e.actor.toString(),farm_name:a,asset_count:t.length,asset_ids:t,transaction_id:i.transaction_id}),i}catch(n){return re.error("unstakeNFTsPixelJourney failed","StakingService",n,{asset_ids:t,farm_name:a}),{success:!1,error:n instanceof Error?n.message:"Unknown error",transaction_id:"",gas_used:0}}}async stakeNFTsBatch(e,t,a="pixeljourney"){const n={success:!0,successful_transactions:[],failed_transactions:[],total_gas_used:0};try{const r=this.createBatches(t,this.MAX_BATCH_SIZE);for(const t of r)try{const i=await this.processBatch(e,t,"stake",a);n.successful_transactions.push(...i.successful_transactions),n.failed_transactions.push(...i.failed_transactions),n.total_gas_used+=i.total_gas_used,r.indexOf(t)<r.length-1&&await this.delay(500)}catch(i){t.forEach(e=>{n.failed_transactions.push({asset_id:e,error:i instanceof Error?i.message:"Batch processing failed"})})}return n.success=0===n.failed_transactions.length,re.info("NFT Staking Batch Operation","StakingService",{total_assets:t.length,successful:n.successful_transactions.length,failed:n.failed_transactions.length,farm_name:a}),n}catch(i){return re.error("stakeNFTsBatch failed","StakingService",i,{asset_ids:t,farm_name:a}),{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:i instanceof Error?i.message:"Unknown error"})),total_gas_used:0}}}async unstakeNFTsBatch(e,t){const a={success:!0,successful_transactions:[],failed_transactions:[],total_gas_used:0};try{const i=this.createBatches(t,this.MAX_BATCH_SIZE);for(const t of i)try{const n=await this.processBatch(e,t,"unstake");a.successful_transactions.push(...n.successful_transactions),a.failed_transactions.push(...n.failed_transactions),a.total_gas_used+=n.total_gas_used,i.indexOf(t)<i.length-1&&await this.delay(500)}catch(n){t.forEach(e=>{a.failed_transactions.push({asset_id:e,error:n instanceof Error?n.message:"Batch processing failed"})})}return a.success=0===a.failed_transactions.length,re.info("NFT Unstaking Batch Operation","StakingService",{total_assets:t.length,successful:a.successful_transactions.length,failed:a.failed_transactions.length}),a}catch(n){return re.error("unstakeNFTsBatch failed","StakingService",n,{asset_ids:t}),{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:n instanceof Error?n.message:"Unknown error"})),total_gas_used:0}}}async claimAllRewards(e,t="pixeljourney"){try{const a=[{account:this.FARMS_CONTRACT,name:"claim",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farmname:t}}],n=await this.executeTransactionWithRetry(e,a);return n.success&&re.info("Rewards Claimed Successfully","StakingService",{user:e.actor.toString(),farm_name:t,transaction_id:n.transaction_id}),n}catch(a){return re.error("claimAllRewards failed","StakingService",a,{user:e.actor.toString(),farm_name:t}),{success:!1,error:a instanceof Error?a.message:"Failed to claim rewards"}}}async getStakingInfo(e,t="pixeljourney"){try{const a=await fetch(`${ue.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.FARMS_CONTRACT,scope:this.FARMS_CONTRACT,table:"stakers",lower_bound:e,upper_bound:e,limit:1e3})});if(!a.ok)throw new Error(`Failed to fetch staking info: ${a.statusText}`);const n=(await a.json()).rows.find(t=>t.user===e)||{},i=n.staked_assets||[],r=n.pending_rewards||[],s=i.map(e=>({asset_id:e,template_id:"0",farm_name:t,stake_time:Date.now()/1e3,rewards_per_hour:{pxj:0,wuf:0},multiplier:1}))||[],l=r.map(e=>({token:e.quantity.split(" ")[1],amount:parseFloat(e.quantity.split(" ")[0]),contract:e.contract,precision:4})),c=s.reduce((e,t)=>e+Object.values(t.rewards_per_hour).reduce((e,t)=>e+t,0)*t.multiplier,0),o=[{token:"PXJ",amount:s.reduce((e,t)=>e+24*(t.rewards_per_hour.pxj||0),0),contract:this.PXJ_CONTRACT,precision:4},{token:"WUF",amount:s.reduce((e,t)=>e+24*(t.rewards_per_hour.wuf||0),0),contract:this.WUF_CONTRACT,precision:4}];return{staked_nfts:s,pending_rewards:l,total_staking_power:c,estimated_daily_rewards:o}}catch(a){return re.error("getStakingInfo failed","StakingService",a,{account:e,farm_name:t}),{staked_nfts:[],pending_rewards:[],total_staking_power:0,estimated_daily_rewards:[]}}}async stakeTokens(e,t,a=this.PXJ_FARM_NAME){try{const n=[{account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{from:e.actor.toString(),to:this.TOKEN_FARMS_CONTRACT,quantity:t,memo:`stake:${a}`}}],i=await this.executeTransactionWithRetry(e,n);return i.success&&re.info("Token staked successfully","StakingService",{type:"token_stake",user:e.actor.toString(),amount:t,farm_name:a}),i}catch(n){return re.error("stakeTokens failed","StakingService",n,{user:e.actor.toString(),amount:t,farm_name:a}),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}async unstakeTokens(e,t,a=this.PXJ_FARM_NAME){try{const n=[{account:this.TOKEN_FARMS_CONTRACT,name:"unstake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farm_name:a,quantity:t}}],i=await this.executeTransactionWithRetry(e,n);return i.success&&re.info("Token unstaked successfully","StakingService",{type:"token_unstake",user:e.actor.toString(),amount:t,farm_name:a}),i}catch(n){return re.error("unstakeTokens failed","StakingService",n,{user:e.actor.toString(),amount:t,farm_name:a}),{success:!1,error:n instanceof Error?n.message:"Unknown error"}}}async claimTokenFarmRewards(e,t=this.PXJ_FARM_NAME){try{const a=[{account:this.TOKEN_FARMS_CONTRACT,name:"getreward",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farm_name:t}}],n=await this.executeTransactionWithRetry(e,a);return n.success&&re.info("Token farm rewards claimed successfully","StakingService",{type:"token_claim_rewards",user:e.actor.toString(),farm_name:t}),n}catch(a){return re.error("claimTokenFarmRewards failed","StakingService",a,{user:e.actor.toString(),farm_name:t}),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async getTokenFarmInfo(e=this.PXJ_FARM_NAME){try{const t=await fetch(`${ue.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.TOKEN_FARMS_CONTRACT,scope:this.TOKEN_FARMS_CONTRACT,table:"farms",lower_bound:e,upper_bound:e,limit:1})});if(!t.ok)throw new Error(`Failed to fetch farm info: ${t.statusText}`);const a=(await t.json()).rows.find(t=>t.farm_name===e);return a?{farm_name:a.farm_name,creator:a.creator,time_created:a.time_created,staking_token:a.staking_token,incentive_count:a.incentive_count,total_staked:a.total_staked,vesting_time:a.vesting_time,last_update_time:a.last_update_time}:null}catch(t){return re.error("getTokenFarmInfo failed","StakingService",t,{farm_name:e}),null}}async getTokenStakingInfo(e,t=this.PXJ_FARM_NAME){try{const a=await fetch(`${ue.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.TOKEN_FARMS_CONTRACT,scope:t,table:"stakers",lower_bound:e,upper_bound:e,limit:1})});if(!a.ok)throw new Error(`Failed to fetch token staking info: ${a.statusText}`);const n=(await a.json()).rows.find(t=>t.user===e);if(!n)return null;const i=(n.pending_rewards||[]).map(e=>({token:e.quantity.split(" ")[1],amount:parseFloat(e.quantity.split(" ")[0]),contract:e.contract,precision:4}));return{farm_name:t,user:n.user,staked_amount:n.staked_amount,stake_time:n.stake_time,pending_rewards:i,vesting_time:n.vesting_time,last_claim_time:n.last_claim_time}}catch(a){return re.error("getTokenStakingInfo failed","StakingService",a,{account:e,farm_name:t}),null}}async calculateOptimalStakingStrategy(e,t="pixeljourney"){try{const a=await this.getStakingInfo(e,t),n=new Set(a.staked_nfts.map(e=>e.asset_id)),i=await fetch(`${$e.atomicAssetsAPI}/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&page=1&limit=1000&order=desc&sort=asset_id`);if(!i.ok)throw new Error("Failed to fetch available NFTs");const r=await i.json(),s=r.data?.filter(e=>!n.has(e.asset_id)).map(e=>({asset_id:e.asset_id,template_id:e.template.template_id,farm_name:t,stake_time:0,rewards_per_hour:this.calculateRewardsPerHour(e.template.template_id),multiplier:1}))||[],l=await this.getTemplateRewards(),c=s.map(e=>{const t=l[e.template_id]||{pxj:0,wuf:0},a=this.getRarityMultiplier(this.getTemplateRarity(e.template_id)),n=24*(t.pxj+t.wuf)*a;return{asset_id:e.asset_id,expected_daily_return:n,priority:this.calculateStakingPriority(this.getTemplateRarity(e.template_id),n)}}).sort((e,t)=>t.priority-e.priority),o=c.reduce((e,t)=>e+t.expected_daily_return,0);return{recommended_stakes:c,total_expected_daily_return:o,optimization_tips:this.generateOptimizationTips(c,s),available_nfts:s}}catch(a){return re.error("calculateOptimalStakingStrategy failed","StakingService",a,{account:e}),{recommended_stakes:[],total_expected_daily_return:0,optimization_tips:["Unable to calculate optimal strategy. Please try again later."],available_nfts:[]}}}async processBatch(e,t,a,n){const i=t.map(t=>"stake"===a?{account:this.FARMS_CONTRACT,name:"stake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{owner:e.actor.toString(),asset_id:t,farm_name:n||"pixeljourney"}}:{account:this.FARMS_CONTRACT,name:"unstake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{owner:e.actor.toString(),asset_id:t}});try{const a=await this.executeTransactionWithRetry(e,i);return a.success?{success:!0,successful_transactions:t,failed_transactions:[],total_gas_used:a.gas_used||0}:{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:a.error||"Transaction failed"})),total_gas_used:0}}catch(r){return{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:r instanceof Error?r.message:"Unknown error"})),total_gas_used:0}}}async executeTransactionWithRetry(e,t,a=1){try{const a=await e.transact({actions:t});return{success:!0,transaction_id:a?.transaction_id||a?.id||"",gas_used:a?.cpu_usage_us||a?.max_net_usage_words||0}}catch(n){return a<this.RETRY_ATTEMPTS?(await this.delay(this.RETRY_DELAY*a),this.executeTransactionWithRetry(e,t,a+1)):{success:!1,error:n instanceof Error?n.message:"Transaction failed"}}}createBatches(e,t){const a=[];for(let n=0;n<e.length;n+=t)a.push(e.slice(n,n+t));return a}delay(e){return new Promise(t=>setTimeout(t,e))}async getTemplateRewards(){try{const e=await fetch(`${ue.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.FARMS_CONTRACT,scope:this.FARMS_CONTRACT,table:"templrewards",limit:1e3})});if(!e.ok)throw new Error("Failed to fetch template rewards");const t=await e.json(),a={};return t.rows.forEach(e=>{const t={pxj:0,wuf:0};e.hourly_rewards&&Array.isArray(e.hourly_rewards)&&e.hourly_rewards.forEach(e=>{const a=parseFloat(e.quantity.split(" ")[0]),n=e.quantity.split(" ")[1];"PXJ"===n&&(t.pxj=a),"WUF"===n&&(t.wuf=a)}),a[e.template_id]=t}),a}catch{return{1001:{pxj:50,wuf:25},1002:{pxj:10,wuf:5},1003:{pxj:2,wuf:1},1004:{pxj:.5,wuf:.25},1005:{pxj:.1,wuf:.05}}}}getRarityMultiplier(e){switch(e.toLowerCase()){case"legendary":return 5;case"epic":return 3;case"rare":return 2;case"uncommon":return 1.5;default:return 1}}calculateStakingPriority(e,t){return 100*this.getRarityMultiplier(e)+10*t}generateOptimizationTips(e,t){const a=[],n=t.reduce((e,t)=>{const a=this.getTemplateRarity(t.template_id);return e[a]=(e[a]||0)+1,e},{});return n.Legendary>0&&a.push("Prioritize staking Legendary ingredients for maximum rewards"),n.Epic>5&&a.push("Consider staking Epic ingredients in batches to optimize gas costs"),e.length>20&&a.push("Use batch staking to reduce transaction costs for large collections"),e.reduce((e,t)=>e+t.expected_daily_return,0)>100&&a.push("Your collection has high earning potential - consider staking all eligible NFTs"),0===a.length&&a.push("Stake your highest rarity NFTs first for optimal returns"),a}calculateRewardsPerHour(e){return{1001:{pxj:50,wuf:25},1002:{pxj:10,wuf:5},1003:{pxj:2,wuf:1},1004:{pxj:.5,wuf:.25},1005:{pxj:.1,wuf:.05}}[e]||{pxj:0,wuf:0}}getTemplateRarity(e){return{1001:"Legendary",1002:"Epic",1003:"Rare",1004:"Uncommon",1005:"Common"}[e]||"Common"}},La=r.memo(({imageUrl:e,videoUrl:t,alt:a,className:n="",loading:r="lazy",enableAnimations:s=!0,placeholder:l,onLoad:c,onError:o})=>{const[d,h]=i.useState(!1),[u,m]=i.useState(!1),[p,f]=i.useState("eager"===r),v=i.useRef(null),y=i.useRef(null),g=e=>e?"string"!=typeof e?null:e.startsWith("http")?e:e.startsWith("Qm")?`${ue.IPFS.GATEWAYS[0]}${e}`:e:null,b=g(t),N=g(e),w=()=>`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#fef2f2"/>\n      <circle cx="100" cy="80" r="20" fill="#fca5a5"/>\n      <text x="100" y="85" text-anchor="middle" font-family="Arial" font-size="16" fill="#dc2626">!</text>\n      <text x="100" y="120" text-anchor="middle" font-family="Arial" font-size="12" fill="#991b1b">Failed to load</text>\n    </svg>')}`;i.useEffect(()=>{if("eager"===r||p)return;const e=new IntersectionObserver(([t])=>{t.isIntersecting&&(f(!0),e.disconnect())},{rootMargin:"50px"}),t=v.current||y.current;return t&&e.observe(t),()=>e.disconnect()},[r,p]);const k=()=>{h(!0),m(!1),c?.()},x=()=>{m(!0),h(!1),o?.()};return p&&(d||u)?u?H.jsx("img",{src:w(),alt:`Error loading ${a}`,className:n,style:{width:"100%",height:"100%",objectFit:"cover"}}):b&&s&&d?H.jsxs("video",{ref:y,className:n,muted:!0,loop:!0,autoPlay:!0,poster:N||void 0,style:{width:"100%",height:"100%",objectFit:"cover",opacity:d?1:0,transition:"opacity 0.3s ease"},children:[H.jsx("source",{src:b,type:"video/mp4"}),H.jsx("source",{src:b,type:"video/webm"})]}):H.jsx("img",{ref:v,src:N||w(),alt:a,className:n,style:{width:"100%",height:"100%",objectFit:"cover",opacity:d?1:0,transition:"opacity 0.3s ease"}}):H.jsxs("div",{className:`progressive-image-container ${n}`,children:[H.jsx("img",{ref:v,src:l||`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#f8fafc"/>\n      <rect x="50" y="80" width="100" height="8" rx="4" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite"/>\n      </rect>\n      <rect x="60" y="100" width="80" height="6" rx="3" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>\n      </rect>\n      <rect x="70" y="120" width="60" height="6" rx="3" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" begin="0.6s" repeatCount="indefinite"/>\n      </rect>\n    </svg>')}`,alt:`Loading ${a}`,className:"progressive-image-placeholder",style:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(2px)",transition:"filter 0.3s ease"}}),p&&N&&H.jsx("img",{src:N,alt:a,style:{display:"none"},onLoad:k,onError:x}),p&&b&&s&&H.jsx("video",{ref:y,src:b,style:{display:"none"},onLoadedData:k,onError:x,muted:!0,loop:!0})]})});La.displayName="ProgressiveImage";const Wa=i.memo(({nft:e,selectedNFTs:t,isSelected:a,settings:n,dropdownOpen:i,onNFTClick:r,onCollectionClick:s,onSchemaClick:l,onToggleSelection:c,onDropdownToggle:o,onListingOpen:d,onTransferOpen:h,onBurnOpen:u,onAuctionOpen:m,onRecyclePixal:p,onCraftingOpen:f,onViewOffers:v,onUnpackPixelPack:y,onStakeOpen:g,onTokenizePixal:b,onImageZoom:N})=>{const w=i===e.asset_id,k="pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name,x="pixeljourney"===e.collection.collection_name&&"ingredients"===e.schema.schema_name,C=me.isValidWaxRock(e.data.WaxRock);return H.jsxs("div",{className:`inventory-page-card ${t.size>0?"selectable":""} ${a?"selected":""}`,children:[H.jsx("div",{className:"selection-checkbox",children:H.jsx("input",{type:"checkbox",checked:a,onChange:()=>c(e.asset_id),onClick:e=>e.stopPropagation()})}),H.jsxs("div",{className:"inventory-page-media",onClick:()=>{t.size>0?c(e.asset_id):r(e)},children:[H.jsx(La,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name,className:"inventory-media",loading:"lazy",enableAnimations:n.enableAnimatedNFTs}),H.jsx("div",{className:"zoom-overlay",onClick:t=>{t.stopPropagation(),N(Qt(e)||"",Zt(e)||"",e.name||`Asset #${e.asset_id}`)},title:"Click to zoom",children:H.jsxs("svg",{className:"zoom-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"11",cy:"11",r:"8"}),H.jsx("path",{d:"m21 21-4.35-4.35"}),H.jsx("path",{d:"M11 8v6M8 11h6"})]})}),e.mint_number&&H.jsxs("div",{className:"mint-badge",children:["#",e.mint_number]})]}),H.jsxs("div",{className:"inventory-page-info",children:[H.jsx("h3",{className:"inventory-page-name",onClick:()=>{t.size>0?c(e.asset_id):r(e)},children:e.name}),H.jsxs("div",{className:"inventory-page-details",children:[H.jsx("span",{className:"inventory-page-collection",onClick:()=>s(e.collection.collection_name),children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),H.jsx("span",{className:"inventory-page-schema",onClick:()=>l(e.schema.schema_name),children:e.schema.schema_name})]}),H.jsxs("div",{className:"inventory-page-actions",children:[H.jsxs("div",{className:"basic-actions",children:[H.jsx("button",{className:"inv-action-btn list-btn",onClick:t=>{t.stopPropagation(),d(e)},title:"List for Sale","aria-label":`List ${e.name} for sale`,children:"\ud83d\udcb0"}),H.jsx("button",{className:"inv-action-btn transfer-btn",onClick:t=>{t.stopPropagation(),h(e)},title:"Transfer","aria-label":`Transfer ${e.name} to another account`,children:"\ud83d\udce4"}),H.jsx("button",{className:"inv-action-btn offers-btn",onClick:t=>{t.stopPropagation(),v(e)},"aria-label":`View offers for ${e.name}`,title:"View Offers",children:"\ud83d\udc41\ufe0f"})]}),H.jsxs("div",{className:"more-actions-dropdown","data-dropdown-id":e.asset_id,children:[H.jsx("button",{className:"more-actions-btn",onClick:t=>{t.stopPropagation(),o(e.asset_id)},title:"More Actions","aria-label":`More actions for ${e.name}`,"aria-expanded":w,children:"\u22ee"}),w&&H.jsxs("div",{className:"inv-dropdown-menu",children:[H.jsx("button",{className:"inv-dropdown-item auction-item",onClick:t=>{t.stopPropagation(),m(e)},"aria-label":`Create auction for ${e.name}`,children:"\ud83c\udfc6 Create Auction"}),!C&&H.jsx("button",{className:"inv-dropdown-item burn-item",onClick:t=>{t.stopPropagation(),u(e)},"aria-label":`Burn ${e.name}`,children:"\ud83d\udd25 Burn"}),k&&!C&&H.jsx("button",{className:"inv-dropdown-item recycle-item",onClick:t=>{t.stopPropagation(),p(e)},"aria-label":`Recycle ${e.name}`,children:"\u267b\ufe0f Recycle"}),k&&H.jsx("button",{className:"inv-dropdown-item tokenize-item",onClick:t=>{t.stopPropagation(),b(e)},"aria-label":`Tokenize ${e.name} into WPIXAL`,children:"\ud83e\ude99 Tokenize into WPIXAL"}),(k||x)&&H.jsxs("button",{className:"inv-dropdown-item craft-item",onClick:t=>{t.stopPropagation(),f(e)},"aria-label":`Use ${e.name} for crafting`,children:["\ud83d\udd28 ",x?"Craft with Ingredient":"Craft"]}),"pixeljourney"===e.collection.collection_name&&H.jsx("button",{className:"inv-dropdown-item stake-item",onClick:t=>{t.stopPropagation(),g(e)},"aria-label":`Stake ${e.name}`,children:"\ud83e\udd69 Stake NFT"}),_a.isPixelPack(e)&&H.jsx("button",{className:"inv-dropdown-item unpack-item",onClick:t=>{t.stopPropagation(),y(e)},children:"\ud83d\udce6 Unpack"})]})]})]})]})]})}),Ra=i.memo(()=>{const e=l(),{settings:t}=ke(),{showSuccess:a,showError:n,confirm:r}=We(),[s,c]=i.useState([]),[o,d]=i.useState(!1),[h,u]=i.useState(!1),[m,p]=i.useState(!1),[f,v]=i.useState(!1),[y,g]=i.useState(!1),[b,N]=i.useState(!1),[w,k]=i.useState(!1),[x,C]=i.useState(!1),[A,_]=i.useState(!1),[S,P]=i.useState(!1),[T,$]=i.useState(!1),[F,E]=i.useState(!1),[I,M]=i.useState(null),[L,W]=i.useState(new Set),[R,O]=i.useState(!1),[B,j]=i.useState(null),[D,U]=i.useState(!1),[X,z]=i.useState(null),[J,q]=i.useState(!1),[V,G]=i.useState(null),[Y,K]=i.useState(!1),[Z,ee]=i.useState(null),[te,ae]=i.useState(null),[ne,ie]=i.useState(!1),re=i.useCallback((e,t,a)=>{const n=t||e,i=t?"video":"image";let r=n;n.startsWith("Qm")||n.startsWith("baf")?r=`https://ipfs.io/ipfs/${n}`:n.startsWith("/ipfs/")?r=`https://ipfs.io${n}`:n.startsWith("ipfs://")&&(r=n.replace("ipfs://","https://ipfs.io/ipfs/")),ae({url:r,name:a,type:i}),ie(!0)},[]),[le,ce]=i.useState(""),[oe,de]=i.useState(""),[he,ue]=i.useState([]),[pe,fe]=i.useState("all"),[ve,ye]=i.useState("all"),[ge,be]=i.useState("all"),[Ne,we]=i.useState(""),[xe,Ce]=i.useState("transferred"),[Ae,_e]=i.useState("desc"),[Se]=i.useState(""),[Pe,Te]=i.useState([]),[Fe,Ee]=i.useState([]),[Ie,Me]=i.useState(!1),[Le,Re]=i.useState({start:"",end:""}),[Oe,Be]=i.useState(1),[je,De]=i.useState(!1),[Ue,Xe]=i.useState(!1),[ze,He]=i.useState(!1),Je=1e3,[qe,Ve]=i.useState(1),{isConnected:Ge,account:Ye,login:Ke,session:Qe}=Q(),Ze=i.useCallback(async(e=1,t=!1)=>{if(Ye)if(o||Ue)se.debug("Skipping loadInventory - already loading","Inventory");else{1===e?(d(!0),Be(1)):Xe(!0);try{let a;se.debug("Loading inventory","Inventory",{filter:pe,page:e,ITEMS_PER_PAGE:Je,sortBy:xe,sortOrder:Ae});const n={page:e,limit:Je,order:Ae,sort:xe.includes("_")?"asset_id":xe,search:oe||void 0,template_id:Ne||void 0};switch(Le.start&&(n.after=new Date(Le.start).getTime()/1e3),Le.end&&(n.before=new Date(Le.end).getTime()/1e3),pe){case"pixals":case"waxrock":n.collection_name="pixeljourney",n.schema_name="pixals";break;case"ingredients":n.collection_name="pixeljourney",n.schema_name="ingredients";break;case"packs":n.collection_name="pixeljourney",n.schema_name="packs";break;default:"all"!==ve&&(n.collection_name=ve),"all"!==ge&&(n.schema_name=ge)}const i=await $e.getUserInventoryEnhanced(Ye,n);a={data:i.assets||[],hasMore:i.hasMore,totalCount:i.total||0,collections:i.collections||[],schemas:i.schemas||[]},a.collections&&a.collections.length>0&&Te(e=>[...new Set([...e,...a.collections])].sort()),a.schemas&&a.schemas.length>0&&Ee(e=>[...new Set([...e,...a.schemas])].sort()),se.debug("Inventory Response","Inventory",{itemsReceived:a?.data?.length||0,totalAvailable:a?.totalCount||"unknown",hasMore:a?.hasMore});let r=a.data.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image||e.img,video:e.video||e.traits?.video||e.data?.video||void 0,collection:{name:e.collection||e.collection_name,collection_name:e.collection||e.collection_name},schema:{schema_name:e.schema||e.schema_name},template:{template_id:e.template_id||e.template?.template_id||"0",max_supply:e.max_supply||e.template?.max_supply||"0"},data:e.traits||e.data||{},mint_number:e.template_mint||e.mint_number}));if(1===e&&"all"===pe){const e=[...new Set(r.map(e=>e.collection.collection_name).filter(e=>"string"==typeof e&&""!==e.trim()))].sort();Te(e)}t&&e>1?(c(e=>[...e,...r]),Be(e)):(c(r),Be(1)),De(a.hasMore)}catch(a){se.error("Error loading inventory","Inventory",a);const n=a instanceof Error?a.message:"Unknown error occurred";1!==e||t?se.warn("Failed to load more inventory items","Inventory",{errorMessage:n}):(c([]),se.warn("Failed to load inventory","Inventory",{errorMessage:n})),De(!1)}finally{d(!1),Xe(!1)}}},[Ye,pe,ve,Je]);i.useEffect(()=>{Ge&&Ye&&(se.debug("Inventory reload triggered","Inventory",{filter:pe,selectedCollection:ve,selectedSchema:ge,selectedTemplate:Ne,sortBy:xe,sortOrder:Ae,searchTerm:le,dateRange:Le}),Ze(1,!1))},[Ge,Ye,pe,ve,ge,Ne,xe,Ae,le,Le]);const et=i.useCallback(()=>{je&&!Ue&&Ye&&Ze(Oe+1,!0)},[je,Ue,Oe,Ye,Ze]),tt=i.useCallback(async()=>{if(!je||ze||!Ye)return void se.debug("LoadAll skipped","Inventory",{hasMore:je,loadingAll:ze,account:Ye});He(!0),se.debug("Starting loadAllItems with concurrent requests","Inventory",{currentInventoryLength:s.length,hasMore:je,currentPage:Oe});let e=Oe+1,t=[],a=!0,n=0;try{for(;a&&n<50;){const i=[],r=[];for(let t=0;t<2&&a;t++){const a=e+t;r.push(a);const n=(async()=>{const e=1e3*(a-1);try{switch(pe){case"pixals":return await $e.getUserInventoryBySchema(Ye,"pixeljourney","pixals",1e3,e);case"ingredients":return await $e.getUserInventoryBySchema(Ye,"pixeljourney","ingredients",1e3,e);case"waxrock":return await $e.getUserInventoryWaxRocks(Ye,1e3,e);default:{const e="all"!==ve?ve:void 0;return await $e.getUserInventoryWithFilter(Ye,a,1e3,e)}}}catch(t){return se.error("Error in individual request","Inventory",t instanceof Error?t:new Error(String(t))),{assets:[],total:0,hasMore:!1}}})();i.push(n)}se.debug("LoadAll Concurrent Batch","Inventory",{pages:r,currentItems:s.length+t.length});const l=await Promise.allSettled(i);n+=l.length;let o=!1;for(let e=0;e<l.length;e++){const n=l[e],i=r[e];if("fulfilled"===n.status){const e=n.value;if(se.debug("LoadAll Response","Inventory",{page:i,items:e?.assets?.length||0,hasMore:e?.hasMore,total:e?.total}),e&&e.assets&&e.assets.length>0){o=!0;let a=e.assets.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image,video:e.video||e.traits?.video||void 0,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:e.max_supply||"0"},data:e.traits||{},mint_number:e.template_mint}));"waxrock"===pe&&(a=a.filter(e=>{const t=e.data.WaxRock;return"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name&&t&&"none"!==t})),t.push(...a)}e&&e.hasMore||(a=!1)}else se.error("LoadAll Request Failed","Inventory",new Error(`Page ${i}: ${n.reason}`))}o||(a=!1,se.debug("No more items found, stopping LoadAll","Inventory")),e+=2,t.length>0&&(c(e=>{const a=[...e,...t];return se.debug("Updated inventory","Inventory",{previousCount:e.length,newCount:a.length,addedCount:t.length}),a}),Be(e-1),t=[]),a&&await new Promise(e=>setTimeout(e,100))}se.debug("LoadAll Complete with concurrent requests","Inventory",{totalItems:s.length,totalRequests:n}),De(!1)}catch(i){se.error("Error loading all items","Inventory",i);const e=i instanceof Error?i.message:"Unknown error occurred";se.warn("Failed to load all inventory items","Inventory",{errorMessage:e}),De(!1)}finally{He(!1)}},[je,ze,Ye,Oe,Je,pe,ve,s.length]);i.useEffect(()=>{const e=e=>{B&&!e.target.closest(".more-actions-dropdown")&&j(null)};return document.addEventListener("mousedown",e),B&&setTimeout(()=>{if(B){const e=document.querySelector(`[data-dropdown-id="${B}"] .inv-dropdown-menu`);if(e){const t=e.getBoundingClientRect(),a=window.innerWidth;e.classList.remove("dropdown-left","dropdown-down"),t.right>a&&e.classList.add("dropdown-left"),t.top<0&&e.classList.add("dropdown-down")}}},0),()=>document.removeEventListener("mousedown",e)},[B]);const at=t=>{e(`/assets/${t.asset_id}`)},nt=t=>{e(`/marketplace?collection=${t}`)},it=t=>{e(`/marketplace?schema=${t}`)},rt=e=>{const t=new Set(L);t.has(e)?(t.delete(e),0===t.size&&O(!1)):(t.add(e),R||O(!0)),W(t)},st=async()=>{if(0===L.size)return;if(!Ye||!Qe)return void n("Wallet Required","Please connect your wallet first");const e=s.filter(e=>L.has(e.asset_id)).filter(e=>_a.isPixelPack(e));if(0!==e.length)try{if(!(await r("Confirm Bulk Unpack",`Are you sure you want to unpack ${e.length} pixelpack(s)?\n\nThis action cannot be undone and will be processed in batches of 20.`,"Unpack All","Cancel")))return;const t=e.map(e=>e.asset_id),n=await _a.unpackPixelPacksBulk(t,Ye);for(let e=0;e<n.length;e++){const t=n[e];a(`Processing batch ${e+1} of ${n.length}...`,"Bulk Unpack"),await _a.executeUnpack(t,Qe)}a("Bulk Unpack Successful",`Successfully unpacked ${e.length} pixelpack(s)!`),W(new Set),await Ze()}catch(t){se.error("Bulk unpack failed","Inventory",t),n("Bulk Unpack Failed",t instanceof Error?t.message:"Unknown error occurred")}else n("No pixelpack NFTs selected","Please select pixelpack items to unpack.")};i.useEffect(()=>{const e=setTimeout(()=>{de(le)},300);return()=>clearTimeout(e)},[le]);const lt=i.useCallback(e=>{if(!e||e.length<2)return[];const t=new Map,a=e.toLowerCase();return s.forEach(e=>{if(e.name.toLowerCase().includes(a)){const a=`name:${e.name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.name,type:"name",count:1})}if(e.collection.collection_name.toLowerCase().includes(a)){const a=`collection:${e.collection.collection_name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.collection.collection_name,type:"collection",count:1})}if(e.schema.schema_name.toLowerCase().includes(a)){const a=`schema:${e.schema.schema_name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.schema.schema_name,type:"schema",count:1})}}),Array.from(t.values()).sort((e,t)=>(t.count||0)-(e.count||0)).slice(0,8)},[s]);i.useEffect(()=>{const e=lt(le);ue(e)},[le,lt]);const ct=i.useMemo(()=>s.filter(e=>{const t=""===oe||e.name.toLowerCase().includes(oe.toLowerCase())||e.collection.collection_name.toLowerCase().includes(oe.toLowerCase())||e.schema.schema_name.toLowerCase().includes(oe.toLowerCase()),a="all"===pe||"pixals"===pe&&"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name||"waxrock"===pe&&"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name&&e.data?.WaxRock&&"none"!==e.data.WaxRock||"ingredients"===pe&&"pixeljourney"===e.collection.collection_name&&"ingredients"===e.schema.schema_name||"packs"===pe&&_a.isPackNFT(e);return t&&a}).sort((e,t)=>{switch(xe){case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"collection_asc":return e.collection.collection_name.localeCompare(t.collection.collection_name);case"collection_desc":return t.collection.collection_name.localeCompare(e.collection.collection_name);case"mint_asc":return(e.mint_number||0)-(t.mint_number||0);case"mint_desc":return(t.mint_number||0)-(e.mint_number||0);default:return 0}}),[s,oe,pe,xe]),ot=ct.length;i.useEffect(()=>{const e=Math.ceil(ot/Je);Ve(Math.max(1,e))},[ot]);const dt=i.useMemo(()=>{const e=(Oe-1)*Je,t=e+Je;return ct.slice(e,t)},[ct,Oe,Je]),ht=i.useCallback(()=>{Oe<qe&&Be(e=>e+1)},[Oe,qe]),ut=i.useCallback(()=>{Oe>1&&Be(e=>e-1)},[Oe]);return i.useEffect(()=>{Be(1)},[pe,ve,oe,xe]),Ge?H.jsxs("div",{className:"inventory-container",children:[H.jsxs("div",{className:"inventory-header",children:[H.jsx("h1",{className:"inventory-title",children:"My NFT Inventory"}),H.jsxs("div",{className:"inventory-action-buttons",children:[H.jsx("button",{className:"btn inventory-action-btn craft-btn",onClick:()=>{U(!0)},title:"Open crafting interface",children:"\ud83d\udd28 Craft"}),H.jsx("button",{className:"btn btn-success inventory-action-btn",onClick:async()=>{if(Ye&&Qe)try{const e=await Ma.claimAllRewards(Qe,"pixeljourney");e.success?a("Rewards Claimed Successfully","All pending rewards have been claimed and transferred to your wallet!"):n("Claim Failed",e.error||"Failed to claim rewards")}catch(e){n("Claim Failed",e instanceof Error?e.message:"An unexpected error occurred")}else n("Wallet Required","Please connect your wallet first")},title:"Claim all pending staking rewards",disabled:!Ye||!Qe,children:"\ud83d\udcb0 Claim"})]})]}),H.jsxs("div",{className:"inventory-page-filters",children:[H.jsx(oa,{searchTerm:le,onSearchChange:e=>{ce(e),Be(1)},suggestions:he,placeholder:"Search NFTs by name, collection, or schema...",showFilters:!1,className:"inventory-search"}),H.jsxs("div",{className:"inventory-controls",children:[H.jsxs("div",{className:"inventory-filter-tabs",children:[H.jsx("button",{className:"inventory-filter-tab "+("all"===pe?"active":""),onClick:()=>{fe("all"),Be(1)},children:"All NFTs"}),H.jsx("button",{className:"inventory-filter-tab "+("pixals"===pe?"active":""),onClick:()=>{fe("pixals"),Be(1)},children:"Pixals"}),H.jsx("button",{className:"inventory-filter-tab "+("waxrock"===pe?"active":""),onClick:()=>{fe("waxrock"),Be(1)},children:"WaxRock"}),H.jsx("button",{className:"inventory-filter-tab "+("ingredients"===pe?"active":""),onClick:()=>{fe("ingredients"),Be(1)},children:"Ingredients"}),H.jsx("button",{className:"inventory-filter-tab "+("packs"===pe?"active":""),onClick:()=>{fe("packs"),Be(1)},children:"Packs"})]}),H.jsxs("div",{className:"enhanced-filters",children:[H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{children:"Sort by:"}),H.jsxs("select",{value:xe,onChange:e=>{Ce(e.target.value),Be(1)},className:"sort-select",children:[H.jsx("option",{value:"transferred",children:"Latest Received"}),H.jsx("option",{value:"created",children:"Latest Created"}),H.jsx("option",{value:"updated",children:"Recently Updated"}),H.jsx("option",{value:"minted",children:"Latest Minted"}),H.jsx("option",{value:"asset_id",children:"Asset ID"}),H.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),H.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),H.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),H.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),H.jsx("option",{value:"mint_asc",children:"Mint Number (Low-High)"}),H.jsx("option",{value:"mint_desc",children:"Mint Number (High-Low)"})]})]}),H.jsxs("div",{className:"collection-filter-container",children:[H.jsx("label",{children:"Collection:"}),H.jsxs("select",{value:ve,onChange:e=>{ye(e.target.value),Be(1)},className:"collection-select",children:[H.jsx("option",{value:"all",children:"All Collections"}),Pe.filter(e=>"string"==typeof e&&e.toLowerCase().includes(Se.toLowerCase())).map(e=>H.jsx("option",{value:e,children:e},e))]})]}),H.jsxs("div",{className:"schema-filter-container",children:[H.jsx("label",{children:"Schema:"}),H.jsxs("select",{value:ge,onChange:e=>{be(e.target.value),Be(1)},className:"schema-select",children:[H.jsx("option",{value:"all",children:"All Schemas"}),Fe.map(e=>H.jsx("option",{value:e,children:e},e))]})]}),H.jsxs("div",{className:"template-filter-container",children:[H.jsx("label",{children:"Template ID:"}),H.jsx("input",{type:"text",placeholder:"Enter template ID...",value:Ne,onChange:e=>{we(e.target.value),Be(1)},className:"template-input"})]}),H.jsxs("button",{className:"advanced-filters-toggle "+(Ie?"active":""),onClick:()=>Me(!Ie),children:[Ie?"\u25bc":"\u25b6"," Advanced Filters"]})]}),Ie&&H.jsxs("div",{className:"advanced-filters-panel",children:[H.jsxs("div",{className:"date-range-filter",children:[H.jsx("label",{children:"Date Range:"}),H.jsxs("div",{className:"date-inputs",children:[H.jsx("input",{type:"date",value:Le.start,onChange:e=>{Re(t=>({...t,start:e.target.value})),Be(1)},className:"date-input",placeholder:"Start date"}),H.jsx("span",{children:"to"}),H.jsx("input",{type:"date",value:Le.end,onChange:e=>{Re(t=>({...t,end:e.target.value})),Be(1)},className:"date-input",placeholder:"End date"})]})]}),H.jsx("div",{className:"filter-actions",children:H.jsx("button",{className:"clear-filters-btn",onClick:()=>{ye("all"),be("all"),we(""),Re({start:"",end:""}),ce(""),Ce("transferred"),_e("desc"),Be(1)},children:"Clear All Filters"})})]})]}),L.size>0&&H.jsxs("div",{className:"bulk-actions-toolbar",children:[H.jsxs("div",{className:"selection-info",children:[H.jsxs("span",{children:[L.size," item",1!==L.size?"s":""," selected"]}),L.size>0&&H.jsx("button",{className:"clear-selection",onClick:()=>{W(new Set)},children:"Clear"}),H.jsx("button",{className:"select-all",onClick:()=>{const e=new Set(ct.map(e=>e.asset_id));if(e.size>0&&[...e].every(e=>L.has(e))){const t=new Set(L);e.forEach(e=>t.delete(e)),W(t)}else{const t=new Set([...L,...e]);W(t)}},children:(()=>{const e=new Set(ct.map(e=>e.asset_id));return e.size>0&&[...e].every(e=>L.has(e))?"Deselect All":"Select All"})()})]}),L.size>0&&H.jsxs("div",{className:"bulk-actions",children:[H.jsxs("button",{className:"bulk-btn list-btn",onClick:()=>{0!==L.size&&N(!0)},children:["\ud83d\udcb0 List (",L.size,")"]}),H.jsxs("button",{className:"bulk-btn auction-btn",onClick:()=>{0!==L.size&&$(!0)},children:["\ud83c\udfc6 Auction (",L.size,")"]}),H.jsxs("button",{className:"bulk-btn transfer-btn",onClick:()=>{0!==L.size&&k(!0)},children:["\ud83d\udce4 Transfer (",L.size,")"]}),H.jsxs("button",{className:"bulk-btn distribute-btn",onClick:()=>{0!==L.size&&C(!0)},children:["\ud83c\udfaf Distribute (",L.size,")"]}),H.jsxs("button",{className:"bulk-btn burn-btn",onClick:()=>{0!==L.size&&_(!0)},children:["\ud83d\udd25 Burn (",L.size,")"]}),H.jsxs("button",{className:"bulk-btn stake-btn",onClick:async()=>{if(0===L.size)return;if(!Ye||!Qe)return void n("Wallet Required","Please connect your wallet first");const e=s.filter(e=>L.has(e.asset_id)),t=e.filter(e=>"pixeljourney"===e.collection.collection_name);if(0!==t.length){t.length!==e.length&&(e.length,t.length);try{const e=t.map(e=>e.asset_id),i=await Ma.stakeNFTsPixelJourney(Qe,e,"pixeljourney");i.success?(a("NFTs Staked Successfully",`${t.length} NFT${t.length>1?"s have":" has"} been staked successfully!`),W(new Set),O(!1),await Ze()):n("Staking Failed",i.error||"Failed to stake NFTs")}catch(i){n("Staking Failed",i instanceof Error?i.message:"An unexpected error occurred")}}else n("No Stakeable NFTs","Only Pixel Journey NFTs can be staked. Please select some Pixel Journey assets.")},children:["\ud83e\udd69 Stake (",L.size,")"]}),(()=>{const e=s.filter(e=>L.has(e.asset_id)).filter(e=>_a.isPixelPack(e)).length;return H.jsx(H.Fragment,{children:e>0&&H.jsxs("button",{className:"bulk-btn unpack-btn",onClick:st,children:["\ud83d\udce6 Unpack Pixelpacks (",e,")"]})})})()]})]})]}),o&&H.jsxs("div",{className:"loading-container",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading your NFTs..."})]}),!o&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"inventory-page-stats",children:H.jsxs("p",{children:[ot," NFTs found"]})}),s.length>0?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"inventory-page-grid",children:dt.map(e=>H.jsx(Wa,{nft:e,selectedNFTs:L,isSelected:L.has(e.asset_id),settings:t,dropdownOpen:B,onNFTClick:at,onCollectionClick:nt,onSchemaClick:it,onToggleSelection:rt,onDropdownToggle:e=>j(B===e?null:e),onListingOpen:e=>{M(e),p(!0)},onTransferOpen:e=>{M(e),v(!0)},onBurnOpen:e=>{M(e),g(!0)},onAuctionOpen:e=>{M(e),E(!0),j(null)},onRecyclePixal:e=>{(async e=>{if(Ye&&Qe){if(me.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&me.isValidWaxRock(t))return void n("WaxRock Protection",`This is a rare WaxRock Pixal PFP (${t}) and cannot be recycled. WaxRock Pixals are protected from burning and recycling on our platform.`)}try{if(!(await r("Confirm Recycle",`Are you sure you want to recycle ${e.name}?\n\nThis will cost 12,000 PXJ tokens and cannot be undone.`,"Recycle","Cancel")))return;const t=await _a.recyclePixal(e.asset_id,Ye);await _a.executeRecycle(t,Qe),a("Recycle Successful","Pixal recycled successfully!"),await Ze()}catch(t){se.error("Recycle failed","Inventory",t),n("Recycle Failed",t instanceof Error?t.message:"Unknown error occurred")}}else n("Wallet Required","Please connect your wallet first")})(e),j(null)},onImageZoom:re,onCraftingOpen:e=>{(e=>{z(e),U(!0)})(e),j(null)},onViewOffers:e=>{(e=>{G(e),q(!0)})(e),j(null)},onUnpackPixelPack:e=>{(async e=>{if(Ye&&Qe)try{if(!(await r("Confirm Unpack",`Are you sure you want to unpack ${e.name}?\n\nThis action cannot be undone.`,"Unpack","Cancel")))return;const t=await _a.unpackPixelPack(e.asset_id,Ye);await _a.executeUnpack(t,Qe),a("Unpack Successful","Pixelpack unpacked successfully!"),await Ze()}catch(t){se.error("Unpack failed","Inventory",t),n("Unpack Failed",t instanceof Error?t.message:"Unknown error occurred")}else n("Wallet Required","Please connect your wallet first")})(e),j(null)},onStakeOpen:e=>{(async e=>{if(Ye&&Qe)if("pixeljourney"===e.collection.collection_name)try{if(!(await r("Confirm Staking",`Are you sure you want to stake ${e.name}?\n\nYour assets will remain in your inventory as the Pixel Journey uses non-custodial staking.`,"Stake NFT","Cancel")))return;const t=await Ma.stakeNFTsPixelJourney(Qe,[e.asset_id],"pixeljourney");t.success?(a("NFT Staked Successfully",`${e.name} has been staked successfully!`),await Ze()):n("Staking Failed",t.error||"Failed to stake NFT")}catch(t){n("Staking Failed",t instanceof Error?t.message:"An unexpected error occurred")}else n("Invalid Asset","Only Pixel Journey NFTs can be staked");else n("Wallet Required","Please connect your wallet first")})(e),j(null)},onTokenizePixal:e=>{(async e=>{Ye&&Qe?me.isPixalPFP(e.template.template_id)?(ee(e),K(!0)):n("Invalid NFT","Only Pixal PFPs can be tokenized into WPIXAL"):n("Wallet Required","Please connect your wallet first")})(e),j(null)}},e.asset_id))}),qe>1&&H.jsxs("div",{className:"pagination-controls",children:[H.jsx("button",{className:"pagination-btn",onClick:ut,disabled:1===Oe,children:"\u2190 Previous"}),H.jsxs("div",{className:"pagination-info",children:[H.jsxs("span",{children:["Page ",Oe," of ",qe]}),H.jsxs("span",{className:"pagination-items",children:["(",ot," total items)"]})]}),H.jsx("button",{className:"pagination-btn",onClick:ht,disabled:Oe===qe,children:"Next \u2192"})]})]}):H.jsxs("div",{className:"empty-inventory",children:[H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"empty-icon",children:H.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M9 1v6m6-6v6"})}),H.jsx("h3",{children:"No NFTs Found"}),H.jsxs("p",{children:["You don't have any ","all"===pe?"Pixel Journey":pe," NFTs yet."]}),H.jsx("p",{children:"Visit the marketplace to start collecting!"}),("waxrock"===pe||"pixals"===pe||"ingredients"===pe)&&H.jsx("div",{className:"empty-inventory-cta",style:{marginTop:"20px"},children:H.jsxs("button",{className:"cta-button",onClick:()=>{e(`/marketplace?category=${{waxrock:"waxrocks",pixals:"pixals",ingredients:"ingredients"}[pe]}`)},style:{background:"linear-gradient(45deg, #4ecdc4, #45b7d1)",border:"none",padding:"12px 24px",borderRadius:"25px",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(78, 205, 196, 0.3)"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(78, 205, 196, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(78, 205, 196, 0.3)"},children:["\ud83d\uded2 Browse ","waxrock"===pe?"WaxRock":pe.charAt(0).toUpperCase()+pe.slice(1)," Marketplace"]})})]}),s.length>0&&H.jsx("div",{className:"load-more-container",children:je?H.jsxs(H.Fragment,{children:[H.jsx("button",{className:"load-more-btn",onClick:et,disabled:Ue||ze,children:Ue?"Loading...":"Load More NFTs"}),H.jsx("button",{className:"load-more-btn load-all-btn",onClick:tt,disabled:Ue||ze,style:{marginLeft:"10px",backgroundColor:"var(--success-color)"},children:ze?"Loading All...":"Load All NFTs"})]}):H.jsxs("div",{className:"pagination-info",children:[H.jsxs("p",{children:["\ud83d\udcc4 Page ",Oe," - All NFTs loaded (",s.length," total)"]}),H.jsx("p",{style:{fontSize:"0.9em",color:"var(--text-secondary)",marginTop:"5px"},children:"No more items to load"})]})})]}),H.jsx(ia,{nft:I?{sale_id:"",asset_id:I.asset_id,name:I.name,image:I.img,video:I.video,price:"Not for sale",seller:Ye||"",collection:I.collection.collection_name,schema:I.schema.schema_name,template_mint:I.mint_number,max_supply:I.template.max_supply,traits:I.data}:null,isOpen:h,onClose:()=>u(!1)}),H.jsx(ua,{nft:I,isOpen:m,onClose:()=>{p(!1),M(null)},onSuccess:()=>{Ze()}}),H.jsx(ma,{nft:I,isOpen:f,onClose:()=>{v(!1),M(null)},onSuccess:()=>{Ze()}}),H.jsx(pa,{nft:I,isOpen:y,onClose:()=>{g(!1),M(null)},onSuccess:()=>{Ze()}}),H.jsx(xa,{isOpen:D,onClose:()=>{U(!1),z(null)},ingredient:X}),H.jsx(Aa,{nft:V,isOpen:J,onClose:()=>{q(!1),G(null)}}),H.jsx(Ia,{nft:Z,isOpen:Y,onClose:()=>{K(!1),ee(null)},onSuccess:()=>{K(!1),ee(null),Ze()}}),H.jsx(fa,{nfts:s.filter(e=>L.has(e.asset_id)),isOpen:b,onClose:()=>{N(!1)},onSuccess:()=>{W(new Set),O(!1),Ze()}}),H.jsx(va,{nfts:s.filter(e=>L.has(e.asset_id)),isOpen:w,onClose:()=>{k(!1)},onSuccess:()=>{W(new Set),O(!1),Ze()}}),H.jsx(ya,{nfts:s.filter(e=>L.has(e.asset_id)),isOpen:x,onClose:()=>{C(!1)},onSuccess:()=>{W(new Set),O(!1),Ze()}}),H.jsx(ga,{nfts:s.filter(e=>L.has(e.asset_id)),isOpen:A,onClose:()=>{_(!1)},onSuccess:()=>{W(new Set),O(!1),Ze()}}),H.jsx(Sa,{selectedNFTs:s.filter(e=>L.has(e.asset_id)),isOpen:S,onClose:()=>{P(!1)},userAccount:Ye||"",walletSession:Qe,onUnpackComplete:()=>{W(new Set),O(!1),Ze(1,!1),a("Packs unpacked successfully!")}}),H.jsx($a,{nfts:s.filter(e=>L.has(e.asset_id)),isOpen:T,onClose:()=>{$(!1)},onSuccess:()=>{W(new Set),O(!1),Ze()}}),I&&H.jsx($a,{nfts:[I],isOpen:F,onClose:()=>{E(!1),M(null)},onSuccess:()=>{Ze()}}),ne&&te&&H.jsx("div",{className:"image-zoom-modal",onClick:()=>ie(!1),children:H.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsx("button",{className:"zoom-modal-close",onClick:()=>ie(!1),"aria-label":"Close zoom modal",children:"\xd7"}),"video"===te.type?H.jsx("video",{src:te.url,className:"zoom-modal-video",controls:!0,autoPlay:!0,muted:!0,loop:!0,children:"Your browser does not support the video tag."}):H.jsx("img",{src:te.url,alt:te.name,className:"zoom-modal-image"}),H.jsx("div",{className:"zoom-modal-title",children:te.name})]})})]}):H.jsxs("div",{className:"inventory-page",children:[H.jsxs("div",{className:"inventory-page-header",children:[H.jsx("h1",{className:"inventory-page-title",children:"My NFT Inventory"}),H.jsx("p",{className:"inventory-page-subtitle",children:"View and manage your Pixel Journey NFTs"})]}),H.jsx("div",{className:"connect-wallet-prompt",children:H.jsxs("div",{className:"connect-wallet-card",children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"wallet-icon",children:[H.jsx("path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"}),H.jsx("path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"}),H.jsx("circle",{cx:"18",cy:"12",r:"2"})]}),H.jsx("h3",{children:"Connect Your Wallet"}),H.jsx("p",{children:"Connect your wallet to view your NFT inventory and manage your Pixel Journey assets."}),H.jsx("button",{className:"btn-primary",onClick:Ke,children:"Connect Wallet"})]})})]})}),Oa=r.memo(({text:e,maxLength:t=240,className:a=""})=>{const[n,r]=i.useState(!1);if(!e||e.length<=t)return H.jsx("span",{className:a,children:e});const s=e.slice(0,t).trim();return H.jsx("span",{className:a,children:n?H.jsxs(H.Fragment,{children:[e,H.jsx("button",{className:"read-more-btn collapse-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),r(!1)},children:"read less"})]}):H.jsxs(H.Fragment,{children:[s,s.endsWith(".")?"":"...",H.jsx("button",{className:"read-more-btn expand-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),r(!0)},children:"read more"})]})})});Oa.displayName="TruncatedText";const Ba=new class{constructor(){t(this,"requestQueue",[]),t(this,"isProcessing",!1),t(this,"gatewayStats",new Map),t(this,"MIN_REQUEST_INTERVAL",200),t(this,"MAX_CONCURRENT_REQUESTS",3),t(this,"MAX_RETRIES",3),t(this,"GATEWAY_COOLDOWN",3e4),t(this,"REQUEST_TIMEOUT",1e4),t(this,"activeRequests",0),t(this,"lastRequestTime",0)}async requestImage(e){return new Promise((t,a)=>{const n={url:e,resolve:t,reject:a,retryCount:0,timestamp:Date.now()};this.requestQueue.push(n),this.processQueue()})}async processQueue(){if(!this.isProcessing&&0!==this.requestQueue.length){for(this.isProcessing=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){const e=this.requestQueue.shift();if(!e)break;if(Date.now()-e.timestamp>this.REQUEST_TIMEOUT){e.reject(new Error("Request timeout in queue"));continue}const t=Date.now()-this.lastRequestTime;if(t<this.MIN_REQUEST_INTERVAL){const e=this.MIN_REQUEST_INTERVAL-t;await this.delay(e)}this.lastRequestTime=Date.now(),this.activeRequests++,this.processRequest(e).finally(()=>{this.activeRequests--,setTimeout(()=>this.processQueue(),0)})}this.isProcessing=!1}}async processRequest(e){try{const t=this.selectBestGateway(e.url);if(!t)throw new Error("No available gateways");const a=await this.makeRequest(e.url,t);this.updateGatewayStats(t,!0),e.resolve(a)}catch(t){const a=this.extractGateway(e.url);if(a&&this.updateGatewayStats(a,!1),e.retryCount<this.MAX_RETRIES)e.retryCount++,re.warn(`Retrying IPFS request (${e.retryCount}/${this.MAX_RETRIES})`,"IPFSRateLimiter",{url:e.url,error:t instanceof Error?t.message:"Unknown error"}),await this.delay(1e3*e.retryCount),this.requestQueue.unshift(e);else{const a=t instanceof Error?t:new Error(String(t));re.error("IPFS request failed after all retries","IPFSRateLimiter",a,{url:e.url}),e.reject(a)}}}async makeRequest(e,t){const a=this.extractIPFSHash(e);if(!a)throw new Error("Invalid IPFS URL");const n=`${t}${a}`;return new Promise((e,t)=>{const a=new Image,i=setTimeout(()=>{a.onload=null,a.onerror=null,t(new Error("Request timeout"))},this.REQUEST_TIMEOUT);a.onload=()=>{clearTimeout(i),e(n)},a.onerror=e=>{clearTimeout(i),t(new Error(`Failed to load image: ${e}`))},a.src=n})}selectBestGateway(e){const t=Date.now(),a=["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://dweb.link/ipfs/","https://cf-ipfs.com/ipfs/"].filter(e=>{const a=this.gatewayStats.get(e);return!a||!(a.isBlocked&&t<a.blockUntil)&&(a.isBlocked&&t>=a.blockUntil&&(a.isBlocked=!1,a.errorCount=0),!0)});return 0===a.length?null:(a.sort((e,t)=>{const a=this.gatewayStats.get(e),n=this.gatewayStats.get(t);return(a?a.errorCount/Math.max(a.requestCount,1):0)-(n?n.errorCount/Math.max(n.requestCount,1):0)}),a[0])}updateGatewayStats(e,t){let a=this.gatewayStats.get(e);if(a||(a={lastRequest:0,requestCount:0,errorCount:0,isBlocked:!1,blockUntil:0},this.gatewayStats.set(e,a)),a.lastRequest=Date.now(),a.requestCount++,!t){a.errorCount++;const t=a.errorCount/a.requestCount;t>.5&&a.requestCount>=5&&(a.isBlocked=!0,a.blockUntil=Date.now()+this.GATEWAY_COOLDOWN,re.warn("Blocking gateway due to high error rate","IPFSRateLimiter",{gateway:e,errorRate:t,requestCount:a.requestCount,errorCount:a.errorCount}))}}extractIPFSHash(e){const t=e.match(/\/ipfs\/([a-zA-Z0-9]+)/);return t?t[1]:null}extractGateway(e){const t=e.match(/(https?:\/\/[^\/]+\/ipfs\/)/);return t?t[1]:null}delay(e){return new Promise(t=>setTimeout(t,e))}getStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,gatewayStats:Object.fromEntries(this.gatewayStats)}}reset(){this.requestQueue.forEach(e=>{e.reject(new Error("Rate limiter reset"))}),this.requestQueue=[],this.gatewayStats.clear(),this.activeRequests=0,this.isProcessing=!1}},ja=new class{constructor(){t(this,"imageCache",new Map),t(this,"loadingPromises",new Map),t(this,"MAX_CACHE_SIZE",500)}generateFallbackSVG(e={}){const{width:t=150,height:a=150,backgroundColor:n="#f3f4f6",textColor:i="#6b7280",text:r,type:s="generic"}=e,l=r||this.getDefaultText(s),c=.15*Math.min(t,a),o=`\n      <svg width="${t}" height="${a}" xmlns="http://www.w3.org/2000/svg">\n        <rect width="100%" height="100%" fill="${n}"/>\n        <g transform="translate(${t/2}, ${a/2})">\n          ${this.getIconForType(s,.3*Math.min(t,a),i)}\n          <text \n            x="0" \n            y="${1.5*c}" \n            font-family="system-ui, -apple-system, sans-serif" \n            font-size="${c}" \n            font-weight="500" \n            fill="${i}" \n            text-anchor="middle" \n            dominant-baseline="middle"\n          >\n            ${l}\n          </text>\n        </g>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(o)}`}getDefaultText(e){switch(e){case"nft":return"NFT";case"collection":return"Collection";case"avatar":return"Avatar";case"token":return"Token";default:return"Image"}}getIconForType(e,t,a){const n=t,i=Math.max(1,.08*n);switch(e){case"nft":return`\n          <rect \n            x="${-n/2}" \n            y="${-n/2}" \n            width="${n}" \n            height="${n}" \n            rx="${.1*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n          <circle \n            cx="0" \n            cy="${.15*-n}" \n            r="${.15*n}" \n            fill="${a}"\n          />\n        `;case"collection":return`\n          <rect \n            x="${-n/2}" \n            y="${-n/2}" \n            width="${.7*n}" \n            height="${.7*n}" \n            rx="${.05*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n          <rect \n            x="${-n/2+.15*n}" \n            y="${-n/2+.15*n}" \n            width="${.7*n}" \n            height="${.7*n}" \n            rx="${.05*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n        `;case"avatar":return`\n          <circle \n            cx="0" \n            cy="${.1*-n}" \n            r="${.25*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n          <path \n            d="M ${.35*-n} ${.3*n} Q 0 ${.1*n} ${.35*n} ${.3*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n        `;case"token":return`\n          <circle \n            cx="0" \n            cy="0" \n            r="${.4*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n          <text \n            x="0" \n            y="${.1*n}" \n            font-family="system-ui, -apple-system, sans-serif" \n            font-size="${.3*n}" \n            font-weight="bold" \n            fill="${a}" \n            text-anchor="middle" \n            dominant-baseline="middle"\n          >\n            $\n          </text>\n        `;default:return`\n          <rect \n            x="${-n/2}" \n            y="${-n/2}" \n            width="${n}" \n            height="${n}" \n            rx="${.1*n}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${i}"\n          />\n          <path \n            d="M ${.2*-n} ${.1*-n} L ${.2*n} ${.1*-n} L 0 ${.2*n} Z" \n            fill="${a}"\n          />\n        `}}async loadImage(e,t={}){if(!e)return{success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0};const a=this.imageCache.get(e);if(a)return{success:!0,src:a,fallbackUsed:!1};const n=this.loadingPromises.get(e);if(n)return n;const i=this.performImageLoad(e,t);this.loadingPromises.set(e,i);try{return await i}finally{this.loadingPromises.delete(e)}}async performImageLoad(e,t){if(this.isIPFSUrl(e))try{const t=await(a=e,Ba.requestImage(a));return this.addToCache(e,t),{success:!0,src:t,fallbackUsed:!1}}catch(n){return re.warn(`IPFS rate-limited load failed: ${e}`,"ImageService",{error:n}),{success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0,error:n instanceof Error?n:new Error("IPFS load failed")}}var a;return new Promise(a=>{const n=new Image,i=setTimeout(()=>{n.onload=null,n.onerror=null,a({success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0,error:new Error("Image load timeout")})},1e4);n.onload=()=>{clearTimeout(i),this.addToCache(e,e),a({success:!0,src:e,fallbackUsed:!1})},n.onerror=n=>{clearTimeout(i);const r=this.generateFallbackSVG(t);re.warn(`Failed to load image: ${e}`,"ImageService",{error:n}),a({success:!1,src:r,fallbackUsed:!0,error:n instanceof Error?n:new Error("Image load failed")})},n.src=e})}addToCache(e,t){if(this.imageCache.size>=this.MAX_CACHE_SIZE){const e=this.imageCache.keys().next().value;e&&this.imageCache.delete(e)}this.imageCache.set(e,t)}async preloadImages(e,t={}){const a=e.map(e=>this.loadImage(e,t));return Promise.all(a)}getOptimizedImageUrl(e,t={}){return e?e.startsWith("data:")||e.startsWith("blob:")?e:e.includes("ipfs.io")||e.includes("ipfs://")?this.optimizeIPFSUrl(e):e:this.generateFallbackSVG(t)}isIPFSUrl(e){return e.includes("/ipfs/")||e.startsWith("ipfs://")||e.includes("gateway.pinata.cloud")}optimizeIPFSUrl(e){return this.isIPFSUrl(e),e}clearCache(){this.imageCache.clear(),this.loadingPromises.clear()}getCacheStats(){return{size:this.imageCache.size,maxSize:this.MAX_CACHE_SIZE,hitRate:0}}},Da=({src:e,alt:t,className:a="",style:n={},width:r,height:s,type:l="generic",fallbackText:c,backgroundColor:o,textColor:d,onLoad:h,onError:u,loading:m="lazy",placeholder:p=!0})=>{const[f,v]=i.useState(""),[y,g]=i.useState(!0),[b,N]=i.useState(null),w=i.useRef(null),k=i.useRef(!1);i.useEffect(()=>{k.current||(k.current=!0,(async()=>{g(!0);const t={width:r,height:s,type:l,text:c,backgroundColor:o,textColor:d};try{const a=await ja.loadImage(e||"",t);v(a.src),N(a),h&&h(a),!a.success&&a.error&&u&&u(a.error)}catch(a){const e=ja.generateFallbackSVG(t);v(e),N({success:!1,src:e,fallbackUsed:!0,error:a}),u&&u(a)}finally{g(!1),k.current=!1}})())},[e,r,s,l,c,o,d,h,u]);const x={...n,...r&&{width:r},...s&&{height:s}},C=`fallback-image ${a} ${y?"loading":""} ${b?.fallbackUsed?"fallback-used":""}`.trim();return H.jsxs("div",{className:"fallback-image-container",style:{position:"relative",display:"inline-block"},children:[y&&p&&H.jsx("div",{className:"image-placeholder",style:{position:"absolute",top:0,left:0,width:r||"100%",height:s||"100%",backgroundColor:o||"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",zIndex:1},children:H.jsx("div",{className:"loading-spinner",style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),H.jsx("img",{ref:w,src:f||"",alt:t,className:C,style:{...x,opacity:y?0:1,transition:"opacity 0.3s ease"},loading:m,onLoad:()=>{g(!1)},onError:()=>{if(b&&!b.fallbackUsed){const e={width:r,height:s,type:l,text:c,backgroundColor:o,textColor:d},t=ja.generateFallbackSVG(e);v(t),N({success:!1,src:t,fallbackUsed:!0})}g(!1)}}),H.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        .fallback-image {\n          display: block;\n          max-width: 100%;\n          height: auto;\n        }\n        \n        .fallback-image.loading {\n          opacity: 0;\n        }\n        \n        .fallback-image.fallback-used {\n          filter: grayscale(0.1);\n        }\n        \n        .image-placeholder {\n          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n          background-size: 200% 100%;\n          animation: shimmer 1.5s infinite;\n        }\n        \n        @keyframes shimmer {\n          0% { background-position: -200% 0; }\n          100% { background-position: 200% 0; }\n        }\n      "})]})},Ua=e=>H.jsx(Da,{...e,type:"nft"}),Xa=e=>H.jsx(Da,{...e,type:"collection"}),za=e=>H.jsx(Da,{...e,type:"token"}),Ha=[{id:"bronze",name:"Bronze",cost:5e6,costFormatted:"5M PXJ",icon:"\ud83e\udd49",description:"Perfect for new collections getting started",benefits:["Basic marketplace listing","Collection verification badge","Community Discord access","Monthly featured spot rotation"]},{id:"silver",name:"Silver",cost:15e6,costFormatted:"15M PXJ",icon:"\ud83e\udd48",description:"Enhanced visibility and analytics access",benefits:["All Bronze benefits","Priority marketplace placement","Weekly newsletter mentions","Custom collection banner","Analytics dashboard access"]},{id:"gold",name:"Gold",cost:3e7,costFormatted:"30M PXJ",icon:"\ud83e\udd47",description:"Premium promotion and exclusive events",benefits:["All Silver benefits","Homepage featured carousel","Social media promotion","Exclusive events participation","Direct community manager contact"]},{id:"platinum",name:"Platinum",cost:5e7,costFormatted:"50M PXJ",icon:"\ud83d\udc8e",description:"Ultimate tier with maximum benefits",benefits:["All Gold benefits","Permanent homepage presence","Dedicated marketing campaigns","WaxRock Council consideration","Platform governance participation","White-label marketplace options"]}],Ja=({isOpen:e,onClose:t})=>{const[a,n]=i.useState(""),[s,l]=i.useState(""),[c,o]=i.useState(!1),[d,h]=i.useState(null),[u,m]=i.useState(!1),{session:p,isConnected:f}=Q(),{showSuccess:v,showError:y}=We();r.useEffect(()=>{e&&f&&p&&g()},[e,f,p]);const g=async()=>{if(p){m(!0);try{const e=await $e.getWaxCurrencyBalance(p.actor?.toString()||"","token.pxj","PXJ"),t=e.length>0?parseFloat(e[0].balance.split(" ")[0]):0;h(t)}catch(e){se.error("Failed to fetch PXJ balance","CollectionTierModal",e),h(0)}finally{m(!1)}}},b=Ha.find(e=>e.id===a);return e?H.jsx("div",{className:"modal-backdrop",onClick:t,children:H.jsxs("div",{className:"modal-content collection-tier-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{className:"modal-title",children:"Upgrade Collection Tier"}),H.jsx("button",{className:"modal-close",onClick:t,children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),H.jsxs("div",{className:"modal-body",children:[H.jsx("div",{className:"balance-section",children:H.jsxs("div",{className:"balance-info",children:[H.jsx("span",{className:"balance-label",children:"Your PXJ Balance:"}),H.jsx("span",{className:"collection-balance-amount",children:u?H.jsx("span",{className:"loading-text",children:"Loading..."}):H.jsx("span",{className:null!==d&&d>0?"balance-positive":"balance-zero",children:null!==d?`${d.toLocaleString()} PXJ`:"Unable to load"})})]})}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"collectionName",children:"Collection Name:"}),H.jsx("input",{type:"text",id:"collectionName",value:s,onChange:e=>l(e.target.value),placeholder:"Enter your collection name",className:"collection-input",disabled:c})]}),H.jsxs("div",{className:"tier-selection",children:[H.jsx("h3",{children:"Select Tier:"}),H.jsx("div",{className:"tier-grid",children:Ha.map(e=>{const t=(e=>null!==d&&d>=e.cost)(e),i=a===e.id;return H.jsxs("div",{className:`tier-card ${i?"selected":""} ${t?"":"unaffordable"}`,onClick:()=>!c&&n(e.id),children:[H.jsxs("div",{className:"tier-header",children:[H.jsx("span",{className:"tier-icon",children:e.icon}),H.jsxs("div",{className:"tier-info",children:[H.jsx("h4",{className:"tier-name",children:e.name}),H.jsx("div",{className:"tier-cost",children:e.costFormatted})]}),!t&&H.jsx("div",{className:"insufficient-badge",children:"Insufficient Balance"})]}),H.jsx("p",{className:"tier-description",children:e.description}),H.jsxs("div",{className:"tier-benefits",children:[H.jsx("h5",{children:"Benefits:"}),H.jsx("ul",{children:e.benefits.map((e,t)=>H.jsx("li",{children:e},t))})]})]},e.id)})})]}),b&&H.jsxs("div",{className:"selected-tier-summary",children:[H.jsx("h4",{children:"Upgrade Summary"}),H.jsxs("div",{className:"summary-content",children:[H.jsxs("div",{className:"summary-item",children:[H.jsx("span",{children:"Collection:"}),H.jsx("span",{children:s||"Not specified"})]}),H.jsxs("div",{className:"summary-item",children:[H.jsx("span",{children:"Tier:"}),H.jsxs("span",{children:[b.icon," ",b.name]})]}),H.jsxs("div",{className:"summary-item",children:[H.jsx("span",{children:"Cost:"}),H.jsx("span",{children:b.costFormatted})]}),H.jsxs("div",{className:"summary-item",children:[H.jsx("span",{children:"Remaining Balance:"}),H.jsx("span",{children:null!==d?`${(d-b.cost).toLocaleString()} PXJ`:"Unknown"})]})]})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"btn-secondary",onClick:t,disabled:c,children:"Cancel"}),H.jsx("button",{className:"btn-primary",onClick:async()=>{if(!a||!s.trim())return void y("Please select a tier and enter a collection name");if(!f||!p)return void y("Please connect your wallet to proceed with payment");const e=Ha.find(e=>e.id===a);if(e)if(null!==d&&d<e.cost)y(`Insufficient PXJ balance. You need at least ${e.costFormatted} to upgrade to ${e.name} tier.`);else{o(!0);try{const a=`upgrade-collection:${s.toUpperCase()}:${e.id.toUpperCase()}`,i={account:"token.pxj",name:"transfer",authorization:[{actor:p.actor?.toString()||"",permission:"active"}],data:{from:p.actor?.toString()||"",to:"market.pxj",quantity:`${e.cost.toFixed(8)} PXJ`,memo:a}};await Lt.transact([i]),v(`Successfully upgraded ${s} to ${e.name} tier! Your upgrade will be processed by our team.`),t(),n(""),l("")}catch(i){se.error("Tier upgrade payment failed","CollectionTierModal",i instanceof Error?i:new Error(String(i))),y(`Payment failed: ${i instanceof Error?i.message:"Unknown error"}`)}finally{o(!1)}}else y("Invalid tier selected")},disabled:c||!a||!s.trim()||!f||b&&null!==d&&d<b.cost,children:c?H.jsxs(H.Fragment,{children:[H.jsx("span",{className:"loading-spinner"}),"Processing..."]}):`Upgrade to ${b?.name||"Selected Tier"}`})]})]})}):null},qa=()=>{const[e,t]=i.useState([]),[a,n]=i.useState(!1),[r,l]=i.useState(null),[c,o]=i.useState(!1),[d,h]=i.useState(""),[u,m]=i.useState("name"),[p,f]=i.useState(12),[v,y]=i.useState(!1),[g,b]=i.useState(!1),[N,w]=i.useState(0),[k,x]=i.useState([{name:"Pixel Journey",collection:"pixeljourney",image:null,description:"The original Pixel Journey collection",tier:"platinum",verified:!0},{name:"Fried Factory",collection:"friedfactory",image:null,description:"3D NFT collection by @Friedfactory the 3D legend (and artist of our Journey Ingredients too)!",tier:"partner",verified:!0},{name:"Crypto Muffins",collection:"crptomuffins",image:null,description:"Delicious crypto-themed NFT collection by AKU!",tier:"gold",verified:!0},{name:"Aku Fish Heads",collection:"akufishheads",image:null,description:"Unique AKU-licious NFT collection",tier:"silver",verified:!0},{name:"Pantheon",collection:"pantheon",image:null,description:"Mythological NFT collection",tier:"bronze",verified:!0},{name:"Pocket People",collection:"pocketsizedp",image:null,description:"Pocket Sized PFPs by our first Partner, Kettleman!",tier:"partner",verified:!0},{name:"NIMAs Odyssey",collection:"nimasodyssey",image:null,description:"NIMAs Odyssey, a Discord RPG Driven NFT Mining Game",tier:"partner",verified:!0}]),C=i.useCallback(async()=>{try{x(e=>{const t=e.filter(e=>!e.image);return 0===t.length||Promise.all(t.map(async e=>{try{const t=await $e.getCollectionDetails(e.collection);return{...e,image:t?.img||null}}catch(t){return se.warn(`Failed to fetch image for ${e.collection}`,"Collections",t),e}})).then(e=>{x(t=>t.map(t=>e.find(e=>e.collection===t.collection)||t))}),e})}catch(e){se.error("Failed to fetch PxApproved project images","Collections",e)}},[]),A=async e=>{const a=[...e];for(let t=0;t<e.length;t+=5){const n=e.slice(t,t+5);(await Promise.allSettled(n.map(async(e,n)=>{const i=t+n;try{const[t,n]=await Promise.all([$e.getCollectionFloorPrice(e.collection_name),$e.getCollectionMarketStats({collection_name:e.collection_name})]);return{index:i,data:{...a[i],floor_price:t.floorPrice,volume:n.data?.volume,market_cap:n.data?.volume?(t.floorPrice*parseFloat(n.data.volume)).toFixed(2):void 0,assets:n.data?.sales,loading_market_data:!1}}}catch(r){return ee.logError("Collections.fetchMarketDataForCollections",r,{collection_name:e.collection_name}),{index:i,data:{...a[i],loading_market_data:!1}}}}))).forEach(e=>{"fulfilled"===e.status&&(a[e.value.index]=e.value.data)}),t+5<e.length&&await new Promise(e=>setTimeout(e,100))}t([...a])},_=async(e=50)=>{n(!0),l(null);try{const a=await $e.getCollections({limit:e,whitelistOnly:!0}),n=(a||[]).map(e=>({collection_name:e.collection_name,name:e.name,img:e.img,author:e.author,created_at_time:e.created_at_time,created_at_block:e.created_at_block,loading_market_data:!0}));t(n),w(a?.length||0),A(n)}catch(a){const t=a instanceof Error?a:new Error("Failed to fetch collections");l(t),ee.logError("Collections.fetchCollections",t,{limit:e})}finally{n(!1)}};i.useEffect(()=>{_(),C()},[C]);const S=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.collection_name.toLowerCase().includes(d.toLowerCase())||e.author.toLowerCase().includes(d.toLowerCase())).sort((e,t)=>{switch(u){case"name":return e.name.localeCompare(t.name);case"author":return e.author.localeCompare(t.author);case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();default:return 0}}),P=k.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.collection.toLowerCase().includes(d.toLowerCase())),T=S.slice(0,p),$=S.length>p||N>=50&&p>=S.length;return H.jsxs("div",{className:"collections-container",children:[H.jsxs("div",{className:"perk-tiers-section",children:[H.jsxs("div",{className:"collections-header",children:[H.jsx("h1",{children:"Collections"}),H.jsx("p",{className:"collections-subtitle",children:"Discover amazing NFT collections on the WAX blockchain"})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h3",{children:"PxApproved Collections"}),H.jsx("p",{children:"Only PxApproved collections are listed on our marketplace by default. This ensures quality and authenticity for our community."}),H.jsxs("div",{className:"info-actions",children:[H.jsxs("a",{href:"https://discord.gg/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"discord-link",children:[H.jsx("svg",{className:"discord-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"})}),"Join Discord for More Info"]}),H.jsx("button",{className:"payment-button",onClick:()=>o(!0),children:"Upgrade Collection Tier"}),H.jsxs("button",{className:"toggle-tiers-button",onClick:()=>b(!g),children:[g?"Hide Tier Details":"Show Tier Details",H.jsx("svg",{className:"toggle-icon "+(g?"rotated":""),viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})})]})]})]}),H.jsx("p",{className:"tiers-description",children:"Elevate your collection's status on PxMarket with our tier system. Each tier unlocks exclusive benefits and promotional opportunities."}),g&&H.jsxs("div",{className:"tiers-content",children:[H.jsx("div",{className:"tiers-header",children:H.jsx("h2",{children:"PxApproved Perk Tiers"})}),H.jsxs("div",{className:"tiers-grid",children:[H.jsxs("div",{className:"tier-card tier-bronze",children:[H.jsxs("div",{className:"tier-header",children:[H.jsx("span",{className:"tier-icon",children:"\ud83e\udd49"}),H.jsx("h3",{children:"Bronze"}),H.jsx("div",{className:"tier-cost",children:"5M PXJ"})]}),H.jsxs("div",{className:"tier-benefits",children:[H.jsx("h4",{children:"Benefits:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Basic marketplace listing"}),H.jsx("li",{children:"Collection verification badge"}),H.jsx("li",{children:"Community Discord access"}),H.jsx("li",{children:"Monthly featured spot rotation"})]})]})]}),H.jsxs("div",{className:"tier-card tier-silver",children:[H.jsxs("div",{className:"tier-header",children:[H.jsx("span",{className:"tier-icon",children:"\ud83e\udd48"}),H.jsx("h3",{children:"Silver"}),H.jsx("div",{className:"tier-cost",children:"15M PXJ"})]}),H.jsxs("div",{className:"tier-benefits",children:[H.jsx("h4",{children:"Benefits:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"All Bronze benefits"}),H.jsx("li",{children:"Priority marketplace placement"}),H.jsx("li",{children:"Weekly newsletter mentions"}),H.jsx("li",{children:"Custom collection banner"}),H.jsx("li",{children:"Analytics dashboard access"})]})]})]}),H.jsxs("div",{className:"tier-card tier-gold",children:[H.jsxs("div",{className:"tier-header",children:[H.jsx("span",{className:"tier-icon",children:"\ud83e\udd47"}),H.jsx("h3",{children:"Gold"}),H.jsx("div",{className:"tier-cost",children:"30M PXJ"})]}),H.jsxs("div",{className:"tier-benefits",children:[H.jsx("h4",{children:"Benefits:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"All Silver benefits"}),H.jsx("li",{children:"Homepage featured carousel"}),H.jsx("li",{children:"Social media promotion"}),H.jsx("li",{children:"Exclusive events participation"}),H.jsx("li",{children:"Direct community manager contact"})]})]})]}),H.jsxs("div",{className:"tier-card tier-partner",children:[H.jsxs("div",{className:"tier-header",children:[H.jsx("span",{className:"tier-icon",children:"\ud83e\udd1d"}),H.jsx("h3",{children:"Partner"}),H.jsx("div",{className:"tier-cost",children:"Special Agreement"})]}),H.jsxs("div",{className:"tier-benefits",children:[H.jsx("h4",{children:"Benefits:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"All Gold benefits"}),H.jsx("li",{children:"Co-marketing opportunities"}),H.jsx("li",{children:"Revenue sharing programs"}),H.jsx("li",{children:"Joint event hosting"}),H.jsx("li",{children:"Custom integration support"})]})]})]}),H.jsxs("div",{className:"tier-card tier-platinum",children:[H.jsxs("div",{className:"tier-header",children:[H.jsx("span",{className:"tier-icon",children:"\ud83d\udc8e"}),H.jsx("h3",{children:"Platinum"}),H.jsx("div",{className:"tier-cost",children:"50M PXJ"})]}),H.jsxs("div",{className:"tier-benefits",children:[H.jsx("h4",{children:"Benefits:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"All Partner benefits"}),H.jsx("li",{children:"Permanent homepage presence"}),H.jsx("li",{children:"Dedicated marketing campaigns"}),H.jsx("li",{children:"WaxRock Council consideration"}),H.jsx("li",{children:"Platform governance participation"}),H.jsx("li",{children:"White-label marketplace options"})]})]})]})]})]}),g&&H.jsx("div",{className:"council-note",children:H.jsxs("div",{className:"council-info",children:[H.jsx("span",{className:"council-icon",children:"\ud83c\udfdb\ufe0f"}),H.jsxs("div",{children:[H.jsx("h4",{children:"WaxRock Council Authority"}),H.jsx("p",{children:"The WaxRock Council reserves the right to grant special tier status to exceptional collections through community proposals and voting. Collections may also lobby for tier upgrades through formal governance processes."})]})]})}),g&&H.jsxs("div",{className:"apply-section",children:[H.jsx("h3",{children:"Ready to Upgrade Your Collection?"}),H.jsx("p",{children:"Contact our team to discuss tier upgrades and promotional opportunities."}),H.jsxs("div",{className:"apply-buttons",children:[H.jsx("a",{href:"https://discord.gg/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"apply-btn discord-btn",children:"Apply via Discord"}),H.jsx("button",{className:"apply-btn payment-btn",onClick:()=>o(!0),children:"Instant Tier Upgrade"})]})]})]}),H.jsx(Ja,{isOpen:c,onClose:()=>o(!1)}),H.jsxs("div",{className:"search-filter-section",children:[H.jsxs("div",{className:"search-controls",children:[H.jsxs("div",{className:"search-input-container",children:[H.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("input",{type:"text",placeholder:"Search collections, authors, or names...",value:d,onChange:e=>h(e.target.value),className:"search-input"}),d&&H.jsx("button",{onClick:()=>h(""),className:"clear-search","aria-label":"Clear search",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),H.jsxs("select",{id:"sortBy",value:u,onChange:e=>m(e.target.value),className:"sort-select",children:[H.jsx("option",{value:"name",children:"Name"}),H.jsx("option",{value:"author",children:"Author"}),H.jsx("option",{value:"created",children:"Created Date"})]})]})]}),d&&H.jsx("div",{className:"search-results-info",children:H.jsxs("p",{children:["Found ",S.length+P.length,' results for "',d,'"']})})]}),(!d||P.length>0)&&H.jsxs("div",{className:"pxapproved-section",children:[H.jsxs("h2",{children:["PxApproved ",d&&`(${P.length})`]}),H.jsx("div",{className:"approved-projects-grid",children:P.map((e,t)=>H.jsx(s,{to:`/collections/${e.collection}`,className:"project-card-link",children:H.jsxs("div",{className:`project-card project-card-${e.tier}`,children:[H.jsxs("div",{className:"project-tier-badge",children:[H.jsx("span",{className:`tier-label tier-${e.tier}`,children:e.tier.toUpperCase()}),e.verified&&H.jsx("span",{className:"verified-badge",children:"\u2713"})]}),H.jsx("img",{src:e.image&&"string"==typeof e.image?e.image.startsWith("http")?e.image:`https://ipfs.io/ipfs/${e.image}`:"/img/placeholder-collection.svg",alt:e.name,className:"project-image",onError:e=>{e.currentTarget.src="/img/placeholder-collection.svg"}}),H.jsxs("div",{className:"project-info",children:[H.jsx("h3",{children:e.name}),H.jsx("p",{className:"project-collection",children:e.collection}),H.jsx(Oa,{text:e.description,maxLength:240,className:"project-description"})]})]})},t))})]}),H.jsxs("div",{className:"all-collections-section",children:[H.jsxs("h2",{children:["More Collections on WAX ",d&&`(${S.length})`]}),r?H.jsx(la,{errorType:"COLLECTION_NOT_FOUND",onRetry:()=>_(),showRetry:!0}):a?H.jsxs("div",{className:"loading-spinner",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading collections..."})]}):H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"collections-grid",children:T.length>0?T.map(e=>H.jsxs(s,{to:`/collections/${e.collection_name}`,className:"collection-card",children:[H.jsx(Xa,{src:e.img?e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`:void 0,alt:e.collection_name,width:150,height:150,fallbackText:e.collection_name,className:"collection-image"}),H.jsxs("div",{className:"collection-info",children:[H.jsx("div",{className:"collection-row-1",children:H.jsx("h3",{children:e.name})}),H.jsx("div",{className:"collection-row-2",children:H.jsx("p",{className:"collection-name",children:e.collection_name})}),H.jsx("div",{className:"collection-market-data",children:e.loading_market_data?H.jsxs("div",{className:"market-data-loading",children:[H.jsx("div",{className:"mini-spinner"}),H.jsx("span",{children:"Loading market data..."})]}):H.jsxs(H.Fragment,{children:[void 0!==e.floor_price&&e.floor_price>0&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Floor:"}),H.jsxs("span",{className:"stat-value",children:[e.floor_price.toFixed(4)," WAX"]})]}),e.volume&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Volume:"}),H.jsxs("span",{className:"stat-value",children:[parseFloat(e.volume).toLocaleString()," WAX"]})]}),e.assets&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Assets:"}),H.jsx("span",{className:"stat-value",children:e.assets})]})]})})]})]},e.collection_name)):d?H.jsxs("div",{className:"no-results",children:[H.jsx("svg",{className:"no-results-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("h3",{children:"No collections found"}),H.jsx("p",{children:"Try adjusting your search terms or browse all collections"}),H.jsx("button",{onClick:()=>h(""),className:"clear-search-button",children:"Clear Search"})]}):null}),$&&!d&&H.jsx("div",{className:"load-more-container",children:H.jsx("button",{onClick:async()=>{y(!0);try{if(p<e.length)f(e=>e+12);else{const e=N+50,a=await $e.getCollections({limit:e,whitelistOnly:!0});if(a&&a.length>N){const e=a.map(e=>({collection_name:e.collection_name,name:e.name,img:e.img,author:e.author,created_at_time:e.created_at_time,created_at_block:e.created_at_block,loading_market_data:!0}));t(e),w(a.length),f(e=>e+12);const n=e.slice(N);n.length>0&&A(n)}}}catch(a){const e=a instanceof Error?a:new Error("Failed to load more collections");ee.logError("Collections.loadMoreCollections",e,{displayedCount:p,totalFetched:N})}finally{y(!1)}},disabled:v,className:"load-more-button",children:v?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"button-spinner"}),"Loading..."]}):`Load More Collections (${S.length-p} remaining)`})})]})]})]})},Va={pixeljourney:{tier:"platinum",verified:!0,quickLinks:[{label:"Main Website",url:"https://pixeljourney.xyz",icon:"\ud83c\udf10"},{label:"Discord",url:"http://discord.gg/pixel-journey-1130670500776005734",icon:"\ud83d\udcac"},{label:"X/Twitter",url:"https://x.com/PXJourney",icon:"\ud83d\udc26"},{label:"Whitepaper",url:"https://docs.pixeljourney.xyz",icon:"\ud83d\udcc4"}],benefits:["Premium marketplace placement","Exclusive promotional campaigns","Priority customer support","Advanced analytics dashboard","Custom branding options"],ownerMessage:"Welcome to Pixel Journey! Join our community of adventurers exploring the digital realm. Connect with fellow travelers, learn about all the things and discover exclusive content.",discordUrl:"http://discord.gg/pixel-journey-1130670500776005734",learnAboutGrid:[{title:"PXJ Token",description:"Learn about our native utility token, its use cases, and how it powers the Pixel Journey ecosystem.",icon:"\ud83e\ude99",url:"https://docs.pixeljourney.xyz/season-1/kickstarting-the-pxj-economy"},{title:"NFT Collections",description:"Discover our diverse range of NFT collectibles, from Pixal PFPs to Pixel Ingredients and special editions.",icon:"\ud83c\udfa8",url:"https://docs.pixeljourney.xyz/season-1/the-pixal-pfps"},{title:"Leaderboards",description:"Explore the PXJourney mechanics, quests, and adventures awaiting in Pixel Journey.",icon:"\ud83c\udfae",url:"https://lb.pixeljourney.xyz/"},{title:"Staking & Rewards",description:"Understand how to stake your NFTs and tokens to earn rewards and participate in governance.",icon:"\ud83d\udc8e",url:"https://pixeljourney.xyz/staking"},{title:"Roadmap",description:"Check out our development roadmap and upcoming features planned for the ecosystem.",icon:"\ud83d\uddfa\ufe0f",url:"/journeymap"},{title:"Community",description:"Join our vibrant community of adventurers, participate in events, and connect with fellow travelers.",icon:"\ud83d\udc65",url:"http://discord.gg/pixel-journey-1130670500776005734"}]},friedfactory:{tier:"partner",verified:!0,quickLinks:[{label:"Artist Portfolio",url:"https://friedfactory.art",icon:"\ud83c\udfa8"},{label:"Discord",url:"https://discord.gg/friedfactory",icon:"\ud83d\udcac"},{label:"Twitter",url:"https://twitter.com/friedfactory",icon:"\ud83d\udc26"}],benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]},crptomuffins:{tier:"gold",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"\u2139\ufe0f"},{label:"Discord",url:"#",icon:"\ud83d\udcac"}],benefits:["Homepage featured carousel","Social media promotion","Exclusive events participation","Direct community manager contact"]},akufishheads:{tier:"silver",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"\u2139\ufe0f"}],benefits:["Priority marketplace placement","Weekly newsletter mentions","Custom collection banner","Analytics dashboard access"]},pantheon:{tier:"bronze",verified:!0,benefits:["Basic marketplace listing","Collection verification badge","Community Discord access","Monthly featured spot rotation"]},pocketsizedp:{tier:"partner",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"\u2139\ufe0f"}],benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]},nimasodyssey:{tier:"partner",verified:!0,benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]}};function Ga(e){return Va[e]||null}function Ya(e){return{platinum:{icon:"\ud83d\udc8e",label:"Platinum",className:"tier-platinum",color:"#e5e4e2"},partner:{icon:"\ud83e\udd1d",label:"Partner",className:"tier-partner",color:"#667eea"},gold:{icon:"\ud83e\udd47",label:"Gold",className:"tier-gold",color:"#ffd700"},silver:{icon:"\ud83e\udd48",label:"Silver",className:"tier-silver",color:"#c0c0c0"},bronze:{icon:"\ud83e\udd49",label:"Bronze",className:"tier-bronze",color:"#cd7f32"}}[e]}const Ka=({collectionName:e})=>{const t=Ga(e);if(!t)return null;const a=Ya(t.tier),n=t.quickLinks&&t.quickLinks.length>0;return H.jsxs("div",{className:"quick-links-container",children:[H.jsx("div",{className:"tier-section",children:H.jsxs("div",{className:`tier-badge ${a.className}`,children:[H.jsx("span",{className:"tier-icon",children:a.icon}),H.jsx("span",{className:"tier-label",children:a.label}),t.verified&&H.jsx("span",{className:"verified-icon",children:"\u2713"})]})}),n&&H.jsxs("div",{className:"links-section",children:[H.jsx("h4",{className:"links-title",children:"Quick Links"}),H.jsx("div",{className:"links-grid",children:t.quickLinks.map((e,t)=>H.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"quick-link",children:[e.icon&&H.jsx("span",{className:"link-icon",children:e.icon}),H.jsx("span",{className:"link-label",children:e.label})]},t))})]}),(t.ownerMessage||t.discordUrl)&&H.jsxs("div",{className:"owner-section",children:[t.ownerMessage&&H.jsxs("div",{className:"owner-message",children:[H.jsxs("div",{className:"owner-title-container",style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[H.jsx("h4",{className:"owner-title",children:"From the Collection Owner"}),H.jsx("div",{className:"info-tooltip",title:"This message is provided directly by the collection owner to share information about their project, community, or special announcements with collectors and fans.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"rgba(255, 255, 255, 0.7)",fontSize:"12px",fontWeight:"bold",cursor:"help",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.15)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",e.currentTarget.style.color="rgba(255, 255, 255, 0.7)"},children:"?"})]}),H.jsx("p",{className:"owner-text",children:t.ownerMessage})]}),t.discordUrl&&H.jsx("div",{className:"discord-section",children:H.jsxs("a",{href:t.discordUrl,target:"_blank",rel:"noopener noreferrer",className:"discord-link",children:[H.jsx("span",{className:"discord-icon",children:"\ud83d\udcac"}),H.jsx("span",{className:"discord-text",children:"Join Our Discord Community"}),H.jsx("span",{className:"external-icon",children:"\u2197"})]})})]}),t.learnAboutGrid&&H.jsxs("div",{className:"learn-about-section",style:{marginTop:"2rem"},children:[H.jsx("h3",{className:"learn-about-title",children:"Learn About Pixel Journey"}),H.jsx("div",{className:"learn-about-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginTop:"16px"},children:t.learnAboutGrid.map((e,t)=>H.jsxs("div",{className:"learn-about-card",style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"20px",transition:"all 0.3s ease",cursor:e.url?"pointer":"default"},onClick:()=>e.url&&window.open(e.url,"_blank"),onMouseEnter:t=>{e.url&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.08)",t.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",t.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:t=>{e.url&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.05)",t.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)",t.currentTarget.style.transform="translateY(0)")},children:[H.jsxs("div",{className:"learn-card-header",style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[H.jsx("span",{className:"learn-card-icon",style:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:e.icon}),H.jsx("h4",{className:"learn-card-title",style:{margin:0,fontSize:"16px",fontWeight:"600",color:"white"},children:e.title}),e.url&&H.jsx("span",{className:"external-link-icon",style:{marginLeft:"auto",fontSize:"14px",color:"rgba(255, 255, 255, 0.6)"},children:"\u2197"})]}),H.jsx("p",{className:"learn-card-description",style:{margin:0,fontSize:"14px",lineHeight:"1.5",color:"rgba(255, 255, 255, 0.8)"},children:e.description})]},t))})]})]})},Qa=({collectionName:e})=>{const{account:t,isConnected:a}=Q(),{showError:n,showSuccess:r}=We(),{settings:s}=ke(),[l,c]=i.useState(!1),[o,d]=i.useState(!0),[h,u]=i.useState(!1),[m,p]=i.useState(!1),[f,v]=i.useState([]),[y,g]=i.useState(0),[b,N]=i.useState(null),[w,k]=i.useState(""),[x,C]=i.useState(null),[A,_]=i.useState(!1),[S,P]=i.useState(!0),[T,$]=i.useState(30),[F,E]=i.useState(!1),[I,M]=i.useState(!1),[L,W]=i.useState(!1),[R,O]=i.useState({collection:e||void 0,hideSpam:!0}),B=i.useRef(null),j=i.useRef(null),D=i.useRef(null),U=(e,t="")=>{const a=D.current;if(!a)return;const n=a.selectionStart,i=a.selectionEnd,r=w.substring(n,i),s=w.substring(0,n),l=w.substring(i);k(s+e+r+t+l),setTimeout(()=>{a.focus();const i=n+e.length+r.length+t.length;a.setSelectionRange(i,i)},0)},X=e=>{const t=Gt(e);return H.jsx("span",{dangerouslySetInnerHTML:{J:t}})};i.useEffect(()=>{if(0!==f.length)if(b){const e=f.filter(e=>new Date(e.timestamp)>new Date(b));g(e.length)}else g(o?f.length:0);else g(0)},[f,b,o]),i.useEffect(()=>{if(!o&&f.length>0){const e=f[f.length-1];N(e.timestamp),g(0)}},[o,f]);const z=i.useCallback(async(t=!1)=>{t||u(!0);try{const t=e?{...R,collection:e}:R,a=await zt.getMessages(t,50,0);v(a)}catch(a){se.error("Error loading messages:","ChatWidget",a),t||n("Failed to load chat messages")}finally{t||u(!1)}},[R,e,n]);i.useEffect(()=>{!e||R.collection&&R.collection===e||O(t=>({...t,collection:e}))},[e,R]),i.useEffect(()=>{z()},[z]),i.useEffect(()=>(S&&!o?j.current=setInterval(()=>{z(!0)},1e3*T):j.current&&(clearInterval(j.current),j.current=null),()=>{j.current&&clearInterval(j.current)}),[S,o,T,z]);const J=i.useCallback(async()=>{if(t&&w)try{const e=await zt.calculateMessageCost(w,t,A);C(e)}catch(e){se.error("Error calculating cost:","ChatWidget",e)}},[t,w,A]);if(i.useEffect(()=>{w&&t?J():C(null)},[w,t,J]),i.useEffect(()=>{V()},[f]),!s.showChatButton)return null;const q=async()=>{if(t&&w.trim()){p(!0);try{const a=e?`::col:${e}:: ${w.trim()}`:w.trim(),n=await zt.sendMessage(a,t,e,A);r("Message sent!",`Transaction: ${n.substring(0,8)}...`),k(""),C(null),_(!1),setTimeout(()=>{z(!0)},2e3)}catch(a){se.error("Error sending message:","ChatWidget",a);const e=a instanceof Error?a.message:"Unknown error";e.includes("transaction ID not found")?n("Message Status Unclear","Your message may have been sent successfully. Please check your transaction history or refresh the chat to confirm."):n("Failed to send message",e)}finally{p(!1)}}},V=()=>{B.current?.scrollIntoView({behavior:"smooth"})},G=e=>{const t=new Date(e),a=(new Date).getTime()-t.getTime(),n=Math.floor(a/6e4),i=Math.floor(a/36e5),r=Math.floor(a/864e5);return n<1?"now":n<60?`${n}m`:i<24?`${i}h`:r<7?`${r}d`:t.toLocaleDateString()},Y=e=>{const t=parseFloat(e.split(" ")[0]);return t>=1e3?`${(t/1e3).toFixed(1)}K PXJ`:`${t.toFixed(0)} PXJ`},K=e=>e.isSponsored?"chat_message--sponsored":"premium"===e.messageType?"chat_message--premium":"chat_message--normal";return o?H.jsx("div",{className:"chat_widget chat_widget--minimized",children:H.jsxs("button",{className:"chat_toggle-btn",onClick:()=>d(!1),title:"Open Chat",children:[H.jsx("span",{className:"chat_icon",children:"\ud83d\udcac"}),y>0&&H.jsx("span",{className:"chat_notification-badge",children:y})]})}):H.jsxs("div",{className:"chat_widget "+(l?"chat_widget--expanded":"chat_widget--normal"),children:[H.jsxs("div",{className:"chat_header",children:[H.jsxs("div",{className:"chat_header-left",children:[H.jsx("span",{className:"chat_title",children:e?`${e} Chat`:"Global Chat"}),H.jsxs("span",{className:"chat_status",children:[f.length," messages"]})]}),H.jsxs("div",{className:"chat_header-right",children:[H.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>z(),disabled:h,title:"Refresh",children:H.jsx("span",{className:"chat_refresh-icon "+(h?"chat_refresh-icon--spinning":""),children:"\ud83d\udd04"})}),H.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>c(!l),title:l?"Minimize":"Expand",children:H.jsx("span",{children:l?"\ud83d\uddd7":"\ud83d\uddd6"})}),H.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>d(!0),title:"Close",children:H.jsx("span",{children:"\u2715"})})]})]}),!e&&H.jsxs("div",{className:"chat_filters",children:[H.jsxs("select",{className:"chat_select",value:R.collection||"",onChange:e=>O({...R,collection:e.target.value||void 0}),children:[H.jsx("option",{value:"",children:"All Collections"}),H.jsx("option",{value:"pixeljourney",children:"Pixel Journey"}),H.jsx("option",{value:"pixalcards",children:"Pixal Cards"})]}),H.jsxs("label",{className:"chat_checkbox-label",children:[H.jsx("input",{type:"checkbox",checked:R.hideSpam||!1,onChange:e=>O({...R,hideSpam:e.target.checked})}),"Hide Spam"]}),H.jsxs("label",{className:"chat_checkbox-label",children:[H.jsx("input",{type:"checkbox",checked:R.showOnlySponsored||!1,onChange:e=>O({...R,showOnlySponsored:e.target.checked})}),"Sponsored Only"]})]}),H.jsxs("div",{className:"chat_messages",children:[h&&0===f.length?H.jsx("div",{className:"chat_loading",children:"Loading messages..."}):0===f.length?H.jsxs("div",{className:"chat_empty",children:[H.jsx("p",{children:"No messages yet."}),H.jsx("p",{children:"Be the first to start the conversation!"})]}):f.map(e=>H.jsxs("div",{className:`chat_message ${K(e)}`,children:[H.jsxs("div",{className:"chat_message-header",children:[H.jsx("div",{className:"chat_message-avatar",children:H.jsx("img",{src:`https://api.dicebear.com/7.x/identicon/svg?seed=${e.sender}`,alt:e.sender,className:"chat_avatar"})}),H.jsxs("div",{className:"chat_message-info",children:[H.jsx("span",{className:"chat_sender",children:e.sender}),H.jsx("span",{className:"chat_timestamp",children:G(e.timestamp)}),H.jsx("span",{className:"chat_amount",children:Y(e.pxjAmount)}),e.isSponsored&&H.jsx("span",{className:"chat_sponsored-badge",children:"SPONSORED"})]}),H.jsx("div",{className:"chat_message-actions",children:H.jsx("a",{href:`https://wax.bloks.io/transaction/${e.transactionId}`,target:"_blank",rel:"noopener noreferrer",className:"chat_tx-link",title:"View on Explorer",children:"\ud83d\udd17"})})]}),H.jsx("div",{className:"chat_message-content",children:X(e.message)})]},e.id)),H.jsx("div",{ref:B})]}),a?H.jsxs("div",{className:"chat_input-section",children:[x&&H.jsxs("div",{className:"chat_cost-info",children:[H.jsxs("div",{className:"chat_cost-display",children:[H.jsxs("span",{className:"chat_cost-amount",children:["Cost: ",(x.totalCost/1e4).toFixed(4)," PXJ"]}),H.jsx("button",{className:"chat_info-btn",onClick:()=>W(!L),title:"View price breakdown",children:"\u2139\ufe0f"})]}),x.hasPixalPFP&&H.jsxs("span",{className:"chat_discount",children:["Pixal PFP Discount: ",x.discount,"%"]}),H.jsxs("span",{className:"chat_char-count",children:[w.length,"/240 chars"]}),L&&H.jsx("div",{className:"chat_price-tooltip",children:H.jsxs("div",{className:"chat_price-content",children:[H.jsx("h4",{children:"Price Breakdown"}),H.jsxs("div",{className:"price-factor",children:[H.jsx("span",{children:"Base Cost:"}),H.jsxs("span",{children:[(x.baseCost/1e4).toFixed(4)," PXJ"]})]}),H.jsxs("div",{className:"price-factor",children:[H.jsxs("span",{children:["Character Cost (",w.length," chars):"]}),H.jsxs("span",{children:[((x.totalCost-x.baseCost)/1e4).toFixed(4)," PXJ"]})]}),x.hasPixalPFP&&H.jsxs("div",{className:"price-factor discount",children:[H.jsxs("span",{children:["Pixal PFP Discount (",x.discount,"%):"]}),H.jsxs("span",{children:["-",((x.baseCost+(x.totalCost-x.baseCost))*(x.discount/100)/1e4).toFixed(4)," PXJ"]})]}),H.jsxs("div",{className:"price-factor total",children:[H.jsx("span",{children:"Total Cost:"}),H.jsxs("span",{children:[(x.totalCost/1e4).toFixed(4)," PXJ"]})]}),H.jsx("div",{className:"price-note",children:H.jsx("small",{children:"Cost increases by 100% per 50 extra characters. Holders capped at 500 PXJ."})})]})})]}),H.jsxs("div",{className:"chat_input-controls",children:[H.jsxs("div",{className:"chat_sponsored-container",children:[H.jsxs("label",{className:"chat_checkbox-label",children:[H.jsx("input",{type:"checkbox",checked:A,onChange:e=>_(e.target.checked)}),"Sponsored (",x?.hasPixalPFP?"10,000":"25,000"," PXJ)"]}),H.jsx("button",{className:"chat_info-btn",onClick:()=>E(!F),title:"Learn more about sponsored messages",children:"\u2139\ufe0f"}),F&&H.jsx("div",{className:"chat_info-tooltip",children:H.jsxs("div",{className:"chat_info-content",children:[H.jsx("h4",{children:"Sponsored Messages"}),H.jsx("p",{children:"\u2022 Messages appear with special highlighting"}),H.jsx("p",{children:"\u2022 Higher visibility in chat feed"}),H.jsxs("p",{children:["\u2022 Costs ",x?.hasPixalPFP?"10,000":"25,000"," PXJ regardless of length"]}),H.jsxs("p",{children:["\u2022 ",x?.hasPixalPFP?"Pixal PFP holders get 60% discount!":"Get a Pixal PFP for 60% discount!"]}),H.jsx("p",{children:"\u2022 Perfect for announcements & promotions"})]})})]}),H.jsxs("label",{className:"chat_checkbox-label",children:[H.jsx("input",{type:"checkbox",checked:S,onChange:e=>P(e.target.checked)}),"Auto-refresh"]})]}),H.jsxs("div",{className:"chat_formatting-toolbar",children:[H.jsx("button",{className:"chat_format-btn",onClick:()=>U("**","**"),title:"Bold",children:H.jsx("strong",{children:"B"})}),H.jsx("button",{className:"chat_format-btn",onClick:()=>U("*","*"),title:"Italic",children:H.jsx("em",{children:"I"})}),H.jsxs("div",{className:"chat_emoji-container",children:[H.jsx("button",{className:"chat_format-btn",onClick:()=>M(!I),title:"Add emoji",children:"\ud83d\ude0a"}),I&&H.jsx("div",{className:"chat_emoji-picker",children:H.jsx("div",{className:"chat_emoji-grid",children:["\ud83d\ude0a","\ud83d\ude02","\u2764\ufe0f","\ud83d\udc4d","\ud83d\udc4e","\ud83d\udd25","\ud83d\udcaf","\ud83d\ude80","\ud83d\udc8e","\ud83c\udf89","\ud83d\ude0e","\ud83e\udd14","\ud83d\ude0d","\ud83e\udd73","\ud83d\udcaa","\ud83d\udc4f","\ud83d\ude4c","\u2728","\u2b50","\ud83c\udf1f"].map(e=>H.jsx("button",{className:"chat_emoji-btn",onClick:()=>(e=>{const t=D.current;if(!t)return;const a=t.selectionStart,n=w.substring(0,a),i=w.substring(a);k(n+e+i),M(!1),setTimeout(()=>{t.focus();const n=a+e.length;t.setSelectionRange(n,n)},0)})(e),children:e},e))})})]})]}),H.jsxs("div",{className:"chat_input-wrapper",children:[H.jsx("textarea",{ref:D,className:"chat_input",placeholder:`Type your message... (${e||"global"} chat)`,value:w,onChange:e=>k(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),q())},maxLength:240,rows:l?3:2,disabled:m}),H.jsx("button",{className:"chat_send-btn",onClick:q,disabled:!w.trim()||m,children:m?"\u23f3":"\ud83d\udce4"})]})]}):H.jsx("div",{className:"chat_login-prompt",children:H.jsx("p",{children:"Connect your wallet to join the chat!"})}),l&&H.jsx("div",{className:"chat_settings",children:H.jsxs("div",{className:"chat_setting-group",children:[H.jsx("label",{children:"Auto-refresh interval:"}),H.jsxs("select",{value:T,onChange:e=>$(Number(e.target.value)),className:"chat_select chat_select--small",children:[H.jsx("option",{value:10,children:"10s"}),H.jsx("option",{value:30,children:"30s"}),H.jsx("option",{value:60,children:"1m"}),H.jsx("option",{value:300,children:"5m"})]})]})})]})},Za=({isOpen:e,imageUrl:t,imageName:a,onClose:n})=>{if(!e)return null;const i=e=>{"Escape"===e.key&&n()};return r.useEffect(()=>(e&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow="unset"}),[e]),H.jsx("div",{className:"image-zoom-modal",onClick:n,children:H.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsx("button",{className:"zoom-modal-close",onClick:n,children:"\xd7"}),H.jsx("img",{src:t,alt:a,className:"zoom-modal-image"}),H.jsx("div",{className:"zoom-modal-info",children:H.jsx("h3",{children:a})})]})})},en=r.memo(()=>{const{collectionName:e}=o(),{settings:t}=ke(),[a,n]=i.useState(null),[r,l]=i.useState([]),[c,d]=i.useState([]),[h,u]=i.useState(null),[m,p]=i.useState("24"),[f,v]=i.useState({}),[y,g]=i.useState(!1),[b,N]=i.useState("WAX"),[w,k]=i.useState(.05),[x,C]=i.useState([]),[A,_]=i.useState(1),[S,P]=i.useState(!1),[T,$]=i.useState(!0),[F,E]=i.useState([]),[I,M]=i.useState([]),[L,W]=i.useState(1),[R]=i.useState(10),[O,B]=i.useState(!1),[j,D]=i.useState([]),[U,X]=i.useState(null),[z,J]=i.useState(""),[q,V]=i.useState(!1),[G,Y]=i.useState(null),[K,Q]=i.useState("sales"),[Z,ee]=i.useState(""),[te,ae]=i.useState("name"),[ne,ie]=i.useState(!1),[re,le]=i.useState({url:"",name:""}),[ce,oe]=i.useState(!1),de=r.filter(e=>e.schema_name.toLowerCase().includes(Z.toLowerCase())).sort((e,t)=>{switch(te){case"name":return e.schema_name.localeCompare(t.schema_name);case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();default:return 0}}),he=c.filter(e=>{const t=e.immutable_data?.name&&String(e.immutable_data.name).toLowerCase().includes(Z.toLowerCase())||e.template_id.toLowerCase().includes(Z.toLowerCase()),a=!z||e.schema_name===z;return t&&a}).sort((e,t)=>{switch(te){case"name":{const a=String(e.immutable_data?.name||`Template #${e.template_id}`),n=String(t.immutable_data?.name||`Template #${t.template_id}`);return a.localeCompare(n)}case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();case"supply":return parseInt(t.issued_supply)-parseInt(e.issued_supply);default:return 0}}),me=i.useCallback(async t=>{if(!e)return"0";try{const a=await fetch(`https://wax-api.hivebp.io/v3/volume/${t}/${e}`);if(!a.ok)throw new Error("Failed to fetch volume data");const n=await a.json();return n.volume?String(n.volume):"0"}catch(a){return"0"}},[e]),pe=i.useCallback(async()=>{if(!e)return null;try{const t=await fetch(`https://wax-api.hivebp.io/v3/collection-stats/${e}`);if(!t.ok)throw new Error("Failed to fetch collection stats");const a=await t.json();return{numUsers:a.numUsers||0,usdMarketCap:a.usdMarketCap||0,waxMarketCap:a.waxMarketCap||0,numAssets:a.numAssets||0}}catch(t){return null}},[e]),fe=i.useCallback(async()=>{if(!e)return;g(!0);const t=["24","7","30","90","365"],a=t.indexOf(m),n=t[(a+1)%t.length];if(f[n])return p(n),void g(!1);const i=await me(n);v(e=>({...e,[n]:i})),p(n),g(!1)},[e,m,f,me]),ve=i.useCallback(async()=>{if(e){V(!0),Y(null);try{const[t,a,i]=await Promise.all([$e.getCollectionDetails(e),$e.getCollectionSchemas(e),$e.getCollectionTemplates(e)]);n(t),l(a),d(i),Promise.all([$e.getCollectionAnalytics(e),$e.getEnhancedCollectionStats(e),$e.getCollectionVolumeGraph(e,30),$e.getSimilarCollections(e),$e.getCollectionHolders(e,500),$e.getCollectionTopSales(e,50),me("24"),pe(),$e.getCollectionMarketStats({collection_name:e,symbol:"WAX"})]).then(([e,t,,a,n,i,r,s,l])=>{v(e=>({...e,24:r}));const c=l.success&&l.data?{sales:l.data.sales||"0",volume:l.data.volume?String(parseFloat(l.data.volume)/Math.pow(10,8)):"0",suggested_median:l.data.suggested_median?String(parseFloat(l.data.suggested_median)/Math.pow(10,8)):"0",suggested_average:l.data.suggested_average?String(parseFloat(l.data.suggested_average)/Math.pow(10,8)):"0"}:null;X(c);const o={volume:c?.volume||e?.volume||"0",sales:c?.sales||e?.sales||"0",floor_price:t.floorPrice&&!isNaN(t.floorPrice)?String(t.floorPrice):e?.floor_price&&!isNaN(parseFloat(e.floor_price))?e.floor_price:e?.floor&&!isNaN(parseFloat(e.floor))?e.floor:c?.suggested_median&&!isNaN(parseFloat(c.suggested_median))?c.suggested_median:i&&i.length>0?(()=>{const e=i.slice(-5).map(e=>{const t="string"==typeof e.price?e.price:e.price?.amount||"0";return parseFloat(t||"0")}).filter(e=>!isNaN(e)&&e>0);return e.length>0?String(Math.min(...e).toFixed(2)):"0"})():"0",market_cap:s?.waxMarketCap?String(s.waxMarketCap):t.marketCap?String(t.marketCap):e?.market_cap||"0",holders:s?.numUsers||e?.holders||0,assets:s?.numAssets?String(s.numAssets):e?.assets||"0",volume_24h:r||(t.volume24h?String(t.volume24h):e?.volume_24h||e?.volume||"0")};u(o),D(a),C(n),E(i||[])}).catch(t=>{se.error("Enhanced analytics failed to load","CollectionDetail.loadCollectionData",t,{collectionName:e})})}catch(t){se.error("Failed to load collection data","CollectionDetail.loadCollectionData",t,{collectionName:e}),Y(`Failed to load collection "${e}". This collection may not exist or be temporarily unavailable.`)}finally{V(!1)}}},[e]),ye=i.useCallback(async t=>{if(e)try{const a=await $e.getCollectionTemplates(e,t);d(a)}catch(a){se.error("Failed to load collection templates","CollectionDetail.loadTemplates",a,{collectionName:e,schemaName:t})}},[e]);i.useEffect(()=>{e&&ve()},[e,ve]),i.useEffect(()=>{z&&e&&ye(z)},[z,e,ye]),i.useEffect(()=>{const e=L*R,t=F.slice(0,e);M(t),B(e<F.length)},[F,L,R]);const ge=e=>{if(e)return e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`},be=e=>{if(!e)return"N/A";try{let t;if(e.includes("T"))t=new Date(e);else{const a=parseInt(e);if(a>946684800&&a<4102444800)t=new Date(1e3*a);else{if(!(a>9466848e5&&a<41024448e5))return"N/A";t=new Date(a)}}return isNaN(t.getTime())?"N/A":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}},Ne=(e,a="template-image")=>{const n=(e=>{if(e.immutable_data?.video){const t=e.immutable_data.video;if("string"==typeof t)return t.startsWith("Qm")?`${ue.IPFS.GATEWAYS[0]}${t}`:t}return null})(e),i=(e=>{if(e.immutable_data?.img){const t=e.immutable_data.img;if("string"==typeof t)return t.startsWith("Qm")?`https://ipfs.io/ipfs/${t}`:t}return"https://pixeljourney.xyz/img/toppixals/10.webp"})(e);return H.jsx(Rt,{imageUrl:i,videoUrl:n,alt:String(e.immutable_data?.name||"NFT"),className:a,enableAnimations:t.enableAnimatedNFTs})};return q?H.jsx("div",{className:"collection-detail-container",children:H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading collection details..."})]})}):G?H.jsx("div",{className:"collection-detail-container",children:H.jsxs("div",{className:"error-state",children:[H.jsx("h2",{children:"Collection Error"}),H.jsx("p",{children:G}),H.jsx(s,{to:"/collections",className:"back-link",children:"\u2190 Back to Collections"})]})}):a?H.jsxs("div",{className:"collection-profile-page",children:[H.jsxs("div",{className:"collection-hero",children:[H.jsxs("div",{className:"hero-background",children:[H.jsx("img",{src:ge(a.img||""),alt:a.name||a.collection_name,className:"hero-bg-image"}),H.jsx("div",{className:"hero-overlay"})]}),H.jsxs("div",{className:"hero-content",children:[H.jsxs("div",{className:"breadcrumb",children:[H.jsx(s,{to:"/",className:"breadcrumb-link",children:"Home"}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx(s,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx("span",{className:"breadcrumb-current",children:a.name||a.collection_name})]}),H.jsxs("div",{className:"collection-profile",children:[H.jsx("div",{className:"collection-logo-container",children:H.jsx("img",{src:ge(a.img||""),alt:a.name||a.collection_name,className:"collection-logo"})}),H.jsxs("div",{className:"profile-info",children:[H.jsx("div",{className:"title-section",children:H.jsx("h1",{className:"collection-title",children:a.name||a.collection_name})}),H.jsxs("div",{className:"collection-actions-row",style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px",marginBottom:"12px"},children:[(()=>{const e=Ga(a.collection_name);if(e){const t=Ya(e.tier);return H.jsxs("div",{className:`collection-tier-badge ${t.className}`,children:[H.jsx("span",{className:"tier-icon",children:t.icon}),H.jsx("span",{className:"tier-label",children:t.label}),e.verified&&H.jsx("span",{className:"verified-icon",children:"\u2713"})]})}return null})(),H.jsxs("button",{className:"share-button",onClick:()=>oe(!0),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"8px 12px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.15)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)"},children:[H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:H.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),"Share Collection"]})]}),H.jsxs("p",{className:"collection-handle",children:["@",a.collection_name]}),H.jsxs("p",{className:"collection-creator",children:["Created by ",a.author]}),a.data?.description&&H.jsx("div",{className:"collection-description",children:H.jsx(Oa,{text:String(a.data.description||""),maxLength:100,className:"description-text"})})]})]})]})]}),H.jsxs("div",{className:"stats-dashboard",children:[H.jsxs("div",{className:"stats-grid",children:[H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:h?.assets||a.assets||0}),H.jsx("div",{className:"stat-label",children:"Total Assets"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:r.length}),H.jsx("div",{className:"stat-label",children:"Schemas"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:c.length}),H.jsx("div",{className:"stat-label",children:"Templates"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:x.length}),H.jsx("div",{className:"stat-label",children:"Holders"})]})]}),h&&H.jsxs("div",{className:"stats-grid",children:[H.jsxs("div",{className:"stat-card premium clickable",onClick:async()=>{if("WAX"===b){try{const e=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),t=await e.json();t.wax&&t.wax.usd&&k(t.wax.usd)}catch(e){}N("USD")}else N("WAX")},style:{cursor:"pointer"},children:[H.jsx("div",{className:"stat-value",children:h.market_cap&&"0"!==h.market_cap?"WAX"===b?`${parseFloat(h.market_cap).toLocaleString()} WAX`:`$${(parseFloat(h.market_cap)*w).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"}),H.jsxs("div",{className:"stat-label",children:["Market Cap (",b,")"]})]}),H.jsxs("div",{className:"stat-card premium",children:[H.jsx("div",{className:"stat-value",children:U?.sales&&"0"!==U.sales?`${parseInt(U.sales).toLocaleString()}`:h?.sales&&"0"!==h.sales?`${parseInt(h.sales).toLocaleString()}`:"N/A"}),H.jsx("div",{className:"stat-label",children:"All Time Sales"})]}),H.jsxs("div",{className:"stat-card premium",children:[H.jsx("div",{className:"stat-value",children:U?.volume&&"0"!==U.volume?`${parseFloat(U.volume).toLocaleString()} WAX`:h?.volume&&"0"!==h.volume?`${parseFloat(h.volume).toLocaleString()} WAX`:"N/A"}),H.jsx("div",{className:"stat-label",children:"All Time Volume"})]}),H.jsxs("div",{className:"stat-card premium clickable",onClick:fe,style:{cursor:"pointer"},children:[H.jsx("div",{className:"stat-value",children:y?H.jsx("span",{style:{opacity:.6},children:"Loading..."}):f[m]&&"0"!==f[m]?`${parseFloat(f[m]).toLocaleString()} WAX`:h?.volume_24h&&"0"!==h.volume_24h?`${parseFloat(h.volume_24h).toLocaleString()} WAX`:"N/A"}),H.jsxs("div",{className:"stat-label",children:["24"===m?"24H":"7"===m?"7D":"30"===m?"30D":"90"===m?"90D":"365D"," Volume",H.jsx("span",{style:{fontSize:"0.8em",opacity:.7,marginLeft:"4px"},children:"\u21bb"})]})]}),H.jsxs("div",{className:"stat-card premium",children:[H.jsx("div",{className:"stat-value",children:h.floor_price&&"0"!==h.floor_price&&!isNaN(parseFloat(h.floor_price))&&parseFloat(h.floor_price)>0?`${parseFloat(h.floor_price).toFixed(2)} WAX`:U?.suggested_median&&"0"!==U.suggested_median&&!isNaN(parseFloat(U.suggested_median))?`${parseFloat(U.suggested_median).toFixed(2)} WAX`:F&&F.length>0?(()=>{const e=F.slice(-3).map(e=>{const t="string"==typeof e.price?e.price:e.price?.amount||"0";return parseFloat(t||"0")}).filter(e=>!isNaN(e)&&e>0);return e.length>0?`~${Math.min(...e).toFixed(2)} WAX`:"N/A"})():"N/A"}),H.jsx("div",{className:"stat-label",children:"Floor Price"})]})]})]}),H.jsx(Ka,{collectionName:a.collection_name}),H.jsx("div",{className:"collection-content-navigation",children:H.jsxs("div",{className:"collection-nav-container",children:[H.jsxs("div",{className:"collection-nav-tabs",children:[H.jsx("button",{className:"collection-nav-tab "+("sales"===K?"active":""),onClick:()=>Q("sales"),children:H.jsxs("div",{className:"tab-content",children:[H.jsx("span",{className:"tab-icon",children:"\ud83d\udcb0"}),H.jsx("span",{className:"tab-text",children:"Top Sales"}),H.jsx("span",{className:"tab-count",children:I.length})]})}),H.jsx("button",{className:"collection-nav-tab "+("holders"===K?"active":""),onClick:()=>Q("holders"),children:H.jsxs("div",{className:"tab-content",children:[H.jsx("span",{className:"tab-icon",children:"\ud83d\udc65"}),H.jsx("span",{className:"tab-text",children:"Holders"}),H.jsx("span",{className:"tab-count",children:x.length})]})}),H.jsx("button",{className:"collection-nav-tab "+("schemas"===K?"active":""),onClick:()=>Q("schemas"),children:H.jsxs("div",{className:"tab-content",children:[H.jsx("span",{className:"tab-icon",children:"\ud83d\udccb"}),H.jsx("span",{className:"tab-text",children:"Schemas"}),H.jsx("span",{className:"tab-count",children:de.length})]})}),H.jsx("button",{className:"collection-nav-tab "+("templates"===K?"active":""),onClick:()=>Q("templates"),children:H.jsxs("div",{className:"tab-content",children:[H.jsx("span",{className:"tab-icon",children:"\ud83c\udfa8"}),H.jsx("span",{className:"tab-text",children:"Templates"}),H.jsx("span",{className:"tab-count",children:he.length})]})}),H.jsx("button",{className:"collection-nav-tab "+("similar"===K?"active":""),onClick:()=>Q("similar"),children:H.jsxs("div",{className:"tab-content",children:[H.jsx("span",{className:"tab-icon",children:"\ud83d\udd17"}),H.jsx("span",{className:"tab-text",children:"Similar"}),H.jsx("span",{className:"tab-count",children:j.length})]})}),H.jsx("button",{className:"collection-nav-tab "+("chat"===K?"active":""),onClick:()=>Q("chat"),children:H.jsxs("div",{className:"tab-content",children:[H.jsx("span",{className:"tab-icon",children:"\ud83d\udcac"}),H.jsx("span",{className:"tab-text",children:"Chat"}),H.jsx("span",{className:"tab-count",children:"0"})]})})]}),H.jsx("div",{className:"nav-indicator"})]})}),H.jsxs("div",{className:"tab-content-area",children:["sales"===K&&H.jsxs("div",{className:"sales-section",children:[H.jsx("div",{className:"sales-grid",children:I.length>0?I.map((e,a)=>H.jsxs("div",{className:"sale-item",children:[H.jsxs("div",{className:"sale-rank",children:["#",a+1]}),H.jsxs("div",{className:"sale-media",children:[H.jsx(Rt,{imageUrl:aa(e),videoUrl:na(e),alt:String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"NFT"),className:"sale-image",controls:!0,muted:!0,loop:!0,enableAnimations:t.enableAnimatedNFTs}),H.jsx("div",{className:"zoom-overlay",onClick:()=>{const t=aa(e),a=String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"NFT");t&&le({url:t,name:a}),ie(!0)},children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),H.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]}),H.jsxs("div",{className:"sale-details",children:[H.jsx("div",{className:"sale-name",children:e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"Unnamed NFT"}),H.jsxs("div",{className:"sale-template",children:["Template #",e.assets?.[0]?.template?.template_id]}),H.jsx("div",{className:"sale-price",children:e.price?(parseInt(e.price.amount)/Math.pow(10,e.price.token_precision)).toFixed(e.price.token_precision)+" "+e.price.token_symbol:"N/A"}),H.jsx("div",{className:"sale-date",children:be(e.updated_at_time||"")})]})]},e.sale_id||a)):H.jsx("div",{className:"no-data",children:"No sales data available"})}),O&&H.jsx("div",{className:"load-more-section",children:H.jsx("button",{className:"load-more-btn",onClick:()=>{O&&W(e=>e+1)},children:"Load More Sales"})})]}),"holders"===K&&H.jsxs("div",{className:"holders-section",children:[H.jsx("div",{className:"holders-grid",children:x.length>0?x.map((e,t)=>H.jsxs("div",{className:"holder-item",children:[H.jsxs("div",{className:"holder-rank",children:["#",t+1]}),H.jsx(s,{to:`/profile-lookup/${e.account}`,className:"holder-account clickable",children:e.account}),H.jsxs("div",{className:"holder-count",children:[e.assets," assets"]})]},t)):H.jsx("div",{className:"no-data",children:"No holders data available"})}),T&&H.jsx("div",{className:"load-more-section",children:H.jsx("button",{className:"load-more-btn",onClick:async()=>{if(e&&!S&&T){P(!0);try{const t=A+1,a=500*(t-1),n=await $e.getCollectionHolders(e,500,a);n&&n.length>0?(C(e=>[...e,...n]),_(t),$(500===n.length)):$(!1)}catch(t){$(!1)}finally{P(!1)}}},disabled:S,children:S?"Loading...":"Load More Holders"})})]}),"similar"===K&&H.jsx("div",{className:"similar-collections",children:H.jsx("div",{className:"similar-collections-grid",children:j.length>0?j.slice(0,12).map((e,t)=>H.jsx("div",{className:"similar-collection-item",children:H.jsxs(s,{to:`/collections/${e.collection_name}`,children:[H.jsx("div",{className:"similar-collection-name",children:e.collection_name}),H.jsx("div",{className:"similar-collection-volume",children:"Similar Collection"})]})},t)):H.jsx("div",{className:"no-data",children:"No similar collections found"})})}),"chat"===K&&H.jsx("div",{className:"chat-section",children:H.jsx("div",{className:"chat-container",children:H.jsx(Qa,{collectionName:e})})}),H.jsxs("div",{className:"search-filter-section",children:[H.jsxs("div",{className:"search-controls",children:[H.jsxs("div",{className:"search-input-container",children:[H.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("input",{type:"text",placeholder:`Search ${K}...`,value:Z,onChange:e=>ee(e.target.value),className:"search-input"}),Z&&H.jsx("button",{onClick:()=>ee(""),className:"clear-search","aria-label":"Clear search",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),H.jsxs("div",{className:"sort-container",children:[H.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),H.jsxs("select",{id:"sortBy",value:te,onChange:e=>ae(e.target.value),className:"sort-select",children:[H.jsx("option",{value:"name",children:"Name"}),H.jsx("option",{value:"created",children:"Created Date"}),"templates"===K&&H.jsx("option",{value:"supply",children:"Supply"})]})]})]}),Z&&H.jsx("div",{className:"search-results-info",children:H.jsxs("p",{children:["Found ","schemas"===K?de.length:he.length,' results for "',Z,'"']})}),"schemas"===K&&H.jsx("div",{className:"schemas-section",children:0===de.length?H.jsx("div",{className:"empty-state",children:Z?H.jsxs(H.Fragment,{children:[H.jsx("svg",{className:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("h3",{children:"No schemas found"}),H.jsxs("p",{children:['No schemas match your search "',Z,'"']}),H.jsx("button",{onClick:()=>ee(""),className:"clear-search-button",children:"Clear Search"})]}):H.jsx("p",{children:"No schemas found for this collection."})}):H.jsx("div",{className:"schemas-grid",children:de.map(e=>H.jsxs("div",{className:"schema-card",children:[H.jsxs("div",{className:"schema-header",children:[H.jsx("h3",{children:e.schema_name}),H.jsx("button",{className:"view-templates-btn",onClick:()=>{J(e.schema_name),Q("templates")},children:"View Templates"})]}),H.jsxs("div",{className:"schema-format",children:[H.jsx("h4",{children:"Attributes:"}),H.jsx("div",{className:"attributes-list",children:e.format.map((e,t)=>H.jsxs("div",{className:"attribute",children:[H.jsx("span",{className:"attr-name",children:e.name}),H.jsx("span",{className:"attr-type",children:e.type})]},t))})]})]},e.schema_name))})}),"templates"===K&&H.jsxs("div",{className:"templates-section",children:[z&&H.jsxs("div",{className:"schema-filter",children:[H.jsx("label",{children:"Filter by Schema:"}),H.jsxs("select",{value:z,onChange:e=>J(e.target.value),children:[H.jsx("option",{value:"",children:"All Schemas"}),r.map(e=>H.jsx("option",{value:e.schema_name,children:e.schema_name},e.schema_name))]})]}),0===he.length?H.jsx("div",{className:"empty-state",children:Z?H.jsxs(H.Fragment,{children:[H.jsx("svg",{className:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("h3",{children:"No templates found"}),H.jsxs("p",{children:['No templates match your search "',Z,'"']}),H.jsx("button",{onClick:()=>ee(""),className:"clear-search-button",children:"Clear Search"})]}):H.jsxs("p",{children:["No templates found",z?` for schema "${z}"`:" for this collection","."]})}):H.jsx("div",{className:"templates-grid",children:he.map(t=>{return H.jsxs(s,{to:`/collections/${e}/templates/${t.template_id}`,className:"template-card",children:[Ne(t,"template-image"),H.jsxs("div",{className:"template-info",children:[H.jsx("h4",{children:String(t.immutable_data?.name||`Template #${t.template_id}`)}),H.jsxs("p",{className:"template-schema",children:["Template ID: ",t.template_id]}),H.jsxs("p",{className:"template-supply",children:["Supply: ",(a=t.issued_supply,n=t.max_supply,"0"===n?`${a} (Unlimited)`:`${a} / ${n}`)]})]})]},t.template_id);var a,n})})]})]})]}),ne&&H.jsx(Za,{isOpen:ne,imageUrl:re.url,imageName:re.name,onClose:()=>ie(!1)}),ce&&H.jsx(Xt,{isOpen:ce,onClose:()=>oe(!1),title:a?.name||a?.collection_name||"Collection",description:String(a?.data?.description||`Check out this amazing collection: ${a?.name||a?.collection_name}`),imageUrl:ge(a?.img||""),shareUrl:`${window.location.origin}/collections/${a?.collection_name}`,defaultShareText:`Check out the ${a?.name||a?.collection_name} collection on PxMarket! \ud83c\udfae\u2728 Explore it at market.pixeljourney.xyz`,type:"collection"})]}):H.jsx("div",{className:"collection-detail-container",children:H.jsxs("div",{className:"error-state",children:[H.jsx("h2",{children:"Collection Not Found"}),H.jsxs("p",{children:['The collection "',e,'" could not be found.']}),H.jsx(s,{to:"/collections",className:"back-link",children:"\u2190 Back to Collections"})]})})});en.displayName="CollectionDetail";const tn=()=>{const{collectionName:e,templateId:t}=o(),{settings:a}=ke(),[n,r]=i.useState(null),[l,c]=i.useState(null),[d,h]=i.useState(null),[u,m]=i.useState([]),[p,f]=i.useState(!1),[v,y]=i.useState(!1),[g,b]=i.useState(1),[N,w]=i.useState(!0),[k,x]=i.useState(!1),C=i.useCallback(async()=>{if(e&&t){f(!0);try{const[a,n,i]=await Promise.all([$e.getCollectionTemplates(e),$e.getCollectionDetails(e),$e.getCollectionSchemas(e)]),s=a.find(e=>e.template_id===t);if(r(s||null),c(n),s){const a=await $e.getCollectionAssets(e,void 0,t,1);if(a.length>0){const e=a[0].schema_name,t=i.find(t=>t.schema_name===e);h(t||null)}}}catch(a){}finally{f(!1)}}},[e,t,f,r,c,h]),A=i.useCallback(async a=>{if(e&&t){y(!0);try{const n=await $e.getCollectionAssets(e,void 0,t,20);m(1===a?n:e=>[...e,...n]),w(20===n.length),b(a)}catch(n){}finally{y(!1)}}},[e,t,y,m,w,b]);i.useEffect(()=>{e&&t&&(C(),A(1))},[e,t,C,A]);const _=e=>new Date(1e3*parseInt(e)).toLocaleDateString(),S=e=>"object"==typeof e&&null!==e?JSON.stringify(e):String(e);return p?H.jsx("div",{className:"template-detail-container",children:H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading template details..."})]})}):n?H.jsxs("div",{className:"template-detail-container",children:[H.jsxs("div",{className:"breadcrumb",children:[H.jsx(s,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx(s,{to:`/collections/${e}`,className:"breadcrumb-link",children:l?.name||e}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx("span",{className:"breadcrumb-current",children:`Template #${t}`})]}),H.jsxs("div",{className:"template-content",children:[H.jsxs("div",{className:"template-header",children:[H.jsx("div",{className:"template-image-container",children:n&&H.jsx(Rt,{imageUrl:ea(n),videoUrl:ta(n),alt:"Template",className:"template-image",enableAnimations:a.enableAnimatedNFTs})}),H.jsxs("div",{className:"template-info",children:[H.jsx("h1",{children:`Template #${t}`}),H.jsxs("p",{className:"template-id",children:["Template ID: ",n.template_id]}),H.jsxs("p",{className:"template-schema",children:["Schema: ",d?.schema_name||"Loading..."]}),H.jsxs("p",{className:"template-collection",children:["Collection: ",l?.name||l?.collection_name||"Loading..."]}),H.jsxs("div",{className:"template-stats",children:[H.jsxs("div",{className:"stat",children:[H.jsx("span",{className:"stat-value",children:n.issued_supply}),H.jsx("span",{className:"stat-label",children:"Minted"})]}),H.jsxs("div",{className:"stat",children:[H.jsx("span",{className:"stat-value",children:"0"===n.max_supply?"\u221e":n.max_supply}),H.jsx("span",{className:"stat-label",children:"Max Supply"})]}),H.jsxs("div",{className:"stat",children:[H.jsx("span",{className:"stat-value",children:u.length}),H.jsx("span",{className:"stat-label",children:"Assets Loaded"})]})]}),H.jsxs("p",{className:"template-created",children:["Created: ",_(n.created_at_time)]}),H.jsxs("button",{className:"share-btn",onClick:()=>x(!0),style:{marginTop:"20px",padding:"12px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"12px",color:"white",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},children:[H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share Template"]})]})]}),n.immutable_data&&Object.keys(n.immutable_data).length>0&&H.jsxs("div",{className:"template-attributes",children:[H.jsx("h2",{children:"Template Attributes"}),H.jsx("div",{className:"attributes-grid",children:Object.entries(n.immutable_data).map(([e,t])=>H.jsxs("div",{className:"attribute-item",children:[H.jsx("span",{className:"attribute-name",children:e}),H.jsx("span",{className:"attribute-value",children:S(t)})]},e))})]}),d&&d.format&&H.jsxs("div",{className:"schema-format",children:[H.jsx("h2",{children:"Schema Format"}),H.jsx("div",{className:"format-grid",children:d.format.map((e,t)=>H.jsxs("div",{className:"format-item",children:[H.jsx("span",{className:"format-name",children:String(e.name)}),H.jsx("span",{className:"format-type",children:String(e.type)})]},t))})]}),H.jsxs("div",{className:"assets-section",children:[H.jsxs("h2",{children:["Assets (",n.issued_supply," total)"]}),0!==u.length||v?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"assets-grid",children:u.map(e=>H.jsxs(s,{to:`/assets/${e.asset_id}`,className:"asset-card",children:[H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name||`Asset #${e.asset_id}`,className:"asset-image",enableAnimations:a.enableAnimatedNFTs}),H.jsxs("div",{className:"asset-info",children:[H.jsx("h4",{children:e.name||`Asset #${e.asset_id}`}),H.jsxs("p",{className:"asset-id",children:["#",e.asset_id]}),H.jsxs("p",{className:"asset-owner",children:["Owner: ",e.owner]}),H.jsxs("p",{className:"asset-minted",children:["Minted: ",_(e.minted_at_time)]})]})]},e.asset_id))}),N&&H.jsx("div",{className:"load-more-container",children:H.jsx("button",{className:"load-more-btn",onClick:()=>{!v&&N&&A(g+1)},disabled:v,children:v?"Loading...":"Load More Assets"})})]}):H.jsx("div",{className:"empty-state",children:H.jsx("p",{children:"No assets found for this template."})})]})]}),n&&H.jsx(Xt,{isOpen:k,onClose:()=>x(!1),title:`Template #${t}`,description:`${l?.name||l?.collection_name} collection`,imageUrl:ea(n),shareUrl:`${window.location.origin}/collections/${e}/templates/${t}`,defaultShareText:`Check out this amazing template: Template #${t} from ${l?.name||l?.collection_name} collection! \ud83c\udfa8\u2728 View it at ${window.location.origin}/collections/${e}/templates/${t}`,type:"template"})]}):H.jsx("div",{className:"template-detail-container",children:H.jsxs("div",{className:"error-state",children:[H.jsx("h2",{children:"Template Not Found"}),H.jsxs("p",{children:['The template "',t,'" could not be found in collection "',e,'".']}),H.jsx(s,{to:`/collections/${e}`,className:"back-link",children:"\u2190 Back to Collection"})]})})},an=()=>{const{assetId:e}=o(),[t,a]=i.useState(null),[n,r]=i.useState(!1),[l,c]=i.useState(null),[d,h]=i.useState(!1),[u,m]=i.useState(""),{isConnected:p,purchaseNFT:f,login:v}=Q(),{showSuccess:y,showError:g,showWarning:b}=We(),N=i.useCallback(async()=>{if(e){r(!0);try{const t=await $e.getAssetDetails(e);a(t)}catch(t){se.error("Failed to load asset data","AssetDetail.loadAssetData",t,{assetId:e})}finally{r(!1)}}},[e]),w=i.useCallback(async()=>{if(e){h(!0);try{const n=await $e.getMarketplaceNFTs({page:1,limit:1,asset_id:e});if(n.data&&n.data.length>0){const i=n.data[0],r={sale_id:i.sale_id,asset_id:i.asset_id,name:t?.name||`Asset #${i.asset_id}`,image:String(t?.data?.img||t?.template?.immutable_data?.img||""),price:i.price,seller:i.seller,collection:t?.collection?.collection_name||"Unknown",schema:t?.schema?.schema_name||"Unknown",template_mint:void 0,max_supply:t?.template?.max_supply||void 0,traits:t?.data?Object.fromEntries(Object.entries(t.data).filter(([,e])=>null!=e)):{}};if(c(r),r.price)try{const e=parseFloat(r.price.replace(" WAX","")),t=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),a=await t.json(),n=(e*(a.wax?.usd||0)).toFixed(2);m(`$${n} USD`)}catch(a){se.warn("Failed to fetch USD price for asset","AssetDetail.checkListingStatus",{assetId:e,error:a.message})}}else c(null),m("")}catch(a){se.error("Failed to check listing status","AssetDetail.checkListingStatus",a,{assetId:e}),c(null)}finally{h(!1)}}},[e]);i.useEffect(()=>{e&&(N(),w())},[e,N,w]);const k=()=>t?Qt(t)??"https://pixeljourney.xyz/img/toppixals/10.webp":"https://pixeljourney.xyz/img/toppixals/10.webp",x=e=>new Date(1e3*parseInt(e)).toLocaleString(),C=e=>{if(null==e)return H.jsx("span",{className:"null-value",children:"null"});if("boolean"==typeof e)return H.jsx("span",{className:"boolean-value",children:e.toString()});if("number"==typeof e)return H.jsx("span",{className:"number-value",children:e.toLocaleString()});if("object"==typeof e)return H.jsx("pre",{className:"object-value",children:JSON.stringify(e,null,2)});const t=String(e);return t.match(/\.(jpg|jpeg|png|gif|webp)$/i)||t.startsWith("Qm")?H.jsxs("div",{className:"image-attribute",children:[H.jsx("img",{src:(a=t,a?a.startsWith("http")?a:(n=a)?n.startsWith("http")?n:Kt(n):"":"https://pixeljourney.xyz/img/toppixals/10.webp"),alt:"Attribute image",className:"attribute-image",onError:e=>{e.currentTarget.style.display="none"}}),H.jsx("span",{className:"image-hash",children:t})]}):H.jsx("span",{className:"string-value",children:t});var a,n};if(n)return H.jsx("div",{className:"asset-detail-container",children:H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading asset details..."})]})});if(!t)return H.jsx("div",{className:"asset-detail-container",children:H.jsxs("div",{className:"error-state",children:[H.jsx("h2",{children:"Asset Not Found"}),H.jsxs("p",{children:['The asset "',e,'" could not be found.']}),H.jsx(s,{to:"/collections",className:"back-link",children:"\u2190 Back to Collections"})]})});const A=t?Zt(t):null,_=t?{...t.template?.immutable_data,...t.data}:{};return H.jsx("div",{className:"asset-detail-container",children:H.jsxs("div",{className:"asset-content",children:[H.jsxs("div",{className:"breadcrumb",children:[H.jsx(s,{to:"/",className:"breadcrumb-link",children:"Home"}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx(s,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx(s,{to:`/collections/${t.collection.collection_name}`,className:"breadcrumb-link",children:t.collection.name||t.collection.collection_name}),H.jsx("span",{className:"breadcrumb-separator",children:"\u203a"}),H.jsx("span",{className:"breadcrumb-current",children:t.name||`Asset #${e}`})]}),H.jsxs("div",{className:"asset-header",children:[H.jsx("div",{className:"asset-media-container",children:A?H.jsx("video",{src:A,className:"asset-video",controls:!0,poster:k(),children:"Your browser does not support the video tag."}):H.jsx("img",{src:k(),alt:t.name||`Asset #${e}`,className:"asset-image",onError:()=>{}})}),H.jsxs("div",{className:"asset-info",children:[H.jsx("h1",{children:t.name||`Asset #${e}`}),H.jsxs("p",{className:"asset-id",children:["Asset ID: ",t.asset_id]}),H.jsxs("div",{className:"asset-links",children:[H.jsxs("p",{className:"asset-collection",children:["Collection:",H.jsx(s,{to:`/collections/${t.collection.collection_name}`,children:t.collection.name||t.collection.collection_name})]}),H.jsxs("p",{className:"asset-template",children:["Template:",H.jsx(s,{to:`/collections/${t.collection.collection_name}/templates/${t.template.template_id}`,children:t.template?.immutable_data?.name||`#${t.template.template_id}`})]}),H.jsxs("p",{className:"asset-schema",children:["Schema: ",t.schema.schema_name]})]}),H.jsxs("div",{className:"asset-ownership",children:[H.jsxs("div",{className:"owner-info",children:[H.jsx("span",{className:"owner-label",children:"Owner:"}),H.jsx("span",{className:"owner-address",children:t.owner})]}),H.jsxs("div",{className:"author-info",children:[H.jsx("span",{className:"author-label",children:"Collection Author:"}),H.jsx("span",{className:"author-address",children:t.owner||"Unknown"})]})]}),d?H.jsx("div",{className:"listing-status loading",children:H.jsx("span",{children:"Checking listing status..."})}):l?H.jsxs("div",{className:"listing-status available",children:[H.jsxs("div",{className:"listing-info",children:[H.jsx("h3",{children:"Available for Sale"}),H.jsxs("div",{className:"price-display",children:[H.jsx("span",{className:"price-wax",children:l.price}),u&&H.jsx("span",{className:"price-usd",children:u})]})]}),H.jsx("button",{className:"buy-now-btn",onClick:async()=>{if(l)try{if(!p){b("Please connect your wallet to purchase this NFT");try{await v()}catch(t){return void se.error("Wallet login failed during purchase","AssetDetail.handlePurchase",t,{assetId:e,saleId:l.sale_id})}}if(!l.sale_id||!l.price)return void g("This NFT is not available for purchase");const a=l.price.replace(" WAX","");se.info("Initiating NFT purchase","AssetDetail.handlePurchase",{saleId:l.sale_id,price:a,assetId:e}),await f(l.sale_id,a),y(`Successfully purchased ${l.name||"NFT"}!`),w()}catch(t){se.error("NFT purchase failed","AssetDetail.handlePurchase",t,{assetId:e,saleId:l?.sale_id,price:l?.price});const a=t instanceof Error?t.message:"Unknown error occurred";g(`Purchase failed: ${a}`)}},disabled:!p,children:p?"Buy Now":"Connect Wallet to Buy"})]}):H.jsx("div",{className:"listing-status not-listed",children:H.jsx("span",{children:"Not currently listed for sale"})}),H.jsxs("div",{className:"asset-timestamps",children:[H.jsxs("div",{className:"timestamp",children:[H.jsx("span",{className:"timestamp-label",children:"Minted:"}),H.jsx("span",{className:"timestamp-value",children:x(t.minted_at_time)})]}),H.jsxs("div",{className:"timestamp",children:[H.jsx("span",{className:"timestamp-label",children:"Last Transfer:"}),H.jsx("span",{className:"timestamp-value",children:x(t.transferred_at_time)})]}),H.jsxs("div",{className:"timestamp",children:[H.jsx("span",{className:"timestamp-label",children:"Last Update:"}),H.jsx("span",{className:"timestamp-value",children:x(t.updated_at_time)})]})]}),t.burned_by_account&&H.jsxs("div",{className:"burn-info",children:[H.jsx("span",{className:"burn-label",children:"\ud83d\udd25 Burned by:"}),H.jsx("span",{className:"burn-account",children:t.burned_by_account}),H.jsx("span",{className:"burn-time",children:x(t.burned_at_time)})]})]})]}),H.jsxs("div",{className:"template-info-section",children:[H.jsx("h2",{children:"Template Information"}),H.jsxs("div",{className:"template-stats",children:[H.jsxs("div",{className:"template-stat",children:[H.jsx("span",{className:"stat-label",children:"Template ID:"}),H.jsx("span",{className:"stat-value",children:t.template.template_id})]}),H.jsxs("div",{className:"template-stat",children:[H.jsx("span",{className:"stat-label",children:"Max Supply:"}),H.jsx("span",{className:"stat-value",children:"0"===t.template.max_supply?"Unlimited":t.template.max_supply})]}),H.jsxs("div",{className:"template-stat",children:[H.jsx("span",{className:"stat-label",children:"Issued Supply:"}),H.jsx("span",{className:"stat-value",children:t.template.issued_supply})]})]})]}),Object.keys(_).length>0&&H.jsxs("div",{className:"asset-attributes",children:[H.jsx("h2",{children:"Attributes"}),H.jsx("div",{className:"attributes-grid",children:Object.entries(_).map(([e,t])=>H.jsxs("div",{className:"attribute-item",children:[H.jsx("span",{className:"attribute-name",children:e}),H.jsx("div",{className:"attribute-value",children:C(t)})]},e))})]}),H.jsxs("div",{className:"schema-format",children:[H.jsx("h2",{children:"Schema Format"}),H.jsx("div",{className:"format-grid",children:t.schema.format?.map((e,t)=>H.jsxs("div",{className:"format-item",children:[H.jsx("span",{className:"format-name",children:e.name}),H.jsx("span",{className:"format-type",children:e.type})]},t))})]}),t.backed_tokens&&t.backed_tokens.length>0&&H.jsxs("div",{className:"backed-tokens",children:[H.jsx("h2",{children:"Backed Tokens"}),H.jsx("div",{className:"tokens-list",children:t.backed_tokens.map((e,t)=>H.jsx("div",{className:"token-item",children:H.jsx("pre",{children:JSON.stringify(e,null,2)})},t))})]})]})})},nn=()=>{const{saleId:e}=o(),t=l(),[a,n]=i.useState(null),[r,s]=i.useState(!0),[c,d]=i.useState(null),[h,u]=i.useState(""),[m,p]=i.useState(!1),[f,v]=i.useState(!1),[y,g]=i.useState(!1),[b,N]=i.useState(!1),[w,k]=i.useState(0);i.useEffect(()=>{e&&x()},[e]);const x=async()=>{if(e)try{s(!0),d(null);const t=`${$e.atomicMarketAPI}/atomicmarket/v1/sales/${e}`,a=await $e.fetchWithRetry(t),i=await a.json();if(i.success&&i.data){const e=i.data;k(e.state);const t={sale_id:e.sale_id,asset_id:e.assets[0]?.asset_id||"",name:e.assets[0]?.name||`${e.assets[0]?.collection?.collection_name||"Unknown"} #${e.assets[0]?.asset_id}`,image:C(e.assets[0]),price:`${(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision)).toFixed(4)} ${e.price.token_symbol}`,seller:e.seller,collection:e.assets[0]?.collection?.collection_name||"Unknown",schema:e.assets[0]?.schema?.schema_name||"Unknown",template_mint:parseInt(e.assets[0]?.template?.template_id||"0")||0,max_supply:e.assets[0]?.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(e.assets[0]?.data||{}).map(([e,t])=>[e,null==t?"":"string"==typeof t||"number"==typeof t||"boolean"==typeof t?t:String(t)]))};n(t);const a=parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision),r=await $e.getUSDPrice(a);u(r)}else d("Listing not found")}catch(t){d(`Failed to load listing data: ${t instanceof Error?t.message:"Unknown error"}`)}finally{s(!1)}},C=e=>e?e.data?.img?e.data.img.startsWith("http")?e.data.img:`https://ipfs.io/ipfs/${e.data.img}`:e.data?.image?e.data.image.startsWith("http")?e.data.image:`https://ipfs.io/ipfs/${e.data.image}`:e.template?.immutable_data?.img?e.template.immutable_data.img.startsWith("http")?e.template.immutable_data.img:`https://ipfs.io/ipfs/${e.template.immutable_data.img}`:e.template?.immutable_data?.image?e.template.immutable_data.image.startsWith("http")?e.template.immutable_data.image:`https://ipfs.io/ipfs/${e.template.immutable_data.image}`:"https://pixeljourney.xyz/img/toppixals/10.webp":"",{isConnected:A,purchaseNFT:_,login:S}=Q(),{showSuccess:P,showError:T,showWarning:$}=We();return r?H.jsx("div",{className:"listing-detail-container",children:H.jsxs("div",{className:"loading-container",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading listing..."})]})}):c||!a?H.jsx("div",{className:"listing-detail-container",children:H.jsxs("div",{className:"error-container",children:[H.jsx("h2",{children:"Listing Not Found"}),H.jsx("p",{children:c||"The requested listing could not be found."}),H.jsx("button",{onClick:()=>t("/marketplace"),className:"btn-primary",children:"Back to Marketplace"})]})}):H.jsxs("div",{className:"listing-detail-container",children:[H.jsxs("div",{className:"listing-detail-header",children:[H.jsx("button",{onClick:()=>t(-1),className:"back-button",children:"\u2190 Back"}),H.jsx("h1",{children:"Listing Details"})]}),H.jsxs("div",{className:"listing-detail-content",children:[H.jsx("div",{className:"listing-image-section",children:H.jsx("div",{className:"listing-image",children:a.image.includes(".mp4")||a.image.includes(".webm")?H.jsx("video",{src:a.image,controls:!0,muted:!0,loop:!0,className:"listing-media"}):H.jsxs(H.Fragment,{children:[H.jsx("img",{src:a.image,alt:a.name,className:"listing-media",onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),H.jsx("div",{className:"zoom-overlay",onClick:()=>N(!0),children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),H.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]})})}),H.jsxs("div",{className:"listing-info-section",children:[H.jsxs("div",{className:"listing-header",children:[H.jsx("h2",{children:a.name}),H.jsxs("div",{className:"listing-actions",children:[H.jsx("button",{onClick:()=>p(!0),className:"listing-detail-nav-btn",children:"\ud83d\udccb View Details"}),H.jsxs("button",{onClick:()=>v(!0),className:"listing-detail-nav-btn",children:[H.jsx("svg",{viewBox:"0 -8 72 72",fill:"currentColor",style:{width:"16px",height:"16px",marginRight:"8px"},children:H.jsx("path",{d:"M64,12.78v17s-3.63.71-4.38.81-3.08.85-4.78-.78C52.22,27.25,42.93,18,42.93,18a3.54,3.54,0,0,0-4.18-.21c-2.36,1.24-5.87,3.07-7.33,3.78a3.37,3.37,0,0,1-5.06-2.64,3.44,3.44,0,0,1,2.1-3c3.33-2,10.36-6,13.29-7.52,1.78-1,3.06-1,5.51,1C50.27,12,53,14.27,53,14.27a2.75,2.75,0,0,0,2.26.43C58.63,14,64,12.78,64,12.78ZM27,41.5a3,3,0,0,0-3.55-4.09,3.07,3.07,0,0,0-.64-3,3.13,3.13,0,0,0-3-.75,3.07,3.07,0,0,0-.65-3,3.38,3.38,0,0,0-4.72.13c-1.38,1.32-2.27,3.72-1,5.14s2.64.55,3.72.3c-.3,1.07-1.2,2.07-.09,3.47s2.64.55,3.72.3c-.3,1.07-1.16,2.16-.1,3.46s2.84.61,4,.25c-.45,1.15-1.41,2.39-.18,3.79s4.08.75,5.47-.58a3.32,3.32,0,0,0,.3-4.68A3.18,3.18,0,0,0,27,41.5Zm25.35-8.82L41.62,22a3.53,3.53,0,0,0-3.77-.68c-1.5.66-3.43,1.56-4.89,2.24a8.15,8.15,0,0,1-3.29,1.1,5.59,5.59,0,0,1-3-10.34C29,12.73,34.09,10,34.09,10a6.46,6.46,0,0,0-5-2C25.67,8,18.51,12.7,18.51,12.7a5.61,5.61,0,0,1-4.93.13L8,10.89v19.4s1.59.46,3,1a6.33,6.33,0,0,1,1.56-2.47,6.17,6.17,0,0,1,8.48-.06,5.4,5.4,0,0,1,1.34,2.37,5.49,5.49,0,0,1,2.29,1.4A5.4,5.4,0,0,1,26,34.94a5.47,5.47,0,0,1,3.71,4,5.38,5.38,0,0,1,2.39,1.43,5.65,5.65,0,0,1,1.48,4.89a0,0,0,0,1,0,0s.8.9,1.29,1.39a2.46,2.46,0,0,0,3.48-3.48s2,2.48,4.28,1c2-1.4,1.69-3.06.74-4a3.19,3.19,0,0,0,4.77.13,2.45,2.45,0,0,0,.13-3.3s1.33,1.81,4,.12c1.89-1.6,1-3.43,0-4.39Z"})}),"Make Offer"]}),H.jsx("button",{onClick:()=>g(!0),className:"listing-detail-nav-btn",children:"\ud83d\udd17 Share"})]})]}),H.jsxs("div",{className:"listing-price-section",children:[H.jsxs("div",{className:"price-display",children:[H.jsx("div",{className:"price-main",children:a.price}),H.jsx("div",{className:"price-usd",children:h}),H.jsx("div",{className:"sale-status-display",children:H.jsx("span",{className:"status-badge "+(1===w?"status-active":3===w?"status-sold":"status-canceled"),children:1===w?"\ud83d\udd04 Available":3===w?"\u2705 Sold":"\u274c Canceled"})})]}),1===w?H.jsx("button",{onClick:async()=>{if(a)try{if(!A){$("Please connect your wallet to purchase this NFT");try{await S()}catch(e){return void se.error("Login failed","ListingDetail",e)}}if(!a.sale_id||!a.price)return void T("This NFT is not available for purchase");const n=a.price.replace(" WAX","");se.info("Purchasing NFT","ListingDetail.handlePurchase",{saleId:a.sale_id,price:n}),await _(a.sale_id,n),P(`Successfully purchased ${a.name||"NFT"}!`),t("/marketplace")}catch(e){se.error("Purchase failed","ListingDetail",e);const t=e instanceof Error?e.message:"Unknown error occurred";T(`Purchase failed: ${t}`)}},className:"listing-detail-nav-btn listing-detail-primary-btn purchase-btn",children:"\ud83d\uded2 Buy Now"}):H.jsx("button",{disabled:!0,className:"listing-detail-nav-btn listing-detail-primary-btn purchase-btn",children:3===w?"\u2705 Sold":"\u274c Not Available"})]}),H.jsxs("div",{className:"listing-details",children:[H.jsxs("div",{className:"detail-item",children:[H.jsx("span",{className:"detail-label",children:"Collection:"}),H.jsx("span",{className:"detail-value link",onClick:()=>{a&&t(`/collections/${a.collection}`)},children:a.collection})]}),H.jsxs("div",{className:"detail-item",children:[H.jsx("span",{className:"detail-label",children:"Schema:"}),H.jsx("span",{className:"detail-value",children:a.schema})]}),H.jsxs("div",{className:"detail-item",children:[H.jsx("span",{className:"detail-label",children:"Asset ID:"}),H.jsx("span",{className:"detail-value link",onClick:()=>{a&&a.asset_id&&t(`/assets/${a.asset_id}`)},children:a.asset_id})]}),H.jsxs("div",{className:"detail-item",children:[H.jsx("span",{className:"detail-label",children:"Seller:"}),H.jsx("span",{className:"detail-value link",onClick:()=>{a&&a.seller&&t(`/user-profile-lookup?user=${encodeURIComponent(a.seller)}`)},children:a.seller})]}),H.jsxs("div",{className:"detail-item",children:[H.jsx("span",{className:"detail-label",children:"Sale ID:"}),H.jsx("span",{className:"detail-value",children:a.sale_id})]}),a.template_mint&&a.template_mint>0&&H.jsxs("div",{className:"detail-item",children:[H.jsx("span",{className:"detail-label",children:"Mint:"}),H.jsxs("span",{className:"detail-value",children:[a.template_mint," / ","0"===a.max_supply?"\u221e":a.max_supply]})]})]}),a.traits&&Object.keys(a.traits).length>0&&H.jsxs("div",{className:"listing-attributes",children:[H.jsx("h3",{children:"Attributes"}),H.jsx("div",{className:"attributes-grid",children:Object.entries(a.traits).map(([e,t])=>H.jsxs("div",{className:"attribute-item",children:[H.jsx("span",{className:"attribute-name",children:e}),H.jsx("span",{className:"attribute-value",children:t})]},e))})]})]})]}),H.jsx(ia,{nft:a,isOpen:m,onClose:()=>p(!1)}),H.jsx(Ot,{nft:a,isOpen:f,onClose:()=>v(!1)}),H.jsx(sa,{nft:a,isOpen:y,onClose:()=>g(!1)}),H.jsx(Za,{isOpen:b,onClose:()=>N(!1),imageUrl:a.image,imageName:a.name})]})},rn=()=>{const{transactionId:e}=o(),t=l(),[a,n]=i.useState(null),[r,s]=i.useState(null),[c,d]=i.useState(!0),[h,u]=i.useState(null),[m,p]=i.useState("overview");i.useEffect(()=>{e&&f(e)},[e]);const f=async e=>{try{d(!0),u(null);const t=await fetch("https://wax.eosrio.io/v1/history/get_transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok)throw new Error(`Failed to fetch transaction: ${t.status}`);const a=await t.json();if(!a.id)throw new Error("Transaction not found");const i={transaction_id:a.id,block_num:a.block_num,block_time:a.block_time,action_name:a.trx?.transaction?.actions?.[0]?.name||"unknown",actor:a.trx?.transaction?.actions?.[0]?.authorization?.[0]?.actor||"unknown",receiver:a.trx?.transaction?.actions?.[0]?.account||"unknown",status:"executed"===a.receipt?.status?"success":"failed",cpu_usage_us:a.receipt?.cpu_usage_us||0,net_usage_words:a.receipt?.max_net_usage_words||a.receipt?.net_usage_words||0,traces:a.traces||[]},r=a.trx?.transaction?.actions?.[0]?.data;r&&(r.asset_ids&&(i.asset_id=r.asset_ids[0]),r.from&&(i.from=r.from),r.to&&(i.to=r.to),r.memo&&(i.memo=r.memo),r.listing_price_to_assert&&(i.price=`${parseFloat(r.listing_price_to_assert.split(" ")[0])} WAX`)),n(i);const l=await fetch("https://wax.eosrio.io/v1/chain/get_block",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({block_num_or_id:a.block_num})});if(l.ok){const e=await l.json();s({block_num:e.block_num,block_id:e.id,timestamp:e.timestamp,producer:e.producer,transaction_count:e.transactions?.length||0})}}catch(t){se.error("Error fetching transaction details","TransactionDetails.fetchTransactionDetails",t),u(t instanceof Error?t.message:"Failed to load transaction details")}finally{d(!1)}},v=e=>{t(`/user-profile-lookup?user=${encodeURIComponent(e)}`)};return c?H.jsx("div",{className:"page-content",children:H.jsx("div",{className:"transaction-details-container",children:H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading transaction details..."})]})})}):h||!a?H.jsx("div",{className:"page-content",children:H.jsx("div",{className:"transaction-details-container",children:H.jsxs("div",{className:"error-state",children:[H.jsx("h2",{children:"Transaction Not Found"}),H.jsx("p",{children:h||"The requested transaction could not be found."}),H.jsx("button",{onClick:()=>t(-1),className:"btn btn-primary",children:"Go Back"})]})})}):H.jsx("div",{className:"page-content",children:H.jsxs("div",{className:"transaction-details-container",children:[H.jsxs("div",{className:"transaction-header",children:[H.jsx("button",{onClick:()=>t(-1),className:"back-button",children:"\u2190 Back"}),H.jsxs("div",{className:"transaction-title",children:[H.jsx("h1",{children:"Transaction Details"}),H.jsxs("div",{className:"transaction-id",children:[H.jsxs("span",{children:["ID: ",a.transaction_id]}),H.jsx("button",{onClick:()=>{return e=a.transaction_id,void navigator.clipboard.writeText(e);var e},className:"copy-button",title:"Copy transaction ID",children:"\ud83d\udccb"})]})]}),H.jsxs("div",{className:`transaction-status ${a.status}`,children:["success"===a.status?"\u2705":"\u274c"," ",a.status.toUpperCase()]})]}),H.jsxs("div",{className:"tab-navigation",children:[H.jsx("button",{className:"tab "+("overview"===m?"active":""),onClick:()=>p("overview"),children:"Overview"}),H.jsx("button",{className:"tab "+("traces"===m?"active":""),onClick:()=>p("traces"),children:"Action Traces"}),H.jsx("button",{className:"tab "+("raw"===m?"active":""),onClick:()=>p("raw"),children:"Raw Data"})]}),H.jsxs("div",{className:"tab-content",children:["overview"===m&&H.jsxs("div",{className:"overview-tab",children:[H.jsxs("div",{className:"info-section",children:[H.jsx("h3",{children:"Basic Information"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Block Number:"}),H.jsx("span",{children:a.block_num.toLocaleString()})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Timestamp:"}),H.jsx("span",{children:(y=a.block_time,new Date(y+"Z").toLocaleString())})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Action:"}),H.jsx("span",{className:"action-name",children:a.action_name})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Contract:"}),H.jsx("span",{className:"contract-name",children:a.receiver})]})]})]}),H.jsxs("div",{className:"info-section",children:[H.jsx("h3",{children:"Transaction Parties"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Actor:"}),H.jsx("span",{className:"clickable-account",onClick:()=>v(a.actor),children:a.actor})]}),a.from&&a.from!==a.actor&&H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"From:"}),H.jsx("span",{className:"clickable-account",onClick:()=>v(a.from),children:a.from})]}),a.to&&H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"To:"}),H.jsx("span",{className:"clickable-account",onClick:()=>v(a.to),children:a.to})]})]})]}),(a.asset_id||a.price)&&H.jsxs("div",{className:"info-section",children:[H.jsx("h3",{children:"Asset Information"}),H.jsxs("div",{className:"info-grid",children:[a.asset_id&&H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Asset ID:"}),H.jsx("span",{className:"clickable-asset",onClick:()=>{return e=a.asset_id,void t(`/assets/${e}`);var e},children:a.asset_id})]}),a.asset_name&&H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Asset Name:"}),H.jsx("span",{children:a.asset_name})]}),a.collection_name&&H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Collection:"}),H.jsx("span",{children:"string"==typeof a.collection_name?a.collection_name:a.collection_name?.collection_name||a.collection_name?.name||"Unknown"})]}),a.price&&H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Price:"}),H.jsx("span",{className:"price",children:a.price})]})]})]}),H.jsxs("div",{className:"info-section",children:[H.jsx("h3",{children:"Resource Usage"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"CPU Usage:"}),H.jsxs("span",{children:[a.cpu_usage_us.toLocaleString()," \u03bcs"]})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"NET Usage:"}),H.jsxs("span",{children:[a.net_usage_words.toLocaleString()," words"]})]})]})]}),r&&H.jsxs("div",{className:"info-section",children:[H.jsx("h3",{children:"Block Information"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Block ID:"}),H.jsx("span",{className:"block-id",children:r.block_id})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Producer:"}),H.jsx("span",{children:r.producer})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("label",{children:"Transactions in Block:"}),H.jsx("span",{children:r.transaction_count})]})]})]}),a.memo&&H.jsxs("div",{className:"info-section",children:[H.jsx("h3",{children:"Memo"}),H.jsx("div",{className:"memo-content",children:a.memo})]})]}),"traces"===m&&H.jsxs("div",{className:"traces-tab",children:[H.jsx("h3",{children:"Action Traces"}),a.traces&&a.traces.length>0?H.jsx("div",{className:"traces-list",children:a.traces.map((e,t)=>H.jsxs("div",{className:"trace-item",children:[H.jsxs("div",{className:"trace-header",children:[H.jsxs("span",{className:"trace-index",children:["#",t+1]}),H.jsx("span",{className:"trace-action",children:e.act?.name||"unknown"}),H.jsx("span",{className:"trace-account",children:e.act?.account||"unknown"})]}),H.jsx("pre",{className:"trace-data",children:JSON.stringify(e,null,2)})]},t))}):H.jsx("p",{children:"No action traces available for this transaction."})]}),"raw"===m&&H.jsxs("div",{className:"raw-tab",children:[H.jsx("h3",{children:"Raw Transaction Data"}),H.jsx("pre",{className:"raw-data",children:JSON.stringify(a,null,2)})]})]})]})});var y},sn=({isOpen:e,onClose:t,resourceType:a,action:n,onSuccess:r})=>{const[s,l]=i.useState(""),[c,o]=i.useState(!1),{session:d,transact:h}=Q(),{showError:u}=We();if(!e)return null;const m=a.toUpperCase(),p="stake"===n?"Stake":"Unstake";return H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h2",{children:[p," ",m]}),H.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"resource-info",children:[H.jsx("div",{className:"resource-icon",children:"cpu"===a?"\u26a1":"\ud83c\udf10"}),H.jsxs("div",{className:"resource-description",children:[H.jsxs("h3",{children:[m," ",p]}),H.jsx("p",{children:"stake"===n?`Stake WAX to increase your ${m} resources. Staked tokens will be locked for 3 days after unstaking.`:`Unstake WAX from your ${m} resources. Tokens will be available after a 3-day waiting period.`})]})]}),H.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d&&s&&!(parseFloat(s)<=0)){o(!0);try{const e=`${parseFloat(s).toFixed(8)} WAX`;if("stake"===n){const t=[{account:"eosio",name:"delegatebw",authorization:[{actor:d.actor.toString(),permission:d.permission.toString()}],data:{from:d.actor.toString(),receiver:d.actor.toString(),stake_net_quantity:"net"===a?e:"0.00000000 WAX",stake_cpu_quantity:"cpu"===a?e:"0.00000000 WAX",transfer:!1}}];await h(t)}else{const t=[{account:"eosio",name:"undelegatebw",authorization:[{actor:d.actor.toString(),permission:d.permission.toString()}],data:{from:d.actor.toString(),receiver:d.actor.toString(),unstake_net_quantity:"net"===a?e:"0.00000000 WAX",unstake_cpu_quantity:"cpu"===a?e:"0.00000000 WAX"}}];await h(t)}r?.(),t()}catch(i){se.error(`Failed to ${n} ${a.toUpperCase()}`,"StakingModal.handleSubmit",i,{action:n,resourceType:a,amount:s}),u(`Failed to ${n} ${a.toUpperCase()}. Please try again.`,"Transaction Failed")}finally{o(!1)}}},children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"amount",children:"Amount (WAX)"}),H.jsx("input",{type:"number",id:"amount",value:s,onChange:e=>l(e.target.value),placeholder:"Enter WAX amount",min:"0.00000001",step:"0.00000001",required:!0,disabled:c})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:c,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary",disabled:c||!s||parseFloat(s)<=0,children:c?"Processing...":`${p} ${m}`})]})]})]})]})})},ln=({isOpen:e,onClose:t,action:a,onSuccess:n})=>{const[r,s]=i.useState(""),[l,c]=i.useState(!1),[o,d]=i.useState(null),[h,u]=i.useState(null),[m,p]=i.useState(!1),{session:f,transact:v}=Q(),{showSuccess:y,showError:g}=We();i.useEffect(()=>{e&&f&&b()},[e,f]);const b=async()=>{if(f){p(!0);try{const e=await fetch("https://wax.greymass.com/v1/chain/get_table_rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"eosio",scope:"eosio",table:"rammarket",limit:1})});if(e.ok){const t=await e.json();if(t.rows&&t.rows.length>0){const e=t.rows[0],a=parseFloat(e.quote.balance.split(" ")[0]),n=parseFloat(e.base.balance.split(" ")[0]);d(a/n)}}const t=await fetch("https://wax.greymass.com/v1/chain/get_account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:f.actor.toString()})});if(t.ok){const e=await t.json();u(e.ram_quota-e.ram_usage)}}catch(e){se.error("Failed to fetch RAM market data","RAMModal.fetchRAMData",e,{account:f?.actor.toString()})}finally{p(!1)}}};if(!e)return null;const N="buy"===a?"Buy":"Sell",w="buy"===a?"Amount (WAX)":"Bytes to Sell",k="buy"===a?"Enter WAX amount":"Enter bytes amount";return H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h2",{children:[N," RAM"]}),H.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"resource-info",children:[H.jsx("div",{className:"resource-icon",children:"\ud83d\udcbe"}),H.jsxs("div",{className:"resource-description",children:[H.jsxs("h3",{children:["RAM ",N]}),H.jsx("p",{children:"buy"===a?"Purchase RAM with WAX tokens. RAM is used to store account data and smart contract state.":"Sell RAM bytes back to the system for WAX tokens. Only sell RAM you don't need."}),H.jsx("div",{className:"ram-market-info",children:m?H.jsx("div",{className:"loading-info",children:H.jsx("span",{children:"Loading RAM market data..."})}):H.jsxs(H.Fragment,{children:[null!==o&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Current RAM Price:"}),H.jsxs("span",{className:"stat-value",children:[(1024*o).toFixed(8)," WAX/KB"]})]}),"sell"===a&&null!==h&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Available RAM:"}),H.jsxs("span",{className:"stat-value",children:[h.toLocaleString()," bytes"]})]}),"buy"===a&&null!==o&&r&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Estimated RAM:"}),H.jsxs("span",{className:"stat-value",children:[Math.floor(parseFloat(r)/o).toLocaleString()," bytes"]})]}),"sell"===a&&null!==o&&r&&H.jsxs("div",{className:"market-stat",children:[H.jsx("span",{className:"stat-label",children:"Estimated WAX:"}),H.jsxs("span",{className:"stat-value",children:[(parseFloat(r)*o).toFixed(8)," WAX"]})]})]})})]})]}),H.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),f&&r&&!(parseFloat(r)<=0)){if("sell"===a&&null!==h&&Math.floor(parseFloat(r))>h)return void g("Insufficient RAM",`You only have ${h.toLocaleString()} bytes available to sell.`);c(!0);try{if("buy"===a){const e=`${parseFloat(r).toFixed(8)} WAX`,t=[{account:"eosio",name:"buyram",authorization:[{actor:f.actor.toString(),permission:f.permission.toString()}],data:{payer:f.actor.toString(),receiver:f.actor.toString(),quant:e}}];await v(t),y("RAM Purchase Successful",`Successfully purchased RAM with ${e}!`)}else{const e=Math.floor(parseFloat(r)),t=[{account:"eosio",name:"sellram",authorization:[{actor:f.actor.toString(),permission:f.permission.toString()}],data:{account:f.actor.toString(),bytes:e}}];await v(t),y("RAM Sale Successful",`Successfully sold ${e.toLocaleString()} bytes of RAM!`)}n?.(),t(),s("")}catch(i){se.error(`Failed to ${a} RAM`,"RAMModal.handleSubmit",i,{action:a,amount:r,account:f?.actor.toString()});const e=i instanceof Error?i.message:"Unknown error occurred";g(`RAM ${"buy"===a?"Purchase":"Sale"} Failed`,e)}finally{c(!1)}}},children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"amount",children:w}),H.jsx("input",{type:"number",id:"amount",value:r,onChange:e=>s(e.target.value),placeholder:k,min:"buy"===a?"0.00000001":"1",step:"buy"===a?"0.00000001":"1",required:!0,disabled:l}),"buy"===a&&H.jsx("small",{className:"form-hint",children:"Minimum: 0.00000001 WAX"}),"sell"===a&&H.jsx("small",{className:"form-hint",children:"Enter the number of bytes to sell"})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:l,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary",disabled:l||!r||parseFloat(r)<=0,children:l?"Processing...":`${N} RAM`})]})]})]})]})})},cn=({token:e,isOpen:t,onClose:a,onSuccess:n})=>{const[r,s]=i.useState(""),[l,c]=i.useState(""),[o,d]=i.useState(""),[h,u]=i.useState(!1),[m,p]=i.useState([]),[f,v]=i.useState(!1),{session:y,transferTokens:g}=Q(),{showSuccess:b,showError:N}=We(),w=e=>/^[a-z1-5.]{1,12}$/.test(e)&&e.length>=1&&e.length<=12,k=t=>{const a=parseFloat(t),n=parseFloat(e?.balance||"0");return a>0&&a<=n},x=()=>l&&0!==m.length?parseFloat(l)/m.length:0,C=e=>{const t=e.split(" ");if(t.length>0){const e=t[0].split(".")[1];return e?e.length:0}return 8},A=()=>{h||(s(""),c(""),d(""),p([]),v(!1),a())};return t&&e?H.jsx("div",{className:"modal-overlay",onClick:A,children:H.jsxs("div",{className:"modal-content token-transfer-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h2",{children:["Transfer ",e.symbol]}),H.jsx("button",{className:"modal-close",onClick:A,disabled:h,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsx("div",{className:"token-preview",children:H.jsxs("div",{className:"token-info",children:[H.jsx("div",{className:"token-icon",children:"\ud83e\ude99"}),H.jsxs("div",{className:"token-details",children:[H.jsx("h3",{children:e.symbol}),H.jsx("p",{className:"token-contract",children:e.contract}),H.jsxs("p",{className:"token-balance",children:["Available: ",e.balance," ",e.symbol]}),"N/A"!==e.value&&"0.00"!==e.value&&H.jsxs("p",{className:"token-usd-value",children:["\u2248 $",e.value," USD"]})]})]})}),H.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!(e&&y&&r.trim()&&l.trim()))return void N("Validation Error","Please fill in all required fields");const i=m.filter(e=>!w(e));if(i.length>0)N("Invalid Account Names",`Invalid WAX account names: ${i.join(", ")}. Account names must be 12 characters, lowercase letters and numbers 1-5.`);else if(k(l)){u(!0);try{const t=C(e.balance),i=[];if(f&&m.length>1){const a=x().toFixed(t)+" "+e.symbol;for(const t of m)i.push({account:e.contract,name:"transfer",authorization:[{actor:y.actor,permission:y.permission}],data:{from:y.actor,to:t,quantity:a,memo:o.trim()||"Bulk transfer via PxMarket - market.pixeljourney.xyz"}})}else{const a=parseFloat(l).toFixed(t)+" "+e.symbol;i.push({account:e.contract,name:"transfer",authorization:[{actor:y.actor,permission:y.permission}],data:{from:y.actor,to:m[0]||r.trim(),quantity:a,memo:o.trim()||"Transferred via PxMarket - market.pixeljourney.xyz"}})}if(f){let t=0;for(const a of m)try{if(!g){se.error("transferTokens service not available","TokenTransferModal");continue}await g(a,x().toString(),e.symbol,o.trim()||"Bulk transfer via PxMarket - market.pixeljourney.xyz")&&t++}catch(h){se.error(`Transfer to ${a} failed`,"TokenTransferModal",h)}if(t>0){const a=t===m.length?`${l} ${e.symbol} transferred to all ${m.length} recipients successfully!`:`${l} ${e.symbol} transferred to ${t}/${m.length} recipients successfully!`;b("Bulk Transfer Complete",a)}}else{if(!g)return void N("Transfer Error","Transfer service not available");await g(m[0]||r.trim(),l,e.symbol,o.trim()||"Transferred via PxMarket - market.pixeljourney.xyz")&&b("Transfer Successful",`${l} ${e.symbol} transferred successfully!`)}n?.(),a(),s(""),c(""),d(""),p([]),v(!1)}catch(h){se.error("Token transfer failed","TokenTransferModal",h),N("Transfer Failed",h instanceof Error?h.message:"Unknown error occurred")}finally{u(!1)}}else N("Invalid Amount","Please enter a valid amount that does not exceed your balance")},className:"modal-form token-transfer-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"recipient",children:f?"Recipients (comma-separated) *":"Recipient WAX Account *"}),H.jsx("input",{type:"text",id:"recipient",value:r,onChange:e=>(e=>{s(e.toLowerCase());const t=e.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0);p(t),v(t.length>1)})(e.target.value),placeholder:f?"e.g. pixeljourney,market.pxj,council.pxj":"e.g. pixeljourney",required:!0,disabled:h,className:"recipient-input"}),H.jsx("small",{className:"input-help",children:f?`Enter WAX account names separated by commas (${m.length} recipients detected)`:"Enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)"}),f&&m.length>1&&H.jsxs("div",{className:"recipients-preview",children:[H.jsx("strong",{children:"Recipients:"}),H.jsx("ul",{children:m.map((e,t)=>H.jsxs("li",{className:w(e)?"valid":"invalid",children:[e," ",!w(e)&&"\u274c"]},t))})]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"amount",children:"Amount *"}),H.jsxs("div",{className:"amount-input-wrapper",children:[H.jsx("input",{type:"number",id:"amount",value:l,onChange:e=>c(e.target.value),placeholder:"0.00000000",step:"0.00000001",min:"0",max:e.balance.split(" ")[0],required:!0,disabled:h,className:"amount-input"}),H.jsx("button",{type:"button",className:"max-btn",onClick:()=>{if(e){const t=e.balance.split(" ")[0];c(t)}},disabled:h,children:"MAX"})]}),f&&m.length>1&&l&&H.jsxs("small",{className:"distribution-info",children:["Each recipient will receive: ",x().toFixed(C(e.balance))," ",e.symbol]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),H.jsx("input",{type:"text",id:"memo",value:o,onChange:e=>d(e.target.value),placeholder:"Optional transfer message",maxLength:256,disabled:h,className:"memo-input"})]}),H.jsxs("div",{className:"transfer-warning",children:[H.jsx("div",{className:"warning-icon",children:"\u26a0\ufe0f"}),H.jsxs("div",{className:"warning-text",children:[H.jsx("strong",{children:"Warning:"})," This action cannot be undone. Make sure you trust the recipient and have entered the correct account name and amount."]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",className:"btn-secondary",onClick:A,disabled:h,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn-primary transfer-btn",disabled:h||!r.trim()||!l.trim()||!w(r.trim())||!k(l),children:h?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"spinner"}),f?"Bulk Transferring...":"Transferring..."]}):f?`Bulk Transfer ${e.symbol}`:`Transfer ${e.symbol}`})]})]})]})]})}):null},on=()=>{const{isConnected:e,account:t}=Q(),[a,n]=i.useState(null),[r,s]=i.useState([]),[l,c]=i.useState([]),[o,d]=i.useState([]),[h,u]=i.useState(!1),[m,p]=i.useState("30d"),[f,v]=i.useState("overview"),y=i.useCallback(async e=>{if(t)try{const a=await $e.getUserTransactions(t,1e3),n="7d"===m?7:"30d"===m?30:"90d"===m?90:365,i=[],r=new Date;for(let t=n;t>=0;t--){const n=new Date(r);n.setDate(n.getDate()-t);const s=n.getTime(),l=a.filter(e=>new Date(e.block_time).getTime()<=s);let c=0,o=0;l.forEach(e=>{if("purchase"===e.type&&e.price){const t=parseFloat(e.price.replace(/[^0-9.-]/g,"")||"0");o+=t,c+=t}else if("sale"===e.type&&e.price){const t=parseFloat(e.price.replace(/[^0-9.-]/g,"")||"0");c-=t}}),0===t?(c=e.totalValue,o=e.totalInvested):0===c&&0===o&&(c=0,o=0),i.push({date:n.toISOString().split("T")[0],value:c,invested:o})}d(i)}catch(a){const t=[];for(let n="7d"===m?7:"30d"===m?30:"90d"===m?90:365;n>=0;n--){const a=new Date;a.setDate(a.getDate()-n),t.push({date:a.toISOString().split("T")[0],value:0===n?e.totalValue:.95*e.totalValue,invested:e.totalInvested})}d(t)}},[t,m]),g=i.useCallback(async()=>{if(t){u(!0);try{const e=await $e.getUserInventory(t),a=await $e.getUserTransactions(t);let i=0,r=0;const l={};for(const t of e){const e=parseFloat(t.price||"0");i+=e;const n=a.find(e=>e.asset_id===t.asset_id&&"purchase"===e.type),s=n?parseFloat(n.price||"0"):e;r+=s,l[t.collection]||(l[t.collection]={collection:t.collection,totalValue:0,totalInvested:0,profitLoss:0,profitLossPercentage:0,nftCount:0,averagePrice:0,floorPrice:0,performance:"neutral"}),l[t.collection].totalValue+=e,l[t.collection].totalInvested+=s,l[t.collection].nftCount+=1}const c=Object.values(l).map(e=>(e.profitLoss=e.totalValue-e.totalInvested,e.profitLossPercentage=e.totalInvested>0?e.profitLoss/e.totalInvested*100:0,e.averagePrice=e.nftCount>0?e.totalValue/e.nftCount:0,e.profitLossPercentage>20?e.performance="excellent":e.profitLossPercentage>5?e.performance="good":e.profitLossPercentage>-5?e.performance="neutral":e.performance="poor",e)),o=i-r,d=r>0?o/r*100:0,h=c.sort((e,t)=>t.profitLossPercentage-e.profitLossPercentage),u=h[0]?.collection||"N/A",m=h[h.length-1]?.collection||"N/A",p=45,f={totalValue:i,totalInvested:r,profitLoss:o,profitLossPercentage:d,totalNFTs:e.length,uniqueCollections:c.length,averageHoldingTime:p,bestPerformingCollection:u,worstPerformingCollection:m};n(f),s(c),b(f,c),await y(f)}catch(e){}finally{u(!1)}}},[t,y]),b=(e,t)=>{const a=[];e.profitLoss>0?a.push({type:"profit",title:"Portfolio in Profit",description:`Your portfolio has gained ${e.profitLossPercentage.toFixed(1)}% since initial investment`,value:`+${e.profitLoss.toFixed(2)} WAX`}):e.profitLoss<0&&a.push({type:"loss",title:"Portfolio Underperforming",description:`Your portfolio is down ${Math.abs(e.profitLossPercentage).toFixed(1)}% from initial investment`,value:`${e.profitLoss.toFixed(2)} WAX`});const n=t.find(t=>t.collection===e.bestPerformingCollection);n&&n.profitLossPercentage>10&&a.push({type:"profit",title:"Top Performer",description:`${n.collection} is your best performing collection`,value:`+${n.profitLossPercentage.toFixed(1)}%`,collection:n.collection}),t.length<3&&a.push({type:"opportunity",title:"Diversification Opportunity",description:"Consider diversifying across more collections to reduce risk",value:`${t.length} collections`});const i=t.reduce((e,t)=>t.totalValue>e.totalValue?t:e,t[0]);i&&i.totalValue/e.totalValue>.6&&a.push({type:"warning",title:"High Concentration Risk",description:`${i.collection} represents over 60% of your portfolio`,collection:i.collection}),c(a)};i.useEffect(()=>{e&&t&&g()},[e,t,g]);const N=e=>`${e.toFixed(2)} WAX`,w=e=>`${e>=0?"+":""}${e.toFixed(1)}%`;return e?h?H.jsx("div",{className:"portfolio-analytics",children:H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Analyzing your portfolio..."})]})}):H.jsxs("div",{className:"portfolio-analytics",children:[H.jsxs("div",{className:"analytics-header",children:[H.jsx("h2",{children:"Portfolio Analytics"}),H.jsxs("div",{className:"analytics-controls",children:[H.jsx("div",{className:"timeframe-selector",children:["7d","30d","90d","1y"].map(e=>H.jsx("button",{className:"timeframe-btn "+(m===e?"active":""),onClick:()=>p(e),children:e},e))}),H.jsx("div",{className:"view-selector",children:["overview","collections","insights"].map(e=>H.jsx("button",{className:"view-btn "+(f===e?"active":""),onClick:()=>v(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),"overview"===f&&a&&H.jsxs("div",{className:"overview-section",children:[H.jsxs("div",{className:"metrics-grid",children:[H.jsxs("div",{className:"metric-card primary",children:[H.jsxs("div",{className:"metric-header",children:[H.jsx("h3",{children:"Total Portfolio Value"}),H.jsx("span",{className:"metric-icon",children:"\ud83d\udcb0"})]}),H.jsx("div",{className:"metric-value",children:N(a.totalValue)}),H.jsxs("div",{className:"metric-change "+(a.profitLoss>=0?"positive":"negative"),children:[w(a.profitLossPercentage)," (",N(a.profitLoss),")"]})]}),H.jsxs("div",{className:"metric-card",children:[H.jsxs("div",{className:"metric-header",children:[H.jsx("h3",{children:"Total Invested"}),H.jsx("span",{className:"metric-icon",children:"\ud83d\udcc8"})]}),H.jsx("div",{className:"metric-value",children:N(a.totalInvested)})]}),H.jsxs("div",{className:"metric-card",children:[H.jsxs("div",{className:"metric-header",children:[H.jsx("h3",{children:"NFTs Owned"}),H.jsx("span",{className:"metric-icon",children:"\ud83c\udfa8"})]}),H.jsx("div",{className:"metric-value",children:a.totalNFTs}),H.jsxs("div",{className:"metric-subtitle",children:[a.uniqueCollections," collections"]})]}),H.jsxs("div",{className:"metric-card",children:[H.jsxs("div",{className:"metric-header",children:[H.jsx("h3",{children:"Avg. Holding Time"}),H.jsx("span",{className:"metric-icon",children:"\u23f1\ufe0f"})]}),H.jsxs("div",{className:"metric-value",children:[a.averageHoldingTime,"d"]})]})]}),H.jsxs("div",{className:"performance-chart",children:[H.jsx("h3",{children:"Portfolio Performance"}),H.jsxs("div",{className:"chart-container",children:[H.jsx("svg",{className:"performance-svg",viewBox:"0 0 800 200",children:o.map((e,t)=>{const a=t/(o.length-1)*780+10,n=190-e.value/Math.max(...o.map(e=>e.value))*180,i=190-e.invested/Math.max(...o.map(e=>e.value))*180;return H.jsxs("g",{children:[t>0&&H.jsxs(H.Fragment,{children:[H.jsx("line",{x1:(t-1)/(o.length-1)*780+10,y1:190-o[t-1].value/Math.max(...o.map(e=>e.value))*180,x2:a,y2:n,stroke:"#4CAF50",strokeWidth:"2"}),H.jsx("line",{x1:(t-1)/(o.length-1)*780+10,y1:190-o[t-1].invested/Math.max(...o.map(e=>e.value))*180,x2:a,y2:i,stroke:"#FF9800",strokeWidth:"2",strokeDasharray:"5,5"})]}),H.jsx("circle",{cx:a,cy:n,r:"3",fill:"#4CAF50"})]},t)})}),H.jsxs("div",{className:"chart-legend",children:[H.jsxs("div",{className:"legend-item",children:[H.jsx("div",{className:"legend-color",style:{backgroundColor:"var(--success-color)"}}),H.jsx("span",{children:"Current Value"})]}),H.jsxs("div",{className:"legend-item",children:[H.jsx("div",{className:"legend-color dashed",style:{backgroundColor:"var(--warning-color)"}}),H.jsx("span",{children:"Invested Amount"})]})]})]})]})]}),"collections"===f&&H.jsxs("div",{className:"collections-section",children:[H.jsx("h3",{children:"Collection Performance"}),H.jsx("div",{className:"collections-grid",children:r.map((e,t)=>H.jsxs("div",{className:`collection-card ${e.performance}`,children:[H.jsxs("div",{className:"collection-header",children:[H.jsx("h4",{children:e.collection}),H.jsx("span",{className:`performance-badge ${e.performance}`,children:e.performance})]}),H.jsxs("div",{className:"collection-metrics",children:[H.jsxs("div",{className:"collection-metric",children:[H.jsx("span",{className:"metric-label",children:"Value:"}),H.jsx("span",{className:"metric-value",children:N(e.totalValue)})]}),H.jsxs("div",{className:"collection-metric",children:[H.jsx("span",{className:"metric-label",children:"P&L:"}),H.jsx("span",{className:"metric-value "+(e.profitLoss>=0?"positive":"negative"),children:w(e.profitLossPercentage)})]}),H.jsxs("div",{className:"collection-metric",children:[H.jsx("span",{className:"metric-label",children:"NFTs:"}),H.jsx("span",{className:"metric-value",children:e.nftCount})]}),H.jsxs("div",{className:"collection-metric",children:[H.jsx("span",{className:"metric-label",children:"Avg Price:"}),H.jsx("span",{className:"metric-value",children:N(e.averagePrice)})]})]})]},t))})]}),"insights"===f&&H.jsxs("div",{className:"insights-section",children:[H.jsx("h3",{children:"Investment Insights"}),H.jsx("div",{className:"insights-grid",children:l.map((e,t)=>H.jsxs("div",{className:`insight-card ${e.type}`,children:[H.jsxs("div",{className:"insight-header",children:[H.jsxs("span",{className:`insight-icon ${e.type}`,children:["profit"===e.type&&"\ud83d\udcc8","loss"===e.type&&"\ud83d\udcc9","opportunity"===e.type&&"\ud83d\udca1","warning"===e.type&&"\u26a0\ufe0f"]}),H.jsx("h4",{children:e.title}),e.value&&H.jsx("span",{className:"insight-value",children:e.value})]}),H.jsx("p",{className:"insight-description",children:e.description}),e.collection&&H.jsxs("div",{className:"insight-collection",children:["Collection: ",e.collection]})]},t))})]})]}):H.jsx("div",{className:"portfolio-analytics",children:H.jsxs("div",{className:"wallet-connection-prompt",children:[H.jsx("h3",{children:"\ud83d\udd17 Connect Your Wallet"}),H.jsx("p",{children:"Connect your WAX wallet to view detailed portfolio analytics and investment insights."})]})})},dn={};function hn(e,t){return e?e*parseFloat(t.weight)/1e15:0}function un(e,t){if(t<=0)return 0;const a=parseFloat(e.max_price.split(" ")[0]),n=parseFloat(e.min_price.split(" ")[0]);let i=0,r=parseFloat(e.utilization),s=parseFloat(r)+parseFloat(t);return r<parseFloat(e.adjusted_utilization)&&(i+=(t=>{let i=n;const r=e.exponent-1;return r<=0?a:(i+=(a-n)*Math.pow(parseFloat(t)/e.weight,r),i)})(parseFloat(e.adjusted_utilization))*Math.min(parseFloat(t),parseFloat(e.adjusted_utilization)-parseFloat(r))/parseFloat(e.weight),r=parseFloat(e.adjusted_utilization)),r<s&&(i+=((t,i)=>{const r=(a-n)/parseFloat(e.exponent),s=t/parseFloat(e.weight),l=i/parseFloat(e.weight);return n*l-n*s+r*(Math.pow(l,parseFloat(e.exponent))-Math.pow(s,parseFloat(e.exponent)))})(r,s)),i<1e-8?i<1e-8?1e-8.toFixed(8):i.toPrecision(1).replace(/e-9/,"0.00000000"):i.toFixed(8)}const mn=(e,t)=>e&&void 0!==t?t/100*1e11:0,pn=(e,t)=>e&&void 0!==t?(100-t)/100*2e9:0;function fn(e,t,a,n){const i=hn(e,a),r=hn(t,n);return{cpuAmount:i,netAmount:r,cpuFee:un(a,i),netFee:un(n,r)}}const vn=(e,t,a,n,i)=>{if(i&&i.virtual_block_cpu_limit&&i.block_cpu_limit){let r=parseFloat(i.block_cpu_limit),s=parseFloat(i.virtual_block_cpu_limit)/r;const l=fn(e,t,a,n).cpuAmount*s;if(!l||l<=0)return"0 ms";const c=l/1e3;return c>=1e3?`${(c/1e3).toFixed(2)} seconds`:`${c.toFixed(2)} ms`}return"0 ms"},yn=()=>{const{account:e}=Ta(),[t,a]=i.useState([]),[n,r]=i.useState(!0),[s,l]=i.useState(new Set),[c,o]=i.useState(null),[d,h]=i.useState(!1),u=i.useCallback(async()=>{if(e)try{r(!0);const t=await Ee.checkUserBadges(e),n=await Ee.getUserBadgeStats(e);a(t.badges),o(n)}catch(t){se.error("Error loading badges","PxBadges.loadUserBadges",t,{account:e})}finally{r(!1)}},[e]);i.useEffect(()=>{e?u():(a([]),r(!1))},[e,u]);const m=i.useMemo(()=>{const e=Ee.getAllBadgeDefinitions(),a={holdings:{id:"holdings",name:"Token Holdings",icon:"\ud83d\udcb0",description:"Achievements for holding various tokens",badges:[]},ownership:{id:"ownership",name:"NFT Collections",icon:"\ud83c\udfad",description:"Achievements for owning NFTs and collectibles",badges:[]},trading:{id:"trading",name:"Trading Mastery",icon:"\ud83d\udcc8",description:"Achievements for trading activities",badges:[]},social:{id:"social",name:"Community",icon:"\ud83d\udc65",description:"Achievements for community participation",badges:[]},achievement:{id:"achievement",name:"Special Achievements",icon:"\ud83c\udfc6",description:"Rare and special accomplishments",badges:[]},special:{id:"special",name:"Legendary",icon:"\u2b50",description:"Ultra-rare legendary achievements",badges:[]}};return e.forEach(e=>{const n=a[e.type]||a.achievement,i=t.find(t=>t.id===e.id);n.badges.push(i||{...e,unlockedAt:void 0})}),Object.values(a).filter(e=>e.badges.length>0)},[t]),p=i.useMemo(()=>{const e=[],a=t.filter(e=>e.id.startsWith("pixal-collector")).sort((e,t)=>(e.tier||0)-(t.tier||0));if(a.length>0){const t=[1,2,3,4,5].map(e=>{const t=a.find(t=>t.tier===e);return{tier:e,earned:!!t?.unlockedAt,current:t?.progress&&!t.unlockedAt}});e.push({name:"Pixal Collector",badges:a,steps:t})}const n=t.filter(e=>e.id.startsWith("waxrock-collector")).sort((e,t)=>(e.tier||0)-(t.tier||0));if(n.length>0){const t=[1,2,3].map(e=>{const t=n.find(t=>t.tier===e);return{tier:e,earned:!!t?.unlockedAt,current:t?.progress&&!t.unlockedAt}});e.push({name:"WaxRock Collector",badges:n,steps:t})}return e},[t]);return e?H.jsxs("div",{className:"pxbadges-container",children:[H.jsxs("div",{className:"pxbadges-header",children:[H.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1rem"},children:[H.jsx("h1",{className:"pxbadges-title",children:"Achievements"}),H.jsx("button",{onClick:()=>h(!0),style:{background:"rgba(255, 215, 0, 0.2)",border:"2px solid #ffd700",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease",color:"#ffd700"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.3)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.2)",e.currentTarget.style.transform="scale(1)"},title:"Share Achievements",children:H.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})})})]}),H.jsx("p",{className:"pxbadges-subtitle",children:"Track your progress and unlock prestigious badges in the Pixel Journey ecosystem"}),c&&H.jsxs("div",{className:"achievement-stats",children:[H.jsxs("div",{className:"stat-card",children:[H.jsx("span",{className:"stat-number",children:c.totalBadges}),H.jsx("span",{className:"stat-label",children:"Total Earned"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("span",{className:"stat-number",children:c.badgesByRarity?.legendary||0}),H.jsx("span",{className:"stat-label",children:"Legendary"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("span",{className:"stat-number",children:c.badgesByRarity?.epic||0}),H.jsx("span",{className:"stat-label",children:"Epic"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("span",{className:"stat-number",children:c.badgesByRarity?.rare||0}),H.jsx("span",{className:"stat-label",children:"Rare"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("span",{className:"stat-number",children:c.progressBadges?.length||0}),H.jsx("span",{className:"stat-label",children:"In Progress"})]})]})]}),n?H.jsxs("div",{className:"achievements-loading",children:[H.jsx("div",{className:"loading-spinner"}),"Loading achievements..."]}):H.jsxs("div",{className:"achievement-categories",children:[p.length>0&&H.jsxs("div",{className:"category-section",children:[H.jsxs("div",{className:"category-header",children:[H.jsx("span",{className:"category-icon",children:"\ud83c\udfc6"}),H.jsx("h2",{className:"category-title",children:"Achievement Series"})]}),p.map(e=>H.jsxs("div",{className:"achievement-card earned",children:[H.jsxs("div",{className:"achievement-header",children:[H.jsx("span",{className:"achievement-icon",children:"\ud83c\udfaf"}),H.jsxs("div",{className:"achievement-info",children:[H.jsx("h3",{className:"achievement-name",children:e.name}),H.jsxs("p",{className:"achievement-description",children:["Multi-tier achievement series with ",e.steps.length," levels"]})]})]}),H.jsx("div",{className:"achievement-series",children:e.steps.map(e=>H.jsx("div",{className:"series-step "+(e.earned?"completed":e.current?"current":""),children:e.tier},e.tier))})]},e.name))]}),m.map(e=>{const t=e.badges.filter(e=>e.unlockedAt).length,a=e.badges.length,n=s.has(e.id);return H.jsxs("div",{className:"category-section",children:[H.jsxs("div",{className:"category-header",onClick:()=>(e=>{const t=new Set(s);t.has(e)?t.delete(e):t.add(e),l(t)})(e.id),children:[H.jsx("span",{className:"category-icon",children:e.icon}),H.jsx("h2",{className:"category-title",children:e.name}),H.jsxs("span",{className:"category-progress",children:[t,"/",a]}),H.jsx("span",{className:"category-toggle "+(n?"collapsed":""),children:"\u25bc"})]}),!n&&H.jsx("div",{className:"achievements-grid",children:e.badges.map(e=>{const t=!!e.unlockedAt,a=(e=>"legendary"===e.rarity?"legendary":"epic"===e.rarity?"epic":"rare"===e.rarity?"rare":"")(e);return H.jsxs("div",{className:`achievement-card ${t?"earned":""} ${a}`,children:[H.jsxs("div",{className:"achievement-header",children:[H.jsx("span",{className:"achievement-icon",children:e.icon}),H.jsxs("div",{className:"achievement-info",children:[H.jsx("h3",{className:"achievement-name",children:e.name}),H.jsx("p",{className:"achievement-description",children:e.description}),H.jsx("p",{className:"achievement-requirements",children:e.requirements})]})]}),e.tier&&H.jsxs("div",{className:"achievement-tier",children:["Tier ",e.tier]}),e.progress&&H.jsxs("div",{className:"achievement-progress",children:[H.jsx("div",{className:"progress-bar",children:H.jsx("div",{className:"progress-fill",style:{width:`${e.progress.percentage}%`}})}),H.jsxs("div",{className:"progress-text",children:[e.progress.current.toLocaleString()," / ",e.progress.required.toLocaleString(),"(",e.progress.percentage,"%)"]})]}),t&&e.unlockedAt&&H.jsx("div",{className:"achievement-date",children:(n=e.unlockedAt,n?new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"")})]},e.id);var n})})]},e.id)}),0===m.length&&H.jsxs("div",{className:"no-achievements",children:[H.jsx("div",{className:"no-achievements-icon",children:"\ud83c\udfaf"}),H.jsx("div",{className:"no-achievements-text",children:"No Achievements Yet"}),H.jsx("div",{className:"no-achievements-subtitle",children:"Start participating in the Pixel Journey ecosystem to earn your first badges!"})]})]}),H.jsx(Xt,{isOpen:d,onClose:()=>h(!1),title:`${e}'s Achievements`,description:`Check out my achievements in the Pixel Journey ecosystem! I've earned ${c?.totalBadges||0} badges including ${c?.badgesByRarity?.legendary||0} legendary achievements.`,shareUrl:`${window.location.origin}/pxbadges?user=${e}`,defaultShareText:`Check out my achievements in the Pixel Journey ecosystem! I've earned ${c?.totalBadges||0} badges. #PixelJourney #Achievements`,type:"achievement",badges:t,totalBadges:c?.totalBadges||0,legendaryCount:c?.badgesByRarity?.legendary||0,username:e||""})]}):H.jsx("div",{className:"pxbadges-container",children:H.jsxs("div",{className:"no-achievements",children:[H.jsx("div",{className:"no-achievements-icon",children:"\ud83d\udd12"}),H.jsx("div",{className:"no-achievements-text",children:"Connect Your Wallet"}),H.jsx("div",{className:"no-achievements-subtitle",children:"Connect your wallet to view your achievements and progress"})]})})},gn=new class{constructor(){t(this,"ALCOR_API_BASE","https://alcor.exchange/api/v2"),t(this,"WAX_CONTRACT","eosio.token"),t(this,"WPIXAL_CONTRACT","pixeljourney"),t(this,"WAX_SYMBOL","WAX"),t(this,"WPIXAL_SYMBOL","WPIXAL"),t(this,"WAX_TOKEN_ID","wax-eosio.token"),t(this,"WPIXAL_TOKEN_ID","wpixal-pixeljourney"),t(this,"tokensCache",null),t(this,"tokensCacheExpiry",0),t(this,"CACHE_DURATION",3e5)}async getAllTokens(){try{if(this.tokensCache&&Date.now()<this.tokensCacheExpiry)return this.tokensCache;const e=`${this.ALCOR_API_BASE}/tokens`,t=await fetch(e,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const a=await t.json();return this.tokensCache=a.map(e=>({id:e.id||`${e.symbol.toLowerCase()}-${e.contract}`,symbol:e.symbol,contract:e.contract,precision:e.precision||8,logo:e.logo,usd_price:e.usd_price,system_price:e.system_price})),this.tokensCacheExpiry=Date.now()+this.CACHE_DURATION,this.tokensCache||[]}catch(e){return se.error("Error fetching all tokens:","AlcorService.getAllTokens",e),[{id:this.WAX_TOKEN_ID,symbol:this.WAX_SYMBOL,contract:this.WAX_CONTRACT,precision:8},{id:this.WPIXAL_TOKEN_ID,symbol:this.WPIXAL_SYMBOL,contract:this.WPIXAL_CONTRACT,precision:8}]}}async getSwapQuoteForPair(e,t,a,n,i="EXACT_INPUT",r=.05){try{const s=`${this.ALCOR_API_BASE}/swapRouter/getRoute?trade_type=${i}&input=${e.token_id}&output=${t.token_id}&amount=${parseFloat(a).toFixed(e.precision)}&slippage=${r.toFixed(2)}&receiver=${n}&maxHops=3&v2=true`;se.info("Fetching swap route from:",s);const l=await fetch(s);if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const c=await l.json();if(se.info("Swap route response:",c),!c.swaps||0===c.swaps.length)throw new Error("No swap route found for this token pair");const o=c.swaps[0];return{input_amount:c.maxSent||o.maxSent||c.input||o.input,output_amount:c.output||o.output||c.minReceived||o.minReceived,price_impact:c.priceImpact?.toString()||"0",minimum_received:c.minReceived||o.minReceived,route:c.route?.map((a,n)=>({pool_id:a,token_in:0===n?`${e.symbol}@${e.contract}`:"intermediate",token_out:n===c.route.length-1?`${t.symbol}@${t.contract}`:"intermediate",amount_in:0===n?c.input||o.input:"0",amount_out:n===c.route.length-1?c.output||o.output:"0"}))||[],memo:c.memo||o.memo,input_token:e,output_token:t}}catch(s){throw se.error("Error getting swap quote for pair:","AlcorService.getSwapQuoteForPair",s),new Error(`Failed to get swap quote for ${e.symbol}/${t.symbol}: ${s instanceof Error?s.message:"Unknown error"}`)}}async getExactOutputQuote(e,t,a=.05){try{const n=`${this.ALCOR_API_BASE}/swapRouter/getRoute?trade_type=EXACT_OUTPUT&input=${this.WAX_TOKEN_ID}&output=${this.WPIXAL_TOKEN_ID}&amount=${parseFloat(e).toFixed(8)}&slippage=${a.toFixed(2)}&receiver=${t}&maxHops=3&v2=true`;se.error("Fetching swap route from:",n);const i=await fetch(n);if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const r=await i.json();if(se.error("Swap route response:",r),!r.swaps||0===r.swaps.length)throw new Error("No swap route found");const s=r.swaps[0];return{input_amount:r.maxSent||s.maxSent,output_amount:r.output||s.output,price_impact:r.priceImpact?.toString()||"0",minimum_received:r.minReceived||s.minReceived,route:r.route?.map((e,t)=>({pool_id:e,token_in:0===t?`${this.WAX_SYMBOL}@${this.WAX_CONTRACT}`:"intermediate",token_out:t===r.route.length-1?`${this.WPIXAL_SYMBOL}@${this.WPIXAL_CONTRACT}`:"intermediate",amount_in:0===t?r.input||s.input:"0",amount_out:t===r.route.length-1?r.output||s.output:"0"}))||[],memo:r.memo||s.memo,input_token:{symbol:this.WAX_SYMBOL,contract:this.WAX_CONTRACT,precision:8,token_id:this.WAX_TOKEN_ID},output_token:{symbol:this.WPIXAL_SYMBOL,contract:this.WPIXAL_CONTRACT,precision:8,token_id:this.WPIXAL_TOKEN_ID}}}catch(n){throw se.error("Error getting exact output quote:","alcorService.getExactOutputQuote",n),new Error(`Failed to get swap quote: ${n instanceof Error?n.message:"Unknown error"}`)}}async getSwapQuote(e){const t=await this.getExchangeRate(),a=(parseFloat(e)/t).toFixed(8);return this.getExactOutputQuote(a,"dummy.account",.5)}async executeSwap(e,t,a=.5){try{const n=await this.getExactOutputQuote(e,t,a),i={expiration:new Date(Date.now()+18e5).toISOString(),ref_block_num:0,ref_block_prefix:0,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.WAX_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"swap.alcor",quantity:`${parseFloat(n.input_amount).toFixed(8)} ${this.WAX_SYMBOL}`,memo:n.memo}}],transaction_extensions:[]};return se.info("Swap transaction prepared","AlcorService.executeSwap",{wpixalAmount:e,maxWaxInput:n.input_amount,memo:n.memo,route:n.route}),i}catch(n){throw se.error("Error executing swap:","AlcorService.executeSwap",n instanceof Error?n:new Error(String(n))),n}}async executeSwapForPair(e,t,a,n,i="EXACT_INPUT",r=.05){try{const s=await this.getSwapQuoteForPair(e,t,a,n,i,r),l={expiration:new Date(Date.now()+18e5).toISOString(),ref_block_num:0,ref_block_prefix:0,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:e.contract,name:"transfer",authorization:[{actor:n,permission:"active"}],data:{from:n,to:"swap.alcor",quantity:`${parseFloat(s.input_amount).toFixed(e.precision)} ${e.symbol}`,memo:s.memo}}],transaction_extensions:[]};return se.info("Generic swap transaction prepared","AlcorService.executeSwapForPair",{inputToken:e.symbol,outputToken:t.symbol,amount:a,tradeType:i,inputAmount:s.input_amount,outputAmount:s.output_amount,memo:s.memo,route:s.route}),l}catch(s){throw se.error("Error executing swap for pair:","AlcorService.executeSwapForPair",s instanceof Error?s:new Error(String(s))),s}}async getExchangeRate(){try{const e=await this.getExactOutputQuote("1.00000000","dummy.account",0);return parseFloat(e.input_amount)}catch(e){return se.error("Error getting exchange rate:","AlcorService.getExchangeRate",e instanceof Error?e:new Error(String(e))),292e-6}}async checkLiquidity(e){try{const t=await this.getExactOutputQuote(e,"dummy.account",.5);return parseFloat(t.price_impact)<5}catch(t){return se.error("Error checking liquidity:","AlcorService.checkLiquidity",t instanceof Error?t:new Error(String(t))),!1}}async estimateWaxNeeded(e){try{return(await this.getExactOutputQuote(e,"dummy.account",0)).input_amount}catch(t){throw se.error("Error estimating WAX needed:","AlcorService.estimateWaxNeeded",t instanceof Error?t:new Error(String(t))),t}}},bn=({selectedToken:e,onTokenSelect:t,availableTokens:a=["WAX","WPIXAL"],className:n="",filterByAvailable:r=!1})=>{const{account:s}=Ta(),[l,c]=i.useState(!1),[o,d]=i.useState([]),[h,u]=i.useState([]),[m,p]=i.useState(!1),f=i.useRef(null),v=async()=>{try{const e=await gn.getAllTokens();return u(e),e}catch(e){se.error("Failed to load Alcor tokens","TokenDropdown.loadAlcorTokens",e);const t=[{symbol:"WAX",contract:"eosio.token",precision:8,logo:null},{symbol:"WPIXAL",contract:"pixeljourney",precision:8,logo:null},{symbol:"PIXAL",contract:"pixeljourney",precision:8,logo:null},{symbol:"LSWAX",contract:"token.defi",precision:8,logo:null},{symbol:"BRWL",contract:"brawlertoken",precision:4,logo:null},{symbol:"TLM",contract:"alien.worlds",precision:4,logo:null},{symbol:"WOMBAT",contract:"wombattoken",precision:4,logo:null}];return u(t),t}},y={PXJ:{contract:"pixeljourney",decimals:8,icon:"\ud83c\udfaf",priority:1},WPIXAL:{contract:"pixeljourney",decimals:8,icon:"\ud83c\udfae",priority:2},WAX:{contract:"eosio.token",decimals:8,icon:"\ud83e\ude99",priority:3},KING:{contract:"alpha.waxfun",decimals:8,icon:"\ud83d\udc51",priority:4},WAXUSDC:{contract:"eth.token",decimals:8,icon:"\ud83d\udcb5",priority:5},WAXWBTC:{contract:"eth.token",decimals:8,icon:"\u20bf",priority:6},WUF:{contract:"wuffi",decimals:4,icon:"\ud83d\udc15",priority:7},LSWAX:{contract:"token.defi",decimals:8,icon:"\ud83d\udc8e",priority:8},BRWL:{contract:"brawlertoken",decimals:4,icon:"\u2694\ufe0f",priority:9},TLM:{contract:"alien.worlds",decimals:4,icon:"\ud83d\udc7d",priority:10},WOMBAT:{contract:"wombattoken",decimals:4,icon:"\ud83d\udc28",priority:11}},g=e=>{const t=y[e];if(t)return{contract:t.contract,decimals:t.decimals,icon:t.icon,logo:null,priority:t.priority};const a=h.find(t=>t.symbol===e);return a?{contract:a.contract,decimals:a.precision,icon:b(e),logo:a.logo,priority:999}:{contract:"eosio.token",decimals:8,icon:"\ud83e\ude99",logo:null,priority:1e3}},b=e=>({WAX:"\ud83e\ude99",WPIXAL:"\ud83c\udfae",PIXAL:"\ud83c\udfaf",LSWAX:"\ud83d\udc8e",BRWL:"\u2694\ufe0f",TLM:"\ud83d\udc7d",WOMBAT:"\ud83d\udc28"}[e]||"\ud83e\ude99");i.useEffect(()=>{v()},[]),i.useEffect(()=>{(async()=>{if(0===h.length&&await v(),!s){const e=(r?a:h.map(e=>e.symbol)).map(e=>{const t=g(e);return{symbol:e,contract:t.contract,amount:"0.0000",decimals:t.decimals,icon:t.icon,logo:t.logo}});return void d(e)}p(!0);try{const e=await $e.getLightApiBalances(s);if(e&&e.balances){const t=[],n=r?a:h.map(e=>e.symbol);for(const a of n){const n=g(a);if(!n)continue;const i=e.balances.find(e=>e.currency===a&&e.contract===n.contract);t.push({symbol:a,contract:n.contract,amount:i?i.amount:"0.0000",decimals:i?parseInt(i.decimals):n.decimals,icon:n.icon,logo:n.logo,priority:n.priority||999})}if(t.sort((e,t)=>(e.priority||999)-(t.priority||999)),!r){for(const a of e.balances)if(!n.includes(a.currency)){const e=g(a.currency);e&&t.push({symbol:a.currency,contract:a.contract,amount:a.amount,decimals:parseInt(a.decimals),icon:e.icon,logo:e.logo,priority:e.priority||999})}t.sort((e,t)=>(e.priority||999)-(t.priority||999))}d(t)}else{const e=(r?a:h.map(e=>e.symbol)).map(e=>{const t=g(e);return{symbol:e,contract:t.contract,amount:"0.0000",decimals:t.decimals,icon:t.icon,logo:t.logo,priority:t.priority||999}});e.sort((e,t)=>(e.priority||999)-(t.priority||999)),d(e)}}catch(e){se.error("Failed to load token balances","TokenDropdown.loadTokenBalances",e);const t=(r?a:h.map(e=>e.symbol)).map(e=>{const t=g(e);return{symbol:e,contract:t.contract,amount:"0.0000",decimals:t.decimals,icon:t.icon,logo:t.logo,priority:t.priority||999}});t.sort((e,t)=>(e.priority||999)-(t.priority||999)),d(t)}finally{p(!1)}})()},[s,a,h,r]),i.useEffect(()=>{const e=e=>{f.current&&!f.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const N=o.find(t=>t.symbol===e),w=g(e);return H.jsxs("div",{className:`token-dropdown ${n}`,ref:f,children:[H.jsxs("button",{className:"token-button",onClick:()=>c(!l),type:"button",children:[H.jsx("span",{className:"token-icon",children:N?.logo?H.jsx("img",{src:N.logo,alt:e,className:"token-logo"}):N?.icon||w?.icon||"\ud83e\ude99"}),H.jsx("span",{className:"token-symbol",children:e}),H.jsx("span",{className:"dropdown-arrow "+(l?"open":""),children:"\u25bc"})]}),l&&H.jsx("div",{className:"token-dropdown-menu",children:m?H.jsx("div",{className:"token-dropdown-loading",children:H.jsx("span",{children:"Loading tokens..."})}):H.jsxs(H.Fragment,{children:[o.map(a=>H.jsxs("button",{className:"token-option "+(a.symbol===e?"selected":""),onClick:()=>(e=>{t(e.symbol),c(!1)})(a),type:"button",children:[H.jsxs("div",{className:"token-option-left",children:[H.jsx("span",{className:"token-option-icon",children:a.logo?H.jsx("img",{src:a.logo,alt:a.symbol,className:"token-logo"}):a.icon}),H.jsxs("div",{className:"token-option-info",children:[H.jsx("span",{className:"token-option-symbol",children:a.symbol}),H.jsx("span",{className:"token-option-contract",children:a.contract})]})]}),H.jsx("div",{className:"token-option-balance",children:parseFloat(a.amount).toFixed(4)})]},`${a.contract}-${a.symbol}`)),0===o.length&&H.jsx("div",{className:"token-dropdown-empty",children:H.jsx("span",{children:"No tokens available"})})]})})]})},Nn=({isModal:e=!1,onClose:t,initialSellAmount:a=0,initialBuyAmount:n=1})=>{const{showSuccess:r,showError:s}=We(),{account:l,session:c}=Ta(),[o,d]=i.useState(a.toString()),[h,u]=i.useState(n.toString()),[m,p]=i.useState("WAX"),[f,v]=i.useState("WPIXAL"),[y,g]=i.useState(!1),[b,N]=i.useState(null),[w,k]=i.useState(.5),[x,C]=i.useState(!1),[A,_]=i.useState({}),[S,P]=i.useState(!1),[T,$]=i.useState([]),F=i.useCallback(async()=>{try{const e=await gn.getAllTokens();return $(e),e}catch(e){return se.error("Failed to load Alcor tokens","SwapInterface.loadAlcorTokens",e),[]}},[]),E={PXJ:{contract:"pixeljourney",precision:8,priority:1},WPIXAL:{contract:"pixeljourney",precision:8,priority:2},WAX:{contract:"eosio.token",precision:8,priority:3},KING:{contract:"alpha.waxfun",precision:8,priority:4},WAXUSDC:{contract:"eth.token",precision:8,priority:5},WAXWBTC:{contract:"eth.token",precision:8,priority:6},WUF:{contract:"wuffi",precision:4,priority:7},LSWAX:{contract:"token.defi",precision:8,priority:8},BRWL:{contract:"brawlertoken",precision:4,priority:9},TLM:{contract:"alien.worlds",precision:4,priority:10},WOMBAT:{contract:"wombattoken",precision:4,priority:11},TACO:{contract:"t.taco",precision:8,priority:12},SHING:{contract:"t.taco",precision:8,priority:13},YEET:{contract:"token.yeet",precision:4,priority:14},DMT:{contract:"defiminingtk",precision:4,priority:15},FGL:{contract:"fgltokenmgmt",precision:4,priority:16},SOREN:{contract:"farfromhomes",precision:4,priority:17}},I=i.useCallback(e=>{const t=E[e];if(t)return{symbol:e,contract:t.contract,precision:t.precision,token_id:`${t.contract}-${e}`,priority:t.priority};const a=T.find(t=>t.symbol===e);return a?{symbol:a.symbol,contract:a.contract,precision:a.precision,token_id:a.id,priority:999}:null},[T]),M=i.useCallback(async()=>{if(l){P(!0);try{0===T.length&&await F();const e=await $e.getLightApiBalances(l),t={};if(e&&e.balances){for(const a of e.balances){const e=I(a.currency);e&&e.contract===a.contract&&(t[a.currency]=`${a.amount} ${a.currency}`)}Object.keys(E).forEach(e=>{t[e]||(t[e]=`0.0000 ${e}`)})}else Object.keys(E).forEach(e=>{t[e]=`0.0000 ${e}`});_(t)}catch(e){se.error("Error loading balances","SwapInterface.loadBalances",e),s("Failed to load token balances");const t={};Object.keys(E).forEach(e=>{t[e]=`0.0000 ${e}`}),_(t)}finally{P(!1)}}else _({})},[l,s,T,F]);i.useEffect(()=>{F()},[]),i.useEffect(()=>{M();const e=setInterval(M,3e4);return()=>clearInterval(e)},[M]);const L=i.useCallback(async()=>{if(!o||parseFloat(o)<=0)return N(null),void u("0");try{g(!0);const e=I(m),t=I(f);if(!e||!t)throw new Error(`Token configuration not found for ${e?f:m}`);const a=await gn.getSwapQuoteForPair(e,t,o,(w/100).toString());if(!a||!a.output_amount)throw new Error("No valid quote received");N(a),u(parseFloat(a.output_amount).toFixed(e.precision||4))}catch(e){se.error("Error getting swap quote","SwapInterface.getQuote",e),N(null),u("0")}finally{g(!1)}},[o,m,f,l,w,I]);i.useEffect(()=>{m&&f&&m!==f&&L()},[m,f,L]);const W=e=>{const t=A[m]||`0.0000 ${m}`,a=(parseFloat(t.split(" ")[0])*e/100).toFixed(4);d(a)},R=H.jsxs("div",{className:"swap-interface "+(e?"modal-content":""),children:[e&&H.jsxs("div",{className:"swap-header",children:[H.jsx("h2",{children:"Swap Tokens"}),H.jsx("button",{className:"close-button",onClick:t,children:"\xd7"})]}),H.jsxs("div",{className:"swap-container",children:[H.jsxs("div",{className:"swap-section sell-section",children:[H.jsxs("div",{className:"swap-section-header",children:[H.jsx("span",{className:"section-label",children:"Sell"}),H.jsxs("span",{className:"balance",children:["Balance: ",S?"Loading...":A[m]||`0.0000 ${m}`]})]}),H.jsxs("div",{className:"input-container",children:[H.jsx("input",{type:"number",value:o,onChange:e=>d(e.target.value),placeholder:"0",className:"amount-input"}),H.jsx("div",{className:"token-selector",children:H.jsx(bn,{selectedToken:m,onTokenSelect:p,filterByAvailable:!1,className:"sell-token-dropdown"})})]}),H.jsxs("div",{className:"percentage-buttons",children:[H.jsx("button",{onClick:()=>W(15),children:"15%"}),H.jsx("button",{onClick:()=>W(25),children:"25%"}),H.jsx("button",{onClick:()=>W(50),children:"50%"}),H.jsx("button",{onClick:()=>W(75),children:"75%"}),H.jsx("button",{onClick:()=>{const e=(A[m]||`0.0000 ${m}`).split(" ")[0];d(e)},className:"max-button",children:"MAX"})]})]}),H.jsxs("div",{className:"swap-arrow-container",children:[H.jsx("button",{className:"swap-arrow",onClick:()=>{const e=m,t=o;p(f),v(e),d(h),u(t)},children:"\u2193"}),H.jsx("button",{className:"refresh-quote-button",onClick:L,disabled:y||!o||parseFloat(o)<=0,title:"Refresh price quote",children:y?"\u27f3":"\ud83d\udd04"})]}),H.jsxs("div",{className:"swap-section buy-section",children:[H.jsxs("div",{className:"swap-section-header",children:[H.jsx("span",{className:"section-label",children:"Buy"}),H.jsxs("span",{className:"balance",children:["Balance: ",S?"Loading...":A[f]||`0.0000 ${f}`]})]}),H.jsxs("div",{className:"input-container",children:[H.jsx("input",{type:"number",value:h,readOnly:!0,placeholder:"0",className:"amount-input",title:"Output amount is calculated automatically"}),H.jsx("div",{className:"token-selector",children:H.jsx(bn,{selectedToken:f,onTokenSelect:v,filterByAvailable:!1,className:"buy-token-dropdown"})})]}),H.jsxs("div",{className:"percentage-buttons",children:[H.jsx("button",{onClick:()=>W(15),children:"15%"}),H.jsx("button",{onClick:()=>W(25),children:"25%"}),H.jsx("button",{onClick:()=>W(50),children:"50%"}),H.jsx("button",{onClick:()=>W(75),children:"75%"})]})]}),b&&H.jsxs("div",{className:"quote-info",children:[H.jsxs("div",{className:"quote-row",children:[H.jsx("span",{className:"quote-label",children:"Rate"}),H.jsxs("span",{className:"quote-value",children:[b.rate||"0.00340412"," WPIXAL per WAX (0.02%)"]})]}),H.jsxs("div",{className:"quote-row",children:[H.jsx("span",{className:"quote-label",children:"Expected Output"}),H.jsx("span",{className:"quote-value",children:b.expectedOutput||h})]}),H.jsxs("div",{className:"quote-row",children:[H.jsx("span",{className:"quote-label",children:"Price Impact"}),H.jsx("span",{className:"quote-value",children:b.priceImpact||"< 0.01%"})]}),H.jsxs("div",{className:"quote-row",children:[H.jsx("span",{className:"quote-label",children:"Maximum Send after slippage"}),H.jsxs("span",{className:"quote-value",children:[b.maxSent||"309.45013892"," WAX (0.50%)"]})]})]}),H.jsxs("div",{className:"slippage-container",children:[H.jsx("button",{className:"slippage-toggle",onClick:()=>C(!x),children:"\u2699\ufe0f Multiroute"}),x&&H.jsxs("div",{className:"slippage-settings",children:[H.jsx("label",{children:"Slippage Tolerance"}),H.jsxs("div",{className:"slippage-options",children:[H.jsx("button",{className:.1===w?"active":"",onClick:()=>k(.1),children:"0.1%"}),H.jsx("button",{className:.5===w?"active":"",onClick:()=>k(.5),children:"0.5%"}),H.jsx("button",{className:1===w?"active":"",onClick:()=>k(1),children:"1.0%"}),H.jsx("input",{type:"number",value:w,onChange:e=>k(parseFloat(e.target.value)||.5),step:"0.1",min:"0.1",max:"50",className:"custom-slippage"})]})]})]}),H.jsx("button",{className:"swap-button",onClick:async()=>{if(l&&c)if(b)try{g(!0);const a=I(m),n=I(f);if(!a||!n)throw new Error(`Token configuration not found for ${a?f:m}`);const i=await gn.executeSwapForPair(a,n,o,l,"EXACT_INPUT",w/100),s=await c.transact({actions:i.actions});r(`Successfully swapped ${o} ${m} for ${h} ${f}`),se.info("Swap transaction completed","SwapInterface.executeSwap",{sellAmount:o,sellToken:m,buyAmount:h,buyToken:f,transactionId:s?.transaction?.id||s?.transactionId||s?.id||"unknown"}),await M(),d("0"),u("0"),N(null),e&&t&&t()}catch(a){se.error("Error executing swap","SwapInterface.executeSwap",a),s("Failed to execute swap transaction")}finally{g(!1)}else s("No quote available");else s("Please connect your wallet first")},disabled:y||!l||!b||parseFloat(o)<=0,children:y?"Processing ...":`Swap ${m} To ${f}`})]})]});return e?H.jsx("div",{className:"swap-modal-overlay",onClick:t,children:H.jsx("div",{onClick:e=>e.stopPropagation(),children:R})}):R},wn=()=>{const{account:e,isConnected:t,session:a,login:n}=Q(),{showError:r,showSuccess:s}=We(),c=l(),[o,d]=i.useState("overview"),[h,u]=i.useState([]),[m,p]=i.useState({}),[v,y]=i.useState(null),[g,b]=i.useState(null),[N,w]=i.useState(null),[k,x]=i.useState([]),[C,A]=i.useState("0.0000 WAX"),[_,S]=i.useState(new Set),[P,T]=i.useState(!1),[$,F]=i.useState(!1),[E,I]=i.useState(null),[M,L]=i.useState([]),[W,R]=i.useState(null),[O,B]=i.useState("all"),[j,D]=i.useState("all"),[U,X]=i.useState({start:"",end:""}),[z,J]=i.useState(""),[q,V]=i.useState(1),[G]=i.useState(10),[Y,K]=i.useState("date"),[Z,ee]=i.useState("desc"),[te,ie]=i.useState(!1),[re,le]=i.useState(!1),[ce,oe]=i.useState(null),[de,he]=i.useState(null),[ue,me]=i.useState({isOpen:!1,resourceType:"cpu",action:"stake"}),[pe,fe]=i.useState({isOpen:!1,action:"buy"}),[ye,ge]=i.useState({isOpen:!1,token:null}),[be,Ne]=i.useState(e||""),[we,ke]=i.useState(100),[xe,Ce]=i.useState(0),[Ae,_e]=i.useState(!1),[,Se]=(()=>{const{account:e,session:t}=Q(),[a,n]=i.useState(null),[r,s]=i.useState(!1);return[a,i.useCallback(async(a=null)=>{if(!t&&!a)return void se.warn("No wallet session or account name provided");const i=a||e;if(i){s(!0);try{const{apiService:e}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),t=await e.getWaxAccountInfo(i);if(!t)throw new Error("Failed to fetch account resources: No data returned");const a={account_name:i,cpu_limit:{used:t.cpu_limit?.used||0,available:t.cpu_limit?.available||0,max:t.cpu_limit?.max||0},net_limit:{used:t.net_limit?.used||0,available:t.net_limit?.available||0,max:t.net_limit?.max||0},ram_usage:t.ram_usage||0,ram_quota:t.ram_quota||0,total_resources:t.total_resources||{},self_delegated_bandwidth:t.self_delegated_bandwidth||{},refund_request:t.refund_request||null,voter_info:t.voter_info||null};n(a),se.info("Account resources fetched:",a)}catch(E){se.error("Error fetching account resources:",E),n(null)}finally{s(!1)}}else se.warn("No target account found")},[t,e]),r]})(),[Pe,Te]=(()=>{const[e,t]=i.useState(null),[a,n]=i.useState(!1);return[e,i.useCallback(async()=>{n(!0);try{const{apiService:e}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),a=await e.getPowerupState();if(a.rows&&a.rows.length>0){const e=a.rows[0],n={version:e.version||0,net:{version:e.net?.version||0,weight:e.net?.weight||"0",weight_ratio:e.net?.weight_ratio||"0",assumed_stake_weight:e.net?.assumed_stake_weight||"0",initial_weight_ratio:e.net?.initial_weight_ratio||"0",target_weight_ratio:e.net?.target_weight_ratio||"0",initial_timestamp:e.net?.initial_timestamp||"",target_timestamp:e.net?.target_timestamp||"",exponent:e.net?.exponent||2,decay_secs:e.net?.decay_secs||86400,min_price:e.net?.min_price||"0",max_price:e.net?.max_price||"0",utilization:e.net?.utilization||"0",adjusted_utilization:e.net?.adjusted_utilization||"0",utilization_timestamp:e.net?.utilization_timestamp||""},cpu:{version:e.cpu?.version||0,weight:e.cpu?.weight||"0",weight_ratio:e.cpu?.weight_ratio||"0",assumed_stake_weight:e.cpu?.assumed_stake_weight||"0",initial_weight_ratio:e.cpu?.initial_weight_ratio||"0",target_weight_ratio:e.cpu?.target_weight_ratio||"0",initial_timestamp:e.cpu?.initial_timestamp||"",target_timestamp:e.cpu?.target_timestamp||"",exponent:e.cpu?.exponent||2,decay_secs:e.cpu?.decay_secs||86400,min_price:e.cpu?.min_price||"0",max_price:e.cpu?.max_price||"0",utilization:e.cpu?.utilization||"0",adjusted_utilization:e.cpu?.adjusted_utilization||"0",utilization_timestamp:e.cpu?.utilization_timestamp||""},powerup_days:e.powerup_days||1,min_powerup_fee:e.min_powerup_fee||"0.0001 WAX"};t(n)}else t(null)}catch(E){t(null)}finally{n(!1)}},[]),a]})(),[Me,Le]=(()=>{const[e,t]=i.useState(null),[a,n]=i.useState(!1);return[e,i.useCallback(async()=>{n(!0);try{const{apiService:e}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),a=await e.getChainInfo(),n={server_version:a.server_version||"",chain_id:a.chain_id||"",head_block_num:a.head_block_num||0,last_irreversible_block_num:a.last_irreversible_block_num||0,last_irreversible_block_id:a.last_irreversible_block_id||"",head_block_id:a.head_block_id||"",head_block_time:a.head_block_time||"",head_block_producer:a.head_block_producer||"",virtual_block_cpu_limit:a.virtual_block_cpu_limit||0,virtual_block_net_limit:a.virtual_block_net_limit||0,block_cpu_limit:a.block_cpu_limit||0,block_net_limit:a.block_net_limit||0,server_version_string:a.server_version_string||"",fork_db_head_block_num:a.fork_db_head_block_num||0,fork_db_head_block_id:a.fork_db_head_block_id||""};t(n)}catch(E){t(null)}finally{n(!1)}},[]),a]})(),Re=i.useCallback(async()=>{if(se.debug("loadTransactions called with account","UserProfile",{account:e}),le(!0),oe(null),!e){se.debug("No account connected, using test account","UserProfile");const e="pixeljourney";try{se.debug("Fetching transactions for test account","UserProfile",{testAccount:e});const t=await $e.getUserTransactions(e,20);if(se.debug("Test transactions fetched","UserProfile",{count:t?.length||0,sample:t?.slice(0,2)}),t&&0!==t.length){const e=t.map(e=>({...e,type:e.type,status:e.status||"completed"}));u(e)}else se.warn("No test transactions returned","UserProfile"),u([])}catch(t){se.error("Error loading test transactions","UserProfile",t,{name:t instanceof Error?t.name:"Unknown",message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0});const e=t instanceof Error?t.message:"Unable to load transaction history. Please try again later.";oe(e),r("Transaction Error",e)}finally{le(!1)}return}try{se.debug("Loading transactions for connected account","UserProfile",{account:e,apiServiceAvailable:!!$e,getUserTransactionsType:typeof $e.getUserTransactions});const t=await $e.getUserTransactions(e,20);if(se.debug("Fetched transactions","UserProfile",{count:t?.length||0,sample:t?.slice(0,2)}),t&&0!==t.length){const e=t.map(e=>({...e,type:e.type,status:e.status||"completed"}));u(e)}else se.warn("No transactions returned from API","UserProfile"),u([])}catch(t){se.error("Error loading transactions","UserProfile",t,{name:t instanceof Error?t.name:"Unknown",message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0});const e=t instanceof Error?t.message:"Unable to load transaction history. Please try again later.";oe(e),r("Transaction Error",e)}finally{le(!1)}},[e,r]),Oe=i.useCallback(async()=>{if(e)try{const t=await $e.getUserStats(e);y(t),t.favoriteCollections.length>0&&Ze(t.favoriteCollections)}catch(t){throw se.error("Error loading user stats","UserProfile",t),t}},[e]),Be=i.useCallback(async()=>{if(e)try{const t=await $e.getWaxAccountInfo(e);t&&(b(t),t.cpu_limit&&t.net_limit&&t.ram_quota&&w({cpu:{used:t.cpu_limit.used,available:t.cpu_limit.available,max:t.cpu_limit.max},net:{used:t.net_limit.used,available:t.net_limit.available,max:t.net_limit.max},ram:{used:t.ram_usage,available:t.ram_quota-t.ram_usage,max:t.ram_quota}}))}catch(t){se.error("Failed to fetch account data","UserProfile",t),r("Account Data Error","Unable to fetch account information. Some features may not work properly.")}},[e,r]),je=i.useCallback(async()=>{if(e)try{const t=await $e.getUserTransactions(e,1);t&&t.length>0&&R(t[0].block_time)}catch(t){se.error("Failed to fetch last transaction date","UserProfile",t),R(null)}},[e]),De=i.useMemo(()=>["swap.taco","alpha.waxfun","beta.waxfun"],[]),Ue=i.useMemo(()=>[{symbol:"WAX",contract:"eosio.token"},{symbol:"PXJ",contract:"pixeljourney"},{symbol:"WPIXAL",contract:"pixeljourney"},{symbol:"WUF",contract:"wuffi"},{symbol:"TLM",contract:"alien.worlds"}],[]),Xe=i.useCallback(async()=>{if(e)try{const a=[],n=Ue.filter(e=>!De.includes(e.contract));for(let i=0;i<n.length;i++){const r=n[i];try{i>0&&await Ve(500);const n=await $e.getWaxCurrencyBalance(e,r.contract,r.symbol);if(n&&n.length>0){let i="N/A";const s=parseFloat(n[0].balance.split(" ")[0]);try{if("WAX"===r.symbol&&"eosio.token"===r.contract){const e=await ve.getWaxPriceUSD();i=ne(s*e,2)}else if("WPIXAL"===r.symbol&&"pixeljourney"===r.contract){const e=await ve.getWpixalPriceUSD();i=ne(s*e,4)}else if("PXJ"===r.symbol&&"pixeljourney"===r.contract){const e=await ve.getPxjPriceUSD();i=ne(s*e,6)}else i="WUF"===r.symbol&&"wuffi"===r.contract?"0.00":"N/A"}catch(t){se.warn(`Failed to fetch price for ${r.symbol} in fallback`,"UserProfile",{error:t}),i="0.00"}const l={...n[0],value:i};if("WAX"===r.symbol&&"eosio.token"===r.contract)try{const t=await Ie.getWaxBalance(e);A(t)}catch(t){se.warn("Failed to get WAX balance from balance service, using fallback","UserProfile",{error:t}),A(l.balance)}a.push(l)}}catch(t){se.error(`Failed to fetch ${r.symbol} balance`,"UserProfile",t)}}x(a)}catch(t){se.error("Failed to fetch token balances with fallback","UserProfile",t)}},[e,Ue,De]),ze=i.useCallback(async()=>{if(e)try{const t=await Ee.checkUserBadges(e);L(t.badges)}catch(t){se.error("Failed to fetch user badges","UserProfile.fetchUserBadges",t,{account:e})}},[e]),He=i.useCallback(async()=>{if(e)try{const a=await $e.getLightApiBalances(e);if(a&&a.balances){const n=[],i=a.balances.filter(e=>parseFloat(e.amount)>1e-4).sort((e,t)=>parseFloat(t.amount)-parseFloat(e.amount)).sort((e,t)=>{const a=Ue.some(t=>t.symbol===e.currency&&t.contract===e.contract),n=Ue.some(e=>e.symbol===t.currency&&e.contract===t.contract);return a&&!n?-1:!a&&n?1:0}).filter(e=>!De.includes(e.contract));for(let a=0;a<i.length;a++){const r=i[a];try{a>0&&await Ve(300);let i="0.00";const s=parseFloat(r.amount);try{if("WAX"===r.currency&&"eosio.token"===r.contract){const e=await ve.getWaxPriceUSD();i=ne(s*e,2)}else if("WPIXAL"===r.currency&&"pixeljourney"===r.contract){const e=await ve.getWpixalPriceUSD();i=ne(s*e,4)}else if("PXJ"===r.currency&&"pixeljourney"===r.contract){const e=await ve.getPxjPriceUSD();i=ne(s*e,6)}else i="WUF"===r.currency&&"wuffi"===r.contract?"0.00":"N/A"}catch(t){se.warn(`Failed to fetch price for ${r.currency}`,"UserProfile",{error:t}),i="0.00"}const l={balance:`${r.amount} ${r.currency}`,symbol:r.currency,contract:r.contract,value:i};if("WAX"===r.currency&&"eosio.token"===r.contract)try{const t=await Ie.getWaxBalance(e);A(t)}catch(t){se.warn("Failed to get WAX balance from balance service, using fallback","UserProfile",{error:t}),A(l.balance)}n.push(l)}catch(t){se.error(`Failed to get price for ${r.currency}`,"UserProfile",t);const e={balance:`${r.amount} ${r.currency}`,symbol:r.currency,contract:r.contract,value:"0.00"};n.push(e)}}x(n)}}catch(t){se.error("Failed to fetch token balances","UserProfile",t),await Xe()}},[e,De,Ue,Xe]),Je=i.useCallback(async()=>{if(e){F(!0),I(null);try{await Re(),await Oe(),await He(),await ze()}catch(t){se.error("Error loading user data","UserProfile",t),I("Failed to load user data"),r("User Data Error","Unable to load user profile data. Please try refreshing the page.")}finally{F(!1)}}},[e,r,He,Re,Oe,ze]);i.useEffect(()=>{t&&e&&(async()=>{try{await Je(),await Be(),await je(),await Te(),await Le(),Se()}catch(e){se.error("Error initializing user data","UserProfile",e),r("Failed to Load User Data","Unable to initialize user profile. Please try refreshing the page."),I("Failed to load user data")}})()},[t,e]),i.useEffect(()=>{e&&Ne(e)},[e]);const qe=(e,t)=>0===t?0:e/t*100,Ve=e=>new Promise(t=>setTimeout(t,e)),Ge=(e,t)=>{me({isOpen:!0,resourceType:e,action:t})},Ye=e=>{fe({isOpen:!0,action:e})},Ke=()=>{ge({isOpen:!1,token:null})},Qe=()=>{Be()},Ze=async e=>{const t={};for(const n of e)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/collections/${n}`),a=await e.json();if(a.success&&a.data?.img){const e=a.data.img;t[n]=e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`}}catch(a){se.error(`Error fetching avatar for collection ${n}`,"UserProfile",a)}p(t)},et=h.filter(e=>{if("all"!==O)if("tokens"===O){if("token_send"!==e.type&&"token_receive"!==e.type)return!1}else if(e.type!==O)return!1;if(z){const t=z.toLowerCase(),a=e.asset_name?.toLowerCase().includes(t),n=e.collection_name?.toLowerCase().includes(t),i=e.transaction_id.toLowerCase().includes(t),r=e.from?.toLowerCase().includes(t),s=e.to?.toLowerCase().includes(t);if(!(a||n||i||r||s))return!1}if("all"!==j){const t=new Date(e.block_time);if("custom"===j){if(U.start&&U.end){const e=new Date(U.start),a=new Date(U.end);if(a.setHours(23,59,59,999),t<e||t>a)return!1}else if(U.start){if(t<new Date(U.start))return!1}else if(U.end){const e=new Date(U.end);if(e.setHours(23,59,59,999),t>e)return!1}}else{const e="7d"===j?7:"30d"===j?30:90;if(t<new Date((new Date).getTime()-24*e*60*60*1e3))return!1}}return!0}),tt=[...et].sort((e,t)=>{let a=0;switch(Y){case"date":a=new Date(e.block_time).getTime()-new Date(t.block_time).getTime();break;case"amount":a=parseFloat(e.price?.replace(" WAX","")||"0")-parseFloat(t.price?.replace(" WAX","")||"0");break;case"type":a=e.type.localeCompare(t.type)}return"desc"===Z?-a:a}),at=Math.ceil(tt.length/G),nt=(q-1)*G,it=tt.slice(nt,nt+G),rt=t=>{ie(!0),he(null);try{let a,n,i;if("csv"===t){const t=[["Transaction ID","Date","Type","Asset Name","Collection","Price","From","To","Status"].join(",")];et.forEach(e=>{const a=[e.transaction_id,e.block_time,e.type,e.asset_name||"",e.collection_name||"",e.price||"",e.from||"",e.to||"",e.status].map(e=>`"${e}"`);t.push(a.join(","))}),a=t.join("\n"),n=`transactions_${e}_${(new Date).toISOString().split("T")[0]}.csv`,i="text/csv"}else a=JSON.stringify(et,null,2),n=`transactions_${e}_${(new Date).toISOString().split("T")[0]}.json`,i="application/json";const r=new Blob([a],{type:i}),s=URL.createObjectURL(r),l=document.createElement("a");l.href=s,l.download=n,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(s)}catch(a){se.error("Export failed","UserProfile",a);const e=a instanceof Error?a.message:"Failed to export transactions. Please try again.";he(e),r("Export Error",e)}finally{ie(!1)}};return t?H.jsxs("div",{className:"user-profile",children:[H.jsxs("div",{className:"profile-container",children:[H.jsxs("div",{className:"profile-header",children:[H.jsx("div",{className:"profile-avatar",children:H.jsx("div",{className:"avatar-placeholder",children:e?.charAt(0).toUpperCase()})}),H.jsxs("div",{className:"profile-info",children:[H.jsx("h1",{children:e}),H.jsxs("div",{className:"profile-badges",children:[M.map(e=>H.jsxs("span",{className:`badge ${e.id}`,title:e.description,children:[e.icon," ",e.name]},e.id)),0===M.length&&H.jsx("span",{className:"badge no-badges",children:"No badges earned yet"})]})]}),H.jsx("div",{className:"profile-stats-quick",children:v&&H.jsxs(H.Fragment,{children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:v.nftsOwned}),H.jsx("span",{className:"stat-label",children:"NFTs Owned"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:v.totalPurchases}),H.jsx("span",{className:"stat-label",children:"Purchases"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:v.totalSales}),H.jsx("span",{className:"stat-label",children:"Sales"})]})]})})]}),H.jsxs("div",{className:"profile-tabs",role:"tablist","aria-label":"Profile sections",children:[H.jsxs("div",{className:"tab-row",children:[H.jsx("button",{className:"tab-button "+("overview"===o?"active":""),onClick:()=>d("overview"),role:"tab","aria-selected":"overview"===o,"aria-controls":"overview-panel",id:"overview-tab",children:"Overview"}),H.jsx("button",{className:"tab-button "+("transactions"===o?"active":""),onClick:()=>d("transactions"),role:"tab","aria-selected":"transactions"===o,"aria-controls":"transactions-panel",id:"transactions-tab",children:"Transactions"}),H.jsx("button",{className:"tab-button "+("portfolio"===o?"active":""),onClick:()=>d("portfolio"),role:"tab","aria-selected":"portfolio"===o,"aria-controls":"portfolio-panel",id:"portfolio-tab",children:"Portfolio Analytics"}),H.jsx("button",{className:"tab-button "+("pxbadges"===o?"active":""),onClick:()=>d("pxbadges"),role:"tab","aria-selected":"pxbadges"===o,"aria-controls":"pxbadges-panel",id:"pxbadges-tab",children:"PxBadges"})]}),H.jsxs("div",{className:"tab-row",children:[H.jsx("button",{className:"tab-button "+("network-resources"===o?"active":""),onClick:()=>d("network-resources"),role:"tab","aria-selected":"network-resources"===o,"aria-controls":"network-resources-panel",id:"network-resources-tab",children:"Network Resources"}),H.jsx("button",{className:"tab-button "+("powerup"===o?"active":""),onClick:()=>d("powerup"),role:"tab","aria-selected":"powerup"===o,"aria-controls":"powerup-panel",id:"powerup-tab",children:"Powerup"}),H.jsx("button",{className:"tab-button "+("token-balances"===o?"active":""),onClick:()=>d("token-balances"),role:"tab","aria-selected":"token-balances"===o,"aria-controls":"token-balances-panel",id:"token-balances-tab",children:"Token Balances"}),H.jsx("button",{className:"tab-button "+("swap"===o?"active":""),onClick:()=>d("swap"),role:"tab","aria-selected":"swap"===o,"aria-controls":"swap-panel",id:"swap-tab",children:"Swap"})]})]}),H.jsxs("div",{className:"profile-content",children:[$&&H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading profile data..."})]}),E&&H.jsxs("div",{className:"error-state",children:[H.jsx("p",{children:E}),H.jsx("button",{onClick:Je,className:"retry-button",children:"Retry"})]}),!$&&!E&&H.jsxs(H.Fragment,{children:["overview"===o&&v&&H.jsxs("div",{className:"overview-tab",children:[H.jsxs("div",{className:"balance-info",children:[H.jsxs("div",{className:"balance-item",children:[H.jsx("span",{className:"balance-label",children:"WAX Balance:"}),H.jsx("span",{className:"balance-value",children:C})]}),H.jsxs("div",{className:"balance-item",children:[H.jsx("span",{className:"balance-label",children:"USD Value:"}),H.jsx("span",{className:"balance-value",children:"$0.00"})]})]}),H.jsxs("div",{className:"account-info",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Account Name:"}),H.jsx("span",{className:"info-value",children:e})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Created:"}),H.jsx("span",{className:"info-value",children:g?.created?new Date(g.created).toLocaleDateString():"Loading..."})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Last Active:"}),H.jsx("span",{className:"info-value",children:W?new Date(W).toLocaleDateString():g?.last_code_update?new Date(g.last_code_update).toLocaleDateString():"Loading..."})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"info-label",children:"Reputation:"}),H.jsx("span",{className:"info-value",children:v?.reputation||"\u2b50\u2b50\u2b50\u2b50\u2b50 (4.8/5)"})]})]}),H.jsxs("div",{className:"stats-grid",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:v?.nftsOwned||0}),H.jsx("div",{className:"stat-label",children:"NFTs Owned"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:v?.totalTransactions||0}),H.jsx("div",{className:"stat-label",children:"Transactions"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:v?.totalEarned||"0"}),H.jsx("div",{className:"stat-label",children:"WAX Earned"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:v?.tierStatus||"Bronze"}),H.jsx("div",{className:"stat-label",children:"Tier Status"})]})]}),H.jsxs("div",{className:"favorite-collections",children:[H.jsx("h3",{children:"Favorite Collections"}),H.jsx("div",{className:"collections-list",children:v.favoriteCollections.map((e,t)=>H.jsxs("div",{className:"collection-item",children:[H.jsxs("div",{className:"user-collection-avatar",children:[m[e]?H.jsx("img",{src:m[e],alt:`${e} avatar`,onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}):null,H.jsx("div",{className:"fallback-avatar",style:{display:m[e]?"none":"flex"},children:e.charAt(0).toUpperCase()})]}),H.jsx("span",{className:"collection-name",children:e})]},t))})]})]}),"transactions"===o&&H.jsxs("div",{className:"transactions-tab",children:[!t&&H.jsx("div",{className:"wallet-connection-prompt",children:H.jsxs("div",{className:"prompt-content",children:[H.jsx("h3",{children:"\ud83d\udd17 Connect Your Wallet"}),H.jsx("p",{children:"Connect your WAX wallet to view your personal transaction history and account details."}),H.jsx("button",{className:"connect-wallet-btn",onClick:n,children:"Connect Wallet"}),H.jsx("div",{className:"demo-notice",children:H.jsxs("p",{children:["\ud83d\udcca Currently showing demo data from account: ",H.jsx("strong",{children:"pixeljourney"})]})})]})}),H.jsxs("div",{className:"quick-filters",children:[H.jsx("button",{className:"filter-btn "+("all"===O?"active":""),onClick:()=>B("all"),children:"\ud83d\udd0d All Activity"}),H.jsx("button",{className:"filter-btn "+("purchase"===O?"active":""),onClick:()=>B("purchase"),children:"\ud83d\uded2 Purchases"}),H.jsx("button",{className:"filter-btn "+("sale"===O?"active":""),onClick:()=>B("sale"),children:"\ud83d\udcb0 Sales"}),H.jsx("button",{className:"filter-btn "+("transfer"===O?"active":""),onClick:()=>B("transfer"),children:"\ud83d\udd04 Transfers"}),H.jsx("button",{className:"filter-btn "+("tokens"===O?"active":""),onClick:()=>B("tokens"),children:"\ud83d\udcb8 Tokens"})]}),H.jsxs("div",{className:"transactions-header",children:[H.jsxs("div",{className:"transactions-stats",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:tt.length}),H.jsx("span",{className:"stat-label",children:"Total Found"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:h.length}),H.jsx("span",{className:"stat-label",children:"All Transactions"})]})]}),H.jsxs("div",{className:"transactions-actions",children:[H.jsxs("button",{className:"export-btn",onClick:()=>rt("csv"),disabled:te||0===et.length,children:[te?"\u23f3":"\ud83d\udcca"," Export CSV"]}),H.jsxs("button",{className:"export-btn",onClick:()=>rt("json"),disabled:te||0===et.length,children:[te?"\u23f3":"\ud83d\udcc4"," Export JSON"]})]})]}),H.jsxs("div",{className:"transactions-controls",children:[H.jsx("div",{className:"search-section",children:H.jsxs("div",{className:"search-input-wrapper",children:[H.jsx("input",{type:"text",placeholder:"Search by asset name, collection, transaction ID, or address...",value:z,onChange:e=>{J(e.target.value),V(1)},className:"search-input"}),H.jsx("span",{className:"search-icon",children:"\ud83d\udd0d"})]})}),H.jsxs("div",{className:"filters-section",children:[H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{children:"Type:"}),H.jsxs("select",{value:O,onChange:e=>{B(e.target.value),V(1)},className:"filter-select",children:[H.jsx("option",{value:"all",children:"All Types"}),H.jsx("option",{value:"purchase",children:"\ud83d\uded2 Purchases"}),H.jsx("option",{value:"sale",children:"\ud83d\udcb0 Sales"}),H.jsx("option",{value:"transfer",children:"\ud83d\udd04 Transfers"}),H.jsx("option",{value:"tokens",children:"\ud83d\udcb8 Token Transactions"})]})]}),H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{children:"Date:"}),H.jsxs("select",{value:j,onChange:e=>{D(e.target.value),V(1)},className:"filter-select",children:[H.jsx("option",{value:"7d",children:"Last 7 days"}),H.jsx("option",{value:"30d",children:"Last 30 days"}),H.jsx("option",{value:"90d",children:"Last 90 days"}),H.jsx("option",{value:"all",children:"All time"}),H.jsx("option",{value:"custom",children:"\ud83d\udcc5 Custom Range"})]}),"custom"===j&&H.jsxs("div",{className:"custom-date-range",children:[H.jsxs("div",{className:"date-input-group",children:[H.jsx("label",{children:"From:"}),H.jsx("input",{type:"date",className:"date-input",value:U.start,onChange:e=>{X(t=>({...t,start:e.target.value})),V(1)}})]}),H.jsxs("div",{className:"date-input-group",children:[H.jsx("label",{children:"To:"}),H.jsx("input",{type:"date",className:"date-input",value:U.end,onChange:e=>{X(t=>({...t,end:e.target.value})),V(1)}})]})]})]}),H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{children:"Sort:"}),H.jsxs("select",{value:`${Y}-${Z}`,onChange:e=>{const[t,a]=e.target.value.split("-");K(t),ee(a)},className:"filter-select",children:[H.jsx("option",{value:"date-desc",children:"\ud83d\udcc5 Newest First"}),H.jsx("option",{value:"date-asc",children:"\ud83d\udcc5 Oldest First"}),H.jsx("option",{value:"amount-desc",children:"\ud83d\udcb0 Highest Amount"}),H.jsx("option",{value:"amount-asc",children:"\ud83d\udcb0 Lowest Amount"}),H.jsx("option",{value:"type-asc",children:"\ud83d\udd24 Type A-Z"}),H.jsx("option",{value:"type-desc",children:"\ud83d\udd24 Type Z-A"})]})]})]})]}),re&&H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner",children:"\u23f3"}),H.jsx("h3",{children:"Loading Transactions..."}),H.jsx("p",{children:"Fetching your transaction history from the blockchain."})]}),ce&&!re&&H.jsxs("div",{className:"error-state",children:[H.jsx("div",{className:"error-icon",children:"\u274c"}),H.jsx("h3",{children:"Failed to Load Transactions"}),H.jsx("p",{children:ce}),H.jsx("button",{className:"retry-btn",onClick:()=>Re(),children:"\ud83d\udd04 Retry"})]}),de&&H.jsxs("div",{className:"export-error",children:[H.jsxs("span",{className:"error-text",children:["Export failed: ",de]}),H.jsx("button",{className:"dismiss-error-btn",onClick:()=>he(null),children:"\u2715"})]}),H.jsx("div",{className:"transactions-list",children:re||ce||0!==it.length?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"transactions-grid",children:it.map(t=>{return H.jsxs("div",{className:"transaction-card",children:[H.jsxs("div",{className:"transaction-header",children:[H.jsxs("div",{className:"transaction-icon",children:["purchase"===t.type&&"\ud83d\uded2","sale"===t.type&&"\ud83d\udcb0","transfer"===t.type&&"\ud83d\udd04","token_send"===t.type&&"\ud83d\udce4","token_receive"===t.type&&"\ud83d\udce5","mint"===t.type&&"\u2728"]}),H.jsx("div",{className:"transaction-type-badge",children:H.jsx("span",{className:`type-badge ${t.type}`,children:t.type.charAt(0).toUpperCase()+t.type.slice(1).replace("_"," ")})}),H.jsx("div",{className:"transaction-status",children:H.jsxs("span",{className:`status-badge ${t.status}`,children:["completed"===t.status&&"\u2705","pending"===t.status&&"\u23f3","failed"===t.status&&"\u274c"]})})]}),H.jsxs("div",{className:"transaction-content",children:[H.jsxs("div",{className:"asset-info",children:[H.jsx("h4",{className:"asset-name",children:t.asset_name||"Unknown Asset"}),t.collection_name&&H.jsx("span",{className:"collection-name",children:t.collection_name})]}),t.price&&H.jsx("div",{className:"transaction-amount",children:H.jsxs("span",{className:"amount "+("sale"===t.type||"token_receive"===t.type?"positive":"negative"),children:["sale"===t.type||"token_receive"===t.type?"+":"-",(n=t.price,ae(parseFloat(n.replace(" WAX",""))))]})}),H.jsxs("div",{className:"transaction-meta",children:[H.jsxs("div",{className:"meta-row",children:[H.jsx("span",{className:"meta-label",children:"Date:"}),H.jsx("span",{className:"meta-value",children:(a=t.block_time,new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),t.from&&t.from!==e&&H.jsxs("div",{className:"meta-row",children:[H.jsx("span",{className:"meta-label",children:"From:"}),H.jsx("span",{className:"meta-value address",children:t.from})]}),t.to&&t.to!==e&&H.jsxs("div",{className:"meta-row",children:[H.jsx("span",{className:"meta-label",children:"To:"}),H.jsx("span",{className:"meta-value address",children:t.to})]}),H.jsxs("div",{className:"meta-row",children:[H.jsx("span",{className:"meta-label",children:"TX ID:"}),H.jsxs("span",{className:"meta-value transaction-id-link",onClick:()=>c(`/transactions/${t.transaction_id}`),title:"View transaction details",children:[t.transaction_id.slice(0,12),"..."]})]}),t.memo&&H.jsxs("div",{className:"meta-row",children:[H.jsx("span",{className:"meta-label",children:"Memo:"}),H.jsx("span",{className:"meta-value memo",children:t.memo})]})]})]})]},t.transaction_id);var a,n})}),at>1&&H.jsxs("div",{className:"pagination",children:[H.jsx("div",{className:"pagination-info",children:H.jsxs("span",{children:["Showing ",nt+1,"-",Math.min(nt+G,tt.length)," of ",tt.length," transactions"]})}),H.jsxs("div",{className:"pagination-controls",children:[H.jsx("button",{className:"pagination-btn",onClick:()=>V(1),disabled:1===q,title:"First page",children:"\u23ee\ufe0f"}),H.jsx("button",{className:"pagination-btn",onClick:()=>V(q-1),disabled:1===q,title:"Previous page",children:"\u23ea"}),H.jsx("div",{className:"page-numbers",children:Array.from({length:Math.min(5,at)},(e,t)=>{let a;return a=at<=5||q<=3?t+1:q>=at-2?at-4+t:q-2+t,H.jsx("button",{className:"page-number "+(q===a?"active":""),onClick:()=>V(a),children:a},a)})}),H.jsx("button",{className:"pagination-btn",onClick:()=>V(q+1),disabled:q===at,title:"Next page",children:"\u23e9"}),H.jsx("button",{className:"pagination-btn",onClick:()=>V(at),disabled:q===at,title:"Last page",children:"\u23ed\ufe0f"})]})]})]}):H.jsxs("div",{className:"no-transactions",children:[H.jsx("div",{className:"no-transactions-icon",children:"\ud83d\udced"}),H.jsx("h3",{children:"No transactions found"}),H.jsx("p",{children:z?`No transactions match your search "${z}"`:"No transactions found for the selected filters."}),(z||"all"!==O||"all"!==j)&&H.jsx("button",{className:"clear-filters-btn",onClick:()=>{J(""),B("all"),D("all"),X({start:"",end:""}),V(1)},children:"Clear All Filters"})]})})]}),"portfolio"===o&&H.jsx("div",{className:"portfolio-tab",children:H.jsx(on,{})}),"pxbadges"===o&&H.jsx(yn,{}),"network-resources"===o&&H.jsxs("div",{className:"network-resources-tab",children:[H.jsxs("div",{className:"resources-header",children:[H.jsx("h2",{children:"Network Resources"}),H.jsx("p",{children:"Manage your WAX account resources (CPU, NET, RAM)"})]}),H.jsxs("div",{className:"resources-grid",children:[H.jsxs("div",{className:"resource-card cpu",children:[H.jsxs("div",{className:"resource-header",children:[H.jsx("div",{className:"resource-icon",children:"\u26a1"}),H.jsxs("div",{className:"resource-info",children:[H.jsx("h3",{children:"CPU"}),H.jsx("p",{children:"Processing power for transactions"})]})]}),H.jsxs("div",{className:"resource-stats",children:[H.jsx("div",{className:"usage-bar",children:H.jsx("div",{className:"usage-fill cpu",style:{width:N?N.cpu.used/N.cpu.max*100+"%":"45%"}})}),H.jsx("div",{className:"usage-text",children:N?`${(N.cpu.used/N.cpu.max*100).toFixed(1)}% used (${(N.cpu.used/1e3).toFixed(1)}ms / ${(N.cpu.max/1e3).toFixed(1)}ms)`:"45% used (4.5ms / 10ms)"})]}),H.jsxs("div",{className:"resource-actions",children:[H.jsx("button",{className:"stake-btn",onClick:()=>Ge("cpu","stake"),children:"Stake CPU"}),H.jsx("button",{className:"unstake-btn",onClick:()=>Ge("cpu","unstake"),children:"Unstake CPU"})]})]}),H.jsxs("div",{className:"resource-card net",children:[H.jsxs("div",{className:"resource-header",children:[H.jsx("div",{className:"resource-icon",children:"\ud83c\udf10"}),H.jsxs("div",{className:"resource-info",children:[H.jsx("h3",{children:"NET"}),H.jsx("p",{children:"Network bandwidth for transactions"})]})]}),H.jsxs("div",{className:"resource-stats",children:[H.jsx("div",{className:"usage-bar",children:H.jsx("div",{className:"usage-fill net",style:{width:N?N.net.used/N.net.max*100+"%":"30%"}})}),H.jsx("div",{className:"usage-text",children:N?`${(N.net.used/N.net.max*100).toFixed(1)}% used (${(N.net.used/1024).toFixed(1)}KB / ${(N.net.max/1024).toFixed(1)}KB)`:"30% used (3KB / 10KB)"})]}),H.jsxs("div",{className:"resource-actions",children:[H.jsx("button",{className:"stake-btn",onClick:()=>Ge("net","stake"),children:"Stake NET"}),H.jsx("button",{className:"unstake-btn",onClick:()=>Ge("net","unstake"),children:"Unstake NET"})]})]}),H.jsxs("div",{className:"resource-card ram",children:[H.jsxs("div",{className:"resource-header",children:[H.jsx("div",{className:"resource-icon",children:"\ud83d\udcbe"}),H.jsxs("div",{className:"resource-info",children:[H.jsx("h3",{children:"RAM"}),H.jsx("p",{children:"Storage space for account data"})]})]}),H.jsxs("div",{className:"resource-stats",children:[H.jsx("div",{className:"usage-bar",children:H.jsx("div",{className:"usage-fill ram",style:{width:N?N.ram.used/N.ram.max*100+"%":"65%"}})}),H.jsx("div",{className:"usage-text",children:N?`${(N.ram.used/N.ram.max*100).toFixed(1)}% used (${(N.ram.used/1024).toFixed(1)}KB / ${(N.ram.max/1024).toFixed(1)}KB)`:"65% used (6.5KB / 10KB)"})]}),H.jsxs("div",{className:"resource-actions",children:[H.jsx("button",{className:"buy-ram-btn",onClick:()=>Ye("buy"),children:"Buy RAM"}),H.jsx("button",{className:"sell-ram-btn",onClick:()=>Ye("sell"),children:"Sell RAM"})]})]})]})]}),"powerup"===o&&H.jsxs("div",{className:"powerup-tab",children:[H.jsxs("div",{className:"powerup-header",children:[H.jsx("h2",{children:"Powerup Resources"}),H.jsx("p",{children:"Boost your account resources for 24 hours"})]}),H.jsx("div",{className:"powerup-stats",children:H.jsxs("div",{className:"current-usage",children:[H.jsx("h3",{children:"Current Resource Usage"}),H.jsxs("div",{className:"usage-grid",children:[H.jsxs("div",{className:"usage-item",children:[H.jsx("span",{className:"usage-label",children:"CPU:"}),H.jsx("div",{className:"usage-bar",children:H.jsx("div",{className:"usage-fill",style:{width:N?`${qe(N.cpu.used,N.cpu.max)}%`:"0%"}})}),H.jsx("span",{className:"usage-percent",children:N?`${qe(N.cpu.used,N.cpu.max).toFixed(1)}%`:"0%"})]}),H.jsxs("div",{className:"usage-item",children:[H.jsx("span",{className:"usage-label",children:"NET:"}),H.jsx("div",{className:"usage-bar",children:H.jsx("div",{className:"usage-fill",style:{width:N?`${qe(N.net.used,N.net.max)}%`:"0%"}})}),H.jsx("span",{className:"usage-percent",children:N?`${qe(N.net.used,N.net.max).toFixed(1)}%`:"0%"})]})]})]})}),H.jsxs("div",{className:"powerup-form",children:[H.jsxs("div",{className:"form-section",children:[H.jsx("label",{children:"Account to Boost:"}),H.jsx("input",{type:"text",placeholder:"Enter account name",value:be,onChange:e=>Ne(e.target.value)})]}),H.jsxs("div",{className:"form-section",children:[H.jsx("label",{children:"WAX Amount to Spend:"}),H.jsxs("div",{className:"amount-input-container",children:[H.jsx("input",{type:"number",placeholder:"0.0000",value:xe||"",onChange:e=>{const t=e.target.value;if((""===t||/^\d*\.?\d*$/.test(t))&&(""===t||!isNaN(Number(t)))){if(""!==t){const e=parseFloat(C.split(" ")[0]);if(Number(t)>e)return}Ce(Number(t))}},step:"0.0001",min:"0",max:parseFloat(C.split(" ")[0])}),H.jsx("span",{className:"wax-label",children:"WAX"})]}),H.jsxs("div",{className:"slider-container",children:[H.jsx("input",{type:"range",min:"0",max:"100",value:parseFloat(C.split(" ")[0])>0?xe/parseFloat(C.split(" ")[0])*100:0,onChange:e=>{const t=Number(e.target.value),a=parseFloat(C.split(" ")[0]),n=Number(a*t/100).toFixed(8);Ce(Number(n))},className:"slider"}),H.jsxs("div",{className:"slider-value",children:[ae(xe)," (Max: ",C,")"]})]})]}),H.jsxs("div",{className:"form-section",children:[H.jsxs("label",{children:["CPU/NET Ratio: ",we,"% CPU / ",100-we,"% NET"]}),H.jsxs("div",{className:"progress-container",children:[H.jsxs("div",{className:"progress-bar-container",children:[H.jsx("div",{className:"progress-bar cpu",style:{width:`${we}%`}}),H.jsx("div",{className:"progress-bar net",style:{width:100-we+"%"}})]}),H.jsxs("div",{className:"progress-text",children:[H.jsxs("span",{className:"cpu-text",children:[we,"% CPU"]}),H.jsx("span",{className:"separator",children:" / "}),H.jsxs("span",{className:"net-text",children:[100-we,"% NET"]})]})]}),H.jsx("div",{className:"slider-container",children:H.jsx("input",{type:"range",min:"0",max:"100",value:we,onChange:e=>{const t=Number(e.target.value);ke(t)},className:"slider"})})]}),xe>0&&Pe&&Me&&H.jsxs("div",{className:"powerup-estimation",children:[H.jsx("h4",{children:"Estimated Boost (24 hours):"}),H.jsxs("div",{className:"boost-details",children:[H.jsxs("div",{className:"boost-item",children:[H.jsx("span",{children:"CPU:"}),H.jsx("span",{children:vn(mn(xe,we),pn(xe,we),Pe?.cpu,Pe?.net,Me)})]}),H.jsxs("div",{className:"boost-item",children:[H.jsx("span",{children:"NET:"}),H.jsx("span",{children:(st=fn(mn(xe,we),pn(xe,we),Pe?.cpu,Pe?.net).netAmount,!st||st<=0?"0 bytes":st>=1048576?`${(st/1048576).toFixed(2)} MB`:st>=1024?`${(st/1024).toFixed(2)} KB`:`${st} bytes`)})]})]}),H.jsxs("div",{className:"cost-info",children:[H.jsxs("div",{className:"cost-item",children:[H.jsx("span",{children:"CPU Cost:"}),H.jsxs("span",{children:[fn(mn(xe,we),pn(xe,we),Pe?.cpu,Pe?.net).cpuFee.toFixed(8)," WAX"]})]}),H.jsxs("div",{className:"cost-item",children:[H.jsx("span",{children:"NET Cost:"}),H.jsxs("span",{children:[fn(mn(xe,we),pn(xe,we),Pe?.cpu,Pe?.net).netFee.toFixed(8)," WAX"]})]})]})]}),H.jsx("button",{className:"powerup-btn",disabled:!xe||xe<=0||!be||Ae,onClick:()=>{if(xe>0&&be&&a){const e=mn(xe,we),t=pn(xe,we);(async(e,t,a,n,i,r,s,l)=>{if(r(!0),s("Awaiting confirmation..."),null==localStorage.getItem("wharf--session"))return void s("You are not logged in. Click the wallet icon in the top menu");const c=void 0;let o=`${Number(a).toFixed(8)} WAX`;const d=[{account:"waxdao",name:"powerup",authorization:[c.permissionLevel],data:{}},{account:"eosio",name:"powerup",authorization:[c.permissionLevel],data:{payer:c.actor,receiver:t,days:1,net_frac:parseFloat(i).toFixed(0),cpu_frac:parseFloat(n).toFixed(0),max_payment:o}}];try{await c.transact({actions:d},dn),l(!0),s("Processing transaction...");const a=setTimeout(()=>{s(`${t} has been boosted with ${o}`),e(e=>!e),l(!1)},3e3);return()=>clearTimeout(a)}catch(h){se.error("Powerup transaction error:",h),s(h.message)}})(be,xe,e,t,_e,a)}},children:Ae?"Processing...":"Boost Resources"})]})]}),"token-balances"===o&&H.jsxs("div",{className:"token-balances-tab",children:[H.jsxs("div",{className:"balances-header",children:[H.jsx("h2",{children:"Token Balances"}),H.jsx("p",{children:"View your token balances with USD values"}),H.jsxs("div",{className:"balance-summary",children:[H.jsxs("div",{className:"balance-summary-item",children:[H.jsx("span",{className:"balance-summary-label",children:"Total Tokens:"}),H.jsx("span",{className:"balance-summary-value",children:k.length})]}),H.jsxs("div",{className:"balance-summary-item",children:[H.jsx("span",{className:"balance-summary-label",children:"With USD Values:"}),H.jsx("span",{className:"balance-summary-value",children:k.filter(e=>"N/A"!==e.value&&"0.00"!==e.value).length})]})]})]}),H.jsxs("div",{className:"balances-controls",children:[H.jsxs("div",{className:"search-sort",children:[H.jsx("input",{type:"text",placeholder:"Search tokens...",className:"search-input"}),H.jsxs("select",{className:"sort-select",children:[H.jsx("option",{value:"balance",children:"Sort by Balance"}),H.jsx("option",{value:"value",children:"Sort by Value"}),H.jsx("option",{value:"name",children:"Sort by Name"})]})]}),H.jsxs("div",{className:"bulk-actions",children:[H.jsx("button",{className:"select-all-btn",onClick:()=>{if(_.size===k.length)S(new Set);else{const e=k.map((e,t)=>t.toString());S(new Set(e))}},children:_.size===k.length?"Deselect All":"Select All"}),H.jsxs("span",{className:"selected-info",children:[_.size," selected"]}),H.jsx("button",{className:"bulk-sell-btn",onClick:async()=>{if(0!==_.size&&e){T(!0);try{const e=Array.from(_).map(e=>k[parseInt(e)]).filter(e=>"PXJ"!==e.symbol);if(0===e.length)return void r("Invalid Selection","No valid tokens selected for swap (PXJ cannot be swapped for itself)");let a=0;const n=[];for(const r of e)try{const e=parseFloat(r.balance.split(" ")[0]),t=await $e.getAlcorSwapQuote({from_token:r.symbol,from_contract:r.contract,to_token:"PXJ",to_contract:"pixeljourney",amount:e.toString(),slippage:.5});t&&parseFloat(t.output.amount)>0?(n.push({token:r.symbol,amount:e,pxjReceived:parseFloat(t.output.amount),success:!0}),a+=parseFloat(t.output.amount)):n.push({token:r.symbol,amount:e,pxjReceived:0,success:!1,error:"No liquidity available"})}catch(t){se.error(`Failed to get swap quote for ${r.symbol}`,"UserProfile",t),n.push({token:r.symbol,amount:parseFloat(r.balance.split(" ")[0]),pxjReceived:0,success:!1,error:"Swap quote failed"})}const i=n.filter(e=>e.success),l=n.filter(e=>!e.success);let c="Bulk Sell Summary:\n\n";i.length>0&&(c+=`Successful swaps (${i.length}):\n`,i.forEach(e=>{c+=`\u2022 ${e.amount} ${e.token} \u2192 ${e.pxjReceived.toFixed(8)} PXJ\n`}),c+=`\nTotal PXJ received: ${a.toFixed(8)} PXJ\n`),l.length>0&&(c+=`\nFailed swaps (${l.length}):\n`,l.forEach(e=>{c+=`\u2022 ${e.amount} ${e.token} - ${e.error}\n`})),c+="\nNote: This is a preview. Actual swaps would require wallet confirmation.",s("Bulk Sell Summary",c),S(new Set),i.length>0&&await He()}catch(t){se.error("Bulk sell failed","UserProfile",t),r("Bulk Sell Failed","Bulk sell failed. Please try again.")}finally{T(!1)}}},disabled:0===_.size||P,children:P?"Processing...":"Bulk Sell into PXJ "+(_.size>0?`(${_.size})`:"(Coming Soon)")})]})]}),H.jsx("div",{className:"token-balances-grid",children:0===k.length?H.jsxs("div",{className:"no-tokens-message",children:[H.jsx("div",{className:"no-tokens-icon",children:"\ud83e\ude99"}),H.jsx("h3",{children:"No Token Balances Found"}),H.jsx("p",{children:"Your account doesn't have any token balances or they're still loading."})]}):k.map((e,t)=>H.jsxs("div",{className:"token-balance-card",children:[H.jsxs("div",{className:"token-header",children:[H.jsx("div",{className:"token-icon",children:"\ud83e\ude99"}),H.jsxs("div",{className:"token-details",children:[H.jsx("h3",{children:e.symbol}),H.jsx("p",{className:"token-contract",children:e.contract})]})]}),H.jsxs("div",{className:"token-amounts",children:[H.jsxs("div",{className:"token-balance",children:[H.jsx("span",{className:"balance-label",children:"Balance:"}),H.jsx("span",{className:"balance-value",children:e.balance})]}),H.jsxs("div",{className:"token-usd-value",children:[H.jsx("span",{className:"usd-label",children:"USD Value:"}),H.jsx("span",{className:"usd-value "+("N/A"===e.value?"unavailable":"0.00"===e.value?"zero":"available"),children:"N/A"===e.value?"N/A":`$${e.value}`})]})]}),H.jsxs("div",{className:"token-actions",children:[H.jsx("button",{className:"token-action-btn transfer",onClick:()=>(e=>{ge({isOpen:!0,token:e})})(e),children:"Transfer"}),H.jsx("button",{className:"token-action-btn trade",disabled:!0,children:"Trade"})]})]},`${e.contract}-${e.symbol}-${t}`))})]}),"swap"===o&&H.jsxs("div",{className:"swap-tab",children:[H.jsxs("div",{className:"swap-tab-header",children:[H.jsx("h2",{children:"Token Swap"}),H.jsx("p",{children:"Swap tokens directly using Alcor DEX integration"})]}),H.jsx(Nn,{})]})]})]})]}),H.jsx(sn,{isOpen:ue.isOpen,onClose:()=>{me({isOpen:!1,resourceType:"cpu",action:"stake"})},resourceType:ue.resourceType,action:ue.action,onSuccess:Qe}),H.jsx(ln,{isOpen:pe.isOpen,onClose:()=>{fe({isOpen:!1,action:"buy"})},action:pe.action,onSuccess:Qe}),H.jsx(cn,{isOpen:ye.isOpen,onClose:Ke,token:ye.token,onSuccess:()=>{Be(),Ke()}})]}):H.jsx("div",{className:"user-profile",children:H.jsx("div",{className:"profile-container",children:H.jsxs("div",{className:"not-connected",children:[H.jsx("div",{className:"not-connected-icon",children:"\ud83d\udd12"}),H.jsx("h2",{children:"Connect Your Wallet"}),H.jsx("p",{children:"Please connect your wallet to view your profile and transaction history."})]})})});var st},kn=()=>{const{account:e}=o(),[t]=d(),a=l(),n=e||t.get("user"),[r,s]=i.useState(null),[c,h]=i.useState(null),[u,m]=i.useState(null),[p,f]=i.useState("0.0000"),[v,y]=i.useState([]),[g,b]=i.useState(null),[N,w]=i.useState(!1),[k,x]=i.useState(null),[C,A]=i.useState(null),[_,S]=i.useState(!1),[P,T]=i.useState({}),[$,F]=i.useState(1),[E,I]=i.useState("all"),[M,L]=i.useState([]),[W,R]=i.useState({Body:"",Eyes:"",Head:"",Mouth:"",WaxRock:"",PixelPet:"",Background:"","Hats and Hair":"","Glasses and Masks":"","Special Accessories":""}),[O,B]=i.useState({}),j=i.useCallback(async e=>{try{const a=["token.pxj","eosio.token"],n=[];for(const i of a)try{const t=await $e.getWaxCurrencyBalance(e,i),a=await Promise.all(t.map(async e=>({...e,contract:i,value:await z(e.balance,e.symbol)})));n.push(...a)}catch(t){se.error(`Failed to fetch balance for ${i}:`,"UserProfileLookup.fetchTokenBalances",t)}y(n)}catch(t){se.error("Error fetching token balances:","UserProfileLookup.fetchTokenBalances",t)}},[]),D=i.useCallback(async()=>{if(n){w(!0),x(null);try{const e=await $e.getUserInventory(n),t=[...new Set(e.map(e=>e.collection))],a=await Ee.checkUserBadges(n);L(a.badges);const i=e.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema),r={Body:new Set,Eyes:new Set,Head:new Set,Mouth:new Set,WaxRock:new Set,PixelPet:new Set,Background:new Set,"Hats and Hair":new Set,"Glasses and Masks":new Set,"Special Accessories":new Set};i.forEach(e=>{Object.keys(r).forEach(t=>{const a=e.data?.[t];a&&"none"!==a&&""!==a&&r[t].add(a)})});const l={};Object.entries(r).forEach(([e,t])=>{l[e]=Array.from(t).sort()}),B(l),await Promise.all([U(n),X(n),j(n)]);const c=await(async e=>{try{const t=await $e.getWaxAccountInfo(e);if(t&&t.created)return new Date(t.created).toISOString().split("T")[0]}catch(k){se.warn("Could not fetch account creation date:","UserProfileLookup.getAccountCreationDate",k)}try{const t=await $e.getUserTransactions(e,1);if(t&&t.length>0){const e=t[t.length-1];if(e.block_time)return new Date(e.block_time).toISOString().split("T")[0]}}catch(k){se.warn("Could not fetch first transaction date:","UserProfileLookup.getAccountCreationDate",k)}return"2023-01-01"})(n),o={account:n,nftsOwned:e,totalNFTs:e.length,collections:t,joinDate:c,isVerified:a.badges.some(e=>"pixal-pfp"===e.id),badges:a.badges.map(e=>e.name)},d=await J(e),u={totalAssets:e.length,uniqueCollections:t.length,totalValue:d,rareAssets:e.filter(e=>e.template_mint&&e.template_mint<=100).length};s(o),h(u),t.length>0&&V(t)}catch(e){se.error("Error loading user profile:","UserProfileLookup.loadUserProfile",e),x("Failed to load user profile. Please check the account name and try again.")}finally{w(!1)}}},[n,j]);i.useEffect(()=>{n&&D()},[n,D]);const U=async e=>{try{const t=await $e.getWaxAccountInfo(e);if(m(t),t){const e={cpu:{used:t.cpu_limit.used,available:t.cpu_limit.available,max:t.cpu_limit.max},net:{used:t.net_limit.used,available:t.net_limit.available,max:t.net_limit.max},ram:{used:t.ram_usage,available:t.ram_quota-t.ram_usage,max:t.ram_quota}};b(e)}}catch(t){se.error("Failed to fetch WAX account info:","UserProfileLookup.fetchWaxAccountInfo",t)}},X=async e=>{try{const t=await Ie.getWaxBalance(e);f(t)}catch(t){se.error("Failed to fetch WAX balance:","UserProfileLookup.fetchWaxBalance",t)}},z=async(e,t)=>{const a=parseFloat(e.split(" ")[0]);try{const e={TLM:"alien.worlds",NEFTY:"neftyblocksp",SEST:"sest.token"}[t];if(e){const n=await $e.getAlcorTokenPrice(t,e);if(n&&n.usd_price)return`$${(a*n.usd_price).toFixed(4)}`}return`$${(a*({TLM:.02,NEFTY:.001,SEST:1e-4}[t]||.001)).toFixed(4)}`}catch(n){return se.error(`Error fetching price for ${t}:`,"UserProfileLookup.fetchWaxAccountInfo",n),`$${(a*({TLM:.02,NEFTY:.001,SEST:1e-4}[t]||.001)).toFixed(4)}`}},J=async e=>{if(0===e.length)return"0.00 WAX";try{const a=e.reduce((e,t)=>{const a=t.collection;return e[a]||(e[a]=[]),e[a].push(t),e},{});let n=0;for(const[e,i]of Object.entries(a))try{const t=await $e.getCollectionStats(e);let a=0;if(t&&t.floor_price)a=parseFloat(t.floor_price);else{const t=await fetch(`${$e.atomicMarketAPI}/atomicmarket/v1/sales?state=3&collection_name=${e}&limit=50&order=desc&sort=updated`),n=await t.json();if(n.success&&n.data?.length>0){const e=n.data.filter(e=>e.price?.amount).map(e=>parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8));e.length>0&&(a=Math.min(...e))}}0===a&&(a=1),i.forEach(e=>{let t=a;e.template_mint&&(e.template_mint<=10?t*=3:e.template_mint<=50?t*=2:e.template_mint<=100&&(t*=1.5)),n+=t})}catch(t){se.warn(`Failed to get market data for collection ${e}, using fallback pricing:`,"UserProfileLookup.calculateTotalValue",t),n+=1.5*i.length}return`${n.toFixed(2)} WAX`}catch(t){return se.error("Error calculating total portfolio value:","UserProfileLookup.calculateTotalValue",t),`${(2*e.length).toFixed(2)} WAX`}},q=()=>{if(!r)return[];let e=r.nftsOwned;switch(E){case"pixals":e=e.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema),Object.entries(W).forEach(([t,a])=>{a&&""!==a&&(e=e.filter(e=>{const n=e.data?.[t];return n&&n.toLowerCase().includes(a.toLowerCase())}))});break;case"waxrock":e=e.filter(e=>{const t=e.data?.WaxRock;return"pixeljourney"===e.collection&&"pixals"===e.schema&&t&&"none"!==t});break;case"ingredients":e=e.filter(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema)}return e},V=async e=>{const t={};for(const n of e)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/collections/${n}`),a=await e.json();if(a.success&&a.data?.img){const e=a.data.img;t[n]=e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`}}catch(a){se.error(`Error fetching avatar for collection ${n}:`,"UserProfileLookup.fetchCollectionAvatars",a)}T(t)},G=e=>{F(e),window.scrollTo({top:0,behavior:"smooth"})};if(N)return H.jsx("div",{className:"user-profile-lookup",children:H.jsx("div",{className:"profile-container",children:H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading user profile..."})]})})});if(k)return H.jsx("div",{className:"user-profile-lookup",children:H.jsx("div",{className:"profile-container",children:H.jsxs("div",{className:"error-state",children:[H.jsx("div",{className:"error-icon",children:"\u26a0\ufe0f"}),H.jsx("h2",{children:"Profile Not Found"}),H.jsx("p",{children:k}),H.jsxs("div",{className:"error-actions",children:[H.jsx("button",{onClick:()=>a(-1),className:"btn-secondary",children:"Go Back"}),H.jsx("button",{onClick:D,className:"btn-primary",children:"Try Again"})]})]})})});if(!r||!c)return H.jsx("div",{className:"user-profile-lookup",children:H.jsx("div",{className:"profile-container",children:H.jsx("div",{className:"no-data",children:H.jsx("p",{children:"No profile data available"})})})});const Y=q(),K=(()=>{const e=q(),t=20*($-1);return e.slice(t,t+20)})(),Q=(()=>{const e=q();return Math.ceil(e.length/20)})();return H.jsxs("div",{className:"user-profile-lookup",children:[H.jsxs("div",{className:"profile-container",children:[H.jsxs("div",{className:"profile-header",children:[H.jsx("div",{className:"profile-avatar",children:H.jsx("div",{className:"avatar-placeholder",children:n?.charAt(0).toUpperCase()})}),H.jsxs("div",{className:"profile-info",children:[H.jsx("h1",{children:n}),H.jsxs("div",{className:"profile-badges",children:[r.isVerified&&H.jsx("span",{className:"badge verified",children:"\u2713 Verified"}),M.map(e=>H.jsxs("span",{className:`badge ${e.id}`,title:e.description,children:[e.icon," ",e.name]},e.id))]})]}),H.jsxs("div",{className:"profile-stats-quick",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:c.totalAssets}),H.jsx("span",{className:"stat-label",children:"NFTs Owned"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:c.uniqueCollections}),H.jsx("span",{className:"stat-label",children:"Collections"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("span",{className:"stat-value",children:c.rareAssets}),H.jsx("span",{className:"stat-label",children:"Rare Assets"})]})]})]}),u&&H.jsxs("div",{className:"account-info-section",children:[H.jsx("h3",{children:"Account Information"}),H.jsxs("div",{className:"account-info-grid",children:[H.jsxs("div",{className:"user-info-card",children:[H.jsx("div",{className:"info-icon",children:"\ud83d\udc64"}),H.jsxs("div",{className:"info-details",children:[H.jsx("h4",{children:"Account Name"}),H.jsx("p",{children:u.account_name})]})]}),H.jsxs("div",{className:"user-info-card",children:[H.jsx("div",{className:"info-icon",children:"\ud83d\udcc5"}),H.jsxs("div",{className:"info-details",children:[H.jsx("h4",{children:"Created"}),H.jsx("p",{children:new Date(u.created).toLocaleDateString()})]})]}),H.jsxs("div",{className:"user-info-card",children:[H.jsx("div",{className:"info-icon",children:"\ud83d\udd11"}),H.jsxs("div",{className:"info-details",children:[H.jsx("h4",{children:"Permissions"}),H.jsxs("p",{children:[u.permissions?.length||0," keys"]})]})]})]})]}),H.jsxs("div",{className:"balance-section",children:[H.jsx("h3",{children:"Balances"}),H.jsxs("div",{className:"balance-grid",children:[H.jsxs("div",{className:"balance-card primary",children:[H.jsx("div",{className:"balance-icon",children:"\ud83d\udcb0"}),H.jsxs("div",{className:"balance-details",children:[H.jsx("h4",{children:"WAX Balance"}),H.jsx("p",{className:"balance-value",children:p})]})]}),v.map((e,t)=>H.jsxs("div",{className:"balance-card",children:[H.jsx("div",{className:"balance-icon",children:"\ud83e\ude99"}),H.jsxs("div",{className:"balance-details",children:[H.jsx("h4",{children:e.symbol}),H.jsx("p",{className:"balance-value",children:e.balance}),H.jsx("p",{className:"balance-usd",children:e.value})]})]},t))]})]}),g&&H.jsxs("div",{className:"resources-section",children:[H.jsx("h3",{children:"Resources"}),H.jsxs("div",{className:"resources-grid",children:[H.jsxs("div",{className:"resource-card",children:[H.jsxs("div",{className:"resource-header",children:[H.jsx("span",{className:"resource-icon",children:"\u26a1"}),H.jsx("h4",{children:"CPU"})]}),H.jsx("div",{className:"resource-bar",children:H.jsx("div",{className:"resource-fill",style:{width:g.cpu.used/g.cpu.max*100+"%"}})}),H.jsxs("div",{className:"resource-stats",children:[H.jsxs("span",{children:[g.cpu.used.toLocaleString()," / ",g.cpu.max.toLocaleString()]}),H.jsxs("span",{children:[(g.cpu.used/g.cpu.max*100).toFixed(1),"%"]})]})]}),H.jsxs("div",{className:"resource-card",children:[H.jsxs("div",{className:"resource-header",children:[H.jsx("span",{className:"resource-icon",children:"\ud83c\udf10"}),H.jsx("h4",{children:"NET"})]}),H.jsx("div",{className:"resource-bar",children:H.jsx("div",{className:"resource-fill",style:{width:g.net.used/g.net.max*100+"%"}})}),H.jsxs("div",{className:"resource-stats",children:[H.jsxs("span",{children:[g.net.used.toLocaleString()," / ",g.net.max.toLocaleString()]}),H.jsxs("span",{children:[(g.net.used/g.net.max*100).toFixed(1),"%"]})]})]}),H.jsxs("div",{className:"resource-card",children:[H.jsxs("div",{className:"resource-header",children:[H.jsx("span",{className:"resource-icon",children:"\ud83d\udcbe"}),H.jsx("h4",{children:"RAM"})]}),H.jsx("div",{className:"resource-bar",children:H.jsx("div",{className:"resource-fill",style:{width:g.ram.used/g.ram.max*100+"%"}})}),H.jsxs("div",{className:"resource-stats",children:[H.jsxs("span",{children:[(g.ram.used/1024).toFixed(2)," KB / ",(g.ram.max/1024).toFixed(2)," KB"]}),H.jsxs("span",{children:[(g.ram.used/g.ram.max*100).toFixed(1),"%"]})]})]})]})]}),H.jsxs("div",{className:"stats-grid",children:[H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-icon",children:"\ud83c\udfa8"}),H.jsxs("div",{className:"stat-details",children:[H.jsx("h3",{children:"Total Assets"}),H.jsx("p",{className:"stat-value",children:c.totalAssets})]})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-icon",children:"\ud83d\udcda"}),H.jsxs("div",{className:"stat-details",children:[H.jsx("h3",{children:"Collections"}),H.jsx("p",{className:"stat-value",children:c.uniqueCollections})]})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-icon",children:"\ud83d\udc8e"}),H.jsxs("div",{className:"stat-details",children:[H.jsx("h3",{children:"Estimated Value"}),H.jsx("p",{className:"stat-value",children:c.totalValue})]})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-icon",children:"\u2b50"}),H.jsxs("div",{className:"stat-details",children:[H.jsx("h3",{children:"Rare Assets"}),H.jsx("p",{className:"stat-value",children:c.rareAssets})]})]})]}),H.jsxs("div",{className:"collections-section",children:[H.jsxs("h3",{children:["Collections (",r.collections.length,")"]}),H.jsx("div",{className:"collections-list",children:r.collections.map((e,t)=>H.jsxs("div",{className:"collection-item",onClick:()=>a(`/collections/${e}`),children:[H.jsxs("div",{className:"user-collection-avatar",children:[P[e]?H.jsx("img",{src:P[e],alt:`${e} avatar`,onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}):null,H.jsx("div",{className:"fallback-avatar",style:{display:P[e]?"none":"flex"},children:e.charAt(0).toUpperCase()})]}),H.jsx("span",{className:"collection-name",children:e}),H.jsx("span",{className:"collection-count",children:r.nftsOwned.filter(t=>t.collection===e).length})]},t))})]}),H.jsxs("div",{className:"inventory-section",children:[H.jsxs("div",{className:"inventory-header",children:[H.jsxs("h3",{children:["NFT Inventory (",Y.length,")"]}),H.jsxs("div",{className:"filter-tabs",children:[H.jsxs("button",{className:"filter-tab "+("all"===E?"active":""),onClick:()=>{I("all"),F(1)},children:["All (",r.nftsOwned.length,")"]}),H.jsxs("button",{className:"filter-tab "+("pixals"===E?"active":""),onClick:()=>{I("pixals"),F(1)},children:["Pixals (",r.nftsOwned.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema).length,")"]}),H.jsxs("button",{className:"filter-tab "+("waxrock"===E?"active":""),onClick:()=>{I("waxrock"),F(1)},children:["WaxRock (",r.nftsOwned.filter(e=>{const t=e.data?.WaxRock;return"pixeljourney"===e.collection&&"pixals"===e.schema&&t&&"none"!==t}).length,")"]}),H.jsxs("button",{className:"filter-tab "+("ingredients"===E?"active":""),onClick:()=>{I("ingredients"),F(1)},children:["Ingredients (",r.nftsOwned.filter(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema).length,")"]})]}),"pixals"===E&&H.jsxs("div",{className:"pixal-filters",children:[H.jsx("h4",{children:"Filter by Traits"}),H.jsx("div",{className:"filters-grid",children:Object.entries(W).map(([e,t])=>H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{children:e}),H.jsxs("select",{value:t,onChange:t=>{R(a=>({...a,[e]:t.target.value})),F(1)},children:[H.jsxs("option",{value:"",children:["All ",e]}),O[e]?.map(e=>H.jsx("option",{value:e,children:e},e))]})]},e))}),H.jsx("button",{className:"clear-filters-btn",onClick:()=>{R({Body:"",Eyes:"",Head:"",Mouth:"",WaxRock:"",PixelPet:"",Background:"","Hats and Hair":"","Glasses and Masks":"","Special Accessories":""}),F(1)},children:"Clear All Filters"})]})]}),0===K.length?H.jsxs("div",{className:"empty-inventory",children:[H.jsx("div",{className:"empty-icon",children:"\ud83d\udce6"}),H.jsx("h3",{children:"No NFTs Found"}),H.jsx("p",{children:"This user doesn't have any NFTs in the selected category."})]}):H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"nft-grid",children:K.map(e=>H.jsxs("div",{className:"nft-card",onClick:()=>(e=>{A(e),S(!0)})(e),children:[H.jsx("div",{className:"nft-image",children:e.video?H.jsx("video",{src:e.video,className:"nft-media",muted:!0,loop:!0,onMouseEnter:e=>e.currentTarget.play(),onMouseLeave:e=>e.currentTarget.pause(),onError:t=>{const a=document.createElement("img");a.src=e.image,a.className="nft-media",a.alt=e.name,a.loading="lazy",t.currentTarget.parentNode?.replaceChild(a,t.currentTarget)}}):H.jsx("img",{src:e.image,alt:e.name,className:"nft-media",loading:"lazy"})}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h4",{className:"nft-name",children:e.name}),H.jsx("p",{className:"nft-collection",children:e.collection}),H.jsxs("div",{className:"nft-schema-template",children:[H.jsx("span",{className:"nft-schema",children:e.schema}),e.template_id&&H.jsxs("span",{className:"nft-template",children:["T#",e.template_id]})]}),H.jsxs("div",{className:"nft-details",children:[H.jsxs("span",{className:"nft-mint",children:["#",e.template_mint]}),e.max_supply&&parseInt(e.max_supply)>0&&H.jsxs("span",{className:"nft-supply",children:["/",e.max_supply]})]})]})]},e.asset_id))}),Q>1&&H.jsxs("div",{className:"pagination",children:[H.jsx("button",{className:"pagination-btn",onClick:()=>G($-1),disabled:1===$,children:"Previous"}),H.jsx("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,Q)},(e,t)=>{let a;return a=Q<=5||$<=3?t+1:$>=Q-2?Q-4+t:$-2+t,H.jsx("button",{className:"pagination-number "+($===a?"active":""),onClick:()=>G(a),children:a},a)})}),H.jsx("button",{className:"pagination-btn",onClick:()=>G($+1),disabled:$===Q,children:"Next"})]})]})]})]}),C&&H.jsx(ia,{nft:C,isOpen:_,onClose:()=>{S(!1),A(null)}})]})},xn=()=>{const{settings:e}=ke(),{showSuccess:t,showError:a}=We(),[n,r]=i.useState([]),[s,l]=i.useState(!1),[c,o]=i.useState(null),[d,h]=i.useState(!1),[u,m]=i.useState(new Set),[p,f]=i.useState(!1),[v,y]=i.useState(!1),[g,b]=i.useState(""),[N,w]=i.useState(""),[k,x]=i.useState(1),[C,A]=i.useState(!1),[_,S]=i.useState(1),{isConnected:P,account:T,login:$,session:F}=Q();i.useEffect(()=>{const e=setTimeout(()=>{w(g)},300);return()=>clearTimeout(e)},[g]);const E=i.useCallback(async(e=1,t=!1)=>{if(T){1===e&&l(!0);try{const a=await $e.getUserInventoryPaginated(T,e,100),n=a.assets.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image,video:e.video||e.traits?.video||void 0,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:(e.max_supply||0).toString()},data:e.traits||{},mint_number:e.template_mint})).filter(e=>_a.isPackNFT(e));t?r(e=>[...e,...n]):(r(n),x(1)),A(100===a.assets.length),S(e)}catch(n){a("Failed to load pack inventory")}finally{l(!1)}}},[T,a]);i.useEffect(()=>{P&&T?E(1,!1):r([])},[P,T,E]);const I=i.useMemo(()=>{if(!N)return n;const e=N.toLowerCase();return n.filter(t=>t.name.toLowerCase().includes(e)||t.collection.collection_name.toLowerCase().includes(e)||t.schema.schema_name.toLowerCase().includes(e))},[n,N]),M=i.useMemo(()=>{const e=20*(k-1),t=e+20;return I.slice(e,t)},[I,k,20]),L=Math.ceil(I.length/20),W=I.length,R=e=>{x(e),window.scrollTo({top:0,behavior:"smooth"})};return P?H.jsxs("div",{className:"page-content packs-page",children:[H.jsxs("div",{className:"page-header",children:[H.jsx("h1",{children:"Pack Inventory"}),H.jsx("p",{children:"Manage and unpack your NFT packs, chests, boxes, and containers"})]}),H.jsxs("div",{className:"inventory-controls",children:[H.jsx("div",{className:"search-container",children:H.jsx("input",{type:"text",placeholder:"Search packs...",value:g,onChange:e=>b(e.target.value),className:"search-input"})}),H.jsxs("div",{className:"control-buttons",children:[H.jsx("button",{className:"multi-select-btn "+(p?"active":""),onClick:()=>{f(!p),m(new Set)},children:p?"\u2713 Multi-Select":"Multi-Select"}),p&&u.size>0&&H.jsxs("button",{className:"bulk-btn unpack-btn",onClick:()=>{0!==u.size&&y(!0)},children:["\ud83d\udce6 Unpack (",u.size,")"]})]})]}),s&&H.jsxs("div",{className:"loading-container",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading your packs..."})]}),!s&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"inventory-page-stats",children:H.jsxs("p",{children:[W," packs found"]})}),n.length>0?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"inventory-page-grid",children:M.map(t=>H.jsxs("div",{className:"nft-card "+(p&&u.has(t.asset_id)?"selected":""),onClick:()=>(e=>{if(p){const t=new Set(u);t.has(e.asset_id)?t.delete(e.asset_id):t.add(e.asset_id),m(t)}else o(e),h(!0)})(t),children:[p&&H.jsx("div",{className:"selection-checkbox",children:H.jsx("input",{type:"checkbox",checked:u.has(t.asset_id),onChange:()=>{}})}),H.jsxs("div",{className:"nft-image-container",children:[H.jsx(Rt,{imageUrl:Qt({img:t.img}),videoUrl:t.video?Zt({video:t.video}):void 0,alt:t.name,className:"w-full h-full object-cover",controls:e.showVideoControls,autoPlay:e.autoPlayVideos,muted:e.muteVideos}),H.jsx("div",{className:"pack-indicator",children:"\ud83d\udce6 Pack"})]}),H.jsxs("div",{className:"nft-info",children:[H.jsx("h3",{className:"nft-name",children:t.name}),H.jsx("p",{className:"nft-collection",children:"string"==typeof t.collection?t.collection:t.collection?.collection_name||t.collection?.name||"Unknown"}),H.jsx("p",{className:"nft-schema",children:t.schema.schema_name}),t.mint_number&&H.jsxs("p",{className:"nft-mint",children:["Mint #",t.mint_number]})]})]},t.asset_id))}),C&&H.jsx("div",{className:"load-more-container",children:H.jsx("button",{className:"load-more-btn",onClick:()=>{C&&E(_+1,!0)},children:"Load More Packs"})}),L>1&&H.jsxs("div",{className:"pagination-container",children:[H.jsxs("div",{className:"pagination",children:[H.jsx("button",{className:"pagination-btn",onClick:()=>R(k-1),disabled:1===k,children:"Previous"}),Array.from({length:Math.min(5,L)},(e,t)=>{const a=t+1;return H.jsx("button",{className:"pagination-btn "+(k===a?"active":""),onClick:()=>R(a),children:a},a)}),H.jsx("button",{className:"pagination-btn",onClick:()=>R(k+1),disabled:k===L,children:"Next"})]}),H.jsxs("div",{className:"pagination-info",children:["Page ",k," of ",L]})]})]}):H.jsxs("div",{className:"empty-state",children:[H.jsx("div",{className:"empty-icon",children:"\ud83d\udce6"}),H.jsx("h3",{children:"No Packs Found"}),H.jsx("p",{children:"You don't have any pack NFTs in your inventory yet."}),H.jsx("p",{children:"Packs, chests, boxes, and containers will appear here when you acquire them."})]})]}),c&&H.jsx(ia,{nft:{asset_id:c.asset_id,name:c.name,image:c.img,collection:c.collection.collection_name,schema:c.schema.schema_name,template_mint:c.mint_number,traits:c.data,price:null,sale_id:null,seller:null},isOpen:d,onClose:()=>{h(!1),o(null)}}),H.jsx(Sa,{selectedNFTs:n.filter(e=>u.has(e.asset_id)),isOpen:v,onClose:()=>{y(!1)},userAccount:T||"",walletSession:F,onUnpackComplete:()=>{m(new Set),f(!1),E(1,!1),t("Packs unpacked successfully!")}})]}):H.jsxs("div",{className:"page-content",children:[H.jsxs("div",{className:"page-header",children:[H.jsx("h1",{children:"Pack Inventory"}),H.jsx("p",{children:"Manage and unpack your NFT packs"})]}),H.jsx("div",{className:"connect-wallet-prompt",children:H.jsxs("div",{className:"connect-card",children:[H.jsx("h3",{children:"Connect Your Wallet"}),H.jsx("p",{children:"Connect your WAX wallet to view your pack inventory"}),H.jsx("button",{className:"connect-btn",onClick:$,children:"Connect Wallet"})]})})]})},Cn=()=>{const[e,t]=i.useState([]),[a,n]=i.useState(!0),[r,s]=i.useState({}),[l,c]=i.useState(null),[o,d]=i.useState(""),[h,u]=i.useState("below");i.useEffect(()=>{m()},[]),i.useEffect(()=>{e.length>0&&(async()=>{const t={};for(const a of e)a.nft.price&&(t[a.nft.asset_id]=await ve.convertWaxToUSDAsync(a.nft.price));s(t)})()},[e]);const m=async()=>{try{n(!0);const e=await Xe.getWatchlist();t(e)}catch(e){se.error("Error loading watchlist","Watchlist",e)}finally{n(!1)}},p=e=>e?e>0?"\u2197":"\u2198":"";return a?H.jsx("div",{className:"watchlist-container",children:H.jsxs("div",{className:"watchlist-loading",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading your watchlist..."})]})}):H.jsxs("div",{className:"watchlist-container",children:[H.jsxs("div",{className:"watchlist-header",children:[H.jsx("h1",{children:"My Watchlist"}),H.jsx("p",{className:"watchlist-subtitle",children:"Track your favorite NFTs and get notified when prices change"})]}),0===e.length?H.jsxs("div",{className:"watchlist-empty",children:[H.jsx("div",{className:"empty-icon",children:"\ud83d\udc41\ufe0f"}),H.jsx("h3",{children:"Your watchlist is empty"}),H.jsx("p",{children:"Add NFTs to your watchlist from the marketplace to track their prices"}),H.jsx("a",{href:"/marketplace",className:"btn-primary",children:"Browse Marketplace"})]}):H.jsx("div",{className:"watchlist-grid",children:e.map(e=>{return H.jsxs("div",{className:"watchlist-card",children:[H.jsxs("div",{className:"watchlist-card-image",children:[H.jsx("img",{src:e.nft.image,alt:e.nft.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),e.targetPrice&&H.jsx("div",{className:"alert-badge",children:H.jsx("span",{className:"alert-icon",children:"\ud83d\udd14"})})]}),H.jsxs("div",{className:"watchlist-card-content",children:[H.jsx("h3",{className:"nft-name",children:e.nft.name}),H.jsx("p",{className:"nft-collection",children:e.nft.collection}),H.jsxs("div",{className:"price-info",children:[H.jsxs("div",{className:"current-price",children:[H.jsx("span",{className:"price-label",children:"Current Price:"}),H.jsxs("div",{className:"price-values",children:[H.jsxs("span",{className:"wax-price",children:[e.nft.price," WAX"]}),r[e.nft.asset_id]&&H.jsxs("span",{className:"usd-price",children:["$",r[e.nft.asset_id]]})]})]}),void 0!==e.priceChange&&H.jsxs("div",{className:"price-change",style:{color:(a=e.priceChange,a?a>0?"var(--success-color)":"var(--error-color)":"var(--text-secondary)")},children:[H.jsx("span",{className:"change-icon",children:p(e.priceChange)}),H.jsxs("span",{children:[Math.abs(e.priceChange).toFixed(2),"%"]})]})]}),e.targetPrice&&H.jsxs("div",{className:"price-alert-info",children:[H.jsxs("span",{className:"alert-label",children:["Alert when price is ",e.alertType,":"]}),H.jsxs("span",{className:"alert-price",children:[e.targetPrice," WAX"]})]}),H.jsxs("div",{className:"watchlist-actions",children:[e.targetPrice?H.jsx("button",{className:"btn-secondary btn-sm",onClick:()=>(async e=>{try{await Xe.removePriceAlert(e),t(t=>t.map(t=>t.nft.asset_id===e?{...t,targetPrice:void 0,alertType:"any"}:t))}catch(a){se.error("Error removing price alert","Watchlist",a)}})(e.nft.asset_id),children:"Remove Alert"}):H.jsx("button",{className:"btn-primary btn-sm",onClick:()=>c(e.nft.asset_id),children:"Add Price Alert"}),H.jsx("button",{className:"btn-danger btn-sm",onClick:()=>(async e=>{try{await Xe.removeFromWatchlist(e),t(t=>t.filter(t=>t.nft.asset_id!==e))}catch(a){se.error("Error removing from watchlist","Watchlist",a)}})(e.nft.asset_id),children:"Remove"})]})]}),l===e.nft.asset_id&&H.jsxs("div",{className:"price-alert-form",children:[H.jsx("h4",{children:"Set Price Alert"}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Alert Type:"}),H.jsxs("select",{value:h,onChange:e=>u(e.target.value),children:[H.jsx("option",{value:"below",children:"Price drops below"}),H.jsx("option",{value:"above",children:"Price rises above"}),H.jsx("option",{value:"any",children:"Any price change"})]})]}),"any"!==h&&H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Target Price (WAX):"}),H.jsx("input",{type:"number",step:"0.01",value:o,onChange:e=>d(e.target.value),placeholder:"Enter price in WAX"})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{className:"btn-primary btn-sm",onClick:()=>(async e=>{if(o)try{await Xe.setPriceAlert(e,{targetPrice:parseFloat(o),alertType:h,enabled:!0}),t(t=>t.map(t=>t.nft.asset_id===e?{...t,targetPrice:parseFloat(o),alertType:h}:t)),c(null),d("")}catch(a){se.error("Error adding price alert","Watchlist",a)}})(e.nft.asset_id),disabled:"any"!==h&&!o,children:"Set Alert"}),H.jsx("button",{className:"btn-secondary btn-sm",onClick:()=>c(null),children:"Cancel"})]})]})]},e.nft.asset_id);var a})})]})},An=()=>{const e=[{title:"Pixel Journey",url:"https://pixeljourney.xyz",icon:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),H.jsx("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),H.jsx("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})},{title:"Documentation",url:"https://docs.pixeljourney.xyz",icon:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),H.jsx("polyline",{points:"14,2 14,8 20,8"}),H.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),H.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),H.jsx("polyline",{points:"10,9 9,9 8,9"})]})},{title:"Discord",url:"http://discord.gg/pixel-journey-1130670500776005734",icon:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})})},{title:"Twitter/X",url:"https://x.com/PXJourney",icon:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})}];return H.jsx("footer",{className:"footer",children:H.jsxs("div",{className:"footer-container",children:[H.jsxs("div",{className:"footer-content",children:[H.jsxs("div",{className:"footer-brand",children:[H.jsxs("a",{href:"https://pixeljourney.xyz",className:"footer-logo",target:"_blank",rel:"noopener noreferrer",children:[H.jsx("img",{src:"https://pixeljourney.xyz/img/logo.png",alt:"Pixel Journey",className:"footer-logo-image"}),H.jsx("span",{className:"footer-logo-text",children:"Pixel Journey"})]}),H.jsx("p",{className:"footer-description",children:"Explore the Pixel Journey ecosystem - a comprehensive NFT marketplace and gaming platform across multiple blockchains."})]}),H.jsxs("div",{className:"footer-section footer-center",children:[H.jsx("h3",{className:"footer-section-title",children:"PXJourney across Web3"}),H.jsxs("div",{className:"blockchain-grid",children:[H.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-eth",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[H.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/ethereum.svg",alt:"Ethereum",className:"blockchain-logo"}),H.jsx("span",{className:"blockchain-name",children:"Ethereum"})]}),H.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-polygon",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[H.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/polygon.jpeg",alt:"Polygon",className:"blockchain-logo"}),H.jsx("span",{className:"blockchain-name",children:"Polygon"})]}),H.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-base",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[H.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/base.jpg",alt:"Base",className:"blockchain-logo"}),H.jsx("span",{className:"blockchain-name",children:"Base"})]}),H.jsxs("a",{href:"https://nft.monbase.com/collections/66c4eb2ca339b05c5a660e44/detail",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[H.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/BSC.png",alt:"BNB Chain",className:"blockchain-logo"}),H.jsx("span",{className:"blockchain-name",children:"BNB Chain"})]})]}),H.jsx("div",{className:"bridge-section",children:H.jsx("a",{href:"https://bridge.mycloudwallet.com/",target:"_blank",rel:"noopener noreferrer",className:"bridge-link",children:"Bridge Now"})})]}),H.jsxs("div",{className:"footer-section footer-wax",children:[H.jsx("h3",{className:"footer-section-title",children:H.jsx("a",{href:"https://wax.io/",target:"_blank",rel:"noopener noreferrer",className:"wax-title-link",children:"PXJourney across WAX"})}),H.jsxs("div",{className:"wax-dapps-grid",children:[H.jsxs("a",{href:"https://market.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item purple-glow",children:[H.jsx("span",{className:"dapp-icon",children:"\ud83d\udecd\ufe0f"}),H.jsx("span",{className:"dapp-name",children:"PxMarket"})]}),H.jsxs("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item green-glow",children:[H.jsx("span",{className:"dapp-icon",children:"\ud83e\uddd1\u200d\ud83c\udf3e"}),H.jsx("span",{className:"dapp-name",children:"PxStaking"})]}),H.jsxs("a",{href:"https://lb.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item golden-glow",children:[H.jsx("span",{className:"dapp-icon",children:"\ud83c\udfc6"}),H.jsx("span",{className:"dapp-name",children:"PxLeaderboards"})]}),H.jsxs(s,{to:"/pxcrafting",className:"wax-dapp-item craft-glow",children:[H.jsx("span",{className:"dapp-icon",children:"\u267b\ufe0f"}),H.jsx("span",{className:"dapp-name",children:"PxCraft"})]})]}),H.jsx("div",{className:"journey-section",children:H.jsx(s,{to:"/journeymap",className:"journey-link",children:"Journey Map"})})]}),H.jsxs("div",{className:"footer-section footer-right",children:[H.jsx("h4",{className:"footer-title",children:"Quick Links"}),H.jsx("div",{className:"footer-links",children:e.map((e,t)=>H.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"footer-link",children:[H.jsx("span",{className:"footer-link-icon",children:e.icon}),e.title]},t))})]})]}),H.jsx("div",{className:"footer-bottom",children:H.jsxs("div",{className:"footer-bottom-content",children:[H.jsx("p",{className:"footer-copyright",children:"\xa9 2025 Pixel Journey. All rights reserved."}),H.jsx("div",{className:"footer-bottom-links",children:H.jsx("span",{className:"footer-note",children:"Requires a Pixal PFP to unlock full market access"})})]})})]})})},_n=r.memo(()=>{const e=l(),{settings:t}=ke(),[a,n]=i.useState("activity"),[r,s]=i.useState([]),[c,o]=i.useState([]),[d,h]=i.useState(null),[u,m]=i.useState(null),[p,f]=i.useState([]),[v,y]=i.useState([]),[g,b]=i.useState(!1),[N,w]=i.useState(null),[k,x]=i.useState(!1),C=async()=>{try{b(!0),w(null);const e=await $e.getRecentSales(50);s(e.map(e=>{const t=e.assets[0];return{sale_id:e.sale_id,asset_id:t?.asset_id||"",collection_name:t?.collection?.collection_name||"",schema_name:t?.schema?.schema_name||"",template_id:t?.template?.template_id||"",asset_name:t?.name||"",seller:e.seller||"",buyer:e.buyer||"",price:e.listing_price||"0",updated_at_time:e.updated_at_time||"",state:e.state||0,image:t?.data?.img||void 0,video:t?.data?.video||void 0}}))}catch(e){w("Failed to load activity data")}finally{b(!1)}},A=async()=>{try{b(!0),w(null);const e=await $e.getCollections({limit:20,whitelistOnly:!0});if(e.length>0){const t=e.slice(0,10).map(async e=>{try{const t=await $e.getCollectionStats(e.collection_name);return{collection_name:e.collection_name,assets:"0",burned:"0",templates:"0",schemas:"0",volume:t?.volume||"0",sales:t?.sales||"0",floor_price:t?.floor||"0"}}catch{return{collection_name:e.collection_name,assets:"0",burned:"0",templates:"0",schemas:"0",volume:"0",sales:"0",floor_price:"0"}}}),a=await Promise.all(t);o(a)}const t=await $e.getMarketStats();if(t&&t.results&&t.results.length>0){const e=t.results[t.results.length-1];h({total_sales:e.sales||"0",total_volume:e.volume||"0",total_assets:"0",active_listings:"0"})}const[a,n,i]=await Promise.all([$e.getNFTTradingStats(),$e.getTopCollectionsByVolume(10),$e.getRecentNFTTrades(20)]);a&&m({dailyVolume:a.dailyVolume||"0",dailySales:a.dailySales||0,totalTransactions:a.totalTransactions||0,activeListings:a.activeListings||0,averagePrice:a.averagePrice||"0",topCollectionsByVolume:n.map(e=>({collection_name:e.collection_name,volume_24h:"0",sales_24h:0,floor_price:"0",assets_count:"0"}))}),y(n.map(e=>({collection_name:e.collection_name,volume_24h:"0",sales_24h:0,floor_price:"0",assets_count:"0"}))||[]),f((i||[]).map(e=>({sale_id:e.sale_id,collection_name:e.collection_name||"",asset_name:String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"Unknown Asset"),price:String(e.listing_price||e.price?.amount||"0"),buyer:e.buyer||"",seller:e.seller||"",timestamp:e.updated_at_time||""})))}catch(e){w("Failed to load statistics data")}finally{b(!1)}},_=i.useCallback(async()=>{x(!0),"activity"===a?await C():await A(),x(!1)},[a]),S=i.useCallback(t=>{e(`/user-profile-lookup?user=${encodeURIComponent(t)}`)},[e]),P=i.useCallback(t=>{e(`/assets/${t}`)},[e]),T=i.useCallback(t=>{e(`/collections/${encodeURIComponent(t)}`)},[e]),$=i.useCallback(t=>{e(`/listings/${t}`)},[e]),F=i.useCallback(t=>{e(`/listings/${t}`)},[e]);i.useEffect(()=>{"activity"===a?C():A()},[a]);const E=e=>{if("string"==typeof e&&e.includes("WAX"))return e;const t=parseFloat(e)/1e8;return ae(t)},I=e=>{const t=parseInt(e);return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()},M=e=>new Date(1e3*parseInt(e)).toLocaleString();return H.jsxs("div",{className:"activity-stats-page",children:[H.jsxs("div",{className:"activity-stats-header",children:[H.jsx("h1",{className:"activity-stats-title",children:"Market Activity & Statistics"}),H.jsx("p",{className:"activity-stats-subtitle",children:"Real-time marketplace data and analytics"})]}),H.jsxs("div",{className:"activity-stats-tabs",children:[H.jsxs("button",{className:"tab-btn "+("activity"===a?"active":""),onClick:()=>n("activity"),children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M3 3v18h18"}),H.jsx("path",{d:"M7 12l4-4 4 4 6-6"})]}),"Activity Feed"]}),H.jsxs("button",{className:"tab-btn "+("stats"===a?"active":""),onClick:()=>n("stats"),children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),H.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),H.jsx("line",{x1:"15",y1:"11",x2:"15",y2:"15"})]}),"Statistics"]}),H.jsxs("button",{className:"refresh-btn "+(k?"refreshing":""),onClick:_,disabled:k,children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("polyline",{points:"23 4 23 10 17 10"}),H.jsx("polyline",{points:"1 20 1 14 7 14"}),H.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]}),k?"Refreshing...":"Refresh"]})]}),N&&H.jsxs("div",{className:"error-message",children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),H.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),N]}),"activity"===a&&H.jsxs("div",{className:"activity-content",children:[H.jsxs("div",{className:"section-header",children:[H.jsx("h2",{children:"Recent Sales"}),H.jsx("p",{children:"Latest NFT sales across all collections"})]}),g?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading recent sales..."})]}):H.jsxs("div",{className:"sales-feed",children:[r.map(e=>H.jsxs("div",{className:"sale-item clickable-sale",onClick:()=>$(e.sale_id),children:[H.jsx("div",{className:"sale-media",children:H.jsx(Rt,{imageUrl:e.image,videoUrl:e.video,alt:e.asset_name||`Asset #${e.asset_id}`,className:"sale-image",enableAnimations:t.enableAnimatedNFTs})}),H.jsxs("div",{className:"sale-info",children:[H.jsxs("div",{className:"sale-asset",children:[H.jsx("h4",{className:"clickable-asset-name",onClick:t=>{t.stopPropagation(),P(e.asset_id)},children:e.asset_name||`Asset #${e.asset_id}`}),H.jsx("p",{className:"sale-collection clickable-collection",onClick:t=>{t.stopPropagation(),T(e.collection_name)},children:e.collection_name})]}),H.jsxs("div",{className:"sale-details",children:[H.jsx("div",{className:"sale-price",children:E(e.price)}),H.jsx("div",{className:"sale-time",children:M(e.updated_at_time)}),H.jsx("div",{className:"sale-status",children:3===e.state?H.jsx("span",{className:"status-sold",children:"\u2705 Sold"}):2===e.state?H.jsx("span",{className:"status-canceled",children:"\u274c Canceled"}):(e.state,H.jsx("span",{className:"status-active",children:"\ud83d\udd04 Active"}))})]})]}),H.jsxs("div",{className:"sale-parties",children:[H.jsxs("div",{className:"sale-party",children:[H.jsx("span",{className:"party-label",children:"Seller:"}),H.jsx("span",{className:"party-name clickable",onClick:t=>{t.stopPropagation(),S(e.seller)},children:e.seller})]}),H.jsxs("div",{className:"sale-party",children:[H.jsx("span",{className:"party-label",children:"Buyer:"}),H.jsx("span",{className:"party-name clickable",onClick:t=>{t.stopPropagation(),S(e.buyer)},children:e.buyer})]}),H.jsxs("div",{className:"sale-party",children:[H.jsx("span",{className:"party-label",children:"Sale ID:"}),H.jsxs("span",{className:"sale-id-link clickable",onClick:t=>{t.stopPropagation(),$(e.sale_id)},title:"View sale details",children:[e.sale_id.slice(0,8),"..."]})]})]})]},e.sale_id)),0===r.length&&!g&&H.jsxs("div",{className:"empty-state",children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("path",{d:"M12 6v6l4 2"})]}),H.jsx("h3",{children:"No recent sales"}),H.jsx("p",{children:"No sales data available at the moment"})]})]})]}),"stats"===a&&H.jsxs("div",{className:"stats-content",children:[d&&H.jsxs("div",{className:"market-overview",children:[H.jsx("h2",{children:"Market Overview"}),H.jsxs("div",{className:"stats-grid",children:[H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:I(d.total_sales)}),H.jsx("div",{className:"stat-label",children:"Total Sales"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:E(d.total_volume)}),H.jsx("div",{className:"stat-label",children:"Total Volume"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:I(d.total_assets)}),H.jsx("div",{className:"stat-label",children:"Total Assets"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("div",{className:"stat-value",children:I(d.active_listings)}),H.jsx("div",{className:"stat-label",children:"Active Listings"})]})]})]}),u&&H.jsxs("div",{className:"nft-trading-stats-section",children:[H.jsx("h2",{children:"WAX NFT Trading Data"}),H.jsxs("div",{className:"nft-stats-grid",children:[H.jsxs("div",{className:"stat-card nft-card",children:[H.jsxs("div",{className:"stat-value",children:[u.dailyVolume," WAX"]}),H.jsx("div",{className:"stat-label",children:"24h Trading Volume"})]}),H.jsxs("div",{className:"stat-card nft-card",children:[H.jsx("div",{className:"stat-value",children:I(u.dailySales.toString())}),H.jsx("div",{className:"stat-label",children:"24h Sales"})]}),H.jsxs("div",{className:"stat-card nft-card",children:[H.jsx("div",{className:"stat-value",children:I(u.activeListings.toString())}),H.jsx("div",{className:"stat-label",children:"Active Listings"})]}),H.jsxs("div",{className:"stat-card nft-card",children:[H.jsxs("div",{className:"stat-value",children:[u.averagePrice," WAX"]}),H.jsx("div",{className:"stat-label",children:"Average Sale Price"})]})]}),v.length>0&&H.jsxs("div",{className:"top-collections-section",children:[H.jsx("h3",{children:"Top Collections by Volume"}),H.jsx("div",{className:"top-collections-grid",children:v.slice(0,6).map(e=>H.jsxs("div",{className:"collection-card",children:[H.jsx("div",{className:"collection-name",children:e.collection_name}),H.jsxs("div",{className:"collection-volume",children:[e.volume_24h," WAX"]}),H.jsxs("div",{className:"collection-sales",children:[e.sales_24h," sales"]}),H.jsxs("div",{className:"collection-floor",children:["Floor: ",e.floor_price," WAX"]})]},e.collection_name))})]}),p.length>0&&H.jsxs("div",{className:"recent-trades-section",children:[H.jsx("h3",{children:"Recent NFT Trades"}),H.jsx("div",{className:"recent-trades-list",children:p.slice(0,8).map(e=>H.jsxs("div",{className:"trade-item clickable-trade",onClick:()=>F(e.sale_id),children:[H.jsxs("div",{className:"trade-asset",children:[H.jsx("span",{className:"asset-name clickable-asset-name",onClick:t=>{t.stopPropagation(),F(e.sale_id)},children:e.asset_name}),H.jsx("span",{className:"collection-name clickable-collection",onClick:t=>{t.stopPropagation(),T(e.collection_name)},children:e.collection_name})]}),H.jsxs("div",{className:"trade-price",children:[e.price," WAX"]}),H.jsx("div",{className:"trade-time",children:M(e.timestamp)})]},e.sale_id))})]})]}),H.jsxs("div",{className:"section-header",children:[H.jsx("h2",{children:"Collection Statistics"}),H.jsx("p",{children:"Performance metrics for top collections"})]}),g?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading collection statistics..."})]}):H.jsxs("div",{className:"collections-table",children:[H.jsxs("div",{className:"table-header",children:[H.jsx("div",{className:"table-cell",children:"Collection"}),H.jsx("div",{className:"table-cell",children:"Assets"}),H.jsx("div",{className:"table-cell",children:"Volume"}),H.jsx("div",{className:"table-cell",children:"Sales"}),H.jsx("div",{className:"table-cell",children:"Floor Price"})]}),c.map(e=>H.jsxs("div",{className:"table-row",children:[H.jsx("div",{className:"table-cell collection-name",children:e.collection_name}),H.jsx("div",{className:"table-cell",children:I(e.assets)}),H.jsx("div",{className:"table-cell",children:E(e.volume)}),H.jsx("div",{className:"table-cell",children:I(e.sales)}),H.jsx("div",{className:"table-cell",children:E(e.floor_price)})]},e.collection_name)),0===c.length&&!g&&H.jsxs("div",{className:"empty-state",children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),H.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),H.jsx("line",{x1:"15",y1:"11",x2:"15",y2:"15"})]}),H.jsx("h3",{children:"No statistics available"}),H.jsx("p",{children:"Statistics data is currently unavailable"})]})]})]})]})});_n.displayName="ActivityStats";const Sn=new class{constructor(){t(this,"subscriptions",new Map),t(this,"pollInterval",null),t(this,"isPolling",!1),t(this,"POLL_INTERVAL",3e4),t(this,"MAX_REQUESTS_PER_MINUTE",30),t(this,"REQUEST_DELAY",2e3),t(this,"lastRequestTime",0),t(this,"requestCount",0),t(this,"requestResetTime",Date.now()+6e4),t(this,"auctionCache",new Map),t(this,"CACHE_DURATION",15e3)}subscribe(e,t){this.subscriptions.has(e)||this.subscriptions.set(e,[]);const a={auction_id:e,callback:t};return this.subscriptions.get(e).push(a),this.startPolling(),()=>{const t=this.subscriptions.get(e);if(t){const n=t.indexOf(a);n>-1&&t.splice(n,1),0===t.length&&this.subscriptions.delete(e)}0===this.subscriptions.size&&this.stopPolling()}}startPolling(){this.isPolling||(this.isPolling=!0,this.pollInterval=setInterval(()=>{this.pollAuctionUpdates()},this.POLL_INTERVAL))}stopPolling(){this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.isPolling=!1}async pollAuctionUpdates(){const e=Array.from(this.subscriptions.keys());if(0!==e.length)try{this.clearExpiredCache(),(await this.fetchAuctionUpdates(e)).forEach(e=>{const t=this.subscriptions.get(e.auction_id);t&&t.forEach(t=>{try{t.callback(e)}catch(a){ee.logError("AuctionService.pollAuctionUpdates.callback",a,{auctionId:e.auction_id})}})})}catch(t){ee.logError("AuctionService.pollAuctionUpdates",t,{auctionIds:e})}else this.stopPolling()}async fetchAuctionUpdates(e){const t=[],a=Date.now();a>this.requestResetTime&&(this.requestCount=0,this.requestResetTime=a+6e4);for(const i of e){const e=this.auctionCache.get(i);if(e&&a-e.timestamp<this.CACHE_DURATION){t.push(e.data);continue}if(this.requestCount>=this.MAX_REQUESTS_PER_MINUTE){re.warn("Rate limit reached, skipping auction","AUCTION",{auctionId:i}),e&&t.push(e.data);continue}const r=a-this.lastRequestTime;r<this.REQUEST_DELAY&&await new Promise(e=>setTimeout(e,this.REQUEST_DELAY-r));try{const e=`${$e.getCurrentAtomicEndpoint()}/atomicmarket/v1/auctions/${i}`,a=await $e.fetchWithRetry(e),n=await a.json();if(this.requestCount++,this.lastRequestTime=Date.now(),n.success&&n.data){const e=n.data,a={auction_id:i,current_bid:e.current_bid,bidder:e.current_bidder,end_time:e.end_time,status:this.getAuctionStatus(e),bid_count:e.bid_count||0,last_bid_time:e.updated_at_time};this.auctionCache.set(i,{data:a,timestamp:Date.now()}),t.push(a)}}catch(n){ee.logError("AuctionService.fetchAuctionUpdates.single",n,{auctionId:i}),e&&t.push(e.data)}}return t}getAuctionStatus(e){const t=Date.now(),a=new Date(e.end_time+"Z").getTime();return 3===e.state?"cancelled":t>a?"ended":"active"}async getAuctionBids(e){try{const t=await $e.getAuctions({limit:1});if(!t.success||!t.data.length)return[];const a=t.data[0].assets.map(e=>e.asset_id);return(await this.fetchAuctionBidHistory(e,a)).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())}catch(t){return ee.logError("AuctionService.getAuctionBids",t,{auctionId:e}),[]}}async fetchAuctionBidHistory(e,t){try{const t=[ue.WAX_CHAIN.EOSRIO,ue.WAX_CHAIN.WAXSWEDEN,ue.HYPERION[2]];for(const n of t)try{const t=await fetch(`${n}/v2/history/get_actions?account=atomicmarket&filter=atomicmarket:auctionbid&limit=100&sort=desc&after=${new Date(Date.now()-6048e5).toISOString()}`,{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)continue;const a=await t.json(),i=[];if(a.actions)for(const n of a.actions)n.act?.data?.auction_id===e&&i.push({bidder:n.act.data.bidder||n.act.authorization?.[0]?.actor||"unknown",bid_amount:n.act.data.bid||"0.0000 WAX",timestamp:n.timestamp,transaction_id:n.trx_id});return i}catch(a){re.warn("Failed to fetch from endpoint","AUCTION",{endpoint:n,error:a});continue}return[]}catch(n){return ee.logError("AuctionService.fetchAuctionBidHistory",n,{auctionId:e,assetIds:t}),[]}}getTimeRemaining(e){const t=Date.now();let a;if(!e)return{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};if(e.includes("T")&&!e.endsWith("Z"))a=new Date(e+"Z").getTime();else if(e.includes("T")&&e.endsWith("Z"))a=new Date(e).getTime();else{const t=parseInt(e);a=isNaN(t)?new Date(e).getTime():t>1e12?t:1e3*t}if(isNaN(a))return re.warn("Invalid endTime format","AUCTION",{endTime:e}),{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};const n=a-t;return n<=0?{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0}:{total:n,days:Math.floor(n/864e5),hours:Math.floor(n%864e5/36e5),minutes:Math.floor(n%36e5/6e4),seconds:Math.floor(n%6e4/1e3),isExpired:!1}}formatTimeRemaining(e){const t=this.getTimeRemaining(e);return t.isExpired?"Auction ended":t.days>0?`${t.days}d ${t.hours}h ${t.minutes}m`:t.hours>0?`${t.hours}h ${t.minutes}m ${t.seconds}s`:t.minutes>0?`${t.minutes}m ${t.seconds}s`:`${t.seconds}s`}isEndingSoon(e){const t=this.getTimeRemaining(e);return!t.isExpired&&t.total<3e5}clearExpiredCache(){const e=Date.now();for(const[t,a]of this.auctionCache.entries())e-a.timestamp>2*this.CACHE_DURATION&&this.auctionCache.delete(t)}cleanup(){this.subscriptions.clear(),this.stopPolling(),this.auctionCache.clear()}},Pn=r.memo(()=>{const e=l(),{isConnected:t,account:a,session:n}=Ta(),{showSuccess:r,showError:s}=We(),[c,o]=i.useState([]),[d,h]=i.useState(!0),[u,m]=i.useState(!1),[p,f]=i.useState(null),[v,y]=i.useState(1),[g,b]=i.useState(!0),[N,w]=i.useState(1),[k,x]=i.useState("all"),[C,A]=i.useState("created_desc"),[_,S]=i.useState(""),[P,T]=i.useState(""),[$,F]=i.useState(!1),[E,I]=i.useState(!1),[M,L]=i.useState(!1),[W,R]=i.useState(null),[O,B]=i.useState(""),[j,D]=i.useState(!1),[U,X]=i.useState(!1),[z,J]=i.useState(new Set),[q,V]=i.useState([]),[G,Y]=i.useState(!1),[K,Q]=i.useState(""),[Z,ee]=i.useState(0),[te,ne]=i.useState(1),[ie,re]=i.useState(0),[le,ce]=i.useState(0),[oe,de]=i.useState(""),[he,ue]=i.useState([]),me=i.useCallback(()=>{switch(C){case"price_asc":case"price_desc":return"price";default:return"created"}},[C]),pe=i.useCallback(()=>{switch(C){case"price_asc":case"created_asc":return"asc";default:return"desc"}},[C]),fe=i.useCallback(async(e=1,t=!1)=>{try{1===e?(h(!0),y(1),b(!0)):m(!0),f(null);const a=await $e.getAuctions({state:1,limit:36,offset:36*(e-1),sort:me(),order:pe(),hide_empty_auctions:$,search:_||void 0,collection_name:P||void 0,collection_blacklist:"flinttffunko,onlyfanzgaly,farmerpetsco,fantaspeop",seller_blacklist:"dximg.wam,xpvrs.wam,5rrrc.wam,nnmnmnmnn.gm",symbol:"WAX"});if(!a.success||!a.data)throw new Error("Failed to fetch auctions data");const n=a.data.map(e=>({auction_id:e.auction_id,asset_id:e.asset_id,seller:e.seller,price:e.price,end_time:e.end_time,collection_name:e.collection_name,template_id:e.template_id,asset_name:e.asset_name,image:e.image,current_bid:e.current_bid||null,bidder:e.bidder||null,collection_info:void 0}));o(t&&e>1?e=>[...e,...n]:n);const i=36,r=n.length===i;b(r),y(e),w(r?e+1:e)}catch(a){se.error("Error loading auctions","Auctions",a),f("Failed to load auctions. Please try again later.")}finally{h(!1),m(!1)}},[me,pe,$,_,P]),ve=i.useCallback(()=>{!u&&g&&fe(v+1,!0)},[fe,v,g,u]),ye=i.useCallback(()=>{y(1),b(!0),fe(1,!1)},[fe]);i.useEffect(()=>{ye()},[ye,k,_,P,$,C]),i.useEffect(()=>{(async()=>{try{const e=await $e.getCollections({limit:50,whitelistOnly:!0});if(e&&e.length>0){const t=e.map(e=>({collection_name:e.collection_name,name:e.name||e.collection_name}));ue(t)}}catch(e){se.error("Failed to load collections","Auctions",e),ue([{collection_name:"pixeljourney",name:"Pixel Journey"},{collection_name:"friedfactory",name:"Fried Factory"}])}})()},[]);const ge=e=>{const t=parseFloat(e)/1e8;return ae(t)},be=i.useMemo(()=>c.filter(e=>{if(_){const t=_.toLowerCase();if(!(e.asset_name?.toLowerCase().includes(t)||e.asset_id?.toString().includes(t)||e.collection_name?.toLowerCase().includes(t)))return!1}return!(P&&e.collection_name!==P||!(!$||e.bidder&&e.current_bid&&"0"!==e.current_bid))}),[c,_,P,$]);i.useEffect(()=>{const e=[];return be.forEach(t=>{const a=Sn.subscribe(t.auction_id,e=>{o(t=>t.map(t=>t.auction_id===e.auction_id?{...t,current_bid:e.current_bid||t.current_bid,bidder:e.bidder||t.bidder,end_time:e.end_time}:t))});e.push(a)}),()=>{e.forEach(e=>e())}},[be]);const Ne=()=>7*Z*24*60*60+24*te*60*60+60*ie*60+60*le,we=(e,t)=>{const a=Math.max(0,Math.min(t,ke(e)));switch(e){case"weeks":ee(a);break;case"days":ne(a);break;case"hours":re(a);break;case"minutes":ce(a)}},ke=e=>{switch(e){case"weeks":return 4;case"days":return 30;case"hours":return 23;case"minutes":return 59;default:return 0}};return H.jsxs("div",{className:"auctions-page",children:[H.jsx("div",{className:"page-header",children:H.jsxs("div",{className:"header-content",children:[H.jsxs("div",{className:"header-text",children:[H.jsx("h1",{children:"Auctions"}),H.jsx("p",{children:"Discover and bid on unique NFTs from the WAX ecosystem"})]}),H.jsx("button",{className:"create-auction-btn",onClick:()=>{I(!0),a&&(async()=>{if(a){Y(!0);try{const e=`${$e.atomicAssetsAPI}/atomicassets/v1/assets?owner=${a}&limit=100`,t=await $e.fetchWithRetry(e),n=await t.json();if(n.success&&n.data){const e=n.data.map(e=>({asset_id:e.asset_id,name:e.name||`${e.collection.collection_name} #${e.template_mint||e.asset_id}`,collection_name:e.collection.collection_name,image:e.data?.img?`https://ipfs.io/ipfs/${e.data.img}`:void 0,template_mint:e.template_mint,isSelected:!1}));V(e)}}catch(e){se.error("Error loading user assets","Auctions",e),V([])}finally{Y(!1)}}})()},children:"Create Auction"})]})}),H.jsxs("div",{className:"auctions-controls",children:[H.jsx("div",{className:"search-section",children:H.jsxs("div",{className:"search-input-wrapper",children:[H.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("input",{type:"text",placeholder:"Search auctions by name or asset ID...",value:_,onChange:e=>S(e.target.value),className:"search-input"})]})}),H.jsxs("div",{className:"filters-section",children:[H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{children:"Collection:"}),H.jsxs("select",{value:P,onChange:e=>T(e.target.value),className:"collection-filter",children:[H.jsx("option",{value:"",children:"All Collections"}),he.map(e=>H.jsx("option",{value:e.collection_name,children:e.name},e.collection_name))]})]}),H.jsxs("div",{className:"filter-group",children:[H.jsx("label",{children:"Sort by:"}),H.jsxs("select",{value:C,onChange:e=>A(e.target.value),className:"sort-filter",children:[H.jsx("option",{value:"price_asc",children:"Price: Low to High"}),H.jsx("option",{value:"price_desc",children:"Price: High to Low"}),H.jsx("option",{value:"created_desc",children:"Newest First"}),H.jsx("option",{value:"created_asc",children:"Oldest First"})]})]}),H.jsx("div",{className:"filter-group",children:H.jsxs("label",{className:"checkbox-label",children:[H.jsx("input",{type:"checkbox",checked:$,onChange:e=>F(e.target.checked)}),H.jsx("span",{className:"checkmark"}),"Hide auctions without bids"]})})]}),H.jsxs("div",{className:"auctions-filters",children:[H.jsx("button",{className:"filter-btn "+("all"===k?"active":""),onClick:()=>x("all"),children:"All Auctions"}),H.jsx("button",{className:"filter-btn "+("ending-soon"===k?"active":""),onClick:()=>x("ending-soon"),children:"Ending Soon"}),H.jsx("button",{className:"filter-btn "+("new"===k?"active":""),onClick:()=>x("new"),children:"New Auctions"})]})]}),d&&H.jsxs("div",{className:"loading-container",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading auctions..."})]}),p&&H.jsxs("div",{className:"error-container",children:[H.jsx("p",{className:"error-message",children:p}),H.jsx("button",{onClick:()=>fe(),className:"retry-btn",children:"Try Again"})]}),!d&&!p&&0===be.length&&c.length>0&&H.jsxs("div",{className:"empty-state",children:[H.jsx("h3",{children:"No Matching Auctions"}),H.jsx("p",{children:"No auctions match your current filters. Try adjusting your search criteria."})]}),!d&&!p&&0===c.length&&H.jsxs("div",{className:"empty-state",children:[H.jsx("h3",{children:"No Active Auctions"}),H.jsx("p",{children:"There are currently no active auctions. Check back later!"})]}),!d&&!p&&be.length>0&&H.jsx("div",{className:"auctions-grid",children:be.map(n=>H.jsxs("div",{className:"auction-card clickable-card",onClick:()=>e(`/auctions/${n.auction_id}`),children:[H.jsxs("div",{className:"auction-image",children:[H.jsx(Rt,{imageUrl:n.image,videoUrl:n.video,alt:n.asset_name,className:"auction-media",enableAnimations:!0}),H.jsx("div",{className:"auction-timer",children:Sn.formatTimeRemaining(n.end_time)})]}),H.jsxs("div",{className:"auction-info",children:[H.jsx("h3",{className:"auction-title",children:n.asset_name}),H.jsxs("div",{className:"auction-collection-info",children:[n.collection_info?.img&&H.jsx("img",{src:n.collection_info.img,alt:n.collection_info.name,className:"collection-avatar"}),H.jsxs("div",{className:"collection-details",children:[H.jsx("p",{className:"collection-name",children:n.collection_info?.name||n.collection_name}),n.collection_info?.description&&H.jsx("p",{className:"collection-description",children:n.collection_info.description.length>60?`${n.collection_info.description.substring(0,60)}...`:n.collection_info.description})]})]}),H.jsxs("div",{className:"seller-info",children:[H.jsx("span",{className:"label",children:"Seller: "}),H.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(n.seller)}`)},className:"seller-account",children:n.seller})]}),H.jsxs("div",{className:"auction-pricing",children:[H.jsxs("div",{className:"current-bid",children:[H.jsx("span",{className:"label",children:n.current_bid?"Current Bid:":"Starting Price:"}),H.jsx("span",{className:"price",children:n.current_bid?ge(n.current_bid):ge(n.price)})]}),n.bidder&&H.jsxs("div",{className:"bidder",children:[H.jsx("span",{className:"label",children:"Top Bidder:"}),H.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(n.bidder||"")}`)},className:"account",children:n.bidder})]})]}),H.jsxs("div",{className:"auction-actions",children:[H.jsx("button",{className:"bid-btn",onClick:e=>{e.stopPropagation(),(e=>{t&&a?e.seller!==a?(R(e),B(""),L(!0)):s("Invalid Action","You cannot bid on your own auction"):s("Wallet Required","Please connect your wallet to place bids")})(n)},disabled:!t||n.seller===a,children:t?n.seller===a?"Your Auction":"Place Bid":"Connect Wallet"}),H.jsx("button",{className:"view-btn",onClick:t=>{t.stopPropagation(),(t=>{e(`/assets/${t.asset_id}`)})(n)},children:"View Details"})]})]})]},n.auction_id))}),!d&&!p&&be.length>0&&H.jsxs("div",{className:"pagination-container",children:[g&&H.jsx("button",{className:"load-more-btn",onClick:ve,disabled:u,children:u?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"loading-spinner small"}),"Loading more..."]}):"Load More Auctions"}),H.jsxs("div",{className:"pagination-info",children:[H.jsxs("span",{children:["Page ",v," of ",N]}),H.jsxs("span",{children:[be.length," auctions loaded"]})]})]}),H.jsxs("div",{className:"coming-soon-notice",children:[H.jsx("h3",{children:"\ud83d\udea7 Integration in Progress"}),H.jsx("p",{children:"Full AtomicMarket auction integration is currently being implemented. This page will soon display live auction data and allow bidding functionality."})]}),M&&W&&H.jsx("div",{className:"modal-overlay",onClick:()=>L(!1),children:H.jsxs("div",{className:"bid-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"bid-modal-header",children:[H.jsx("h2",{children:"Place Your Bid"}),H.jsx("button",{className:"close-btn",onClick:()=>L(!1),children:"\xd7"})]}),H.jsxs("div",{className:"bid-modal-body",children:[H.jsxs("div",{className:"bid-auction-summary",children:[H.jsxs("div",{className:"bid-asset-image",children:[H.jsx(Rt,{imageUrl:W.image,videoUrl:W.video,alt:W.asset_name,className:"bid-modal-media",enableAnimations:!0}),H.jsx("div",{className:"auction-timer-small",children:Sn.formatTimeRemaining(W.end_time)})]}),H.jsxs("div",{className:"bid-asset-info",children:[H.jsx("h3",{children:W.asset_name}),H.jsxs("div",{className:"bid-collection-info",children:[W.collection_info?.img&&H.jsx("img",{src:W.collection_info.img,alt:W.collection_info.name,className:"collection-avatar-small"}),H.jsx("span",{className:"collection-name",children:W.collection_info?.name||W.collection_name})]}),H.jsxs("div",{className:"bid-current-info",children:[H.jsxs("div",{className:"current-bid-display",children:[H.jsx("span",{className:"label",children:W.current_bid?"Current Bid":"Starting Price"}),H.jsx("span",{className:"amount",children:ge(W.current_bid||W.price)})]}),W.bidder&&H.jsxs("div",{className:"current-bidder",children:[H.jsx("span",{className:"label",children:"Leading Bidder"}),H.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(W.bidder||"")}`)},className:"bidder-account",children:W.bidder})]})]})]})]}),H.jsx("div",{className:"bid-input-section",children:H.jsxs("div",{className:"bid-form-group",children:[H.jsx("label",{children:"Your Bid Amount"}),H.jsxs("div",{className:"bid-input-wrapper",children:[H.jsx("input",{type:"number",value:O,onChange:e=>B(e.target.value),placeholder:"0.0000",step:"0.0001",min:W.current_bid&&W.bidder?parseFloat(W.current_bid)/1e8+1e-4:parseFloat(W.price)/1e8,className:"bid-amount-input",disabled:j}),H.jsx("span",{className:"currency-label",children:"WAX"})]}),H.jsxs("div",{className:"bid-requirements",children:[H.jsx("p",{className:"minimum-bid",children:W.current_bid&&W.bidder?`Minimum: ${ae(parseFloat(W.current_bid)/1e8+1e-4)}`:`Starting Price: ${ae(parseFloat(W.price)/1e8)}`}),O&&H.jsxs("p",{className:"bid-total",children:["Total: ",ae(parseFloat(O))]})]})]})}),H.jsxs("div",{className:"previous-bids-section",children:[H.jsx("h4",{children:"Bid History"}),H.jsx("div",{className:"bids-list",children:W.bidder?H.jsxs("div",{className:"bid-item",children:[H.jsxs("div",{className:"bidder-info",children:[H.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(W.bidder||"")}`)},className:"bidder",children:W.bidder}),H.jsx("span",{className:"bid-time",children:"Current leading bid"})]}),H.jsx("span",{className:"bid-amount",children:ge(W.current_bid||W.price)})]}):H.jsx("div",{className:"no-bids",children:H.jsx("p",{children:"No bids yet - be the first to bid!"})})})]}),H.jsxs("div",{className:"bid-notice",children:[H.jsx("div",{className:"notice-icon",children:"\ud83d\udca1"}),H.jsx("div",{className:"notice-text",children:H.jsxs("p",{children:[H.jsx("strong",{children:"Important:"})," Ensure you have sufficient WAX balance for your bid. Bids are binding and cannot be cancelled."]})})]})]}),H.jsxs("div",{className:"bid-modal-footer",children:[H.jsx("button",{className:"cancel-bid-btn",onClick:()=>L(!1),disabled:j,children:"Cancel"}),H.jsx("button",{className:"submit-bid-btn",onClick:async()=>{if(!W||!n||!a)return void s("Error","Please connect your wallet first");const e=parseFloat(O);if(isNaN(e)||e<=0)return void s("Invalid Bid","Please enter a valid bid amount");const t=parseFloat(W.current_bid||W.price)/1e8,i=W.current_bid&&W.bidder;if(i&&e<=t)s("Invalid Bid",`Bid must be higher than current bid of ${ae(t)}`);else if(!i&&e<t)s("Invalid Bid",`Bid must be at least the starting price of ${ae(t)}`);else{D(!0);try{const t=`${e.toFixed(8)} WAX`,i={account:"atomicmarket",name:"auctionbid",authorization:[{actor:a,permission:n.permission}],data:{bidder:a,auction_id:W.auction_id,bid:t,taker_marketplace:"market.pxj"}};await n.transact({actions:[i]})&&(r("Bid Placed",`Successfully placed bid of ${ae(e)}`),L(!1),B(""),R(null),fe())}catch(l){se.error("Error placing bid","Auctions",l);const e=l instanceof Error?l.message:"Failed to place bid. Please try again.";s("Bid Failed",e)}finally{D(!1)}}},disabled:j||!O||(W.current_bid&&W.bidder?parseFloat(O)<=parseFloat(W.current_bid)/1e8:parseFloat(O)<parseFloat(W.price)/1e8),children:j?H.jsxs(H.Fragment,{children:[H.jsx("span",{className:"loading-spinner-small"}),"Placing Bid..."]}):`Place Bid \u2022 ${O||"0.0000"} WAX`})]})]})}),E&&H.jsx("div",{className:"modal-overlay auction-modal",onClick:()=>I(!1),children:H.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Create Auction"}),H.jsx("button",{className:"close-btn",onClick:()=>I(!1),children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsx("div",{className:"asset-selection-section",children:H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Select Assets to Auction"}),H.jsx("div",{className:"asset-selection-container",children:G?H.jsxs("div",{className:"loading-assets",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("span",{children:"Loading your assets..."})]}):q.length>0?H.jsx("div",{className:"assets-grid",children:q.map(e=>H.jsxs("div",{className:"asset-item "+(z.has(e.asset_id)?"selected":""),onClick:()=>(e=>{const t=new Set(z);t.has(e)?t.delete(e):t.add(e),J(t)})(e.asset_id),children:[H.jsxs("div",{className:"asset-image",children:[H.jsx(Rt,{imageUrl:Qt(e),videoUrl:Zt(e),alt:e.name||`Asset #${e.asset_id}`,className:"asset-media",enableAnimations:!0,loading:"lazy"}),z.has(e.asset_id)&&H.jsx("div",{className:"selection-indicator",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M9,20.42l-6.21,-6.21l2.83,-2.83L9,14.77l9.88,-9.89l2.83,2.83L9,20.42z"})})})]}),H.jsxs("div",{className:"asset-info",children:[H.jsx("div",{className:"asset-name",children:e.name||`Asset #${e.asset_id}`}),H.jsx("div",{className:"asset-collection",children:e.collection_name}),e.template_mint&&H.jsxs("div",{className:"asset-mint-info",children:["Mint #",e.template_mint]})]})]},e.asset_id))}):H.jsxs("div",{className:"no-assets",children:[H.jsx("svg",{className:"no-assets-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M20,7l-8,-4l-8,4m16,0l-8,4m8,-4v10l-8,4m0,-10L4,7m8,4v10M4,7v10l8,4"})}),H.jsx("h3",{children:"No Assets Found"}),H.jsx("p",{children:"You don't have any assets to auction. Visit the marketplace to acquire some NFTs first."})]})}),z.size>0&&H.jsx("div",{className:"selection-summary",children:H.jsxs("span",{children:[z.size," asset",z.size>1?"s":""," selected"]})})]})}),H.jsxs("div",{className:"auction-form-section",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Starting Price (WAX)"}),H.jsx("input",{type:"number",placeholder:"0.0000",step:"0.0001",min:"0",value:K,onChange:e=>Q(e.target.value),className:"form-input"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Auction Duration"}),H.jsxs("div",{className:"duration-inputs",children:[H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Weeks"}),H.jsx("input",{type:"number",min:"0",max:"4",value:Z,onChange:e=>we("weeks",parseInt(e.target.value)||0),className:"duration-input"})]}),H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Days"}),H.jsx("input",{type:"number",min:"0",max:"30",value:te,onChange:e=>we("days",parseInt(e.target.value)||0),className:"duration-input"})]}),H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Hours"}),H.jsx("input",{type:"number",min:"0",max:"23",value:ie,onChange:e=>we("hours",parseInt(e.target.value)||0),className:"duration-input"})]}),H.jsxs("div",{className:"duration-field",children:[H.jsx("label",{className:"duration-label",children:"Minutes"}),H.jsx("input",{type:"number",min:"0",max:"59",value:le,onChange:e=>we("minutes",parseInt(e.target.value)||0),className:"duration-input"})]})]}),H.jsxs("div",{className:"duration-summary",children:[H.jsx("span",{className:"duration-display",children:(()=>{const e=[];return Z>0&&e.push(`${Z} week${Z>1?"s":""}`),te>0&&e.push(`${te} day${te>1?"s":""}`),ie>0&&e.push(`${ie} hour${ie>1?"s":""}`),le>0&&e.push(`${le} minute${le>1?"s":""}`),0===e.length?"No duration set":e.join(", ")})()}),H.jsxs("span",{className:"duration-total",children:["Total: ",Math.floor(Ne()/3600),"h ",Math.floor(Ne()%3600/60),"m"]})]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Memo (Optional)"}),H.jsx("textarea",{placeholder:"Add a description for your auction",className:"form-textarea",rows:3,value:oe,onChange:e=>de(e.target.value)})]})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"cancel-btn",onClick:()=>I(!1),children:"Cancel"}),H.jsx("button",{className:"create-btn",onClick:async()=>{if(0===z.size)return void s("No Assets Selected","Please select at least one asset to auction");if(!K||parseFloat(K)<=0)return void s("Invalid Price","Please enter a valid starting price");const e=Ne();if(e<3600)s("Invalid Duration","Auction duration must be at least 1 hour");else if(e>2592e3)s("Invalid Duration","Auction duration cannot exceed 30 days");else try{X(!0);const t=Array.from(z).map(e=>parseInt(e)),i=`${parseFloat(K).toFixed(8)} WAX`,s=[{account:"atomicmarket",name:"announceauct",authorization:[{actor:a||"",permission:n?.permission||"active"}],data:{seller:a||"",asset_ids:t,starting_bid:i,duration:e,maker_marketplace:"market.pxj"}}];n&&await n.transact({actions:s}),r("Auction Created",`Successfully created auction for ${z.size} asset(s). Remember to transfer your assets to the atomicmarket contract to activate the auction.`),I(!1),J(new Set),Q(""),ee(0),ne(1),re(0),ce(0),de(""),fe()}catch(t){se.error("Failed to create auction","Auctions",t),s("Auction Creation Failed",t instanceof Error?t.message:"Failed to create auction")}finally{X(!1)}},disabled:0===z.size||!K||parseFloat(K)<=0||U,children:U?H.jsxs(H.Fragment,{children:[H.jsx("span",{className:"loading-spinner-small"}),"Creating Auction..."]}):"Create Auction"+(z.size>0?` (${z.size} asset${z.size>1?"s":""})`:"")})]})]})})]})}),Tn=()=>{const{id:e}=o(),t=l(),{isConnected:a,account:n,session:r}=Ta(),{showSuccess:s,showError:c}=We(),[d,h]=i.useState(null),[u,m]=i.useState(!0),[p,f]=i.useState(null),[v,y]=i.useState(!1),[g,b]=i.useState(""),[N,w]=i.useState(!1),k=i.useCallback(async()=>{if(e){m(!0),f(null);try{const t=await $e.getAuction(e);if(!t.success||!t.data)return void f("Auction not found");h(t.data)}catch(t){f("Failed to load auction details")}finally{m(!1)}}},[e]);i.useEffect(()=>{e&&k()},[e,k]),i.useEffect(()=>{if(!d)return;const e=Sn.subscribe(d.auction_id,e=>{h(t=>t?{...t,current_bid:e.current_bid||t.current_bid,bidder:e.bidder||t.bidder,end_time:e.end_time}:null)});return()=>e()},[d]);const x=e=>`${(parseFloat(e)/1e8).toFixed(4)} WAX`,C=e=>{t(`/user-profile-lookup?user=${encodeURIComponent(e)}`)};if(u)return H.jsx("div",{className:"auction-detail-page",children:H.jsxs("div",{className:"loading-container",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading auction details..."})]})});if(p||!d)return H.jsx("div",{className:"auction-detail-page",children:H.jsxs("div",{className:"error-container",children:[H.jsx("h2",{children:"Auction Not Found"}),H.jsx("p",{children:p||"The requested auction could not be found."}),H.jsx("button",{className:"btn-primary",onClick:()=>t("/auctions"),children:"Back to Auctions"})]})});const A=(_=d.end_time,Sn.formatTimeRemaining(_));var _;const S="Auction ended"===A,P=d.current_bid?x(d.current_bid):x(d.price);return H.jsxs("div",{className:"auction-detail-page",children:[H.jsxs("div",{className:"auction-detail-container",children:[H.jsx("button",{className:"back-button",onClick:()=>t("/auctions"),children:"\u2190 Back to Auctions"}),H.jsxs("div",{className:"auction-detail-content",children:[H.jsxs("div",{className:"auction-image-section",children:[H.jsx("div",{className:"auction-image-container",children:H.jsx(Rt,{imageUrl:d.image?`${ue.IPFS.GATEWAYS[0]}${d.image}`:void 0,videoUrl:d.video?`${ue.IPFS.GATEWAYS[0]}${d.video}`:void 0,alt:d.asset_name||"NFT",className:"auction-image",enableAnimations:!0})}),H.jsxs("div",{className:"auction-basic-info",children:[H.jsx("h1",{className:"auction-title",children:d.asset_name||`Asset #${d.asset_id||"Unknown"}`}),H.jsxs("div",{className:"auction-collection",children:["Collection: ",d.collection_name||"Unknown"]}),H.jsxs("div",{className:"auction-id",children:["Auction ID: ",d.auction_id]})]})]}),H.jsxs("div",{className:"auction-info-section",children:[H.jsxs("div",{className:"auction-status",children:[H.jsx("div",{className:"status-badge "+(S?"ended":"active"),children:S?"Ended":"Active"}),!S&&H.jsxs("div",{className:"time-remaining",children:[H.jsx("span",{className:"time-label",children:"Time Remaining:"}),H.jsx("span",{className:"time-value",children:A})]})]}),H.jsx("div",{className:"price-section",children:H.jsxs("div",{className:"current-price",children:[H.jsx("span",{className:"price-label",children:d.current_bid?"Current Bid:":"Starting Price:"}),H.jsx("span",{className:"price-value",children:P})]})}),H.jsxs("div",{className:"participants-section",children:[H.jsxs("div",{className:"seller-info",children:[H.jsx("span",{className:"participant-label",children:"Seller:"}),H.jsx("button",{className:"participant-link",onClick:()=>C(d.seller),children:d.seller})]}),d.bidder&&H.jsxs("div",{className:"bidder-info",children:[H.jsx("span",{className:"participant-label",children:"Top Bidder:"}),H.jsx("button",{className:"participant-link",onClick:()=>C(d.bidder||""),children:d.bidder})]})]}),H.jsx("div",{className:"auction-actions",children:!S&&H.jsx("button",{className:"btn-primary bid-button",onClick:()=>{a&&n?d?.seller!==n?(b(""),y(!0)):c("Invalid Action","You cannot bid on your own auction"):c("Wallet Required","Please connect your wallet to place bids")},disabled:!a||d.seller===n,children:a?d.seller===n?"Your Auction":"Place Bid":"Connect Wallet"})})]})]})]}),v&&H.jsx("div",{className:"modal-overlay",onClick:()=>y(!1),children:H.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h3",{children:"Place Bid"}),H.jsx("button",{className:"modal-close",onClick:()=>y(!1),children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"auction-summary",children:[H.jsx(Rt,{imageUrl:d.image?`${ue.IPFS.GATEWAYS[0]}${d.image}`:void 0,videoUrl:d.video?`${ue.IPFS.GATEWAYS[0]}${d.video}`:void 0,alt:d.asset_name||"NFT",className:"modal-nft-image",enableAnimations:!0}),H.jsxs("div",{className:"modal-nft-info",children:[H.jsx("h4",{children:d.asset_name||`Asset #${d.asset_id||"Unknown"}`}),H.jsxs("p",{children:["Current: ",P]})]})]}),d.bidder&&H.jsxs("div",{className:"current-bidder",children:[H.jsx("span",{className:"label",children:"Leading Bidder"}),H.jsx("button",{className:"bidder-account",onClick:()=>C(d.bidder),children:d.bidder})]}),H.jsxs("div",{className:"bid-input-section",children:[H.jsx("label",{htmlFor:"bidAmount",children:"Your Bid (WAX)"}),H.jsx("input",{id:"bidAmount",type:"number",step:"0.0001",placeholder:"Enter bid amount",value:g,onChange:e=>b(e.target.value),min:d.current_bid&&d.bidder?parseFloat(d.current_bid)/1e8+1e-4:parseFloat(d.price)/1e8}),H.jsxs("div",{className:"bid-requirement",children:["Minimum: ",d.current_bid&&d.bidder?`${(parseFloat(d.current_bid)/1e8+1e-4).toFixed(4)} WAX`:`${(parseFloat(d.price)/1e8).toFixed(4)} WAX`]})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"btn-secondary",onClick:()=>y(!1),disabled:N,children:"Cancel"}),H.jsx("button",{className:"btn-primary",onClick:async()=>{if(!d||!r||!n)return void c("Error","Please connect your wallet first");const e=parseFloat(g);if(isNaN(e)||e<=0)return void c("Invalid Bid","Please enter a valid bid amount");const t=parseFloat(d.current_bid||d.price)/1e8,a=d.current_bid&&d.bidder;if(a&&e<=t)c("Invalid Bid",`Bid must be higher than current bid of ${t.toFixed(4)} WAX`);else if(!a&&e<parseFloat(d.price)/1e8)c("Invalid Bid",`Bid must be at least ${(parseFloat(d.price)/1e8).toFixed(4)} WAX`);else{w(!0);try{const t=Math.floor(1e8*e);await r.transact({actions:[{account:"atomicmarket",name:"auctionbid",authorization:[{actor:n,permission:"active"}],data:{bidder:n,auction_id:d.auction_id,bid:`${t} WAX`,taker_marketplace:"market.pxj"}}]})&&(s("Bid Placed",`Successfully placed bid of ${e.toFixed(4)} WAX`),y(!1),b(""),h(e=>e?{...e,current_bid:t.toString(),bidder:n}:null))}catch(i){c("Bid Failed",i instanceof Error?i.message:"Failed to place bid")}finally{w(!1)}}},disabled:N||!g,children:N?"Placing Bid...":"Place Bid"})]})]})})]})},$n=()=>{const[e,t]=i.useState("getting-started"),a=[{id:"getting-started",title:"Getting Started on WAX",content:H.jsxs("div",{className:"guide-content",children:[H.jsx("h3",{children:"Welcome to the WAX Blockchain!"}),H.jsx("p",{children:"WAX (Worldwide Asset eXchange) is a purpose-built blockchain for NFTs and gaming. Here's how to get started:"}),H.jsxs("div",{className:"step-list",children:[H.jsxs("div",{className:"step",children:[H.jsx("div",{className:"step-number",children:"1"}),H.jsxs("div",{className:"step-content",children:[H.jsx("h4",{children:"Create a WAX Wallet"}),H.jsxs("p",{children:["Visit ",H.jsx("a",{href:"https://wallet.wax.io",target:"_blank",rel:"noopener noreferrer",children:"wallet.wax.io"})," to create your free WAX account. No gas fees required!"]})]})]}),H.jsxs("div",{className:"step",children:[H.jsx("div",{className:"step-number",children:"2"}),H.jsxs("div",{className:"step-content",children:[H.jsx("h4",{children:"Get Some WAX Tokens"}),H.jsx("p",{children:"Purchase WAX tokens from exchanges like Binance, KuCoin, or use the built-in WAX wallet exchange."})]})]}),H.jsxs("div",{className:"step",children:[H.jsx("div",{className:"step-number",children:"3"}),H.jsxs("div",{className:"step-content",children:[H.jsx("h4",{children:"Connect Your Wallet"}),H.jsx("p",{children:'Use the "Connect Wallet" button in the top right to connect your WAX wallet to PxMarket.'})]})]}),H.jsxs("div",{className:"step",children:[H.jsx("div",{className:"step-number",children:"4"}),H.jsxs("div",{className:"step-content",children:[H.jsx("h4",{children:"Start Trading!"}),H.jsx("p",{children:"Browse collections, buy NFTs, and start building your digital asset portfolio."})]})]})]})]})},{id:"pixel-journey",title:"About Pixel Journey",content:H.jsxs("div",{className:"guide-content",children:[H.jsx("h3",{children:"Welcome to Pixel Journey!"}),H.jsx("p",{children:"Pixel Journey is a comprehensive NFT ecosystem on the WAX blockchain, featuring unique pixel art collections and gaming utilities."}),H.jsxs("div",{className:"feature-grid",children:[H.jsxs("div",{className:"feature-card",children:[H.jsx("h4",{children:"\ud83c\udfa8 Pixel Art NFTs"}),H.jsx("p",{children:"Collect unique pixel art characters, items, and accessories with various rarity levels."})]}),H.jsxs("div",{className:"feature-card",children:[H.jsx("h4",{children:"\ud83c\udfae Gaming Integration"}),H.jsx("p",{children:"Use your NFTs in games and earn rewards through various gameplay mechanics."})]}),H.jsxs("div",{className:"feature-card",children:[H.jsx("h4",{children:"\ud83d\udc8e Staking Rewards"}),H.jsx("p",{children:"Stake your Pixel Journey NFTs to earn PXJ tokens and other rewards."})]}),H.jsxs("div",{className:"feature-card",children:[H.jsx("h4",{children:"\ud83c\udfea Marketplace"}),H.jsx("p",{children:"Trade your NFTs on our integrated marketplace with zero fees for holders."})]})]}),H.jsxs("div",{className:"collections-info",children:[H.jsx("h4",{children:"Main Collections:"}),H.jsxs("ul",{children:[H.jsxs("li",{children:[H.jsx("strong",{children:"Pixals:"})," The main character collection with various traits and rarities"]}),H.jsxs("li",{children:[H.jsx("strong",{children:"Pixel Ingredients:"})," Crafting materials and consumables"]}),H.jsxs("li",{children:[H.jsx("strong",{children:"Pixel Tools:"})," Equipment and utility items"]}),H.jsxs("li",{children:[H.jsx("strong",{children:"Pixel Lands:"})," Virtual land parcels for building and development"]})]})]})]})},{id:"trading-tips",title:"Trading Tips & Strategies",content:H.jsxs("div",{className:"guide-content",children:[H.jsx("h3",{children:"Smart Trading on WAX"}),H.jsxs("div",{className:"tip-section",children:[H.jsx("h4",{children:"\ud83d\udd0d Research Before Buying"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Check the collection's total supply and rarity distribution"}),H.jsx("li",{children:"Look at recent sales history and price trends"}),H.jsx("li",{children:"Verify the authenticity of the collection"}),H.jsx("li",{children:"Join the project's Discord or Telegram for community insights"})]})]}),H.jsxs("div",{className:"tip-section",children:[H.jsx("h4",{children:"\ud83d\udcb0 Pricing Strategies"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Use floor price as a baseline for common items"}),H.jsx("li",{children:"Factor in rarity and trait combinations for pricing"}),H.jsx("li",{children:"Consider market timing and overall WAX ecosystem trends"}),H.jsx("li",{children:"Set competitive prices for quick sales or premium prices for rare items"})]})]}),H.jsxs("div",{className:"tip-section",children:[H.jsx("h4",{children:"\u26a0\ufe0f Risk Management"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Never invest more than you can afford to lose"}),H.jsx("li",{children:"Diversify across different collections and projects"}),H.jsx("li",{children:"Be aware of market volatility and seasonal trends"}),H.jsx("li",{children:"Keep some WAX liquid for opportunities"})]})]})]})},{id:"faq",title:"Frequently Asked Questions",content:H.jsxs("div",{className:"guide-content",children:[H.jsx("h3",{children:"Common Questions"}),H.jsxs("div",{className:"faq-list",children:[H.jsxs("div",{className:"faq-item",children:[H.jsx("h4",{children:"Q: Are there any fees for trading on PxMarket?"}),H.jsx("p",{children:"A: PxMarket charges a small marketplace fee on sales. However, Pixel Journey NFT holders may receive fee discounts or exemptions."})]}),H.jsxs("div",{className:"faq-item",children:[H.jsx("h4",{children:"Q: How do I know if an NFT is authentic?"}),H.jsx("p",{children:"A: Always verify the collection name and creator account. Authentic Pixel Journey NFTs are minted by verified accounts and will show the official collection badge."})]}),H.jsxs("div",{className:"faq-item",children:[H.jsx("h4",{children:"Q: Can I cancel a listing after it's posted?"}),H.jsx("p",{children:"A: Yes, you can cancel your listings at any time from your inventory or profile page. There's no fee for canceling listings."})]}),H.jsxs("div",{className:"faq-item",children:[H.jsx("h4",{children:"Q: What happens if I lose access to my WAX wallet?"}),H.jsx("p",{children:"A: Always keep your private keys and recovery phrases secure. If you lose access, you may lose your NFTs permanently. Consider using hardware wallets for valuable collections."})]}),H.jsxs("div",{className:"faq-item",children:[H.jsx("h4",{children:"Q: How do I participate in NFT drops and launches?"}),H.jsx("p",{children:"A: Follow Pixel Journey on social media and join our Discord for announcements. Most drops happen directly through our platform or partner sites."})]}),H.jsxs("div",{className:"faq-item",children:[H.jsx("h4",{children:"Q: Can I use my NFTs in games?"}),H.jsx("p",{children:"A: Many Pixel Journey NFTs have gaming utility. Check the NFT details page for specific game integrations and benefits."})]})]})]})},{id:"advanced",title:"Advanced Features",content:H.jsxs("div",{className:"guide-content",children:[H.jsx("h3",{children:"Power User Features"}),H.jsxs("div",{className:"advanced-section",children:[H.jsx("h4",{children:"\ud83d\udd27 Bulk Operations"}),H.jsx("p",{children:"Use our bulk tools to:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"List multiple NFTs at once with smart pricing"}),H.jsx("li",{children:"Transfer multiple items to different recipients"}),H.jsx("li",{children:"Burn unwanted NFTs in batches"}),H.jsx("li",{children:"Stake multiple NFTs for rewards"})]})]}),H.jsxs("div",{className:"advanced-section",children:[H.jsx("h4",{children:"\ud83d\udcca Analytics & Tracking"}),H.jsx("p",{children:"Monitor your portfolio with:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Real-time portfolio value tracking"}),H.jsx("li",{children:"Transaction history and profit/loss analysis"}),H.jsx("li",{children:"Collection performance metrics"}),H.jsx("li",{children:"Market trend indicators"})]})]}),H.jsxs("div",{className:"advanced-section",children:[H.jsx("h4",{children:"\ud83c\udfaf Watchlists & Alerts"}),H.jsx("p",{children:"Stay informed with:"}),H.jsxs("ul",{children:[H.jsx("li",{children:"Custom watchlists for tracking specific NFTs"}),H.jsx("li",{children:"Price alerts for collections you're interested in"}),H.jsx("li",{children:"New listing notifications"}),H.jsx("li",{children:"Auction ending reminders"})]})]})]})}];return H.jsxs("div",{className:"learn-page",children:[H.jsxs("div",{className:"page-header",children:[H.jsx("h1",{children:"Learn Hub"}),H.jsx("p",{children:"Everything you need to know about WAX, NFTs, and Pixel Journey"})]}),H.jsxs("div",{className:"learn-container",children:[H.jsx("div",{className:"learn-sidebar",children:H.jsx("nav",{className:"learn-nav",children:a.map(a=>H.jsx("button",{className:"nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id),children:a.title},a.id))})}),H.jsx("div",{className:"learn-content",children:a.find(t=>t.id===e)?.content})]}),H.jsxs("div",{className:"help-section",children:[H.jsx("h3",{children:"Need More Help?"}),H.jsx("p",{children:"Access our documentation and join our community for support:"}),H.jsxs("div",{className:"community-links",children:[H.jsxs("a",{href:"https://docs.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"community-link docs",children:[H.jsx("span",{className:"icon",children:"\ud83d\udcda"}),"Documentation"]}),H.jsxs("a",{href:"#",className:"community-link discord",children:[H.jsx("span",{className:"icon",children:"\ud83d\udcac"}),"Discord Community"]}),H.jsxs("a",{href:"#",className:"community-link telegram",children:[H.jsx("span",{className:"icon",children:"\ud83d\udcf1"}),"Telegram Group"]}),H.jsxs("a",{href:"#",className:"community-link twitter",children:[H.jsx("span",{className:"icon",children:"\ud83d\udc26"}),"Twitter Updates"]})]})]})]})},Fn=()=>{const[e,t]=i.useState("overview"),a=[{id:"overview",title:"Overview",content:H.jsxs("div",{className:"section-content",children:[H.jsx("h3",{children:"PxMarket Journey Map"}),H.jsx("p",{children:"Welcome to the comprehensive roadmap of the Pixel Journey ecosystem. This page serves as both a sitemap for current features and a development roadmap for future enhancements."}),H.jsxs("div",{className:"ecosystem-grid",children:[H.jsxs("div",{className:"ecosystem-card current",children:[H.jsx("h4",{children:"\ud83c\udfea Current Platform"}),H.jsx("p",{children:"PxMarket - Your gateway to the Pixel Journey NFT ecosystem"})]}),H.jsxs("div",{className:"ecosystem-card future",children:[H.jsx("h4",{children:"\ud83d\ude80 Future dApps"}),H.jsx("p",{children:"Expanding ecosystem of interconnected applications"})]})]})]})},{id:"pxmarket-features",title:"PxMarket Features",content:H.jsxs("div",{className:"section-content",children:[H.jsx("h3",{children:"PxMarket Feature Map"}),H.jsx("p",{children:"Explore all the features available in the current PxMarket platform:"}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83d\uded2 Marketplace Core"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"NFT Marketplace"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Collection Browser"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Asset Details"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Advanced Filtering"}),H.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83d\udc64 User Features"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"User Profiles"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Inventory Management"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Watchlist"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Activity Tracking"}),H.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83d\udcb0 Trading & Economy"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Buy/Sell NFTs"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Bulk Operations"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Price Analytics"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Auctions"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Offers System"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Shopping Cart"}),H.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83d\udd04 WAX Integration"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"RWAX Tokenization"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"WAX Balance Management"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Resource Management (CPU/NET/RAM)"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Multi-Wallet Support"}),H.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83c\udfc6 Staking & Rewards"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"NFT Staking"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Token Staking"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Reward Distribution"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"PXJ Badge System"}),H.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83c\udf81 Rewards & Gamification"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Pack Opening"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Chat System"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Live Transactions Feed"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Social Sharing"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item planned",children:[H.jsx("span",{className:"feature-name",children:"Achievement System"}),H.jsx("span",{className:"status-badge planned",children:"Planned"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83d\udee0\ufe0f Advanced Features"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"NFT Comparison Tool"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Portfolio Analytics"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Price Alerts"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Collection Analytics"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"Accessibility Features"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsxs("div",{className:"feature-item live",children:[H.jsx("span",{className:"feature-name",children:"PWA Support"}),H.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),H.jsxs("div",{className:"feature-category",children:[H.jsx("h4",{children:"\ud83c\udfa8 Crafting & Creation"}),H.jsxs("div",{className:"feature-list",children:[H.jsxs("div",{className:"feature-item beta",children:[H.jsx("span",{className:"feature-name",children:"NFT Crafting System"}),H.jsx("span",{className:"status-badge beta",children:"Beta"})]}),H.jsxs("div",{className:"feature-item planned",children:[H.jsx("span",{className:"feature-name",children:"Custom Templates"}),H.jsx("span",{className:"status-badge planned",children:"Planned"})]}),H.jsxs("div",{className:"feature-item planned",children:[H.jsx("span",{className:"feature-name",children:"Community Creations"}),H.jsx("span",{className:"status-badge planned",children:"Planned"})]})]})]})]})},{id:"wax-ecosystem",title:"WAX Ecosystem",content:H.jsxs("div",{className:"section-content",children:[H.jsx("h3",{children:"PXJourney across WAX"}),H.jsx("p",{children:"Explore the expanding Pixel Journey ecosystem on the WAX blockchain:"}),H.jsxs("div",{className:"dapp-grid",children:[H.jsxs("div",{className:"dapp-card live purple-glow",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxMarket"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsx("p",{children:"NFT marketplace and trading platform"}),H.jsx("a",{href:"https://market.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxMarket \u2192"})]}),H.jsxs("div",{className:"dapp-card live green-glow",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxStaking"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsx("p",{children:"Stake your Pixel Journey NFTs for rewards"}),H.jsx("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxStaking \u2192"})]}),H.jsxs("div",{className:"dapp-card live golden-glow",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxLeaderboards"}),H.jsx("span",{className:"status-badge live",children:"Live"})]}),H.jsx("p",{children:"Track rankings and compete with other players"}),H.jsx("a",{href:"https://lb.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxLeaderboards \u2192"})]}),H.jsxs("div",{className:"dapp-card planned",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxDeFi"}),H.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),H.jsx("p",{children:"Decentralized finance features for the ecosystem"}),H.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]}),H.jsxs("div",{className:"dapp-card coming-soon",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxCraft"}),H.jsx("span",{className:"status-badge coming-soon",children:"Coming Soon"})]}),H.jsx("p",{children:"Craft and create new NFTs from existing assets"}),H.jsx("div",{className:"dapp-link disabled",children:"In Development"})]}),H.jsxs("div",{className:"dapp-card coming-soon",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxMilestones"}),H.jsx("span",{className:"status-badge coming-soon",children:"Coming Soon"})]}),H.jsx("p",{children:"Achievement and milestone tracking system"}),H.jsx("div",{className:"dapp-link disabled",children:"In Development"})]}),H.jsxs("div",{className:"dapp-card planned",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxQuest"}),H.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),H.jsx("p",{children:"Quest and mission system for earning rewards"}),H.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]}),H.jsxs("div",{className:"dapp-card planned",children:[H.jsxs("div",{className:"dapp-header",children:[H.jsx("h4",{children:"PxDAO"}),H.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),H.jsx("p",{children:"Decentralized governance for the ecosystem"}),H.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]})]})]})},{id:"external-links",title:"External Platforms",content:H.jsxs("div",{className:"section-content",children:[H.jsx("h3",{children:"Pixel Journey Across Platforms"}),H.jsx("p",{children:"Find Pixel Journey on various platforms and marketplaces:"}),H.jsxs("div",{className:"platform-category",children:[H.jsx("h4",{children:"\ud83c\udf10 Official Websites"}),H.jsxs("div",{className:"link-grid",children:[H.jsxs("a",{href:"https://pixeljourney.xyz/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"Main Website"}),H.jsx("span",{className:"platform-desc",children:"Official Pixel Journey homepage"})]}),H.jsxs("a",{href:"https://docs.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"Documentation"}),H.jsx("span",{className:"platform-desc",children:"Complete project documentation"})]})]})]}),H.jsxs("div",{className:"platform-category",children:[H.jsx("h4",{children:"\ud83d\uded2 NFT Marketplaces (WAX)"}),H.jsxs("div",{className:"link-grid",children:[H.jsxs("a",{href:"https://atomichub.io/explorer/collection/wax-mainnet/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"AtomicHub"}),H.jsx("span",{className:"platform-desc",children:"Primary WAX marketplace"})]}),H.jsxs("a",{href:"https://neftyblocks.com/collection/pixeljourney/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"NeftyBlocks"}),H.jsx("span",{className:"platform-desc",children:"WAX NFT marketplace"})]}),H.jsxs("a",{href:"https://nfthive.io/collection/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"NFTHive"}),H.jsx("span",{className:"platform-desc",children:"WAX marketplace and drops"})]}),H.jsxs("a",{href:"https://www.pfpwizard.xyz/pfp/pixals/ranking/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"PFP Wizard"}),H.jsx("span",{className:"platform-desc",children:"Pixal PFP marketplace"})]})]})]}),H.jsxs("div",{className:"platform-category",children:[H.jsx("h4",{children:"\ud83c\udf09 Cross-Chain Marketplaces"}),H.jsxs("div",{className:"link-grid",children:[H.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-polygon",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"OpenSea (Polygon)"}),H.jsx("span",{className:"platform-desc",children:"Polygon bridged collection"})]}),H.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-base",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"OpenSea (Base)"}),H.jsx("span",{className:"platform-desc",children:"Base bridged collection"})]}),H.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-eth",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"OpenSea (Ethereum)"}),H.jsx("span",{className:"platform-desc",children:"Ethereum bridged collection"})]}),H.jsxs("a",{href:"https://nft.monbase.com/collections/66c4eb2ca339b05c5a660e44/detail",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"MonBase"}),H.jsx("span",{className:"platform-desc",children:"Base chain marketplace"})]})]})]}),H.jsxs("div",{className:"platform-category",children:[H.jsx("h4",{children:"\ud83d\udcb0 DeFi & Staking"}),H.jsxs("div",{className:"link-grid",children:[H.jsxs("a",{href:"https://waxdao.io/v2/farm/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"WaxDAO Farm"}),H.jsx("span",{className:"platform-desc",children:"NFT staking rewards"})]}),H.jsxs("a",{href:"https://www.pfpwizard.xyz/pfp/pixals/buy/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[H.jsx("span",{className:"platform-name",children:"PFP Wizard Buy"}),H.jsx("span",{className:"platform-desc",children:"Get your Pixal PFP"})]})]})]})]})},{id:"social-community",title:"Social & Community",content:H.jsxs("div",{className:"section-content",children:[H.jsx("h3",{children:"Join the Community"}),H.jsx("p",{children:"Connect with the Pixel Journey community across various platforms:"}),H.jsxs("div",{className:"social-grid",children:[H.jsxs("a",{href:"https://twitter.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"social-link twitter",children:[H.jsx("div",{className:"social-icon",children:"\ud83d\udc26"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"Twitter/X"}),H.jsx("span",{className:"social-desc",children:"Latest updates and announcements"})]})]}),H.jsxs("a",{href:"https://t.me/pixel_journey",target:"_blank",rel:"noopener noreferrer",className:"social-link telegram",children:[H.jsx("div",{className:"social-icon",children:"\ud83d\udcf1"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"Telegram"}),H.jsx("span",{className:"social-desc",children:"Community chat and discussions"})]})]}),H.jsxs("a",{href:"https://discord.gg/waxblockchain",target:"_blank",rel:"noopener noreferrer",className:"social-link discord",children:[H.jsx("div",{className:"social-icon",children:"\ud83d\udcac"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"WAX Discord"}),H.jsx("span",{className:"social-desc",children:"Join the broader WAX community"})]})]}),H.jsxs("a",{href:"https://instagram.com/pixeljourney_xyz",target:"_blank",rel:"noopener noreferrer",className:"social-link instagram",children:[H.jsx("div",{className:"social-icon",children:"\ud83d\udcf8"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"Instagram"}),H.jsx("span",{className:"social-desc",children:"Visual updates and behind-the-scenes"})]})]}),H.jsxs("a",{href:"https://coinmarketcap.com/community/profile/pixeljourney/",target:"_blank",rel:"noopener noreferrer",className:"social-link cmc",children:[H.jsx("div",{className:"social-icon",children:"\ud83d\udcca"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"CoinMarketCap"}),H.jsx("span",{className:"social-desc",children:"Project profile and metrics"})]})]}),H.jsxs("a",{href:"https://dappradar.com/nft-collection/pixel-journey",target:"_blank",rel:"noopener noreferrer",className:"social-link dappradar",children:[H.jsx("div",{className:"social-icon",children:"\ud83d\udcc8"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"DappRadar"}),H.jsx("span",{className:"social-desc",children:"NFT collection analytics"})]})]}),H.jsxs("a",{href:"https://pixel-journey.uncut.network/",target:"_blank",rel:"noopener noreferrer",className:"social-link uncut",children:[H.jsx("div",{className:"social-icon",children:"\ud83c\udfae"}),H.jsxs("div",{className:"social-info",children:[H.jsx("span",{className:"social-name",children:"Uncut Network"}),H.jsx("span",{className:"social-desc",children:"Gaming community presence"})]})]})]})]})},{id:"roadmap",title:"Development Roadmap",content:H.jsxs("div",{className:"section-content",children:[H.jsx("h3",{children:"Future Development Roadmap"}),H.jsx("p",{children:"Planned features and enhancements for the Pixel Journey ecosystem:"}),H.jsxs("div",{className:"roadmap-timeline",children:[H.jsxs("div",{className:"roadmap-phase completed",children:[H.jsxs("div",{className:"phase-header",children:[H.jsx("h4",{children:"Phase 1: Foundation"}),H.jsx("span",{className:"phase-status completed",children:"Completed"})]}),H.jsxs("ul",{children:[H.jsx("li",{children:"\u2705 PxMarket NFT marketplace launch"}),H.jsx("li",{children:"\u2705 Basic trading functionality"}),H.jsx("li",{children:"\u2705 User profiles and inventory"}),H.jsx("li",{children:"\u2705 PXJ token integration"})]})]}),H.jsxs("div",{className:"roadmap-phase current",children:[H.jsxs("div",{className:"phase-header",children:[H.jsx("h4",{children:"Phase 2: Enhancement"}),H.jsx("span",{className:"phase-status current",children:"Current"})]}),H.jsxs("ul",{children:[H.jsx("li",{children:"\u2705 Advanced filtering and search"}),H.jsx("li",{children:"\u2705 Bulk operations"}),H.jsx("li",{children:"\ud83d\udd04 Auction system (Beta)"}),H.jsx("li",{children:"\ud83d\udd04 Enhanced analytics"})]})]}),H.jsxs("div",{className:"roadmap-phase planned",children:[H.jsxs("div",{className:"phase-header",children:[H.jsx("h4",{children:"Phase 3: Ecosystem Expansion"}),H.jsx("span",{className:"phase-status planned",children:"Q2 2025"})]}),H.jsxs("ul",{children:[H.jsx("li",{children:"\ud83d\udd2e PxCraft crafting system"}),H.jsx("li",{children:"\ud83d\udd2e PxMilestones achievement system"}),H.jsx("li",{children:"\ud83d\udd2e Enhanced gamification"}),H.jsx("li",{children:"\ud83d\udd2e Cross-platform integration"})]})]}),H.jsxs("div",{className:"roadmap-phase future",children:[H.jsxs("div",{className:"phase-header",children:[H.jsx("h4",{children:"Phase 4: Advanced Features"}),H.jsx("span",{className:"phase-status future",children:"Q3-Q4 2025"})]}),H.jsxs("ul",{children:[H.jsx("li",{children:"\ud83d\udd2e PxQuest mission system"}),H.jsx("li",{children:"\ud83d\udd2e PxDeFi financial features"}),H.jsx("li",{children:"\ud83d\udd2e PxDAO governance"}),H.jsx("li",{children:"\ud83d\udd2e Mobile applications"})]})]})]})]})}];return H.jsxs("div",{className:"journeymap-page",children:[H.jsxs("div",{className:"page-header",children:[H.jsx("h1",{children:"Journey Map"}),H.jsx("p",{children:"Your comprehensive guide to the Pixel Journey ecosystem - current features, future roadmap, and community links"})]}),H.jsxs("div",{className:"journeymap-container",children:[H.jsx("div",{className:"journeymap-sidebar",children:H.jsx("nav",{className:"journeymap-nav",children:a.map(a=>H.jsx("button",{className:"nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id),children:a.title},a.id))})}),H.jsx("div",{className:"journeymap-content",children:a.find(t=>t.id===e)?.content})]})]})},En=({isOpen:e,onClose:t,templateId:a,templateName:n,action:r,onSuccess:s})=>{const[l,c]=i.useState([]),[o,d]=i.useState([]),[h,u]=i.useState(!1),[m,p]=i.useState(!1),[v,y]=i.useState(null),[g,b]=i.useState(null),{session:N,account:w}=Q(),{addNotification:k,showSuccess:x,showError:C}=We();i.useEffect(()=>{e&&w&&A()},[e,w,a]);const A=async()=>{if(w){u(!0);try{if("stake"===r){const{apiService:e}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),t=`${e.atomicAssetsAPI}/atomicassets/v1/assets?owner=${w}&template_id=${a}&page=1&limit=100&order=desc&sort=asset_id`,n=await e.fetchWithRetry(t),i=await n.json();c(i.data||[])}else{const{apiService:e}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),t=(await e.waxRpcCall("/v1/chain/get_table_rows",{json:!0,code:"farms.waxdao",scope:"farms.waxdao",table:"stakers",lower_bound:w,upper_bound:w,limit:1})).rows.find(e=>e.user===w),a=t?.staked_assets||[];if(0===a.length)c([]);else{const t=await e.fetchWithRetry(`${e.atomicAssetsAPI}/atomicassets/v1/assets?ids=${a.join(",")}&page=1&limit=1000`);if(!t.ok)throw new Error("Failed to fetch asset details");const n=await t.json();c(n.data||[])}}}catch(e){se.error("Failed to fetch staking assets","NFTStakingModal.fetchAssets",e,{account:w}),k({type:"error",message:"Failed to load assets"})}finally{u(!1)}}};return e?H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"modal-content nft-staking-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h2",{children:["stake"===r?"Stake":"Unstake"," ",n," NFTs"]}),H.jsx("button",{className:"modal-close",onClick:t,children:"\xd7"})]}),H.jsx("div",{className:"modal-body",children:h?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsxs("p",{children:["Loading your ",n," NFTs..."]})]}):m?H.jsxs("div",{className:"processing-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsxs("p",{children:["stake"===r?"Staking":"Unstaking"," your NFTs..."]}),v&&H.jsxs("div",{className:"batch-progress",children:[H.jsx("div",{className:"progress-bar",children:H.jsx("div",{className:"progress-fill",style:{width:v.current/v.total*100+"%"}})}),H.jsxs("p",{children:["Processing ",v.current," of ",v.total," NFTs"]})]}),g&&H.jsxs("div",{className:"transaction-results",children:[H.jsxs("div",{className:"results-summary",children:[H.jsxs("div",{className:"success-count",children:["\u2705 ",g.successful_transactions.length," successful"]}),g.failed_transactions.length>0&&H.jsxs("div",{className:"error-count",children:["\u274c ",g.failed_transactions.length," failed"]})]}),g.failed_transactions.length>0&&H.jsxs("div",{className:"failed-transactions",children:[H.jsx("h4",{children:"Failed Transactions:"}),g.failed_transactions.slice(0,5).map(e=>H.jsxs("div",{className:"failure-item",children:[H.jsxs("span",{children:["#",e.asset_id]}),H.jsx("span",{className:"error-message",children:e.error})]},e.asset_id)),g.failed_transactions.length>5&&H.jsxs("p",{children:["... and ",g.failed_transactions.length-5," more"]})]})]})]}):H.jsxs(H.Fragment,{children:[H.jsxs("div",{className:"selection-controls",children:[H.jsx("button",{className:"btn btn-secondary",onClick:()=>{o.length===l.length?d([]):d(l.map(e=>e.asset_id))},children:o.length===l.length?"Deselect All":"Select All"}),H.jsxs("span",{className:"selection-count",children:[o.length," of ",l.length," selected"]})]}),H.jsx("div",{className:"asset-grid",children:0===l.length?H.jsx("div",{className:"no-assets",children:H.jsxs("p",{children:["No ",n," NFTs available to ",r]})}):l.map(e=>H.jsxs("div",{className:"asset-item "+(o.includes(e.asset_id)?"selected":""),onClick:()=>{return t=e.asset_id,void d(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[H.jsx(Ua,{src:e.image||`https://ipfs.io/ipfs/${e.data?.img||"placeholder"}`,alt:e.name}),H.jsxs("div",{className:"asset-id",children:["#",e.asset_id]}),o.includes(e.asset_id)&&H.jsx("div",{className:"selection-indicator",children:"\u2713"})]},e.asset_id))})]})}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),H.jsx("button",{className:"btn btn-primary",onClick:async()=>{if(N&&0!==o.length){p(!0),y({current:0,total:o.length}),b(null);try{let e;if(e="stake"===r?await Ma.stakeNFTsBatch(N,o,"pixeljourney"):await Ma.unstakeNFTsBatch(N,o),b(e),e.success)x("Transaction Successful",`Successfully ${r}d ${e.successful_transactions.length} ${n} NFT${e.successful_transactions.length>1?"s":""}`),setTimeout(()=>{s?.(),t()},2e3);else{const t=e.successful_transactions.length,a=e.failed_transactions.length;t>0?x("Partial Success",`${t} NFTs ${r}d successfully, ${a} failed`):C("Transaction Failed",`Failed to ${r} NFTs. Please try again.`)}}catch(e){se.error(`NFT ${r} operation failed`,"NFTStakingModal.handleBatchAction",e,{action:r,selectedAssetsCount:o.length});const t=e instanceof Error?e.message:`Failed to ${r} NFTs`;C("Transaction Error",t)}finally{p(!1),y(null)}}},disabled:0===o.length||m,children:m?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"loading-spinner"}),"stake"===r?"Staking...":"Unstaking..."]}):`${"stake"===r?"Stake":"Unstake"} ${o.length} NFT${1!==o.length?"s":""}`})]})]})}):null},In=e=>({PXJ:"/img/tokens/pxj.png",WUF:"/img/tokens/wuf.png",WAX:"/img/tokens/wax.png",PIXAL:"/img/tokens/pixal.png"}[e.toUpperCase()]||"/img/tokens/default.png"),Mn=({isOpen:e,onClose:t,action:a,farmName:n="pxjfarm1",onSuccess:r})=>{const{session:s}=Q(),{showSuccess:l,showError:c}=We(),[o,d]=i.useState(""),[h,u]=i.useState(!1),[m,p]=i.useState(null),[f,v]=i.useState(null),[y,g]=i.useState(0),[b,N]=i.useState(!1),w=i.useCallback(async()=>{if(s){N(!0);try{const e=await Ma.getTokenFarmInfo(n);p(e);const t=await Ma.getTokenStakingInfo(s.actor.toString(),n);v(t);const a=await fetch("https://wax.greymass.com/v1/chain/get_currency_balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"pixeljourney",account:s.actor.toString(),symbol:"PXJ"})});if(a.ok){const e=await a.json(),t=e.length>0?parseFloat(e[0].split(" ")[0]):0;g(t)}}catch(e){c("Failed to load staking data")}finally{N(!1)}}},[s,N,n,p,v,g,c]);i.useEffect(()=>{e&&s&&w()},[e,s,n,w]);const k=e=>e.toLocaleString(void 0,{minimumFractionDigits:4,maximumFractionDigits:4});return e?H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"modal-content token-staking-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h3",{children:(()=>{switch(a){case"stake":return"Stake PXJ Tokens";case"unstake":return"Unstake PXJ Tokens";case"claim":return"Claim Rewards";default:return"Token Staking"}})()}),H.jsx("button",{className:"close-btn",onClick:t,children:"\xd7"})]}),H.jsx("div",{className:"modal-body",children:b?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading staking data..."})]}):H.jsxs(H.Fragment,{children:[m&&H.jsxs("div",{className:"farm-info-section",children:[H.jsx("h4",{children:"Farm Information"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"label",children:"Farm:"}),H.jsx("span",{className:"value",children:m.farm_name})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"label",children:"Total Staked:"}),H.jsxs("span",{className:"value",children:[k(m.total_staked)," PXJ"]})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"label",children:"Vesting Period:"}),H.jsxs("span",{className:"value",children:[Math.floor(m.vesting_time/86400)," days"]})]})]})]}),f&&H.jsxs("div",{className:"user-stake-info",children:[H.jsx("h4",{children:"Your Staking Position"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"label",children:"Staked Amount:"}),H.jsxs("span",{className:"value",children:[k(f.staked_amount)," PXJ"]})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"label",children:"Pending Rewards:"}),H.jsx("span",{className:"value",children:f.pending_rewards.map(e=>`${k(e.amount)} ${e.token}`).join(", ")||"None"})]}),H.jsxs("div",{className:"info-item",children:[H.jsx("span",{className:"label",children:"Unlock Time:"}),H.jsx("span",{className:"value",children:(e=>{const t=e-Date.now()/1e3;if(t<=0)return"Available now";const a=Math.floor(t/86400),n=Math.floor(t%86400/3600),i=Math.floor(t%3600/60);return a>0?`${a}d ${n}h remaining`:n>0?`${n}h ${i}m remaining`:`${i}m remaining`})(f.vesting_time)})]})]})]}),H.jsx("div",{className:"balance-info",children:H.jsxs("div",{className:"balance-item",children:[H.jsx(za,{src:In("PXJ"),alt:"PXJ"}),H.jsxs("span",{children:["Available: ",k(y)," PXJ"]})]})}),H.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),s&&!h)if("claim"===a||o&&!(parseFloat(o)<=0))if("stake"===a&&parseFloat(o)>y)c("Insufficient PXJ balance");else if("unstake"===a&&f&&parseFloat(o)>f.staked_amount)c("Amount exceeds staked balance");else{u(!0);try{let e;const i=`${parseFloat(o).toFixed(4)} PXJ`;switch(a){case"stake":e=await Ma.stakeTokens(s,i,n);break;case"unstake":e=await Ma.unstakeTokens(s,i,n);break;case"claim":e=await Ma.claimTokenFarmRewards(s,n);break;default:throw new Error("Invalid action")}e.success?(l(`Successfully ${"stake"===a?"staked":"unstake"===a?"unstaked":"claimed"} tokens!`),r?.(),t()):c(e.error||`Failed to ${a} tokens`)}catch(i){c(i instanceof Error?i.message:`Failed to ${a} tokens`)}finally{u(!1)}}else c("Please enter a valid amount")},className:"staking-form",children:["claim"!==a&&H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"amount",children:"Amount (PXJ)"}),H.jsxs("div",{className:"input-group",children:[H.jsx("input",{type:"number",id:"amount",value:o,onChange:e=>d(e.target.value),placeholder:"0.0000",step:"0.0001",min:"0",max:"stake"===a?y:f?.staked_amount||0,required:!0,disabled:h}),H.jsx("button",{type:"button",className:"max-btn",onClick:()=>{d(("stake"===a?y:f?.staked_amount||0).toFixed(4))},disabled:h,children:"MAX"})]})]}),"claim"===a&&f&&f.pending_rewards.length>0&&H.jsxs("div",{className:"rewards-preview",children:[H.jsx("h4",{children:"Rewards to Claim:"}),H.jsx("div",{className:"rewards-list",children:f.pending_rewards.map((e,t)=>H.jsxs("div",{className:"reward-item",children:[H.jsx(za,{src:In(e.token),alt:e.token}),H.jsxs("span",{children:[k(e.amount)," ",e.token]})]},t))})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,disabled:h,children:"Cancel"}),H.jsx("button",{type:"submit",className:"btn btn-primary",disabled:h||"claim"!==a&&!o,children:(()=>{if(h)return"Processing...";switch(a){case"stake":return"Stake Tokens";case"unstake":return"Unstake Tokens";case"claim":return"Claim Rewards";default:return"Submit"}})()})]})]})]})})]})}):null},Ln=async(e,t)=>{try{const t=await $e.getSales({template:e,limit:10});if(t&&t.data.length>0){const e=t.data.reduce((e,t)=>e+parseFloat(t.price?.amount||"0"),0)/t.data.length;return Math.floor(100*e)}}catch(a){se.warn("Could not fetch template sales data","Staking",a)}return{Common:1e3,Uncommon:2500,Rare:5e3,Epic:15e3,Legendary:5e4}[t]||1e3},Wn=async e=>{try{const t=await $e.getSales({template:e,limit:5});if(t&&t.data.length>0){const e=t.data.map(e=>parseFloat(e.price?.amount||"0")),a=Math.min(...e.filter(e=>e>0));return Math.floor(a)}}catch(t){se.warn("Could not fetch template listings","Staking",t)}return 50},Rn=({template:e,isOpen:t,onClose:a})=>t&&e?H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal-content quick-buy-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsxs("h3",{children:["Quick Buy - ",e.name]}),H.jsx("button",{className:"close-btn",onClick:a,children:"\xd7"})]}),H.jsx("div",{className:"modal-body",children:H.jsxs("div",{className:"buy-item-preview",children:[H.jsx(Ua,{src:e.image,alt:e.name}),H.jsxs("div",{className:"item-details",children:[H.jsx("h4",{children:e.name}),H.jsx("p",{className:"rarity",children:e.rarity}),H.jsxs("p",{className:"price",children:[e.market_price||"N/A"," WAX"]}),H.jsxs("p",{className:"available",children:[e.available_for_sale||0," available"]})]})]})}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),H.jsx("button",{className:"btn btn-primary",children:"Buy Now"})]})]})}):null,On=()=>{const{session:e,isConnected:t,login:a}=Q(),{showSuccess:n,showError:r}=We(),[l,c]=i.useState(!1),[o,d]=i.useState([]),[h,u]=i.useState({pxj:0,wuf:0}),[m,p]=i.useState(!1),[v,y]=i.useState(0),[g,b]=i.useState(null),[N,w]=i.useState(!1),[k,x]=i.useState(!1),[C,A]=i.useState(!1),[_,S]=i.useState(null),[P,T]=i.useState(!1),[$,F]=i.useState(null),[E,I]=i.useState(null),[M,L]=i.useState(!1),[W,R]=i.useState("stake"),[O,B]=i.useState(!1),[j,D]=i.useState(0),U=i.useMemo(()=>[{template_id:"1001",name:"Black Ingredient",type:"Legendary",rarity:"Legendary",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:50,wuf:25},estimated_value:1e5,apr:120,market_price:2500,available_for_sale:3},{template_id:"1002",name:"Tertiary Ingredient",type:"Epic",rarity:"Epic",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:10,wuf:5},estimated_value:25e3,apr:80,market_price:500,available_for_sale:12},{template_id:"1003",name:"Secondary Ingredient",type:"Rare",rarity:"Rare",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:2,wuf:1},estimated_value:5e3,apr:40,market_price:100,available_for_sale:25},{template_id:"1004",name:"Primary Ingredient",type:"Common",rarity:"Common",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:.1,wuf:.05},estimated_value:1e3,apr:10,market_price:25,available_for_sale:50}],[]),X=i.useCallback(async()=>{p(!0);try{if(!e)return d(U),void p(!1);try{const{apiService:t}=await f(async()=>{const{apiService:e}=await Promise.resolve().then(()=>Fe);return{apiService:e}},void 0),a=await t.fetchWithRetry(`${t.atomicAssetsAPI}/atomicassets/v1/templates?collection_name=pixeljourney&schema_name=ingredients&page=1&limit=100&order=desc&sort=created`);if(!a.ok)throw new Error("AtomicAssets API failed");const n=await a.json(),i=n.data.slice(0,10).map(e=>e.template_id),r=await t.getAssetCountsBatch(i,e.actor.toString()),s=(await Promise.all(n.data.slice(0,10).map(async t=>{try{const n=r.data[t.template_id]||0;let i=0;try{const t=await fetch("https://wax.greymass.com/v1/chain/get_table_rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"farms.waxdao",scope:"farms.waxdao",table:"stakers",lower_bound:e.actor,upper_bound:e.actor,limit:1})});if(t.ok){const a=(await t.json()).rows.find(t=>t.user===e.actor.toString());i=(a?.staked_assets||[]).length}}catch(a){se.warn("Failed to fetch staked count for template","Staking",{templateId:t.template_id,error:a})}const s=String(t.immutable_data?.rarity||"Common");let l=.1,c=5;switch(s.toLowerCase()){case"legendary":l=50,c=120;break;case"epic":l=10,c=80;break;case"rare":l=2,c=40;break;case"uncommon":l=.5,c=20;break;default:l=.1,c=10}return{template_id:t.template_id,name:t.immutable_data?.name||`Template ${t.template_id}`,type:t.immutable_data?.type||s,rarity:s,image:t.immutable_data?.img?`https://ipfs.io/ipfs/${t.immutable_data.img}`:"",owned_count:n,staked_count:i,rewards_per_hour:{pxj:l,wuf:.5*l},estimated_value:await Ln(t.template_id,s),apr:c,market_price:await Wn(t.template_id),available_for_sale:Math.floor(20*Math.random())+1}}catch(a){return se.error("Error processing template","Staking",a),null}}))).filter(e=>null!==e);d(s.length>0?s:U),r.errors.length>0&&se.warn("Some template counts could not be fetched","Staking",{errors:r.errors})}catch(t){se.warn("API fetch failed, using default templates","Staking",t),d(U)}}catch(a){se.error("Failed to fetch NFT templates","Staking",a),d(U)}finally{p(!1)}},[e,p,d,U]),z=i.useCallback(async()=>{if(e)try{const t=await Ma.getStakingInfo(e.actor.toString()),a=t.pending_rewards.reduce((e,t)=>("PXJ"===t.token?e.pxj=t.amount:"WUF"===t.token&&(e.wuf=t.amount),e),{pxj:0,wuf:0});u(a),y(t.total_staking_power);const n=o.map(e=>{const a=t.staked_nfts.filter(t=>t.template_id===e.template_id);return{...e,staked_count:a.length,rewards_per_hour:a.length>0?a[0].rewards_per_hour:e.rewards_per_hour}});d(n)}catch(t){se.error("Failed to fetch rewards","Staking",t);const a=Date.now(),n=localStorage.getItem(`lastClaimTime_${e.actor}`)||a.toString(),i=(a-parseInt(n))/1e3/3600,r=o.reduce((e,t)=>{const a=t.staked_count*t.rewards_per_hour.pxj*Math.floor(i),n=t.staked_count*t.rewards_per_hour.wuf*Math.floor(i);return{pxj:e.pxj+a,wuf:e.wuf+n}},{pxj:0,wuf:0});u(r)}},[e,o,u,y,d]),J=i.useCallback(async()=>{if(e){B(!0);try{const t=await Ma.getTokenFarmInfo("pxjfarm1");I(t);const a=await Ma.getTokenStakingInfo(e.actor.toString(),"pxjfarm1");F(a);const n=await fetch("https://wax.greymass.com/v1/chain/get_currency_balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"pixeljourney",account:e.actor.toString(),symbol:"PXJ"})});if(n.ok){const e=await n.json(),t=e.length>0?parseFloat(e[0].split(" ")[0]):0;D(t)}}catch(t){se.error("Failed to fetch token staking data","Staking",t)}finally{B(!1)}}},[e,B,I,F,D]),q=e=>{R(e),L(!0)},V=e=>{S(e),A(!0)},G=()=>{A(!1),S(null)},Y=e=>{switch(e.toLowerCase()){case"legendary":return"#f59e0b";case"epic":return"#8b5cf6";case"rare":return"#3b82f6";case"uncommon":return"#10b981";default:return"#6b7280"}};return i.useEffect(()=>{X(),e&&(z(),J())},[e,X,z,J]),i.useEffect(()=>{const t=setInterval(()=>{e&&(z(),J())},3e4);return()=>clearInterval(t)},[e,o,z,J]),i.useEffect(()=>{const e=o.reduce((e,t)=>e+t.staked_count*(t.rewards_per_hour.pxj+t.rewards_per_hour.wuf),0);y(e)},[o]),t?H.jsxs("div",{className:"staking-container",children:[H.jsx("div",{className:"staking-header",children:H.jsxs("div",{className:"header-content",children:[H.jsx("h1",{children:"NFT Staking Dashboard"}),H.jsxs("button",{className:"refresh-btn",onClick:async()=>{c(!0),await Promise.all([X(),z(),J()]),c(!1)},disabled:l,children:[l?"\ud83d\udd04":"\u21bb"," Refresh"]})]})}),H.jsx("div",{className:"staking-portal-section",children:H.jsxs("div",{className:"portal-card",children:[H.jsxs("div",{className:"portal-header",children:[H.jsx("div",{className:"portal-icon",children:"\ud83d\ude80"}),H.jsxs("div",{className:"portal-info",children:[H.jsx("h2",{children:"Advanced Staking Portal"}),H.jsx("p",{children:"Access our comprehensive staking platform with advanced features, analytics, and enhanced rewards management."})]})]}),H.jsxs("div",{className:"portal-features",children:[H.jsxs("div",{className:"feature-item",children:[H.jsx("span",{className:"feature-icon",children:"\ud83d\udcca"}),H.jsx("span",{children:"Advanced Analytics"})]}),H.jsxs("div",{className:"feature-item",children:[H.jsx("span",{className:"feature-icon",children:"\u26a1"}),H.jsx("span",{children:"Enhanced Rewards"})]}),H.jsxs("div",{className:"feature-item",children:[H.jsx("span",{className:"feature-icon",children:"\ud83d\udd27"}),H.jsx("span",{children:"Advanced Tools"})]})]}),H.jsx("div",{className:"portal-actions",children:H.jsxs("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary portal-btn",children:["Launch Staking Portal",H.jsx("svg",{className:"external-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})})]})}),H.jsxs("div",{className:"stats-bar",style:{display:"none"},children:[H.jsxs("div",{className:"stat",children:[H.jsx(za,{src:"/img/tokens/pxj.png",alt:"PXJ"}),H.jsx("span",{children:"PXJ Balance: 0"})]}),H.jsxs("div",{className:"stat",children:[H.jsx(za,{src:"/img/tokens/wuf.png",alt:"WUF"}),H.jsx("span",{children:"WUF Balance: 0"})]})]}),H.jsxs("div",{className:"dashboard-row",children:[H.jsxs("div",{className:"rewards-section",id:"rewardsSection",style:{display:h.pxj>0||h.wuf>0?"block":"none"},children:[H.jsxs("div",{className:"rewards-header",children:[H.jsx("h3",{children:"Claimable Rewards"}),H.jsx("div",{className:"simulation-toggle",onClick:()=>T(!P),children:H.jsx("div",{className:"toggle "+(P?"active":"")})})]}),H.jsxs("div",{id:"claimableRewards",children:[h.pxj.toFixed(2)," PXJ + ",h.wuf.toFixed(2)," WUF"]}),H.jsx("button",{className:"claim-btn",onClick:async()=>{if(e)if(0!==h.pxj||0!==h.wuf){c(!0);try{const t=await Ma.claimAllRewards(e,"pixeljourney");if(t.success){const t=`PXJ: ${h.pxj.toFixed(1)} | WUF: ${h.wuf.toFixed(1)}`;n("Success",`Rewards claimed successfully! ${t}`),u({pxj:0,wuf:0}),await z();const a=Date.now();localStorage.setItem(`lastClaimTime_${e.actor}`,a.toString())}else r("Error",t.error||"Failed to claim rewards")}catch(t){se.error("Failed to claim rewards","Staking",t),r("Error","Failed to claim rewards. Please try again.")}finally{c(!1)}}else r("Error","No rewards available to claim");else r("Error","Please connect your wallet first")},disabled:l,children:l?"Claiming...":"Claim All Rewards"}),P&&H.jsx("div",{className:"simulation-status",children:"\ud83d\udd34 SIMULATION MODE ACTIVE"})]}),H.jsxs("div",{className:"quick-claim-section",children:[H.jsx("h4",{children:"Quick Actions"}),H.jsx("button",{className:"quick-claim-btn",onClick:()=>x(!0),children:"Open Crafting"})]})]}),v>0&&H.jsxs("div",{className:"total-power",children:[H.jsx("h3",{children:"Total Staking Power"}),H.jsxs("div",{className:"power-value-container",children:[H.jsx("div",{className:"power-value",children:v.toFixed(1)}),H.jsx("div",{className:"power-rate",children:"/hr"})]}),H.jsx("p",{children:"Combined rewards per hour from all staked NFTs"})]}),H.jsxs("div",{className:"token-staking-section",children:[H.jsxs("div",{className:"token-staking-header",children:[H.jsx("h2",{children:"PXJ Token Staking"}),H.jsx("p",{className:"section-description",children:"Stake your PXJ tokens in the pxjfarm1 to earn additional rewards"})]}),O?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading token staking data..."})]}):H.jsxs("div",{className:"token-staking-content",children:[E&&H.jsxs("div",{className:"token-farm-card",children:[H.jsxs("div",{className:"farm-header",children:[H.jsx("div",{className:"farm-icon",children:H.jsx(za,{src:"/img/tokens/pxj.png",alt:"PXJ"})}),H.jsxs("div",{className:"farm-info",children:[H.jsx("h3",{children:E.farm_name}),H.jsx("p",{className:"farm-description",children:"PXJ Token Farm"})]})]}),H.jsxs("div",{className:"farm-stats",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-label",children:"Total Staked"}),H.jsxs("div",{className:"stat-value",children:[E.total_staked.toLocaleString()," PXJ"]})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-label",children:"Vesting Period"}),H.jsxs("div",{className:"stat-value",children:[Math.floor(E.vesting_time/86400)," days"]})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-label",children:"Your Balance"}),H.jsxs("div",{className:"stat-value",children:[j.toLocaleString()," PXJ"]})]})]}),$&&H.jsxs("div",{className:"user-position",children:[H.jsx("h4",{children:"Your Staking Position"}),H.jsxs("div",{className:"position-stats",children:[H.jsxs("div",{className:"position-item",children:[H.jsx("span",{className:"label",children:"Staked:"}),H.jsxs("span",{className:"value",children:[$.staked_amount.toLocaleString()," PXJ"]})]}),H.jsxs("div",{className:"position-item",children:[H.jsx("span",{className:"label",children:"Pending Rewards:"}),H.jsx("span",{className:"value",children:$.pending_rewards.length>0?$.pending_rewards.map(e=>`${e.amount.toFixed(4)} ${e.token}`).join(", "):"None"})]}),H.jsxs("div",{className:"position-item",children:[H.jsx("span",{className:"label",children:"Unlock Time:"}),H.jsx("span",{className:"value",children:$.vesting_time>Date.now()/1e3?`${Math.ceil(($.vesting_time-Date.now()/1e3)/86400)} days remaining`:"Available now"})]})]})]}),H.jsxs("div",{className:"token-actions",children:[H.jsx("button",{className:"btn btn-primary",onClick:()=>q("stake"),disabled:!t||j<=0,children:"Stake PXJ"}),H.jsx("button",{className:"btn btn-secondary",onClick:()=>q("unstake"),disabled:!t||!$||$.staked_amount<=0,children:"Unstake PXJ"}),H.jsx("button",{className:"btn btn-accent",onClick:()=>q("claim"),disabled:!t||!$||0===$.pending_rewards.length,children:"Claim Rewards"})]})]}),!t&&H.jsxs("div",{className:"connect-prompt",children:[H.jsx("h3",{children:"Connect Your Wallet"}),H.jsx("p",{children:"Connect your WAX wallet to view and manage your PXJ token staking"}),H.jsx("button",{className:"btn btn-primary",onClick:a,children:"Connect Wallet"})]})]})]}),H.jsxs("div",{className:"nft-staking-section",children:[H.jsxs("div",{className:"nft-staking-header",children:[H.jsx("h2",{children:"Pixel Journey NFT Staking"}),H.jsx("p",{className:"section-description",children:"Stake your ingredients to earn PXJ and WUF rewards"})]}),m?H.jsxs("div",{className:"loading-state",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("p",{children:"Loading NFT staking data..."})]}):H.jsx("div",{className:"template-grid",children:o.map(e=>H.jsxs("div",{className:"template-card",children:[H.jsxs("div",{className:"template-image",style:{backgroundImage:`url(${e.image})`},children:[e.owned_count>0&&H.jsx("div",{className:"asset-count",children:e.owned_count}),e.staked_count>0&&H.jsxs("div",{className:"staked-count",children:["\u26a1",e.staked_count]}),H.jsx("div",{className:"rarity-badge",style:{backgroundColor:Y(e.rarity)},children:e.rarity}),e.image.includes("placeholder")?e.name:null]}),H.jsxs("div",{className:"template-info",children:[H.jsxs("div",{className:"template-header",children:[H.jsx("div",{className:"template-name",children:e.name}),H.jsxs("div",{className:"template-apr",children:[e.apr,"% APR"]})]}),H.jsxs("div",{className:"template-stats",children:[H.jsxs("div",{className:"stat-row",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:e.rewards_per_hour.pxj}),H.jsx("div",{className:"stat-label",children:"PXJ/hr"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:e.rewards_per_hour.wuf}),H.jsx("div",{className:"stat-label",children:"WUF/hr"})]})]}),H.jsx("div",{className:"staking-status",children:H.jsxs("span",{children:["Staked: ",e.staked_count,"/",e.owned_count]})})]}),H.jsx("div",{className:"template-actions",children:e.owned_count>0?H.jsx("button",{className:"btn btn-primary",onClick:()=>(e=>{b(e),w(!0)})(e),children:"Manage Staking"}):H.jsx("button",{className:"btn btn-secondary",onClick:()=>V(e),children:"Quick Buy"})})]})]},e.template_id))})]}),H.jsxs("div",{className:"crafting-mechanics",children:[H.jsx("h2",{children:"PXJ Lockup & Crafting Mechanics"}),H.jsxs("div",{className:"mechanics-content",children:[H.jsxs("div",{className:"mechanics-overview",children:[H.jsx("h3",{children:"\ud83d\udd12 PXJ Lockup System"}),H.jsx("p",{children:"Lock your PXJ tokens to participate in advanced crafting and upgrade systems. Each month, we distribute additional NFT rewards to collectors based on their PXJ lockup value."}),H.jsx("div",{className:"leaderboard-info",children:H.jsxs("div",{className:"leaderboard-card",children:[H.jsxs("div",{className:"leaderboard-header",children:[H.jsx("span",{className:"leaderboard-icon",children:"\ud83c\udfc6"}),H.jsx("h4",{children:"Monthly Leaderboard Rewards"})]}),H.jsxs("div",{className:"leaderboard-details",children:[H.jsxs("p",{children:[H.jsx("strong",{children:"Entry Requirement:"})," 25,000 PXJ locked per entry"]}),H.jsx("p",{children:"Rewards distributed based on upgraded ingredient lockup value"}),H.jsx("a",{href:"https://lb.pixeljourney.xyz/",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",children:"View Leaderboard"})]})]})})]}),H.jsxs("div",{className:"crafting-process",children:[H.jsx("h3",{children:"\u2697\ufe0f Ingredient Combination System"}),H.jsxs("div",{className:"process-flow",children:[H.jsxs("div",{className:"process-step",children:[H.jsx("div",{className:"step-icon",children:"\ud83e\uddea"}),H.jsx("h4",{children:"Primary Ingredients"}),H.jsx("p",{children:"Common base materials that form the foundation of all crafting recipes"})]}),H.jsx("div",{className:"process-arrow",children:"\u2192"}),H.jsxs("div",{className:"process-step",children:[H.jsx("div",{className:"step-icon",children:"\u26a1"}),H.jsx("h4",{children:"Secondary Ingredients"}),H.jsx("p",{children:"Rare catalysts that enhance and modify the properties of primary ingredients"})]}),H.jsx("div",{className:"process-arrow",children:"\u2192"}),H.jsxs("div",{className:"process-step",children:[H.jsx("div",{className:"step-icon",children:"\ud83d\udc8e"}),H.jsx("h4",{children:"Tertiary Ingredients"}),H.jsx("p",{children:"Epic components that unlock powerful abilities and unique traits"})]}),H.jsx("div",{className:"process-arrow",children:"\u2192"}),H.jsxs("div",{className:"process-step",children:[H.jsx("div",{className:"step-icon",children:"\ud83c\udf1f"}),H.jsx("h4",{children:"Black Ingredients"}),H.jsx("p",{children:"Legendary materials that create the most powerful and sought-after items"})]})]})]}),H.jsx("div",{className:"learn-more-section",children:H.jsxs("div",{className:"learn-more-card",children:[H.jsx("h3",{children:"\ud83d\udcda Want to Learn More?"}),H.jsx("p",{children:"Dive deeper into the Pixel Journey ecosystem with our comprehensive documentation covering all aspects of crafting, staking, and gameplay mechanics."}),H.jsxs("div",{className:"learn-actions",children:[H.jsx(s,{to:"/learn",className:"btn-primary",children:"Visit Learn Page"}),H.jsx("a",{href:"https://docs.pixeljourney.xyz/season-1/recycling-and-crafting",target:"_blank",rel:"noopener noreferrer",className:"btn-secondary",children:"Journey Docs"})]})]})})]})]}),H.jsx(En,{isOpen:N,onClose:()=>{w(!1),b(null)},templateId:g?.template_id||"",templateName:g?.name||"",action:"stake",onSuccess:()=>{X(),z()}}),H.jsx(Mn,{isOpen:M,onClose:()=>{L(!1)},action:W,farmName:"pxjfarm1",onSuccess:()=>{J(),z()}}),H.jsx(xa,{isOpen:k,onClose:()=>x(!1),ingredient:null}),H.jsx(Rn,{template:_,isOpen:C,onClose:G})]}):H.jsxs("div",{className:"staking-container",children:[H.jsxs("div",{className:"connect-wallet-prompt",children:[H.jsx("h2",{children:"Connect Your Wallet"}),H.jsx("p",{children:"Connect your WAX wallet to access NFT staking features"}),H.jsx("button",{className:"btn btn-primary",onClick:a,children:"Connect Wallet"})]}),H.jsxs("div",{className:"nft-staking-section",children:[H.jsx("h2",{children:"Pixel Journey NFT Staking"}),H.jsx("p",{className:"section-description",children:"Stake your Pixel Journey ingredients to earn PXJ and WUF rewards"}),H.jsx("div",{className:"template-grid",children:U.map(e=>H.jsxs("div",{className:"template-card",children:[H.jsxs("div",{className:"template-image",children:[H.jsx(Ua,{src:e.image,alt:e.name,width:160,height:160,fallbackText:e.name}),H.jsx("div",{className:"rarity-badge",style:{backgroundColor:Y(e.rarity)},children:e.rarity})]}),H.jsxs("div",{className:"template-info",children:[H.jsxs("div",{className:"template-header",children:[H.jsx("div",{className:"template-name",children:e.name}),H.jsxs("div",{className:"template-apr",children:[e.apr,"% APR"]})]}),H.jsxs("div",{className:"template-stats",children:[H.jsxs("div",{className:"stat-row",children:[H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:e.rewards_per_hour.pxj}),H.jsx("div",{className:"stat-label",children:"PXJ/hr"})]}),H.jsxs("div",{className:"stat-item",children:[H.jsx("div",{className:"stat-value",children:e.rewards_per_hour.wuf}),H.jsx("div",{className:"stat-label",children:"WUF/hr"})]})]}),H.jsx("div",{className:"staking-status",children:H.jsx("span",{children:"Connect wallet to view your assets"})})]}),H.jsx("div",{className:"template-actions",children:H.jsx("button",{className:"btn btn-secondary",onClick:()=>V(e),children:"Quick Buy"})})]})]},e.template_id))})]}),H.jsx(Rn,{template:_,isOpen:C,onClose:G})]})},Bn=new class{constructor(){t(this,"baseUrl","https://wax-api.hivebp.io/api")}async getAttributeFilters(e,t){try{const a=new URL(`${this.baseUrl}/filter-attributes/${e}`);t&&a.searchParams.append("schema",t);const n=await fetch(a.toString());if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.json()}catch(a){return se.error("Error fetching attribute filters from API, will use fallback","AttributeService",a),{}}}extractAttributesFromNFTs(e,t){const a=new Map;(t?e.filter(e=>e.schema===t):e).forEach(e=>{e.traits&&Object.entries(e.traits).forEach(([e,t])=>{if(null!=t){a.has(e)||a.set(e,new Map);const n=a.get(e),i=String(t),r=n.get(i)||0;n.set(i,r+1)}})});const n={};return a.forEach((e,t)=>{const a=[];e.forEach((e,t)=>{a.push({value:t,numMinted:e,maxSupply:e})}),a.sort((e,t)=>t.numMinted-e.numMinted),n[t]={values:a}}),n}formatAttributesForQuery(e){const t=[];return Object.entries(e).forEach(([e,a])=>{a.forEach(a=>{t.push(`${e}:${encodeURIComponent(a)}`)})}),t.join("&")}parseAttributeQuery(e){const t={};return e?(e.split("&").forEach(e=>{const[a,n]=e.split(":");if(a&&n){const e=decodeURIComponent(n);t[a]||(t[a]=[]),t[a].push(e)}}),t):t}},jn=({isOpen:e,onClose:t,onSuccess:a})=>{const{account:n}=Ta(),{showSuccess:r,showError:s}=We(),[l,o]=i.useState([]),[d,h]=i.useState([]),[u,m]=i.useState(new Set),[p,f]=i.useState(null),[v,y]=i.useState(!1),[g,b]=i.useState(""),[N,w]=i.useState(1),[k,x]=i.useState(0),C=i.useCallback(async(e=1)=>{if(n){y(!0),b("");try{const t=12*(e-1),a=await Fa.getUserPixalAssets(n,12,t);o(a),x(a.length)}catch(t){se.error("Failed to load user Pixal assets","TokenizeFromInventoryModal.loadUserAssets",t,{account:n,page:e}),b("Failed to load your Pixal assets. Please try again."),s("Failed to load assets")}finally{y(!1)}}},[n,12,s]),A=i.useCallback(async()=>{try{const e=await Fa.getFeeTokens();h(e)}catch(e){se.error("Failed to load fee tokens","TokenizeFromInventoryModal.loadFeeTokens",e),s("Failed to load fee tokens")}},[s]);i.useEffect(()=>{e&&n&&(C(N),A())},[e,n,N,C,A]);const _=e=>{w(e),m(new Set)};if(!e)return null;const S=Math.ceil(k/12),P=u.size;return c.createPortal(H.jsx("div",{className:"modal-overlay",onClick:t,children:H.jsxs("div",{className:"tokenize-inventory-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Tokenize from Inventory"}),H.jsx("button",{className:"close-button",onClick:t,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[g&&H.jsx("div",{className:"error-message",children:g}),H.jsxs("div",{className:"selection-controls",children:[H.jsx("div",{className:"selection-info",children:H.jsxs("span",{children:[P," asset",1!==P?"s":""," selected"]})}),H.jsxs("div",{className:"selection-actions",children:[H.jsx("button",{className:"select-all-btn",onClick:()=>{const e=new Set(l.map(e=>e.assetId.toString()));m(e)},disabled:v,children:"Select All on Page"}),H.jsx("button",{className:"clear-all-btn",onClick:()=>{m(new Set)},disabled:v||0===P,children:"Clear All"})]})]}),H.jsxs("div",{className:"assets-section",children:[H.jsx("h3",{children:"Your Pixal Assets"}),v?H.jsxs("div",{className:"loading-spinner",children:[H.jsx("div",{className:"spinner"}),H.jsx("p",{children:"Loading your assets..."})]}):H.jsx("div",{className:"assets-grid",children:l.map(e=>H.jsxs("div",{className:"asset-card "+(u.has(e.assetId.toString())?"selected":""),onClick:()=>(e=>{const t=new Set(u);t.has(e)?t.delete(e):t.add(e),m(t)})(e.assetId.toString()),children:[H.jsxs("div",{className:"asset-image-container",children:[H.jsx(Rt,{imageUrl:e.image,alt:e.name,className:"asset-image"}),u.has(e.assetId.toString())&&H.jsx("div",{className:"selection-indicator",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})})]}),H.jsxs("div",{className:"asset-info",children:[H.jsx("h4",{className:"asset-name",children:e.name}),H.jsxs("p",{className:"asset-id",children:["#",e.assetId.toString()]})]})]},e.assetId))}),S>1&&H.jsxs("div",{className:"pagination",children:[H.jsx("button",{className:"pagination-btn",onClick:()=>_(N-1),disabled:1===N||v,children:"Previous"}),H.jsxs("span",{className:"pagination-info",children:["Page ",N," of ",S]}),H.jsx("button",{className:"pagination-btn",onClick:()=>_(N+1),disabled:N===S||v,children:"Next"})]})]}),P>0&&H.jsxs("div",{className:"fee-selection",children:[H.jsx("h3",{children:"Select Fee Token"}),H.jsx("div",{className:"fee-tokens-grid",children:d.map((e,t)=>H.jsxs("div",{className:"fee-option "+(p===e?"selected":""),onClick:()=>f(e),children:[H.jsxs("div",{className:"fee-info",children:[H.jsx("span",{className:"fee-amount",children:e.fee}),H.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&H.jsxs("div",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]})]}),H.jsxs("div",{className:"modal-footer",children:[H.jsx("button",{className:"cancel-button",onClick:t,disabled:v,children:"Cancel"}),H.jsx("button",{className:"tokenize-button",onClick:async()=>{if(n&&0!==u.size&&p){y(!0);try{const e=Array.from(u),n=await Fa.executeTokenization(e,p);r(`Tokenization transaction prepared for ${e.length} asset(s)`),se.info("Tokenization transaction prepared","TokenizeFromInventoryModal.executeTokenization",{assetIds:e,feeToken:p.symbol,transaction:n}),m(new Set),f(null),t(),a&&a()}catch(e){se.error("Tokenization execution failed","TokenizeFromInventoryModal.executeTokenization",e,{assetIds:Array.from(u),feeToken:p?.symbol}),s("Tokenization failed. Please try again.")}finally{y(!1)}}else s("Please select assets and a fee token")},disabled:v||0===P||!p,children:v?"Processing...":`Tokenize ${P} Asset${1!==P?"s":""}`})]})]})}),document.body)},Dn=({asset:e,isOpen:t,onClose:a,onRedeem:n})=>{const{account:r}=Ta(),{showError:s}=We(),[l,c]=i.useState([]),[o,d]=i.useState(null),[h,u]=i.useState(!1),[m,p]=i.useState(!1),f=async()=>{try{const e=await Fa.getFeeTokens();c(e)}catch(e){se.error("Failed to load fee tokens","AssetDetailModal.loadFeeTokens",e),s("Failed to load fee tokens")}};return i.useEffect(()=>{t&&e&&f()},[t,e,f]),t&&e?H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"asset-detail-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h2",{children:"Asset Details"}),H.jsx("button",{className:"close-button",onClick:a,children:"\xd7"})]}),H.jsxs("div",{className:"modal-body",children:[H.jsxs("div",{className:"asset-main-info",children:[H.jsx("div",{className:"asset-image-section",children:H.jsx(Rt,{imageUrl:e.image,alt:e.name,className:"asset-image"})}),H.jsxs("div",{className:"asset-info-section",children:[H.jsx("h3",{className:"asset-name",children:e.name}),H.jsxs("div",{className:"asset-metadata",children:[H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Asset ID:"}),H.jsx("span",{className:"value",children:e.assetId})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Collection:"}),H.jsx("span",{className:"value",children:e.collection?.displayName||e.collection?.collectionName})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Schema:"}),H.jsx("span",{className:"value",children:e.schema})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Mint #:"}),H.jsx("span",{className:"value",children:e.mint})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Template ID:"}),H.jsx("span",{className:"value",children:e.template?.templateId})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"WPIXAL Amount:"}),H.jsxs("span",{className:"value highlight",children:[e.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),e.rarityScore&&H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Rarity Score:"}),H.jsx("span",{className:"value highlight",children:e.rarityScore.toFixed(2)})]}),e.attributesFloor&&H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Attributes Floor:"}),H.jsxs("span",{className:"value highlight",children:[e.attributesFloor.toFixed(8)," WPIXAL"]})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Contract:"}),H.jsx("span",{className:"value",children:e.contract})]}),H.jsxs("div",{className:"metadata-item",children:[H.jsx("span",{className:"label",children:"Owner:"}),H.jsx("span",{className:"value",children:e.owner})]})]}),e.immutableData&&e.immutableData.length>0&&H.jsxs("div",{className:"asset-attributes",children:[H.jsx("h4",{children:"NFT Traits"}),H.jsx("div",{className:"attributes-grid",children:e.immutableData.filter(({key:e,value:t})=>!["image","img","video","audio","model","description","name"].includes(e.toLowerCase())&&t&&null!==t[1]&&void 0!==t[1]&&""!==t[1]).map(({key:e,value:t})=>{const a=e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),n=Array.isArray(t)?t[1]:t;return H.jsxs("div",{className:"trait-item",children:[H.jsx("div",{className:"trait-label",children:a}),H.jsx("div",{className:"trait-value",children:String(n)})]},e)})}),(()=>{const t=e.immutableData.find(e=>"description"===e.key.toLowerCase()),a=t?Array.isArray(t.value)?t.value[1]:t.value:null;return a&&String(a).trim()?H.jsxs("div",{className:"asset-description",children:[H.jsx("h4",{children:"Description"}),H.jsx("p",{children:String(a)})]}):null})()]})]})]}),r&&H.jsx("div",{className:"redemption-section",children:m?H.jsxs("div",{className:"redeem-form",children:[H.jsx("h4",{children:"Redeem Asset"}),H.jsxs("p",{className:"redeem-description",children:["Redeem this tokenized asset by paying ",e.rwax.redeemAmount.toFixed(8)," WPIXAL plus a fee."]}),H.jsxs("div",{className:"fee-selection",children:[H.jsx("h5",{children:"Select Fee Token:"}),H.jsx("div",{className:"fee-options",children:l.map((e,t)=>H.jsxs("div",{className:"fee-option "+(o===e?"selected":""),onClick:()=>d(e),children:[H.jsxs("div",{className:"fee-info",children:[H.jsx("span",{className:"fee-amount",children:e.fee}),H.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&H.jsxs("div",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]}),H.jsxs("div",{className:"redeem-actions",children:[H.jsx("button",{className:"cancel-redeem-button",onClick:()=>p(!1),children:"Cancel"}),H.jsx("button",{className:"confirm-redeem-button",onClick:async()=>{if(e&&o&&r){u(!0);try{n&&await n(e,o),a()}catch(t){se.error("Asset redemption failed","AssetDetailModal.handleRedeem",t,{assetId:e?.assetId,feeToken:o?.symbol}),s("Redemption failed. Please try again.")}finally{u(!1)}}else s("Please select a fee token")},disabled:!o||h,children:h?"Processing...":"Confirm Redemption"})]})]}):H.jsx("button",{className:"show-redeem-button",onClick:()=>p(!0),children:"Redeem this Asset"})}),!r&&H.jsx("div",{className:"wallet-connect-message",children:H.jsx("p",{children:"Connect your wallet to redeem this asset"})})]})]})}):null},Un=({limit:e=12,refreshInterval:t=3e4})=>{const[a,n]=i.useState([]),[r,s]=i.useState(!0),[l,c]=i.useState(null),[o,d]=i.useState(null),[h,u]=i.useState(1),[m,p]=i.useState(!0),[f,v]=i.useState(!1),y=i.useCallback(async(t=1,a=!1)=>{try{a?v(!0):(c(null),s(!0));const i=await $e.getRWAXTransfers({limit:e,page:t,order:"desc"});if(!i.success)throw new Error("Failed to fetch RWAX transactions");{const t=i.data;n(a?e=>[...e,...t]:t),p(t.length===e),d(new Date)}}catch(i){se.error("Error fetching RWAX transactions","RWAXLiveTransactions",i),a||c("Failed to load RWAX transactions")}finally{s(!1),v(!1)}},[e]);i.useEffect(()=>{y();const e=setInterval(()=>{y(1,!1),u(1)},t);return()=>clearInterval(e)},[e,t,y]);const g=e=>{try{const t=new Date(e);if(isNaN(t.getTime()))return"Unknown";const a=(new Date).getTime()-t.getTime(),n=Math.floor(a/6e4);return n<0||n<1?"Just now":n<60?`${n}m ago`:n<1440?`${Math.floor(n/60)}h ago`:`${Math.floor(n/1440)}d ago`}catch(t){return"Unknown"}},b=e=>"tokenization"===e?"Tokenized":"Redeemed";return r&&0===a.length?H.jsxs("div",{className:"rwax-live-transactions",children:[H.jsxs("div",{className:"rwax-live-transactions-header",children:[H.jsx("h3",{children:"Live RWAX Transactions"}),H.jsx("div",{className:"loading-spinner"})]}),H.jsx("div",{className:"transactions-loading",children:H.jsx("p",{children:"Loading RWAX transactions..."})})]}):l&&0===a.length?H.jsxs("div",{className:"rwax-live-transactions",children:[H.jsxs("div",{className:"rwax-live-transactions-header",children:[H.jsx("h3",{children:"Live RWAX Transactions"}),H.jsx("button",{onClick:()=>y(),className:"refresh-button",children:"\ud83d\udd04"})]}),H.jsxs("div",{className:"transactions-error",children:[H.jsx("p",{children:l}),H.jsx("button",{onClick:()=>y(),className:"retry-button",children:"Try Again"})]})]}):H.jsxs("div",{className:"rwax-live-transactions",children:[H.jsxs("div",{className:"rwax-live-transactions-header",children:[H.jsx("h3",{children:"Live RWAX Transactions"}),H.jsxs("div",{className:"header-actions",children:[o&&H.jsxs("span",{className:"last-update",children:["Updated ",g(o.toISOString())]}),H.jsx("button",{onClick:()=>{y(1,!1),u(1)},className:"refresh-button",disabled:r,children:r?"\u23f3":"\ud83d\udd04"})]})]}),H.jsx("div",{className:"rwax-transactions-grid",children:0===a.length?H.jsx("div",{className:"no-transactions",children:H.jsx("p",{children:"No recent RWAX transactions found"})}):a.map((e,t)=>{return H.jsxs("div",{className:"rwax-transaction-card",children:[H.jsxs("div",{className:"transaction-header",children:[H.jsxs("div",{className:"transaction-type",children:[H.jsx("span",{className:"transaction-icon",children:(a=e.type,"tokenization"===a?"\ud83d\udd04":"\ud83c\udf81")}),H.jsx("span",{className:`transaction-label ${e.type}`,children:b(e.type)})]}),H.jsx("span",{className:"transaction-time",children:g(e.created_at_time)})]}),H.jsxs("div",{className:"transaction-assets",children:[e.assets.slice(0,1).map(e=>{return H.jsxs("div",{className:"asset-preview",children:[H.jsx(Rt,{imageUrl:(t=e.data?.img,t?t.startsWith("Qm")||t.startsWith("baf")?`https://ipfs.io/ipfs/${t}`:t.startsWith("/")?`https://ipfs.io/ipfs${t}`:t:"/placeholder-nft.png"),alt:e.name||"Unknown Asset",className:"asset-image"}),H.jsxs("div",{className:"asset-info",children:[H.jsx("h4",{className:"asset-name",children:e.name||"Unknown Asset"}),H.jsxs("p",{className:"asset-mint",children:["#",e.template_mint||e.asset_id||"N/A"]})]})]},e.asset_id);var t}),e.assets.length>1&&H.jsxs("div",{className:"additional-assets",children:["+",e.assets.length-1," more"]})]}),H.jsxs("div",{className:"transaction-details",children:[H.jsxs("div",{className:"transaction-accounts",children:[H.jsxs("span",{className:"account from",children:["From: ",e.sender_name.length>8?`${e.sender_name.slice(0,6)}...`:e.sender_name]}),H.jsxs("span",{className:"account to",children:["To: ",e.recipient_name.length>8?`${e.recipient_name.slice(0,6)}...`:e.recipient_name]})]}),H.jsx("div",{className:"transaction-actions",children:H.jsx("button",{className:"view-tx-button",onClick:()=>window.open(`https://waxblock.io/transaction/${e.txid}`,"_blank"),title:"View on WAX Block Explorer",children:"\ud83d\udd17"})})]})]},`${e.txid}-${e.transfer_id}-${t}`);var a})}),m&&H.jsx("div",{className:"load-more-section",children:H.jsx("button",{onClick:async()=>{if(!f&&m){const e=h+1;u(e),await y(e,!0)}},className:"load-more-button",disabled:f,children:f?H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"loading-spinner small"}),"Loading more..."]}):"Load More Transactions"})})]})},Xn={Background:["Nefty Spot","Blue Sky","Forest","Desert","Ocean","Mountain","City","Space","Sunset","Rainbow"],Body:["Pink-Blue Overalls","Red Shirt","Blue Hoodie","Green Jacket","Yellow Dress","Purple Suit","Orange Tank","Black Tee","White Polo","Gray Sweater"],Eyes:["Kawaii Green","Brown","Blue","Hazel","Gray","Amber","Violet","Red","Black","Gold"],Head:["Grey","Black Hair","Brown Hair","Blonde Hair","Red Hair","Blue Hair","Green Hair","Purple Hair","Bald","Hat"]},zn=({onFiltersChange:e,initialFilters:t={}})=>{const[a,n]=i.useState({});i.useEffect(()=>{const e={};Object.keys(Xn).forEach(a=>{e[a]={isExpanded:!1,selectedValues:new Set(t[a]||[]),searchTerm:""}}),n(e)},[]);const r=i.useCallback((e,t)=>{n(a=>{const n={...a};n[e]||(n[e]={isExpanded:!1,selectedValues:new Set,searchTerm:""});const i=new Set(n[e].selectedValues);return i.has(t)?i.delete(t):i.add(t),n[e]={...n[e],selectedValues:i},n})},[]),s=i.useCallback(e=>{n(t=>({...t,[e]:{...t[e],isExpanded:!t[e]?.isExpanded}}))},[]),l=i.useCallback((e,t)=>{n(a=>({...a,[e]:{...a[e],searchTerm:t}}))},[]),c=i.useCallback(()=>{const e={};Object.keys(Xn).forEach(t=>{e[t]={isExpanded:!1,selectedValues:new Set,searchTerm:""}}),n(e)},[]);i.useEffect(()=>{const t={};Object.entries(a).forEach(([e,a])=>{a.selectedValues.size>0&&(t[e]=Array.from(a.selectedValues))}),e(t)},[a,e]);const o=Object.values(a).reduce((e,t)=>e+t.selectedValues.size,0);return H.jsxs("div",{className:"attribute-filter-container",children:[H.jsxs("div",{className:"filter-header",children:[H.jsx("h3",{children:"Pixal Traits"}),o>0&&H.jsxs("button",{className:"clear-all-button",onClick:c,children:["Clear All (",o,")"]})]}),Object.entries(Xn).map(([e])=>{const t=a[e],n=(e=>{const t=a[e]?.searchTerm?.toLowerCase()||"",n=Xn[e]||[];return t?n.filter(e=>e.toLowerCase().includes(t)):n})(e),i=t?.selectedValues.size||0;return H.jsxs("div",{className:"filter-group",children:[H.jsxs("div",{className:"filter-group-header",onClick:()=>s(e),children:[H.jsxs("div",{className:"attribute-name",children:[e,i>0&&H.jsx("span",{className:"selected-count",children:i})]}),H.jsx("div",{className:"expand-icon "+(t?.isExpanded?"expanded":""),children:"\u25bc"})]}),t?.isExpanded&&H.jsxs("div",{className:"filter-group-content",children:[H.jsx("input",{type:"text",placeholder:`Search ${e.toLowerCase()}...`,value:t.searchTerm,onChange:t=>l(e,t.target.value),className:"attribute-search"}),H.jsx("div",{className:"attribute-values",children:n.length>0?n.map(a=>{const n=t.selectedValues.has(a);return H.jsx("div",{className:"attribute-value-item "+(n?"selected":""),onClick:()=>r(e,a),children:H.jsx("span",{className:"attribute-value-text",children:a})},a)}):H.jsxs("div",{className:"no-results",children:["No ",e.toLowerCase(),' found matching "',t.searchTerm,'"']})})]})]},e)})]})},Hn=()=>{const e=l(),{account:t,session:a}=Ta(),{showSuccess:n,showError:r}=We(),[s,c]=i.useState("redeem"),[o,d]=i.useState([]),[h,u]=i.useState([]),[m,p]=i.useState(!1),[f,v]=i.useState(null),[y,g]=i.useState(!1),[b,N]=i.useState(!1),[w,k]=i.useState(!1),[x,C]=i.useState(!1),[A,_]=i.useState(!1),[S,P]=i.useState(null),[T,$]=i.useState(null),[F,E]=i.useState(null),[I,M]=i.useState("confirm"),[L,W]=i.useState(""),[R,O]=i.useState(new Set),[B,j]=i.useState(!1),[D,U]=i.useState(null),[X,z]=i.useState(!1),[J,q]=i.useState(0),[V,G]=i.useState(0),[Y,K]=i.useState(0),[Q,Z]=i.useState(!1),[ee,te]=i.useState({min:"",max:""}),[ae,ne]=i.useState(0),[ie,re]=i.useState(!1),[le]=i.useState(null),[ce,oe]=i.useState(10),[de,he]=i.useState(!1),[ue,me]=i.useState(null),[pe,fe]=i.useState(!1),[ye,ge]=i.useState(""),[be,Ne]=i.useState("0.0000 WAX"),[we,ke]=i.useState(1),[xe,Ce]=i.useState(!0),[Ae,_e]=i.useState(!1),[Se,Pe]=i.useState("rarity_score_desc"),[Te,$e]=i.useState(""),[Fe,Ee]=i.useState({}),[Me,Le]=i.useState(""),[Re,Oe]=i.useState(new Set),[Be,je]=i.useState(new Map),De=i.useMemo(()=>{if(!Me.trim())return o;const e=Me.toLowerCase();return o.filter(t=>{if(t.name?.toLowerCase().includes(e))return!0;if(t.collection?.collectionName?.toLowerCase().includes(e)||t.collection?.displayName?.toLowerCase().includes(e))return!0;if(t.template?.templateId?.toString().includes(e))return!0;if(t.immutableData)for(const a of t.immutableData)if(a.key?.toLowerCase().includes(e)||a.value?.[1]?.toString().toLowerCase().includes(e))return!0;if(t.mutableData)for(const a of t.mutableData)if(a.key?.toLowerCase().includes(e)||a.value?.[1]?.toString().toLowerCase().includes(e))return!0;return!1})},[o,Me]),Ue=i.useCallback(async(e=1,t=!1)=>{se.debug("Loading tokenized assets","RWax.loadTokenizedAssets",{page:e,append:t,sortBy:Se,attributeFilters:Te});try{t?_e(!0):(p(!0),v(null));const a=36,n=(e-1)*a;se.debug("Calling rwaxService.getTokenizedAssets","RWax.loadTokenizedAssets",{limit:a,offset:n,sortBy:Se,attributeFilters:Te});const i=await Fa.getTokenizedAssets(a,n,Se,Te);se.info("Received tokenized assets","RWax.loadTokenizedAssets",{count:i.length}),d(t?e=>[...e,...i]:i),Ce(i.length===a)}catch(a){se.error("Error loading tokenized assets","RWax",a),t||v("Failed to load tokenized assets. Please try again later.")}finally{p(!1),_e(!1)}},[Se,Te]),Xe=i.useCallback(async()=>{const e=we+1;await Ue(e,!0),ke(e)},[we,Ue]),ze=i.useCallback(e=>{Pe(e),ke(1)},[]),He=i.useCallback(e=>{Ee(e);const t=Bn.formatAttributesForQuery(e);$e(t),ke(1)},[]);i.useEffect(()=>{const e=setTimeout(()=>{"redeem"===s&&Ue(1,!1)},300);return()=>clearTimeout(e)},[Se,Te,s]);const Je=i.useCallback(async()=>{try{const e=await Fa.getFeeTokens();u(e)}catch(e){se.error("Error loading fee tokens","RWax",e)}},[]),qe=i.useCallback(async()=>{try{const[e,t,a]=await Promise.all([ve.getWpixalPriceWAX(),ve.getWpixalPriceUSD(),ve.getWaxPriceUSD()]);G(e),K(t),ne(a)}catch(e){se.error("Error loading price data","RWax",e),G(.0177),K(9e-4),ne(.051),r("Price Loading Error","Unable to fetch current prices. Using fallback values.")}},[r]),Ve=i.useCallback(async()=>{if(t)try{const e=await Ie.getWaxBalance(t);Ne(e)}catch(e){se.error("Error loading WAX balance","RWax",e),Ne("0.0000 WAX")}else Ne("0.0000 WAX")},[t]);i.useEffect(()=>{Je(),qe(),Ve(),"redeem"===s&&Ue(1,!1)},[s,Ue,Je,qe,Ve]),i.useEffect(()=>{const e=setInterval(qe,3e5);return()=>clearInterval(e)},[qe]);const Ge=()=>{_(!1),M("confirm"),W(""),p(!1),P(null)},Ye=e=>{$(e),C(!0)},Ke=i.useCallback(()=>{Z(e=>!e)},[]),Qe=i.useCallback(()=>{Z(!1)},[]),Ze=e=>"rwax"in e&&e.rwax&&"redeemAmount"in e.rwax;i.useEffect(()=>{const e=localStorage.getItem("rwax-watchlist");if(e)try{const t=JSON.parse(e);Oe(new Set(t))}catch(t){se.error("Error loading watchlist","RWax",t)}},[]);const et=i.useCallback((e,t)=>{const a=parseFloat(e.rwax.redeemAmount.toString()),i={assetId:e.assetId.toString(),assetName:e.name,originalPrice:a,alertPercentage:t,createdAt:Date.now()},r=new Map(Be);r.set(e.assetId.toString(),i),je(r);const s=Array.from(r.entries());localStorage.setItem("rwax-price-alerts",JSON.stringify(s)),n(`Price alert set for ${e.name} at ${t}% change`)},[Be,n]),tt=i.useCallback(e=>{const t=new Map(Be);t.delete(e),je(t);const a=Array.from(t.entries());localStorage.setItem("rwax-price-alerts",JSON.stringify(a)),n("Price alert removed")},[Be,n]),at=i.useCallback(()=>{0!==Be.size&&0!==o.length&&Be.forEach((e,t)=>{const a=o.find(e=>e.assetId.toString()===t);if(!a)return r(`Alert: ${e.assetName} is no longer available on RWAX!`),void tt(t);const i=(parseFloat(a.rwax.redeemAmount.toString())-e.originalPrice)/e.originalPrice*100;if(Math.abs(i)>=e.alertPercentage){const t=i>0?"increased":"decreased";n(`Price Alert: ${e.assetName} has ${t} by ${Math.abs(i).toFixed(2)}%!`),et(a,e.alertPercentage)}})},[Be,o,r,n,tt,et]);return i.useEffect(()=>{const e=localStorage.getItem("rwax-price-alerts");if(e)try{const t=JSON.parse(e);je(new Map(t))}catch(t){se.error("Error loading price alerts","RWax",t)}},[]),i.useEffect(()=>{at()},[at]),H.jsxs("div",{className:"rwax-container",children:[H.jsxs("div",{className:"rwax-header",children:[H.jsxs("div",{className:"rwax-header-top",children:[H.jsxs("button",{className:"rwax-back-button",onClick:()=>e("/marketplace"),children:[H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Marketplace"]}),H.jsx("div",{className:"header-actions"})]}),H.jsx("h1",{children:"R-WAX Tokenization"}),H.jsx("p",{children:"Tokenize your Pixals to WPIXAL or redeem WPIXAL back to Pixals"}),H.jsxs("p",{style:{marginTop:"16px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Visit the ",H.jsx("a",{href:"https://r-wax.io/token/pixeljourney/WPIXAL",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary-purple)",textDecoration:"none",fontWeight:"500"},onMouseEnter:e=>e.target.style.textDecoration="underline",onMouseLeave:e=>e.target.style.textDecoration="none",children:"official RWAX website"})," for full WPIXAL markets and trading features."]})]}),H.jsxs("div",{className:"rwax-tabs",children:[H.jsx("button",{className:"tab-button "+("redeem"===s?"active":""),onClick:()=>c("redeem"),children:"WPIXAL to Pixal PFP"}),H.jsx("button",{className:"tab-button "+("other-collections"===s?"active":""),onClick:()=>c("other-collections"),children:"Other RWAX Collections"})]}),f&&H.jsx("div",{className:"error-message",children:f}),H.jsx("div",{className:"rwax-content",children:"redeem"===s?H.jsxs("div",{className:"redeem-section",children:[H.jsxs("div",{className:"actions-and-controls-container",children:[H.jsxs("div",{className:"left-actions",children:[H.jsx("div",{className:"action-group",children:H.jsx("button",{className:"inventory-tokenize-button",onClick:()=>k(!0),children:"Tokenize from Inventory"})}),H.jsxs("div",{className:"action-group",children:[H.jsxs("button",{className:"wpixal-alert-button "+(localStorage.getItem("wpixalPriceAlert")?"has-alert":""),onClick:()=>fe(!0),children:[H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),H.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"WPIXAL Price Alert"]}),localStorage.getItem("wpixalPriceAlert")&&H.jsxs("div",{className:"current-alert-display",children:[H.jsxs("span",{children:["Current Alert: ",localStorage.getItem("wpixalPriceAlert")," WAX"]}),H.jsx("button",{className:"remove-alert",onClick:e=>{e.stopPropagation(),localStorage.removeItem("wpixalPriceAlert"),ge("")},title:"Remove Alert",children:"\xd7"})]})]})]}),H.jsxs("div",{className:"sorting-and-filter-controls",children:[H.jsx("div",{className:"search-bar-container",children:H.jsxs("div",{className:"search-input-container",children:[H.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),H.jsx("input",{type:"text",placeholder:"Search R-WAX assets...",value:Me,onChange:e=>Le(e.target.value),className:"search-input"}),Me&&H.jsx("button",{onClick:()=>Le(""),className:"clear-search","aria-label":"Clear search",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})}),H.jsxs("div",{className:"sorting-controls",children:[H.jsx("label",{htmlFor:"sort-select",children:"Sort by:"}),H.jsxs("select",{id:"sort-select",value:Se,onChange:e=>ze(e.target.value),className:"sort-dropdown",children:[H.jsx("option",{value:"date_desc",children:"Date (Newest First)"}),H.jsx("option",{value:"date_asc",children:"Date (Oldest First)"}),H.jsx("option",{value:"price_desc",children:"Price (High to Low)"}),H.jsx("option",{value:"price_asc",children:"Price (Low to High)"}),H.jsx("option",{value:"floor_desc",children:"Floor Price (High to Low)"}),H.jsx("option",{value:"floor_asc",children:"Floor Price (Low to High)"}),H.jsx("option",{value:"mint_desc",children:"Mint Number (High to Low)"}),H.jsx("option",{value:"mint_asc",children:"Mint Number (Low to High)"}),H.jsx("option",{value:"rarity_score_desc",children:"Rarity Score (High to Low)"}),H.jsx("option",{value:"rarity_score_asc",children:"Rarity Score (Low to High)"})]}),H.jsx("button",{className:"filter-toggle-btn",onClick:Ke,title:"Open Filters",children:H.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]})]})]}),m?H.jsx("div",{className:"loading-spinner",children:"Loading tokenized assets..."}):H.jsxs(H.Fragment,{children:[De.length>0&&H.jsxs("div",{className:"multi-select-controls",children:[H.jsx("button",{className:"select-all-button",onClick:()=>{R.size===o.length?O(new Set):O(new Set(o.map(e=>e.assetId.toString())))},children:R.size===De.length?"Deselect All":"Select All"}),H.jsxs("div",{className:"selected-count-container",children:[H.jsxs("div",{className:"selected-count",children:[R.size," of ",De.length," selected"]}),xe&&H.jsx("button",{className:"load-more-small-button",onClick:Xe,disabled:Ae,title:"Load More Assets",children:Ae?"Loading...":"Load More"})]}),H.jsxs("button",{className:"batch-redeem-button",onClick:async()=>{if(0!==R.size)try{p(!0);const a=o.filter(e=>R.has(e.assetId.toString())),i=h.length>0?h[0]:null;if(!i)return void r("No fee tokens available for batch redemption");for(const n of a){if(!t)return void r("Please connect your wallet");try{const e=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:i.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:i.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${n.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${n.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:n.assetId.toString(),fee_currency:`8,${i.symbol}`}}],a=await Lt.transact(e);se.info(`Redemption transaction completed for ${n.name}`,"RWax.handleBatchRedemption",{assetId:n.assetId,result:a})}catch(e){se.error(`Error redeeming asset ${n.assetId}`,"RWax",e)}}n(`Successfully processed redemption for ${R.size} assets!`),O(new Set),Ue()}catch(a){se.error("Batch redemption failed","RWax",a),r("Batch redemption failed. Please try again.")}finally{p(!1)}},disabled:0===R.size||!t,children:["Batch Redeem (",R.size,")"]})]}),H.jsx("div",{className:"rwax-assets-grid",children:De.map((e,a)=>H.jsxs("div",{className:"asset-card "+(R.has(e.assetId.toString())?"selected":""),children:[H.jsx("div",{className:"selection-checkbox "+(R.has(e.assetId.toString())?"checked":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(R);t.has(e)?t.delete(e):t.add(e),O(t)})(e.assetId.toString())},children:R.has(e.assetId.toString())&&H.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:H.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}),H.jsxs("div",{className:"asset-card-content",onClick:()=>Ye(e),children:[H.jsxs("div",{className:"asset-image",children:[H.jsx(Rt,{imageUrl:e.image,alt:e.name,className:"nft-image"}),H.jsx("div",{className:"zoom-overlay",onClick:t=>{t.stopPropagation(),((e,t)=>{let a=e;e&&!e.startsWith("http")&&(e.startsWith("Qm")||e.startsWith("baf")?a=`https://ipfs.io/ipfs/${e}`:e.startsWith("/ipfs/")?a=`https://ipfs.io/ipfs/${e.replace("/ipfs/","")}`:e.startsWith("ipfs://")&&(a=e.replace("ipfs://","https://ipfs.io/ipfs/"))),U({url:a,name:t}),j(!0)})(e.image,e.name)},children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[H.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),H.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]}),H.jsxs("div",{className:"asset-info",children:[H.jsx("h3",{children:e.name}),H.jsxs("div",{className:"pricing-info",children:[H.jsxs("div",{className:"wpixal-amount",onClick:t=>{var a;t.stopPropagation(),a=parseFloat(e.rwax.redeemAmount.toString()),q(a),z(!0)},title:`Exact amount: ${e.rwax.redeemAmount} WPIXAL`,children:[parseFloat(e.rwax.redeemAmount.toString()).toFixed(1)," WPIXAL"]}),H.jsxs("div",{className:"rwax-price-convert",children:[H.jsxs("div",{className:"wax-price",children:["\u2248 ",(parseFloat(e.rwax.redeemAmount.toString())*V).toFixed(4)," WAX"]}),H.jsxs("div",{className:"usd-price",children:["\u2248 $",(parseFloat(e.rwax.redeemAmount.toString())*Y).toFixed(4)," USD"]})]})]})]})]}),H.jsxs("div",{className:"asset-actions",children:[H.jsx("button",{className:"redeem-button primary",onClick:t=>{t.stopPropagation(),(e=>{P(e),N(!0)})(e)},disabled:!t,children:"Redeem (WPIXAL)"}),H.jsxs("div",{className:"secondary-actions",children:[H.jsx("button",{className:"wax-redeem-button secondary",onClick:t=>{t.stopPropagation(),(e=>{P(e),_(!0),M("confirm"),W("")})(e)},disabled:!t,children:"Redeem (WAX)"}),H.jsx("button",{className:"info-button secondary",onClick:t=>{t.stopPropagation(),Ye(e)},children:"Info"})]}),H.jsxs("div",{className:"icon-actions",children:[H.jsx("button",{className:"btn-watchlist icon-only "+(Re.has(e.assetId.toString())?"active":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(Re);t.has(e)?(t.delete(e),n("Removed from watchlist")):(t.add(e),n("Added to watchlist")),Oe(t),localStorage.setItem("rwax-watchlist",JSON.stringify(Array.from(t)))})(e.assetId.toString())},title:Re.has(e.assetId.toString())?"Remove from Watchlist":"Add to Watchlist",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:Re.has(e.assetId.toString())?"currentColor":"none",stroke:"currentColor",children:H.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),H.jsx("button",{className:"btn-copy-link icon-only",onClick:t=>{t.stopPropagation();const a=`${window.location.origin}/asset/${e.assetId}`;navigator.clipboard.writeText(a).then(()=>{n("Asset link copied to clipboard!")}).catch(()=>{r("Failed to copy link")})},title:"Copy Link",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),H.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}),H.jsx("button",{className:"btn-share icon-only",onClick:t=>{t.stopPropagation(),(e=>{me(e),he(!0)})(e)},title:"Share Asset",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),H.jsx("polyline",{points:"16,6 12,2 8,6"}),H.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})})]})]})]},`${e.assetId}-${a}`))}),xe&&H.jsx("div",{className:"load-more-section",children:H.jsx("button",{className:"load-more-button",onClick:Xe,disabled:Ae,children:Ae?"Loading...":"Load More Assets"})})]})]}):"other-collections"===s?H.jsx("div",{className:"other-collections-section",children:H.jsxs("div",{className:"construction-message",children:[H.jsx("div",{className:"construction-icon",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:H.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})}),H.jsx("h2",{children:"Other RWAX Collections"}),H.jsx("p",{children:"Support for additional RWAX collections is coming soon!"}),H.jsx("div",{className:"construction-details",children:H.jsx("p",{children:"We're working on expanding RWAX tokenization to support more NFT collections beyond Pixals. Stay tuned for updates!"})})]})}):null}),y&&S&&H.jsx("div",{className:"rwax-modal-overlay",onClick:()=>g(!1),children:H.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"rwax-modal-header",children:[H.jsx("h2",{children:"Tokenize Pixal"}),H.jsx("button",{className:"rwax-close-button",onClick:()=>g(!1),children:"\xd7"})]}),H.jsxs("div",{className:"rwax-modal-body",children:[H.jsxs("div",{className:"selected-asset",children:[H.jsx(Rt,{imageUrl:S.image,alt:S.name,className:"modal-asset-image"}),H.jsx("h3",{children:S.name})]}),H.jsxs("div",{className:"fee-selection",children:[H.jsx("h4",{children:"Select Fee Token:"}),h.map((e,t)=>H.jsxs("div",{className:"fee-option "+(F===e?"selected":""),onClick:()=>E(e),children:[H.jsx("span",{className:"fee-amount",children:e.fee}),e.wax_value&&"WAX"!==e.symbol&&H.jsxs("span",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"cancel-button",onClick:()=>g(!1),children:"Cancel"}),H.jsx("button",{className:"confirm-button",onClick:async()=>{if(S&&F&&a&&t)try{const e=await Fa.executeTokenization([S.assetId.toString()],F);n("Tokenization transaction prepared"),se.info("Tokenization transaction prepared","RWax.handleTokenization",{transaction:e}),g(!1),setTimeout(()=>{Ue()},2e3)}catch(e){se.error("Error during tokenization","RWax",e),r("Tokenization failed. Please try again.")}else r("Please select an asset and fee token")},disabled:!F,children:"Tokenize"})]})]})]})}),b&&S&&Ze(S)&&H.jsx("div",{className:"rwax-modal-overlay",onClick:()=>N(!1),children:H.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"rwax-modal-header",children:[H.jsx("h2",{children:"Redeem WPIXAL"}),H.jsx("button",{className:"rwax-close-button",onClick:()=>N(!1),children:"\xd7"})]}),H.jsxs("div",{className:"rwax-modal-body",children:[H.jsxs("div",{className:"selected-asset",children:[H.jsx(Rt,{imageUrl:S.image,alt:S.name,className:"modal-asset-image"}),H.jsx("h3",{children:S.name}),Ze(S)&&H.jsxs("p",{className:"wpixal-required",children:["Required: ",S.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),H.jsxs("div",{className:"fee-selection",children:[H.jsx("h4",{children:"Select Fee Token:"}),h.map((e,t)=>H.jsxs("div",{className:"fee-option "+(F===e?"selected":""),onClick:()=>E(e),children:[H.jsx("span",{className:"fee-amount",children:e.fee}),e.wax_value&&"WAX"!==e.symbol&&H.jsxs("span",{className:"wax-equivalent",children:["\u2248 ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"cancel-button",onClick:()=>N(!1),children:"Cancel"}),H.jsx("button",{className:"confirm-button",onClick:async()=>{if(S&&F&&a&&t&&Ze(S))try{p(!0);const e=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:F.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:F.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${S.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${S.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:S.assetId.toString(),fee_currency:`8,${F.symbol}`}}],a=await Lt.transact(e);n("Redemption transaction completed successfully!"),se.info("Redemption transaction completed","RWax.handleRedeemFromModal",{result:a}),N(!1),setTimeout(()=>{Ue()},2e3)}catch(e){se.error("Error during redemption","RWax",e),r("Redemption failed. Please try again.")}finally{p(!1)}else r("Please select an asset and fee token")},disabled:!F,children:"Redeem"})]})]})]})}),H.jsx(jn,{isOpen:w,onClose:()=>k(!1),onSuccess:()=>{"redeem"===s&&Ue()}}),H.jsx(Dn,{asset:T,isOpen:x,onClose:()=>{C(!1),$(null)},onRedeem:async(e,a)=>{if(t)try{p(!0);const i=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:a.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:a.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${e.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${e.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:e.assetId.toString(),fee_currency:`8,${a.symbol}`}}],r=await Lt.transact(i);n("Redemption transaction completed successfully!"),se.info("Redemption transaction completed","RWax.handleRedemption",{result:r}),C(!1),$(null),Ue()}catch(i){se.error("Error during redemption","RWax",i),r("Redemption failed. Please try again.")}finally{p(!1)}else r("Please connect your wallet")}}),A&&S&&H.jsx("div",{className:"rwax-modal-overlay",onClick:Ge,children:H.jsxs("div",{className:"rwax-modal-content rwax-wax-redeem-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"rwax-modal-header",children:[H.jsx("h2",{children:"Pay with WAX"}),H.jsx("button",{className:"rwax-close-button",onClick:Ge,children:"\xd7"})]}),H.jsxs("div",{className:"rwax-modal-body",children:[H.jsxs("div",{className:"selected-asset",children:[H.jsx(Rt,{imageUrl:S.image,alt:S.name,className:"modal-asset-image"}),H.jsx("h3",{children:S.name}),Ze(S)&&H.jsxs(H.Fragment,{children:[H.jsxs("p",{className:"wpixal-required",children:["Required: ",S.rwax.redeemAmount.toFixed(8)," WPIXAL"]}),H.jsxs("p",{className:"wax-cost",children:["Cost: ",(S.rwax.redeemAmount*V).toFixed(4)," WAX"]}),H.jsxs("p",{className:"usd-cost",children:["USD: $",(S.rwax.redeemAmount*Y).toFixed(4)]})]})]}),"confirm"===I&&H.jsxs("div",{className:"wax-redeem-step",children:[H.jsx("h4",{children:"Step 1: Confirm WAX Payment"}),H.jsx("p",{className:"step-description",children:"This process will swap your WAX for WPIXAL via Alcor, then use that WPIXAL to redeem your NFT."}),H.jsxs("div",{className:"wax-calculator-section",children:[H.jsxs("div",{className:"available-wax",children:[H.jsx("h4",{children:"Your Available WAX"}),H.jsxs("div",{className:"wax-balance",children:[H.jsx("span",{className:"nav-balance-amount",children:be}),H.jsxs("span",{className:"balance-usd",children:["($",(parseFloat(be.split(" ")[0])*ae).toFixed(2)," USD)"]})]})]}),H.jsxs("div",{className:"wpixal-calculator",children:[H.jsx("h4",{children:"WPIXAL Calculator"}),H.jsxs("div",{className:"calculator-info",children:[H.jsx("p",{children:"With your available WAX, you can buy:"}),H.jsx("div",{className:"max-wpixal",children:H.jsxs("strong",{children:[V>0?(100/V).toFixed(4):"0.0000"," WPIXAL"]})}),H.jsx("div",{className:"rate-info",children:H.jsxs("small",{children:["Rate: 1 WPIXAL = ",V.toFixed(6)," WAX"]})})]}),H.jsxs("div",{className:"purchase-slider",children:[H.jsx("label",{children:"Amount to purchase:"}),H.jsx("input",{type:"range",min:"0",max:Math.min(100,V>0&&Ze(S)?S.rwax.redeemAmount*V:0),step:"0.0001",value:L?parseFloat(L):0,onChange:e=>W(parseFloat(e.target.value).toFixed(4)),className:"wpixal-slider"}),H.jsxs("div",{className:"slider-labels",children:[H.jsx("span",{children:"0 WAX"}),H.jsxs("span",{children:[Math.min(100,V>0&&Ze(S)?S.rwax.redeemAmount*V:0).toFixed(4)," WAX"]})]})]}),H.jsxs("div",{className:"purchase-summary",children:[H.jsxs("div",{className:"summary-row",children:[H.jsx("span",{children:"WPIXAL to buy:"}),H.jsxs("span",{children:[L?(parseFloat(L)/V).toFixed(4):"0.0000"," WPIXAL"]})]}),H.jsxs("div",{className:"summary-row",children:[H.jsx("span",{children:"WAX cost:"}),H.jsxs("span",{children:[L||"0.0000"," WAX"]})]}),H.jsxs("div",{className:"summary-row",children:[H.jsx("span",{children:"USD cost:"}),H.jsxs("span",{children:["$",L?(parseFloat(L)*ae).toFixed(4):"0.0000"]})]})]})]})]}),H.jsxs("div",{className:"process-steps",children:[H.jsxs("div",{className:"step-item",children:[H.jsx("span",{className:"step-number",children:"1"}),H.jsx("span",{className:"step-text",children:"Swap WAX \u2192 WPIXAL via Alcor"})]}),H.jsxs("div",{className:"step-item",children:[H.jsx("span",{className:"step-number",children:"2"}),H.jsx("span",{className:"step-text",children:"Redeem NFT with WPIXAL"})]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"cancel-button",onClick:Ge,children:"Cancel"}),H.jsx("button",{className:"confirm-button",onClick:async()=>{if(!(S&&t&&a&&Ze(S)))return void r("Missing required data for WAX redemption");const e=parseFloat(be.split(" ")[0]),i=parseFloat(L);if(e<i)r(`Insufficient WAX balance. You have ${be} but need ${i.toFixed(4)} WAX`);else try{p(!0),M("swap");const e=await gn.executeSwap(L,t);n("Swap transaction prepared"),se.info("Swap transaction prepared","RWax.handleWaxRedemption",{swapTransaction:e}),await new Promise(e=>setTimeout(e,2e3)),M("redeem");const a={fee:"0.00000000",contract:"eosio.token",exchange_rate:"1",symbol:"WAX",amount:"0.00000000"};if(!Ze(S))return void r("Selected asset is not a tokenized asset");const i=await Fa.executeRedemption(S.assetId.toString(),S.rwax.redeemAmount.toFixed(8)+" WPIXAL",a);n("Redemption transaction prepared"),se.info("Redemption transaction prepared","RWax.handleWaxRedemption",{redeemTransaction:i}),await new Promise(e=>setTimeout(e,2e3)),M("complete"),n("WAX redemption completed successfully!")}catch(s){se.error("Error during WAX redemption","RWax",s),r("WAX redemption failed. Please try again."),M("confirm")}finally{p(!1)}},disabled:!L||parseFloat(L)<=0||V<=0||!Ze(S)||parseFloat(L)/V>S.rwax.redeemAmount,children:"Buy WPIXAL & Redeem"})]})]}),"swap"===I&&H.jsxs("div",{className:"wax-redeem-step",children:[H.jsx("h4",{children:"Step 2: Swapping WAX to WPIXAL"}),H.jsxs("p",{className:"step-description",children:["Connecting to Alcor to swap ",L," WAX for WPIXAL..."]}),H.jsxs("div",{className:"swap-progress",children:[H.jsx("div",{className:"progress-spinner"}),H.jsx("p",{children:"Processing swap transaction..."})]}),H.jsx("div",{className:"modal-actions",children:H.jsx("button",{className:"cancel-button",onClick:Ge,children:"Cancel"})})]}),"redeem"===I&&H.jsxs("div",{className:"wax-redeem-step",children:[H.jsx("h4",{children:"Step 3: Redeeming NFT"}),H.jsx("p",{className:"step-description",children:"Using WPIXAL to redeem your NFT..."}),H.jsxs("div",{className:"redeem-progress",children:[H.jsx("div",{className:"progress-spinner"}),H.jsx("p",{children:"Processing redemption transaction..."})]})]}),"complete"===I&&H.jsxs("div",{className:"wax-redeem-step",children:[H.jsx("h4",{children:"\u2705 Redemption Complete!"}),H.jsx("p",{className:"step-description success",children:"Your NFT has been successfully redeemed using WAX payment."}),H.jsx("div",{className:"modal-actions",children:H.jsx("button",{className:"confirm-button",onClick:()=>{Ge(),Ue()},children:"Done"})})]})]})]})}),H.jsx("div",{className:"live-transactions-section",children:H.jsx(Un,{limit:12,refreshInterval:3e4})}),B&&H.jsx("div",{className:"image-zoom-modal",onClick:()=>j(!1),children:H.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsx("button",{className:"zoom-modal-close",onClick:()=>j(!1),children:"\xd7"}),D&&H.jsxs(H.Fragment,{children:[H.jsx("img",{src:D.url,alt:D.name,className:"zoom-modal-image"}),H.jsx("div",{className:"zoom-modal-info",children:H.jsx("h3",{children:D.name})})]})]})}),X&&H.jsx(Nn,{isModal:!0,onClose:()=>z(!1),initialBuyAmount:J}),ie&&le&&H.jsx("div",{className:"rwax-modal-overlay",onClick:()=>re(!1),children:H.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"rwax-modal-header",children:[H.jsx("h2",{children:"Set Price Alert"}),H.jsx("button",{className:"rwax-close-button",onClick:()=>re(!1),children:"\xd7"})]}),H.jsxs("div",{className:"rwax-modal-body",children:[le&&H.jsxs("div",{className:"alert-asset-info",children:[H.jsx(Rt,{imageUrl:le.image,alt:le.name,className:"modal-asset-image"}),H.jsx("h3",{children:le.name}),H.jsxs("p",{children:["Current Price: ",le.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),H.jsxs("div",{className:"alert-settings",children:[H.jsx("h4",{children:"Alert when price changes by:"}),H.jsx("div",{className:"percentage-options",children:[5,10,15,20,25].map(e=>H.jsxs("button",{className:"percentage-option "+(ce===e?"selected":""),onClick:()=>oe(e),children:[e,"%"]},e))}),H.jsxs("div",{className:"custom-percentage",children:[H.jsx("label",{children:"Custom percentage:"}),H.jsx("input",{type:"number",min:"1",max:"100",value:ce,onChange:e=>oe(parseInt(e.target.value)||10),className:"percentage-input"}),H.jsx("span",{children:"%"})]}),H.jsxs("div",{className:"alert-preview",children:[H.jsxs("p",{children:["You will be notified when the price moves ",ce,"% from the current value."]}),H.jsxs("div",{className:"price-thresholds",children:[H.jsxs("div",{className:"threshold-item",children:[H.jsx("span",{className:"threshold-label",children:"Alert above:"}),H.jsxs("span",{className:"threshold-value",children:[(le.rwax.redeemAmount*(1+ce/100)).toFixed(4)," WPIXAL"]})]}),H.jsxs("div",{className:"threshold-item",children:[H.jsx("span",{className:"threshold-label",children:"Alert below:"}),H.jsxs("span",{className:"threshold-value",children:[(le.rwax.redeemAmount*(1-ce/100)).toFixed(4)," WPIXAL"]})]})]})]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"cancel-button",onClick:()=>re(!1),children:"Cancel"}),le&&Be.has(le.assetId.toString())&&H.jsx("button",{className:"remove-alert-button",onClick:()=>{le&&(tt(le.assetId.toString()),re(!1))},children:"Remove Alert"}),H.jsx("button",{className:"confirm-button",onClick:()=>{le&&(et(le,ce),re(!1))},children:le&&Be.has(le.assetId.toString())?"Update Alert":"Set Alert"})]})]})]})}),pe&&H.jsx("div",{className:"rwax-modal-overlay",onClick:()=>fe(!1),children:H.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"rwax-modal-header",children:[H.jsx("h2",{children:"WPIXAL Price Alert"}),H.jsx("button",{className:"rwax-close-button",onClick:()=>fe(!1),children:"\xd7"})]}),H.jsxs("div",{className:"rwax-modal-body",children:[H.jsxs("div",{className:"wpixal-alert-info",children:[H.jsx("h3",{children:"Set WPIXAL Price Alert"}),H.jsxs("div",{className:"current-wpixal-prices",children:[H.jsx("p",{children:"Current WPIXAL Price:"}),H.jsxs("div",{className:"price-display",children:[H.jsx("span",{className:"wax-price",children:V>0?`${V.toFixed(8)} WAX`:"Loading..."}),H.jsx("span",{className:"usd-price",children:Y>0?`($${Y.toFixed(6)} USD)`:""})]})]}),localStorage.getItem("wpixalPriceAlert")&&H.jsxs("div",{className:"existing-alert-info",children:[H.jsxs("p",{children:["Your Current Alert: ",localStorage.getItem("wpixalPriceAlert")," WAX"]}),H.jsx("p",{className:"price-comparison",children:V>0&&localStorage.getItem("wpixalPriceAlert")?`Current price is ${((V-parseFloat(localStorage.getItem("wpixalPriceAlert")))/parseFloat(localStorage.getItem("wpixalPriceAlert"))*100).toFixed(2)}% ${V>parseFloat(localStorage.getItem("wpixalPriceAlert"))?"above":"below"} your alert`:""})]}),H.jsx("p",{children:"Get notified when WPIXAL price drops below your target value"})]}),H.jsxs("div",{className:"alert-settings",children:[H.jsx("h4",{children:"Alert when WPIXAL price (in WAX) drops below:"}),H.jsxs("div",{className:"price-input-container",children:[H.jsx("input",{type:"number",step:"0.00000001",min:"0",value:ye,onChange:e=>ge(e.target.value),placeholder:"Enter WAX amount",className:"price-alert-input"}),H.jsx("span",{className:"currency-label",children:"WAX"})]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"cancel-button",onClick:()=>fe(!1),children:"Cancel"}),H.jsx("button",{className:"confirm-button",onClick:()=>{ye&&parseFloat(ye)>0&&(localStorage.setItem("wpixalPriceAlert",ye),fe(!1),ge(""),n("Price Alert Set",`WPIXAL price alert set for ${ye} WAX`))},disabled:!ye||parseFloat(ye)<=0,children:"Set Alert"})]})]})]})}),Q&&H.jsxs(H.Fragment,{children:[H.jsx("div",{className:"filter-sidebar-overlay",onClick:Qe}),H.jsxs("div",{className:"filter-sidebar",children:[H.jsxs("div",{className:"filter-sidebar-header",children:[H.jsx("h3",{children:"Advanced Filters"}),H.jsx("button",{className:"close-sidebar-btn",onClick:Qe,children:H.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),H.jsxs("div",{className:"filter-section",children:[H.jsx("h4",{children:"Price Range (WPIXAL)"}),H.jsxs("div",{className:"price-range-inputs",children:[H.jsx("input",{type:"number",placeholder:"Min",value:ee.min,onChange:e=>te(t=>({...t,min:e.target.value})),className:"price-input"}),H.jsx("span",{children:"to"}),H.jsx("input",{type:"number",placeholder:"Max",value:ee.max,onChange:e=>te(t=>({...t,max:e.target.value})),className:"price-input"})]})]}),H.jsx("div",{className:"filter-section",children:H.jsx(zn,{onFiltersChange:He,initialFilters:Fe})})]})]}),de&&ue&&H.jsx(Xt,{isOpen:de,onClose:()=>{he(!1),me(null)},type:"nft",title:"",shareUrl:`${window.location.origin}/rwax/asset/${ue.assetId}`,defaultShareText:`Check out this tokenized Pixal: ${ue.name} - ${ue.rwax.redeemAmount.toFixed(8)} WPIXAL on PxMarket! \ud83c\udfae\u2728`})]})},Jn=[{id:781515,pxj:1,wuf:22,pxjUpgrade:0,name:"Pixal PFP",type:"pixals"},{id:820134,pxj:2.22,wuf:5,pxjUpgrade:0,name:"Pixel Ingredient Pack",type:"pixelpack"},{id:858568,pxj:142,wuf:142,pxjUpgrade:0,name:"Black",type:"special"},{id:858569,pxj:.42,wuf:1,pxjUpgrade:0,name:"Blue",type:"primary ingredient"},{id:858570,pxj:.42,wuf:1,pxjUpgrade:0,name:"Red",type:"primary ingredient"},{id:858571,pxj:.42,wuf:1,pxjUpgrade:0,name:"Yellow",type:"primary ingredient"},{id:858572,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Green",type:"secondary ingredient"},{id:858573,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Orange",type:"secondary ingredient"},{id:858574,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Purple",type:"secondary ingredient"},{id:858575,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Amber",type:"tertiary ingredient"},{id:858576,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Chartreuse",type:"tertiary ingredient"},{id:858577,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Violet",type:"tertiary ingredient"},{id:858578,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Teal",type:"tertiary ingredient"},{id:858580,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Vermillion",type:"tertiary ingredient"},{id:859273,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Magenta",type:"tertiary ingredient"}],qn=()=>{const[e,t]=i.useState("overview"),[a,n]=i.useState(!1),[r,s]=i.useState(.001),[l,c]=i.useState(5e-4),[o,d]=i.useState({ingredients:!0,governance:!0,collectibles:!0,overviewIngredients:!0}),h=e=>{const t=Jn.find(t=>t.id===e.resultTemplateId);if(!t)return{craftingCost:0,dailyEarnings:0,roiDays:0,profitMargin:0};const a=(e.ingredients.reduce((e,t)=>{const a=Jn.find(e=>e.id===t.templateId);return e+(a?a.pxj*t.quantity:0)},0)+t.pxjUpgrade)*r,n=24*t.pxj*r;return{craftingCost:a,dailyEarnings:n,roiDays:a>0?a/n:0,profitMargin:n>0?(n-a/365)/n*100+100:100}},u=i.useMemo(()=>{const e={special:[],"primary ingredient":[],"secondary ingredient":[],"tertiary ingredient":[],pixals:[],pixelpack:[]};return Jn.forEach(t=>{e[t.type]&&e[t.type].push(t)}),e},[]),m=()=>{n(!0)},p=e=>({858575:"http://pixeljourney.xyz/ingredients/Pixel_Amber_vid_25fps_300px.mp4",858576:"http://pixeljourney.xyz/ingredients/Pixel_Chartreuse_vid_25fps_300px.mp4",858577:"http://pixeljourney.xyz/ingredients/Pixel_Violet_vid_25fps_300px.mp4",858578:"http://pixeljourney.xyz/ingredients/Pixel_Teal_vid_25fps_300px.mp4",858580:"http://pixeljourney.xyz/ingredients/Pixel_Vermillion_vid_25fps_300px.mp4",859273:"http://pixeljourney.xyz/ingredients/Pixel_Magenta_vid_25fps_300px.mp4",858574:"http://pixeljourney.xyz/ingredients/Pixel_Purple_vid_25fps_300px.mp4",858573:"http://pixeljourney.xyz/ingredients/Pixel_Orange_vid_25fps_300px.mp4",858572:"http://pixeljourney.xyz/ingredients/Pixel_Green_vid_25fps_300px.mp4",858570:"http://pixeljourney.xyz/ingredients/Pixel_Red_vid_25fps_300px.mp4",858569:"http://pixeljourney.xyz/ingredients/Pixel_Blue_vid_25fps_300px.mp4",858571:"http://pixeljourney.xyz/ingredients/Pixel_Yellow_vid_25fps_300px.mp4",858568:"http://pixeljourney.xyz/ingredients/Pixel_Black_White_vid_25fps_300px.mp4"}[e.toString()]||`/img/ingredients/${e}.png`),f=e=>e.includes(".mp4")||e.includes(".webm");return H.jsxs("div",{className:"pxcrafting-container",children:[H.jsxs("div",{className:"pxcrafting-header",children:[H.jsx("h1",{children:"Pixel Ingredient Crafting"}),H.jsx("p",{className:"pxcrafting-subtitle",children:"Master the art of pixel ingredient crafting with comprehensive guides, ROI calculations, and staking insights."})]}),H.jsxs("div",{className:"pxcrafting-tabs",children:[H.jsx("button",{className:"tab-btn "+("overview"===e?"active":""),onClick:()=>t("overview"),children:"Overview"}),H.jsx("button",{className:"tab-btn "+("recipes"===e?"active":""),onClick:()=>t("recipes"),children:"Recipes"}),H.jsx("button",{className:"tab-btn "+("calculator"===e?"active":""),onClick:()=>t("calculator"),children:"ROI Calculator"}),H.jsx("button",{className:"tab-btn "+("staking"===e?"active":""),onClick:()=>t("staking"),children:"Staking Info"})]}),H.jsxs("div",{className:"pxcrafting-content",children:["overview"===e&&H.jsxs("div",{className:"overview-tab",children:[H.jsxs("div",{className:"overview-grid",children:[H.jsxs("div",{className:"overview-card",children:[H.jsx("h3",{children:"\ud83c\udfa8 Crafting System"}),H.jsx("p",{children:"Create powerful pixel ingredients by combining primary colors into secondary and tertiary ingredients. Each tier offers increased staking rewards and unique properties."}),H.jsx("button",{className:"cta-button",onClick:()=>m(),children:"Start Crafting"})]}),H.jsxs("div",{className:"overview-card",children:[H.jsx("h3",{children:"\ud83d\udcb0 Staking Rewards"}),H.jsx("p",{children:"Stake your crafted ingredients to earn PXJ and WUF tokens. Higher tier ingredients provide significantly better returns on your investment."}),H.jsx("button",{className:"cta-button secondary",onClick:()=>t("staking"),children:"View Staking Info"})]}),H.jsxs("div",{className:"overview-card",children:[H.jsx("h3",{children:"\ud83d\udcca ROI Analysis"}),H.jsx("p",{children:"Calculate the return on investment for different crafting strategies. Optimize your crafting decisions with real-time profitability analysis."}),H.jsx("button",{className:"cta-button secondary",onClick:()=>t("calculator"),children:"Calculate ROI"})]})]}),H.jsx("div",{className:"main-staking-section",children:H.jsxs("div",{className:"main-staking-card",children:[H.jsx("h3",{children:"\ud83c\udfdb\ufe0f Main Staking Platform"}),H.jsx("p",{children:"Visit the official Pixel Journey staking platform to stake all your NFT collectibles and earn rewards across the entire ecosystem."}),H.jsx("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"main-staking-button",children:"Visit Staking Platform"})]})}),H.jsx("div",{className:"ingredient-tiers",children:H.jsxs("div",{className:"collapsible-section",children:[H.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,overviewIngredients:!e.overviewIngredients})),children:[H.jsx("h2",{children:"Staking Values"}),H.jsx("span",{className:"collapse-icon "+(o.overviewIngredients?"collapsed":""),children:"\u25bc"})]}),!o.overviewIngredients&&H.jsxs("div",{className:"smart-tier-layout",children:[H.jsxs("div",{className:"tier-row tier-row-premium",children:[H.jsxs("div",{className:"tier-card pixelpack",children:[H.jsx("h4",{children:"Pixel Ingredient Pack"}),H.jsx("div",{className:"tier-ingredients",children:Jn.filter(e=>"pixelpack"===e.type).map(e=>{const t=p(e.id)||"https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif";return H.jsxs("div",{className:"ingredient-preview",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif"}}),H.jsxs("span",{children:[e.name," ",H.jsx("span",{className:"season-tag",children:"Season 1"})]}),H.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),H.jsxs("div",{className:"tier-card special",children:[H.jsx("h4",{children:"Special Ingredients"}),H.jsx("div",{className:"tier-ingredients",children:Jn.filter(e=>"special"===e.type).map(e=>{const t=p(e.id);return H.jsxs("div",{className:"ingredient-preview",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),H.jsxs("span",{children:[e.name," ",H.jsx("span",{className:"season-tag",children:"Season 1"})]}),H.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]})]}),H.jsxs("div",{className:"tier-row tier-row-standard",children:[H.jsxs("div",{className:"tier-card primary",children:[H.jsx("h4",{children:"Primary Ingredients"}),H.jsx("div",{className:"tier-ingredients",children:Jn.filter(e=>"primary ingredient"===e.type).map(e=>{const t=p(e.id);return H.jsxs("div",{className:"ingredient-preview",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),H.jsxs("span",{children:[e.name," ",H.jsx("span",{className:"season-tag",children:"Season 1"})]}),H.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),H.jsxs("div",{className:"tier-card secondary",children:[H.jsx("h4",{children:"Secondary Ingredients"}),H.jsx("div",{className:"tier-ingredients",children:Jn.filter(e=>"secondary ingredient"===e.type).map(e=>{const t=p(e.id);return H.jsxs("div",{className:"ingredient-preview",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),H.jsxs("span",{children:[e.name," ",H.jsx("span",{className:"season-tag",children:"Season 1"})]}),H.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]})]}),H.jsxs("div",{className:"tier-row tier-row-tertiary",children:[H.jsxs("div",{className:"tier-card tertiary",children:[H.jsx("h4",{children:"Tertiary Ingredients"}),H.jsx("div",{className:"tier-ingredients",children:Jn.filter(e=>"tertiary ingredient"===e.type).map(e=>{const t=p(e.id);return H.jsxs("div",{className:"ingredient-preview",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),H.jsxs("span",{children:[e.name," ",H.jsx("span",{className:"season-tag",children:"Season 1"})]}),H.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),H.jsxs("div",{className:"tier-card collectibles",children:[H.jsx("h4",{children:"Collectibles"}),H.jsx("div",{className:"tier-ingredients",children:H.jsxs("div",{className:"sub-tier",children:[H.jsx("h5",{children:"PFPs"}),Jn.filter(e=>"pixals"===e.type).map(e=>{const t=p(e.id)||"https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp";return H.jsxs("div",{className:"ingredient-preview",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp"}}),H.jsxs("span",{children:[e.name," ",H.jsx("span",{className:"season-tag",children:"Season 1"})]}),H.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})]})})]})]})]})]})})]}),"recipes"===e&&H.jsxs("div",{className:"recipes-tab",children:[H.jsxs("div",{className:"recipes-header",children:[H.jsx("h2",{children:"Crafting Recipes"}),H.jsxs("div",{className:"recipe-category-tabs",children:[H.jsx("button",{className:"recipe-tab active",children:"Ingredient"}),H.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Collectibles"}),H.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Event"}),H.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Governance"})]})]}),H.jsx("div",{className:"recipes-grid",children:Na.map((e,t)=>{const a=h(e),n=Jn.find(t=>t.id===e.resultTemplateId);return H.jsxs("div",{className:"recipe-card",children:[H.jsxs("div",{className:"recipe-header",children:[H.jsx("h3",{children:e.name}),H.jsx("span",{className:`tier-badge ${e.tier}`,children:e.tier})]}),H.jsxs("div",{className:"recipe-ingredients",children:[H.jsx("h4",{children:"Ingredients Required:"}),e.ingredients.map((e,t)=>{const a=Jn.find(t=>t.id===e.templateId),n=p(e.templateId);return H.jsxs("div",{className:"ingredient-requirement",children:[f(n)?H.jsx("video",{src:n,autoPlay:!0,loop:!0,muted:!0,onError:e=>{e.currentTarget.style.display="none";const t=document.createElement("img");t.src="/img/placeholder-ingredient.png",t.alt=a?.name||"Unknown",e.currentTarget.parentNode?.appendChild(t)}}):H.jsx("img",{src:n,alt:a?.name||"Unknown",onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),H.jsxs("span",{children:[e.quantity,"x ",a?.name||"Unknown"]})]},t)})]}),H.jsxs("div",{className:"recipe-result",children:[H.jsx("h4",{children:"Creates:"}),H.jsxs("div",{className:"result-item",children:[(()=>{const t=p(e.resultTemplateId);return f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:e=>{e.currentTarget.style.display="none";const t=document.createElement("img");t.src="/img/placeholder-ingredient.png",t.alt=n?.name||"Unknown",e.currentTarget.parentNode?.appendChild(t)}}):H.jsx("img",{src:t,alt:n?.name||"Unknown",onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}})})(),H.jsxs("span",{children:["1x ",n?.name||"Unknown"]})]})]}),H.jsxs("div",{className:"recipe-stats",children:[H.jsxs("div",{className:"stat",children:[H.jsx("label",{children:"Cost:"}),H.jsxs("span",{children:[a.craftingCost.toFixed(4)," WAX"]})]}),H.jsxs("div",{className:"stat",children:[H.jsx("label",{children:"Daily Earnings:"}),H.jsxs("span",{children:[a.dailyEarnings.toFixed(4)," WAX"]})]}),H.jsxs("div",{className:"stat",children:[H.jsx("label",{children:"ROI Period:"}),H.jsxs("span",{children:[a.roiDays.toFixed(1)," days"]})]})]}),H.jsx("button",{className:"craft-button",onClick:()=>{m()},children:"Craft This Recipe"})]},t)})})]}),"calculator"===e&&H.jsxs("div",{className:"calculator-tab",children:[H.jsx("h2",{children:"ROI Calculator"}),H.jsxs("div",{className:"price-inputs",children:[H.jsxs("div",{className:"input-group",children:[H.jsx("label",{children:"PXJ Price (WAX):"}),H.jsx("input",{type:"number",step:"0.0001",value:r,onChange:e=>s(parseFloat(e.target.value)||0)})]}),H.jsxs("div",{className:"input-group",children:[H.jsx("label",{children:"WUF Price (WAX):"}),H.jsx("input",{type:"number",step:"0.0001",value:l,onChange:e=>c(parseFloat(e.target.value)||0)})]})]}),H.jsx("div",{className:"roi-table",children:H.jsxs("table",{children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("th",{children:"Recipe"}),H.jsx("th",{children:"Tier"}),H.jsx("th",{children:"Crafting Cost"}),H.jsx("th",{children:"Daily Earnings"}),H.jsx("th",{children:"ROI Period"}),H.jsx("th",{children:"Profit Margin"})]})}),H.jsx("tbody",{children:Na.map((e,t)=>{const a=h(e);return H.jsxs("tr",{children:[H.jsx("td",{children:e.name}),H.jsx("td",{children:H.jsx("span",{className:`tier-badge ${e.tier}`,children:e.tier})}),H.jsxs("td",{children:[a.craftingCost.toFixed(4)," WAX"]}),H.jsxs("td",{children:[a.dailyEarnings.toFixed(4)," WAX"]}),H.jsxs("td",{children:[a.roiDays.toFixed(1)," days"]}),H.jsxs("td",{className:a.profitMargin>0?"positive":"negative",children:[a.profitMargin.toFixed(1),"%"]})]},t)})})]})})]}),"staking"===e&&H.jsxs("div",{className:"staking-tab",children:[H.jsx("h2",{children:"Staking Information"}),H.jsx("p",{className:"staking-description",children:"Stake your Pixel Journey NFTs to earn PXJ and WUF rewards. Use PXJ to infuse, upgrade, and unlock new journeys while earning returns over a 2-3 year period. Benefit from our yearly PXJ allocations (~25% of yearly inflation) that boost crafting incentives and reward active participants in the ecosystem."}),H.jsxs("div",{className:"staking-tiers",children:[H.jsxs("div",{className:"collapsible-section",children:[H.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,collectibles:!e.collectibles})),children:[H.jsx("h3",{children:"Collectibles"}),H.jsx("span",{className:"collapse-icon "+(o.collectibles?"collapsed":""),children:"\u25bc"})]}),!o.collectibles&&H.jsx("div",{className:"tiers-grid",children:H.jsxs("div",{className:"tier-section",children:[H.jsx("h4",{className:"tier-title",children:"PFPs"}),H.jsx("div",{className:"tier-items",children:Jn.filter(e=>"pixals"===e.type).map(e=>{const t=p(e.id),a="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp";return H.jsxs("div",{className:"tier-item",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const n=document.createElement("img");n.src=a,n.alt=e.name,t.currentTarget.parentNode?.appendChild(n)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),H.jsxs("div",{className:"tier-info",children:[H.jsx("h5",{children:e.name}),H.jsxs("div",{className:"tier-stats",children:[H.jsxs("span",{children:["PXJ: ",e.pxj]}),H.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&H.jsxs("span",{children:["Upgrade: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]})})]}),H.jsxs("div",{className:"collapsible-section",children:[H.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,ingredients:!e.ingredients})),children:[H.jsx("h3",{children:"Ingredients"}),H.jsx("span",{className:"collapse-icon "+(o.ingredients?"collapsed":""),children:"\u25bc"})]}),!o.ingredients&&H.jsxs("div",{className:"tiers-grid",children:[u.pixelpack.length>0&&H.jsxs("div",{className:"tier-section",children:[H.jsx("h4",{className:"tier-title",children:"Pixel Ingredient Pack"}),H.jsx("div",{className:"tier-items",children:u.pixelpack.map(e=>{const t=p(e.id),a="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif";return H.jsxs("div",{className:"tier-item",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const n=document.createElement("img");n.src=a,n.alt=e.name,t.currentTarget.parentNode?.appendChild(n)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),H.jsxs("div",{className:"ingredient-info",children:[H.jsx("h5",{children:e.name}),H.jsxs("div",{className:"ingredient-stats",children:[H.jsxs("span",{children:["PXJ: ",e.pxj]}),H.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&H.jsxs("span",{children:["Cost: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]}),Object.entries(u).filter(([e])=>"pixals"!==e&&"pixelpack"!==e).map(([e,t])=>H.jsxs("div",{className:"tier-section",children:[H.jsxs("h4",{className:"tier-title",children:[e.charAt(0).toUpperCase()+e.slice(1)," Ingredients"]}),H.jsx("div",{className:"tier-items",children:t.map(e=>{const t=p(e.id),a="pixelpack"===e.type?"https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif":"pixals"===e.type?"https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp":"/img/placeholder-ingredient.png";return H.jsxs("div",{className:"tier-item",children:[f(t)?H.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const n=document.createElement("img");n.src=a,n.alt=e.name,t.currentTarget.parentNode?.appendChild(n)}}):H.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),H.jsxs("div",{className:"ingredient-info",children:[H.jsx("h5",{children:e.name}),H.jsxs("div",{className:"ingredient-stats",children:[H.jsxs("span",{children:["PXJ: ",e.pxj]}),H.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&H.jsxs("span",{children:["Cost: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]},e))]})]}),H.jsxs("div",{className:"collapsible-section",children:[H.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,governance:!e.governance})),children:[H.jsx("h3",{children:"Governance NFTs"}),H.jsx("span",{className:"collapse-icon "+(o.governance?"collapsed":""),children:"\u25bc"})]}),!o.governance&&H.jsx("div",{className:"coming-soon-content",children:H.jsx("p",{children:"Coming soon at next PixelDAO expansions"})})]})]})]})]}),H.jsx(xa,{isOpen:a,onClose:()=>n(!1),ingredient:null})]})},Vn=new class{constructor(){t(this,"FEATURE_ACCOUNT","feature.pxj"),t(this,"MIN_AMOUNT",5e5),t(this,"MAX_AMOUNT",5e6),t(this,"MIN_DAYS",30),t(this,"MAX_DAYS",365)}calculateDuration(e){const t=(e-this.MIN_AMOUNT)/(this.MAX_AMOUNT-this.MIN_AMOUNT);return Math.floor(this.MIN_DAYS+t*(this.MAX_DAYS-this.MIN_DAYS))}calculateRequiredAmount(e){const t=(e-this.MIN_DAYS)/(this.MAX_DAYS-this.MIN_DAYS);return Math.floor(this.MIN_AMOUNT+t*(this.MAX_AMOUNT-this.MIN_AMOUNT))}generatePromoMemo(e){const t=`${e.tokenSymbol}@${e.tokenContract}`,a=t.length+1+(e.imageUrl?e.imageUrl.length+1:0)+(e.websiteUrl?e.websiteUrl.length+1:0),n=Math.min(100,235-a);let i=e.description;i.length>n&&(i=i.substring(0,n-3)+"...");let r=`${t}|${i}`;return e.imageUrl&&(r+=`|${e.imageUrl}`),e.websiteUrl&&(r+=`|${e.websiteUrl}`),r}parseMemo(e){if(!e)return null;try{if(e.includes("|")&&e.includes("@")&&!e.startsWith("{")){const t=e.split("|");if(t.length>=2){const[e,a,n="",i=""]=t,[r,s]=e.split("@");return{type:"feature_token",token:e,tokenSymbol:r,tokenContract:s,description:a,image:n,website:i}}}const t=JSON.parse(e);return"feature_token"===t.type?t:null}catch(t){return se.error("Failed to parse memo:","FeaturedTokensService.parseMemo",t),null}}async getFeaturedTokens(){try{const t=await fetch(`https://wax.eosrio.io/v2/history/get_actions?account=${this.FEATURE_ACCOUNT}&filter=eosio.token:transfer&limit=100&sort=desc`);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.json(),n=[];for(const i of a.actions||[])try{const e=i.act.data,t=this.parseMemo(e.memo);if(!t||"feature_token"!==t.type)continue;const a=parseFloat(e.quantity.split(" ")[0]),r=new Date(i.timestamp),s=new Date(r.getTime()+24*t.duration*60*60*1e3),l=new Date<=s;if(a>=this.MIN_AMOUNT&&l){const[e,c]=t.token.split("@");n.push({id:i.trx_id,tokenSymbol:e,tokenContract:c,description:t.description,imageUrl:t.image,websiteUrl:t.website,paidAmount:a,startDate:r,endDate:s,transactionId:i.trx_id,isActive:l})}}catch(e){se.error("Error processing featured token action:","FeaturedTokensService.getFeaturedTokens",e)}return n.sort((e,t)=>e.paidAmount!==t.paidAmount?t.paidAmount-e.paidAmount:t.startDate.getTime()-e.startDate.getTime())}catch(e){return se.error("Failed to fetch featured tokens:","FeaturedTokensService.getFeaturedTokens",e),[]}}validatePayment(e){if(e.amount<this.MIN_AMOUNT||e.amount>this.MAX_AMOUNT)return{valid:!1,error:`Amount must be between ${this.MIN_AMOUNT.toLocaleString()} and ${this.MAX_AMOUNT.toLocaleString()} PXJ`};if(e.duration<this.MIN_DAYS||e.duration>this.MAX_DAYS)return{valid:!1,error:`Duration must be between ${this.MIN_DAYS} and ${this.MAX_DAYS} days`};if(!e.tokenSymbol||!e.tokenContract)return{valid:!1,error:"Token symbol and contract are required"};if(!e.description||e.description.length<10)return{valid:!1,error:"Description must be at least 10 characters"};const t=`${e.tokenSymbol}@${e.tokenContract}`.length+1+(e.imageUrl?e.imageUrl.length+1:0)+(e.websiteUrl?e.websiteUrl.length+1:0),a=Math.min(100,235-t);return e.description.length>a?{valid:!1,error:`Description too long. Maximum ${a} characters allowed with current image/website URLs.`}:{valid:!0}}},Gn=({className:e=""})=>{const{account:t,session:a}=Ta(),{showSuccess:n,showError:r}=We(),[s,l]=i.useState([]),[c,o]=i.useState(!0),[d,h]=i.useState(!1),[u,m]=i.useState({amount:5e5,duration:30,tokenSymbol:"",tokenContract:"",description:"",imageUrl:"",websiteUrl:""});i.useEffect(()=>{p()},[]);const p=async()=>{try{o(!0);const e=await Vn.getFeaturedTokens();l(e)}catch(e){se.error("Failed to load featured tokens:","FeaturedTokens.loadFeaturedTokens",e)}finally{o(!1)}},f=e=>{const t=new Date,a=e.getTime()-t.getTime(),n=Math.floor(a/864e5),i=Math.floor(a%864e5/36e5);return n>0?`${n}d ${i}h remaining`:i>0?`${i}h remaining`:"Expires soon"};return H.jsxs("div",{className:`featured-tokens ${e}`,children:[H.jsxs("div",{className:"featured-tokens-header",children:[H.jsx("h3",{children:"\ud83c\udf1f Featured Tokens"}),H.jsx("button",{className:"promote-button",onClick:()=>h(!0),disabled:!t,children:"Promote Your Token"})]}),c?H.jsxs("div",{className:"featured-tokens-loading",children:[H.jsx("div",{className:"loading-spinner"}),H.jsx("span",{children:"Loading featured tokens..."})]}):s.length>0?H.jsx("div",{className:"featured-tokens-grid",children:s.slice(0,6).map(e=>H.jsxs("div",{className:"featured-token-card",children:[e.imageUrl&&H.jsx("div",{className:"token-image",children:H.jsx("img",{src:e.imageUrl,alt:e.tokenSymbol})}),H.jsxs("div",{className:"token-info",children:[H.jsxs("div",{className:"token-header",children:[H.jsx("span",{className:"token-symbol",children:e.tokenSymbol}),H.jsxs("span",{className:"token-contract",children:["@",e.tokenContract]})]}),H.jsx("p",{className:"token-description",children:e.description}),H.jsxs("div",{className:"token-meta",children:[H.jsxs("span",{className:"promo-amount",children:[e.paidAmount.toLocaleString()," PXJ"]}),H.jsx("span",{className:"time-remaining",children:f(e.endDate)})]}),e.websiteUrl&&H.jsx("a",{href:e.websiteUrl,target:"_blank",rel:"noopener noreferrer",className:"token-website",children:"Visit Website \u2192"})]})]},e.id))}):H.jsxs("div",{className:"no-featured-tokens",children:[H.jsx("p",{children:"No featured tokens at the moment."}),H.jsx("p",{children:"Be the first to promote your token!"})]}),d&&H.jsx("div",{className:"promo-modal-overlay",onClick:()=>h(!1),children:H.jsxs("div",{className:"promo-modal",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"promo-modal-header",children:[H.jsx("h3",{children:"Promote Your Token"}),H.jsx("button",{className:"close-button",onClick:()=>h(!1),children:"\xd7"})]}),H.jsxs("div",{className:"promo-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Token Symbol"}),H.jsx("input",{type:"text",value:u.tokenSymbol,onChange:e=>m(t=>({...t,tokenSymbol:e.target.value.toUpperCase()})),placeholder:"e.g., MYTOKEN"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Token Contract"}),H.jsx("input",{type:"text",value:u.tokenContract,onChange:e=>m(t=>({...t,tokenContract:e.target.value})),placeholder:"e.g., mycontract12"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Description"}),H.jsx("textarea",{value:u.description,onChange:e=>m(t=>({...t,description:e.target.value})),placeholder:"Describe your token and why users should trade it...",rows:3})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Image URL (optional)"}),H.jsx("input",{type:"url",value:u.imageUrl,onChange:e=>m(t=>({...t,imageUrl:e.target.value})),placeholder:"https://example.com/token-logo.png"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Website URL (optional)"}),H.jsx("input",{type:"url",value:u.websiteUrl,onChange:e=>m(t=>({...t,websiteUrl:e.target.value})),placeholder:"https://yourtoken.com"})]}),H.jsxs("div",{className:"form-group",children:[H.jsxs("label",{children:["Promotion Amount: ",u.amount.toLocaleString()," PXJ"]}),H.jsx("input",{type:"range",min:5e5,max:5e6,step:5e4,value:u.amount,onChange:e=>(e=>{const t=Vn.calculateDuration(e);m(a=>({...a,amount:e,duration:t}))})(parseInt(e.target.value)),className:"amount-slider"}),H.jsxs("div",{className:"slider-labels",children:[H.jsx("span",{children:"500K PXJ (30 days)"}),H.jsx("span",{children:"5M PXJ (365 days)"})]})]}),H.jsxs("div",{className:"promotion-summary",children:[H.jsxs("div",{className:"summary-item",children:[H.jsx("span",{children:"Duration:"}),H.jsxs("span",{children:[u.duration," days"]})]}),H.jsxs("div",{className:"summary-item",children:[H.jsx("span",{children:"Cost:"}),H.jsxs("span",{children:[u.amount.toLocaleString()," PXJ"]})]})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{className:"cancel-button",onClick:()=>h(!1),children:"Cancel"}),H.jsx("button",{className:"submit-button",onClick:async()=>{if(!t||!a)return void r("Please connect your wallet first");const e=Vn.validatePayment(u);if(e.valid)try{const e=Vn.generatePromoMemo(u),i={actions:[{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"feature.pxj",quantity:`${u.amount.toFixed(4)} PXJ`,memo:e}}]},r=await a.transact(i);let s=null;r&&(s=r.transaction_id||r.id||r.processed?.id||r.processed?.transaction_id||r.response&&r.response.transaction_id||r.transaction&&r.transaction.id),n(s?`Promotion submitted successfully! Transaction: ${s}`:"Promotion submitted successfully!"),h(!1),setTimeout(()=>{p()},3e3)}catch(i){se.error("Failed to submit promotion:","FeaturedTokens.submitPromotion",i),r(`Failed to submit promotion: ${i instanceof Error?i.message:"Unknown error"}`)}else r(e.error||"Invalid promotion parameters")},disabled:!u.tokenSymbol||!u.tokenContract||!u.description,children:"Submit Promotion"})]})]})]})})]})},Yn=()=>H.jsx("div",{className:"pxswap-page",children:H.jsxs("div",{className:"pxswap-container",children:[H.jsxs("div",{className:"pxswap-header",children:[H.jsx("h1",{children:"PxSwap"}),H.jsx("p",{children:"Swap between WAX and WPIXAL tokens with live market rates"})]}),H.jsx("div",{className:"pxswap-content",children:H.jsx(Nn,{})}),H.jsxs("div",{className:"pxswap-info",children:[H.jsxs("div",{className:"swap-info-section",children:[H.jsx("h3",{children:"\ud83d\udd04 PxSwap Platform Overview"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"Universal Token Swapping"}),H.jsx("p",{children:"PxSwap enables seamless trading of any tokens held directly on our platform. Trade between WAX ecosystem tokens, community tokens, and project-specific assets with ease using our integrated Alcor Exchange routing."})]}),H.jsxs("div",{className:"info-card routing-info",children:[H.jsx("h4",{children:"\ud83d\udee3\ufe0f Multi-DEX Routing"}),H.jsxs("p",{children:["PxSwap currently uses ",H.jsx("strong",{children:"Alcor Exchange"})," for all swaps, providing reliable liquidity and competitive rates. We're expanding to include multi-DEX routing in the future for even better prices and deeper liquidity."]}),H.jsxs("p",{children:[H.jsx("strong",{children:"Want advanced routing now?"})," Visit"," ",H.jsx("a",{href:"https://waxonedge.app/swap/WAX_eosio.token/PXJ_pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"external-link",children:"WaxOnEdge"})," ","for their ecosystem-MVP swap routing platform."]})]})]})]}),H.jsx(Gn,{}),H.jsxs("div",{className:"swap-info-section",children:[H.jsx("h3",{children:"\ud83d\udcb0 DeFi & LP Farming on WAX"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"\ud83c\udfdb\ufe0f Alcor Exchange"}),H.jsx("p",{children:"The premier DEX on WAX with deep liquidity pools and farming opportunities."}),H.jsx("a",{href:"https://alcor.exchange/farm",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Farm on Alcor \u2192"})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"\ud83c\udf2e TacoCrypto"}),H.jsx("p",{children:"Innovative DeFi platform offering unique yield farming and staking mechanisms."}),H.jsx("a",{href:"https://swap.tacocrypto.io/meal",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Explore TacoCrypto \u2192"})]})]})]}),H.jsxs("div",{className:"swap-info-section",children:[H.jsx("h3",{children:"\ud83d\udcc8 PXJ Spot Markets"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"PXJ/WAX"}),H.jsx("p",{children:"Primary trading pair with highest liquidity"}),H.jsx("a",{href:"https://alcor.exchange/trade/pxj-pixeljourney_wax-eosio.token",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Trade PXJ/WAX \u2192"})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"PXJ/WUF"}),H.jsx("p",{children:"Community favorite pairing"}),H.jsx("a",{href:"https://alcor.exchange/trade/pxj-pixeljourney_wuf-wuffi",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Trade PXJ/WUF \u2192"})]}),H.jsxs("div",{className:"info-card community-request",children:[H.jsx("h4",{children:"\ud83e\udd14 What's Next?"}),H.jsx("p",{children:"What market should we open next? WPIXAL/PXJ? WPIXAL/USDC? Let us and the WaxRock Council know on our Discord!"}),H.jsx("a",{href:"#",className:"info-link discord-link",children:"Join Discord \u2192"})]})]})]}),H.jsxs("div",{className:"swap-info-section",children:[H.jsx("h3",{children:"\ud83d\udcca WAX DeFi Analytics"}),H.jsxs("div",{className:"info-grid",children:[H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"\ud83d\udcc8 Alcor Analytics"}),H.jsx("p",{children:"Detailed trading data and market insights for Alcor Exchange"}),H.jsx("a",{href:"https://alcor.exchange/analytics/",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"View Alcor Data \u2192"})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"\ud83c\udf0a WaxOnEdge Analytics"}),H.jsx("p",{children:"Comprehensive ecosystem analytics and cross-DEX insights"}),H.jsx("a",{href:"https://waxonedge.app/analytics",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"Explore WaxOnEdge \u2192"})]}),H.jsxs("div",{className:"info-card",children:[H.jsx("h4",{children:"\ud83d\udd0d WAX Network Overview"}),H.jsx("p",{children:"Complete WAX blockchain DeFi metrics and network statistics"}),H.jsx("a",{href:"https://grafana.waxtools.net/",target:"_blank",rel:"noopener noreferrer",className:"info-link",children:"View Network Stats \u2192"})]})]})]})]})]})}),Kn=({alert:e,onClose:t})=>{const[a,n]=i.useState(!1),[r,s]=i.useState(!1),l=i.useCallback(()=>{s(!0),setTimeout(()=>{t()},300)},[t]);return i.useEffect(()=>{const e=setTimeout(()=>n(!0),100),t=setTimeout(()=>{l()},8e3);return()=>{clearTimeout(e),clearTimeout(t)}},[l]),H.jsx("div",{className:`price-alert-notification ${a&&!r?"visible":""} ${r?"closing":""}`,children:H.jsxs("div",{className:"notification-content",children:[H.jsxs("div",{className:"notification-header",children:[H.jsx("div",{className:"notification-icon",children:H.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:H.jsx("path",{d:"M15 17h5l-5 5-5-5h5v-5a7.5 7.5 0 1 0-15 0v5h5l-5 5-5-5h5v-5a12.5 12.5 0 1 1 25 0v5z"})})}),H.jsxs("div",{className:"notification-title",children:[H.jsx("h4",{children:"Price Alert"}),H.jsx("span",{className:"notification-time",children:(new Date).toLocaleTimeString()})]}),H.jsx("button",{className:"notification-close",onClick:l,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"notification-body",children:[H.jsx("div",{className:"nft-preview",children:H.jsx("img",{src:e.item.nft.image,alt:e.item.nft.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}})}),H.jsxs("div",{className:"alert-details",children:[H.jsx("h5",{className:"nft-name",children:e.item.nft.name}),H.jsx("p",{className:"alert-message",children:e.message})]})]}),H.jsxs("div",{className:"notification-actions",children:[H.jsx("button",{className:"btn-secondary",onClick:l,children:"Dismiss"}),H.jsx("button",{className:"btn-primary",onClick:()=>{window.location.href="/watchlist",l()},children:"View Watchlist"})]})]})})},Qn=()=>{const[e,t]=i.useState([]);return i.useEffect(()=>{const e=e=>{t(t=>[...t,e.detail])};return window.addEventListener("priceAlert",e),()=>{window.removeEventListener("priceAlert",e)}},[]),H.jsx("div",{className:"price-alert-manager",children:e.map((e,a)=>H.jsx(Kn,{alert:e,onClose:()=>(e=>{t(t=>t.filter((t,a)=>a!==e))})(a)},`${e.item.nft.asset_id}-${Date.now()}-${a}`))})},Zn=()=>{const{notifications:e,removeNotification:t,soundEnabled:a}=We(),n=i.useRef(null),r=i.useRef({}),s=(e,t,a,n)=>{const i=e.sampleRate,r=i*a,s=e.createBuffer(1,r,i),l=s.getChannelData(0);for(let c=0;c<r;c++){const e=c/i;let a=0;switch(n){case"sine":a=Math.sin(2*Math.PI*t*e);break;case"square":a=Math.sign(Math.sin(2*Math.PI*t*e));break;case"triangle":a=2/Math.PI*Math.asin(Math.sin(2*Math.PI*t*e))}const r=Math.exp(5*-e);l[c]=a*r*.1}return s},l=i.useCallback(e=>{if(a&&n.current&&r.current[e])try{const t=n.current.createBufferSource();t.buffer=r.current[e],t.connect(n.current.destination),t.start()}catch(t){}},[a]);return i.useEffect(()=>((async()=>{try{n.current=new(window.AudioContext||window.webkitAudioContext);const e={success:s(n.current,800,.1,"sine"),error:s(n.current,400,.2,"square"),warning:s(n.current,600,.15,"triangle"),info:s(n.current,500,.1,"sine")};r.current=e}catch(e){}})(),()=>{n.current&&n.current.close()}),[]),i.useEffect(()=>{if(e.length>0){const t=e[e.length-1];l(t.type)}},[e.length,e,l]),0===e.length?null:H.jsx("div",{className:"notification-container",children:e.map(e=>H.jsx("div",{className:`notification notification-${e.type}`,"data-notification-id":e.id,children:H.jsxs("div",{className:"notification-content",children:[H.jsxs("div",{className:"notification-header",children:[e.title&&H.jsx("h4",{className:"notification-title",children:e.title}),H.jsx("button",{className:"notification-close",onClick:()=>(e=>{const a=document.querySelector(`[data-notification-id="${e}"]`);a?(a.classList.add("removing"),setTimeout(()=>{t(e)},300)):t(e)})(e.id),"aria-label":"Close notification",children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsxs("div",{className:"notification-body",children:[H.jsxs("div",{className:"notification-icon",children:["success"===e.type&&H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),H.jsx("polyline",{points:"22,4 12,14.01 9,11.01"})]}),"error"===e.type&&H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),H.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"warning"===e.type&&H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),H.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),H.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),"info"===e.type&&H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("circle",{cx:"12",cy:"12",r:"10"}),H.jsx("path",{d:"M12 16v-4"}),H.jsx("path",{d:"M12 8h.01"})]})]}),H.jsxs("div",{className:"notification-message",children:[H.jsx("p",{children:e.message}),e.action&&H.jsx("button",{className:"notification-action",onClick:e.action.onClick,children:e.action.label})]})]})]})},e.id))})},ei=()=>{const{confirmDialog:e,resolveConfirm:t}=We();if(!e)return null;const a=()=>{t(!1)};return H.jsx("div",{className:"modal-overlay",onClick:a,children:H.jsxs("div",{className:"modal confirm-dialog",onClick:e=>e.stopPropagation(),children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h3",{children:e.title||"Confirm Action"}),H.jsx("button",{className:"modal-close",onClick:a,children:H.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[H.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),H.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),H.jsx("div",{className:"modal-body",children:H.jsx("p",{children:e.message})}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{className:"btn-secondary",onClick:a,children:e.cancelText||"Cancel"}),H.jsx("button",{className:"btn-primary",onClick:()=>{t(!0)},children:e.confirmText||"Confirm"})]})]})})};class ti extends i.Component{constructor(e){super(e),t(this,"reportError",async(e,t)=>{try{const a={message:e.message,stack:e.stack,componentStack:t.componentStack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href};re.warn("Error Report generated","ErrorBoundary",a)}catch(a){re.error("Failed to report error","ErrorBoundary",a)}}),t(this,"handleRetry",()=>{const e=this.state.retryCount+1;e>3?re.warn("Maximum retry attempts reached","ErrorBoundary"):this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e})}),this.state={hasError:!1,retryCount:0}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){re.error("ErrorBoundary caught an error","ErrorBoundary",e,{componentStack:t.componentStack,errorBoundary:this.constructor.name}),this.props.onError&&this.props.onError(e,t),this.setState({error:e,errorInfo:t}),this.reportError(e,t)}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=this.state.retryCount>=3;return H.jsx(la,{title:"Something went wrong",message:e?"Multiple errors occurred. Please refresh the page or contact support if the problem persists.":"An unexpected error occurred. Please try again or refresh the page.",onRetry:e?void 0:this.handleRetry,showRetry:!e})}return this.props.children}}class ai extends i.Component{constructor(e){super(e),t(this,"maxRetries",3),t(this,"retryTimeouts",[]),t(this,"handleRetry",()=>{if(this.state.retryCount>=this.maxRetries)return void se.warn("Max retries reached for API error boundary");const e=1e3*Math.pow(2,this.state.retryCount),t=.1*Math.random()*e,a=Math.min(e+t,3e4);this.setState({isRetrying:!0,lastRetryTime:Date.now()});const n=setTimeout(()=>{this.setState(e=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e.retryCount+1,isRetrying:!1}))},a);this.retryTimeouts.push(n)}),t(this,"handleReset",()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:0})}),this.state={hasError:!1,retryCount:0,isRetrying:!1,errorCategory:"unknown"}}componentWillUnmount(){this.retryTimeouts.forEach(e=>clearTimeout(e))}static getDerivedStateFromError(e){const t=e.message.toLowerCase();let a="unknown";if(t.includes("fetch")||t.includes("network")||t.includes("connection")?a="network":t.includes("timeout")||t.includes("aborted")?a="timeout":(t.includes("http")||t.includes("api")||t.includes("failed to load"))&&(a="api"),["network","api","timeout"].includes(a)||"ChunkLoadError"===e.name||"TypeError"===e.name&&t.includes("fetch"))return{hasError:!0,error:e,errorCategory:a};throw e}componentDidCatch(e,t){ee.logError("APIErrorBoundary",e,{errorInfo:t,retryCount:this.state.retryCount,componentStack:t.componentStack}),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=this.state.retryCount<this.maxRetries;let t;switch(this.state.errorCategory){case"network":t="NETWORK_ERROR";break;case"timeout":t="TIMEOUT_ERROR";break;case"api":t="API_ERROR";break;default:t="LOAD_FAILED"}return H.jsxs("div",{className:"error-boundary-container",children:[H.jsx(la,{errorType:t,onRetry:e?this.handleRetry:this.handleReset,showRetry:!0,isRetrying:this.state.isRetrying,retryCount:this.state.retryCount,maxRetries:this.maxRetries}),this.state.retryCount>0&&H.jsxs("div",{className:"error-retry-info",children:[H.jsxs("p",{children:["Retry attempt ",this.state.retryCount," of ",this.maxRetries]}),this.state.isRetrying&&H.jsxs("div",{className:"retry-progress",children:[H.jsx("div",{className:"retry-spinner"}),H.jsx("span",{children:"Retrying..."})]})]}),!1]})}return this.props.children}}const ni=()=>{const{isConnected:e,account:t}=Q();return i.useEffect(()=>{if(!e||!t)return;const a=setTimeout(async()=>{try{const e=`watchlist_last_check_${t}`,a=localStorage.getItem(e),n=a?parseInt(a):0,i=Date.now();if(i-n<3e5)return;const r=await Xe.getWatchlist();if(0===r.length)return void localStorage.setItem(e,i.toString());const s=[];for(const t of r){const e=Xe.getPriceAlert(t.nft.asset_id);if(e&&e.enabled&&e.lastTriggered&&e.lastTriggered>n){let a="";const n=t.lastPrice||parseFloat(t.nft.price||"0");switch(e.alertType){case"below":a=`${t.nft.name} price dropped to ${n.toFixed(2)} WAX (target: ${e.targetPrice} WAX)`;break;case"above":a=`${t.nft.name} price rose to ${n.toFixed(2)} WAX (target: ${e.targetPrice} WAX)`;break;case"any":{const e=Math.abs(t.priceChange||0),i=(t.priceChange||0)>0?"increased":"decreased";a=`${t.nft.name} price ${i} by ${e.toFixed(1)}% to ${n.toFixed(2)} WAX`;break}}s.push({alert:e,item:t,message:a,triggeredAt:e.lastTriggered})}}s.sort((e,t)=>t.triggeredAt-e.triggeredAt),s.forEach((e,t)=>{setTimeout(()=>{window.dispatchEvent(new CustomEvent("priceAlert",{detail:{item:e.item,message:e.message}}))},1e3*t)}),localStorage.setItem(e,i.toString()),s.length>0&&se.info(`Found ${s.length} triggered watchlist alerts since last visit`)}catch(e){se.error("Error checking watchlist alerts:","WatchlistAlertChecker.checkTriggeredAlerts",e)}},2e3);return()=>clearTimeout(a)},[e,t]),null},ii=()=>{const[e,t]=i.useState(null),[a,n]=i.useState(!1),[r,s]=i.useState(!1),[l,c]=i.useState(navigator.onLine),[o,d]=i.useState(!1);return i.useEffect(()=>{(()=>{const e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");d(e),s(e)})();const e=e=>{e.preventDefault(),t(e),n(!0)},a=()=>{s(!0),n(!1),t(null)},i=()=>c(!0),r=()=>c(!1);window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",a),window.addEventListener("online",i),window.addEventListener("offline",r);const l=window.matchMedia("(display-mode: standalone)"),o=e=>{d(e.matches),s(e.matches)};return l.addEventListener?l.addEventListener("change",o):l.addListener(o),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",a),window.removeEventListener("online",i),window.removeEventListener("offline",r),l.removeEventListener?l.removeEventListener("change",o):l.removeListener(o)}},[]),{isInstallable:a,isInstalled:r,isOnline:l,isStandalone:o,installPrompt:e,showInstallPrompt:async()=>{if(e)try{await e.prompt();const{outcome:a}=await e.userChoice;se.info("accepted"===a?"User accepted the install prompt":"User dismissed the install prompt"),t(null),n(!1)}catch(a){se.error("Error showing install prompt:","usePWA.showInstallPrompt",a)}},dismissInstallPrompt:()=>{t(null),n(!1)}}},ri=({className:e=""})=>{const{isInstallable:t,isInstalled:a,isStandalone:n,showInstallPrompt:i,dismissInstallPrompt:r}=ii();return!t||a||n?null:H.jsx("div",{className:`pwa-install-banner ${e}`,role:"banner","aria-label":"Install app banner",children:H.jsxs("div",{className:"pwa-banner-content",children:[H.jsx("div",{className:"pwa-banner-icon",children:H.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[H.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",fill:"currentColor",fillOpacity:"0.1",stroke:"currentColor",strokeWidth:"1.5"}),H.jsx("path",{d:"M8 12l2 2 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),H.jsxs("div",{className:"pwa-banner-text",children:[H.jsx("h3",{className:"pwa-banner-title",children:"Install PxMarket"}),H.jsx("p",{className:"pwa-banner-description",children:"Get the full app experience with offline access and faster loading."})]}),H.jsxs("div",{className:"pwa-banner-actions",children:[H.jsxs("button",{type:"button",className:"pwa-install-button",onClick:i,"aria-label":"Install PxMarket app",children:[H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:H.jsx("path",{d:"M8 1v10M4 7l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Install"]}),H.jsx("button",{type:"button",className:"pwa-dismiss-button",onClick:r,"aria-label":"Dismiss install banner",children:H.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:H.jsx("path",{d:"M12 4L4 12M4 4l8 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})})},si=({className:e=""})=>{const{isOnline:t}=ii();return t?null:H.jsx("div",{className:`offline-indicator ${e}`,role:"status","aria-live":"polite","aria-label":"You are currently offline",children:H.jsxs("div",{className:"offline-content",children:[H.jsx("div",{className:"offline-icon",children:H.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[H.jsx("path",{d:"M3 7c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v6c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V7z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),H.jsx("path",{d:"M7 9l6 4M13 9l-6 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),H.jsxs("div",{className:"offline-text",children:[H.jsx("span",{className:"offline-title",children:"You're offline"}),H.jsx("span",{className:"offline-description",children:"Some features may be limited"})]}),H.jsx("div",{className:"offline-pulse","aria-hidden":"true"})]})})},li=()=>{const[e,t]=i.useState([]),[a,n]=i.useState(new Set),{activeTransactions:r,completedTransactions:s}=(()=>{const[e,t]=i.useState({activeTransactions:new Map,completedTransactions:[],isProcessing:!1}),{executeTransaction:a,getTransaction:n,cancelTransaction:r}=Q(),s=i.useRef(new Map),l=i.useCallback((e,a)=>{t(t=>{const n=new Map(t.activeTransactions),i=n.get(e);if(i){const r={...i,...a};if("success"===r.status||"failed"===r.status||"cancelled"===r.status){n.delete(e);const a=s.current.get(e);return a&&(clearInterval(a),s.current.delete(e)),{...t,activeTransactions:n,completedTransactions:[r,...t.completedTransactions.slice(0,49)],isProcessing:n.size>0}}return n.set(e,r),{...t,activeTransactions:n}}return t})},[]),c=i.useCallback(async e=>{try{if(!n)return void se.warn("getWalletTransaction not available");const t=await n(e);t&&l(e,t)}catch(t){se.error(`Error polling transaction ${e}:`,"useTransactionManager.pollTransactionStatus",t),l(e,{status:"failed",error:"Failed to check transaction status"})}},[n,l]),o=i.useCallback(e=>{const t=s.current.get(e);t&&clearInterval(t);const a=setInterval(()=>{c(e)},2e3);s.current.set(e,a),setTimeout(()=>{s.current.get(e)===a&&(clearInterval(a),s.current.delete(e),l(e,{status:"failed",error:"Transaction timeout - please check manually"}))},3e5)},[c,l]),d=i.useCallback(async(e,n)=>{try{if(t(e=>({...e,isProcessing:!0})),!a)throw new Error("executeTransaction not available - wallet not connected");const i=await a(e,n);if(i){const a={id:i,type:e,status:"pending",timestamp:Date.now(),account:"",actions:[],metadata:n};return t(e=>{const t=new Map(e.activeTransactions);return t.set(i,a),{...e,activeTransactions:t}}),o(i),i}return null}catch(i){throw se.error("Error starting transaction:","useTransactionManager.startTransaction",i),t(e=>({...e,isProcessing:!1})),i}},[a,o]),h=i.useCallback(t=>e.activeTransactions.get(t)||e.completedTransactions.find(e=>e.id===t)||null,[e.activeTransactions,e.completedTransactions]),u=i.useCallback(async e=>{try{if(!r)return se.warn("cancelWalletTransaction not available"),!1;const t=await r(e);return t&&l(e,{status:"cancelled",error:"Transaction cancelled by user"}),t}catch(t){return se.error("Error cancelling transaction:","useTransactionManager.cancelTransaction",t),!1}},[r,l]),m=i.useCallback(()=>{t(e=>({...e,completedTransactions:[]}))},[]),p=i.useCallback(()=>e.activeTransactions.size,[e.activeTransactions.size]),f=i.useCallback(()=>e.completedTransactions.length,[e.completedTransactions.length]),v=i.useCallback(()=>e.completedTransactions.some(e=>"failed"===e.status),[e.completedTransactions]);return{activeTransactions:Array.from(e.activeTransactions.values()),completedTransactions:e.completedTransactions,isProcessing:e.isProcessing,startTransaction:d,getTransaction:h,cancelTransaction:u,clearCompleted:m,getActiveCount:p,getCompletedCount:f,hasFailedTransactions:v}})(),{showSuccess:l,showError:c}=We(),o=i.useCallback(e=>{const a={...e,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),autoHide:e.autoHide??!0,duration:e.duration??5e3};t(e=>[a,...e.slice(0,4)]),a.autoHide&&setTimeout(()=>{d(a.id)},a.duration)},[]),d=i.useCallback(e=>{t(t=>t.filter(t=>t.id!==e))},[]);i.useEffect(()=>{[...r,...s].forEach(e=>{if(!a.has(e.id))switch(n(t=>new Set([...t,e.id])),e.status){case"pending":o({type:"info",title:"Transaction Started",message:`${h(e.type)} transaction is being prepared...`,transactionId:e.id,duration:3e3});break;case"processing":o({type:"info",title:"Processing Transaction",message:`${h(e.type)} is being processed on the blockchain...`,transactionId:e.id,duration:4e3});break;case"success":o({type:"success",title:"Transaction Successful!",message:`${h(e.type)} completed successfully`,transactionId:e.id,duration:6e3}),l("Transaction Complete",`Your ${h(e.type).toLowerCase()} has been processed successfully!`);break;case"failed":o({type:"error",title:"Transaction Failed",message:e.error||`${h(e.type)} failed to process`,transactionId:e.id,autoHide:!1}),c("Transaction Failed",e.error||"Your transaction failed to process. Please try again.");break;case"cancelled":o({type:"warning",title:"Transaction Cancelled",message:`${h(e.type)} was cancelled`,transactionId:e.id,duration:4e3})}})},[r,s,a,o,l,c]);const h=e=>{switch(e){case"nft_purchase":return"NFT Purchase";case"nft_transfer":return"NFT Transfer";case"token_transfer":return"Token Transfer";case"nft_listing":return"NFT Listing";case"listing_cancel":return"Cancel Listing";case"crafting":return"Crafting";case"blend":return"Blend";case"burn":return"Burn Assets";case"unpack":return"Unpack Asset";case"auction_bid":return"Auction Bid";case"tokenize_wax":return"Tokenize WAX";default:return e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())}},u=e=>{switch(e){case"success":return"\u2705";case"error":return"\u274c";case"warning":return"\u26a0\ufe0f";default:return"\u2139\ufe0f"}},m=e=>{const t=Date.now()-e,a=Math.floor(t/1e3),n=Math.floor(a/60);if(a<60)return"Just now";if(n<60)return`${n}m ago`;const i=Math.floor(n/60);return i<24?`${i}h ago`:new Date(e).toLocaleDateString()};return 0===e.length?null:H.jsx("div",{className:"transaction-notifications",children:e.map(e=>H.jsxs("div",{className:`notification notification-${e.type}`,children:[H.jsxs("div",{className:"notification-content",children:[H.jsxs("div",{className:"notification-header",children:[H.jsx("span",{className:"notification-icon",children:u(e.type)}),H.jsx("span",{className:"notification-title",children:e.title}),H.jsx("span",{className:"notification-time",children:m(e.timestamp)}),H.jsx("button",{className:"notification-close",onClick:()=>d(e.id),children:"\xd7"})]}),H.jsx("div",{className:"notification-message",children:e.message}),e.transactionId&&H.jsxs("div",{className:"notification-transaction-id",children:["ID: ",e.transactionId.slice(0,8),"...",e.transactionId.slice(-8)]})]}),e.autoHide&&H.jsx("div",{className:"notification-progress",style:{animationDuration:`${e.duration}ms`}})]},e.id))})},ci=()=>{const e=u(),[t,a]=i.useState("landing");r.useEffect(()=>{const t=e.pathname;""===t||"/"===t||"/market-alphatest/"===t||"/market-alphatest"===t?a("/landing"):"/marketplace"===t||"/market-alphatest/marketplace"===t?a("marketplace"):"/rewards"===t?a("rewards"):"/inventory"===t?a("inventory"):"/packs"===t?a("packs"):t.startsWith("/collections")?a("collections"):"/activity"===t||"/stats"===t?a("activity"):"/staking"===t?a("staking"):"/profile"===t?a("profile"):"/watchlist"===t?a("watchlist"):"/auctions"===t?a("auctions"):"/learn"===t?a("learn"):"/journeymap"===t?a("journeymap"):"/pxcrafting"===t&&a("pxcrafting")},[e.pathname]),r.useEffect(()=>{window.scrollTo(0,0)},[e.pathname]);const n=e=>{a(e),"landing"===e?window.history.pushState(null,"","/"):"marketplace"===e?window.history.pushState(null,"","/marketplace"):window.history.pushState(null,"",`/${e}`)};return H.jsxs("div",{className:"App",children:[H.jsx(je,{currentPage:t,onPageChange:n}),H.jsx("main",{id:"main-content",role:"main","aria-label":"Main content",className:"main-content",children:H.jsxs(m,{children:[H.jsx(p,{path:"/",element:H.jsx(ai,{children:H.jsx(De,{})})}),H.jsx(p,{path:"/marketplace",element:H.jsx(ai,{children:H.jsx(da,{})})}),H.jsx(p,{path:"/rewards",element:H.jsx(ai,{children:H.jsx(ha,{onPageChange:n})})}),H.jsx(p,{path:"/inventory",element:H.jsx(ai,{children:H.jsx(Ra,{})})}),H.jsx(p,{path:"/packs",element:H.jsx(ai,{children:H.jsx(xn,{})})}),H.jsx(p,{path:"/collections",element:H.jsx(ai,{children:H.jsx(qa,{})})}),H.jsx(p,{path:"/collections/:collectionName",element:H.jsx(ai,{children:H.jsx(en,{})})}),H.jsx(p,{path:"/collections/:collectionName/templates/:templateId",element:H.jsx(ai,{children:H.jsx(tn,{})})}),H.jsx(p,{path:"/assets/:assetId",element:H.jsx(ai,{children:H.jsx(an,{})})}),H.jsx(p,{path:"/listings/:saleId",element:H.jsx(ai,{children:H.jsx(nn,{})})}),H.jsx(p,{path:"/transactions/:transactionId",element:H.jsx(ai,{children:H.jsx(rn,{})})}),H.jsx(p,{path:"/activity",element:H.jsx(ai,{children:H.jsx(_n,{})})}),H.jsx(p,{path:"/stats",element:H.jsx(ai,{children:H.jsx(_n,{})})}),H.jsx(p,{path:"/profile",element:H.jsx(ai,{children:H.jsx(wn,{})})}),H.jsx(p,{path:"/profile/:account",element:H.jsx(ai,{children:H.jsx(kn,{})})}),H.jsx(p,{path:"/user-profile-lookup",element:H.jsx(ai,{children:H.jsx(kn,{})})}),H.jsx(p,{path:"/watchlist",element:H.jsx(ai,{children:H.jsx(Cn,{})})}),H.jsx(p,{path:"/auctions",element:H.jsx(ai,{children:H.jsx(Pn,{})})}),H.jsx(p,{path:"/auctions/:id",element:H.jsx(ai,{children:H.jsx(Tn,{})})}),H.jsx(p,{path:"/learn",element:H.jsx(ai,{children:H.jsx($n,{})})}),H.jsx(p,{path:"/journeymap",element:H.jsx(ai,{children:H.jsx(Fn,{})})}),H.jsx(p,{path:"/staking",element:H.jsx(ai,{children:H.jsx(On,{})})}),H.jsx(p,{path:"/rwax",element:H.jsx(ai,{children:H.jsx(Hn,{})})}),H.jsx(p,{path:"/pxcrafting",element:H.jsx(ai,{children:H.jsx(qn,{})})}),H.jsx(p,{path:"/pxswap",element:H.jsx(ai,{children:H.jsx(Yn,{})})})]})}),H.jsx(An,{})]})};function oi(){return r.useEffect(()=>{xe.trackEvent("app_initialized",{timestamp:Date.now(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}}),Oe.initialize().then(()=>{se.info("Accessibility service ready","App"),xe.trackEvent("accessibility_service_ready",{preferences:Oe.getPreferences()})}).catch(e=>{se.error("Failed to initialize accessibility service","App",e),xe.reportError(e,"accessibility_init_error")}),Ue.initialize().then(e=>{e?(se.info("Push notification service initialized successfully","App"),xe.trackEvent("push_service_ready",{supported:Ue.getPermissionState().supported})):se.warn("Push notification service initialization failed","App")}).catch(e=>{se.error("Push notification service initialization error","App",e),xe.reportError(e,"push_service_init_error")}),me.preloadConfiguration().then(()=>{se.info("Marketplace configuration preloaded successfully","App"),xe.trackEvent("marketplace_config_preloaded",{timestamp:Date.now()})}).catch(e=>{se.warn("Failed to preload marketplace configuration","App",{error:e}),xe.reportError(e,"marketplace_config_preload_error")})},[]),H.jsx(ti,{children:H.jsx(Pa,{children:H.jsx(we,{children:H.jsxs(Le,{children:[H.jsx(h,{basename:"/market-alphatest",children:H.jsx(ci,{})}),H.jsx(ni,{}),H.jsx(Qn,{}),H.jsx(Zn,{}),H.jsx(ei,{}),H.jsx(Qa,{}),H.jsx(ri,{}),H.jsx(si,{}),H.jsx(li,{})]})})})})}Y.createRoot(document.getElementById("root")).render(H.jsx(i.StrictMode,{children:H.jsx(oi,{})}));
