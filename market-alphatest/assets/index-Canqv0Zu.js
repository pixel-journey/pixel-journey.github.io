import{r as e,b as t,c as a,R as s,L as n,u as i,d as r,e as l,f as c,B as o,h as d,i as u,j as m}from"./vendor-M91y7A-R.js";import{_ as h,W as p,a as f,b as x}from"./wallets-CVbRd5Zw.js";import{t as g,u as v,v as y}from"./wharfkit-DegL5BAe.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var j,b,N={exports:{}},w={};var k,_,S,C,A=(b||(b=1,N.exports=function(){if(j)return w;j=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(t,a,s){var n=null;if(void 0!==s&&(n=""+s),void 0!==a.key&&(n=""+a.key),"key"in a)for(var i in s={},a)"key"!==i&&(s[i]=a[i]);else s=a;return a=s.ref,{$$typeof:e,type:t,key:n,ref:void 0!==a?a:null,props:s}}return w.Fragment=t,w.jsx=a,w.jsxs=a,w}()),N.exports),E={exports:{}},P={},T={exports:{}},I={};function F(){return _||(_=1,T.exports=(k||(k=1,function(e){function t(e,t){var a=e.length;e.push(t);e:for(;0<a;){var s=a-1>>>1,i=e[s];if(!(0<n(i,t)))break e;e[s]=t,e[a]=i,a=s}}function a(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],a=e.pop();if(a!==t){e[0]=a;e:for(var s=0,i=e.length,r=i>>>1;s<r;){var l=2*(s+1)-1,c=e[l],o=l+1,d=e[o];if(0>n(c,a))o<i&&0>n(d,c)?(e[s]=d,e[o]=a,s=o):(e[s]=c,e[l]=a,s=l);else{if(!(o<i&&0>n(d,a)))break e;e[s]=d,e[o]=a,s=o}}}return t}function n(e,t){var a=e.sortIndex-t.sortIndex;return 0!==a?a:e.id-t.id}if(e.unstable_now=void 0,"object"==typeof performance&&"function"==typeof performance.now){var i=performance;e.unstable_now=function(){return i.now()}}else{var r=Date,l=r.now();e.unstable_now=function(){return r.now()-l}}var c=[],o=[],d=1,u=null,m=3,h=!1,p=!1,f=!1,x=!1,g="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,y="undefined"!=typeof setImmediate?setImmediate:null;function j(e){for(var n=a(o);null!==n;){if(null===n.callback)s(o);else{if(!(n.startTime<=e))break;s(o),n.sortIndex=n.expirationTime,t(c,n)}n=a(o)}}function b(e){if(f=!1,j(e),!p)if(null!==a(c))p=!0,w||(w=!0,N());else{var t=a(o);null!==t&&T(b,t.startTime-e)}}var N,w=!1,k=-1,_=5,S=-1;function C(){return!(!x&&e.unstable_now()-S<_)}function A(){if(x=!1,w){var t=e.unstable_now();S=t;var n=!0;try{e:{p=!1,f&&(f=!1,v(k),k=-1),h=!0;var i=m;try{t:{for(j(t),u=a(c);null!==u&&!(u.expirationTime>t&&C());){var r=u.callback;if("function"==typeof r){u.callback=null,m=u.priorityLevel;var l=r(u.expirationTime<=t);if(t=e.unstable_now(),"function"==typeof l){u.callback=l,j(t),n=!0;break t}u===a(c)&&s(c),j(t)}else s(c);u=a(c)}if(null!==u)n=!0;else{var d=a(o);null!==d&&T(b,d.startTime-t),n=!1}}break e}finally{u=null,m=i,h=!1}n=void 0}}finally{n?N():w=!1}}}if("function"==typeof y)N=function(){y(A)};else if("undefined"!=typeof MessageChannel){var E=new MessageChannel,P=E.port2;E.port1.onmessage=A,N=function(){P.postMessage(null)}}else N=function(){g(A,0)};function T(t,a){k=g(function(){t(e.unstable_now())},a)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var a=m;m=t;try{return e()}finally{m=a}},e.unstable_requestPaint=function(){x=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var a=m;m=e;try{return t()}finally{m=a}},e.unstable_scheduleCallback=function(s,n,i){var r=e.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?r+i:r,s){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return s={id:d++,callback:n,priorityLevel:s,startTime:i,expirationTime:l=i+l,sortIndex:-1},i>r?(s.sortIndex=i,t(o,s),null===a(c)&&s===a(o)&&(f?(v(k),k=-1):f=!0,T(b,i-r))):(s.sortIndex=l,t(c,s),p||h||(p=!0,w||(w=!0,N()))),s},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(e){var t=m;return function(){var a=m;m=t;try{return e.apply(this,arguments)}finally{m=a}}}}(I)),I)),T.exports}function $(){if(S)return P;S=1;
/**
   * @license React
   * react-dom-client.production.js
   *
   * Copyright (c) Meta Platforms, Inc. and affiliates.
   *
   * This source code is licensed under the MIT license found in the
   * LICENSE file in the root directory of this source tree.
   */
var a=F(),s=e(),n=t();function i(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var a=2;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function l(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function c(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function o(e){if(l(e)!==e)throw Error(i(188))}function d(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=d(e)))return t;e=e.sibling}return null}var u=Object.assign,m=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),y=Symbol.for("react.consumer"),j=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),C=Symbol.for("react.activity"),A=Symbol.for("react.memo_cache_sentinel"),E=Symbol.iterator;function T(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=E&&e[E]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function $(e){if(null==e)return null;if("function"==typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case f:return"Fragment";case g:return"Profiler";case x:return"StrictMode";case N:return"Suspense";case w:return"SuspenseList";case C:return"Activity"}if("object"==typeof e)switch(e.$$typeof){case p:return"Portal";case j:return(e.displayName||"Context")+".Provider";case y:return(e._context.displayName||"Context")+".Consumer";case b:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case k:return null!==(t=e.displayName||null)?t:$(e.type)||"Memo";case _:t=e._payload,e=e._init;try{return $(e(t))}catch(a){}}return null}var L=Array.isArray,M=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},O=[],D=-1;function B(e){return{current:e}}function U(e){0>D||(e.current=O[D],O[D]=null,D--)}function z(e,t){D++,O[D]=e.current,e.current=t}var X=B(null),H=B(null),q=B(null),J=B(null);function V(e,t){switch(z(q,t),z(H,e),z(X,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ru(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=lu(t=ru(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}U(X),z(X,e)}function G(){U(X),U(H),U(q)}function K(e){null!==e.memoizedState&&z(J,e);var t=X.current,a=lu(t,e.type);t!==a&&(z(H,e),z(X,a))}function Y(e){H.current===e&&(U(X),U(H)),J.current===e&&(U(J),Ku._currentValue=W)}var Q=Object.prototype.hasOwnProperty,Z=a.unstable_scheduleCallback,ee=a.unstable_cancelCallback,te=a.unstable_shouldYield,ae=a.unstable_requestPaint,se=a.unstable_now,ne=a.unstable_getCurrentPriorityLevel,ie=a.unstable_ImmediatePriority,re=a.unstable_UserBlockingPriority,le=a.unstable_NormalPriority,ce=a.unstable_LowPriority,oe=a.unstable_IdlePriority,de=a.log,ue=a.unstable_setDisableYieldValue,me=null,he=null;function pe(e){if("function"==typeof de&&ue(e),he&&"function"==typeof he.setStrictMode)try{he.setStrictMode(me,e)}catch(t){}}var fe=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(xe(e)/ge|0)|0},xe=Math.log,ge=Math.LN2;var ve=256,ye=4194304;function je(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194048&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function be(e,t,a){var s=e.pendingLanes;if(0===s)return 0;var n=0,i=e.suspendedLanes,r=e.pingedLanes;e=e.warmLanes;var l=134217727&s;return 0!==l?0!==(s=l&~i)?n=je(s):0!==(r&=l)?n=je(r):a||0!==(a=l&~e)&&(n=je(a)):0!==(l=s&~i)?n=je(l):0!==r?n=je(r):a||0!==(a=s&~e)&&(n=je(a)),0===n?0:0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(a=t&-t)||32===i&&4194048&a)?t:n}function Ne(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function we(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ke(){var e=ve;return!(4194048&(ve<<=1))&&(ve=256),e}function _e(){var e=ye;return!(62914560&(ye<<=1))&&(ye=4194304),e}function Se(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function Ce(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ae(e,t,a){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-fe(t);e.entangledLanes|=t,e.entanglements[s]=1073741824|e.entanglements[s]|4194090&a}function Ee(e,t){var a=e.entangledLanes|=t;for(e=e.entanglements;a;){var s=31-fe(a),n=1<<s;n&t|e[s]&t&&(e[s]|=t),a&=~n}}function Pe(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Te(e){return 2<(e&=-e)?8<e?134217727&e?32:268435456:8:2}function Ie(){var e=R.p;return 0!==e?e:void 0===(e=window.event)?32:um(e.type)}var Fe=Math.random().toString(36).slice(2),$e="__reactFiber$"+Fe,Le="__reactProps$"+Fe,Me="__reactContainer$"+Fe,Re="__reactEvents$"+Fe,We="__reactListeners$"+Fe,Oe="__reactHandles$"+Fe,De="__reactResources$"+Fe,Be="__reactMarker$"+Fe;function Ue(e){delete e[$e],delete e[Le],delete e[Re],delete e[We],delete e[Oe]}function ze(e){var t=e[$e];if(t)return t;for(var a=e.parentNode;a;){if(t=a[Me]||a[$e]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=bu(e);null!==e;){if(a=e[$e])return a;e=bu(e)}return t}a=(e=a).parentNode}return null}function Xe(e){if(e=e[$e]||e[Me]){var t=e.tag;if(5===t||6===t||13===t||26===t||27===t||3===t)return e}return null}function He(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(i(33))}function qe(e){var t=e[De];return t||(t=e[De]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Je(e){e[Be]=!0}var Ve=new Set,Ge={};function Ke(e,t){Ye(e,t),Ye(e+"Capture",t)}function Ye(e,t){for(Ge[e]=t,e=0;e<t.length;e++)Ve.add(t[e])}var Qe,Ze,et=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tt={},at={};function st(e,t,a){if(n=t,Q.call(at,n)||!Q.call(tt,n)&&(et.test(n)?at[n]=!0:(tt[n]=!0,0)))if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var s=t.toLowerCase().slice(0,5);if("data-"!==s&&"aria-"!==s)return void e.removeAttribute(t)}e.setAttribute(t,""+a)}var n}function nt(e,t,a){if(null===a)e.removeAttribute(t);else{switch(typeof a){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+a)}}function it(e,t,a,s){if(null===s)e.removeAttribute(a);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(a)}e.setAttributeNS(t,a,""+s)}}function rt(e){if(void 0===Qe)try{throw Error()}catch(a){var t=a.stack.trim().match(/\n( *(at )?)/);Qe=t&&t[1]||"",Ze=-1<a.stack.indexOf("\n    at")?" (<anonymous>)":-1<a.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+Qe+e+Ze}var lt=!1;function ct(e,t){if(!e||lt)return"";lt=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var a=function(){throw Error()};if(Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(a,[])}catch(n){var s=n}Reflect.construct(e,[],a)}else{try{a.call()}catch(i){s=i}e.call(a.prototype)}}else{try{throw Error()}catch(r){s=r}(a=e())&&"function"==typeof a.catch&&a.catch(function(){})}}catch(l){if(l&&s&&"string"==typeof l.stack)return[l.stack,s.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var n=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");n&&n.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var i=s.DetermineComponentFrameRoot(),r=i[0],l=i[1];if(r&&l){var c=r.split("\n"),o=l.split("\n");for(n=s=0;s<c.length&&!c[s].includes("DetermineComponentFrameRoot");)s++;for(;n<o.length&&!o[n].includes("DetermineComponentFrameRoot");)n++;if(s===c.length||n===o.length)for(s=c.length-1,n=o.length-1;1<=s&&0<=n&&c[s]!==o[n];)n--;for(;1<=s&&0<=n;s--,n--)if(c[s]!==o[n]){if(1!==s||1!==n)do{if(s--,0>--n||c[s]!==o[n]){var d="\n"+c[s].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}}while(1<=s&&0<=n);break}}}finally{lt=!1,Error.prepareStackTrace=a}return(a=e?e.displayName||e.name:"")?rt(a):""}function ot(e){switch(e.tag){case 26:case 27:case 5:return rt(e.type);case 16:return rt("Lazy");case 13:return rt("Suspense");case 19:return rt("SuspenseList");case 0:case 15:return ct(e.type,!1);case 11:return ct(e.type.render,!1);case 1:return ct(e.type,!0);case 31:return rt("Activity");default:return""}}function dt(e){try{var t="";do{t+=ot(e),e=e.return}while(e);return t}catch(a){return"\nError generating stack: "+a.message+"\n"+a.stack}}function ut(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function mt(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function ht(e){e._valueTracker||(e._valueTracker=function(e){var t=mt(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==a&&"function"==typeof a.get&&"function"==typeof a.set){var n=a.get,i=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){s=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return s},setValue:function(e){s=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function pt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),s="";return e&&(s=mt(e)?e.checked?"true":"false":e.value),(e=s)!==a&&(t.setValue(e),!0)}function ft(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}var xt=/[\n"\\]/g;function gt(e){return e.replace(xt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function vt(e,t,a,s,n,i,r,l){e.name="",null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r?e.type=r:e.removeAttribute("type"),null!=t?"number"===r?(0===t&&""===e.value||e.value!=t)&&(e.value=""+ut(t)):e.value!==""+ut(t)&&(e.value=""+ut(t)):"submit"!==r&&"reset"!==r||e.removeAttribute("value"),null!=t?jt(e,r,ut(t)):null!=a?jt(e,r,ut(a)):null!=s&&e.removeAttribute("value"),null==n&&null!=i&&(e.defaultChecked=!!i),null!=n&&(e.checked=n&&"function"!=typeof n&&"symbol"!=typeof n),null!=l&&"function"!=typeof l&&"symbol"!=typeof l&&"boolean"!=typeof l?e.name=""+ut(l):e.removeAttribute("name")}function yt(e,t,a,s,n,i,r,l){if(null!=i&&"function"!=typeof i&&"symbol"!=typeof i&&"boolean"!=typeof i&&(e.type=i),null!=t||null!=a){if(("submit"===i||"reset"===i)&&null==t)return;a=null!=a?""+ut(a):"",t=null!=t?""+ut(t):a,l||t===e.value||(e.value=t),e.defaultValue=t}s="function"!=typeof(s=null!=s?s:n)&&"symbol"!=typeof s&&!!s,e.checked=l?e.checked:!!s,e.defaultChecked=!!s,null!=r&&"function"!=typeof r&&"symbol"!=typeof r&&"boolean"!=typeof r&&(e.name=r)}function jt(e,t,a){"number"===t&&ft(e.ownerDocument)===e||e.defaultValue===""+a||(e.defaultValue=""+a)}function bt(e,t,a,s){if(e=e.options,t){t={};for(var n=0;n<a.length;n++)t["$"+a[n]]=!0;for(a=0;a<e.length;a++)n=t.hasOwnProperty("$"+e[a].value),e[a].selected!==n&&(e[a].selected=n),n&&s&&(e[a].defaultSelected=!0)}else{for(a=""+ut(a),t=null,n=0;n<e.length;n++){if(e[n].value===a)return e[n].selected=!0,void(s&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function Nt(e,t,a){null==t||((t=""+ut(t))!==e.value&&(e.value=t),null!=a)?e.defaultValue=null!=a?""+ut(a):"":e.defaultValue!==t&&(e.defaultValue=t)}function wt(e,t,a,s){if(null==t){if(null!=s){if(null!=a)throw Error(i(92));if(L(s)){if(1<s.length)throw Error(i(93));s=s[0]}a=s}null==a&&(a=""),t=a}a=ut(t),e.defaultValue=a,(s=e.textContent)===a&&""!==s&&null!==s&&(e.value=s)}function kt(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var _t=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function St(e,t,a){var s=0===t.indexOf("--");null==a||"boolean"==typeof a||""===a?s?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":s?e.setProperty(t,a):"number"!=typeof a||0===a||_t.has(t)?"float"===t?e.cssFloat=a:e[t]=(""+a).trim():e[t]=a+"px"}function Ct(e,t,a){if(null!=t&&"object"!=typeof t)throw Error(i(62));if(e=e.style,null!=a){for(var s in a)!a.hasOwnProperty(s)||null!=t&&t.hasOwnProperty(s)||(0===s.indexOf("--")?e.setProperty(s,""):"float"===s?e.cssFloat="":e[s]="");for(var n in t)s=t[n],t.hasOwnProperty(n)&&a[n]!==s&&St(e,n,s)}else for(var r in t)t.hasOwnProperty(r)&&St(e,r,t[r])}function At(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Et=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tt(e){return Pt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var It=null;function Ft(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var $t=null,Lt=null;function Mt(e){var t=Xe(e);if(t&&(e=t.stateNode)){var a=e[Le]||null;e:switch(e=t.stateNode,t.type){case"input":if(vt(e,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll('input[name="'+gt(""+t)+'"][type="radio"]'),t=0;t<a.length;t++){var s=a[t];if(s!==e&&s.form===e.form){var n=s[Le]||null;if(!n)throw Error(i(90));vt(s,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name)}}for(t=0;t<a.length;t++)(s=a[t]).form===e.form&&pt(s)}break e;case"textarea":Nt(e,a.value,a.defaultValue);break e;case"select":null!=(t=a.value)&&bt(e,!!a.multiple,t,!1)}}}var Rt=!1;function Wt(e,t,a){if(Rt)return e(t,a);Rt=!0;try{return e(t)}finally{if(Rt=!1,(null!==$t||null!==Lt)&&(zo(),$t&&(t=$t,e=Lt,Lt=$t=null,Mt(t),e)))for(t=0;t<e.length;t++)Mt(e[t])}}function Ot(e,t){var a=e.stateNode;if(null===a)return null;var s=a[Le]||null;if(null===s)return null;a=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(s=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!s;break e;default:e=!1}if(e)return null;if(a&&"function"!=typeof a)throw Error(i(231,t,typeof a));return a}var Dt=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),Bt=!1;if(Dt)try{var Ut={};Object.defineProperty(Ut,"passive",{get:function(){Bt=!0}}),window.addEventListener("test",Ut,Ut),window.removeEventListener("test",Ut,Ut)}catch(Lm){Bt=!1}var zt=null,Xt=null,Ht=null;function qt(){if(Ht)return Ht;var e,t,a=Xt,s=a.length,n="value"in zt?zt.value:zt.textContent,i=n.length;for(e=0;e<s&&a[e]===n[e];e++);var r=s-e;for(t=1;t<=r&&a[s-t]===n[i-t];t++);return Ht=n.slice(e,1<t?1-t:void 0)}function Jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Vt(){return!0}function Gt(){return!1}function Kt(e){function t(t,a,s,n,i){for(var r in this._reactName=t,this._targetInst=s,this.type=a,this.nativeEvent=n,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(r)&&(t=e[r],this[r]=t?t(n):n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Vt:Gt,this.isPropagationStopped=Gt,this}return u(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Vt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Vt)},persist:function(){},isPersistent:Vt}),t}var Yt,Qt,Zt,ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ta=Kt(ea),aa=u({},ea,{view:0,detail:0}),sa=Kt(aa),na=u({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fa,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zt&&(Zt&&"mousemove"===e.type?(Yt=e.screenX-Zt.screenX,Qt=e.screenY-Zt.screenY):Qt=Yt=0,Zt=e),Yt)},movementY:function(e){return"movementY"in e?e.movementY:Qt}}),ia=Kt(na),ra=Kt(u({},na,{dataTransfer:0})),la=Kt(u({},aa,{relatedTarget:0})),ca=Kt(u({},ea,{animationName:0,elapsedTime:0,pseudoElement:0})),oa=Kt(u({},ea,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),da=Kt(u({},ea,{data:0})),ua={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ma={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ha={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pa(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ha[e])&&!!t[e]}function fa(){return pa}var xa=Kt(u({},aa,{key:function(e){if(e.key){var t=ua[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?ma[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fa,charCode:function(e){return"keypress"===e.type?Jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),ga=Kt(u({},na,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),va=Kt(u({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fa})),ya=Kt(u({},ea,{propertyName:0,elapsedTime:0,pseudoElement:0})),ja=Kt(u({},na,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),ba=Kt(u({},ea,{newState:0,oldState:0})),Na=[9,13,27,32],wa=Dt&&"CompositionEvent"in window,ka=null;Dt&&"documentMode"in document&&(ka=document.documentMode);var _a=Dt&&"TextEvent"in window&&!ka,Sa=Dt&&(!wa||ka&&8<ka&&11>=ka),Ca=String.fromCharCode(32),Aa=!1;function Ea(e,t){switch(e){case"keyup":return-1!==Na.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pa(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Ta=!1;var Ia={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Fa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Ia[e.type]:"textarea"===t}function $a(e,t,a,s){$t?Lt?Lt.push(s):Lt=[s]:$t=s,0<(t=qd(t,"onChange")).length&&(a=new ta("onChange","change",null,a,s),e.push({event:a,listeners:t}))}var La=null,Ma=null;function Ra(e){Wd(e,0)}function Wa(e){if(pt(He(e)))return e}function Oa(e,t){if("change"===e)return t}var Da=!1;if(Dt){var Ba;if(Dt){var Ua="oninput"in document;if(!Ua){var za=document.createElement("div");za.setAttribute("oninput","return;"),Ua="function"==typeof za.oninput}Ba=Ua}else Ba=!1;Da=Ba&&(!document.documentMode||9<document.documentMode)}function Xa(){La&&(La.detachEvent("onpropertychange",Ha),Ma=La=null)}function Ha(e){if("value"===e.propertyName&&Wa(Ma)){var t=[];$a(t,Ma,e,Ft(e)),Wt(Ra,t)}}function qa(e,t,a){"focusin"===e?(Xa(),Ma=a,(La=t).attachEvent("onpropertychange",Ha)):"focusout"===e&&Xa()}function Ja(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Wa(Ma)}function Va(e,t){if("click"===e)return Wa(t)}function Ga(e,t){if("input"===e||"change"===e)return Wa(t)}var Ka="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function Ya(e,t){if(Ka(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var a=Object.keys(e),s=Object.keys(t);if(a.length!==s.length)return!1;for(s=0;s<a.length;s++){var n=a[s];if(!Q.call(t,n)||!Ka(e[n],t[n]))return!1}return!0}function Qa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Za(e,t){var a,s=Qa(e);for(e=0;s;){if(3===s.nodeType){if(a=e+s.textContent.length,e<=t&&a>=t)return{node:s,offset:t-e};e=a}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Qa(s)}}function es(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?es(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ts(e){for(var t=ft((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var a="string"==typeof t.contentWindow.location.href}catch(s){a=!1}if(!a)break;t=ft((e=t.contentWindow).document)}return t}function as(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var ss=Dt&&"documentMode"in document&&11>=document.documentMode,ns=null,is=null,rs=null,ls=!1;function cs(e,t,a){var s=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;ls||null==ns||ns!==ft(s)||("selectionStart"in(s=ns)&&as(s)?s={start:s.selectionStart,end:s.selectionEnd}:s={anchorNode:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset},rs&&Ya(rs,s)||(rs=s,0<(s=qd(is,"onSelect")).length&&(t=new ta("onSelect","select",null,t,a),e.push({event:t,listeners:s}),t.target=ns)))}function os(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var ds={animationend:os("Animation","AnimationEnd"),animationiteration:os("Animation","AnimationIteration"),animationstart:os("Animation","AnimationStart"),transitionrun:os("Transition","TransitionRun"),transitionstart:os("Transition","TransitionStart"),transitioncancel:os("Transition","TransitionCancel"),transitionend:os("Transition","TransitionEnd")},us={},ms={};function hs(e){if(us[e])return us[e];if(!ds[e])return e;var t,a=ds[e];for(t in a)if(a.hasOwnProperty(t)&&t in ms)return us[e]=a[t];return e}Dt&&(ms=document.createElement("div").style,"AnimationEvent"in window||(delete ds.animationend.animation,delete ds.animationiteration.animation,delete ds.animationstart.animation),"TransitionEvent"in window||delete ds.transitionend.transition);var ps=hs("animationend"),fs=hs("animationiteration"),xs=hs("animationstart"),gs=hs("transitionrun"),vs=hs("transitionstart"),ys=hs("transitioncancel"),js=hs("transitionend"),bs=new Map,Ns="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ws(e,t){bs.set(e,t),Ke(t,[e])}Ns.push("scrollEnd");var ks=new WeakMap;function _s(e,t){if("object"==typeof e&&null!==e){var a=ks.get(e);return void 0!==a?a:(t={value:e,source:t,stack:dt(t)},ks.set(e,t),t)}return{value:e,source:t,stack:dt(t)}}var Ss=[],Cs=0,As=0;function Es(){for(var e=Cs,t=As=Cs=0;t<e;){var a=Ss[t];Ss[t++]=null;var s=Ss[t];Ss[t++]=null;var n=Ss[t];Ss[t++]=null;var i=Ss[t];if(Ss[t++]=null,null!==s&&null!==n){var r=s.pending;null===r?n.next=n:(n.next=r.next,r.next=n),s.pending=n}0!==i&&Fs(a,n,i)}}function Ps(e,t,a,s){Ss[Cs++]=e,Ss[Cs++]=t,Ss[Cs++]=a,Ss[Cs++]=s,As|=s,e.lanes|=s,null!==(e=e.alternate)&&(e.lanes|=s)}function Ts(e,t,a,s){return Ps(e,t,a,s),$s(e)}function Is(e,t){return Ps(e,null,null,t),$s(e)}function Fs(e,t,a){e.lanes|=a;var s=e.alternate;null!==s&&(s.lanes|=a);for(var n=!1,i=e.return;null!==i;)i.childLanes|=a,null!==(s=i.alternate)&&(s.childLanes|=a),22===i.tag&&(null===(e=i.stateNode)||1&e._visibility||(n=!0)),e=i,i=i.return;return 3===e.tag?(i=e.stateNode,n&&null!==t&&(n=31-fe(a),null===(s=(e=i.hiddenUpdates)[n])?e[n]=[t]:s.push(t),t.lane=536870912|a),i):null}function $s(e){if(50<$o)throw $o=0,Lo=null,Error(i(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Ls={};function Ms(e,t,a,s){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rs(e,t,a,s){return new Ms(e,t,a,s)}function Ws(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Os(e,t){var a=e.alternate;return null===a?((a=Rs(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=65011712&e.flags,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a.refCleanup=e.refCleanup,a}function Ds(e,t){e.flags&=65011714;var a=e.alternate;return null===a?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=a.childLanes,e.lanes=a.lanes,e.child=a.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=a.memoizedProps,e.memoizedState=a.memoizedState,e.updateQueue=a.updateQueue,e.type=a.type,t=a.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Bs(e,t,a,s,n,r){var l=0;if(s=e,"function"==typeof e)Ws(e)&&(l=1);else if("string"==typeof e)l=function(e,t,a){if(1===a||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!=typeof t.precedence||"string"!=typeof t.href||""===t.href)break;return!0;case"link":if("string"!=typeof t.rel||"string"!=typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"==typeof t.precedence&&null==e);case"script":if(t.async&&"function"!=typeof t.async&&"symbol"!=typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"==typeof t.src)return!0}return!1}(e,a,X.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case C:return(e=Rs(31,a,t,n)).elementType=C,e.lanes=r,e;case f:return Us(a.children,n,r,t);case x:l=8,n|=24;break;case g:return(e=Rs(12,a,t,2|n)).elementType=g,e.lanes=r,e;case N:return(e=Rs(13,a,t,n)).elementType=N,e.lanes=r,e;case w:return(e=Rs(19,a,t,n)).elementType=w,e.lanes=r,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case v:case j:l=10;break e;case y:l=9;break e;case b:l=11;break e;case k:l=14;break e;case _:l=16,s=null;break e}l=29,a=Error(i(130,null===e?"null":typeof e,"")),s=null}return(t=Rs(l,a,t,n)).elementType=e,t.type=s,t.lanes=r,t}function Us(e,t,a,s){return(e=Rs(7,e,s,t)).lanes=a,e}function zs(e,t,a){return(e=Rs(6,e,null,t)).lanes=a,e}function Xs(e,t,a){return(t=Rs(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Hs=[],qs=0,Js=null,Vs=0,Gs=[],Ks=0,Ys=null,Qs=1,Zs="";function en(e,t){Hs[qs++]=Vs,Hs[qs++]=Js,Js=e,Vs=t}function tn(e,t,a){Gs[Ks++]=Qs,Gs[Ks++]=Zs,Gs[Ks++]=Ys,Ys=e;var s=Qs;e=Zs;var n=32-fe(s)-1;s&=~(1<<n),a+=1;var i=32-fe(t)+n;if(30<i){var r=n-n%5;i=(s&(1<<r)-1).toString(32),s>>=r,n-=r,Qs=1<<32-fe(t)+n|a<<n|s,Zs=i+e}else Qs=1<<i|a<<n|s,Zs=e}function an(e){null!==e.return&&(en(e,1),tn(e,1,0))}function sn(e){for(;e===Js;)Js=Hs[--qs],Hs[qs]=null,Vs=Hs[--qs],Hs[qs]=null;for(;e===Ys;)Ys=Gs[--Ks],Gs[Ks]=null,Zs=Gs[--Ks],Gs[Ks]=null,Qs=Gs[--Ks],Gs[Ks]=null}var nn=null,rn=null,ln=!1,cn=null,on=!1,dn=Error(i(519));function un(e){throw gn(_s(Error(i(418,"")),e)),dn}function mn(e){var t=e.stateNode,a=e.type,s=e.memoizedProps;switch(t[$e]=e,t[Le]=s,a){case"dialog":Od("cancel",t),Od("close",t);break;case"iframe":case"object":case"embed":Od("load",t);break;case"video":case"audio":for(a=0;a<Md.length;a++)Od(Md[a],t);break;case"source":Od("error",t);break;case"img":case"image":case"link":Od("error",t),Od("load",t);break;case"details":Od("toggle",t);break;case"input":Od("invalid",t),yt(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),ht(t);break;case"select":Od("invalid",t);break;case"textarea":Od("invalid",t),wt(t,s.value,s.defaultValue,s.children),ht(t)}"string"!=typeof(a=s.children)&&"number"!=typeof a&&"bigint"!=typeof a||t.textContent===""+a||!0===s.suppressHydrationWarning||Qd(t.textContent,a)?(null!=s.popover&&(Od("beforetoggle",t),Od("toggle",t)),null!=s.onScroll&&Od("scroll",t),null!=s.onScrollEnd&&Od("scrollend",t),null!=s.onClick&&(t.onclick=Zd),t=!0):t=!1,t||un(e)}function hn(e){for(nn=e.return;nn;)switch(nn.tag){case 5:case 13:return void(on=!1);case 27:case 3:return void(on=!0);default:nn=nn.return}}function pn(e){if(e!==nn)return!1;if(!ln)return hn(e),ln=!0,!1;var t,a=e.tag;if((t=3!==a&&27!==a)&&((t=5===a)&&(t=!("form"!==(t=e.type)&&"button"!==t)||cu(e.type,e.memoizedProps)),t=!t),t&&rn&&un(e),hn(e),13===a){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,a=0;e;){if(8===e.nodeType)if("/$"===(t=e.data)){if(0===a){rn=yu(e.nextSibling);break e}a--}else"$"!==t&&"$!"!==t&&"$?"!==t||a++;e=e.nextSibling}rn=null}}else 27===a?(a=rn,fu(e.type)?(e=ju,ju=null,rn=e):rn=a):rn=nn?yu(e.stateNode.nextSibling):null;return!0}function fn(){rn=nn=null,ln=!1}function xn(){var e=cn;return null!==e&&(null===bo?bo=e:bo.push.apply(bo,e),cn=null),e}function gn(e){null===cn?cn=[e]:cn.push(e)}var vn=B(null),yn=null,jn=null;function bn(e,t,a){z(vn,t._currentValue),t._currentValue=a}function Nn(e){e._currentValue=vn.current,U(vn)}function wn(e,t,a){for(;null!==e;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==s&&(s.childLanes|=t)):null!==s&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===a)break;e=e.return}}function kn(e,t,a,s){var n=e.child;for(null!==n&&(n.return=e);null!==n;){var r=n.dependencies;if(null!==r){var l=n.child;r=r.firstContext;e:for(;null!==r;){var c=r;r=n;for(var o=0;o<t.length;o++)if(c.context===t[o]){r.lanes|=a,null!==(c=r.alternate)&&(c.lanes|=a),wn(r.return,a,e),s||(l=null);break e}r=c.next}}else if(18===n.tag){if(null===(l=n.return))throw Error(i(341));l.lanes|=a,null!==(r=l.alternate)&&(r.lanes|=a),wn(l,a,e),l=null}else l=n.child;if(null!==l)l.return=n;else for(l=n;null!==l;){if(l===e){l=null;break}if(null!==(n=l.sibling)){n.return=l.return,l=n;break}l=l.return}n=l}}function _n(e,t,a,s){e=null;for(var n=t,r=!1;null!==n;){if(!r)if(524288&n.flags)r=!0;else if(262144&n.flags)break;if(10===n.tag){var l=n.alternate;if(null===l)throw Error(i(387));if(null!==(l=l.memoizedProps)){var c=n.type;Ka(n.pendingProps.value,l.value)||(null!==e?e.push(c):e=[c])}}else if(n===J.current){if(null===(l=n.alternate))throw Error(i(387));l.memoizedState.memoizedState!==n.memoizedState.memoizedState&&(null!==e?e.push(Ku):e=[Ku])}n=n.return}null!==e&&kn(t,e,a,s),t.flags|=262144}function Sn(e){for(e=e.firstContext;null!==e;){if(!Ka(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Cn(e){yn=e,jn=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function An(e){return Pn(yn,e)}function En(e,t){return null===yn&&Cn(e),Pn(e,t)}function Pn(e,t){var a=t._currentValue;if(t={context:t,memoizedValue:a,next:null},null===jn){if(null===e)throw Error(i(308));jn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else jn=jn.next=t;return a}var Tn="undefined"!=typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,a){e.push(a)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},In=a.unstable_scheduleCallback,Fn=a.unstable_NormalPriority,$n={$$typeof:j,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ln(){return{controller:new Tn,data:new Map,refCount:0}}function Mn(e){e.refCount--,0===e.refCount&&In(Fn,function(){e.controller.abort()})}var Rn=null,Wn=0,On=0,Dn=null;function Bn(){if(0===--Wn&&null!==Rn){null!==Dn&&(Dn.status="fulfilled");var e=Rn;Rn=null,On=0,Dn=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Un=M.S;M.S=function(e,t){"object"==typeof t&&null!==t&&"function"==typeof t.then&&function(e,t){if(null===Rn){var a=Rn=[];Wn=0,On=Td(),Dn={status:"pending",value:void 0,then:function(e){a.push(e)}}}Wn++,t.then(Bn,Bn)}(0,t),null!==Un&&Un(e,t)};var zn=B(null);function Xn(){var e=zn.current;return null!==e?e:no.pooledCache}function Hn(e,t){z(zn,null===t?zn.current:t.pool)}function qn(){var e=Xn();return null===e?null:{parent:$n._currentValue,pool:e}}var Jn=Error(i(460)),Vn=Error(i(474)),Gn=Error(i(542)),Kn={then:function(){}};function Yn(e){return"fulfilled"===(e=e.status)||"rejected"===e}function Qn(){}function Zn(e,t,a){switch(void 0===(a=e[a])?e.push(t):a!==t&&(t.then(Qn,Qn),t=a),t.status){case"fulfilled":return t.value;case"rejected":throw ai(e=t.reason),e;default:if("string"==typeof t.status)t.then(Qn,Qn);else{if(null!==(e=no)&&100<e.shellSuspendCounter)throw Error(i(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var a=t;a.status="fulfilled",a.value=e}},function(e){if("pending"===t.status){var a=t;a.status="rejected",a.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ai(e=t.reason),e}throw ei=t,Jn}}var ei=null;function ti(){if(null===ei)throw Error(i(459));var e=ei;return ei=null,e}function ai(e){if(e===Jn||e===Gn)throw Error(i(483))}var si=!1;function ni(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ii(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ri(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function li(e,t,a){var s=e.updateQueue;if(null===s)return null;if(s=s.shared,2&so){var n=s.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),s.pending=t,t=$s(e),Fs(e,null,a),t}return Ps(e,s,t,a),$s(e)}function ci(e,t,a){if(null!==(t=t.updateQueue)&&(t=t.shared,4194048&a)){var s=t.lanes;a|=s&=e.pendingLanes,t.lanes=a,Ee(e,a)}}function oi(e,t){var a=e.updateQueue,s=e.alternate;if(null!==s&&a===(s=s.updateQueue)){var n=null,i=null;if(null!==(a=a.firstBaseUpdate)){do{var r={lane:a.lane,tag:a.tag,payload:a.payload,callback:null,next:null};null===i?n=i=r:i=i.next=r,a=a.next}while(null!==a);null===i?n=i=t:i=i.next=t}else n=i=t;return a={baseState:s.baseState,firstBaseUpdate:n,lastBaseUpdate:i,shared:s.shared,callbacks:s.callbacks},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}var di=!1;function ui(){if(di){if(null!==Dn)throw Dn}}function mi(e,t,a,s){di=!1;var n=e.updateQueue;si=!1;var i=n.firstBaseUpdate,r=n.lastBaseUpdate,l=n.shared.pending;if(null!==l){n.shared.pending=null;var c=l,o=c.next;c.next=null,null===r?i=o:r.next=o,r=c;var d=e.alternate;null!==d&&((l=(d=d.updateQueue).lastBaseUpdate)!==r&&(null===l?d.firstBaseUpdate=o:l.next=o,d.lastBaseUpdate=c))}if(null!==i){var m=n.baseState;for(r=0,d=o=c=null,l=i;;){var h=-536870913&l.lane,p=h!==l.lane;if(p?(ro&h)===h:(s&h)===h){0!==h&&h===On&&(di=!0),null!==d&&(d=d.next={lane:0,tag:l.tag,payload:l.payload,callback:null,next:null});e:{var f=e,x=l;h=t;var g=a;switch(x.tag){case 1:if("function"==typeof(f=x.payload)){m=f.call(g,m,h);break e}m=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null==(h="function"==typeof(f=x.payload)?f.call(g,m,h):f))break e;m=u({},m,h);break e;case 2:si=!0}}null!==(h=l.callback)&&(e.flags|=64,p&&(e.flags|=8192),null===(p=n.callbacks)?n.callbacks=[h]:p.push(h))}else p={lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===d?(o=d=p,c=m):d=d.next=p,r|=h;if(null===(l=l.next)){if(null===(l=n.shared.pending))break;l=(p=l).next,p.next=null,n.lastBaseUpdate=p,n.shared.pending=null}}null===d&&(c=m),n.baseState=c,n.firstBaseUpdate=o,n.lastBaseUpdate=d,null===i&&(n.shared.lanes=0),fo|=r,e.lanes=r,e.memoizedState=m}}function hi(e,t){if("function"!=typeof e)throw Error(i(191,e));e.call(t)}function pi(e,t){var a=e.callbacks;if(null!==a)for(e.callbacks=null,e=0;e<a.length;e++)hi(a[e],t)}var fi=B(null),xi=B(0);function gi(e,t){z(xi,e=ho),z(fi,t),ho=e|t.baseLanes}function vi(){z(xi,ho),z(fi,fi.current)}function yi(){ho=xi.current,U(fi),U(xi)}var ji=0,bi=null,Ni=null,wi=null,ki=!1,_i=!1,Si=!1,Ci=0,Ai=0,Ei=null,Pi=0;function Ti(){throw Error(i(321))}function Ii(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!Ka(e[a],t[a]))return!1;return!0}function Fi(e,t,a,s,n,i){return ji=i,bi=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,M.H=null===e||null===e.memoizedState?Jr:Vr,Si=!1,i=a(s,n),Si=!1,_i&&(i=Li(t,a,s,n)),$i(e),i}function $i(e){M.H=qr;var t=null!==Ni&&null!==Ni.next;if(ji=0,wi=Ni=bi=null,ki=!1,Ai=0,Ei=null,t)throw Error(i(300));null===e||Al||null!==(e=e.dependencies)&&Sn(e)&&(Al=!0)}function Li(e,t,a,s){bi=e;var n=0;do{if(_i&&(Ei=null),Ai=0,_i=!1,25<=n)throw Error(i(301));if(n+=1,wi=Ni=null,null!=e.updateQueue){var r=e.updateQueue;r.lastEffect=null,r.events=null,r.stores=null,null!=r.memoCache&&(r.memoCache.index=0)}M.H=Gr,r=t(a,s)}while(_i);return r}function Mi(){var e=M.H,t=e.useState()[0];return t="function"==typeof t.then?Ui(t):t,e=e.useState()[0],(null!==Ni?Ni.memoizedState:null)!==e&&(bi.flags|=1024),t}function Ri(){var e=0!==Ci;return Ci=0,e}function Wi(e,t,a){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a}function Oi(e){if(ki){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}ki=!1}ji=0,wi=Ni=bi=null,_i=!1,Ai=Ci=0,Ei=null}function Di(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===wi?bi.memoizedState=wi=e:wi=wi.next=e,wi}function Bi(){if(null===Ni){var e=bi.alternate;e=null!==e?e.memoizedState:null}else e=Ni.next;var t=null===wi?bi.memoizedState:wi.next;if(null!==t)wi=t,Ni=e;else{if(null===e){if(null===bi.alternate)throw Error(i(467));throw Error(i(310))}e={memoizedState:(Ni=e).memoizedState,baseState:Ni.baseState,baseQueue:Ni.baseQueue,queue:Ni.queue,next:null},null===wi?bi.memoizedState=wi=e:wi=wi.next=e}return wi}function Ui(e){var t=Ai;return Ai+=1,null===Ei&&(Ei=[]),e=Zn(Ei,e,t),t=bi,null===(null===wi?t.memoizedState:wi.next)&&(t=t.alternate,M.H=null===t||null===t.memoizedState?Jr:Vr),e}function zi(e){if(null!==e&&"object"==typeof e){if("function"==typeof e.then)return Ui(e);if(e.$$typeof===j)return An(e)}throw Error(i(438,String(e)))}function Xi(e){var t=null,a=bi.updateQueue;if(null!==a&&(t=a.memoCache),null==t){var s=bi.alternate;null!==s&&(null!==(s=s.updateQueue)&&(null!=(s=s.memoCache)&&(t={data:s.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===a&&(a={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=a),a.memoCache=t,void 0===(a=t.data[t.index]))for(a=t.data[t.index]=Array(e),s=0;s<e;s++)a[s]=A;return t.index++,a}function Hi(e,t){return"function"==typeof t?t(e):t}function qi(e){return Ji(Bi(),Ni,e)}function Ji(e,t,a){var s=e.queue;if(null===s)throw Error(i(311));s.lastRenderedReducer=a;var n=e.baseQueue,r=s.pending;if(null!==r){if(null!==n){var l=n.next;n.next=r.next,r.next=l}t.baseQueue=n=r,s.pending=null}if(r=e.baseState,null===n)e.memoizedState=r;else{var c=l=null,o=null,d=t=n.next,u=!1;do{var m=-536870913&d.lane;if(m!==d.lane?(ro&m)===m:(ji&m)===m){var h=d.revertLane;if(0===h)null!==o&&(o=o.next={lane:0,revertLane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),m===On&&(u=!0);else{if((ji&h)===h){d=d.next,h===On&&(u=!0);continue}m={lane:0,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===o?(c=o=m,l=r):o=o.next=m,bi.lanes|=h,fo|=h}m=d.action,Si&&a(r,m),r=d.hasEagerState?d.eagerState:a(r,m)}else h={lane:m,revertLane:d.revertLane,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null},null===o?(c=o=h,l=r):o=o.next=h,bi.lanes|=m,fo|=m;d=d.next}while(null!==d&&d!==t);if(null===o?l=r:o.next=c,!Ka(r,e.memoizedState)&&(Al=!0,u&&null!==(a=Dn)))throw a;e.memoizedState=r,e.baseState=l,e.baseQueue=o,s.lastRenderedState=r}return null===n&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Vi(e){var t=Bi(),a=t.queue;if(null===a)throw Error(i(311));a.lastRenderedReducer=e;var s=a.dispatch,n=a.pending,r=t.memoizedState;if(null!==n){a.pending=null;var l=n=n.next;do{r=e(r,l.action),l=l.next}while(l!==n);Ka(r,t.memoizedState)||(Al=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),a.lastRenderedState=r}return[r,s]}function Gi(e,t,a){var s=bi,n=Bi(),r=ln;if(r){if(void 0===a)throw Error(i(407));a=a()}else a=t();var l=!Ka((Ni||n).memoizedState,a);if(l&&(n.memoizedState=a,Al=!0),n=n.queue,vr(2048,8,Qi.bind(null,s,n,e),[e]),n.getSnapshot!==t||l||null!==wi&&1&wi.memoizedState.tag){if(s.flags|=2048,fr(9,{destroy:void 0,resource:void 0},Yi.bind(null,s,n,a,t),null),null===no)throw Error(i(349));r||124&ji||Ki(s,t,a)}return a}function Ki(e,t,a){e.flags|=16384,e={getSnapshot:t,value:a},null===(t=bi.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=t,t.stores=[e]):null===(a=t.stores)?t.stores=[e]:a.push(e)}function Yi(e,t,a,s){t.value=a,t.getSnapshot=s,Zi(t)&&er(e)}function Qi(e,t,a){return a(function(){Zi(t)&&er(e)})}function Zi(e){var t=e.getSnapshot;e=e.value;try{var a=t();return!Ka(e,a)}catch(s){return!0}}function er(e){var t=Is(e,2);null!==t&&Wo(t,e,2)}function tr(e){var t=Di();if("function"==typeof e){var a=e;if(e=a(),Si){pe(!0);try{a()}finally{pe(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:e},t}function ar(e,t,a,s){return e.baseState=a,Ji(e,Ni,"function"==typeof s?s:Hi)}function sr(e,t,a,s,n){if(zr(e))throw Error(i(485));if(null!==(e=t.action)){var r={payload:n,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){r.listeners.push(e)}};null!==M.T?a(!0):r.isTransition=!1,s(r),null===(a=t.pending)?(r.next=t.pending=r,nr(t,r)):(r.next=a.next,t.pending=a.next=r)}}function nr(e,t){var a=t.action,s=t.payload,n=e.state;if(t.isTransition){var i=M.T,r={};M.T=r;try{var l=a(n,s),c=M.S;null!==c&&c(r,l),ir(e,t,l)}catch(o){lr(e,t,o)}finally{M.T=i}}else try{ir(e,t,i=a(n,s))}catch(d){lr(e,t,d)}}function ir(e,t,a){null!==a&&"object"==typeof a&&"function"==typeof a.then?a.then(function(a){rr(e,t,a)},function(a){return lr(e,t,a)}):rr(e,t,a)}function rr(e,t,a){t.status="fulfilled",t.value=a,cr(t),e.state=a,null!==(t=e.pending)&&((a=t.next)===t?e.pending=null:(a=a.next,t.next=a,nr(e,a)))}function lr(e,t,a){var s=e.pending;if(e.pending=null,null!==s){s=s.next;do{t.status="rejected",t.reason=a,cr(t),t=t.next}while(t!==s)}e.action=null}function cr(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function or(e,t){return t}function dr(e,t){if(ln){var a=no.formState;if(null!==a){e:{var s=bi;if(ln){if(rn){t:{for(var n=rn,i=on;8!==n.nodeType;){if(!i){n=null;break t}if(null===(n=yu(n.nextSibling))){n=null;break t}}n="F!"===(i=n.data)||"F"===i?n:null}if(n){rn=yu(n.nextSibling),s="F!"===n.data;break e}}un(s)}s=!1}s&&(t=a[0])}}return(a=Di()).memoizedState=a.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:or,lastRenderedState:t},a.queue=s,a=Dr.bind(null,bi,s),s.dispatch=a,s=tr(!1),i=Ur.bind(null,bi,!1,s.queue),n={state:t,dispatch:null,action:e,pending:null},(s=Di()).queue=n,a=sr.bind(null,bi,n,i,a),n.dispatch=a,s.memoizedState=e,[t,a,!1]}function ur(e){return mr(Bi(),Ni,e)}function mr(e,t,a){if(t=Ji(e,t,or)[0],e=qi(Hi)[0],"object"==typeof t&&null!==t&&"function"==typeof t.then)try{var s=Ui(t)}catch(r){if(r===Jn)throw Gn;throw r}else s=t;var n=(t=Bi()).queue,i=n.dispatch;return a!==t.memoizedState&&(bi.flags|=2048,fr(9,{destroy:void 0,resource:void 0},hr.bind(null,n,a),null)),[s,i,e]}function hr(e,t){e.action=t}function pr(e){var t=Bi(),a=Ni;if(null!==a)return mr(t,a,e);Bi(),t=t.memoizedState;var s=(a=Bi()).queue.dispatch;return a.memoizedState=e,[t,s,!1]}function fr(e,t,a,s){return e={tag:e,create:a,deps:s,inst:t,next:null},null===(t=bi.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},bi.updateQueue=t),null===(a=t.lastEffect)?t.lastEffect=e.next=e:(s=a.next,a.next=e,e.next=s,t.lastEffect=e),e}function xr(){return Bi().memoizedState}function gr(e,t,a,s){var n=Di();s=void 0===s?null:s,bi.flags|=e,n.memoizedState=fr(1|t,{destroy:void 0,resource:void 0},a,s)}function vr(e,t,a,s){var n=Bi();s=void 0===s?null:s;var i=n.memoizedState.inst;null!==Ni&&null!==s&&Ii(s,Ni.memoizedState.deps)?n.memoizedState=fr(t,i,a,s):(bi.flags|=e,n.memoizedState=fr(1|t,i,a,s))}function yr(e,t){gr(8390656,8,e,t)}function jr(e,t){vr(2048,8,e,t)}function br(e,t){return vr(4,2,e,t)}function Nr(e,t){return vr(4,4,e,t)}function wr(e,t){if("function"==typeof t){e=e();var a=t(e);return function(){"function"==typeof a?a():t(null)}}if(null!=t)return e=e(),t.current=e,function(){t.current=null}}function kr(e,t,a){a=null!=a?a.concat([e]):null,vr(4,4,wr.bind(null,t,e),a)}function _r(){}function Sr(e,t){var a=Bi();t=void 0===t?null:t;var s=a.memoizedState;return null!==t&&Ii(t,s[1])?s[0]:(a.memoizedState=[e,t],e)}function Cr(e,t){var a=Bi();t=void 0===t?null:t;var s=a.memoizedState;if(null!==t&&Ii(t,s[1]))return s[0];if(s=e(),Si){pe(!0);try{e()}finally{pe(!1)}}return a.memoizedState=[s,t],s}function Ar(e,t,a){return void 0===a||1073741824&ji?e.memoizedState=t:(e.memoizedState=a,e=Ro(),bi.lanes|=e,fo|=e,a)}function Er(e,t,a,s){return Ka(a,t)?a:null!==fi.current?(e=Ar(e,a,s),Ka(e,t)||(Al=!0),e):42&ji?(e=Ro(),bi.lanes|=e,fo|=e,t):(Al=!0,e.memoizedState=a)}function Pr(e,t,a,s,n){var i=R.p;R.p=0!==i&&8>i?i:8;var r,l,c,o=M.T,d={};M.T=d,Ur(e,!1,t,a);try{var u=n(),m=M.S;if(null!==m&&m(d,u),null!==u&&"object"==typeof u&&"function"==typeof u.then)Br(e,t,(r=s,l=[],c={status:"pending",value:null,reason:null,then:function(e){l.push(e)}},u.then(function(){c.status="fulfilled",c.value=r;for(var e=0;e<l.length;e++)(0,l[e])(r)},function(e){for(c.status="rejected",c.reason=e,e=0;e<l.length;e++)(0,l[e])(void 0)}),c),Mo());else Br(e,t,s,Mo())}catch(h){Br(e,t,{then:function(){},status:"rejected",reason:h},Mo())}finally{R.p=i,M.T=o}}function Tr(){}function Ir(e,t,a,s){if(5!==e.tag)throw Error(i(476));var n=Fr(e).queue;Pr(e,n,t,W,null===a?Tr:function(){return $r(e),a(s)})}function Fr(e){var t=e.memoizedState;if(null!==t)return t;var a={};return(t={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:W},next:null}).next={memoizedState:a,baseState:a,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:a},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function $r(e){Br(e,Fr(e).next.queue,{},Mo())}function Lr(){return An(Ku)}function Mr(){return Bi().memoizedState}function Rr(){return Bi().memoizedState}function Wr(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var a=Mo(),s=li(t,e=ri(a),a);return null!==s&&(Wo(s,t,a),ci(s,t,a)),t={cache:Ln()},void(e.payload=t)}t=t.return}}function Or(e,t,a){var s=Mo();a={lane:s,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null},zr(e)?Xr(t,a):null!==(a=Ts(e,t,a,s))&&(Wo(a,e,s),Hr(a,t,s))}function Dr(e,t,a){Br(e,t,a,Mo())}function Br(e,t,a,s){var n={lane:s,revertLane:0,action:a,hasEagerState:!1,eagerState:null,next:null};if(zr(e))Xr(t,n);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var r=t.lastRenderedState,l=i(r,a);if(n.hasEagerState=!0,n.eagerState=l,Ka(l,r))return Ps(e,t,n,0),null===no&&Es(),!1}catch(c){}if(null!==(a=Ts(e,t,n,s)))return Wo(a,e,s),Hr(a,t,s),!0}return!1}function Ur(e,t,a,s){if(s={lane:2,revertLane:Td(),action:s,hasEagerState:!1,eagerState:null,next:null},zr(e)){if(t)throw Error(i(479))}else null!==(t=Ts(e,a,s,2))&&Wo(t,e,2)}function zr(e){var t=e.alternate;return e===bi||null!==t&&t===bi}function Xr(e,t){_i=ki=!0;var a=e.pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}function Hr(e,t,a){if(4194048&a){var s=t.lanes;a|=s&=e.pendingLanes,t.lanes=a,Ee(e,a)}}var qr={readContext:An,use:zi,useCallback:Ti,useContext:Ti,useEffect:Ti,useImperativeHandle:Ti,useLayoutEffect:Ti,useInsertionEffect:Ti,useMemo:Ti,useReducer:Ti,useRef:Ti,useState:Ti,useDebugValue:Ti,useDeferredValue:Ti,useTransition:Ti,useSyncExternalStore:Ti,useId:Ti,useHostTransitionStatus:Ti,useFormState:Ti,useActionState:Ti,useOptimistic:Ti,useMemoCache:Ti,useCacheRefresh:Ti},Jr={readContext:An,use:zi,useCallback:function(e,t){return Di().memoizedState=[e,void 0===t?null:t],e},useContext:An,useEffect:yr,useImperativeHandle:function(e,t,a){a=null!=a?a.concat([e]):null,gr(4194308,4,wr.bind(null,t,e),a)},useLayoutEffect:function(e,t){return gr(4194308,4,e,t)},useInsertionEffect:function(e,t){gr(4,2,e,t)},useMemo:function(e,t){var a=Di();t=void 0===t?null:t;var s=e();if(Si){pe(!0);try{e()}finally{pe(!1)}}return a.memoizedState=[s,t],s},useReducer:function(e,t,a){var s=Di();if(void 0!==a){var n=a(t);if(Si){pe(!0);try{a(t)}finally{pe(!1)}}}else n=t;return s.memoizedState=s.baseState=n,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:n},s.queue=e,e=e.dispatch=Or.bind(null,bi,e),[s.memoizedState,e]},useRef:function(e){return e={current:e},Di().memoizedState=e},useState:function(e){var t=(e=tr(e)).queue,a=Dr.bind(null,bi,t);return t.dispatch=a,[e.memoizedState,a]},useDebugValue:_r,useDeferredValue:function(e,t){return Ar(Di(),e,t)},useTransition:function(){var e=tr(!1);return e=Pr.bind(null,bi,e.queue,!0,!1),Di().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,a){var s=bi,n=Di();if(ln){if(void 0===a)throw Error(i(407));a=a()}else{if(a=t(),null===no)throw Error(i(349));124&ro||Ki(s,t,a)}n.memoizedState=a;var r={value:a,getSnapshot:t};return n.queue=r,yr(Qi.bind(null,s,r,e),[e]),s.flags|=2048,fr(9,{destroy:void 0,resource:void 0},Yi.bind(null,s,r,a,t),null),a},useId:function(){var e=Di(),t=no.identifierPrefix;if(ln){var a=Zs;t="«"+t+"R"+(a=(Qs&~(1<<32-fe(Qs)-1)).toString(32)+a),0<(a=Ci++)&&(t+="H"+a.toString(32)),t+="»"}else t="«"+t+"r"+(a=Pi++).toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Lr,useFormState:dr,useActionState:dr,useOptimistic:function(e){var t=Di();t.memoizedState=t.baseState=e;var a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=a,t=Ur.bind(null,bi,!0,a),a.dispatch=t,[e,t]},useMemoCache:Xi,useCacheRefresh:function(){return Di().memoizedState=Wr.bind(null,bi)}},Vr={readContext:An,use:zi,useCallback:Sr,useContext:An,useEffect:jr,useImperativeHandle:kr,useInsertionEffect:br,useLayoutEffect:Nr,useMemo:Cr,useReducer:qi,useRef:xr,useState:function(){return qi(Hi)},useDebugValue:_r,useDeferredValue:function(e,t){return Er(Bi(),Ni.memoizedState,e,t)},useTransition:function(){var e=qi(Hi)[0],t=Bi().memoizedState;return["boolean"==typeof e?e:Ui(e),t]},useSyncExternalStore:Gi,useId:Mr,useHostTransitionStatus:Lr,useFormState:ur,useActionState:ur,useOptimistic:function(e,t){return ar(Bi(),0,e,t)},useMemoCache:Xi,useCacheRefresh:Rr},Gr={readContext:An,use:zi,useCallback:Sr,useContext:An,useEffect:jr,useImperativeHandle:kr,useInsertionEffect:br,useLayoutEffect:Nr,useMemo:Cr,useReducer:Vi,useRef:xr,useState:function(){return Vi(Hi)},useDebugValue:_r,useDeferredValue:function(e,t){var a=Bi();return null===Ni?Ar(a,e,t):Er(a,Ni.memoizedState,e,t)},useTransition:function(){var e=Vi(Hi)[0],t=Bi().memoizedState;return["boolean"==typeof e?e:Ui(e),t]},useSyncExternalStore:Gi,useId:Mr,useHostTransitionStatus:Lr,useFormState:pr,useActionState:pr,useOptimistic:function(e,t){var a=Bi();return null!==Ni?ar(a,0,e,t):(a.baseState=e,[e,a.queue.dispatch])},useMemoCache:Xi,useCacheRefresh:Rr},Kr=null,Yr=0;function Qr(e){var t=Yr;return Yr+=1,null===Kr&&(Kr=[]),Zn(Kr,e,t)}function Zr(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function el(e,t){if(t.$$typeof===m)throw Error(i(525));throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function tl(e){return(0,e._init)(e._payload)}function al(e){function t(t,a){if(e){var s=t.deletions;null===s?(t.deletions=[a],t.flags|=16):s.push(a)}}function a(a,s){if(!e)return null;for(;null!==s;)t(a,s),s=s.sibling;return null}function s(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function n(e,t){return(e=Os(e,t)).index=0,e.sibling=null,e}function r(t,a,s){return t.index=s,e?null!==(s=t.alternate)?(s=s.index)<a?(t.flags|=67108866,a):s:(t.flags|=67108866,a):(t.flags|=1048576,a)}function l(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,a,s){return null===t||6!==t.tag?((t=zs(a,e.mode,s)).return=e,t):((t=n(t,a)).return=e,t)}function o(e,t,a,s){var i=a.type;return i===f?u(e,t,a.props.children,s,a.key):null!==t&&(t.elementType===i||"object"==typeof i&&null!==i&&i.$$typeof===_&&tl(i)===t.type)?(Zr(t=n(t,a.props),a),t.return=e,t):(Zr(t=Bs(a.type,a.key,a.props,null,e.mode,s),a),t.return=e,t)}function d(e,t,a,s){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=Xs(a,e.mode,s)).return=e,t):((t=n(t,a.children||[])).return=e,t)}function u(e,t,a,s,i){return null===t||7!==t.tag?((t=Us(a,e.mode,s,i)).return=e,t):((t=n(t,a)).return=e,t)}function m(e,t,a){if("string"==typeof t&&""!==t||"number"==typeof t||"bigint"==typeof t)return(t=zs(""+t,e.mode,a)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case h:return Zr(a=Bs(t.type,t.key,t.props,null,e.mode,a),t),a.return=e,a;case p:return(t=Xs(t,e.mode,a)).return=e,t;case _:return m(e,t=(0,t._init)(t._payload),a)}if(L(t)||T(t))return(t=Us(t,e.mode,a,null)).return=e,t;if("function"==typeof t.then)return m(e,Qr(t),a);if(t.$$typeof===j)return m(e,En(e,t),a);el(e,t)}return null}function x(e,t,a,s){var n=null!==t?t.key:null;if("string"==typeof a&&""!==a||"number"==typeof a||"bigint"==typeof a)return null!==n?null:c(e,t,""+a,s);if("object"==typeof a&&null!==a){switch(a.$$typeof){case h:return a.key===n?o(e,t,a,s):null;case p:return a.key===n?d(e,t,a,s):null;case _:return x(e,t,a=(n=a._init)(a._payload),s)}if(L(a)||T(a))return null!==n?null:u(e,t,a,s,null);if("function"==typeof a.then)return x(e,t,Qr(a),s);if(a.$$typeof===j)return x(e,t,En(e,a),s);el(e,a)}return null}function g(e,t,a,s,n){if("string"==typeof s&&""!==s||"number"==typeof s||"bigint"==typeof s)return c(t,e=e.get(a)||null,""+s,n);if("object"==typeof s&&null!==s){switch(s.$$typeof){case h:return o(t,e=e.get(null===s.key?a:s.key)||null,s,n);case p:return d(t,e=e.get(null===s.key?a:s.key)||null,s,n);case _:return g(e,t,a,s=(0,s._init)(s._payload),n)}if(L(s)||T(s))return u(t,e=e.get(a)||null,s,n,null);if("function"==typeof s.then)return g(e,t,a,Qr(s),n);if(s.$$typeof===j)return g(e,t,a,En(t,s),n);el(t,s)}return null}function v(c,o,d,u){if("object"==typeof d&&null!==d&&d.type===f&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case h:e:{for(var y=d.key;null!==o;){if(o.key===y){if((y=d.type)===f){if(7===o.tag){a(c,o.sibling),(u=n(o,d.props.children)).return=c,c=u;break e}}else if(o.elementType===y||"object"==typeof y&&null!==y&&y.$$typeof===_&&tl(y)===o.type){a(c,o.sibling),Zr(u=n(o,d.props),d),u.return=c,c=u;break e}a(c,o);break}t(c,o),o=o.sibling}d.type===f?((u=Us(d.props.children,c.mode,u,d.key)).return=c,c=u):(Zr(u=Bs(d.type,d.key,d.props,null,c.mode,u),d),u.return=c,c=u)}return l(c);case p:e:{for(y=d.key;null!==o;){if(o.key===y){if(4===o.tag&&o.stateNode.containerInfo===d.containerInfo&&o.stateNode.implementation===d.implementation){a(c,o.sibling),(u=n(o,d.children||[])).return=c,c=u;break e}a(c,o);break}t(c,o),o=o.sibling}(u=Xs(d,c.mode,u)).return=c,c=u}return l(c);case _:return v(c,o,d=(y=d._init)(d._payload),u)}if(L(d))return function(n,i,l,c){for(var o=null,d=null,u=i,h=i=0,p=null;null!==u&&h<l.length;h++){u.index>h?(p=u,u=null):p=u.sibling;var f=x(n,u,l[h],c);if(null===f){null===u&&(u=p);break}e&&u&&null===f.alternate&&t(n,u),i=r(f,i,h),null===d?o=f:d.sibling=f,d=f,u=p}if(h===l.length)return a(n,u),ln&&en(n,h),o;if(null===u){for(;h<l.length;h++)null!==(u=m(n,l[h],c))&&(i=r(u,i,h),null===d?o=u:d.sibling=u,d=u);return ln&&en(n,h),o}for(u=s(u);h<l.length;h++)null!==(p=g(u,n,h,l[h],c))&&(e&&null!==p.alternate&&u.delete(null===p.key?h:p.key),i=r(p,i,h),null===d?o=p:d.sibling=p,d=p);return e&&u.forEach(function(e){return t(n,e)}),ln&&en(n,h),o}(c,o,d,u);if(T(d)){if("function"!=typeof(y=T(d)))throw Error(i(150));return function(n,l,c,o){if(null==c)throw Error(i(151));for(var d=null,u=null,h=l,p=l=0,f=null,v=c.next();null!==h&&!v.done;p++,v=c.next()){h.index>p?(f=h,h=null):f=h.sibling;var y=x(n,h,v.value,o);if(null===y){null===h&&(h=f);break}e&&h&&null===y.alternate&&t(n,h),l=r(y,l,p),null===u?d=y:u.sibling=y,u=y,h=f}if(v.done)return a(n,h),ln&&en(n,p),d;if(null===h){for(;!v.done;p++,v=c.next())null!==(v=m(n,v.value,o))&&(l=r(v,l,p),null===u?d=v:u.sibling=v,u=v);return ln&&en(n,p),d}for(h=s(h);!v.done;p++,v=c.next())null!==(v=g(h,n,p,v.value,o))&&(e&&null!==v.alternate&&h.delete(null===v.key?p:v.key),l=r(v,l,p),null===u?d=v:u.sibling=v,u=v);return e&&h.forEach(function(e){return t(n,e)}),ln&&en(n,p),d}(c,o,d=y.call(d),u)}if("function"==typeof d.then)return v(c,o,Qr(d),u);if(d.$$typeof===j)return v(c,o,En(c,d),u);el(c,d)}return"string"==typeof d&&""!==d||"number"==typeof d||"bigint"==typeof d?(d=""+d,null!==o&&6===o.tag?(a(c,o.sibling),(u=n(o,d)).return=c,c=u):(a(c,o),(u=zs(d,c.mode,u)).return=c,c=u),l(c)):a(c,o)}return function(e,t,a,s){try{Yr=0;var n=v(e,t,a,s);return Kr=null,n}catch(r){if(r===Jn||r===Gn)throw r;var i=Rs(29,r,null,e.mode);return i.lanes=s,i.return=e,i}}}var sl=al(!0),nl=al(!1),il=B(null),rl=null;function ll(e){var t=e.alternate;z(ul,1&ul.current),z(il,e),null===rl&&(null===t||null!==fi.current||null!==t.memoizedState)&&(rl=e)}function cl(e){if(22===e.tag){if(z(ul,ul.current),z(il,e),null===rl){var t=e.alternate;null!==t&&null!==t.memoizedState&&(rl=e)}}else ol()}function ol(){z(ul,ul.current),z(il,il.current)}function dl(e){U(il),rl===e&&(rl=null),U(ul)}var ul=B(0);function ml(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||"$?"===a.data||vu(a)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function hl(e,t,a,s){a=null==(a=a(s,t=e.memoizedState))?t:u({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}var pl={enqueueSetState:function(e,t,a){e=e._reactInternals;var s=Mo(),n=ri(s);n.payload=t,null!=a&&(n.callback=a),null!==(t=li(e,n,s))&&(Wo(t,e,s),ci(t,e,s))},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var s=Mo(),n=ri(s);n.tag=1,n.payload=t,null!=a&&(n.callback=a),null!==(t=li(e,n,s))&&(Wo(t,e,s),ci(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=Mo(),s=ri(a);s.tag=2,null!=t&&(s.callback=t),null!==(t=li(e,s,a))&&(Wo(t,e,a),ci(t,e,a))}};function fl(e,t,a,s,n,i,r){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(s,i,r):!t.prototype||!t.prototype.isPureReactComponent||(!Ya(a,s)||!Ya(n,i))}function xl(e,t,a,s){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,s),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,s),t.state!==e&&pl.enqueueReplaceState(t,t.state,null)}function gl(e,t){var a=t;if("ref"in t)for(var s in a={},t)"ref"!==s&&(a[s]=t[s]);if(e=e.defaultProps)for(var n in a===t&&(a=u({},a)),e)void 0===a[n]&&(a[n]=e[n]);return a}var vl="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function yl(e){vl(e)}function jl(e){console.error(e)}function bl(e){vl(e)}function Nl(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(a){setTimeout(function(){throw a})}}function wl(e,t,a){try{(0,e.onCaughtError)(a.value,{componentStack:a.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(s){setTimeout(function(){throw s})}}function kl(e,t,a){return(a=ri(a)).tag=3,a.payload={element:null},a.callback=function(){Nl(e,t)},a}function _l(e){return(e=ri(e)).tag=3,e}function Sl(e,t,a,s){var n=a.type.getDerivedStateFromError;if("function"==typeof n){var i=s.value;e.payload=function(){return n(i)},e.callback=function(){wl(t,a,s)}}var r=a.stateNode;null!==r&&"function"==typeof r.componentDidCatch&&(e.callback=function(){wl(t,a,s),"function"!=typeof n&&(null===So?So=new Set([this]):So.add(this));var e=s.stack;this.componentDidCatch(s.value,{componentStack:null!==e?e:""})})}var Cl=Error(i(461)),Al=!1;function El(e,t,a,s){t.child=null===e?nl(t,null,a,s):sl(t,e.child,a,s)}function Pl(e,t,a,s,n){a=a.render;var i=t.ref;if("ref"in s){var r={};for(var l in s)"ref"!==l&&(r[l]=s[l])}else r=s;return Cn(t),s=Fi(e,t,a,r,i,n),l=Ri(),null===e||Al?(ln&&l&&an(t),t.flags|=1,El(e,t,s,n),t.child):(Wi(e,t,n),Kl(e,t,n))}function Tl(e,t,a,s,n){if(null===e){var i=a.type;return"function"!=typeof i||Ws(i)||void 0!==i.defaultProps||null!==a.compare?((e=Bs(a.type,null,s,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Il(e,t,i,s,n))}if(i=e.child,!Yl(e,n)){var r=i.memoizedProps;if((a=null!==(a=a.compare)?a:Ya)(r,s)&&e.ref===t.ref)return Kl(e,t,n)}return t.flags|=1,(e=Os(i,s)).ref=t.ref,e.return=t,t.child=e}function Il(e,t,a,s,n){if(null!==e){var i=e.memoizedProps;if(Ya(i,s)&&e.ref===t.ref){if(Al=!1,t.pendingProps=s=i,!Yl(e,n))return t.lanes=e.lanes,Kl(e,t,n);131072&e.flags&&(Al=!0)}}return Ml(e,t,a,s,n)}function Fl(e,t,a){var s=t.pendingProps,n=s.children,i=null!==e?e.memoizedState:null;if("hidden"===s.mode){if(128&t.flags){if(s=null!==i?i.baseLanes|a:a,null!==e){for(n=t.child=e.child,i=0;null!==n;)i=i|n.lanes|n.childLanes,n=n.sibling;t.childLanes=i&~s}else t.childLanes=0,t.child=null;return $l(e,t,s,a)}if(!(536870912&a))return t.lanes=t.childLanes=536870912,$l(e,t,null!==i?i.baseLanes|a:a,a);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Hn(0,null!==i?i.cachePool:null),null!==i?gi(t,i):vi(),cl(t)}else null!==i?(Hn(0,i.cachePool),gi(t,i),ol(),t.memoizedState=null):(null!==e&&Hn(0,null),vi(),ol());return El(e,t,n,a),t.child}function $l(e,t,a,s){var n=Xn();return n=null===n?null:{parent:$n._currentValue,pool:n},t.memoizedState={baseLanes:a,cachePool:n},null!==e&&Hn(0,null),vi(),cl(t),null!==e&&_n(e,t,s,!0),null}function Ll(e,t){var a=t.ref;if(null===a)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!=typeof a&&"object"!=typeof a)throw Error(i(284));null!==e&&e.ref===a||(t.flags|=4194816)}}function Ml(e,t,a,s,n){return Cn(t),a=Fi(e,t,a,s,void 0,n),s=Ri(),null===e||Al?(ln&&s&&an(t),t.flags|=1,El(e,t,a,n),t.child):(Wi(e,t,n),Kl(e,t,n))}function Rl(e,t,a,s,n,i){return Cn(t),t.updateQueue=null,a=Li(t,s,a,n),$i(e),s=Ri(),null===e||Al?(ln&&s&&an(t),t.flags|=1,El(e,t,a,i),t.child):(Wi(e,t,i),Kl(e,t,i))}function Wl(e,t,a,s,n){if(Cn(t),null===t.stateNode){var i=Ls,r=a.contextType;"object"==typeof r&&null!==r&&(i=An(r)),i=new a(s,i),t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,i.updater=pl,t.stateNode=i,i._reactInternals=t,(i=t.stateNode).props=s,i.state=t.memoizedState,i.refs={},ni(t),r=a.contextType,i.context="object"==typeof r&&null!==r?An(r):Ls,i.state=t.memoizedState,"function"==typeof(r=a.getDerivedStateFromProps)&&(hl(t,a,r,s),i.state=t.memoizedState),"function"==typeof a.getDerivedStateFromProps||"function"==typeof i.getSnapshotBeforeUpdate||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||(r=i.state,"function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),r!==i.state&&pl.enqueueReplaceState(i,i.state,null),mi(t,s,i,n),ui(),i.state=t.memoizedState),"function"==typeof i.componentDidMount&&(t.flags|=4194308),s=!0}else if(null===e){i=t.stateNode;var l=t.memoizedProps,c=gl(a,l);i.props=c;var o=i.context,d=a.contextType;r=Ls,"object"==typeof d&&null!==d&&(r=An(d));var u=a.getDerivedStateFromProps;d="function"==typeof u||"function"==typeof i.getSnapshotBeforeUpdate,l=t.pendingProps!==l,d||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l||o!==r)&&xl(t,i,s,r),si=!1;var m=t.memoizedState;i.state=m,mi(t,s,i,n),ui(),o=t.memoizedState,l||m!==o||si?("function"==typeof u&&(hl(t,a,u,s),o=t.memoizedState),(c=si||fl(t,a,c,s,m,o,r))?(d||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=o),i.props=s,i.state=o,i.context=r,s=c):("function"==typeof i.componentDidMount&&(t.flags|=4194308),s=!1)}else{i=t.stateNode,ii(e,t),d=gl(a,r=t.memoizedProps),i.props=d,u=t.pendingProps,m=i.context,o=a.contextType,c=Ls,"object"==typeof o&&null!==o&&(c=An(o)),(o="function"==typeof(l=a.getDerivedStateFromProps)||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(r!==u||m!==c)&&xl(t,i,s,c),si=!1,m=t.memoizedState,i.state=m,mi(t,s,i,n),ui();var h=t.memoizedState;r!==u||m!==h||si||null!==e&&null!==e.dependencies&&Sn(e.dependencies)?("function"==typeof l&&(hl(t,a,l,s),h=t.memoizedState),(d=si||fl(t,a,d,s,m,h,c)||null!==e&&null!==e.dependencies&&Sn(e.dependencies))?(o||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(s,h,c),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(s,h,c)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||r===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||r===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=h),i.props=s,i.state=h,i.context=c,s=d):("function"!=typeof i.componentDidUpdate||r===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||r===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),s=!1)}return i=s,Ll(e,t),s=!!(128&t.flags),i||s?(i=t.stateNode,a=s&&"function"!=typeof a.getDerivedStateFromError?null:i.render(),t.flags|=1,null!==e&&s?(t.child=sl(t,e.child,null,n),t.child=sl(t,null,a,n)):El(e,t,a,n),t.memoizedState=i.state,e=t.child):e=Kl(e,t,n),e}function Ol(e,t,a,s){return fn(),t.flags|=256,El(e,t,a,s),t.child}var Dl={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Bl(e){return{baseLanes:e,cachePool:qn()}}function Ul(e,t,a){return e=null!==e?e.childLanes&~a:0,t&&(e|=vo),e}function zl(e,t,a){var s,n=t.pendingProps,r=!1,l=!!(128&t.flags);if((s=l)||(s=(null===e||null!==e.memoizedState)&&!!(2&ul.current)),s&&(r=!0,t.flags&=-129),s=!!(32&t.flags),t.flags&=-33,null===e){if(ln){if(r?ll(t):ol(),ln){var c,o=rn;if(c=o){e:{for(c=o,o=on;8!==c.nodeType;){if(!o){o=null;break e}if(null===(c=yu(c.nextSibling))){o=null;break e}}o=c}null!==o?(t.memoizedState={dehydrated:o,treeContext:null!==Ys?{id:Qs,overflow:Zs}:null,retryLane:536870912,hydrationErrors:null},(c=Rs(18,null,null,0)).stateNode=o,c.return=t,t.child=c,nn=t,rn=null,c=!0):c=!1}c||un(t)}if(null!==(o=t.memoizedState)&&null!==(o=o.dehydrated))return vu(o)?t.lanes=32:t.lanes=536870912,null;dl(t)}return o=n.children,n=n.fallback,r?(ol(),o=Hl({mode:"hidden",children:o},r=t.mode),n=Us(n,r,a,null),o.return=t,n.return=t,o.sibling=n,t.child=o,(r=t.child).memoizedState=Bl(a),r.childLanes=Ul(e,s,a),t.memoizedState=Dl,n):(ll(t),Xl(t,o))}if(null!==(c=e.memoizedState)&&null!==(o=c.dehydrated)){if(l)256&t.flags?(ll(t),t.flags&=-257,t=ql(e,t,a)):null!==t.memoizedState?(ol(),t.child=e.child,t.flags|=128,t=null):(ol(),r=n.fallback,o=t.mode,n=Hl({mode:"visible",children:n.children},o),(r=Us(r,o,a,null)).flags|=2,n.return=t,r.return=t,n.sibling=r,t.child=n,sl(t,e.child,null,a),(n=t.child).memoizedState=Bl(a),n.childLanes=Ul(e,s,a),t.memoizedState=Dl,t=r);else if(ll(t),vu(o)){if(s=o.nextSibling&&o.nextSibling.dataset)var d=s.dgst;s=d,(n=Error(i(419))).stack="",n.digest=s,gn({value:n,source:null,stack:null}),t=ql(e,t,a)}else if(Al||_n(e,t,a,!1),s=0!==(a&e.childLanes),Al||s){if(null!==(s=no)&&(0!==(n=0!==((n=42&(n=a&-a)?1:Pe(n))&(s.suspendedLanes|a))?0:n)&&n!==c.retryLane))throw c.retryLane=n,Is(e,n),Wo(s,e,n),Cl;"$?"===o.data||Go(),t=ql(e,t,a)}else"$?"===o.data?(t.flags|=192,t.child=e.child,t=null):(e=c.treeContext,rn=yu(o.nextSibling),nn=t,ln=!0,cn=null,on=!1,null!==e&&(Gs[Ks++]=Qs,Gs[Ks++]=Zs,Gs[Ks++]=Ys,Qs=e.id,Zs=e.overflow,Ys=t),(t=Xl(t,n.children)).flags|=4096);return t}return r?(ol(),r=n.fallback,o=t.mode,d=(c=e.child).sibling,(n=Os(c,{mode:"hidden",children:n.children})).subtreeFlags=65011712&c.subtreeFlags,null!==d?r=Os(d,r):(r=Us(r,o,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,n=r,r=t.child,null===(o=e.child.memoizedState)?o=Bl(a):(null!==(c=o.cachePool)?(d=$n._currentValue,c=c.parent!==d?{parent:d,pool:d}:c):c=qn(),o={baseLanes:o.baseLanes|a,cachePool:c}),r.memoizedState=o,r.childLanes=Ul(e,s,a),t.memoizedState=Dl,n):(ll(t),e=(a=e.child).sibling,(a=Os(a,{mode:"visible",children:n.children})).return=t,a.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=a,t.memoizedState=null,a)}function Xl(e,t){return(t=Hl({mode:"visible",children:t},e.mode)).return=e,e.child=t}function Hl(e,t){return(e=Rs(22,e,null,t)).lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function ql(e,t,a){return sl(t,e.child,null,a),(e=Xl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Jl(e,t,a){e.lanes|=t;var s=e.alternate;null!==s&&(s.lanes|=t),wn(e.return,t,a)}function Vl(e,t,a,s,n){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:a,tailMode:n}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=a,i.tailMode=n)}function Gl(e,t,a){var s=t.pendingProps,n=s.revealOrder,i=s.tail;if(El(e,t,s.children,a),2&(s=ul.current))s=1&s|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Jl(e,a,t);else if(19===e.tag)Jl(e,a,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(z(ul,s),n){case"forwards":for(a=t.child,n=null;null!==a;)null!==(e=a.alternate)&&null===ml(e)&&(n=a),a=a.sibling;null===(a=n)?(n=t.child,t.child=null):(n=a.sibling,a.sibling=null),Vl(t,!1,n,a,i);break;case"backwards":for(a=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ml(e)){t.child=n;break}e=n.sibling,n.sibling=a,a=n,n=e}Vl(t,!0,a,null,i);break;case"together":Vl(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Kl(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),fo|=t.lanes,0===(a&t.childLanes)){if(null===e)return null;if(_n(e,t,a,!1),0===(a&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(a=Os(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=Os(e,e.pendingProps)).return=t;a.sibling=null}return t.child}function Yl(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!Sn(e))}function Ql(e,t,a){if(null!==e)if(e.memoizedProps!==t.pendingProps)Al=!0;else{if(!(Yl(e,a)||128&t.flags))return Al=!1,function(e,t,a){switch(t.tag){case 3:V(t,t.stateNode.containerInfo),bn(0,$n,e.memoizedState.cache),fn();break;case 27:case 5:K(t);break;case 4:V(t,t.stateNode.containerInfo);break;case 10:bn(0,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(null!==s)return null!==s.dehydrated?(ll(t),t.flags|=128,null):0!==(a&t.child.childLanes)?zl(e,t,a):(ll(t),null!==(e=Kl(e,t,a))?e.sibling:null);ll(t);break;case 19:var n=!!(128&e.flags);if((s=0!==(a&t.childLanes))||(_n(e,t,a,!1),s=0!==(a&t.childLanes)),n){if(s)return Gl(e,t,a);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),z(ul,ul.current),s)break;return null;case 22:case 23:return t.lanes=0,Fl(e,t,a);case 24:bn(0,$n,e.memoizedState.cache)}return Kl(e,t,a)}(e,t,a);Al=!!(131072&e.flags)}else Al=!1,ln&&1048576&t.flags&&tn(t,Vs,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,n=s._init;if(s=n(s._payload),t.type=s,"function"!=typeof s){if(null!=s){if((n=s.$$typeof)===b){t.tag=11,t=Pl(null,t,s,e,a);break e}if(n===k){t.tag=14,t=Tl(null,t,s,e,a);break e}}throw t=$(s)||s,Error(i(306,t,""))}Ws(s)?(e=gl(s,e),t.tag=1,t=Wl(null,t,s,e,a)):(t.tag=0,t=Ml(null,t,s,e,a))}return t;case 0:return Ml(e,t,t.type,t.pendingProps,a);case 1:return Wl(e,t,s=t.type,n=gl(s,t.pendingProps),a);case 3:e:{if(V(t,t.stateNode.containerInfo),null===e)throw Error(i(387));s=t.pendingProps;var r=t.memoizedState;n=r.element,ii(e,t),mi(t,s,null,a);var l=t.memoizedState;if(s=l.cache,bn(0,$n,s),s!==r.cache&&kn(t,[$n],a,!0),ui(),s=l.element,r.isDehydrated){if(r={element:s,isDehydrated:!1,cache:l.cache},t.updateQueue.baseState=r,t.memoizedState=r,256&t.flags){t=Ol(e,t,s,a);break e}if(s!==n){gn(n=_s(Error(i(424)),t)),t=Ol(e,t,s,a);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(rn=yu(e.firstChild),nn=t,ln=!0,cn=null,on=!0,a=nl(t,null,s,a),t.child=a;a;)a.flags=-3&a.flags|4096,a=a.sibling}else{if(fn(),s===n){t=Kl(e,t,a);break e}El(e,t,s,a)}t=t.child}return t;case 26:return Ll(e,t),null===e?(a=Pu(t.type,null,t.pendingProps,null))?t.memoizedState=a:ln||(a=t.type,e=t.pendingProps,(s=iu(q.current).createElement(a))[$e]=t,s[Le]=e,au(s,a,e),Je(s),t.stateNode=s):t.memoizedState=Pu(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return K(t),null===e&&ln&&(s=t.stateNode=Nu(t.type,t.pendingProps,q.current),nn=t,on=!0,n=rn,fu(t.type)?(ju=n,rn=yu(s.firstChild)):rn=n),El(e,t,t.pendingProps.children,a),Ll(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&ln&&((n=s=rn)&&(null!==(s=function(e,t,a,s){for(;1===e.nodeType;){var n=a;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(s){if(!e[Be])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(i=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(i!==n.rel||e.getAttribute("href")!==(null==n.href||""===n.href?null:n.href)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin)||e.getAttribute("title")!==(null==n.title?null:n.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((i=e.getAttribute("src"))!==(null==n.src?null:n.src)||e.getAttribute("type")!==(null==n.type?null:n.type)||e.getAttribute("crossorigin")!==(null==n.crossOrigin?null:n.crossOrigin))&&i&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var i=null==n.name?null:""+n.name;if("hidden"===n.type&&e.getAttribute("name")===i)return e}if(null===(e=yu(e.nextSibling)))break}return null}(s,t.type,t.pendingProps,on))?(t.stateNode=s,nn=t,rn=yu(s.firstChild),on=!1,n=!0):n=!1),n||un(t)),K(t),n=t.type,r=t.pendingProps,l=null!==e?e.memoizedProps:null,s=r.children,cu(n,r)?s=null:null!==l&&cu(n,l)&&(t.flags|=32),null!==t.memoizedState&&(n=Fi(e,t,Mi,null,null,a),Ku._currentValue=n),Ll(e,t),El(e,t,s,a),t.child;case 6:return null===e&&ln&&((e=a=rn)&&(null!==(a=function(e,t,a){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!a)return null;if(null===(e=yu(e.nextSibling)))return null}return e}(a,t.pendingProps,on))?(t.stateNode=a,nn=t,rn=null,e=!0):e=!1),e||un(t)),null;case 13:return zl(e,t,a);case 4:return V(t,t.stateNode.containerInfo),s=t.pendingProps,null===e?t.child=sl(t,null,s,a):El(e,t,s,a),t.child;case 11:return Pl(e,t,t.type,t.pendingProps,a);case 7:return El(e,t,t.pendingProps,a),t.child;case 8:case 12:return El(e,t,t.pendingProps.children,a),t.child;case 10:return s=t.pendingProps,bn(0,t.type,s.value),El(e,t,s.children,a),t.child;case 9:return n=t.type._context,s=t.pendingProps.children,Cn(t),s=s(n=An(n)),t.flags|=1,El(e,t,s,a),t.child;case 14:return Tl(e,t,t.type,t.pendingProps,a);case 15:return Il(e,t,t.type,t.pendingProps,a);case 19:return Gl(e,t,a);case 31:return s=t.pendingProps,a=t.mode,s={mode:s.mode,children:s.children},null===e?((a=Hl(s,a)).ref=t.ref,t.child=a,a.return=t,t=a):((a=Os(e.child,s)).ref=t.ref,t.child=a,a.return=t,t=a),t;case 22:return Fl(e,t,a);case 24:return Cn(t),s=An($n),null===e?(null===(n=Xn())&&(n=no,r=Ln(),n.pooledCache=r,r.refCount++,null!==r&&(n.pooledCacheLanes|=a),n=r),t.memoizedState={parent:s,cache:n},ni(t),bn(0,$n,n)):(0!==(e.lanes&a)&&(ii(e,t),mi(t,null,null,a),ui()),n=e.memoizedState,r=t.memoizedState,n.parent!==s?(n={parent:s,cache:s},t.memoizedState=n,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=n),bn(0,$n,s)):(s=r.cache,bn(0,$n,s),s!==n.cache&&kn(t,[$n],a,!0))),El(e,t,t.pendingProps.children,a),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Zl(e){e.flags|=4}function ec(e,t){if("stylesheet"!==t.type||4&t.state.loading)e.flags&=-16777217;else if(e.flags|=16777216,!zu(t)){if(null!==(t=il.current)&&((4194048&ro)===ro?null!==rl:(62914560&ro)!==ro&&!(536870912&ro)||t!==rl))throw ei=Kn,Vn;e.flags|=8192}}function tc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?_e():536870912,e.lanes|=t,yo|=t)}function ac(e,t){if(!ln)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var s=null;null!==a;)null!==a.alternate&&(s=a),a=a.sibling;null===s?t||null===e.tail?e.tail=null:e.tail.sibling=null:s.sibling=null}}function sc(e){var t=null!==e.alternate&&e.alternate.child===e.child,a=0,s=0;if(t)for(var n=e.child;null!==n;)a|=n.lanes|n.childLanes,s|=65011712&n.subtreeFlags,s|=65011712&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)a|=n.lanes|n.childLanes,s|=n.subtreeFlags,s|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=s,e.childLanes=a,t}function nc(e,t,a){var s=t.pendingProps;switch(sn(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return sc(t),null;case 3:return a=t.stateNode,s=null,null!==e&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Nn($n),G(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(pn(t)?Zl(t):null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,xn())),sc(t),null;case 26:return a=t.memoizedState,null===e?(Zl(t),null!==a?(sc(t),ec(t,a)):(sc(t),t.flags&=-16777217)):a?a!==e.memoizedState?(Zl(t),sc(t),ec(t,a)):(sc(t),t.flags&=-16777217):(e.memoizedProps!==s&&Zl(t),sc(t),t.flags&=-16777217),null;case 27:Y(t),a=q.current;var n=t.type;if(null!==e&&null!=t.stateNode)e.memoizedProps!==s&&Zl(t);else{if(!s){if(null===t.stateNode)throw Error(i(166));return sc(t),null}e=X.current,pn(t)?mn(t):(e=Nu(n,s,a),t.stateNode=e,Zl(t))}return sc(t),null;case 5:if(Y(t),a=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==s&&Zl(t);else{if(!s){if(null===t.stateNode)throw Error(i(166));return sc(t),null}if(e=X.current,pn(t))mn(t);else{switch(n=iu(q.current),e){case 1:e=n.createElementNS("http://www.w3.org/2000/svg",a);break;case 2:e=n.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;default:switch(a){case"svg":e=n.createElementNS("http://www.w3.org/2000/svg",a);break;case"math":e=n.createElementNS("http://www.w3.org/1998/Math/MathML",a);break;case"script":(e=n.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e="string"==typeof s.is?n.createElement("select",{is:s.is}):n.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e="string"==typeof s.is?n.createElement(a,{is:s.is}):n.createElement(a)}}e[$e]=t,e[Le]=s;e:for(n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&27!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break e;for(;null===n.sibling;){if(null===n.return||n.return===t)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}t.stateNode=e;e:switch(au(e,a,s),a){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Zl(t)}}return sc(t),t.flags&=-16777217,null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==s&&Zl(t);else{if("string"!=typeof s&&null===t.stateNode)throw Error(i(166));if(e=q.current,pn(t)){if(e=t.stateNode,a=t.memoizedProps,s=null,null!==(n=nn))switch(n.tag){case 27:case 5:s=n.memoizedProps}e[$e]=t,(e=!!(e.nodeValue===a||null!==s&&!0===s.suppressHydrationWarning||Qd(e.nodeValue,a)))||un(t)}else(e=iu(e).createTextNode(s))[$e]=t,t.stateNode=e}return sc(t),null;case 13:if(s=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(n=pn(t),null!==s&&null!==s.dehydrated){if(null===e){if(!n)throw Error(i(318));if(!(n=null!==(n=t.memoizedState)?n.dehydrated:null))throw Error(i(317));n[$e]=t}else fn(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;sc(t),n=!1}else n=xn(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),n=!0;if(!n)return 256&t.flags?(dl(t),t):(dl(t),null)}if(dl(t),128&t.flags)return t.lanes=a,t;if(a=null!==s,e=null!==e&&null!==e.memoizedState,a){n=null,null!==(s=t.child).alternate&&null!==s.alternate.memoizedState&&null!==s.alternate.memoizedState.cachePool&&(n=s.alternate.memoizedState.cachePool.pool);var r=null;null!==s.memoizedState&&null!==s.memoizedState.cachePool&&(r=s.memoizedState.cachePool.pool),r!==n&&(s.flags|=2048)}return a!==e&&a&&(t.child.flags|=8192),tc(t,t.updateQueue),sc(t),null;case 4:return G(),null===e&&Ud(t.stateNode.containerInfo),sc(t),null;case 10:return Nn(t.type),sc(t),null;case 19:if(U(ul),null===(n=t.memoizedState))return sc(t),null;if(s=!!(128&t.flags),null===(r=n.rendering))if(s)ac(n,!1);else{if(0!==po||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(r=ml(e))){for(t.flags|=128,ac(n,!1),e=r.updateQueue,t.updateQueue=e,tc(t,e),t.subtreeFlags=0,e=a,a=t.child;null!==a;)Ds(a,e),a=a.sibling;return z(ul,1&ul.current|2),t.child}e=e.sibling}null!==n.tail&&se()>ko&&(t.flags|=128,s=!0,ac(n,!1),t.lanes=4194304)}else{if(!s)if(null!==(e=ml(r))){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,tc(t,e),ac(n,!0),null===n.tail&&"hidden"===n.tailMode&&!r.alternate&&!ln)return sc(t),null}else 2*se()-n.renderingStartTime>ko&&536870912!==a&&(t.flags|=128,s=!0,ac(n,!1),t.lanes=4194304);n.isBackwards?(r.sibling=t.child,t.child=r):(null!==(e=n.last)?e.sibling=r:t.child=r,n.last=r)}return null!==n.tail?(t=n.tail,n.rendering=t,n.tail=t.sibling,n.renderingStartTime=se(),t.sibling=null,e=ul.current,z(ul,s?1&e|2:1&e),t):(sc(t),null);case 22:case 23:return dl(t),yi(),s=null!==t.memoizedState,null!==e?null!==e.memoizedState!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?!!(536870912&a)&&!(128&t.flags)&&(sc(t),6&t.subtreeFlags&&(t.flags|=8192)):sc(t),null!==(a=t.updateQueue)&&tc(t,a.retryQueue),a=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),s=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(s=t.memoizedState.cachePool.pool),s!==a&&(t.flags|=2048),null!==e&&U(zn),null;case 24:return a=null,null!==e&&(a=e.memoizedState.cache),t.memoizedState.cache!==a&&(t.flags|=2048),Nn($n),sc(t),null;case 25:case 30:return null}throw Error(i(156,t.tag))}function ic(e,t){switch(sn(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Nn($n),G(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 13:if(dl(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fn()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return U(ul),null;case 4:return G(),null;case 10:return Nn(t.type),null;case 22:case 23:return dl(t),yi(),null!==e&&U(zn),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Nn($n),null;default:return null}}function rc(e,t){switch(sn(t),t.tag){case 3:Nn($n),G();break;case 26:case 27:case 5:Y(t);break;case 4:G();break;case 13:dl(t);break;case 19:U(ul);break;case 10:Nn(t.type);break;case 22:case 23:dl(t),yi(),null!==e&&U(zn);break;case 24:Nn($n)}}function lc(e,t){try{var a=t.updateQueue,s=null!==a?a.lastEffect:null;if(null!==s){var n=s.next;a=n;do{if((a.tag&e)===e){s=void 0;var i=a.create,r=a.inst;s=i(),r.destroy=s}a=a.next}while(a!==n)}}catch(l){md(t,t.return,l)}}function cc(e,t,a){try{var s=t.updateQueue,n=null!==s?s.lastEffect:null;if(null!==n){var i=n.next;s=i;do{if((s.tag&e)===e){var r=s.inst,l=r.destroy;if(void 0!==l){r.destroy=void 0,n=t;var c=a,o=l;try{o()}catch(d){md(n,c,d)}}}s=s.next}while(s!==i)}}catch(d){md(t,t.return,d)}}function oc(e){var t=e.updateQueue;if(null!==t){var a=e.stateNode;try{pi(t,a)}catch(s){md(e,e.return,s)}}}function dc(e,t,a){a.props=gl(e.type,e.memoizedProps),a.state=e.memoizedState;try{a.componentWillUnmount()}catch(s){md(e,t,s)}}function uc(e,t){try{var a=e.ref;if(null!==a){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;default:s=e.stateNode}"function"==typeof a?e.refCleanup=a(s):a.current=s}}catch(n){md(e,t,n)}}function mc(e,t){var a=e.ref,s=e.refCleanup;if(null!==a)if("function"==typeof s)try{s()}catch(n){md(e,t,n)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"==typeof a)try{a(null)}catch(i){md(e,t,i)}else a.current=null}function hc(e){var t=e.type,a=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":a.autoFocus&&s.focus();break e;case"img":a.src?s.src=a.src:a.srcSet&&(s.srcset=a.srcSet)}}catch(n){md(e,e.return,n)}}function pc(e,t,a){try{var s=e.stateNode;!function(e,t,a,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var n=null,r=null,l=null,c=null,o=null,d=null,u=null;for(p in a){var m=a[p];if(a.hasOwnProperty(p)&&null!=m)switch(p){case"checked":case"value":break;case"defaultValue":o=m;default:s.hasOwnProperty(p)||eu(e,t,p,null,s,m)}}for(var h in s){var p=s[h];if(m=a[h],s.hasOwnProperty(h)&&(null!=p||null!=m))switch(h){case"type":r=p;break;case"name":n=p;break;case"checked":d=p;break;case"defaultChecked":u=p;break;case"value":l=p;break;case"defaultValue":c=p;break;case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(i(137,t));break;default:p!==m&&eu(e,t,h,p,s,m)}}return void vt(e,l,c,o,d,u,r,n);case"select":for(r in p=l=c=h=null,a)if(o=a[r],a.hasOwnProperty(r)&&null!=o)switch(r){case"value":break;case"multiple":p=o;default:s.hasOwnProperty(r)||eu(e,t,r,null,s,o)}for(n in s)if(r=s[n],o=a[n],s.hasOwnProperty(n)&&(null!=r||null!=o))switch(n){case"value":h=r;break;case"defaultValue":c=r;break;case"multiple":l=r;default:r!==o&&eu(e,t,n,r,s,o)}return t=c,a=l,s=p,void(null!=h?bt(e,!!a,h,!1):!!s!=!!a&&(null!=t?bt(e,!!a,t,!0):bt(e,!!a,a?[]:"",!1)));case"textarea":for(c in p=h=null,a)if(n=a[c],a.hasOwnProperty(c)&&null!=n&&!s.hasOwnProperty(c))switch(c){case"value":case"children":break;default:eu(e,t,c,null,s,n)}for(l in s)if(n=s[l],r=a[l],s.hasOwnProperty(l)&&(null!=n||null!=r))switch(l){case"value":h=n;break;case"defaultValue":p=n;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=n)throw Error(i(91));break;default:n!==r&&eu(e,t,l,n,s,r)}return void Nt(e,h,p);case"option":for(var f in a)if(h=a[f],a.hasOwnProperty(f)&&null!=h&&!s.hasOwnProperty(f))if("selected"===f)e.selected=!1;else eu(e,t,f,null,s,h);for(o in s)if(h=s[o],p=a[o],s.hasOwnProperty(o)&&h!==p&&(null!=h||null!=p))if("selected"===o)e.selected=h&&"function"!=typeof h&&"symbol"!=typeof h;else eu(e,t,o,h,s,p);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var x in a)h=a[x],a.hasOwnProperty(x)&&null!=h&&!s.hasOwnProperty(x)&&eu(e,t,x,null,s,h);for(d in s)if(h=s[d],p=a[d],s.hasOwnProperty(d)&&h!==p&&(null!=h||null!=p))switch(d){case"children":case"dangerouslySetInnerHTML":if(null!=h)throw Error(i(137,t));break;default:eu(e,t,d,h,s,p)}return;default:if(At(t)){for(var g in a)h=a[g],a.hasOwnProperty(g)&&void 0!==h&&!s.hasOwnProperty(g)&&tu(e,t,g,void 0,s,h);for(u in s)h=s[u],p=a[u],!s.hasOwnProperty(u)||h===p||void 0===h&&void 0===p||tu(e,t,u,h,s,p);return}}for(var v in a)h=a[v],a.hasOwnProperty(v)&&null!=h&&!s.hasOwnProperty(v)&&eu(e,t,v,null,s,h);for(m in s)h=s[m],p=a[m],!s.hasOwnProperty(m)||h===p||null==h&&null==p||eu(e,t,m,h,s,p)}(s,e.type,a,t),s[Le]=t}catch(n){md(e,e.return,n)}}function fc(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&fu(e.type)||4===e.tag}function xc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||fc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&fu(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function gc(e,t,a){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?(9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).insertBefore(e,t):((t=9===a.nodeType?a.body:"HTML"===a.nodeName?a.ownerDocument.body:a).appendChild(e),null!=(a=a._reactRootContainer)||null!==t.onclick||(t.onclick=Zd));else if(4!==s&&(27===s&&fu(e.type)&&(a=e.stateNode,t=null),null!==(e=e.child)))for(gc(e,t,a),e=e.sibling;null!==e;)gc(e,t,a),e=e.sibling}function vc(e,t,a){var s=e.tag;if(5===s||6===s)e=e.stateNode,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==s&&(27===s&&fu(e.type)&&(a=e.stateNode),null!==(e=e.child)))for(vc(e,t,a),e=e.sibling;null!==e;)vc(e,t,a),e=e.sibling}function yc(e){var t=e.stateNode,a=e.memoizedProps;try{for(var s=e.type,n=t.attributes;n.length;)t.removeAttributeNode(n[0]);au(t,s,a),t[$e]=e,t[Le]=a}catch(i){md(e,e.return,i)}}var jc=!1,bc=!1,Nc=!1,wc="function"==typeof WeakSet?WeakSet:Set,kc=null;function _c(e,t,a){var s=a.flags;switch(a.tag){case 0:case 11:case 15:Wc(e,a),4&s&&lc(5,a);break;case 1:if(Wc(e,a),4&s)if(e=a.stateNode,null===t)try{e.componentDidMount()}catch(r){md(a,a.return,r)}else{var n=gl(a.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(n,t,e.__reactInternalSnapshotBeforeUpdate)}catch(l){md(a,a.return,l)}}64&s&&oc(a),512&s&&uc(a,a.return);break;case 3:if(Wc(e,a),64&s&&null!==(e=a.updateQueue)){if(t=null,null!==a.child)switch(a.child.tag){case 27:case 5:case 1:t=a.child.stateNode}try{pi(e,t)}catch(r){md(a,a.return,r)}}break;case 27:null===t&&4&s&&yc(a);case 26:case 5:Wc(e,a),null===t&&4&s&&hc(a),512&s&&uc(a,a.return);break;case 12:Wc(e,a);break;case 13:Wc(e,a),4&s&&Tc(e,a),64&s&&(null!==(e=a.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var a=e.ownerDocument;if("$?"!==e.data||"complete"===a.readyState)t();else{var s=function(){t(),a.removeEventListener("DOMContentLoaded",s)};a.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}(e,a=xd.bind(null,a))));break;case 22:if(!(s=null!==a.memoizedState||jc)){t=null!==t&&null!==t.memoizedState||bc,n=jc;var i=bc;jc=s,(bc=t)&&!i?Dc(e,a,!!(8772&a.subtreeFlags)):Wc(e,a),jc=n,bc=i}break;case 30:break;default:Wc(e,a)}}function Sc(e){var t=e.alternate;null!==t&&(e.alternate=null,Sc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Ue(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Cc=null,Ac=!1;function Ec(e,t,a){for(a=a.child;null!==a;)Pc(e,t,a),a=a.sibling}function Pc(e,t,a){if(he&&"function"==typeof he.onCommitFiberUnmount)try{he.onCommitFiberUnmount(me,a)}catch(i){}switch(a.tag){case 26:bc||mc(a,t),Ec(e,t,a),a.memoizedState?a.memoizedState.count--:a.stateNode&&(a=a.stateNode).parentNode.removeChild(a);break;case 27:bc||mc(a,t);var s=Cc,n=Ac;fu(a.type)&&(Cc=a.stateNode,Ac=!1),Ec(e,t,a),wu(a.stateNode),Cc=s,Ac=n;break;case 5:bc||mc(a,t);case 6:if(s=Cc,n=Ac,Cc=null,Ec(e,t,a),Ac=n,null!==(Cc=s))if(Ac)try{(9===Cc.nodeType?Cc.body:"HTML"===Cc.nodeName?Cc.ownerDocument.body:Cc).removeChild(a.stateNode)}catch(r){md(a,t,r)}else try{Cc.removeChild(a.stateNode)}catch(r){md(a,t,r)}break;case 18:null!==Cc&&(Ac?(xu(9===(e=Cc).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,a.stateNode),Em(e)):xu(Cc,a.stateNode));break;case 4:s=Cc,n=Ac,Cc=a.stateNode.containerInfo,Ac=!0,Ec(e,t,a),Cc=s,Ac=n;break;case 0:case 11:case 14:case 15:bc||cc(2,a,t),bc||cc(4,a,t),Ec(e,t,a);break;case 1:bc||(mc(a,t),"function"==typeof(s=a.stateNode).componentWillUnmount&&dc(a,t,s)),Ec(e,t,a);break;case 21:Ec(e,t,a);break;case 22:bc=(s=bc)||null!==a.memoizedState,Ec(e,t,a),bc=s;break;default:Ec(e,t,a)}}function Tc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Em(e)}catch(a){md(t,t.return,a)}}function Ic(e,t){var a=function(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new wc),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new wc),t;default:throw Error(i(435,e.tag))}}(e);t.forEach(function(t){var s=gd.bind(null,e,t);a.has(t)||(a.add(t),t.then(s,s))})}function Fc(e,t){var a=t.deletions;if(null!==a)for(var s=0;s<a.length;s++){var n=a[s],r=e,l=t,c=l;e:for(;null!==c;){switch(c.tag){case 27:if(fu(c.type)){Cc=c.stateNode,Ac=!1;break e}break;case 5:Cc=c.stateNode,Ac=!1;break e;case 3:case 4:Cc=c.stateNode.containerInfo,Ac=!0;break e}c=c.return}if(null===Cc)throw Error(i(160));Pc(r,l,n),Cc=null,Ac=!1,null!==(r=n.alternate)&&(r.return=null),n.return=null}if(13878&t.subtreeFlags)for(t=t.child;null!==t;)Lc(t,e),t=t.sibling}var $c=null;function Lc(e,t){var a=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Fc(t,e),Mc(e),4&s&&(cc(3,e,e.return),lc(3,e),cc(5,e,e.return));break;case 1:Fc(t,e),Mc(e),512&s&&(bc||null===a||mc(a,a.return)),64&s&&jc&&(null!==(e=e.updateQueue)&&(null!==(s=e.callbacks)&&(a=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===a?s:a.concat(s))));break;case 26:var n=$c;if(Fc(t,e),Mc(e),512&s&&(bc||null===a||mc(a,a.return)),4&s){var r=null!==a?a.memoizedState:null;if(s=e.memoizedState,null===a)if(null===s)if(null===e.stateNode){e:{s=e.type,a=e.memoizedProps,n=n.ownerDocument||n;t:switch(s){case"title":(!(r=n.getElementsByTagName("title")[0])||r[Be]||r[$e]||"http://www.w3.org/2000/svg"===r.namespaceURI||r.hasAttribute("itemprop"))&&(r=n.createElement(s),n.head.insertBefore(r,n.querySelector("head > title"))),au(r,s,a),r[$e]=e,Je(r),s=r;break e;case"link":var l=Bu("link","href",n).get(s+(a.href||""));if(l)for(var c=0;c<l.length;c++)if((r=l[c]).getAttribute("href")===(null==a.href||""===a.href?null:a.href)&&r.getAttribute("rel")===(null==a.rel?null:a.rel)&&r.getAttribute("title")===(null==a.title?null:a.title)&&r.getAttribute("crossorigin")===(null==a.crossOrigin?null:a.crossOrigin)){l.splice(c,1);break t}au(r=n.createElement(s),s,a),n.head.appendChild(r);break;case"meta":if(l=Bu("meta","content",n).get(s+(a.content||"")))for(c=0;c<l.length;c++)if((r=l[c]).getAttribute("content")===(null==a.content?null:""+a.content)&&r.getAttribute("name")===(null==a.name?null:a.name)&&r.getAttribute("property")===(null==a.property?null:a.property)&&r.getAttribute("http-equiv")===(null==a.httpEquiv?null:a.httpEquiv)&&r.getAttribute("charset")===(null==a.charSet?null:a.charSet)){l.splice(c,1);break t}au(r=n.createElement(s),s,a),n.head.appendChild(r);break;default:throw Error(i(468,s))}r[$e]=e,Je(r),s=r}e.stateNode=s}else Uu(n,e.type,e.stateNode);else e.stateNode=Mu(n,s,e.memoizedProps);else r!==s?(null===r?null!==a.stateNode&&(a=a.stateNode).parentNode.removeChild(a):r.count--,null===s?Uu(n,e.type,e.stateNode):Mu(n,s,e.memoizedProps)):null===s&&null!==e.stateNode&&pc(e,e.memoizedProps,a.memoizedProps)}break;case 27:Fc(t,e),Mc(e),512&s&&(bc||null===a||mc(a,a.return)),null!==a&&4&s&&pc(e,e.memoizedProps,a.memoizedProps);break;case 5:if(Fc(t,e),Mc(e),512&s&&(bc||null===a||mc(a,a.return)),32&e.flags){n=e.stateNode;try{kt(n,"")}catch(p){md(e,e.return,p)}}4&s&&null!=e.stateNode&&pc(e,n=e.memoizedProps,null!==a?a.memoizedProps:n),1024&s&&(Nc=!0);break;case 6:if(Fc(t,e),Mc(e),4&s){if(null===e.stateNode)throw Error(i(162));s=e.memoizedProps,a=e.stateNode;try{a.nodeValue=s}catch(p){md(e,e.return,p)}}break;case 3:if(Du=null,n=$c,$c=Su(t.containerInfo),Fc(t,e),$c=n,Mc(e),4&s&&null!==a&&a.memoizedState.isDehydrated)try{Em(t.containerInfo)}catch(p){md(e,e.return,p)}Nc&&(Nc=!1,Rc(e));break;case 4:s=$c,$c=Su(e.stateNode.containerInfo),Fc(t,e),Mc(e),$c=s;break;case 12:default:Fc(t,e),Mc(e);break;case 13:Fc(t,e),Mc(e),8192&e.child.flags&&null!==e.memoizedState!=(null!==a&&null!==a.memoizedState)&&(wo=se()),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,Ic(e,s)));break;case 22:n=null!==e.memoizedState;var o=null!==a&&null!==a.memoizedState,d=jc,u=bc;if(jc=d||n,bc=u||o,Fc(t,e),bc=u,jc=d,Mc(e),8192&s)e:for(t=e.stateNode,t._visibility=n?-2&t._visibility:1|t._visibility,n&&(null===a||o||jc||bc||Oc(e)),a=null,t=e;;){if(5===t.tag||26===t.tag){if(null===a){o=a=t;try{if(r=o.stateNode,n)"function"==typeof(l=r.style).setProperty?l.setProperty("display","none","important"):l.display="none";else{c=o.stateNode;var m=o.memoizedProps.style,h=null!=m&&m.hasOwnProperty("display")?m.display:null;c.style.display=null==h||"boolean"==typeof h?"":(""+h).trim()}}catch(p){md(o,o.return,p)}}}else if(6===t.tag){if(null===a){o=t;try{o.stateNode.nodeValue=n?"":o.memoizedProps}catch(p){md(o,o.return,p)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;a===t&&(a=null),t=t.return}a===t&&(a=null),t.sibling.return=t.return,t=t.sibling}4&s&&(null!==(s=e.updateQueue)&&(null!==(a=s.retryQueue)&&(s.retryQueue=null,Ic(e,a))));break;case 19:Fc(t,e),Mc(e),4&s&&(null!==(s=e.updateQueue)&&(e.updateQueue=null,Ic(e,s)));case 30:case 21:}}function Mc(e){var t=e.flags;if(2&t){try{for(var a,s=e.return;null!==s;){if(fc(s)){a=s;break}s=s.return}if(null==a)throw Error(i(160));switch(a.tag){case 27:var n=a.stateNode;vc(e,xc(e),n);break;case 5:var r=a.stateNode;32&a.flags&&(kt(r,""),a.flags&=-33),vc(e,xc(e),r);break;case 3:case 4:var l=a.stateNode.containerInfo;gc(e,xc(e),l);break;default:throw Error(i(161))}}catch(c){md(e,e.return,c)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Rc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Rc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Wc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)_c(e,t.alternate,t),t=t.sibling}function Oc(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:cc(4,t,t.return),Oc(t);break;case 1:mc(t,t.return);var a=t.stateNode;"function"==typeof a.componentWillUnmount&&dc(t,t.return,a),Oc(t);break;case 27:wu(t.stateNode);case 26:case 5:mc(t,t.return),Oc(t);break;case 22:null===t.memoizedState&&Oc(t);break;default:Oc(t)}e=e.sibling}}function Dc(e,t,a){for(a=a&&!!(8772&t.subtreeFlags),t=t.child;null!==t;){var s=t.alternate,n=e,i=t,r=i.flags;switch(i.tag){case 0:case 11:case 15:Dc(n,i,a),lc(4,i);break;case 1:if(Dc(n,i,a),"function"==typeof(n=(s=i).stateNode).componentDidMount)try{n.componentDidMount()}catch(o){md(s,s.return,o)}if(null!==(n=(s=i).updateQueue)){var l=s.stateNode;try{var c=n.shared.hiddenCallbacks;if(null!==c)for(n.shared.hiddenCallbacks=null,n=0;n<c.length;n++)hi(c[n],l)}catch(o){md(s,s.return,o)}}a&&64&r&&oc(i),uc(i,i.return);break;case 27:yc(i);case 26:case 5:Dc(n,i,a),a&&null===s&&4&r&&hc(i),uc(i,i.return);break;case 12:Dc(n,i,a);break;case 13:Dc(n,i,a),a&&4&r&&Tc(n,i);break;case 22:null===i.memoizedState&&Dc(n,i,a),uc(i,i.return);break;case 30:break;default:Dc(n,i,a)}t=t.sibling}}function Bc(e,t){var a=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(a=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==a&&(null!=e&&e.refCount++,null!=a&&Mn(a))}function Uc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Mn(e))}function zc(e,t,a,s){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Xc(e,t,a,s),t=t.sibling}function Xc(e,t,a,s){var n=t.flags;switch(t.tag){case 0:case 11:case 15:zc(e,t,a,s),2048&n&&lc(9,t);break;case 1:case 13:default:zc(e,t,a,s);break;case 3:zc(e,t,a,s),2048&n&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Mn(e)));break;case 12:if(2048&n){zc(e,t,a,s),e=t.stateNode;try{var i=t.memoizedProps,r=i.id,l=i.onPostCommit;"function"==typeof l&&l(r,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(c){md(t,t.return,c)}}else zc(e,t,a,s);break;case 23:break;case 22:i=t.stateNode,r=t.alternate,null!==t.memoizedState?2&i._visibility?zc(e,t,a,s):qc(e,t):2&i._visibility?zc(e,t,a,s):(i._visibility|=2,Hc(e,t,a,s,!!(10256&t.subtreeFlags))),2048&n&&Bc(r,t);break;case 24:zc(e,t,a,s),2048&n&&Uc(t.alternate,t)}}function Hc(e,t,a,s,n){for(n=n&&!!(10256&t.subtreeFlags),t=t.child;null!==t;){var i=e,r=t,l=a,c=s,o=r.flags;switch(r.tag){case 0:case 11:case 15:Hc(i,r,l,c,n),lc(8,r);break;case 23:break;case 22:var d=r.stateNode;null!==r.memoizedState?2&d._visibility?Hc(i,r,l,c,n):qc(i,r):(d._visibility|=2,Hc(i,r,l,c,n)),n&&2048&o&&Bc(r.alternate,r);break;case 24:Hc(i,r,l,c,n),n&&2048&o&&Uc(r.alternate,r);break;default:Hc(i,r,l,c,n)}t=t.sibling}}function qc(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var a=e,s=t,n=s.flags;switch(s.tag){case 22:qc(a,s),2048&n&&Bc(s.alternate,s);break;case 24:qc(a,s),2048&n&&Uc(s.alternate,s);break;default:qc(a,s)}t=t.sibling}}var Jc=8192;function Vc(e){if(e.subtreeFlags&Jc)for(e=e.child;null!==e;)Gc(e),e=e.sibling}function Gc(e){switch(e.tag){case 26:Vc(e),e.flags&Jc&&null!==e.memoizedState&&function(e,t,a){if(null===Xu)throw Error(i(475));var s=Xu;if(!("stylesheet"!==t.type||"string"==typeof a.media&&!1===matchMedia(a.media).matches||4&t.state.loading)){if(null===t.instance){var n=Tu(a.href),r=e.querySelector(Iu(n));if(r)return null!==(e=r._p)&&"object"==typeof e&&"function"==typeof e.then&&(s.count++,s=qu.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=r,void Je(r);r=e.ownerDocument||e,a=Fu(a),(n=ku.get(n))&&Wu(a,n),Je(r=r.createElement("link"));var l=r;l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),au(r,"link",a),t.instance=r}null===s.stylesheets&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&!(3&t.state.loading)&&(s.count++,t=qu.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}($c,e.memoizedState,e.memoizedProps);break;case 5:default:Vc(e);break;case 3:case 4:var t=$c;$c=Su(e.stateNode.containerInfo),Vc(e),$c=t;break;case 22:null===e.memoizedState&&(null!==(t=e.alternate)&&null!==t.memoizedState?(t=Jc,Jc=16777216,Vc(e),Jc=t):Vc(e))}}function Kc(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function Yc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var a=0;a<t.length;a++){var s=t[a];kc=s,eo(s,e)}Kc(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Qc(e),e=e.sibling}function Qc(e){switch(e.tag){case 0:case 11:case 15:Yc(e),2048&e.flags&&cc(9,e,e.return);break;case 3:case 12:default:Yc(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,Zc(e)):Yc(e)}}function Zc(e){var t=e.deletions;if(16&e.flags){if(null!==t)for(var a=0;a<t.length;a++){var s=t[a];kc=s,eo(s,e)}Kc(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:cc(8,t,t.return),Zc(t);break;case 22:2&(a=t.stateNode)._visibility&&(a._visibility&=-3,Zc(t));break;default:Zc(t)}e=e.sibling}}function eo(e,t){for(;null!==kc;){var a=kc;switch(a.tag){case 0:case 11:case 15:cc(8,a,t);break;case 23:case 22:if(null!==a.memoizedState&&null!==a.memoizedState.cachePool){var s=a.memoizedState.cachePool.pool;null!=s&&s.refCount++}break;case 24:Mn(a.memoizedState.cache)}if(null!==(s=a.child))s.return=a,kc=s;else e:for(a=e;null!==kc;){var n=(s=kc).sibling,i=s.return;if(Sc(s),s===a){kc=null;break e}if(null!==n){n.return=i,kc=n;break e}kc=i}}}var to={getCacheForType:function(e){var t=An($n),a=t.data.get(e);return void 0===a&&(a=e(),t.data.set(e,a)),a}},ao="function"==typeof WeakMap?WeakMap:Map,so=0,no=null,io=null,ro=0,lo=0,co=null,oo=!1,uo=!1,mo=!1,ho=0,po=0,fo=0,xo=0,go=0,vo=0,yo=0,jo=null,bo=null,No=!1,wo=0,ko=1/0,_o=null,So=null,Co=0,Ao=null,Eo=null,Po=0,To=0,Io=null,Fo=null,$o=0,Lo=null;function Mo(){if(2&so&&0!==ro)return ro&-ro;if(null!==M.T){return 0!==On?On:Td()}return Ie()}function Ro(){0===vo&&(vo=536870912&ro&&!ln?536870912:ke());var e=il.current;return null!==e&&(e.flags|=32),vo}function Wo(e,t,a){(e!==no||2!==lo&&9!==lo)&&null===e.cancelPendingCommit||(Ho(e,0),Uo(e,ro,vo,!1)),Ce(e,a),2&so&&e===no||(e===no&&(!(2&so)&&(xo|=a),4===po&&Uo(e,ro,vo,!1)),kd(e))}function Oo(e,t,a){if(6&so)throw Error(i(327));for(var s=!a&&!(124&t)&&0===(t&e.expiredLanes)||Ne(e,t),n=s?function(e,t){var a=so;so|=2;var s=Jo(),n=Vo();no!==e||ro!==t?(_o=null,ko=se()+500,Ho(e,t)):uo=Ne(e,t);e:for(;;)try{if(0!==lo&&null!==io){t=io;var r=co;t:switch(lo){case 1:lo=0,co=null,td(e,t,r,1);break;case 2:case 9:if(Yn(r)){lo=0,co=null,ed(t);break}t=function(){2!==lo&&9!==lo||no!==e||(lo=7),kd(e)},r.then(t,t);break e;case 3:lo=7;break e;case 4:lo=5;break e;case 7:Yn(r)?(lo=0,co=null,ed(t)):(lo=0,co=null,td(e,t,r,7));break;case 5:var l=null;switch(io.tag){case 26:l=io.memoizedState;case 5:case 27:var c=io;if(!l||zu(l)){lo=0,co=null;var o=c.sibling;if(null!==o)io=o;else{var d=c.return;null!==d?(io=d,ad(d)):io=null}break t}}lo=0,co=null,td(e,t,r,5);break;case 6:lo=0,co=null,td(e,t,r,6);break;case 8:Xo(),po=6;break e;default:throw Error(i(462))}}Qo();break}catch(u){qo(e,u)}return jn=yn=null,M.H=s,M.A=n,so=a,null!==io?0:(no=null,ro=0,Es(),po)}(e,t):Ko(e,t,!0),r=s;;){if(0===n){uo&&!s&&Uo(e,t,0,!1);break}if(a=e.current.alternate,!r||Bo(a)){if(2===n){if(r=t,e.errorRecoveryDisabledLanes&r)var l=0;else l=0!==(l=-536870913&e.pendingLanes)?l:536870912&l?536870912:0;if(0!==l){t=l;e:{var c=e;n=jo;var o=c.current.memoizedState.isDehydrated;if(o&&(Ho(c,l).flags|=256),2!==(l=Ko(c,l,!1))){if(mo&&!o){c.errorRecoveryDisabledLanes|=r,xo|=r,n=4;break e}r=bo,bo=n,null!==r&&(null===bo?bo=r:bo.push.apply(bo,r))}n=l}if(r=!1,2!==n)continue}}if(1===n){Ho(e,0),Uo(e,t,0,!0);break}e:{switch(s=e,r=n){case 0:case 1:throw Error(i(345));case 4:if((4194048&t)!==t)break;case 6:Uo(s,t,vo,!oo);break e;case 2:bo=null;break;case 3:case 5:break;default:throw Error(i(329))}if((62914560&t)===t&&10<(n=wo+300-se())){if(Uo(s,t,vo,!oo),0!==be(s,0,!0))break e;s.timeoutHandle=du(Do.bind(null,s,a,bo,_o,No,t,vo,xo,yo,oo,r,2,-0,0),n)}else Do(s,a,bo,_o,No,t,vo,xo,yo,oo,r,0,-0,0)}break}n=Ko(e,t,!1),r=!1}kd(e)}function Do(e,t,a,s,n,r,l,c,o,d,u,m,h,p){if(e.timeoutHandle=-1,(8192&(m=t.subtreeFlags)||!(16785408&~m))&&(Xu={stylesheets:null,count:0,unsuspend:Hu},Gc(t),null!==(m=function(){if(null===Xu)throw Error(i(475));var e=Xu;return e.stylesheets&&0===e.count&&Vu(e,e.stylesheets),0<e.count?function(t){var a=setTimeout(function(){if(e.stylesheets&&Vu(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(a)}}:null}())))return e.cancelPendingCommit=m(nd.bind(null,e,t,r,a,s,n,l,c,o,u,1,h,p)),void Uo(e,r,l,!d);nd(e,t,r,a,s,n,l,c,o)}function Bo(e){for(var t=e;;){var a=t.tag;if((0===a||11===a||15===a)&&16384&t.flags&&(null!==(a=t.updateQueue)&&null!==(a=a.stores)))for(var s=0;s<a.length;s++){var n=a[s],i=n.getSnapshot;n=n.value;try{if(!Ka(i(),n))return!1}catch(r){return!1}}if(a=t.child,16384&t.subtreeFlags&&null!==a)a.return=t,t=a;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Uo(e,t,a,s){t&=~go,t&=~xo,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var n=t;0<n;){var i=31-fe(n),r=1<<i;s[i]=-1,n&=~r}0!==a&&Ae(e,a,t)}function zo(){return!!(6&so)||(_d(0),!1)}function Xo(){if(null!==io){if(0===lo)var e=io.return;else jn=yn=null,Oi(e=io),Kr=null,Yr=0,e=io;for(;null!==e;)rc(e.alternate,e),e=e.return;io=null}}function Ho(e,t){var a=e.timeoutHandle;-1!==a&&(e.timeoutHandle=-1,uu(a)),null!==(a=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,a()),Xo(),no=e,io=a=Os(e.current,null),ro=t,lo=0,co=null,oo=!1,uo=Ne(e,t),mo=!1,yo=vo=go=xo=fo=po=0,bo=jo=null,No=!1,8&t&&(t|=32&t);var s=e.entangledLanes;if(0!==s)for(e=e.entanglements,s&=t;0<s;){var n=31-fe(s),i=1<<n;t|=e[n],s&=~i}return ho=t,Es(),a}function qo(e,t){bi=null,M.H=qr,t===Jn||t===Gn?(t=ti(),lo=3):t===Vn?(t=ti(),lo=4):lo=t===Cl?8:null!==t&&"object"==typeof t&&"function"==typeof t.then?6:1,co=t,null===io&&(po=1,Nl(e,_s(t,e.current)))}function Jo(){var e=M.H;return M.H=qr,null===e?qr:e}function Vo(){var e=M.A;return M.A=to,e}function Go(){po=4,oo||(4194048&ro)!==ro&&null!==il.current||(uo=!0),!(134217727&fo)&&!(134217727&xo)||null===no||Uo(no,ro,vo,!1)}function Ko(e,t,a){var s=so;so|=2;var n=Jo(),i=Vo();no===e&&ro===t||(_o=null,Ho(e,t)),t=!1;var r=po;e:for(;;)try{if(0!==lo&&null!==io){var l=io,c=co;switch(lo){case 8:Xo(),r=6;break e;case 3:case 2:case 9:case 6:null===il.current&&(t=!0);var o=lo;if(lo=0,co=null,td(e,l,c,o),a&&uo){r=0;break e}break;default:o=lo,lo=0,co=null,td(e,l,c,o)}}Yo(),r=po;break}catch(d){qo(e,d)}return t&&e.shellSuspendCounter++,jn=yn=null,so=s,M.H=n,M.A=i,null===io&&(no=null,ro=0,Es()),r}function Yo(){for(;null!==io;)Zo(io)}function Qo(){for(;null!==io&&!te();)Zo(io)}function Zo(e){var t=Ql(e.alternate,e,ho);e.memoizedProps=e.pendingProps,null===t?ad(e):io=t}function ed(e){var t=e,a=t.alternate;switch(t.tag){case 15:case 0:t=Rl(a,t,t.pendingProps,t.type,void 0,ro);break;case 11:t=Rl(a,t,t.pendingProps,t.type.render,t.ref,ro);break;case 5:Oi(t);default:rc(a,t),t=Ql(a,t=io=Ds(t,ho),ho)}e.memoizedProps=e.pendingProps,null===t?ad(e):io=t}function td(e,t,a,s){jn=yn=null,Oi(t),Kr=null,Yr=0;var n=t.return;try{if(function(e,t,a,s,n){if(a.flags|=32768,null!==s&&"object"==typeof s&&"function"==typeof s.then){if(null!==(t=a.alternate)&&_n(t,a,n,!0),null!==(a=il.current)){switch(a.tag){case 13:return null===rl?Go():null===a.alternate&&0===po&&(po=3),a.flags&=-257,a.flags|=65536,a.lanes=n,s===Kn?a.flags|=16384:(null===(t=a.updateQueue)?a.updateQueue=new Set([s]):t.add(s),hd(e,s,n)),!1;case 22:return a.flags|=65536,s===Kn?a.flags|=16384:(null===(t=a.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},a.updateQueue=t):null===(a=t.retryQueue)?t.retryQueue=new Set([s]):a.add(s),hd(e,s,n)),!1}throw Error(i(435,a.tag))}return hd(e,s,n),Go(),!1}if(ln)return null!==(t=il.current)?(!(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=n,s!==dn&&gn(_s(e=Error(i(422),{cause:s}),a))):(s!==dn&&gn(_s(t=Error(i(423),{cause:s}),a)),(e=e.current.alternate).flags|=65536,n&=-n,e.lanes|=n,s=_s(s,a),oi(e,n=kl(e.stateNode,s,n)),4!==po&&(po=2)),!1;var r=Error(i(520),{cause:s});if(r=_s(r,a),null===jo?jo=[r]:jo.push(r),4!==po&&(po=2),null===t)return!0;s=_s(s,a),a=t;do{switch(a.tag){case 3:return a.flags|=65536,e=n&-n,a.lanes|=e,oi(a,e=kl(a.stateNode,s,e)),!1;case 1:if(t=a.type,r=a.stateNode,!(128&a.flags||"function"!=typeof t.getDerivedStateFromError&&(null===r||"function"!=typeof r.componentDidCatch||null!==So&&So.has(r))))return a.flags|=65536,n&=-n,a.lanes|=n,Sl(n=_l(n),e,a,s),oi(a,n),!1}a=a.return}while(null!==a);return!1}(e,n,t,a,ro))return po=1,Nl(e,_s(a,e.current)),void(io=null)}catch(r){if(null!==n)throw io=n,r;return po=1,Nl(e,_s(a,e.current)),void(io=null)}32768&t.flags?(ln||1===s?e=!0:uo||536870912&ro?e=!1:(oo=e=!0,(2===s||9===s||3===s||6===s)&&(null!==(s=il.current)&&13===s.tag&&(s.flags|=16384))),sd(t,e)):ad(t)}function ad(e){var t=e;do{if(32768&t.flags)return void sd(t,oo);e=t.return;var a=nc(t.alternate,t,ho);if(null!==a)return void(io=a);if(null!==(t=t.sibling))return void(io=t);io=t=e}while(null!==t);0===po&&(po=5)}function sd(e,t){do{var a=ic(e.alternate,e);if(null!==a)return a.flags&=32767,void(io=a);if(null!==(a=e.return)&&(a.flags|=32768,a.subtreeFlags=0,a.deletions=null),!t&&null!==(e=e.sibling))return void(io=e);io=e=a}while(null!==e);po=6,io=null}function nd(e,t,a,s,n,r,l,c,o){e.cancelPendingCommit=null;do{od()}while(0!==Co);if(6&so)throw Error(i(327));if(null!==t){if(t===e.current)throw Error(i(177));if(r=t.lanes|t.childLanes,function(e,t,a,s,n,i){var r=e.pendingLanes;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=a,e.entangledLanes&=a,e.errorRecoveryDisabledLanes&=a,e.shellSuspendCounter=0;var l=e.entanglements,c=e.expirationTimes,o=e.hiddenUpdates;for(a=r&~a;0<a;){var d=31-fe(a),u=1<<d;l[d]=0,c[d]=-1;var m=o[d];if(null!==m)for(o[d]=null,d=0;d<m.length;d++){var h=m[d];null!==h&&(h.lane&=-536870913)}a&=~u}0!==s&&Ae(e,s,0),0!==i&&0===n&&0!==e.tag&&(e.suspendedLanes|=i&~(r&~t))}(e,a,r|=As,l,c,o),e===no&&(io=no=null,ro=0),Eo=t,Ao=e,Po=a,To=r,Io=n,Fo=s,10256&t.subtreeFlags||10256&t.flags?(e.callbackNode=null,e.callbackPriority=0,Z(le,function(){return dd(),null})):(e.callbackNode=null,e.callbackPriority=0),s=!!(13878&t.flags),13878&t.subtreeFlags||s){s=M.T,M.T=null,n=R.p,R.p=2,l=so,so|=4;try{!function(e,t){if(e=e.containerInfo,su=nm,as(e=ts(e))){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{var s=(a=(a=e.ownerDocument)&&a.defaultView||window).getSelection&&a.getSelection();if(s&&0!==s.rangeCount){a=s.anchorNode;var n=s.anchorOffset,r=s.focusNode;s=s.focusOffset;try{a.nodeType,r.nodeType}catch(x){a=null;break e}var l=0,c=-1,o=-1,d=0,u=0,m=e,h=null;t:for(;;){for(var p;m!==a||0!==n&&3!==m.nodeType||(c=l+n),m!==r||0!==s&&3!==m.nodeType||(o=l+s),3===m.nodeType&&(l+=m.nodeValue.length),null!==(p=m.firstChild);)h=m,m=p;for(;;){if(m===e)break t;if(h===a&&++d===n&&(c=l),h===r&&++u===s&&(o=l),null!==(p=m.nextSibling))break;h=(m=h).parentNode}m=p}a=-1===c||-1===o?null:{start:c,end:o}}else a=null}a=a||{start:0,end:0}}else a=null;for(nu={focusedElem:e,selectionRange:a},nm=!1,kc=t;null!==kc;)if(e=(t=kc).child,1024&t.subtreeFlags&&null!==e)e.return=t,kc=e;else for(;null!==kc;){switch(r=(t=kc).alternate,e=t.flags,t.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(1024&e&&null!==r){e=void 0,a=t,n=r.memoizedProps,r=r.memoizedState,s=a.stateNode;try{var f=gl(a.type,n,(a.elementType,a.type));e=s.getSnapshotBeforeUpdate(f,r),s.__reactInternalSnapshotBeforeUpdate=e}catch(g){md(a,a.return,g)}}break;case 3:if(1024&e)if(9===(a=(e=t.stateNode.containerInfo).nodeType))gu(e);else if(1===a)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":gu(e);break;default:e.textContent=""}break;default:if(1024&e)throw Error(i(163))}if(null!==(e=t.sibling)){e.return=t.return,kc=e;break}kc=t.return}}(e,t)}finally{so=l,R.p=n,M.T=s}}Co=1,id(),rd(),ld()}}function id(){if(1===Co){Co=0;var e=Ao,t=Eo,a=!!(13878&t.flags);if(13878&t.subtreeFlags||a){a=M.T,M.T=null;var s=R.p;R.p=2;var n=so;so|=4;try{Lc(t,e);var i=nu,r=ts(e.containerInfo),l=i.focusedElem,c=i.selectionRange;if(r!==l&&l&&l.ownerDocument&&es(l.ownerDocument.documentElement,l)){if(null!==c&&as(l)){var o=c.start,d=c.end;if(void 0===d&&(d=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(d,l.value.length);else{var u=l.ownerDocument||document,m=u&&u.defaultView||window;if(m.getSelection){var h=m.getSelection(),p=l.textContent.length,f=Math.min(c.start,p),x=void 0===c.end?f:Math.min(c.end,p);!h.extend&&f>x&&(r=x,x=f,f=r);var g=Za(l,f),v=Za(l,x);if(g&&v&&(1!==h.rangeCount||h.anchorNode!==g.node||h.anchorOffset!==g.offset||h.focusNode!==v.node||h.focusOffset!==v.offset)){var y=u.createRange();y.setStart(g.node,g.offset),h.removeAllRanges(),f>x?(h.addRange(y),h.extend(v.node,v.offset)):(y.setEnd(v.node,v.offset),h.addRange(y))}}}}for(u=[],h=l;h=h.parentNode;)1===h.nodeType&&u.push({element:h,left:h.scrollLeft,top:h.scrollTop});for("function"==typeof l.focus&&l.focus(),l=0;l<u.length;l++){var j=u[l];j.element.scrollLeft=j.left,j.element.scrollTop=j.top}}nm=!!su,nu=su=null}finally{so=n,R.p=s,M.T=a}}e.current=t,Co=2}}function rd(){if(2===Co){Co=0;var e=Ao,t=Eo,a=!!(8772&t.flags);if(8772&t.subtreeFlags||a){a=M.T,M.T=null;var s=R.p;R.p=2;var n=so;so|=4;try{_c(e,t.alternate,t)}finally{so=n,R.p=s,M.T=a}}Co=3}}function ld(){if(4===Co||3===Co){Co=0,ae();var e=Ao,t=Eo,a=Po,s=Fo;10256&t.subtreeFlags||10256&t.flags?Co=5:(Co=0,Eo=Ao=null,cd(e,e.pendingLanes));var n=e.pendingLanes;if(0===n&&(So=null),Te(a),t=t.stateNode,he&&"function"==typeof he.onCommitFiberRoot)try{he.onCommitFiberRoot(me,t,void 0,!(128&~t.current.flags))}catch(c){}if(null!==s){t=M.T,n=R.p,R.p=2,M.T=null;try{for(var i=e.onRecoverableError,r=0;r<s.length;r++){var l=s[r];i(l.value,{componentStack:l.stack})}}finally{M.T=t,R.p=n}}3&Po&&od(),kd(e),n=e.pendingLanes,4194090&a&&42&n?e===Lo?$o++:($o=0,Lo=e):$o=0,_d(0)}}function cd(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Mn(t)))}function od(e){return id(),rd(),ld(),dd()}function dd(){if(5!==Co)return!1;var e=Ao,t=To;To=0;var a=Te(Po),s=M.T,n=R.p;try{R.p=32>a?32:a,M.T=null,a=Io,Io=null;var r=Ao,l=Po;if(Co=0,Eo=Ao=null,Po=0,6&so)throw Error(i(331));var c=so;if(so|=4,Qc(r.current),Xc(r,r.current,l,a),so=c,_d(0,!1),he&&"function"==typeof he.onPostCommitFiberRoot)try{he.onPostCommitFiberRoot(me,r)}catch(o){}return!0}finally{R.p=n,M.T=s,cd(e,t)}}function ud(e,t,a){t=_s(a,t),null!==(e=li(e,t=kl(e.stateNode,t,2),2))&&(Ce(e,2),kd(e))}function md(e,t,a){if(3===e.tag)ud(e,e,a);else for(;null!==t;){if(3===t.tag){ud(t,e,a);break}if(1===t.tag){var s=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof s.componentDidCatch&&(null===So||!So.has(s))){e=_s(a,e),null!==(s=li(t,a=_l(2),2))&&(Sl(a,s,t,e),Ce(s,2),kd(s));break}}t=t.return}}function hd(e,t,a){var s=e.pingCache;if(null===s){s=e.pingCache=new ao;var n=new Set;s.set(t,n)}else void 0===(n=s.get(t))&&(n=new Set,s.set(t,n));n.has(a)||(mo=!0,n.add(a),e=pd.bind(null,e,t,a),t.then(e,e))}function pd(e,t,a){var s=e.pingCache;null!==s&&s.delete(t),e.pingedLanes|=e.suspendedLanes&a,e.warmLanes&=~a,no===e&&(ro&a)===a&&(4===po||3===po&&(62914560&ro)===ro&&300>se()-wo?!(2&so)&&Ho(e,0):go|=a,yo===ro&&(yo=0)),kd(e)}function fd(e,t){0===t&&(t=_e()),null!==(e=Is(e,t))&&(Ce(e,t),kd(e))}function xd(e){var t=e.memoizedState,a=0;null!==t&&(a=t.retryLane),fd(e,a)}function gd(e,t){var a=0;switch(e.tag){case 13:var s=e.stateNode,n=e.memoizedState;null!==n&&(a=n.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(i(314))}null!==s&&s.delete(t),fd(e,a)}var vd=null,yd=null,jd=!1,bd=!1,Nd=!1,wd=0;function kd(e){e!==yd&&null===e.next&&(null===yd?vd=yd=e:yd=yd.next=e),bd=!0,jd||(jd=!0,hu(function(){6&so?Z(ie,Sd):Cd()}))}function _d(e,t){if(!Nd&&bd){Nd=!0;do{for(var a=!1,s=vd;null!==s;){if(0!==e){var n=s.pendingLanes;if(0===n)var i=0;else{var r=s.suspendedLanes,l=s.pingedLanes;i=(1<<31-fe(42|e)+1)-1,i=201326741&(i&=n&~(r&~l))?201326741&i|1:i?2|i:0}0!==i&&(a=!0,Pd(s,i))}else i=ro,!(3&(i=be(s,s===no?i:0,null!==s.cancelPendingCommit||-1!==s.timeoutHandle)))||Ne(s,i)||(a=!0,Pd(s,i));s=s.next}}while(a);Nd=!1}}function Sd(){Cd()}function Cd(){bd=jd=!1;var e=0;0!==wd&&(function(){var e=window.event;if(e&&"popstate"===e.type)return e!==ou&&(ou=e,!0);return ou=null,!1}()&&(e=wd),wd=0);for(var t=se(),a=null,s=vd;null!==s;){var n=s.next,i=Ad(s,t);0===i?(s.next=null,null===a?vd=n:a.next=n,null===n&&(yd=a)):(a=s,(0!==e||3&i)&&(bd=!0)),s=n}_d(e)}function Ad(e,t){for(var a=e.suspendedLanes,s=e.pingedLanes,n=e.expirationTimes,i=-62914561&e.pendingLanes;0<i;){var r=31-fe(i),l=1<<r,c=n[r];-1===c?0!==(l&a)&&0===(l&s)||(n[r]=we(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}if(a=ro,a=be(e,e===(t=no)?a:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),s=e.callbackNode,0===a||e===t&&(2===lo||9===lo)||null!==e.cancelPendingCommit)return null!==s&&null!==s&&ee(s),e.callbackNode=null,e.callbackPriority=0;if(!(3&a)||Ne(e,a)){if((t=a&-a)===e.callbackPriority)return t;switch(null!==s&&ee(s),Te(a)){case 2:case 8:a=re;break;case 32:default:a=le;break;case 268435456:a=oe}return s=Ed.bind(null,e),a=Z(a,s),e.callbackPriority=t,e.callbackNode=a,t}return null!==s&&null!==s&&ee(s),e.callbackPriority=2,e.callbackNode=null,2}function Ed(e,t){if(0!==Co&&5!==Co)return e.callbackNode=null,e.callbackPriority=0,null;var a=e.callbackNode;if(od()&&e.callbackNode!==a)return null;var s=ro;return 0===(s=be(e,e===no?s:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:(Oo(e,s,t),Ad(e,se()),null!=e.callbackNode&&e.callbackNode===a?Ed.bind(null,e):null)}function Pd(e,t){if(od())return null;Oo(e,t,!0)}function Td(){return 0===wd&&(wd=ke()),wd}function Id(e){return null==e||"symbol"==typeof e||"boolean"==typeof e?null:"function"==typeof e?e:Tt(""+e)}function Fd(e,t){var a=t.ownerDocument.createElement("input");return a.name=t.name,a.value=t.value,e.id&&a.setAttribute("form",e.id),t.parentNode.insertBefore(a,t),e=new FormData(e),a.parentNode.removeChild(a),e}for(var $d=0;$d<Ns.length;$d++){var Ld=Ns[$d];ws(Ld.toLowerCase(),"on"+(Ld[0].toUpperCase()+Ld.slice(1)))}ws(ps,"onAnimationEnd"),ws(fs,"onAnimationIteration"),ws(xs,"onAnimationStart"),ws("dblclick","onDoubleClick"),ws("focusin","onFocus"),ws("focusout","onBlur"),ws(gs,"onTransitionRun"),ws(vs,"onTransitionStart"),ws(ys,"onTransitionCancel"),ws(js,"onTransitionEnd"),Ye("onMouseEnter",["mouseout","mouseover"]),Ye("onMouseLeave",["mouseout","mouseover"]),Ye("onPointerEnter",["pointerout","pointerover"]),Ye("onPointerLeave",["pointerout","pointerover"]),Ke("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ke("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ke("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ke("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ke("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Md="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rd=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Md));function Wd(e,t){t=!!(4&t);for(var a=0;a<e.length;a++){var s=e[a],n=s.event;s=s.listeners;e:{var i=void 0;if(t)for(var r=s.length-1;0<=r;r--){var l=s[r],c=l.instance,o=l.currentTarget;if(l=l.listener,c!==i&&n.isPropagationStopped())break e;i=l,n.currentTarget=o;try{i(n)}catch(d){vl(d)}n.currentTarget=null,i=c}else for(r=0;r<s.length;r++){if(c=(l=s[r]).instance,o=l.currentTarget,l=l.listener,c!==i&&n.isPropagationStopped())break e;i=l,n.currentTarget=o;try{i(n)}catch(d){vl(d)}n.currentTarget=null,i=c}}}}function Od(e,t){var a=t[Re];void 0===a&&(a=t[Re]=new Set);var s=e+"__bubble";a.has(s)||(zd(t,e,2,!1),a.add(s))}function Dd(e,t,a){var s=0;t&&(s|=4),zd(a,e,s,t)}var Bd="_reactListening"+Math.random().toString(36).slice(2);function Ud(e){if(!e[Bd]){e[Bd]=!0,Ve.forEach(function(t){"selectionchange"!==t&&(Rd.has(t)||Dd(t,!1,e),Dd(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Bd]||(t[Bd]=!0,Dd("selectionchange",!1,t))}}function zd(e,t,a,s){switch(um(t)){case 2:var n=im;break;case 8:n=rm;break;default:n=lm}a=n.bind(null,t,a,e),n=void 0,!Bt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),s?void 0!==n?e.addEventListener(t,a,{capture:!0,passive:n}):e.addEventListener(t,a,!0):void 0!==n?e.addEventListener(t,a,{passive:n}):e.addEventListener(t,a,!1)}function Xd(e,t,a,s,n){var i=s;if(!(1&t||2&t||null===s))e:for(;;){if(null===s)return;var r=s.tag;if(3===r||4===r){var c=s.stateNode.containerInfo;if(c===n)break;if(4===r)for(r=s.return;null!==r;){var o=r.tag;if((3===o||4===o)&&r.stateNode.containerInfo===n)return;r=r.return}for(;null!==c;){if(null===(r=ze(c)))return;if(5===(o=r.tag)||6===o||26===o||27===o){s=i=r;continue e}c=c.parentNode}}s=s.return}Wt(function(){var s=i,n=Ft(a),r=[];e:{var c=bs.get(e);if(void 0!==c){var o=ta,d=e;switch(e){case"keypress":if(0===Jt(a))break e;case"keydown":case"keyup":o=xa;break;case"focusin":d="focus",o=la;break;case"focusout":d="blur",o=la;break;case"beforeblur":case"afterblur":o=la;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=ia;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=ra;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=va;break;case ps:case fs:case xs:o=ca;break;case js:o=ya;break;case"scroll":case"scrollend":o=sa;break;case"wheel":o=ja;break;case"copy":case"cut":case"paste":o=oa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=ga;break;case"toggle":case"beforetoggle":o=ba}var u=!!(4&t),m=!u&&("scroll"===e||"scrollend"===e),h=u?null!==c?c+"Capture":null:c;u=[];for(var p,f=s;null!==f;){var x=f;if(p=x.stateNode,5!==(x=x.tag)&&26!==x&&27!==x||null===p||null===h||null!=(x=Ot(f,h))&&u.push(Hd(f,x,p)),m)break;f=f.return}0<u.length&&(c=new o(c,d,null,a,n),r.push({event:c,listeners:u}))}}if(!(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(c="mouseover"===e||"pointerover"===e)||a===It||!(d=a.relatedTarget||a.fromElement)||!ze(d)&&!d[Me])&&(o||c)&&(c=n.window===n?n:(c=n.ownerDocument)?c.defaultView||c.parentWindow:window,o?(o=s,null!==(d=(d=a.relatedTarget||a.toElement)?ze(d):null)&&(m=l(d),u=d.tag,d!==m||5!==u&&27!==u&&6!==u)&&(d=null)):(o=null,d=s),o!==d)){if(u=ia,x="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(u=ga,x="onPointerLeave",h="onPointerEnter",f="pointer"),m=null==o?c:He(o),p=null==d?c:He(d),(c=new u(x,f+"leave",o,a,n)).target=m,c.relatedTarget=p,x=null,ze(n)===s&&((u=new u(h,f+"enter",d,a,n)).target=p,u.relatedTarget=m,x=u),m=x,o&&d)e:{for(h=d,f=0,p=u=o;p;p=Jd(p))f++;for(p=0,x=h;x;x=Jd(x))p++;for(;0<f-p;)u=Jd(u),f--;for(;0<p-f;)h=Jd(h),p--;for(;f--;){if(u===h||null!==h&&u===h.alternate)break e;u=Jd(u),h=Jd(h)}u=null}else u=null;null!==o&&Vd(r,c,o,u,!1),null!==d&&null!==m&&Vd(r,m,d,u,!0)}if("select"===(o=(c=s?He(s):window).nodeName&&c.nodeName.toLowerCase())||"input"===o&&"file"===c.type)var g=Oa;else if(Fa(c))if(Da)g=Ga;else{g=Ja;var v=qa}else!(o=c.nodeName)||"input"!==o.toLowerCase()||"checkbox"!==c.type&&"radio"!==c.type?s&&At(s.elementType)&&(g=Oa):g=Va;switch(g&&(g=g(e,s))?$a(r,g,a,n):(v&&v(e,c,s),"focusout"===e&&s&&"number"===c.type&&null!=s.memoizedProps.value&&jt(c,"number",c.value)),v=s?He(s):window,e){case"focusin":(Fa(v)||"true"===v.contentEditable)&&(ns=v,is=s,rs=null);break;case"focusout":rs=is=ns=null;break;case"mousedown":ls=!0;break;case"contextmenu":case"mouseup":case"dragend":ls=!1,cs(r,a,n);break;case"selectionchange":if(ss)break;case"keydown":case"keyup":cs(r,a,n)}var y;if(wa)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Ta?Ea(e,a)&&(j="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(j="onCompositionStart");j&&(Sa&&"ko"!==a.locale&&(Ta||"onCompositionStart"!==j?"onCompositionEnd"===j&&Ta&&(y=qt()):(Xt="value"in(zt=n)?zt.value:zt.textContent,Ta=!0)),0<(v=qd(s,j)).length&&(j=new da(j,e,null,a,n),r.push({event:j,listeners:v}),y?j.data=y:null!==(y=Pa(a))&&(j.data=y))),(y=_a?function(e,t){switch(e){case"compositionend":return Pa(t);case"keypress":return 32!==t.which?null:(Aa=!0,Ca);case"textInput":return(e=t.data)===Ca&&Aa?null:e;default:return null}}(e,a):function(e,t){if(Ta)return"compositionend"===e||!wa&&Ea(e,t)?(e=qt(),Ht=Xt=zt=null,Ta=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Sa&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(j=qd(s,"onBeforeInput")).length&&(v=new da("onBeforeInput","beforeinput",null,a,n),r.push({event:v,listeners:j}),v.data=y)),function(e,t,a,s,n){if("submit"===t&&a&&a.stateNode===n){var i=Id((n[Le]||null).action),r=s.submitter;r&&null!==(t=(t=r[Le]||null)?Id(t.formAction):r.getAttribute("formAction"))&&(i=t,r=null);var l=new ta("action","action",null,s,n);e.push({event:l,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(0!==wd){var e=r?Fd(n,r):new FormData(n);Ir(a,{pending:!0,data:e,method:n.method,action:i},null,e)}}else"function"==typeof i&&(l.preventDefault(),e=r?Fd(n,r):new FormData(n),Ir(a,{pending:!0,data:e,method:n.method,action:i},i,e))},currentTarget:n}]})}}(r,e,s,a,n)}Wd(r,t)})}function Hd(e,t,a){return{instance:e,listener:t,currentTarget:a}}function qd(e,t){for(var a=t+"Capture",s=[];null!==e;){var n=e,i=n.stateNode;if(5!==(n=n.tag)&&26!==n&&27!==n||null===i||(null!=(n=Ot(e,a))&&s.unshift(Hd(e,n,i)),null!=(n=Ot(e,t))&&s.push(Hd(e,n,i))),3===e.tag)return s;e=e.return}return[]}function Jd(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function Vd(e,t,a,s,n){for(var i=t._reactName,r=[];null!==a&&a!==s;){var l=a,c=l.alternate,o=l.stateNode;if(l=l.tag,null!==c&&c===s)break;5!==l&&26!==l&&27!==l||null===o||(c=o,n?null!=(o=Ot(a,i))&&r.unshift(Hd(a,o,c)):n||null!=(o=Ot(a,i))&&r.push(Hd(a,o,c))),a=a.return}0!==r.length&&e.push({event:t,listeners:r})}var Gd=/\r\n?/g,Kd=/\u0000|\uFFFD/g;function Yd(e){return("string"==typeof e?e:""+e).replace(Gd,"\n").replace(Kd,"")}function Qd(e,t){return t=Yd(t),Yd(e)===t}function Zd(){}function eu(e,t,a,s,n,r){switch(a){case"children":"string"==typeof s?"body"===t||"textarea"===t&&""===s||kt(e,s):("number"==typeof s||"bigint"==typeof s)&&"body"!==t&&kt(e,""+s);break;case"className":nt(e,"class",s);break;case"tabIndex":nt(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":nt(e,a,s);break;case"style":Ct(e,s,r);break;case"data":if("object"!==t){nt(e,"data",s);break}case"src":case"href":if(""===s&&("a"!==t||"href"!==a)){e.removeAttribute(a);break}if(null==s||"function"==typeof s||"symbol"==typeof s||"boolean"==typeof s){e.removeAttribute(a);break}s=Tt(""+s),e.setAttribute(a,s);break;case"action":case"formAction":if("function"==typeof s){e.setAttribute(a,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"==typeof r&&("formAction"===a?("input"!==t&&eu(e,t,"name",n.name,n,null),eu(e,t,"formEncType",n.formEncType,n,null),eu(e,t,"formMethod",n.formMethod,n,null),eu(e,t,"formTarget",n.formTarget,n,null)):(eu(e,t,"encType",n.encType,n,null),eu(e,t,"method",n.method,n,null),eu(e,t,"target",n.target,n,null))),null==s||"symbol"==typeof s||"boolean"==typeof s){e.removeAttribute(a);break}s=Tt(""+s),e.setAttribute(a,s);break;case"onClick":null!=s&&(e.onclick=Zd);break;case"onScroll":null!=s&&Od("scroll",e);break;case"onScrollEnd":null!=s&&Od("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!=typeof s||!("__html"in s))throw Error(i(61));if(null!=(a=s.__html)){if(null!=n.children)throw Error(i(60));e.innerHTML=a}}break;case"multiple":e.multiple=s&&"function"!=typeof s&&"symbol"!=typeof s;break;case"muted":e.muted=s&&"function"!=typeof s&&"symbol"!=typeof s;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==s||"function"==typeof s||"boolean"==typeof s||"symbol"==typeof s){e.removeAttribute("xlink:href");break}a=Tt(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(a,""+s):e.removeAttribute(a);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(a,""):e.removeAttribute(a);break;case"capture":case"download":!0===s?e.setAttribute(a,""):!1!==s&&null!=s&&"function"!=typeof s&&"symbol"!=typeof s?e.setAttribute(a,s):e.removeAttribute(a);break;case"cols":case"rows":case"size":case"span":null!=s&&"function"!=typeof s&&"symbol"!=typeof s&&!isNaN(s)&&1<=s?e.setAttribute(a,s):e.removeAttribute(a);break;case"rowSpan":case"start":null==s||"function"==typeof s||"symbol"==typeof s||isNaN(s)?e.removeAttribute(a):e.setAttribute(a,s);break;case"popover":Od("beforetoggle",e),Od("toggle",e),st(e,"popover",s);break;case"xlinkActuate":it(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":it(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":it(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":it(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":it(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":it(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":it(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":it(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":it(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":st(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<a.length)||"o"!==a[0]&&"O"!==a[0]||"n"!==a[1]&&"N"!==a[1])&&st(e,a=Et.get(a)||a,s)}}function tu(e,t,a,s,n,r){switch(a){case"style":Ct(e,s,r);break;case"dangerouslySetInnerHTML":if(null!=s){if("object"!=typeof s||!("__html"in s))throw Error(i(61));if(null!=(a=s.__html)){if(null!=n.children)throw Error(i(60));e.innerHTML=a}}break;case"children":"string"==typeof s?kt(e,s):("number"==typeof s||"bigint"==typeof s)&&kt(e,""+s);break;case"onScroll":null!=s&&Od("scroll",e);break;case"onScrollEnd":null!=s&&Od("scrollend",e);break;case"onClick":null!=s&&(e.onclick=Zd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Ge.hasOwnProperty(a)||("o"!==a[0]||"n"!==a[1]||(n=a.endsWith("Capture"),t=a.slice(2,n?a.length-7:void 0),"function"==typeof(r=null!=(r=e[Le]||null)?r[a]:null)&&e.removeEventListener(t,r,n),"function"!=typeof s)?a in e?e[a]=s:!0===s?e.setAttribute(a,""):st(e,a,s):("function"!=typeof r&&null!==r&&(a in e?e[a]=null:e.hasAttribute(a)&&e.removeAttribute(a)),e.addEventListener(t,s,n)))}}function au(e,t,a){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Od("error",e),Od("load",e);var s,n=!1,r=!1;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];if(null!=l)switch(s){case"src":n=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:eu(e,t,s,l,a,null)}}return r&&eu(e,t,"srcSet",a.srcSet,a,null),void(n&&eu(e,t,"src",a.src,a,null));case"input":Od("invalid",e);var c=s=l=r=null,o=null,d=null;for(n in a)if(a.hasOwnProperty(n)){var u=a[n];if(null!=u)switch(n){case"name":r=u;break;case"type":l=u;break;case"checked":o=u;break;case"defaultChecked":d=u;break;case"value":s=u;break;case"defaultValue":c=u;break;case"children":case"dangerouslySetInnerHTML":if(null!=u)throw Error(i(137,t));break;default:eu(e,t,n,u,a,null)}}return yt(e,s,c,o,d,l,r,!1),void ht(e);case"select":for(r in Od("invalid",e),n=l=s=null,a)if(a.hasOwnProperty(r)&&null!=(c=a[r]))switch(r){case"value":s=c;break;case"defaultValue":l=c;break;case"multiple":n=c;default:eu(e,t,r,c,a,null)}return t=s,a=l,e.multiple=!!n,void(null!=t?bt(e,!!n,t,!1):null!=a&&bt(e,!!n,a,!0));case"textarea":for(l in Od("invalid",e),s=r=n=null,a)if(a.hasOwnProperty(l)&&null!=(c=a[l]))switch(l){case"value":n=c;break;case"defaultValue":r=c;break;case"children":s=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(i(91));break;default:eu(e,t,l,c,a,null)}return wt(e,n,r,s),void ht(e);case"option":for(o in a)if(a.hasOwnProperty(o)&&null!=(n=a[o]))if("selected"===o)e.selected=n&&"function"!=typeof n&&"symbol"!=typeof n;else eu(e,t,o,n,a,null);return;case"dialog":Od("beforetoggle",e),Od("toggle",e),Od("cancel",e),Od("close",e);break;case"iframe":case"object":Od("load",e);break;case"video":case"audio":for(n=0;n<Md.length;n++)Od(Md[n],e);break;case"image":Od("error",e),Od("load",e);break;case"details":Od("toggle",e);break;case"embed":case"source":case"link":Od("error",e),Od("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(d in a)if(a.hasOwnProperty(d)&&null!=(n=a[d]))switch(d){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,t));default:eu(e,t,d,n,a,null)}return;default:if(At(t)){for(u in a)a.hasOwnProperty(u)&&(void 0!==(n=a[u])&&tu(e,t,u,n,a,void 0));return}}for(c in a)a.hasOwnProperty(c)&&(null!=(n=a[c])&&eu(e,t,c,n,a,null))}var su=null,nu=null;function iu(e){return 9===e.nodeType?e:e.ownerDocument}function ru(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lu(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function cu(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"bigint"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ou=null;var du="function"==typeof setTimeout?setTimeout:void 0,uu="function"==typeof clearTimeout?clearTimeout:void 0,mu="function"==typeof Promise?Promise:void 0,hu="function"==typeof queueMicrotask?queueMicrotask:void 0!==mu?function(e){return mu.resolve(null).then(e).catch(pu)}:du;function pu(e){setTimeout(function(){throw e})}function fu(e){return"head"===e}function xu(e,t){var a=t,s=0,n=0;do{var i=a.nextSibling;if(e.removeChild(a),i&&8===i.nodeType)if("/$"===(a=i.data)){if(0<s&&8>s){a=s;var r=e.ownerDocument;if(1&a&&wu(r.documentElement),2&a&&wu(r.body),4&a)for(wu(a=r.head),r=a.firstChild;r;){var l=r.nextSibling,c=r.nodeName;r[Be]||"SCRIPT"===c||"STYLE"===c||"LINK"===c&&"stylesheet"===r.rel.toLowerCase()||a.removeChild(r),r=l}}if(0===n)return e.removeChild(i),void Em(t);n--}else"$"===a||"$?"===a||"$!"===a?n++:s=a.charCodeAt(0)-48;else s=0;a=i}while(a);Em(t)}function gu(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var a=t;switch(t=t.nextSibling,a.nodeName){case"HTML":case"HEAD":case"BODY":gu(a),Ue(a);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===a.rel.toLowerCase())continue}e.removeChild(a)}}function vu(e){return"$!"===e.data||"$?"===e.data&&"complete"===e.ownerDocument.readyState}function yu(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"F!"===t||"F"===t)break;if("/$"===t)return null}}return e}var ju=null;function bu(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a){if(0===t)return e;t--}else"/$"===a&&t++}e=e.previousSibling}return null}function Nu(e,t,a){switch(t=iu(a),e){case"html":if(!(e=t.documentElement))throw Error(i(452));return e;case"head":if(!(e=t.head))throw Error(i(453));return e;case"body":if(!(e=t.body))throw Error(i(454));return e;default:throw Error(i(451))}}function wu(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Ue(e)}var ku=new Map,_u=new Set;function Su(e){return"function"==typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Cu=R.d;R.d={f:function(){var e=Cu.f(),t=zo();return e||t},r:function(e){var t=Xe(e);null!==t&&5===t.tag&&"form"===t.type?$r(t):Cu.r(e)},D:function(e){Cu.D(e),Eu("dns-prefetch",e,null)},C:function(e,t){Cu.C(e,t),Eu("preconnect",e,t)},L:function(e,t,a){Cu.L(e,t,a);var s=Au;if(s&&e&&t){var n='link[rel="preload"][as="'+gt(t)+'"]';"image"===t&&a&&a.imageSrcSet?(n+='[imagesrcset="'+gt(a.imageSrcSet)+'"]',"string"==typeof a.imageSizes&&(n+='[imagesizes="'+gt(a.imageSizes)+'"]')):n+='[href="'+gt(e)+'"]';var i=n;switch(t){case"style":i=Tu(e);break;case"script":i=$u(e)}ku.has(i)||(e=u({rel:"preload",href:"image"===t&&a&&a.imageSrcSet?void 0:e,as:t},a),ku.set(i,e),null!==s.querySelector(n)||"style"===t&&s.querySelector(Iu(i))||"script"===t&&s.querySelector(Lu(i))||(au(t=s.createElement("link"),"link",e),Je(t),s.head.appendChild(t)))}},m:function(e,t){Cu.m(e,t);var a=Au;if(a&&e){var s=t&&"string"==typeof t.as?t.as:"script",n='link[rel="modulepreload"][as="'+gt(s)+'"][href="'+gt(e)+'"]',i=n;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":i=$u(e)}if(!ku.has(i)&&(e=u({rel:"modulepreload",href:e},t),ku.set(i,e),null===a.querySelector(n))){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(a.querySelector(Lu(i)))return}au(s=a.createElement("link"),"link",e),Je(s),a.head.appendChild(s)}}},X:function(e,t){Cu.X(e,t);var a=Au;if(a&&e){var s=qe(a).hoistableScripts,n=$u(e),i=s.get(n);i||((i=a.querySelector(Lu(n)))||(e=u({src:e,async:!0},t),(t=ku.get(n))&&Ou(e,t),Je(i=a.createElement("script")),au(i,"link",e),a.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},s.set(n,i))}},S:function(e,t,a){Cu.S(e,t,a);var s=Au;if(s&&e){var n=qe(s).hoistableStyles,i=Tu(e);t=t||"default";var r=n.get(i);if(!r){var l={loading:0,preload:null};if(r=s.querySelector(Iu(i)))l.loading=5;else{e=u({rel:"stylesheet",href:e,"data-precedence":t},a),(a=ku.get(i))&&Wu(e,a);var c=r=s.createElement("link");Je(c),au(c,"link",e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){l.loading|=1}),c.addEventListener("error",function(){l.loading|=2}),l.loading|=4,Ru(r,t,s)}r={type:"stylesheet",instance:r,count:1,state:l},n.set(i,r)}}},M:function(e,t){Cu.M(e,t);var a=Au;if(a&&e){var s=qe(a).hoistableScripts,n=$u(e),i=s.get(n);i||((i=a.querySelector(Lu(n)))||(e=u({src:e,async:!0,type:"module"},t),(t=ku.get(n))&&Ou(e,t),Je(i=a.createElement("script")),au(i,"link",e),a.head.appendChild(i)),i={type:"script",instance:i,count:1,state:null},s.set(n,i))}}};var Au="undefined"==typeof document?null:document;function Eu(e,t,a){var s=Au;if(s&&"string"==typeof t&&t){var n=gt(t);n='link[rel="'+e+'"][href="'+n+'"]',"string"==typeof a&&(n+='[crossorigin="'+a+'"]'),_u.has(n)||(_u.add(n),e={rel:e,crossOrigin:a,href:t},null===s.querySelector(n)&&(au(t=s.createElement("link"),"link",e),Je(t),s.head.appendChild(t)))}}function Pu(e,t,a,s){var n,r,l,c,o=(o=q.current)?Su(o):null;if(!o)throw Error(i(446));switch(e){case"meta":case"title":return null;case"style":return"string"==typeof a.precedence&&"string"==typeof a.href?(t=Tu(a.href),(s=(a=qe(o).hoistableStyles).get(t))||(s={type:"style",instance:null,count:0,state:null},a.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===a.rel&&"string"==typeof a.href&&"string"==typeof a.precedence){e=Tu(a.href);var d=qe(o).hoistableStyles,u=d.get(e);if(u||(o=o.ownerDocument||o,u={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},d.set(e,u),(d=o.querySelector(Iu(e)))&&!d._p&&(u.instance=d,u.state.loading=5),ku.has(e)||(a={rel:"preload",as:"style",href:a.href,crossOrigin:a.crossOrigin,integrity:a.integrity,media:a.media,hrefLang:a.hrefLang,referrerPolicy:a.referrerPolicy},ku.set(e,a),d||(n=o,r=e,l=a,c=u.state,n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),au(r,"link",l),Je(r),n.head.appendChild(r))))),t&&null===s)throw Error(i(528,""));return u}if(t&&null!==s)throw Error(i(529,""));return null;case"script":return t=a.async,"string"==typeof(a=a.src)&&t&&"function"!=typeof t&&"symbol"!=typeof t?(t=$u(a),(s=(a=qe(o).hoistableScripts).get(t))||(s={type:"script",instance:null,count:0,state:null},a.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Tu(e){return'href="'+gt(e)+'"'}function Iu(e){return'link[rel="stylesheet"]['+e+"]"}function Fu(e){return u({},e,{"data-precedence":e.precedence,precedence:null})}function $u(e){return'[src="'+gt(e)+'"]'}function Lu(e){return"script[async]"+e}function Mu(e,t,a){if(t.count++,null===t.instance)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+gt(a.href)+'"]');if(s)return t.instance=s,Je(s),s;var n=u({},a,{"data-href":a.href,"data-precedence":a.precedence,href:null,precedence:null});return Je(s=(e.ownerDocument||e).createElement("style")),au(s,"style",n),Ru(s,a.precedence,e),t.instance=s;case"stylesheet":n=Tu(a.href);var r=e.querySelector(Iu(n));if(r)return t.state.loading|=4,t.instance=r,Je(r),r;s=Fu(a),(n=ku.get(n))&&Wu(s,n),Je(r=(e.ownerDocument||e).createElement("link"));var l=r;return l._p=new Promise(function(e,t){l.onload=e,l.onerror=t}),au(r,"link",s),t.state.loading|=4,Ru(r,a.precedence,e),t.instance=r;case"script":return r=$u(a.src),(n=e.querySelector(Lu(r)))?(t.instance=n,Je(n),n):(s=a,(n=ku.get(r))&&Ou(s=u({},a),n),Je(n=(e=e.ownerDocument||e).createElement("script")),au(n,"link",s),e.head.appendChild(n),t.instance=n);case"void":return null;default:throw Error(i(443,t.type))}else"stylesheet"===t.type&&!(4&t.state.loading)&&(s=t.instance,t.state.loading|=4,Ru(s,a.precedence,e));return t.instance}function Ru(e,t,a){for(var s=a.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),n=s.length?s[s.length-1]:null,i=n,r=0;r<s.length;r++){var l=s[r];if(l.dataset.precedence===t)i=l;else if(i!==n)break}i?i.parentNode.insertBefore(e,i.nextSibling):(t=9===a.nodeType?a.head:a).insertBefore(e,t.firstChild)}function Wu(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function Ou(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var Du=null;function Bu(e,t,a){if(null===Du){var s=new Map,n=Du=new Map;n.set(a,s)}else(s=(n=Du).get(a))||(s=new Map,n.set(a,s));if(s.has(e))return s;for(s.set(e,null),a=a.getElementsByTagName(e),n=0;n<a.length;n++){var i=a[n];if(!(i[Be]||i[$e]||"link"===e&&"stylesheet"===i.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==i.namespaceURI){var r=i.getAttribute(t)||"";r=e+r;var l=s.get(r);l?l.push(i):s.set(r,[i])}}return s}function Uu(e,t,a){(e=e.ownerDocument||e).head.insertBefore(a,"title"===t?e.querySelector("head > title"):null)}function zu(e){return!!("stylesheet"!==e.type||3&e.state.loading)}var Xu=null;function Hu(){}function qu(){if(this.count--,0===this.count)if(this.stylesheets)Vu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var Ju=null;function Vu(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,Ju=new Map,t.forEach(Gu,e),Ju=null,qu.call(e))}function Gu(e,t){if(!(4&t.state.loading)){var a=Ju.get(e);if(a)var s=a.get(null);else{a=new Map,Ju.set(e,a);for(var n=e.querySelectorAll("link[data-precedence],style[data-precedence]"),i=0;i<n.length;i++){var r=n[i];"LINK"!==r.nodeName&&"not all"===r.getAttribute("media")||(a.set(r.dataset.precedence,r),s=r)}s&&a.set(null,s)}r=(n=t.instance).getAttribute("data-precedence"),(i=a.get(r)||s)===s&&a.set(null,n),a.set(r,n),this.count++,s=qu.bind(this),n.addEventListener("load",s),n.addEventListener("error",s),i?i.parentNode.insertBefore(n,i.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(n,e.firstChild),t.state.loading|=4}}var Ku={$$typeof:j,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function Yu(e,t,a,s,n,i,r,l){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Se(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Se(0),this.hiddenUpdates=Se(null),this.identifierPrefix=s,this.onUncaughtError=n,this.onCaughtError=i,this.onRecoverableError=r,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=l,this.incompleteTransitions=new Map}function Qu(e,t,a,s,n,i,r,l,c,o,d,u){return e=new Yu(e,t,a,r,l,c,o,u),t=1,!0===i&&(t|=24),i=Rs(3,null,null,t),e.current=i,i.stateNode=e,(t=Ln()).refCount++,e.pooledCache=t,t.refCount++,i.memoizedState={element:s,isDehydrated:a,cache:t},ni(i),e}function Zu(e){return e?e=Ls:Ls}function em(e,t,a,s,n,i){n=Zu(n),null===s.context?s.context=n:s.pendingContext=n,(s=ri(t)).payload={element:a},null!==(i=void 0===i?null:i)&&(s.callback=i),null!==(a=li(e,s,t))&&(Wo(a,0,t),ci(a,e,t))}function tm(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function am(e,t){tm(e,t),(e=e.alternate)&&tm(e,t)}function sm(e){if(13===e.tag){var t=Is(e,67108864);null!==t&&Wo(t,0,67108864),am(e,67108864)}}var nm=!0;function im(e,t,a,s){var n=M.T;M.T=null;var i=R.p;try{R.p=2,lm(e,t,a,s)}finally{R.p=i,M.T=n}}function rm(e,t,a,s){var n=M.T;M.T=null;var i=R.p;try{R.p=8,lm(e,t,a,s)}finally{R.p=i,M.T=n}}function lm(e,t,a,s){if(nm){var n=cm(s);if(null===n)Xd(e,t,s,om,a),jm(e,s);else if(function(e,t,a,s,n){switch(t){case"focusin":return hm=bm(hm,e,t,a,s,n),!0;case"dragenter":return pm=bm(pm,e,t,a,s,n),!0;case"mouseover":return fm=bm(fm,e,t,a,s,n),!0;case"pointerover":var i=n.pointerId;return xm.set(i,bm(xm.get(i)||null,e,t,a,s,n)),!0;case"gotpointercapture":return i=n.pointerId,gm.set(i,bm(gm.get(i)||null,e,t,a,s,n)),!0}return!1}(n,e,t,a,s))s.stopPropagation();else if(jm(e,s),4&t&&-1<ym.indexOf(e)){for(;null!==n;){var i=Xe(n);if(null!==i)switch(i.tag){case 3:if((i=i.stateNode).current.memoizedState.isDehydrated){var r=je(i.pendingLanes);if(0!==r){var l=i;for(l.pendingLanes|=2,l.entangledLanes|=2;r;){var c=1<<31-fe(r);l.entanglements[1]|=c,r&=~c}kd(i),!(6&so)&&(ko=se()+500,_d(0))}}break;case 13:null!==(l=Is(i,2))&&Wo(l,0,2),zo(),am(i,2)}if(null===(i=cm(s))&&Xd(e,t,s,om,a),i===n)break;n=i}null!==n&&s.stopPropagation()}else Xd(e,t,s,null,a)}}function cm(e){return dm(e=Ft(e))}var om=null;function dm(e){if(om=null,null!==(e=ze(e))){var t=l(e);if(null===t)e=null;else{var a=t.tag;if(13===a){if(null!==(e=c(t)))return e;e=null}else if(3===a){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return om=e,null}function um(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ne()){case ie:return 2;case re:return 8;case le:case ce:return 32;case oe:return 268435456;default:return 32}default:return 32}}var mm=!1,hm=null,pm=null,fm=null,xm=new Map,gm=new Map,vm=[],ym="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function jm(e,t){switch(e){case"focusin":case"focusout":hm=null;break;case"dragenter":case"dragleave":pm=null;break;case"mouseover":case"mouseout":fm=null;break;case"pointerover":case"pointerout":xm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gm.delete(t.pointerId)}}function bm(e,t,a,s,n,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:a,eventSystemFlags:s,nativeEvent:i,targetContainers:[n]},null!==t&&(null!==(t=Xe(t))&&sm(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Nm(e){var t=ze(e.target);if(null!==t){var a=l(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=c(a)))return e.blockedOn=t,void function(e,t){var a=R.p;try{return R.p=e,t()}finally{R.p=a}}(e.priority,function(){if(13===a.tag){var e=Mo();e=Pe(e);var t=Is(a,e);null!==t&&Wo(t,0,e),am(a,e)}})}else if(3===t&&a.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function wm(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=cm(e.nativeEvent);if(null!==a)return null!==(t=Xe(a))&&sm(t),e.blockedOn=a,!1;var s=new(a=e.nativeEvent).constructor(a.type,a);It=s,a.target.dispatchEvent(s),It=null,t.shift()}return!0}function km(e,t,a){wm(e)&&a.delete(t)}function _m(){mm=!1,null!==hm&&wm(hm)&&(hm=null),null!==pm&&wm(pm)&&(pm=null),null!==fm&&wm(fm)&&(fm=null),xm.forEach(km),gm.forEach(km)}function Sm(e,t){e.blockedOn===t&&(e.blockedOn=null,mm||(mm=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,_m)))}var Cm=null;function Am(e){Cm!==e&&(Cm=e,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Cm===e&&(Cm=null);for(var t=0;t<e.length;t+=3){var a=e[t],s=e[t+1],n=e[t+2];if("function"!=typeof s){if(null===dm(s||a))continue;break}var i=Xe(a);null!==i&&(e.splice(t,3),t-=3,Ir(i,{pending:!0,data:n,method:a.method,action:s},s,n))}}))}function Em(e){function t(t){return Sm(t,e)}null!==hm&&Sm(hm,e),null!==pm&&Sm(pm,e),null!==fm&&Sm(fm,e),xm.forEach(t),gm.forEach(t);for(var a=0;a<vm.length;a++){var s=vm[a];s.blockedOn===e&&(s.blockedOn=null)}for(;0<vm.length&&null===(a=vm[0]).blockedOn;)Nm(a),null===a.blockedOn&&vm.shift();if(null!=(a=(e.ownerDocument||e).$$reactFormReplay))for(s=0;s<a.length;s+=3){var n=a[s],i=a[s+1],r=n[Le]||null;if("function"==typeof i)r||Am(a);else if(r){var l=null;if(i&&i.hasAttribute("formAction")){if(n=i,r=i[Le]||null)l=r.formAction;else if(null!==dm(n))continue}else l=r.action;"function"==typeof l?a[s+1]=l:(a.splice(s,3),s-=3),Am(a)}}}function Pm(e){this._internalRoot=e}function Tm(e){this._internalRoot=e}Tm.prototype.render=Pm.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));em(t.current,Mo(),e,t,null,null)},Tm.prototype.unmount=Pm.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;em(e.current,2,null,e,null,null),zo(),t[Me]=null}},Tm.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ie();e={blockedOn:null,target:e,priority:t};for(var a=0;a<vm.length&&0!==t&&t<vm[a].priority;a++);vm.splice(a,0,e),0===a&&Nm(e)}};var Im=s.version;if("19.1.1"!==Im)throw Error(i(527,Im,"19.1.1"));R.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=l(e)))throw Error(i(188));return t!==e?null:e}for(var a=e,s=t;;){var n=a.return;if(null===n)break;var r=n.alternate;if(null===r){if(null!==(s=n.return)){a=s;continue}break}if(n.child===r.child){for(r=n.child;r;){if(r===a)return o(n),e;if(r===s)return o(n),t;r=r.sibling}throw Error(i(188))}if(a.return!==s.return)a=n,s=r;else{for(var c=!1,d=n.child;d;){if(d===a){c=!0,a=n,s=r;break}if(d===s){c=!0,s=n,a=r;break}d=d.sibling}if(!c){for(d=r.child;d;){if(d===a){c=!0,a=r,s=n;break}if(d===s){c=!0,s=r,a=n;break}d=d.sibling}if(!c)throw Error(i(189))}}if(a.alternate!==s)throw Error(i(190))}if(3!==a.tag)throw Error(i(188));return a.stateNode.current===a?e:t}(t),e=null===(e=null!==e?d(e):null)?null:e.stateNode};var Fm={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:M,reconcilerVersion:"19.1.1"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var $m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$m.isDisabled&&$m.supportsFiber)try{me=$m.inject(Fm),he=$m}catch(Mm){}}return P.createRoot=function(e,t){if(!r(e))throw Error(i(299));var a=!1,s="",n=yl,l=jl,c=bl;return null!=t&&(!0===t.unstable_strictMode&&(a=!0),void 0!==t.identifierPrefix&&(s=t.identifierPrefix),void 0!==t.onUncaughtError&&(n=t.onUncaughtError),void 0!==t.onCaughtError&&(l=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError),void 0!==t.unstable_transitionCallbacks&&t.unstable_transitionCallbacks),t=Qu(e,1,!1,null,0,a,s,n,l,c,0,null),e[Me]=t.current,Ud(e),new Pm(t)},P.hydrateRoot=function(e,t,a){if(!r(e))throw Error(i(299));var s=!1,n="",l=yl,c=jl,o=bl,d=null;return null!=a&&(!0===a.unstable_strictMode&&(s=!0),void 0!==a.identifierPrefix&&(n=a.identifierPrefix),void 0!==a.onUncaughtError&&(l=a.onUncaughtError),void 0!==a.onCaughtError&&(c=a.onCaughtError),void 0!==a.onRecoverableError&&(o=a.onRecoverableError),void 0!==a.unstable_transitionCallbacks&&a.unstable_transitionCallbacks,void 0!==a.formState&&(d=a.formState)),(t=Qu(e,1,!0,t,0,s,n,l,c,o,0,d)).context=Zu(null),a=t.current,(n=ri(s=Pe(s=Mo()))).callback=null,li(a,n,s),a=s,t.current.lanes=a,Ce(t,a),kd(t),e[Me]=t.current,Ud(e),new Tm(t)},P.version="19.1.1",P}var L=(C||(C=1,function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),E.exports=$()),E.exports);const M=a.createContext(void 0),R=()=>{const e=a.useContext(M);if(void 0===e)throw new Error("useWallet must be used within a WalletProvider");return e};class W{static MESSAGES={NETWORK_ERROR:{title:"Connection Error",message:"Unable to connect to the server. Please check your internet connection and try again.",action:"Retry"},TIMEOUT_ERROR:{title:"Request Timeout",message:"The request took too long to complete. Please try again.",action:"Retry"},API_ERROR:{title:"Service Unavailable",message:"The service is temporarily unavailable. Please try again in a moment.",action:"Retry"},LOAD_FAILED:{title:"Loading Failed",message:"Failed to load data. Please refresh the page or try again later.",action:"Refresh"},WALLET_CONNECTION_FAILED:{title:"Wallet Connection Failed",message:"Unable to connect to your wallet. Please ensure your wallet is unlocked and try again.",action:"Retry"},WALLET_DISCONNECTED:{title:"Wallet Disconnected",message:"Your wallet has been disconnected. Please reconnect to continue.",action:"Connect Wallet"},INSUFFICIENT_BALANCE:{title:"Insufficient Balance",message:"You do not have enough balance to complete this transaction.",action:"Add Funds"},TRANSACTION_FAILED:{title:"Transaction Failed",message:"The transaction could not be completed. Please try again.",action:"Retry"},TRANSACTION_REJECTED:{title:"Transaction Rejected",message:"The transaction was rejected. Please try again if this was unintentional.",action:"Retry"},INVALID_INPUT:{title:"Invalid Input",message:"Please check your input and try again.",action:"Correct Input"},REQUIRED_FIELD:{title:"Required Field Missing",message:"Please fill in all required fields.",action:"Complete Form"},NFT_NOT_FOUND:{title:"NFT Not Found",message:"The requested NFT could not be found or may no longer be available.",action:"Go Back"},COLLECTION_NOT_FOUND:{title:"Collection Not Found",message:"The requested collection could not be found or may not exist.",action:"Browse Collections"},PURCHASE_FAILED:{title:"Purchase Failed",message:"Unable to complete the purchase. The item may no longer be available.",action:"Refresh Listings"},LISTING_FAILED:{title:"Listing Failed",message:"Unable to list your NFT. Please check your wallet and try again.",action:"Retry"},UNKNOWN_ERROR:{title:"Something Went Wrong",message:"An unexpected error occurred. Please try again or contact support if the problem persists.",action:"Retry"}};static getMessage(e){return W.MESSAGES[e]}static createMessage(e,t,a){return{title:e,message:t,action:a}}static formatError(e,t){if(e instanceof Error){const t=e.message.toLowerCase(),a=e.name.toLowerCase();return t.includes("network")||t.includes("fetch")||t.includes("connection")?W.MESSAGES.NETWORK_ERROR:t.includes("timeout")||t.includes("aborted")||a.includes("timeout")?W.MESSAGES.TIMEOUT_ERROR:t.includes("rejected")||t.includes("cancelled")?W.MESSAGES.TRANSACTION_REJECTED:t.includes("insufficient")?W.MESSAGES.INSUFFICIENT_BALANCE:t.includes("not found")?W.MESSAGES.NFT_NOT_FOUND:"chunkloaderror"===a?W.MESSAGES.LOAD_FAILED:t.includes("api")||t.includes("http")||t.includes("server")?W.MESSAGES.API_ERROR:"localhost"===window.location.hostname?W.createMessage(`Error: ${e.name}`,e.message,"Retry"):W.createMessage("Error","An error occurred while processing your request.","Retry")}return t||W.MESSAGES.UNKNOWN_ERROR}static logError(e,t,a){const s={context:e,error:t instanceof Error?{name:t.name,message:t.message,stack:t.stack}:t,timestamp:(new Date).toISOString(),...a};console.error(`[${e}]`,s)}}function O(e,t=8,a=0){const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"0";if(0===s)return a>0?"0."+"0".repeat(a):"0";if(Math.abs(s)<Math.pow(10,-t))return s.toExponential(2);let n=s.toFixed(t);if(n.includes(".")&&(n=n.replace(/\.?0+$/,"")),a>0){const e=n.indexOf(".");if(-1===e)n+="."+"0".repeat(a);else{const t=n.length-e-1;t<a&&(n+="0".repeat(a-t))}}return n}const D=function(e,t=!0){const a="string"==typeof e?parseFloat(e.replace(" WAX","")):e;if(isNaN(a))return t?"0 WAX":"0";let s;return s=O(a,a>=1e3||a>=1?4:a>=.01?6:8,0),t?`${s} WAX`:s},B=O,U="debug",z="info",X="warn",H="error";const q=new class{logLevel=z;isDevelopment=!1;logs=[];maxLogs=1e3;constructor(){this.logLevel=this.isDevelopment?U:X}createLogEntry(e,t,a,s,n){return{timestamp:(new Date).toISOString(),level:e,message:t,context:a,data:s,error:n}}shouldLog(e){return e>=this.logLevel}storeLog(e){this.logs.push(e),this.logs.length>this.maxLogs&&this.logs.shift()}formatMessage(e){const t=e.level.toUpperCase(),a=e.context?`[${e.context}]`:"";return`${e.timestamp} ${t} ${a} ${e.message}`}debug(e,t,a){if(!this.shouldLog(U))return;const s=this.createLogEntry(U,e,t,a);this.storeLog(s),this.isDevelopment&&console.debug(this.formatMessage(s),a||"")}info(e,t,a){if(!this.shouldLog(z))return;const s=this.createLogEntry(z,e,t,a);this.storeLog(s),this.isDevelopment&&console.info(this.formatMessage(s),a||"")}warn(e,t,a){if(!this.shouldLog(X))return;const s=this.createLogEntry(X,e,t,a);this.storeLog(s),console.warn(this.formatMessage(s),a||"")}error(e,t,a,s){if(!this.shouldLog(H))return;const n=this.createLogEntry(H,e,t,s,a);this.storeLog(n),console.error(this.formatMessage(n),a||"",s||""),!this.isDevelopment&&a&&this.reportError(a,{message:e,context:t,data:s})}async reportError(e,t){try{const a=[this.sendToErrorReportingAPI(e,t),this.sendToLocalStorage(e,t),this.sendToConsole(e,t)];await Promise.allSettled(a)}catch(a){console.error("Failed to report error:",a),console.error("Original error:",e)}}async sendToErrorReportingAPI(e,t){try{const a={message:e.message,stack:e.stack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,userId:this.getUserId(),sessionId:this.getSessionId(),buildVersion:this.getBuildVersion(),environment:this.getEnvironment(),metadata:t},s=await fetch("/api/errors/report",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify(a)});if(!s.ok)throw new Error(`Error reporting failed: ${s.status} ${s.statusText}`);console.log("Error successfully reported to server")}catch{await this.sendToFallbackErrorService(e,t)}}async sendToFallbackErrorService(e,t){try{const a={error:{message:e.message,stack:e.stack,timestamp:(new Date).toISOString()},context:{...t,userAgent:navigator.userAgent,url:window.location.href}};"undefined"!=typeof window&&window.Sentry&&window.Sentry.captureException(e,{extra:a.context,level:"error"})}catch(a){console.warn("Fallback error reporting also failed:",a)}}async sendToLocalStorage(e,t){try{const s="error_reports",n=50,i={message:e.message,stack:e.stack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href,metadata:t};let r=[];const l=localStorage.getItem(s);if(l)try{r=JSON.parse(l)}catch(a){console.warn("Failed to parse stored errors:",a)}r.unshift(i),r=r.slice(0,n),localStorage.setItem(s,JSON.stringify(r))}catch(s){console.warn("Failed to store error in localStorage:",s)}}sendToConsole(e,t){console.group(`%cERROR: ${e.message}`,"color: #ff4444; font-weight: bold; background: #ffe6e6; padding: 2px 4px; border-radius: 3px;"),t&&console.log("Metadata:",t),e.stack&&console.log("Stack:",e.stack),console.log("Timestamp:",(new Date).toISOString()),console.groupEnd()}getUserId(){return localStorage.getItem("user_id")||sessionStorage.getItem("user_id")||"anonymous"}getSessionId(){let e=sessionStorage.getItem("session_id");return e||(e=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,sessionStorage.setItem("session_id",e)),e}getAuthToken(){return localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")||""}getBuildVersion(){return"unknown"}getEnvironment(){return"production"}getLogs(e){return void 0!==e?this.logs.filter(t=>t.level>=e):[...this.logs]}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}},J=(e,t,a)=>q.debug(e,t,a),V=(e,t,a)=>q.info(e,t,a),G=(e,t,a)=>q.warn(e,t,a),K=(e,t,a,s)=>q.error(e,t,a,s),Y=["Citrine","Tourmaline","Emerald","Garnet","Peridot","Jade","Sapphire","Turquoise","Pigeon Blood Ruby","Blue Rock","Black Rock","Rock"],Q=["friedfactory","pixeljourney"],Z=["alien.worlds","prospectorsc","token.nefty"],ee="781515",te={ATOMIC_ASSETS:["https://atomic.wax.eosrio.io","https://wax-atomic.alcor.exchange","https://atomic-wax-mainnet.wecan.dev","https://wax.eosusa.io","https://wax-atomic-api.eosphere.io","https://atomic.3dkrender.com","https://aa-wax-public1.neftyblocks.com","https://atomic-wax.tacocrypto.io"],WAX_CHAIN:{EOSRIO:"https://wax.eosrio.io",WAXSWEDEN:"https://api.waxsweden.org",GREYMASS:"https://wax.greymass.com",EOSPHERE:"https://wax.eosphere.io",ALOHAEOS:"https://api.wax.alohaeos.com",PINK:"https://wax.pink.gg",CRYPTOLIONS:"https://wax.cryptolions.io",FALLBACK_ENDPOINTS:["https://wax.eosphere.io","https://wax.eosrio.io","https://api.wax.alohaeos.com","https://wax.pink.gg","https://api.waxsweden.org","https://wax.greymass.com","https://wax.cryptolions.io"],HYPERION_ENDPOINTS:["https://wax-hyperion.eosdetroit.io","https://wax.eosrio.io","https://api.waxsweden.org"],HIVEBP:"https://wax-api.hivebp.io",LIGHT_API:"https://wax.light-api.net"},SPECIALIZED:{ALCOR:"https://alcor.exchange/api/v2",DAPPLICA:"https://aa.dapplica.io",NEFTY:"https://api.neftyblocks.com"},IPFS:{GATEWAYS:["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://dweb.link/ipfs/"]},AVATAR:{DICEBEAR:"https://api.dicebear.com/7.x/identicon/svg"},HYPERION:["https://wax-hyperion.eosdetroit.io","https://wax.eosrio.io","https://api.waxsweden.org"],COINGECKO_API:"https://api.coingecko.com/api/v3/simple/price",EXCHANGE_RATE_API:"https://api.exchangerate-api.com/v4/latest/USD",SOCIAL:{TWITTER_INTENT:"https://twitter.com/intent/tweet",FACEBOOK_SHARE:"https://www.facebook.com/sharer/sharer.php",REDDIT_SUBMIT:"https://reddit.com/submit",TELEGRAM_SHARE:"https://t.me/share/url",DISCORD:"https://discord.gg/pixeljourney",ATOMICHUB_EXPLORER:"https://wax.atomichub.io/explorer",BLOKS_EXPLORER:"https://wax.bloks.io"},PIXEL_JOURNEY:{MAIN_SITE:"https://pixeljourney.xyz",DOCS:"https://docs.pixeljourney.xyz",LOGO:"https://pixeljourney.xyz/img/logo.png",DEFAULT_IMAGE:"https://pixeljourney.xyz/img/toppixals/10.webp",LEADERBOARD:"https://lb.pixeljourney.xyz/",CRAFTING_DOCS:"https://docs.pixeljourney.xyz/season-1/recycling-and-crafting"},DICEBEAR_API:"https://api.dicebear.com/7.x/identicon/svg",GOOGLE_FONTS:"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap",WAX_WALLET:"https://wallet.wax.io"};class ae{static configCache={};static CACHE_DURATION=3e5;static isValidWaxRock(e){return"none"!==e&&Y.includes(e)}static getWaxRockTypes(){return Y}static async getPartnerCollections(){const e=Date.now();if(this.configCache.partnerCollections&&this.configCache.lastFetch&&e-this.configCache.lastFetch<this.CACHE_DURATION)return this.configCache.partnerCollections;try{const{apiService:t}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),a=await t.getPartnerCollections();return this.configCache.partnerCollections=a,this.configCache.lastFetch=e,a}catch(t){return G("Failed to fetch partner collections from API, using fallback","MarketplaceConfig",{error:t}),[...Q]}}static getPartnerCollectionsSync(){return this.configCache.partnerCollections||Q}static async getTokenContracts(){const e=Date.now();if(this.configCache.tokenContracts&&this.configCache.lastFetch&&e-this.configCache.lastFetch<this.CACHE_DURATION)return this.configCache.tokenContracts;try{const{apiService:t}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),a=await t.getTokenContracts();return this.configCache.tokenContracts=a,this.configCache.lastFetch=e,a}catch(t){return G("Failed to fetch token contracts from API, using fallback","MarketplaceConfig",{error:t}),[...Z]}}static getTokenContractsSync(){return this.configCache.tokenContracts||Z}static getPixalTemplateId(){return ee}static isPixalPFP(e){return e===ee}static generateFiltersFromAssets(e){const t=new Set,a=new Map;t.add("All Items"),e.forEach(e=>{if(e.traits&&"object"==typeof e.traits&&null!==e.traits&&Object.keys(e.traits).forEach(t=>{const s=e.traits[t];if(s&&"none"!==s&&""!==s){const e=`${t}: ${s}`;a.set(e,(a.get(e)||0)+1)}}),e.data&&"object"==typeof e.data&&null!==e.data&&Object.keys(e.data).forEach(t=>{const s=e.data[t];if(s&&"none"!==s&&""!==s){const e=`${t}: ${s}`;a.set(e,(a.get(e)||0)+1)}}),e.collection){const t=`Collection: ${e.collection}`;a.set(t,(a.get(t)||0)+1)}if(e.schema){const t=`Schema: ${e.schema}`;a.set(t,(a.get(t)||0)+1)}});const s=Math.max(2,Math.floor(.05*e.length));return a.forEach((e,a)=>{e>=s&&t.add(a)}),Array.from(t).sort()}static async preloadConfiguration(){try{await Promise.all([this.getPartnerCollections(),this.getTokenContracts()])}catch(e){G("Failed to preload marketplace configuration","MarketplaceConfig",{error:e})}}static clearCache(){this.configCache={}}}const se=Object.freeze(Object.defineProperty({__proto__:null,API_ENDPOINTS:te,MarketplaceConfigService:ae,PARTNER_COLLECTIONS:Q,PIXAL_TEMPLATE_ID:ee,TOKEN_CONTRACTS:Z,WAXROCK_TYPES:Y},Symbol.toStringTag,{value:"Module"}));const ne=new class{exchangeRates={};cryptoRates={bitcoin:{usd:0},ethereum:{usd:0}};lastFetchTime=0;CACHE_DURATION=6e5;EXCHANGE_API=te.EXCHANGE_RATE_API;CRYPTO_API=te.COINGECKO_API;FALLBACK_RATES={USD:1,EUR:.85,DKK:6.3,AED:3.67,INR:83.12,RUB:74.5,CNY:7.1,JPY:110};FALLBACK_CRYPTO={bitcoin:{usd:115e3},ethereum:{usd:4e3}};async getExchangeRates(){const e=Date.now();if(Object.keys(this.exchangeRates).length>0&&e-this.lastFetchTime<this.CACHE_DURATION)return this.exchangeRates;try{const a=await fetch(this.EXCHANGE_API,{method:"GET",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const s=await a.json();this.exchangeRates={USD:1,EUR:s.rates?.EUR||this.FALLBACK_RATES.EUR,DKK:s.rates?.DKK||this.FALLBACK_RATES.DKK,AED:s.rates?.AED||this.FALLBACK_RATES.AED,INR:s.rates?.INR||this.FALLBACK_RATES.INR,RUB:s.rates?.RUB||this.FALLBACK_RATES.RUB,CNY:s.rates?.CNY||this.FALLBACK_RATES.CNY,JPY:s.rates?.JPY||this.FALLBACK_RATES.JPY};try{const e=await fetch(this.CRYPTO_API,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){const t=await e.json();this.cryptoRates={bitcoin:{usd:t.bitcoin?.usd||this.FALLBACK_CRYPTO.bitcoin.usd},ethereum:{usd:t.ethereum?.usd||this.FALLBACK_CRYPTO.ethereum.usd}}}}catch(t){W.logError("CurrencyService.getCryptoRates",t),this.cryptoRates=this.FALLBACK_CRYPTO}return this.lastFetchTime=e,this.exchangeRates}catch(a){return W.logError("CurrencyService.getExchangeRates",a,{api:this.EXCHANGE_API}),this.exchangeRates=this.FALLBACK_RATES,this.cryptoRates=this.FALLBACK_CRYPTO,this.lastFetchTime=e,this.exchangeRates}}async convertUSDToCurrency(e,t){if(e<=0)return"0.00";if("BTC"===t){await this.getExchangeRates();const t=e/this.cryptoRates.bitcoin.usd;return t>=.001?t.toFixed(6):t.toExponential(2)}if("ETH"===t){await this.getExchangeRates();const t=e/this.cryptoRates.ethereum.usd;return t>=.001?t.toFixed(6):t.toExponential(2)}const a=(await this.getExchangeRates())[t];if(!a)return"0.00";const s=e*a;return"JPY"===t?Math.round(s).toString():s.toFixed(2)}async convertWaxToCurrency(e,t){try{const{priceService:a}=await h(async()=>{const{priceService:e}=await Promise.resolve().then(()=>re);return{priceService:e}},void 0),s=await a.convertWaxToUSDAsync(e),n=parseFloat(s.replace(/[$,]/g,""));if("USD"===t)return s;const i=await this.convertUSDToCurrency(n,t);return this.formatCurrencyAmount(i,t)}catch(a){return W.logError("CurrencyService.convertWaxToCurrency",a,{waxAmount:e,targetCurrency:t}),"0.00"}}formatCurrencyAmount(e,t){switch(t){case"USD":return`$${e}`;case"EUR":return`€${e}`;case"DKK":return`${e} kr`;case"AED":return`${e} د.إ`;case"INR":return`₹${e}`;case"RUB":return`${e} ₽`;case"CNY":case"JPY":return`¥${e}`;case"BTC":return`₿${e}`;case"ETH":return`Ξ${e}`;default:return`${e} ${t}`}}getCurrencySymbol(e){return{USD:"$",EUR:"€",DKK:"kr",AED:"د.إ",INR:"₹",RUB:"₽",CNY:"¥",JPY:"¥",BTC:"₿",ETH:"Ξ"}[e]||e}};const ie=new class{waxPriceUSD=.02;wpixalPriceUSD=2e-5;wpixalPriceWAX=.001;pxjPriceUSD=1e-4;lastFetchTime=0;CACHE_DURATION=3e5;COINGECKO_WAX_API="https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd";GECKOTERMINAL_WPIXAL_API="https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:7845";GECKOTERMINAL_PXJ_POOLS=["https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:1195","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:1657","https://api.geckoterminal.com/api/v2/networks/wax/pools/swap.alcor:6560"];FALLBACK_WAX_PRICE=.02;FALLBACK_WPIXAL_PRICE=2e-5;FALLBACK_PXJ_PRICE=1e-4;async fetchPrices(){const e=Date.now();if(!(e-this.lastFetchTime<this.CACHE_DURATION&&this.waxPriceUSD>0&&this.wpixalPriceUSD>0))try{const[a,s,...n]=await Promise.all([fetch(this.COINGECKO_WAX_API).catch(()=>null),fetch(this.GECKOTERMINAL_WPIXAL_API).catch(()=>null),...this.GECKOTERMINAL_PXJ_POOLS.map(e=>fetch(e).catch(()=>null))]);let i=null;if(a&&a.ok)try{const e=await a.json();i=e.wax?.usd}catch(t){console.warn("Failed to parse WAX price data:",t)}let r=null;if(s&&s.ok)try{const e=await s.json();r=e.data?.attributes?.quote_token_price_usd,r&&(r=parseFloat(r))}catch(t){console.warn("Failed to parse WPIXAL price data:",t)}let l=null;for(const e of n)if(e&&e.ok)try{const t=await e.json(),a=t.data?.attributes?.quote_token_price_usd;if(a){l=parseFloat(a);break}}catch(t){console.warn("Failed to parse PXJ price data from pool:",t)}this.waxPriceUSD=i||this.FALLBACK_WAX_PRICE,this.wpixalPriceUSD=r||this.FALLBACK_WPIXAL_PRICE,this.pxjPriceUSD=l||this.FALLBACK_PXJ_PRICE,this.waxPriceUSD>0?this.wpixalPriceWAX=this.wpixalPriceUSD/this.waxPriceUSD:this.wpixalPriceWAX=.001,this.lastFetchTime=e}catch(t){W.logError("PriceService.fetchPrices",t,{waxApi:this.COINGECKO_WAX_API,wpixalApi:this.GECKOTERMINAL_WPIXAL_API,pxjPools:this.GECKOTERMINAL_PXJ_POOLS,fallbackWaxPrice:this.FALLBACK_WAX_PRICE,fallbackWpixalPrice:this.FALLBACK_WPIXAL_PRICE,fallbackPxjPrice:this.FALLBACK_PXJ_PRICE}),this.waxPriceUSD=this.FALLBACK_WAX_PRICE,this.wpixalPriceUSD=this.FALLBACK_WPIXAL_PRICE,this.pxjPriceUSD=this.FALLBACK_PXJ_PRICE,this.wpixalPriceWAX=this.FALLBACK_WPIXAL_PRICE/this.FALLBACK_WAX_PRICE,this.lastFetchTime=e}}async getWaxPriceUSD(){return await this.fetchPrices(),this.waxPriceUSD}async getWpixalPriceWAX(){return await this.fetchPrices(),this.wpixalPriceWAX}async getWpixalPriceUSD(){return await this.fetchPrices(),this.wpixalPriceUSD}async getPxjPriceUSD(){return await this.fetchPrices(),this.pxjPriceUSD}convertWaxToUSD(e){const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t)||this.waxPriceUSD<=0)return"$0.00";const a=t*this.waxPriceUSD;return`$${B(a,2)}`}async convertWaxToUSDAsync(e){return await this.getWaxPriceUSD(),this.convertWaxToUSD(e)}async convertWaxToCurrencyAsync(e,t="USD"){return"USD"===t?this.convertWaxToUSDAsync(e):ne.convertWaxToCurrency(e,t)}async convertWpixalToWAX(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"0.0000 WAX";const a=await this.getWpixalPriceWAX();return D(t*a)}catch(t){return W.logError("PriceService.convertWpixalToWAX",t,{wpixalAmount:e}),"0.0000 WAX"}}async convertWpixalToUSD(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"$0.00";const a=await this.getWpixalPriceUSD();return`$${B(t*a,2)}`}catch(t){return W.logError("PriceService.convertWpixalToUSD",t,{wpixalAmount:e}),"$0.00"}}async convertPxjToUSD(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"$0.00";const a=await this.getPxjPriceUSD();return`$${B(t*a,6)}`}catch(t){return W.logError("PriceService.convertPxjToUSD",t,{pxjAmount:e}),"$0.00"}}async convertPxjToWAX(e){try{const t=parseFloat(e.replace(/[^0-9.]/g,""));if(isNaN(t))return"0.0000 WAX";const a=await this.getPxjPriceUSD(),s=await this.getWaxPriceUSD();return D(t*a/s)}catch(t){return W.logError("PriceService.convertPxjToWAX",t,{pxjAmount:e}),"0.0000 WAX"}}async convertWaxWithDisplaySettings(e){try{const t=localStorage.getItem("selectedCurrency")||"USD";if(!JSON.parse(localStorage.getItem("showPricesInUSD")||"true")){const t=parseFloat(e.replace(/[^0-9.]/g,""));return D(t)}return this.convertWaxToCurrencyAsync(e,t)}catch(t){return W.logError("PriceService.convertWaxWithDisplaySettings",t,{waxAmount:e}),this.convertWaxToUSDAsync(e)}}},re=Object.freeze(Object.defineProperty({__proto__:null,priceService:ie},Symbol.toStringTag,{value:"Module"}));const le=new class{isStorageAvailable(e){try{const t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch{return!1}}get isLocalStorageAvailable(){return"undefined"!=typeof window&&this.isStorageAvailable(localStorage)}get isSessionStorageAvailable(){return"undefined"!=typeof window&&this.isStorageAvailable(sessionStorage)}getItem(e,t=!1){try{const a=t?sessionStorage:localStorage;if(t&&this.isSessionStorageAvailable)return a.getItem(e);if(!t&&this.isLocalStorageAvailable)return a.getItem(e);const s=t?localStorage:sessionStorage;return(t?this.isLocalStorageAvailable:this.isSessionStorageAvailable)?(q.warn(`Primary storage unavailable, using fallback for key: ${e}`),s.getItem(e)):(q.warn(`No storage available for key: ${e}`),null)}catch(a){return q.error("StorageService.getItem failed","StorageService",a,{key:e,useSessionStorage:t}),null}}setItem(e,t,a=!1){try{const s=a?sessionStorage:localStorage;if(a&&this.isSessionStorageAvailable)return s.setItem(e,t),!0;if(!a&&this.isLocalStorageAvailable)return s.setItem(e,t),!0;const n=a?localStorage:sessionStorage;return(a?this.isLocalStorageAvailable:this.isSessionStorageAvailable)?(q.warn(`Primary storage unavailable, using fallback for key: ${e}`),n.setItem(e,t),!0):(q.warn(`No storage available for key: ${e}`),!1)}catch(s){return q.error("StorageService.setItem failed","StorageService",s,{key:e,useSessionStorage:a}),!1}}removeItem(e,t=!1){try{const a=t?sessionStorage:localStorage;if(t&&this.isSessionStorageAvailable)return a.removeItem(e),!0;if(!t&&this.isLocalStorageAvailable)return a.removeItem(e),!0;let s=!1;return this.isLocalStorageAvailable&&(localStorage.removeItem(e),s=!0),this.isSessionStorageAvailable&&(sessionStorage.removeItem(e),s=!0),s||q.warn(`No storage available to remove key: ${e}`),s}catch(a){return q.error("StorageService.removeItem failed","StorageService",a,{key:e,useSessionStorage:t}),!1}}clear(e=!1){try{const t=e?sessionStorage:localStorage;return e&&this.isSessionStorageAvailable||!e&&this.isLocalStorageAvailable?(t.clear(),!0):(q.warn("No storage available to clear"),!1)}catch(t){return q.error("StorageService.clear failed","StorageService",t,{useSessionStorage:e}),!1}}getJSON(e,t,a=!1){try{const s=this.getItem(e,a);return null===s?t:JSON.parse(s)}catch(s){return q.error("StorageService.getJSON failed","StorageService",s,{key:e,useSessionStorage:a}),t}}setJSON(e,t,a=!1){try{const s=JSON.stringify(t);return this.setItem(e,s,a)}catch(s){return q.error("StorageService.setJSON failed","StorageService",s,{key:e,useSessionStorage:a}),!1}}getStorageStats(){const e=e=>{try{let t=0;for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t+=e[a].length+a.length);return{used:t,total:5242880}}catch{return{used:0,total:0}}};return{localStorage:{available:this.isLocalStorageAvailable,...e(this.isLocalStorageAvailable?localStorage:{})},sessionStorage:{available:this.isSessionStorageAvailable,...e(this.isSessionStorageAvailable?sessionStorage:{})}}}isQuotaExceeded(){const e=this.getStorageStats(),t=e.localStorage.used/e.localStorage.total,a=e.sessionStorage.used/e.sessionStorage.total;return t>.9||a>.9}cleanup(e=[]){let t=0;try{const a=[{storage:localStorage,available:this.isLocalStorageAvailable},{storage:sessionStorage,available:this.isSessionStorageAvailable}];for(const{storage:s,available:n}of a){if(!n)continue;const a=[];for(let t=0;t<s.length;t++){const n=s.key(t);if(n)for(const t of e)if(n.includes(t)){a.push(n);break}}for(const e of a)s.removeItem(e),t++}}catch(a){q.error("StorageService.cleanup failed","StorageService",a,{keyPatterns:e})}return t}};const ce=new class{storageKey="pixal-marketplace-cart";cart=[];listeners=[];constructor(){this.loadCart()}loadCart(){try{this.cart=le.getJSON(this.storageKey,[])}catch(e){W.logError("CartService.loadCart",e),this.cart=[]}}saveCart(){try{le.setJSON(this.storageKey,this.cart)||W.logError("CartService.saveCart",new Error("Failed to save cart to storage"),{storageKey:this.storageKey,cartSize:this.cart.length}),this.notifyListeners()}catch(e){W.logError("CartService.saveCart",e,{storageKey:this.storageKey,cartSize:this.cart.length})}}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.listeners.forEach(e=>e([...this.cart]))}addToCart(e){if(-1!==this.cart.findIndex(t=>t.nft.asset_id===e.asset_id))return!1;const t={nft:e,addedAt:Date.now(),isAvailable:!0,sale_id:e.sale_id};return this.cart.push(t),this.saveCart(),!0}removeFromCart(e){const t=this.cart.length;return this.cart=this.cart.filter(t=>t.nft.asset_id!==e),this.cart.length!==t&&(this.saveCart(),!0)}isInCart(e){return this.cart.some(t=>t.nft.asset_id===e)}getCart(){return[...this.cart]}getCartCount(){return this.cart.length}clearCart(){this.cart=[],this.saveCart()}cleanupUnavailableItems(){const e=this.cart.length;this.cart=this.cart.filter(e=>!1!==e.isAvailable),this.cart.length!==e&&this.saveCart()}async calculateTotals(){const e=this.cart.filter(e=>!1!==e.isAvailable);let t=0;e.forEach(e=>{if(e.nft.price){const a=parseFloat(e.nft.price.replace(" WAX",""));isNaN(a)||(t+=a)}});const a=`${t.toFixed(4)} WAX`;return{totalWAX:a,totalUSD:await ie.convertWaxToUSDAsync(a),itemCount:e.length}}async checkAvailability(){if(0===this.cart.length)return;const{apiService:e}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0);try{const t=this.cart.map(e=>e.sale_id).filter(Boolean);if(0===t.length)return;const a=`${e.atomicMarketAPI}/atomicmarket/v1/sales?ids=${t.join(",")}&state=1&limit=${t.length}`,s=await e.fetchWithRetry(a),n=await s.json(),i=new Set(n.success&&n.data?n.data.map(e=>e.sale_id):[]);for(const e of this.cart)e.isAvailable=!!e.sale_id&&i.has(e.sale_id)}catch(t){W.logError("CartService.checkAvailability",t,{cartSize:this.cart.length});for(const e of this.cart)e.isAvailable=!1}this.saveCart()}toggleSelection(e){const t=this.cart.find(t=>t.nft.asset_id===e);t&&(t.selected=!t.selected,this.saveCart())}selectAll(){this.cart.forEach(e=>{!1!==e.isAvailable&&(e.selected=!0)}),this.saveCart()}deselectAll(){this.cart.forEach(e=>{e.selected=!1}),this.saveCart()}getSelectedItems(){return this.cart.filter(e=>!0===e.selected)}getSelectedCount(){return this.cart.filter(e=>!0===e.selected).length}removeSelectedItems(){this.cart=this.cart.filter(e=>!0!==e.selected),this.saveCart()}isSelected(e){const t=this.cart.find(t=>t.nft.asset_id===e);return!0===t?.selected}},oe=a.createContext(void 0),de=({children:e})=>{const[t,s]=a.useState(()=>({showOtherCollections:JSON.parse(localStorage.getItem("showOtherCollections")||"true"),showWhitelistedOnly:JSON.parse(localStorage.getItem("showWhitelistedOnly")||"true"),enableAnimatedNFTs:JSON.parse(localStorage.getItem("enableAnimatedNFTs")||"true"),showExplicitContent:JSON.parse(localStorage.getItem("showExplicitContent")||"false"),blockNSFW:JSON.parse(localStorage.getItem("blockNSFW")||"false"),blockAI:JSON.parse(localStorage.getItem("blockAI")||"false"),showChatButton:JSON.parse(localStorage.getItem("showChatButton")||"true"),autoPlayVideos:JSON.parse(localStorage.getItem("autoPlayVideos")||"false"),muteVideos:JSON.parse(localStorage.getItem("muteVideos")||"true"),showVideoControls:JSON.parse(localStorage.getItem("showVideoControls")||"true"),showPricesInUSD:JSON.parse(localStorage.getItem("showPricesInUSD")||"true"),selectedCurrency:localStorage.getItem("selectedCurrency")||"USD",showRarityRankings:JSON.parse(localStorage.getItem("showRarityRankings")||"true")})),n={settings:t,updateSetting:(e,t)=>{s(a=>{const s={...a,[e]:t};return"string"==typeof t?localStorage.setItem(e,t):localStorage.setItem(e,JSON.stringify(t)),s})}};return A.jsx(oe.Provider,{value:n,children:e})},ue=()=>{const e=a.useContext(oe);if(void 0===e)throw new Error("useDisplaySettings must be used within a DisplaySettingsProvider");return e};const me=new class{sessionId;userId;session;performanceMetrics=[];apiMetrics=[];errorReports=[];isEnabled=!0;batchSize=50;flushInterval=3e4;maxStoredMetrics=1e3;pendingBatches=[];batchTimeout=null;constructor(){this.sessionId=this.generateSessionId(),this.session={sessionId:this.sessionId,startTime:Date.now(),lastActivity:Date.now(),pageViews:0,events:[]},this.initializeMonitoring(),this.startPerformanceObserver(),this.setupErrorHandlers(),this.startFlushTimer()}generateSessionId(){return`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}initializeMonitoring(){"undefined"!=typeof window&&window.performance&&(window.addEventListener("load",()=>{setTimeout(()=>{this.trackPageLoadPerformance()},0)}),document.addEventListener("visibilitychange",()=>{this.trackEvent("page_visibility_change",{hidden:document.hidden})}),this.setupUserInteractionTracking())}startPerformanceObserver(){if("undefined"!=typeof window&&"PerformanceObserver"in window)try{new PerformanceObserver(e=>{for(const t of e.getEntries())"navigation"===t.entryType&&this.trackNavigationTiming(t)}).observe({entryTypes:["navigation"]});new PerformanceObserver(e=>{for(const t of e.getEntries())"resource"===t.entryType&&this.trackResourceTiming(t)}).observe({entryTypes:["resource"]});new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformanceMetric("largest_contentful_paint",t.startTime)}).observe({entryTypes:["largest-contentful-paint"]});new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformanceMetric("first_input_delay",t.processingStart-t.startTime)}).observe({entryTypes:["first-input"]})}catch(e){console.warn("Performance Observer not fully supported:",e)}}setupErrorHandlers(){"undefined"!=typeof window&&(window.addEventListener("error",e=>{this.reportError(e.error||new Error(e.message),"global_error",{filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{this.reportError(e.reason instanceof Error?e.reason:new Error(String(e.reason)),"unhandled_promise_rejection")}))}setupUserInteractionTracking(){"undefined"!=typeof window&&(document.addEventListener("click",e=>{const t=e.target;t.matches('button, a, [role="button"], .clickable')&&this.trackEvent("user_click",{element:t.tagName.toLowerCase(),className:t.className,id:t.id,text:t.textContent?.slice(0,50)})}),document.addEventListener("submit",e=>{const t=e.target;this.trackEvent("form_submit",{formId:t.id,formClass:t.className,action:t.action})}))}startFlushTimer(){setInterval(()=>{this.flushMetrics()},this.flushInterval)}setUserId(e){this.userId=e,this.session.userId=e}trackEvent(e,t={}){if(!this.isEnabled)return;const a={event:e,properties:t,timestamp:Date.now(),userId:this.userId,sessionId:this.sessionId};this.session.events.push(a),this.session.lastActivity=Date.now(),this.addToBatch("events",a),this.session.events.length>this.maxStoredMetrics&&(this.session.events=this.session.events.slice(-this.maxStoredMetrics/2))}trackPerformanceMetric(e,t,a){if(!this.isEnabled)return;const s={name:e,value:t,timestamp:Date.now(),context:a};this.performanceMetrics.push(s),this.addToBatch("performance",s),this.performanceMetrics.length>this.maxStoredMetrics&&(this.performanceMetrics=this.performanceMetrics.slice(-this.maxStoredMetrics/2))}trackAPICall(e,t,a,s,n,i){if(!this.isEnabled)return;const r={endpoint:e,method:t,duration:a,status:s,timestamp:Date.now(),success:n,retryCount:i};this.apiMetrics.push(r),this.addToBatch("api",r),a>5e3&&this.trackPerformanceMetric("slow_api_call",a,{endpoint:e,method:t,status:s}),this.apiMetrics.length>this.maxStoredMetrics&&(this.apiMetrics=this.apiMetrics.slice(-this.maxStoredMetrics/2))}reportError(e,t,a){if(!this.isEnabled)return;W.logError(t,e,a);const s={error:e,context:t,additionalInfo:a,timestamp:Date.now(),userId:this.userId,sessionId:this.sessionId,userAgent:navigator.userAgent,url:window.location.href,stackTrace:e.stack};this.errorReports.push(s),this.trackEvent("error_occurred",{context:t,errorName:e.name,errorMessage:e.message,...a}),this.errorReports.length>this.maxStoredMetrics&&(this.errorReports=this.errorReports.slice(-this.maxStoredMetrics/2))}trackPageLoadPerformance(){if(!window.performance||!window.performance.timing)return;const e=window.performance.timing,t=window.performance.navigation,a=e.loadEventEnd-e.navigationStart,s=e.domContentLoadedEventEnd-e.navigationStart,n=e.responseStart-e.navigationStart,i=e.domInteractive-e.navigationStart;this.trackPerformanceMetric("page_load_time",a),this.trackPerformanceMetric("dom_content_loaded_time",s),this.trackPerformanceMetric("first_byte_time",n),this.trackPerformanceMetric("dom_interactive_time",i),this.trackEvent("page_load",{pageLoadTime:a,domContentLoadedTime:s,firstByteTime:n,domInteractiveTime:i,navigationType:t.type,redirectCount:t.redirectCount})}trackNavigationTiming(e){this.trackPerformanceMetric("dns_lookup_time",e.domainLookupEnd-e.domainLookupStart),this.trackPerformanceMetric("tcp_connect_time",e.connectEnd-e.connectStart),this.trackPerformanceMetric("request_response_time",e.responseEnd-e.requestStart),this.trackPerformanceMetric("dom_processing_time",e.domComplete-e.domContentLoadedEventStart)}trackResourceTiming(e){(e.name.includes(".js")||e.name.includes(".css")||e.name.includes("api"))&&this.trackPerformanceMetric("resource_load_time",e.duration,{resource:e.name,type:e.initiatorType,size:e.transferSize})}getSessionSummary(){return{...this.session,events:[...this.session.events]}}getPerformanceMetrics(){return[...this.performanceMetrics]}getAPIMetrics(){return[...this.apiMetrics]}getErrorReports(){return[...this.errorReports]}async flushMetrics(){if(!this.isEnabled)return;const e={session:this.getSessionSummary(),performance:this.getPerformanceMetrics(),api:this.getAPIMetrics(),errors:this.getErrorReports(),timestamp:Date.now()};try{const t=JSON.parse(localStorage.getItem("monitoring_data")||"[]");t.push(e);const a=t.slice(-10);localStorage.setItem("monitoring_data",JSON.stringify(a))}catch(t){console.warn("Failed to store monitoring data:",t)}this.performanceMetrics=[],this.apiMetrics=[],this.errorReports=[],this.session.events=[]}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}isMonitoringEnabled(){return this.isEnabled}setBatchSize(e){this.batchSize=Math.max(10,Math.min(e,200))}addToBatch(e,t){if(!this.isEnabled)return;let a=this.pendingBatches.find(t=>t.type===e);a||(a={type:e,data:[],timestamp:Date.now()},this.pendingBatches.push(a)),a.data.push(t),a.data.length>=this.batchSize&&(this.processBatch(a),this.pendingBatches=this.pendingBatches.filter(e=>e!==a)),this.scheduleBatchProcessing()}scheduleBatchProcessing(){this.batchTimeout&&clearTimeout(this.batchTimeout),this.batchTimeout=setTimeout(()=>{this.processAllPendingBatches()},5e3)}async processBatch(e){try{const t={...e,batchId:this.generateBatchId(),processedAt:Date.now()},a=JSON.parse(localStorage.getItem("monitoring_batches")||"[]");a.push(t);const s=a.slice(-20);localStorage.setItem("monitoring_batches",JSON.stringify(s)),console.log(`Processed batch of ${e.data.length} ${e.type} items`)}catch(t){console.warn("Failed to process batch:",t)}}async processAllPendingBatches(){const e=[...this.pendingBatches];this.pendingBatches=[];for(const t of e)await this.processBatch(t);this.batchTimeout&&(clearTimeout(this.batchTimeout),this.batchTimeout=null)}generateBatchId(){return`batch_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}setFlushInterval(e){this.flushInterval=Math.max(5e3,Math.min(e,3e5))}async exportData(){const e={session:this.getSessionSummary(),performance:this.getPerformanceMetrics(),api:this.getAPIMetrics(),errors:this.getErrorReports()};return JSON.stringify(e,null,2)}clearAllData(){this.performanceMetrics=[],this.apiMetrics=[],this.errorReports=[],this.session.events=[],localStorage.removeItem("monitoring_data")}};class he{cache=new Map;config;cleanupTimer=null;constructor(e={}){this.config={defaultTTL:3e5,maxSize:1e3,cleanupInterval:6e4,...e},this.startCleanup()}startCleanup(){this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}cleanup(){const e=Date.now(),t=[];for(const[a,s]of this.cache.entries())e-s.timestamp>s.ttl&&t.push(a);if(t.forEach(e=>this.cache.delete(e)),this.cache.size>this.config.maxSize){Array.from(this.cache.entries()).sort(([,e],[,t])=>e.timestamp-t.timestamp).slice(0,this.cache.size-this.config.maxSize).forEach(([e])=>this.cache.delete(e))}}set(e,t,a){const s={data:t,timestamp:Date.now(),ttl:a||this.config.defaultTTL};this.cache.set(e,s)}get(e){const t=this.cache.get(e);if(!t)return null;return Date.now()-t.timestamp>t.ttl?(this.cache.delete(e),null):t.data}has(e){const t=this.cache.get(e);if(!t)return!1;return!(Date.now()-t.timestamp>t.ttl)||(this.cache.delete(e),!1)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}async getOrFetch(e,t,a){const s=this.get(e);if(null!==s)return s;const n=await t();return this.set(e,n,a),n}setMany(e){e.forEach(({key:e,data:t,ttl:a})=>{this.set(e,t,a)})}getMany(e){return e.map(e=>({key:e,data:this.get(e)}))}getStats(){const e=Date.now();let t=0,a=0;for(const s of this.cache.values())e-s.timestamp>s.ttl?a++:t++;return{totalEntries:this.cache.size,validEntries:t,expiredEntries:a,hitRate:t/(t+a)||0}}destroy(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null),this.clear()}}const pe=new he({defaultTTL:3e5,maxSize:1e3,cleanupInterval:6e4}),fe=new he({defaultTTL:6e5,maxSize:500,cleanupInterval:12e4}),xe=new he({defaultTTL:18e5,maxSize:200,cleanupInterval:3e5}),ge=new he({defaultTTL:12e4,maxSize:100,cleanupInterval:3e4});const ve=new class{endpointGroups=new Map;HEALTH_CHECK_TIMEOUT=5e3;MAX_CONSECUTIVE_FAILURES=3;HEALTH_CHECK_INTERVAL=3e5;healthCheckTimers=new Map;constructor(){this.initializeEndpointGroups(),this.startHealthChecks()}initializeEndpointGroups(){this.endpointGroups.set("atomic",{name:"atomic",currentIndex:0,fallbackStrategy:"priority",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://atomic.wax.eosrio.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax-atomic.alcor.exchange",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://atomic-wax-mainnet.wecan.dev",priority:3,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax.eosusa.io",priority:4,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3}]}),this.endpointGroups.set("waxChain",{name:"waxChain",currentIndex:0,fallbackStrategy:"priority",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://wax.eosphere.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://wax.eosrio.io",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3},{url:"https://api.wax.alohaeos.com",priority:3,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:3}]}),this.endpointGroups.set("hyperion",{name:"hyperion",currentIndex:0,fallbackStrategy:"fastest",healthCheckInterval:this.HEALTH_CHECK_INTERVAL,endpoints:[{url:"https://wax.eosrio.io",priority:1,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:2},{url:"https://api.wax.alohaeos.com",priority:2,healthStatus:"healthy",lastHealthCheck:0,consecutiveFailures:0,averageResponseTime:0,maxRetries:2}]})}getBestEndpoint(e){const t=this.endpointGroups.get(e);if(!t)return null;const a=t.endpoints.filter(e=>"healthy"===e.healthStatus);if(0===a.length){const e=t.endpoints.filter(e=>"degraded"===e.healthStatus);return e.length>0?this.selectEndpoint(e,t.fallbackStrategy):t.endpoints[0]?.url||null}return this.selectEndpoint(a,t.fallbackStrategy)}selectEndpoint(e,t){switch(t){case"priority":return e.sort((e,t)=>e.priority-t.priority)[0].url;case"fastest":return e.sort((e,t)=>e.averageResponseTime-t.averageResponseTime)[0].url;default:return e[Math.floor(Math.random()*e.length)].url}}reportFailure(e,t){const a=this.endpointGroups.get(e);if(!a)return;const s=a.endpoints.find(e=>e.url===t);s&&(s.consecutiveFailures++,s.consecutiveFailures>=this.MAX_CONSECUTIVE_FAILURES?s.healthStatus="unhealthy":s.consecutiveFailures>=1&&(s.healthStatus="degraded"))}reportSuccess(e,t,a){const s=this.endpointGroups.get(e);if(!s)return;const n=s.endpoints.find(e=>e.url===t);n&&(n.consecutiveFailures=0,n.healthStatus="healthy",0===n.averageResponseTime?n.averageResponseTime=a:n.averageResponseTime=.8*n.averageResponseTime+.2*a)}getEndpoints(e){const t=this.endpointGroups.get(e);return t?t.endpoints.map(e=>e.url):[]}getCurrentIndex(e){const t=this.endpointGroups.get(e);return t?t.currentIndex:0}setCurrentIndex(e,t){const a=this.endpointGroups.get(e);a&&t>=0&&t<a.endpoints.length&&(a.currentIndex=t)}startHealthChecks(){for(const[e,t]of this.endpointGroups){const a=setInterval(()=>{this.performHealthCheck(e)},t.healthCheckInterval);this.healthCheckTimers.set(e,a)}}async performHealthCheck(e){const t=this.endpointGroups.get(e);if(!t)return;const a=t.endpoints.map(async t=>{try{const a=Date.now(),s=new AbortController,n=setTimeout(()=>s.abort(),this.HEALTH_CHECK_TIMEOUT),i=await fetch(`${t.url}/health`,{method:"GET",signal:s.signal,headers:{Accept:"application/json"}});clearTimeout(n);const r=Date.now()-a;t.lastHealthCheck=Date.now(),i.ok?this.reportSuccess(e,t.url,r):this.reportFailure(e,t.url)}catch{t.lastHealthCheck=Date.now(),this.reportFailure(e,t.url)}});await Promise.allSettled(a)}getHealthStatus(){const e={};for(const[t,a]of this.endpointGroups)e[t]={healthy:a.endpoints.filter(e=>"healthy"===e.healthStatus).length,degraded:a.endpoints.filter(e=>"degraded"===e.healthStatus).length,unhealthy:a.endpoints.filter(e=>"unhealthy"===e.healthStatus).length};return e}destroy(){for(const e of this.healthCheckTimers.values())clearInterval(e);this.healthCheckTimers.clear()}};const ye=new class{atomicEndpoints=[...te.ATOMIC_ASSETS];hiveBPAPI=te.WAX_CHAIN.HIVEBP;waxLightAPI=te.WAX_CHAIN.LIGHT_API;alcorAPI=te.SPECIALIZED.ALCOR;waxChainEndpoints=[...te.WAX_CHAIN.FALLBACK_ENDPOINTS];hyperionEndpoints=te.WAX_CHAIN.HYPERION_ENDPOINTS;currentEndpointIndex=0;currentWaxChainIndex=0;currentHyperionIndex=0;adaptiveLimits=new Map;DEFAULT_CACHE_TTL=3e5;get waxChainAPI(){return ve.getBestEndpoint("waxChain")||this.waxChainEndpoints[this.currentWaxChainIndex]}get atomicMarketAPI(){return this.atomicEndpoints[this.currentEndpointIndex]}get atomicAssetsAPI(){return this.atomicEndpoints[this.currentEndpointIndex]}getCurrentAtomicEndpoint(){const e=ve.getBestEndpoint("atomic");if(e)return e;const t=this.getHealthyEndpoints(this.atomicEndpoints);if(t.length>0){const e=t[0];return this.currentEndpointIndex=this.atomicEndpoints.indexOf(e),e}return this.atomicEndpoints[this.currentEndpointIndex]||this.atomicEndpoints[0]}getFromCache(e){return e.startsWith("asset_")?fe.get(e):e.startsWith("collection_")?xe.get(e):e.startsWith("user_")?ge.get(e):pe.get(e)}setCache(e,t,a=this.DEFAULT_CACHE_TTL){e.startsWith("asset_")?fe.set(e,t,a):e.startsWith("collection_")?xe.set(e,t,a):e.startsWith("user_")?ge.set(e,t,a):pe.set(e,t,a)}reportEndpointHealth(e,t,a){try{const s=new URL(e),n=`${s.protocol}//${s.host}`;let i="atomic";(e.includes("wax.eosphere.io")||e.includes("wax.eosrio.io")||e.includes("api.wax.alohaeos.com"))&&(i=e.includes("/v2/history")||e.includes("/v1/history")?"hyperion":"waxChain"),t&&void 0!==a?ve.reportSuccess(i,n,a):t||ve.reportFailure(i,n)}catch(s){console.warn("Failed to report endpoint health:",s)}}getCacheStats(){const e=fe.getStats(),t=xe.getStats(),a=ge.getStats(),s=pe.getStats();return{totalEntries:e.totalEntries+t.totalEntries+a.totalEntries+s.totalEntries,validEntries:e.validEntries+t.validEntries+a.validEntries+s.validEntries,expiredEntries:e.expiredEntries+t.expiredEntries+a.expiredEntries+s.expiredEntries,hitRate:(e.hitRate+t.hitRate+a.hitRate+s.hitRate)/4}}clearCache(){fe.clear(),xe.clear(),ge.clear(),pe.clear()}async warmupCache(e){try{const t=[],a=this.approvedCollections.slice(0,5);for(const e of a)t.push(this.getCollectionStats(e).catch(t=>W.logError("ApiService.warmupCache.collectionStats",t,{collection:e})));t.push(this.getMarketStats().catch(e=>W.logError("ApiService.warmupCache.marketStats",e))),e&&t.push(this.getUserInventoryOverview(e).catch(t=>W.logError("ApiService.warmupCache.userInventory",t,{account:e}))),await Promise.allSettled(t)}catch(t){W.logError("ApiService.warmupCache",t)}}async prefetchData(e){try{const t=[];if("marketplace"===e.currentPage&&t.push(this.getPxApprovedListings(100,100).catch(e=>W.logError("ApiService.prefetch.marketplaceAssets",e))),"inventory"===e.currentPage&&e.userAccount&&t.push(this.getUserInventoryOptimized(e.userAccount,{page:2}).catch(t=>W.logError("ApiService.prefetch.userInventory",t,{account:e.userAccount}))),e.recentCollections)for(const a of e.recentCollections.slice(0,3))t.push(this.getCollectionStats(a).catch(e=>W.logError("ApiService.prefetch.recentCollection",e,{collection:a})));setTimeout(()=>{Promise.allSettled(t)},1e3)}catch(t){W.logError("ApiService.prefetchData",t)}}invalidateCache(e){fe.clear(),xe.clear(),ge.clear(),pe.clear()}getAdaptiveLimit(e,t){const a=new URL(e).hostname,s=this.adaptiveLimits.get(a);return s?Math.min(t,s,100):Math.min(t,100)}updateAdaptiveLimit(e,t,a){const s=new URL(e).hostname;if(a){if(t<100){const e=this.adaptiveLimits.get(s)||t,a=Math.min(Math.floor(1.1*e),100);this.adaptiveLimits.set(s,a)}}else{const e=Math.max(Math.floor(.7*t),20);this.adaptiveLimits.set(s,e)}}approvedCollections=["pixeljourney","friedfactory"];constructor(){this.currentEndpointIndex=0,this.currentWaxChainIndex=0,this.currentHyperionIndex=0,this.initializeHealthConfigs()}async fetchAlcorAPI(e,t=3,a){let s=null;const n=Date.now(),i=a?.method||"GET";for(let l=0;l<t;l++)try{const r=await fetch(e,{method:i,headers:{Accept:"application/json","Content-Type":"application/json",...a?.headers},mode:"cors",signal:a?.signal,...a}),c=Date.now()-n;if(r.ok)return me.trackAPICall(e,i,c,r.status,!0,l),r;s=new Error(`HTTP ${r.status}: ${r.statusText}`),l<t-1?await new Promise(e=>setTimeout(e,1e3*(l+1))):me.trackAPICall(e,i,c,r.status,!1,l)}catch(r){const a=Date.now()-n;if(s=r,l===t-1&&(me.trackAPICall(e,i,a,0,!1,l),me.reportError(s,"alcor_api_error",{url:e,method:i,retries:l+1})),r instanceof Error&&"AbortError"===r.name)throw me.reportError(r,"alcor_api_abort",{url:e,method:i}),r;l<t-1&&await new Promise(e=>setTimeout(e,1e3*(l+1)))}throw s||new Error("Failed to fetch from Alcor Exchange API")}circuitBreakerState=new Map;CIRCUIT_BREAKER_THRESHOLD=5;CIRCUIT_BREAKER_TIMEOUT=6e4;MAX_TIMEOUT=3e4;endpointHealth=new Map;HEALTH_CHECK_INTERVAL=3e5;MAX_CONSECUTIVE_FAILURES=3;healthCheckIntervalId=null;healthConfigs=new Map;initializeHealthConfigs(){this.healthConfigs.clear(),this.getValidatedEndpoints("atomic").forEach(e=>{this.healthConfigs.set(e,{path:"/atomicassets/v1/collections?limit=1",validator:e=>{const t=e;return Array.isArray(t.data)&&!0===t.success}})}),this.getValidatedEndpoints("waxChain").forEach(e=>{this.healthConfigs.set(e,{path:"/v1/chain/get_info",validator:e=>{const t=e;return"number"==typeof t.head_block_num&&t.head_block_num>0}})}),this.getValidatedEndpoints("hyperion").forEach(e=>{this.healthConfigs.set(e,{path:"/v2/health",validator:e=>{const t=e;return t.health&&"object"==typeof t.health&&"OK"===t.health.status||"OK"===t.health}})}),console.log(`[Health Config] Initialized configurations for ${this.healthConfigs.size} endpoints`)}eosNationEndpoints={atomicEndpoints:[],waxChainEndpoints:[],hyperionEndpoints:[],lastUpdated:0};EOS_NATION_UPDATE_INTERVAL=36e5;getCircuitBreakerKey(e){try{return new URL(e).hostname}catch{return e}}isCircuitBreakerOpen(e){const t=this.circuitBreakerState.get(e);return!!t&&("open"===t.state&&(!(Date.now()-t.lastFailure>this.CIRCUIT_BREAKER_TIMEOUT)||(t.state="half-open",!1)))}recordCircuitBreakerFailure(e){const t=this.circuitBreakerState.get(e)||{failures:0,lastFailure:0,state:"closed"};t.failures++,t.lastFailure=Date.now(),t.failures>=this.CIRCUIT_BREAKER_THRESHOLD&&(t.state="open"),this.circuitBreakerState.set(e,t)}recordCircuitBreakerSuccess(e){const t=this.circuitBreakerState.get(e);t&&(t.failures=0,t.state="closed",this.circuitBreakerState.set(e,t))}updateEndpointHealth(e,t,a){let s=this.endpointHealth.get(e);s||(s={isHealthy:!0,lastCheck:Date.now(),consecutiveFailures:0,responseTime:0},this.endpointHealth.set(e,s)),s.lastCheck=Date.now(),t?(s.consecutiveFailures=0,s.isHealthy=!0,s.responseTime=a):(s.consecutiveFailures++,s.consecutiveFailures>=this.MAX_CONSECUTIVE_FAILURES&&(s.isHealthy=!1)),this.endpointHealth.set(e,s)}isEndpointHealthy(e){const t=this.endpointHealth.get(e);if(!t)return!0;return!(Date.now()-t.lastCheck>2*this.HEALTH_CHECK_INTERVAL)&&t.isHealthy}async performHealthCheck(e){const t=this.getCircuitBreakerKey(e),a=this.healthConfigs.get(e)||{path:"",fallback:!0},s=a.path?`${e}${a.path}`:e;try{const n=Date.now(),i=await fetch(s,{method:a.path?"GET":"HEAD",signal:AbortSignal.timeout(1e4),headers:{Accept:"application/json"}});let r=i.ok;const l=Date.now()-n;if(i.ok&&a.validator){const s=await i.json();r=a.validator(s);const n=this.endpointHealth.get(t);(!r||n&&n.consecutiveFailures>0)&&console.log(`[HealthCheck] ${e}:`,{healthy:r,duration:`${l}ms`})}this.updateEndpointHealth(t,r,l),r||console.warn(`[HealthCheck] ${e} failed validation`)}catch(n){console.error(`[HealthCheck] ${e} error:`,n),this.updateEndpointHealth(t,!1,0)}}startHealthChecks(){this.healthCheckIntervalId&&(clearInterval(this.healthCheckIntervalId),this.healthCheckIntervalId=null),this.healthCheckIntervalId=setInterval(()=>{console.log("[HealthCheck] Starting periodic health check cycle..."),this.getValidatedEndpoints("atomic").forEach(e=>{this.performHealthCheck(e)}),this.getValidatedEndpoints("waxChain").forEach(e=>{this.performHealthCheck(e)}),this.getValidatedEndpoints("hyperion").forEach(e=>{this.performHealthCheck(e)}),console.log("[HealthCheck] Completed periodic health check cycle")},this.HEALTH_CHECK_INTERVAL),this.updateEosNationEndpoints()}stopHealthChecks(){this.healthCheckIntervalId&&(clearInterval(this.healthCheckIntervalId),this.healthCheckIntervalId=null,console.log("[HealthCheck] Health check interval stopped"))}enableHealthChecks(){console.log("[HealthCheck] Enabling health checks..."),this.startHealthChecks()}async updateEosNationEndpoints(){try{const e=Date.now();if(e-this.eosNationEndpoints.lastUpdated<this.EOS_NATION_UPDATE_INTERVAL)return;console.log("[EOS Nation] Fetching latest endpoint data...");const t=await fetch("https://validate.eosnation.io/wax/reports/endpoints.json",{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(1e4)});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const a=await t.json();if(!a||"object"!=typeof a)throw new Error("Invalid JSON response from EOS Nation API");if(!a.report||"object"!=typeof a.report)throw console.warn("[EOS Nation] No report data found in response:",a),new Error("Invalid response format from EOS Nation API");const s=a.report,n=this.parseEosNationEndpoints(s.atomic_https||[]),i=this.parseEosNationEndpoints(s.api_https2||[]),r=this.parseEosNationEndpoints(s.hyperion_https||[]);console.log("[EOS Nation] Raw endpoint counts:",{atomic_https:Array.isArray(s.atomic_https)?s.atomic_https.length:"not array",api_https2:Array.isArray(s.api_https2)?s.api_https2.length:"not array",hyperion_https:Array.isArray(s.hyperion_https)?s.hyperion_https.length:"not array"}),this.eosNationEndpoints={atomicEndpoints:n,waxChainEndpoints:i,hyperionEndpoints:r,lastUpdated:e},console.log(`[EOS Nation] Updated endpoints: ${n.length} atomic, ${i.length} wax chain, ${r.length} hyperion`),this.initializeHealthConfigs(),setTimeout(()=>this.updateEosNationEndpoints(),this.EOS_NATION_UPDATE_INTERVAL)}catch(e){console.error("[EOS Nation] Failed to update endpoint data:",e),setTimeout(()=>this.updateEosNationEndpoints(),6e5)}}parseEosNationEndpoints(e){return Array.isArray(e)?e.map(e=>{try{let t;if("string"==typeof e)t=e;else if("object"==typeof e&&null!==e){const a=e;t=a.url||a.endpoint||a.api_url||String(e)}else t=String(e);const a=t.trim().match(/https?:\/\/[^\s]+/);return a?a[0]:null}catch(t){return console.warn("[EOS Nation] Failed to parse endpoint:",e,t),null}}).filter(e=>null!==e).filter(e=>{try{return new URL(e),!0}catch{return!1}}):(console.warn("[EOS Nation] Expected array of endpoints, got:",typeof e),[])}getValidatedEndpoints(e){const t="atomic"===e?this.atomicEndpoints:"waxChain"===e?this.waxChainEndpoints:this.hyperionEndpoints,a="atomic"===e?this.eosNationEndpoints.atomicEndpoints:"waxChain"===e?this.eosNationEndpoints.waxChainEndpoints:this.eosNationEndpoints.hyperionEndpoints,s=[...new Set([...a,...t])];return console.log(`[Endpoint Selection] ${e}: ${s.length} total (${a.length} from EOS Nation, ${t.length} static)`),s}getHealthyEndpoints(e){return e.filter(e=>{const t=this.getCircuitBreakerKey(e);return this.isEndpointHealthy(t)&&!this.isCircuitBreakerOpen(t)})}classifyError(e,t){if(t){if(429===t)return"rate-limit";if(408===t||502===t||503===t||504===t)return"retryable";if(t>=400&&t<500)return"non-retryable";if(t>=500)return"retryable"}const a=e.message.toLowerCase();return a.includes("rate limit")||a.includes("429")||a.includes("too many requests")?"rate-limit":a.includes("timeout")||a.includes("network")||a.includes("connection")||a.includes("fetch")||a.includes("enotfound")||a.includes("econnreset")||a.includes("econnrefused")||a.includes("socket hang up")||"AbortError"===e.name?"retryable":a.includes("400")||a.includes("401")||a.includes("403")||a.includes("404")||a.includes("unauthorized")||a.includes("forbidden")||a.includes("not found")||a.includes("bad request")?"non-retryable":"retryable"}calculateDelay(e,t,a=!0){let s;if(s="rate-limit"===t?Math.min(1e3*Math.pow(2,e),this.MAX_TIMEOUT):Math.min(1e3*(e+1),5e3),a){const e=.1*s;s+=2*(Math.random()-.5)*e}return Math.max(s,100)}async fetchWithRetry(e,t=3,a){const s=this.getCircuitBreakerKey(e);let n=null;const i=Date.now();if(this.isCircuitBreakerOpen(s))throw new Error(`Circuit breaker is open for ${s}. Service temporarily unavailable.`);const r=a?.signal?void 0:15e3,l=new AbortController;let c;r&&!a?.signal&&(c=setTimeout(()=>l.abort(),r));const o={method:a?.method||"GET",headers:{Accept:"application/json","Content-Type":"application/json","User-Agent":"PxMarket/2.0",...a?.headers},mode:"cors",signal:a?.signal||l.signal,...a};try{if(e.includes("wax-api.hivebp.io")){for(let a=0;a<t;a++)try{const r=await fetch(e,o);if(r.ok){this.recordCircuitBreakerSuccess(s);const t=Date.now()-i;return this.reportEndpointHealth(e,!0,t),r}const l=this.classifyError(new Error(`HTTP ${r.status}`),r.status);if(n=new Error(`HTTP ${r.status}: ${r.statusText}`),"non-retryable"===l||a===t-1)break;const c=this.calculateDelay(a,l);await new Promise(e=>setTimeout(e,c))}catch(d){const e=d,s=this.classifyError(e);if(n=e,"non-retryable"===s||a===t-1)break;const i=this.calculateDelay(a,s);await new Promise(e=>setTimeout(e,i))}throw this.recordCircuitBreakerFailure(s),n||new Error("Failed to fetch from HiveBP API")}if(this.waxChainEndpoints.some(t=>e.includes(t))){const a=this.getHealthyEndpoints(this.waxChainEndpoints),s=a.length>0?a:this.waxChainEndpoints;for(let i=0;i<s.length;i++){const a=s[i];this.currentWaxChainIndex=this.waxChainEndpoints.indexOf(a);const r=e.replace(/https:\/\/[^/]+/,a),l=this.getCircuitBreakerKey(r);if(this.isCircuitBreakerOpen(l))continue;let c=!1;for(let e=0;e<t;e++)try{const a=await fetch(r,o);if(a.ok)return this.recordCircuitBreakerSuccess(l),c=!0,a;const s=this.classifyError(new Error(`HTTP ${a.status}`),a.status);if(n=new Error(`HTTP ${a.status}: ${a.statusText}`),400===a.status||"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}catch(d){const a=d,s=this.classifyError(a);if(n=a,"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}c||this.recordCircuitBreakerFailure(l)}throw n||new Error("All WAX Chain endpoints failed")}const a=this.getHealthyEndpoints(this.atomicEndpoints),r=a.length>0?a:this.atomicEndpoints;for(let s=0;s<r.length;s++){const a=r[s];this.currentEndpointIndex=this.atomicEndpoints.indexOf(a);const l=e.replace(/https:\/\/[^/]+/,a),c=this.getCircuitBreakerKey(l);if(this.isCircuitBreakerOpen(c))continue;let u=!1;for(let e=0;e<t;e++)try{const a=await fetch(l,o);if(a.ok){this.recordCircuitBreakerSuccess(c),u=!0;const e=Date.now()-i;return this.reportEndpointHealth(l,!0,e),a}const s=this.classifyError(new Error(`HTTP ${a.status}`),a.status);if(n=new Error(`HTTP ${a.status}: ${a.statusText}`),400===a.status||"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}catch(d){const a=d,s=this.classifyError(a);if(n=a,"non-retryable"===s)break;if(e<t-1){const t=this.calculateDelay(e,s);await new Promise(e=>setTimeout(e,t))}}u||this.recordCircuitBreakerFailure(c)}throw n||new Error("All endpoints failed")}finally{c&&clearTimeout(c)}}formatSaleData(e){const t=e.assets[0];return{sale_id:e.sale_id,asset_id:t?.asset_id||"",name:t?.name||`${t?.collection?.collection_name||"Unknown"} #${t?.asset_id||"N/A"}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:e.price?this.formatPrice(e.price):"0 WAX",seller:e.seller,collection:t?.collection?.collection_name||"Unknown",schema:t?.schema?.schema_name||"Unknown",template_mint:t?.template_mint?parseInt(t.template_mint.toString()):void 0,max_supply:t?.template?.max_supply||void 0,traits:t?.data?Object.fromEntries(Object.entries(t.data).filter(([,e])=>null!=e)):{}}}getAssetImage(e){const t=e?.data?.img||e?.template?.immutable_data?.img;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?`${te.IPFS.GATEWAYS[0]}${t}`:t:te.PIXEL_JOURNEY.DEFAULT_IMAGE}getAssetVideo(e){const t=e?.data?.video||e?.template?.immutable_data?.video;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?`${te.IPFS.GATEWAYS[0]}${t}`:t:""}formatPrice(e){if(!e||!e.amount)return"0 WAX";const t=parseFloat(e.amount)/Math.pow(10,e.token_precision||8);return"WAX"!==e.token_symbol&&e.token_symbol?`${B(t)} ${e.token_symbol}`:D(t)}async getCheapestPixals(e=50,t=1){const a=this.atomicMarketAPI,s=this.getAdaptiveLimit(a,e);try{const e=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&sort=price&order=asc&limit=${s}&page=${t}`,n=await this.fetchWithRetry(e),i=await n.json();if(i.success&&i.data)return this.updateAdaptiveLimit(a,s,!0),i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(n){throw this.updateAdaptiveLimit(a,s,!1),W.logError("ApiService.getCheapestPixals",n,{limit:e,adaptiveLimit:s,page:t}),n}}async getWaxRockPixals(e=50,t=1){const a=this.atomicMarketAPI,s=this.getAdaptiveLimit(a,e);try{const{MarketplaceConfigService:e}=await h(async()=>{const{MarketplaceConfigService:e}=await Promise.resolve().then(()=>se);return{MarketplaceConfigService:e}},void 0),i=e.getWaxRockTypes();let r=[];for(const t of i)try{const e=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&immutable_data.WaxRock=${encodeURIComponent(t)}&sort=price&order=asc&limit=50&page=1`,s=await this.fetchWithRetry(e),n=await s.json();n.success&&n.data&&r.push(...n.data)}catch(n){console.warn(`Failed to fetch ${t} WaxRocks:`,n)}if(0===r.length){const s=`${a}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=pixals&sort=price&order=asc&limit=100&page=${t}`,n=await this.fetchWithRetry(s),l=await n.json();l.success&&l.data&&(r=l.data.filter(t=>{if(!t.assets||!t.assets[0])return!1;const a=t.assets[0],s=a.data?.WaxRock||a.template?.immutable_data?.WaxRock;if(s&&"string"==typeof s)return"none"!==s&&e.isValidWaxRock(s);const n=i.map(e=>e.toLowerCase());return!!a.data&&Object.values(a.data).some(e=>{if("string"==typeof e){const t=e.toLowerCase();return"none"!==t&&n.includes(t)}return!1})}))}const l=r.filter((e,t,a)=>t===a.findIndex(t=>t.sale_id===e.sale_id));l.sort((e,t)=>parseFloat(e.listing_price||"0")-parseFloat(t.listing_price||"0"));const c=(t-1)*s,o=l.slice(c,c+s);return this.updateAdaptiveLimit(a,s,!0),o.map(e=>this.formatSaleData(e))}catch(n){throw this.updateAdaptiveLimit(a,s,!1),W.logError("ApiService.getWaxRockPixals",n,{limit:e,adaptiveLimit:s,page:t}),n}}async getPixelIngredients(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=ingredients&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getPixelIngredients",a,{limit:e,page:t}),a}}async getBundleListings(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&schema_name=bundles&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getBundleListings",a,{limit:e,page:t}),a}}async getFriedFactoryNFTs(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=friedfactory&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getFriedFactoryNFTs",a,{limit:e,page:t}),a}}async getCryptoMuffinsNFTs(e=20,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=cryptomuffins&sort=price&order=asc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getCryptoMuffinsNFTs",a,{limit:e,page:t}),a}}async getPartnerListings(e=16,t=1){try{const a=Math.min(e,50),s=ae.getPartnerCollectionsSync().join(","),n=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=${s}&sort=created&order=desc&limit=${a}&page=${t}`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data)return r.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getPartnerListings",a,{limit:e,page:t}),a}}async getPxApprovedListings(e=16,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&collection_name=pixeljourney&sort=created&order=desc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getPxApprovedListings",a,{limit:e,page:t}),a}}async getAHVerifiedListings(e=16,t=1){try{const a=Math.min(e,50),s=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&verified=true&sort=created&order=desc&limit=${a}&page=${t}`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(a){throw W.logError("ApiService.getAHVerifiedListings",a,{limit:e,page:t}),a}}async getAllWaxListings(e=16,t=1){const a=this.atomicMarketAPI,s=this.getAdaptiveLimit(a,e);try{const e=`${a}/atomicmarket/v1/sales?state=1&sort=created&order=desc&limit=${s}&page=${t}`,n=await this.fetchWithRetry(e),i=await n.json();if(i.success&&i.data)return this.updateAdaptiveLimit(a,s,!0),i.data.map(e=>this.formatSaleData(e));throw new Error("Invalid API response")}catch(n){throw this.updateAdaptiveLimit(a,s,!1),W.logError("ApiService.getAllWaxListings",n,{limit:e,adaptiveLimit:s,page:t}),n}}async getRecentSales(e=50){try{const t=`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&limit=${e}&order=desc&sort=updated`,a=await this.fetchWithRetry(t),s=await a.json();if(s.success&&s.data)return s.data;throw new Error("Invalid API response")}catch(t){return W.logError("ApiService.getRecentSales",t,{limit:e}),[]}}async getSales(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="updated",collection_name:i,schema_name:r,template_id:l,asset_id:c,seller:o,buyer:d,state:u="1,3",symbol:m="WAX",min_price:h,max_price:p,before:f,after:x}=e;let g=`${this.atomicMarketAPI}/atomicmarket/v1/sales?page=${t}&limit=${a}&order=${s}&sort=${n}&state=${u}&symbol=${m}`;i&&(g+=`&collection_name=${i}`),r&&(g+=`&schema_name=${r}`),l&&(g+=`&template_id=${l}`),c&&(g+=`&asset_id=${c}`),o&&(g+=`&seller=${o}`),d&&(g+=`&buyer=${d}`),h&&(g+=`&min_price=${h}`),p&&(g+=`&max_price=${p}`),f&&(g+=`&before=${f}`),x&&(g+=`&after=${x}`);const v=await this.fetchWithRetry(g),y=await v.json();return{success:y.success||!1,data:y.data||[],query_total:y.query_total}}catch(t){return W.logError("ApiService.getSales",t,e),{success:!1,data:[]}}}COLLECTION_WHITELIST=["alien.worlds","defiminingio","pixeljourney","crptomuffins","kogsofficial","mlb.topps","gpk.topps","pantheon","cbreakgaming","akufishheads","battleminers","twitchytides","novopangeaio","fadedmonsuta","bcbrawlers","nftopiafrens","drwawncompany","talesofcrypt","official.wax","music.worlds","gkniftyheads","dungeonitems","outlawtroops","byronartset1","prospectorsg","street.hero","crewtoonswax"];async getCollections(e={}){try{const{limit:t=20,page:a=1,whitelistOnly:s=!0,author:n,match:i,order:r="desc",sort:l="created",singleCollection:c}=e,o=new URLSearchParams;if(c)o.append("collection_name",c),o.append("limit","1");else{if(s){const e=this.COLLECTION_WHITELIST.slice(0,Math.min(t,20)).map(async e=>{try{const t=await this.fetchWithRetry(`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}`),a=await t.json();return a.success&&a.data?a.data:null}catch{return null}}),a=await Promise.all(e);return a.filter(e=>null!==e)}o.append("limit",Math.min(t,100).toString()),o.append("page",a.toString()),n&&o.append("author",n),i&&o.append("match",i)}o.append("order",r),o.append("sort",l);const d=`${this.atomicAssetsAPI}/atomicassets/v1/collections?${o.toString()}`,u=await this.fetchWithRetry(d),m=await u.json();if(m.success&&m.data)return m.data;throw new Error("Invalid API response")}catch(t){return W.logError("ApiService.getCollections",t,e),[{collection_name:"pixeljourney",name:"Pixel Journey",img:"",author:"pixeljourney",allow_notify:!0,authorized_accounts:[],notify_accounts:[],market_fee:0,created_at_time:"",created_at_block:""},{collection_name:"friedfactory",name:"Fried Factory",img:"",author:"friedfactory",allow_notify:!0,authorized_accounts:[],notify_accounts:[],market_fee:0,created_at_time:"",created_at_block:""}]}}async getMarketStats(){try{const e=`${this.atomicAssetsAPI}/atomicmarket/v1/stats/graph`,t=await this.fetchWithRetry(e),a=await t.json();return a.success&&a.data&&a.data.length>0?a.data[a.data.length-1]:null}catch(e){return W.logError("ApiService.getMarketStats",e),null}}async getCollectionDetails(e){const t=`collection-${e}`;if(this.isCircuitBreakerOpen(t))return null;try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data:null}catch(a){return this.recordCircuitBreakerFailure(t),this.isCircuitBreakerOpen(t)||W.logError("ApiService.getCollectionDetails",a,{collectionName:e}),null}}async getCollectionSchemas(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/schemas?collection_name=${e}&limit=${t}&order=desc&sort=created`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return W.logError("ApiService.getCollectionAssets",a,{collectionName:e,limit:t}),[]}}async getCollectionTemplates(e,t,a=50){try{let s=`${this.atomicAssetsAPI}/atomicassets/v1/templates?collection_name=${e}&limit=${a}&order=desc&sort=created`;t&&(s+=`&schema_name=${t}`);const n=await this.fetchWithRetry(s),i=await n.json();return i.success&&i.data?i.data:[]}catch(s){return W.logError("ApiService.getCollectionTemplates",s,{collectionName:e,schemaName:t,limit:a}),[]}}async getCollectionAssets(e,t,a,s=50){try{let n=`${this.getCurrentAtomicEndpoint()}/atomicmarket/v1/assets?collection_name=${e}&burned=false&limit=${s}&order=desc&sort=asset_id`;t&&(n+=`&schema_name=${t}`),a&&(n+=`&template_id=${a}`);const i=await this.fetchWithRetry(n),r=await i.json();return r.success&&r.data?r.data:[]}catch(n){return W.logError("ApiService.getCollectionAssets",n,{collectionName:e,schemaName:t,templateId:a,limit:s}),[]}}async getAssetDetails(e){try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/assets/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data:null}catch(t){return W.logError("ApiService.getAssetDetails",t,{assetId:e}),null}}async getCollectionStats(e){try{const t=`${this.atomicAssetsAPI}/atomicassets/v1/collections/${e}/stats`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data:null}catch(t){return W.logError("ApiService.getCollectionSchemas",t,{collectionName:e}),null}}async getCollectionBurns(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/burns?collection_name=${e}&limit=${t}&order=desc&sort=created`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return W.logError("ApiService.getCollectionBurns",a,{collectionName:e,limit:t}),[]}}async getCollectionTransfers(e,t=50){try{const a=`${this.atomicAssetsAPI}/atomicassets/v1/transfers?collection_name=${e}&limit=${t}&order=desc&sort=created`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return W.logError("ApiService.getCollectionTransfers",a,{collectionName:e,limit:t}),[]}}async getCollectionVolumeGraph(e,t=30){try{const a=`${this.hiveBPAPI}/v3/sales-volume-graph/${t}/${e}`,s=await this.fetchWithRetry(a);return await s.json()}catch(a){return q.warn(`HiveBP volume graph not available for ${e}`,"API",a),null}}async getCollectionMarketCap(e){try{const t=`${this.hiveBPAPI}/v3/collection-marketcap/${e}`,a=await this.fetchWithRetry(t);return await a.json()}catch(t){return q.warn(`HiveBP market cap not available for ${e}`,"API",t),null}}async getSimilarCollections(e){try{const t=`${this.hiveBPAPI}/v3/similar-collections/${e}`,a=await this.fetchWithRetry(t);return await a.json()||[]}catch(t){return q.warn(`HiveBP similar collections not available for ${e}`,"API",t),[]}}async getCollectionAnalytics(e){try{const t=`${this.hiveBPAPI}/v3/collection-stats/${e}`,a=await this.fetchWithRetry(t);return await a.json()}catch(t){return q.warn(`HiveBP analytics not available for ${e}`,"API",t),null}}async getHiveBPMarketCap(e){try{const t=`${this.hiveBPAPI}/v3/marketcap/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s?.marketcap||null}catch(t){return q.warn(`HiveBP market cap not available for ${e}`,"API",t),null}}async getHiveBPVolumeDays(e,t=1){try{const a=`${this.hiveBPAPI}/v3/volume/${t}/${e}`,s=await this.fetchWithRetry(a),n=await s.json();return n?.volume||null}catch(a){return q.warn(`HiveBP volume data not available for ${e}`,"API",a),null}}async getHiveBPFloorPrice(e){try{const t=`${this.hiveBPAPI}/v3/floor/${e}`,a=await this.fetchWithRetry(t),s=await a.json();return s?.floor_price||null}catch(t){return q.warn(`HiveBP floor price not available for template ${e}`,"API",t),null}}async getEnhancedCollectionStats(e){try{const[a,s,n]=await Promise.all([this.getHiveBPMarketCap(e),this.getHiveBPVolumeDays(e,1),this.getHiveBPVolumeDays(e,7)]);let i=null;try{const t=await this.getCollectionTemplates(e,void 0,1);t.length>0&&(i=await this.getHiveBPFloorPrice(t[0].template_id))}catch(t){q.warn(`Could not fetch floor price for ${e}`,"API",t)}return{marketCap:a,volume24h:s,volume7d:n,floorPrice:i}}catch(t){return W.logError("ApiService.getCollectionStats",t,{collectionName:e}),{marketCap:null,volume24h:null,volume7d:null,floorPrice:null}}}async getCollectionTopSales(e,t=20){try{const a=`${this.atomicAssetsAPI}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=${t}&order=desc&sort=price`,s=await this.fetchWithRetry(a),n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return W.logError("ApiService.getCollectionTopSales",a,{collectionName:e,limit:t}),[]}}async getCollectionFloorPrice(e){try{const t=`${this.atomicAssetsAPI}/atomicmarket/v1/sales?collection_name=${e}&state=1&limit=1&order=asc&sort=price`,a=await this.fetchWithRetry(t),s=await a.json();if(s.success&&s.data&&s.data.length>0){return{floorPrice:parseFloat(s.data[0].listing_price)/1e8}}return{floorPrice:0}}catch(t){return W.logError("ApiService.getCollectionFloorPrice",t,{collectionName:e}),{floorPrice:0}}}async getCollectionHolders(e,t=50,a=0){try{let s=`${this.atomicAssetsAPI}/atomicassets/v1/accounts?collection_name=${e}&limit=${t}&order=desc&sort=assets`;a>0&&(s+=`&page=${Math.floor(a/t)+1}`);const n=await this.fetchWithRetry(s),i=await n.json();return i.success&&i.data?i.data:[]}catch(s){return W.logError("ApiService.getCollectionHolders",s,{collectionName:e,limit:t,offset:a}),[]}}async getNFTTradingStats(){try{const e=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&after=${Date.now()-864e5}&limit=1000`),t=await e.json();let a=0,s=0;t.success&&t.data&&(s=t.data.length,a=t.data.reduce((e,t)=>e+(t.price?parseFloat(t.price.amount)/Math.pow(10,t.price.token_precision):0),0));const n=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=1&limit=1`),i=await n.json(),r=i.success?parseInt(i.query_time):0;return{collection_name:"global",dailyVolume:B(a),dailySales:s,totalTransactions:s,activeListings:r,averagePrice:s>0?B(a/s):"0"}}catch(e){return W.logError("ApiService.getNFTTradingStats",e),null}}async getTopCollectionsByVolume(e=10){try{const t=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/stats/collections?limit=${e}&sort=volume`),a=await t.json();return a.success&&a.data?a.data.map(e=>({collection_name:e.collection_name,volume_24h:e.volume?D(parseFloat(e.volume)/1e8):"0 WAX",sales_24h:parseInt(e.sales||"0")||0,floor_price:e.floor_price?D(parseFloat(e.floor_price)/1e8):"0 WAX",assets_count:e.assets||"0"})):[]}catch(t){return W.logError("ApiService.getTopCollectionsByVolume",t,{limit:e}),[]}}async getRecentNFTTrades(e=20){try{const t=await this.fetchWithRetry(`${this.atomicMarketAPI}/atomicmarket/v1/sales?state=3&limit=${e}&sort=updated`),a=await t.json();return a.success&&a.data?a.data.map(e=>({sale_id:e.sale_id,collection_name:e.collection_name||e.assets[0]?.collection?.collection_name||"Unknown",asset_name:e.assets[0]?.name||`Asset #${e.assets[0]?.asset_id}`,price:e.price?D(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision)):"0 WAX",buyer:e.buyer,seller:e.seller,timestamp:e.updated_at_time})):[]}catch(t){return W.logError("ApiService.getNFTTradingStats",t,{limit:e}),[]}}async getUserInventory(e,t=1e3){try{const a=this.approvedCollections.join(","),s=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${a}&burned=false&limit=${t}&order=desc&sort=asset_id`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data)return i.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))}));throw new Error("Invalid API response")}catch(a){return W.logError("ApiService.getUserInventory",a,{account:e}),[]}}async getUserInventoryPaginated(e,t=1,a=1e3){try{const s=this.approvedCollections.join(","),n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${s}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const s=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:s,hasMore:n,total:(t-1)*a+r.data.length+(n?1:0)}}throw new Error("Invalid API response")}catch(s){return W.logError("ApiService.getUserInventoryPaginated",s,{account:e,page:t,limit:a}),{assets:[],hasMore:!1,total:0}}}async getUserInventoryAll(e,t=1,a=1e3){try{const s=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`,n=await this.fetchWithRetry(s),i=await n.json();if(i.success&&i.data){const s=i.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=i.data.length===a;return{assets:s,total:(t-1)*a+s.length+(n?1:0),hasMore:n,currentPage:t}}return{assets:[],total:0,hasMore:!1,currentPage:t}}catch(s){return W.logError("ApiService.getUserInventoryAll",s,{account:e,page:t,limit:a}),{assets:[],total:0,hasMore:!1,currentPage:t}}}async getUserInventoryByCollection(e,t,a=1e3,s=0){try{const n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${t}&burned=false&limit=${a}&offset=${s}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const t=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:t,total:s+t.length+(n?1:0),hasMore:n}}return{assets:[],total:0,hasMore:!1}}catch(n){return W.logError("ApiService.getUserInventoryByCollection",n,{account:e,collectionName:t,limit:a,offset:s}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryBySchema(e,t,a,s=1e3,n=0){try{const i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=${t}&schema_name=${a}&burned=false&limit=${s}&offset=${n}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),l=await r.json();if(l.success&&l.data){const t=l.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),a=l.data.length===s;return{assets:t,total:n+t.length+(a?1:0),hasMore:a}}return{assets:[],total:0,hasMore:!1}}catch(i){return W.logError("ApiService.getUserInventoryBySchema",i,{account:e,collectionName:t,schemaName:a,limit:s,offset:n}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryOverview(e){try{const t=`${te.WAX_CHAIN.EOSRIO}/v1/chain/get_table_rows`,a=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"atomicassets",scope:e,table:"assets",limit:1e3,reverse:!1})}),s=await a.json(),n=new Map;let i=0;s.rows&&s.rows.forEach(e=>{if(!e.collection_name)return;i++;const t=e.collection_name,a=e.schema_name||"unknown";n.has(t)||n.set(t,{count:0,schemas:new Map});const s=n.get(t);s.count++,s.schemas.set(a,(s.schemas.get(a)||0)+1)});const r=Array.from(n.entries()).map(([e,t])=>({name:e,count:t.count,schema_counts:Object.fromEntries(t.schemas)})).sort((e,t)=>t.count-e.count);return{totalAssets:i,collections:r,topCollections:r.slice(0,10)}}catch(t){W.logError("ApiService.getUserInventoryOverview",t,{account:e});try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&page=1&limit=1`,a=await this.fetchWithRetry(t),s=await a.json();return{totalAssets:s.success&&s.query_total||0,collections:[],topCollections:[]}}catch(a){return W.logError("ApiService.getUserInventoryOverview.fallback",a,{account:e}),{totalAssets:0,collections:[],topCollections:[]}}}}async getUserInventoryOptimized(e,t={}){const{page:a=1,limit:s=1e3,collectionName:n,schemaName:i,useCache:r=!0,cacheTTL:l=3e5}=t,c=`inventory_${e}_${a}_${s}_${n||"all"}_${i||"all"}`;if(r){const e=this.getFromCache(c);if(e)return e}try{let t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${s}&page=${a}&order=desc&sort=asset_id`;n&&"all"!==n&&(t+=`&collection_name=${n}`),i&&(t+=`&schema_name=${i}`);const o=await this.fetchWithRetry(t),d=await o.json();if(d.success&&d.data){const t=d.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=d.data.length===s,i={assets:t,total:d.query_total||(a-1)*s+t.length+(n?1:0),hasMore:n,currentPage:a};return r&&this.setCache(c,i,l),i}return{assets:[],total:0,hasMore:!1,currentPage:a}}catch(o){return W.logError("ApiService.getUserInventoryOptimized",o,{account:e,page:a,limit:s,collectionName:n,schemaName:i}),{assets:[],total:0,hasMore:!1,currentPage:a}}}async getUserInventoryBatch(e,t={}){const{batchSize:a=1e3,maxBatches:s=20,delayMs:n=500,collectionName:i,onProgress:r,maxRetries:l=3,onError:c}=t,o=[],d=[];let u=1,m=!0,h=0;for(;m&&u<=s&&h<3;){let t=!1,f=null;for(let x=0;x<=l;x++)try{if(x>0){const e=n*Math.pow(1.5,h),t=Math.min(1e3*Math.pow(2,x-1)+e,1e4);await new Promise(e=>setTimeout(e,t))}const l=await this.getUserInventoryOptimized(e,{page:u,limit:a,collectionName:i,useCache:!1});o.push(...l.assets),m=l.hasMore,t=!0,h=0,r&&r({current:u,total:Math.min(s,Math.ceil(l.total/a)),assets:[...o],errors:[...d]});break}catch(p){f=p;const t=x<l;if(c&&c(f,u,t),W.logError(`ApiService.getUserInventoryBatch.batch${u}.attempt${x+1}`,f,{account:e,batchSize:a,currentBatch:u,retryAttempt:x}),!t){const t=`Batch ${u} failed after ${l+1} attempts: ${f.message}`;if(d.push(t),h++,this.isCriticalError(f))return W.logError("ApiService.getUserInventoryBatch.criticalError",f,{account:e,currentBatch:u,errorType:"critical"}),{assets:o,errors:[...d,"Critical error encountered, stopping batch processing"],partialSuccess:o.length>0}}}if(u++,m&&u<=s&&t){const e=n*Math.pow(1.2,Math.min(h,3));await new Promise(t=>setTimeout(t,e))}}if(h>=3){const t=`Stopped processing due to ${h} consecutive batch failures`;d.push(t),W.logError("ApiService.getUserInventoryBatch.tooManyFailures",new Error(t),{account:e,currentBatch:u,consecutiveFailures:h})}return{assets:o,errors:d,partialSuccess:o.length>0&&(d.length>0||h>0)}}isCriticalError(e){const t=e.message.toLowerCase();return t.includes("unauthorized")||t.includes("forbidden")||t.includes("invalid account")||t.includes("network error")||t.includes("dns")||t.includes("connection refused")}async executeBatchOperation(e,t,a={}){const{batchSize:s=100,maxRetries:n=3,delayMs:i=500,onProgress:r,onError:l,stopOnCriticalError:c=!0}=a,o=[],d=[],u=this.chunkArray(e,s);let m=0;for(let p=0;p<u.length;p++){const e=u[p];let a=!1,s=null;for(let i=0;i<=n;i++)try{if(i>0){const e=Math.min(1e3*Math.pow(2,i-1),1e4);await new Promise(t=>setTimeout(t,e))}const s=await t(e,p);o.push(...s),a=!0,m=0,r&&r({completed:p+1,total:u.length,errors:[...d]});break}catch(h){s=h;const t=i<n;if(l&&l(s,p,t),W.logError(`ApiService.executeBatchOperation.batch${p}.attempt${i+1}`,s,{batchIndex:p,retryAttempt:i,batchSize:e.length}),!t){const e=`Batch ${p} failed after ${n+1} attempts: ${s.message}`;if(d.push(e),m++,c&&this.isCriticalError(s))return W.logError("ApiService.executeBatchOperation.criticalError",s,{batchIndex:p,errorType:"critical"}),{results:o,errors:[...d,"Critical error encountered, stopping batch processing"],partialSuccess:o.length>0}}}if(m>=3){const e=`Stopped processing due to ${m} consecutive batch failures`;d.push(e),W.logError("ApiService.executeBatchOperation.tooManyFailures",new Error(e),{batchIndex:p,consecutiveFailures:m});break}if(p<u.length-1&&a){const e=i*Math.pow(1.2,Math.min(m,3));await new Promise(t=>setTimeout(t,e))}}return{results:o,errors:d,partialSuccess:o.length>0&&d.length>0}}chunkArray(e,t){const a=[];for(let s=0;s<e.length;s+=t)a.push(e.slice(s,s+t));return a}async getUserInventoryWithFilter(e,t=1,a=1e3,s){try{let n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&burned=false&limit=${a}&page=${t}&order=desc&sort=asset_id`;s&&"all"!==s&&(n+=`&collection_name=${s}`);const i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const s=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),video:this.getAssetVideo(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_id:t.template?.template_id||"0",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:s,total:(t-1)*a+s.length+(n?1:0),hasMore:n,currentPage:t}}return{assets:[],total:0,hasMore:!1,currentPage:t}}catch(n){return W.logError("ApiService.getUserInventoryWithFilter",n,{account:e,page:t,limit:a,collectionName:s}),{assets:[],total:0,hasMore:!1,currentPage:t}}}async getUserInventoryByTemplate(e,t,a=1e3,s=0){try{const n=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&template_id=${t}&burned=false&limit=${a}&offset=${s}&order=desc&sort=asset_id`,i=await this.fetchWithRetry(n),r=await i.json();if(r.success&&r.data){const t=r.data.map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""]))})),n=r.data.length===a;return{assets:t,total:s+t.length+(n?1:0),hasMore:n}}return{assets:[],total:0,hasMore:!1}}catch(n){return W.logError("ApiService.getUserInventoryByTemplate",n,{account:e,templateId:t,limit:a,offset:s}),{assets:[],total:0,hasMore:!1}}}async getUserInventoryWaxRocks(e,t=1e3,a=0){try{const{MarketplaceConfigService:s}=await h(async()=>{const{MarketplaceConfigService:e}=await Promise.resolve().then(()=>se);return{MarketplaceConfigService:e}},void 0),n=s.getPixalTemplateId(),i=`${this.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&template_id=${n}&burned=false&limit=${t}&offset=${a}&order=desc&sort=asset_id`,r=await this.fetchWithRetry(i),l=await r.json();if(l.success&&l.data){const a=l.data.filter(e=>{const t=e.data?.WaxRock||e.template?.immutable_data?.WaxRock;return!(!t||"string"!=typeof t)&&("none"!==t&&s.isValidWaxRock(t))}).map(t=>({sale_id:"",asset_id:t.asset_id||"",name:t.name||`${t.collection?.collection_name||"Unknown"} #${t.asset_id}`,image:this.getAssetImage(t),price:"Not for sale",seller:e,collection:t.collection?.collection_name||"Unknown",schema:t.schema?.schema_name||"Unknown",template_mint:parseInt(t.template?.template_id||"0")||0,max_supply:t.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(t.data||{}).map(([e,t])=>[e,t??""])),data:t.data})),n=l.data.length===t;return{assets:a,total:a.length,hasMore:n}}return{assets:[],total:0,hasMore:!1}}catch(s){return W.logError("ApiService.getUserInventoryWaxRocks",s,{account:e,limit:t,offset:a}),{assets:[],total:0,hasMore:!1}}}async getWaxChainInfo(){try{const e=await this.fetchWithRetry(`${this.waxChainAPI}/v1/chain/get_info`);if(e.ok)return await e.json();throw new Error("Failed to fetch chain info")}catch(e){return W.logError("ApiService.getWaxChainInfo",e),this.currentWaxChainIndex<this.waxChainEndpoints.length-1?(this.currentWaxChainIndex++,this.getWaxChainInfo()):(this.currentWaxChainIndex=0,null)}}async getWaxAccountInfo(e){for(let a=0;a<this.waxChainEndpoints.length;a++){const s=this.waxChainEndpoints[a];try{const t=await fetch(`${s}/v1/chain/get_account`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify({account_name:e})});if(t.ok){const e=await t.json();return this.currentWaxChainIndex=a,e}q.warn(`Endpoint ${s} returned status ${t.status}: ${t.statusText}`,"API")}catch(t){W.logError("ApiService.getWaxAccountInfo",t,{endpoint:s,accountName:e})}}return W.logError("ApiService.getWaxAccountInfo",new Error("All WAX chain endpoints failed for get_account"),{accountName:e}),null}async getWaxCurrencyBalance(e,t="eosio.token",a="WAX"){q.debug(`Attempting to fetch currency balance for: ${e}`,"API");for(let n=0;n<this.waxChainEndpoints.length;n++){const i=this.waxChainEndpoints[n];q.debug(`Trying endpoint ${n+1}/${this.waxChainEndpoints.length}: ${i}`,"API");try{const s=await fetch(`${i}/v1/chain/get_currency_balance`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify({code:t,account:e,symbol:a})});if(s.ok){const e=await s.json();return q.debug(`Successfully fetched currency balance from ${i}`,"API"),this.currentWaxChainIndex=n,e.map(e=>({balance:e,contract:t,symbol:e.split(" ")[1]||a}))}q.warn(`Endpoint ${i} returned status ${s.status}: ${s.statusText}`,"API")}catch(s){W.logError("ApiService.getWaxCurrencyBalance",s,{endpoint:i,accountName:e,contract:t,symbol:a})}}return W.logError("ApiService.getWaxCurrencyBalance",new Error("All WAX chain endpoints failed for get_currency_balance"),{accountName:e,contract:t,symbol:a}),[]}async getLightApiBalances(e){try{const t=`${this.waxLightAPI}/api/balances/wax/${e}`,a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(t){return W.logError("ApiService.getLightApiBalances",t,{accountName:e}),null}}async getLightApiAccountInfo(e){try{const t=`${this.waxLightAPI}/api/account/wax/${e}`,a=await fetch(t,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},mode:"cors"});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);return await a.json()}catch(t){return W.logError("ApiService.getLightApiAccountInfo",t,{accountName:e}),null}}async getAlcorTokenPrice(e,t){let a=null;try{const s=`${e.toLowerCase()}-${t}`,n=`${this.alcorAPI}/tokens/${s}`,i=new AbortController;a=setTimeout(()=>{i.abort()},8e3);const r=await this.fetchAlcorAPI(n,2,{signal:i.signal});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);return await r.json()}catch(s){return s instanceof Error&&"AbortError"===s.name?(q.warn(`Alcor API request timeout for ${e}`,"API"),null):(q.warn(`Error fetching Alcor token price for ${e}`,"API",s),"wax"===e.toLowerCase()?{symbol:"WAX",contract:"eosio.token",id:"wax-eosio.token",system_price:.05,usd_price:.05,decimals:8}:null)}finally{a&&clearTimeout(a)}}async getAlcorMarkets(){try{const e=`${this.alcorAPI}/pairs`,t=await this.fetchAlcorAPI(e);return await t.json()}catch(e){return W.logError("ApiService.getAlcorMarkets",e),[]}}async getMarketplaceConfig(){try{return{partnerCollections:["friedfactory","pixeljourney"],tokenContracts:["alien.worlds","prospectorsc","token.nefty"],supportedTokens:[{contract:"eosio.token",symbol:"WAX",precision:8},{contract:"alien.worlds",symbol:"TLM",precision:4},{contract:"prospectorsc",symbol:"PGL",precision:4},{contract:"token.nefty",symbol:"NEFTY",precision:8}]}}catch(e){return W.logError("ApiService.getMarketplaceConfig",e),{partnerCollections:["friedfactory","pixeljourney"],tokenContracts:["alien.worlds","prospectorsc","token.nefty"],supportedTokens:[{contract:"eosio.token",symbol:"WAX",precision:8}]}}}async getPartnerCollections(){try{return(await this.getMarketplaceConfig()).partnerCollections}catch(e){return W.logError("ApiService.getPartnerCollections",e),["friedfactory","pixeljourney"]}}async getTokenContracts(){try{return(await this.getMarketplaceConfig()).tokenContracts}catch(e){return W.logError("ApiService.getTokenContracts",e),["alien.worlds","prospectorsc","token.nefty"]}}async getAlcorSwapQuote(e){try{const t=`${this.alcorAPI}/swap/quote`,a=await this.fetchAlcorAPI(t,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await a.json()}catch(t){return W.logError("ApiService.getAlcorSwapQuote",t,{params:e}),null}}async getPXJPrice(){try{const e=await this.getAlcorTokenPrice("PXJ","pixeljourney");return e?.system_price||0}catch(e){return W.logError("ApiService.getPXJPrice",e),0}}async calculatePortfolioValue(e){let t=0;for(const s of e)try{const e=await this.getAlcorTokenPrice(s.currency,s.contract);if(e){const a=parseFloat(s.amount),n=parseInt(s.decimals);t+=a/Math.pow(10,n)*e.usd_price}}catch(a){q.warn(`Could not get price for ${s.currency}`,"API",a)}return t}async getMarketplaceNFTs(e){try{const{page:t=1,limit:a=100,asset_id:s,state:n=1}=e;let i=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?state=${n}&page=${t}&limit=${a}&order=desc&sort=created`;s&&(i+=`&asset_id=${s}`);const r=await this.fetchWithRetry(i),l=await r.json();return l.success&&l.data?{success:!0,data:l.data.map(e=>({sale_id:e.sale_id,asset_id:e.assets[0]?.asset_id||"",price:e.price?`${(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)).toFixed(8)} ${e.price.token_symbol}`:"0 WAX",seller:e.seller,created_at_time:e.created_at_time}))}:{success:!0,data:[]}}catch(t){return W.logError("ApiService.getMarketplaceNFTs",t,{params:e}),{success:!1,data:[]}}}async getAssetOffers(e){try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/buyoffers?asset_id=${e}&state=0&page=1&limit=100&order=desc&sort=price`,a=await this.fetchWithRetry(t),s=await a.json();return s.success&&s.data?s.data.map(e=>({id:e.buyoffer_id,buyer:e.buyer,price:e.price.amount,symbol:e.price.token_symbol,timestamp:e.created_at_time,memo:e.memo||""})):[]}catch(t){return W.logError("ApiService.getAssetOffers",t,{assetId:e}),[]}}async getAssetsBatch(e){if(!e.length)return{success:!0,data:[],errors:[]};try{const a=this.chunkArray(e,100),s=[],n=[];for(const e of a)try{const t=e.join(","),a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets`,i=await this.fetchWithRetry(a,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,limit:"1000"})}),r=await i.json();r.success&&r.data?s.push(...r.data):n.push(`Failed to fetch assets batch: ${e.join(", ")}`)}catch(t){W.logError("ApiService.getAssetsBatch",t,{chunk:e}),n.push(`Error fetching assets: ${e.join(", ")}`)}return{success:0===n.length,data:s,errors:n}}catch(t){return W.logError("ApiService.getAssetsBatch",t,{assetIds:e}),{success:!1,data:[],errors:[`Failed to process asset batch: ${t}`]}}}async getTemplatesBatch(e){if(!e.length)return{success:!0,data:[],errors:[]};try{const a=this.chunkArray(e,100),s=[],n=[];for(const e of a)try{const t=e.join(","),a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/templates`,i=await this.fetchWithRetry(a,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ids:t,limit:"1000"})}),r=await i.json();r.success&&r.data?s.push(...r.data):n.push(`Failed to fetch templates batch: ${e.join(", ")}`)}catch(t){W.logError("ApiService.getTemplatesBatch",t,{chunk:e}),n.push(`Error fetching templates: ${e.join(", ")}`)}return{success:0===n.length,data:s,errors:n}}catch(t){return W.logError("ApiService.getTemplatesBatch",t,{templateIds:e}),{success:!1,data:[],errors:[`Failed to process template batch: ${t}`]}}}async getAssetCountsBatch(e,t){if(!e.length)return{success:!0,data:{},errors:[]};try{const s={},n=[],i=this.chunkArray(e,50);for(const e of i)try{const a=e.map(async e=>{try{const a={template_id:e,limit:1};t&&(a.owner=t);const s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets`,n=new URLSearchParams;Object.entries(a).forEach(([e,t])=>{null!=t&&n.append(e,String(t))});const i=await this.fetchWithRetry(`${s}?${n}`),r=await i.json();return r.success?{templateId:e,count:parseInt(r.query_total||"0")}:{templateId:e,count:0,error:"API returned unsuccessful response"}}catch(a){return{templateId:e,count:0,error:String(a)}}});(await Promise.all(a)).forEach(e=>{e.error&&n.push(`Error fetching count for template ${e.templateId}: ${e.error}`),s[e.templateId]=e.count}),i.indexOf(e)<i.length-1&&await new Promise(e=>setTimeout(e,100))}catch(a){W.logError("ApiService.getAssetCountsBatch chunk",a,{chunk:e}),e.forEach(e=>{s[e]=0,n.push(`Error processing template ${e}: ${a}`)})}return{success:0===n.length,data:s,errors:n}}catch(a){return W.logError("ApiService.getAssetCountsBatch",a,{templateIds:e}),{success:!1,data:{},errors:[`Failed to process asset counts batch: ${a}`]}}}async getOffers(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="created",state:i="0",collection_name:r,schema_name:l,template_id:c,asset_id:o,buyer:d,seller:u,min_price:m,max_price:h,symbol:p="WAX"}=e;let f=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/buyoffers?page=${t}&limit=${a}&order=${s}&sort=${n}&state=${i}&symbol=${p}`;r&&(f+=`&collection_name=${r}`),l&&(f+=`&schema_name=${l}`),c&&(f+=`&template_id=${c}`),o&&(f+=`&asset_id=${o}`),d&&(f+=`&buyer=${d}`),u&&(f+=`&seller=${u}`),m&&(f+=`&min_price=${m}`),h&&(f+=`&max_price=${h}`);const x=await this.fetchWithRetry(f),g=await x.json();return{success:g.success||!1,data:g.data||[],query_total:g.query_total}}catch(t){return W.logError("ApiService.getOffers",t,e),{success:!1,data:[]}}}async getPrices(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="created",collection_name:i,schema_name:r,template_id:l,symbol:c="WAX"}=e;let o=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/prices?page=${t}&limit=${a}&order=${s}&sort=${n}&symbol=${c}`;i&&(o+=`&collection_name=${i}`),r&&(o+=`&schema_name=${r}`),l&&(o+=`&template_id=${l}`);const d=await this.fetchWithRetry(o),u=await d.json();return{success:u.success||!1,data:u.data||[],query_total:u.query_total}}catch(t){return W.logError("ApiService.getPrices",t,e),{success:!1,data:[]}}}async getTransfers(e={}){try{const{page:t=1,limit:a=100,order:s="desc",sort:n="created",collection_name:i,schema_name:r,template_id:l,asset_id:c,sender:o,recipient_name:d}=e;let u=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/transfers?page=${t}&limit=${a}&order=${s}&sort=${n}`;i&&(u+=`&collection_name=${i}`),r&&(u+=`&schema_name=${r}`),l&&(u+=`&template_id=${l}`),c&&(u+=`&asset_id=${c}`),o&&(u+=`&sender_name=${o}`),d&&(u+=`&recipient_name=${d}`);const m=await this.fetchWithRetry(u),h=await m.json();return{success:h.success||!1,data:h.data||[],query_total:h.query_total}}catch(t){return W.logError("ApiService.getTransfers",t,e),{success:!1,data:[]}}}async getCollectionMarketStats(e={}){try{const{collection_name:t,symbol:a="WAX"}=e;let s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/collections?symbol=${a}`;t&&(s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/collections/${t}?symbol=${a}`);const n=await this.fetchWithRetry(s),i=await n.json();return{success:i.success||!1,data:i.data||{}}}catch(t){return W.logError("ApiService.getCollectionMarketStats",t,e),{success:!1,data:{symbol:"",market_contract:"",sales:"0",volume:"0",suggested_median:"0",suggested_average:"0"}}}}async getTemplateStats(e,t,a="WAX"){try{const s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/stats/templates/${e}/${t}?symbol=${a}`,n=await this.fetchWithRetry(s),i=await n.json();return{success:i.success||!1,data:i.data||{}}}catch(s){return W.logError("ApiService.getTemplateStats",s,{collectionName:e,templateId:t,symbol:a}),{success:!1,data:{template_id:"",collection_name:"",assets:"0",burned:"0",sales:"0",volume:"0",suggested_median:"0",suggested_average:"0"}}}}async getHyperionTransactionHistory(e,t=100,a=0){q.debug("🔍 Fetching Hyperion transaction history for:","API",{account:e});try{const s=`${this.hyperionEndpoints[this.currentHyperionIndex]}/v2/history/get_actions`,n=new URLSearchParams({account:e,limit:Math.min(t,1e3).toString(),skip:a.toString(),sort:"desc"});q.debug("📡 Hyperion API URL:","API",{url:`${s}?${n}`});const i=await this.fetchWithRetry(`${s}?${n}`),r=await i.json();if(!r.actions||!Array.isArray(r.actions))return q.warn("No actions found in Hyperion response","API"),[];q.debug(`📊 Found ${r.actions.length} Hyperion actions`,"API");const l=r.actions.map(t=>{const a=t.act.data;let s="unknown";return s="eosio.token"===t.act.account&&"transfer"===t.act.name?a.from===e?"token_send":"token_receive":"atomicassets"===t.act.account&&"transfer"===t.act.name?"nft_transfer":"atomicmarket"===t.act.account&&"purchasesale"===t.act.name?"nft_purchase":"atomicmarket"===t.act.account&&"announcesale"===t.act.name?"nft_listing":"atomicmarket"===t.act.account&&"cancelsale"===t.act.name?"nft_cancel_listing":`${t.act.account}_${t.act.name}`,{transaction_id:t.trx_id,block_time:t.timestamp,action_name:t.act.name,contract:t.act.account,from:a.from,to:a.to,quantity:a.quantity,memo:a.memo,asset_ids:a.asset_ids,collection_name:a.collection_name,type:s,status:"completed"}});return q.debug(`✅ Processed ${l.length} Hyperion transactions`,"API"),l}catch(s){return q.error("❌ Hyperion API error","API",s),this.currentHyperionIndex<this.hyperionEndpoints.length-1?(this.currentHyperionIndex++,q.debug(`🔄 Switching to Hyperion endpoint ${this.currentHyperionIndex+1}`,"API"),this.getHyperionTransactionHistory(e,t,a)):(this.currentHyperionIndex=0,W.logError("ApiService.getHyperionTransactionHistory",s,{account:e,limit:t,skip:a}),[])}}async getAccountTransfers(e,t,a,s=50,n=0){try{const i=`${this.hyperionEndpoints[this.currentHyperionIndex]}/v2/history/get_actions`,r=new URLSearchParams({account:e,limit:Math.min(s,100).toString(),sort:"desc",skip:n.toString(),"transfer.to":e});q.debug("🔍 Fetching account transfers from Hyperion:","API",{account:e,contract:t,symbol:a,url:`${i}?${r}`});const l=await this.fetchWithRetry(`${i}?${r}`),c=await l.json();if(!c.actions||!Array.isArray(c.actions))return q.warn("No actions found in Hyperion response for transfers","API"),[];q.debug(`📊 Found ${c.actions.length} Hyperion transfer actions`,"API");const o=c.actions.filter(s=>{const n=s.act;return n?.account===t&&"transfer"===n?.name&&(n?.data?.to===e||n?.data?.from===e)&&(n?.data?.quantity?.includes(a)||n?.data?.symbol===a)}).slice(0,s).map(e=>{const t=e.act.data;return{from:t.from,to:t.to,quantity:t.quantity,memo:t.memo||"",timestamp:e.timestamp,transaction_id:e.trx_id,block_num:e.block_num}});return q.debug(`✅ Processed ${o.length} transfers for account ${e}`,"API"),o}catch(i){return W.logError("ApiService.getAccountTransfers",i,{account:e,contract:t,symbol:a,limit:s,offset:n}),q.warn("Falling back to legacy WAX chain API","API"),this.fetchTransfersFromWaxChainAPI(e,t,a,s,n)}}async fetchTransfersFromWaxChainAPI(e,t,a,s=50,n=0){try{const i=await fetch(`${this.waxChainAPI}/v1/history/get_actions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:e,pos:-1,offset:n,filter:`${t}:transfer`})});if(!i.ok)throw new Error(`HTTP ${i.status}: ${i.statusText}`);const r=(await i.json()).actions||[];return r.filter(s=>{const n=s.action_trace?.act;return"transfer"===n?.name&&n?.account===t&&(n?.data?.to===e||n?.data?.from===e)&&n?.data?.quantity?.includes(a)}).slice(0,s).map(e=>{const t=e.action_trace.act.data;return{from:t.from,to:t.to,quantity:t.quantity,memo:t.memo||"",timestamp:e.block_time,transaction_id:e.action_trace.trx_id,block_num:e.block_num}})}catch(i){return W.logError("ApiService.fetchTransfersFromWaxChainAPI",i,{account:e,contract:t,symbol:a,limit:s,offset:n}),[]}}async getUserTransactions(e,t=500){q.debug("🔍 getUserTransactions called for account:","API",{account:e,limit:t});try{const s=[];try{q.debug("🚀 Fetching Hyperion transaction history...","API");const a=await this.getHyperionTransactionHistory(e,Math.min(t,200));q.debug("🚀 Hyperion transactions:","API",{count:a.length});const n=a.map(e=>({transaction_id:e.transaction_id,block_time:e.block_time,action_name:e.action_name,asset_id:e.asset_ids?.[0],asset_name:e.asset_ids?.[0]?`Asset #${e.asset_ids[0]}`:void 0,collection_name:e.collection_name,price:e.quantity,from:e.from,to:e.to,type:e.type,status:e.status,memo:e.memo}));s.push(...n),q.debug("✅ Added Hyperion transactions","API",{count:n.length})}catch(a){q.warn("Failed to fetch Hyperion transactions","API",a)}try{const a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?account=${e}&state=3&page=1&limit=${Math.min(t,200)}&order=desc&sort=updated`;q.debug("📊 Fetching marketplace transactions from:","API",{url:a});const n=await this.fetchWithRetry(a),i=await n.json();if(q.debug("📊 Marketplace response:","API",{success:i.success,dataLength:i.data?.length}),i.success&&i.data){const t=i.data.map(t=>{const a=parseFloat(t.price.amount)/Math.pow(10,t.price.token_precision||8),s="WAX"===t.price.token_symbol?D(a):`${B(a)} ${t.price.token_symbol}`;return{transaction_id:t.sale_id,block_time:t.updated_at_time,action_name:t.buyer===e?"purchase":"sale",asset_id:t.assets[0]?.asset_id,asset_name:t.assets[0]?.name||`Asset #${t.assets[0]?.asset_id}`,collection_name:t.assets[0]?.collection?.collection_name,price:s,from:t.buyer===e?t.seller:e,to:t.buyer===e?e:t.buyer,type:t.buyer===e?"purchase":"sale",status:"completed"}});s.push(...t)}}catch(a){q.warn("Failed to fetch marketplace transactions","API",a)}try{const a=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/transfers?account=${e}&page=1&limit=${Math.min(t,200)}&order=desc&sort=created`;q.debug("🔄 Fetching NFT transfers from:","API",{url:a});const n=await this.fetchWithRetry(a),i=await n.json();if(q.debug("🔄 NFT transfers response:","API",{success:i.success,dataLength:i.data?.length}),i.success&&i.data){const e=i.data.filter(e=>e.sender!==e.recipient).map(e=>{const t=e.assets?.[0];return{transaction_id:e.tx_id||`transfer_${e.transfer_id}`,block_time:e.created_at_time,action_name:"transfer",asset_id:t?.asset_id,asset_name:t?.name||`Asset #${t?.asset_id}`,collection_name:t?.collection?.collection_name,price:void 0,from:e.sender,to:e.recipient,type:"transfer",status:"completed",memo:e.memo||void 0}});s.push(...e)}}catch(a){q.warn("Failed to fetch NFT transfers","API",a)}try{q.debug("💰 Fetching token transfers for account:","API",{account:e});const a=await this.getAccountTransfers(e,"eosio.token","WAX",Math.min(t,100));q.debug("💰 Token transfers response:","API",{count:a.length});const n=a.map(t=>({transaction_id:t.transaction_id,block_time:t.timestamp,action_name:"token_transfer",asset_id:void 0,asset_name:"WAX Token",collection_name:"WAX",price:t.quantity,from:t.from,to:t.to,type:t.from===e?"token_send":"token_receive",status:"completed",memo:t.memo}));s.push(...n)}catch(a){q.warn("Failed to fetch token transfers","API",a)}q.debug("📋 Total transactions found:","API",{count:s.length});const n=new Map;s.forEach(e=>{const t=n.get(e.transaction_id);if(t){const a={...t,...e,asset_id:e.asset_id||t.asset_id,asset_name:e.asset_name||t.asset_name,collection_name:e.collection_name||t.collection_name,price:e.price||t.price,from:e.from||t.from,to:e.to||t.to,memo:e.memo||t.memo};n.set(e.transaction_id,a)}else n.set(e.transaction_id,e)});const i=Array.from(n.values()).sort((e,t)=>new Date(t.block_time).getTime()-new Date(e.block_time).getTime()).slice(0,t);return q.debug("✅ Returning unique transactions","API",{unique:i.length,total:s.length}),i}catch(a){return W.logError("ApiService.getUserTransactions",a,{account:e,limit:t}),[]}}async getUserStats(e){try{let a="2023-01-01";try{const t=await this.getWaxAccountInfo(e);if(t?.created){a=new Date(t.created).toISOString().split("T")[0]}}catch(t){q.warn("Failed to fetch account creation date","API",{account:e,error:t})}const s=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicassets/v1/assets?owner=${e}&page=1&limit=1`,n=await this.fetchWithRetry(s),i=await n.json(),r=i.success&&(i.query_total||i.data?.length)||0,l=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?seller=${e}&state=3&page=1&limit=100&order=desc&sort=updated`,c=await this.fetchWithRetry(l),o=await c.json();let d=0,u=0;const m=new Set;o.success&&o.data&&(d=o.data.length,o.data.forEach(e=>{u+=parseFloat(e.price.amount)||0,e.assets[0]?.collection?.collection_name&&m.add(e.assets[0].collection.collection_name)}));const h=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?buyer=${e}&state=3&page=1&limit=100&order=desc&sort=updated`,p=await this.fetchWithRetry(h),f=await p.json();let x=0,g=0;return f.success&&f.data&&(x=f.data.length,f.data.forEach(e=>{g+=parseFloat(e.price.amount)||0,e.assets[0]?.collection?.collection_name&&m.add(e.assets[0].collection.collection_name)})),{totalAssets:r,totalPurchases:x,totalSales:d,totalSpent:D(g),totalEarned:D(u),collections:Array.from(m),favoriteCollections:Array.from(m).slice(0,3),joinDate:a,nftsOwned:r,nftsListed:0}}catch(a){return W.logError("ApiService.getUserStats",a,{account:e}),{totalAssets:0,totalPurchases:0,totalSales:0,totalSpent:"0.0000 WAX",totalEarned:"0.0000 WAX",collections:[],favoriteCollections:[],joinDate:"2023-01-01",nftsOwned:0,nftsListed:0}}}async getCollectionPriceHistory(e,t="7d"){try{const t=`${this.atomicEndpoints[this.currentEndpointIndex]}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=100&order=desc&sort=updated`,a=await this.fetchWithRetry(t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=await a.json();return s.data.map(e=>({timestamp:new Date(e.updated_at_time).getTime(),price:parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision),volume:1}))}catch(a){return W.logError("ApiService.getCollectionPriceHistory",a,{collectionName:e,timeframe:t}),this.fetchPriceHistoryFromAlcor(e,t)}}async fetchPriceHistoryFromAlcor(e,t){try{const a=await fetch(`${this.alcorAPI}/markets/1/charts?resolution=1D&limit=100`);if(a.ok){const e=await a.json();if(e&&Array.isArray(e)){const a="24h"===t?1:"7d"===t?7:"30d"===t?30:90;return e.slice(-a).map(e=>({timestamp:1e3*e.time,price:parseFloat(e.close||e.price||"1"),volume:parseFloat(e.volume||"0")}))}}const s=await this.getCollectionMarketStats({collection_name:e});if(s.success&&s.data){const e=parseFloat(s.data.suggested_average||"1"),a=Date.now(),n="24h"===t?1:"7d"===t?7:"30d"===t?30:90,i=[];for(let t=n;t>=0;t--){const r=a-24*t*60*60*1e3,l=e*(.9+.2*Math.random()),c=parseFloat(s.data.volume||"0")/n;i.push({timestamp:r,price:l,volume:c})}return i}return[]}catch(a){return W.logError("ApiService.fetchPriceHistoryFromAlcor",a,{collectionName:e,timeframe:t}),[]}}async getAuctionBids(e){try{return[]}catch(t){return W.logError("ApiService.getAuctionBids",t,{auctionId:e}),[]}}async getAuctions(e={}){const{state:t=1,limit:a=36,offset:s=0,sort:n="created",order:i="desc",hide_empty_auctions:r=!0,search:l,collection_name:c,collection_blacklist:o="flinttffunko,onlyfanzgaly,farmerpetsco,fantaspeop",seller_blacklist:d="dximg.wam,xpvrs.wam,5rrrc.wam,nnmnmnmnn.gm",symbol:u="WAX"}=e;try{let e=`${this.atomicMarketAPI}/atomicmarket/v1/auctions?limit=${a}&offset=${s}&sort=${n}&order=${i}&symbol=${u}`;void 0!==t&&(e+=`&state=${t}`),r&&(e+="&hide_empty_auctions=true"),l&&(e+=`&search=${encodeURIComponent(l)}`),c&&(e+=`&collection_name=${encodeURIComponent(c)}`),o&&(e+=`&collection_blacklist=${encodeURIComponent(o)}`),d&&(e+=`&seller_blacklist=${encodeURIComponent(d)}`);const m=await this.fetchWithRetry(e);if(!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const h=await m.json();if(!h.success||!h.data)throw new Error("Invalid API response structure");return{data:h.data.map(e=>{const t=e.assets?.[0],a=t?.name||t?.data?.name||t?.template?.immutable_data?.name||`${t?.collection?.collection_name||"Unknown"} #${t?.asset_id}`,s=e.price?.amount||"0",n=e.price?.token_symbol||"WAX",i=e.price?.token_precision||8,r="0"!==s?`${(parseFloat(s)/Math.pow(10,i)).toFixed(i)} ${n}`:"0 WAX";return{auction_id:e.auction_id,asset_id:t?.asset_id||"",seller:e.seller,price:r,end_time:e.end_time,collection_name:t?.collection?.collection_name||"Unknown",template_id:t?.template?.template_id||"",asset_name:a,image:t?this.getAssetImage(t):"https://pixeljourney.xyz/img/toppixals/10.webp",video:t&&this.getAssetVideo(t)||"",current_bid:r,bidder:e.buyer||null,created_at_time:e.created_at_time}}),success:!0}}catch(m){return W.logError("ApiService.getAuctions",m,{state:t,limit:a,offset:s,sort:n,order:i}),{data:[],success:!1,error:m}}}async getAuction(e){try{const t=`${this.atomicMarketAPI}/atomicmarket/v1/auctions/${e}`,a=await this.fetchWithRetry(t);if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const s=await a.json();if(!s.success||!s.data)throw new Error("Invalid API response structure");const n=s.data;return{data:{auction_id:n.auction_id,asset_id:n.assets?.[0]?.asset_id||"",seller:n.seller,price:n.price?.amount||"0",end_time:n.end_time,collection_name:n.assets?.[0]?.collection?.collection_name||"Unknown",template_id:n.assets?.[0]?.template?.template_id||"",asset_name:n.assets?.[0]?.name||n.assets?.[0]?.data?.name||`Asset #${n.assets?.[0]?.asset_id}`,image:n.assets?.[0]?this.getAssetImage(n.assets[0]):"",video:n.assets?.[0]?this.getAssetVideo(n.assets[0]):"",current_bid:n.price?.amount||"0",bidder:n.buyer||null},success:!0}}catch(t){return W.logError("ApiService.getAuction",t,{auctionId:e}),{data:null,success:!1,error:t}}}async getUSDPrice(e){try{const{priceService:t}=await h(async()=>{const{priceService:e}=await Promise.resolve().then(()=>re);return{priceService:e}},void 0);return await t.convertWaxToUSDAsync(e.toString())}catch(t){return W.logError("ApiService.getUSDPrice",t,{waxAmount:e}),"$0.00"}}async waxRpcCall(e,t){for(let s=0;s<this.waxChainEndpoints.length;s++){const n=this.waxChainEndpoints[s],i=`${n}${e}`;try{const e=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},mode:"cors",body:JSON.stringify(t)});if(e.ok)return this.currentWaxChainIndex=s,await e.json();q.warn("WAX RPC endpoint returned error status","API",{endpoint:n,status:e.status,statusText:e.statusText})}catch(a){W.logError("ApiService.waxRpcCall",a,{endpoint:n,body:t})}}throw new Error(`All WAX RPC endpoints failed for ${e}`)}async getPowerupState(){return this.waxRpcCall("/v1/chain/get_table_rows",{json:!0,code:"eosio",scope:"eosio",table:"powup.state",limit:1})}async getChainInfo(){return this.waxRpcCall("/v1/chain/get_info",{})}async getRWAXTransfers(e={}){try{const{limit:t=20,page:a=1,order:s="desc"}=e,[n,i]=await Promise.all([this.getTransfers({recipient_name:"rwax",collection_name:"pixeljourney",limit:Math.ceil(t/2),page:a,order:s,sort:"created"}),this.getTransfers({sender:"rwax",collection_name:"pixeljourney",limit:Math.ceil(t/2),page:a,order:s,sort:"created"})]),r=[...n.data.map(e=>({...e,type:"tokenization"})),...i.data.map(e=>({...e,type:"redemption"}))],l=new Map;r.forEach(e=>{const t=`${e.transfer_id}-${e.txid}`;if(l.has(t)){const a=l.get(t),s=e.assets.length>a.assets.length,n=Object.keys(e).length>Object.keys(a).length;(s||n)&&l.set(t,e)}else l.set(t,e)});const c=Array.from(l.values());c.sort((e,t)=>{const a=new Date(e.created_at_time).getTime(),n=new Date(t.created_at_time).getTime();return"desc"===s?n-a:a-n});return{success:!0,data:c.slice(0,t),query_total:(n.query_total||0)+(i.query_total||0)}}catch(t){return W.logError("ApiService.getRWAXTransfers",t,e),{success:!1,data:[]}}}},je=Object.freeze(Object.defineProperty({__proto__:null,apiService:ye},Symbol.toStringTag,{value:"Module"}));const be=new class{badgeCache=new Map;CACHE_DURATION=3e5;BADGE_DEFINITIONS={"pixal-pfp":{id:"pixal-pfp",name:"Pixal PFP",description:"Owns a Pixal PFP NFT (Template 781515)",icon:"🎭",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"Own Template 781515"},"pixal-collector-5":{id:"pixal-collector-5",name:"Pixal Collector I",description:"Owns 5+ Pixal PFPs",icon:"🎭",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"5+ Pixal PFPs",tier:1},"pixal-collector-25":{id:"pixal-collector-25",name:"Pixal Collector II",description:"Owns 25+ Pixal PFPs",icon:"🎭",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"25+ Pixal PFPs",tier:2,rarity:"rare"},"pixal-collector-50":{id:"pixal-collector-50",name:"Pixal Collector III",description:"Owns 50+ Pixal PFPs",icon:"🎭",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"50+ Pixal PFPs",tier:3,rarity:"epic"},"pixal-collector-100":{id:"pixal-collector-100",name:"Pixal Collector IV",description:"Owns 100+ Pixal PFPs",icon:"🎭",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"100+ Pixal PFPs",tier:4,rarity:"epic"},"pixal-collector-250":{id:"pixal-collector-250",name:"Pixal Collector V",description:"Owns 250+ Pixal PFPs",icon:"🎭",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"ownership",requirements:"250+ Pixal PFPs",tier:5,rarity:"legendary"},waxrock:{id:"waxrock",name:"WaxRock",description:"Owns WaxRock Pixal NFT",icon:"🪨",color:"#f59e0b",borderColor:"rgba(245, 158, 11, 0.3)",type:"ownership",requirements:"Own WaxRock NFTs"},"waxrock-collector-3":{id:"waxrock-collector-3",name:"WaxRock Collector I",description:"Owns 3+ WaxRock trait Pixals",icon:"🪨",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"3+ WaxRock trait Pixals",tier:1},"waxrock-collector-6":{id:"waxrock-collector-6",name:"WaxRock Collector II",description:"Owns 6+ WaxRock trait Pixals",icon:"🪨",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"6+ WaxRock trait Pixals",tier:2,rarity:"rare"},"waxrock-collector-10":{id:"waxrock-collector-10",name:"WaxRock Collector III",description:"Owns 10+ WaxRock trait Pixals",icon:"🪨",color:"#78716c",borderColor:"rgba(120, 113, 108, 0.3)",type:"ownership",requirements:"10+ WaxRock trait Pixals",tier:3,rarity:"epic"},ingredients:{id:"ingredients",name:"Ingredients",description:"Owns Pixel Journey Ingredients",icon:"🧪",color:"#22c55e",borderColor:"rgba(34, 197, 94, 0.3)",type:"ownership",requirements:"Own Ingredient NFTs"},"pxj-whale":{id:"pxj-whale",name:"PXJ Whale",description:"Holds 50,000,000+ PXJ tokens",icon:"🐋",color:"#3b82f6",borderColor:"rgba(59, 130, 246, 0.3)",type:"holdings",requirements:"50,000,000+ PXJ",rarity:"legendary"},"pxj-holder":{id:"pxj-holder",name:"PXJ Holder",description:"Holds 100,000+ PXJ tokens",icon:"💎",color:"#8b5cf6",borderColor:"rgba(139, 92, 246, 0.3)",type:"holdings",requirements:"100,000+ PXJ"},"pxj-shrimp":{id:"pxj-shrimp",name:"PXJ Shrimp",description:"Holds 10,000+ PXJ tokens",icon:"🦐",color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)",type:"holdings",requirements:"10,000+ PXJ"},"wpixal-holder":{id:"wpixal-holder",name:"WPIXAL Holder",description:"Owns WPIXAL tokens",icon:"🪙",color:"#a855f7",borderColor:"rgba(168, 85, 247, 0.3)",type:"holdings",requirements:"Own WPIXAL tokens"},"king-holder":{id:"king-holder",name:"KING Holder",description:"Holds KING tokens",icon:"👑",color:"#fbbf24",borderColor:"rgba(251, 191, 36, 0.3)",type:"holdings",requirements:"Hold KING tokens"},"journey-collector":{id:"journey-collector",name:"Journey Collector",description:"Owns 50+ Journey assets",icon:"🎒",color:"#ec4899",borderColor:"rgba(236, 72, 153, 0.3)",type:"ownership",requirements:"50+ Journey Assets"},"journey-enthusiast":{id:"journey-enthusiast",name:"Journey Enthusiast",description:"Owns 10+ Journey assets",icon:"⭐",color:"#f97316",borderColor:"rgba(249, 115, 22, 0.3)",type:"ownership",requirements:"10+ Journey Assets"},"early-adopter":{id:"early-adopter",name:"Early Adopter",description:"One of the first Journey participants",icon:"🚀",color:"#06b6d4",borderColor:"rgba(6, 182, 212, 0.3)",type:"special",requirements:"Early participation",rarity:"legendary"},"active-trader":{id:"active-trader",name:"Active Trader",description:"Completed 100+ transactions",icon:"📈",color:"#10b981",borderColor:"rgba(16, 185, 129, 0.3)",type:"trading",requirements:"100+ Transactions",rarity:"rare"},"volume-trader":{id:"volume-trader",name:"Volume Trader",description:"Traded 10,000+ WAX in volume",icon:"💰",color:"#f59e0b",borderColor:"rgba(245, 158, 11, 0.3)",type:"trading",requirements:"10,000+ WAX Volume",rarity:"epic"},"community-member":{id:"community-member",name:"Community Member",description:"Active community participant",icon:"👥",color:"#8b5cf6",borderColor:"rgba(139, 92, 246, 0.3)",type:"social",requirements:"Community Engagement",rarity:"common"},"diamond-hands":{id:"diamond-hands",name:"Diamond Hands",description:"Held assets for 6+ months",icon:"💎",color:"#3b82f6",borderColor:"rgba(59, 130, 246, 0.3)",type:"achievement",requirements:"6+ Months Holding",rarity:"epic"},"master-collector":{id:"master-collector",name:"Master Collector",description:"Owns 500+ Journey assets",icon:"🏆",color:"#dc2626",borderColor:"rgba(220, 38, 38, 0.3)",type:"ownership",requirements:"500+ Journey Assets",rarity:"legendary"}};async checkUserBadges(e,t=!1){if(!t){const t=this.badgeCache.get(e);if(t&&Date.now()<t.expiresAt)return t.result}try{const[t,a,s]=await Promise.all([ye.getUserInventory(e),this.getPXJBalance(e),this.getTradingStats(e)]),n=[];let i=0,r=!1,l=!1,c=!1;const o=s.volume,d=s.transactions,u=s.accountAge;if(t&&t.length>0){i=t.filter(e=>"pixeljourney"===e.collection).length;const e=t.filter(e=>"781515"===e.template_id).length;r=e>0,r&&n.push(this.BADGE_DEFINITIONS["pixal-pfp"]),e>=250?n.push({...this.BADGE_DEFINITIONS["pixal-collector-250"],unlockedAt:new Date}):e>=100?n.push({...this.BADGE_DEFINITIONS["pixal-collector-100"],unlockedAt:new Date,progress:{current:e,required:250,percentage:Math.round(e/250*100)}}):e>=50?n.push({...this.BADGE_DEFINITIONS["pixal-collector-50"],unlockedAt:new Date,progress:{current:e,required:100,percentage:Math.round(e/100*100)}}):e>=25?n.push({...this.BADGE_DEFINITIONS["pixal-collector-25"],unlockedAt:new Date,progress:{current:e,required:50,percentage:Math.round(e/50*100)}}):e>=5&&n.push({...this.BADGE_DEFINITIONS["pixal-collector-5"],unlockedAt:new Date,progress:{current:e,required:25,percentage:Math.round(e/25*100)}});const a=t.filter(e=>{if(e.template_id===ae.getPixalTemplateId()){const t=e.traits?.WaxRock;if("string"==typeof t&&"none"!==t)return ae.isValidWaxRock(t);if(e.data){const t=Object.values(e.traits||{}).find(e=>"string"==typeof e&&ae.isValidWaxRock(e));return t&&"none"!==t}}return!1}).length;l=a>0,l&&n.push(this.BADGE_DEFINITIONS.waxrock),a>=10?n.push({...this.BADGE_DEFINITIONS["waxrock-collector-10"],unlockedAt:new Date}):a>=6?n.push({...this.BADGE_DEFINITIONS["waxrock-collector-6"],unlockedAt:new Date,progress:{current:a,required:10,percentage:Math.round(a/10*100)}}):a>=3&&n.push({...this.BADGE_DEFINITIONS["waxrock-collector-3"],unlockedAt:new Date,progress:{current:a,required:6,percentage:Math.round(a/6*100)}}),c=t.some(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema),c&&n.push(this.BADGE_DEFINITIONS.ingredients),i>=500?n.push({...this.BADGE_DEFINITIONS["master-collector"],unlockedAt:new Date}):i>=50?n.push({...this.BADGE_DEFINITIONS["journey-collector"],unlockedAt:new Date,progress:i<500?{current:i,required:500,percentage:Math.round(i/500*100)}:void 0}):i>=10&&n.push({...this.BADGE_DEFINITIONS["journey-enthusiast"],unlockedAt:new Date,progress:{current:i,required:50,percentage:Math.round(i/50*100)}})}a>=5e7?n.push({...this.BADGE_DEFINITIONS["pxj-whale"],unlockedAt:new Date}):a>=1e5?n.push({...this.BADGE_DEFINITIONS["pxj-holder"],unlockedAt:new Date,progress:a<5e7?{current:a,required:5e7,percentage:Math.round(a/5e7*100)}:void 0}):a>=1e4&&n.push({...this.BADGE_DEFINITIONS["pxj-shrimp"],unlockedAt:new Date,progress:a<1e5?{current:a,required:1e5,percentage:Math.round(a/1e5*100)}:void 0});const[m,h]=await Promise.all([this.getTokenBalance(e,"pixeljourney","WPIXAL"),this.getTokenBalance(e,"alpha.waxfun","KING")]);m>0&&n.push({...this.BADGE_DEFINITIONS["wpixal-holder"],unlockedAt:new Date}),h>0&&n.push({...this.BADGE_DEFINITIONS["king-holder"],unlockedAt:new Date}),d>=100&&n.push({...this.BADGE_DEFINITIONS["active-trader"],unlockedAt:new Date}),o>=1e4&&n.push({...this.BADGE_DEFINITIONS["volume-trader"],unlockedAt:new Date}),u>=180&&n.push({...this.BADGE_DEFINITIONS["diamond-hands"],unlockedAt:new Date});new Set(n.map(e=>e.type)).size>=3&&n.push({...this.BADGE_DEFINITIONS["community-member"],unlockedAt:new Date});await this.checkEarlyAdopterStatus(e)&&n.push(this.BADGE_DEFINITIONS["early-adopter"]);const p={badges:n,pxjBalance:a,journeyAssets:i,pixalPfpOwned:r,waxrockOwned:l,ingredientsOwned:c,tradingVolume:o,totalTransactions:d,accountAge:u};return this.badgeCache.set(e,{result:p,timestamp:Date.now(),expiresAt:Date.now()+this.CACHE_DURATION}),p}catch(a){return W.logError("BadgeService.checkUserBadges",a,{userAccount:e}),{badges:[],pxjBalance:0,journeyAssets:0,pixalPfpOwned:!1,waxrockOwned:!1,ingredientsOwned:!1,tradingVolume:0,totalTransactions:0,accountAge:0}}}async getPXJBalance(e){try{const t=await ye.fetchWithRetry(`${te.WAX_CHAIN.EOSRIO}/v2/state/get_tokens?account=${e}`),a=await t.json();if(a.tokens){const e=a.tokens.find(e=>"PXJ"===e.symbol&&"pixeljourney"===e.contract);return e?parseFloat(e.amount):0}return 0}catch(t){return W.logError("BadgeService.getPXJBalance",t,{userAccount:e}),0}}async getTradingStats(e){try{return{volume:5e4*Math.random(),transactions:Math.floor(200*Math.random()),accountAge:Math.floor(365*Math.random())}}catch(t){return W.logError("BadgeService.getTradingStats",t,{userAccount:e}),{volume:0,transactions:0,accountAge:0}}}async getTokenBalance(e,t,a){try{const s=await ye.fetchWithRetry(`${te.WAX_CHAIN.GREYMASS}/get_table_rows`,3,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:t,scope:e,table:"accounts",limit:100})}),n=await s.json();if(n.rows&&n.rows.length>0){const e=n.rows.find(e=>e.balance&&e.balance.includes(a));if(e){const t=e.balance.split(" ")[0];return parseFloat(t)||0}}return 0}catch(s){return W.logError("BadgeService.getTokenBalance",s,{userAccount:e,contract:t,symbol:a}),0}}async checkEarlyAdopterStatus(e){try{const t=await ye.fetchWithRetry(`${te.WAX_CHAIN.EOSRIO}/v2/history/get_actions?account=${e}&limit=1&sort=asc`),a=await t.json();if(a.actions&&a.actions.length>0){const e=a.actions[0],t=new Date(e.timestamp);return t<new Date("2023-01-01")}return!1}catch(t){return W.logError("BadgeService.checkEarlyAdopterStatus",t,{userAccount:e}),!1}}getBadgeDefinition(e){return this.BADGE_DEFINITIONS[e]}getAllBadgeDefinitions(){return Object.values(this.BADGE_DEFINITIONS)}async hasUserBadge(e,t){return(await this.checkUserBadges(e)).badges.some(e=>e.id===t)}async getUserBadgeStats(e){const t=await this.checkUserBadges(e);return this.getBadgeStatistics(t.badges)}getBadgeStatistics(e){const t={},a={},s=e.filter(e=>e.unlockedAt).sort((e,t)=>new Date(t.unlockedAt).getTime()-new Date(e.unlockedAt).getTime()).slice(0,5),n=e.filter(e=>e.progress);return e.forEach(e=>{t[e.type]=(t[e.type]||0)+1,e.rarity&&(a[e.rarity]=(a[e.rarity]||0)+1)}),{totalBadges:e.length,badgesByType:t,badgesByRarity:a,recentBadges:s,progressBadges:n}}clearBadgeCache(e){e?this.badgeCache.delete(e):this.badgeCache.clear()}getBadgeProgress(e,t){const a=this.badgeCache.get(e);if(!a)return null;const s=a.result.badges.find(e=>e.id===t);return s?.progress?{badgeId:t,current:s.progress.current,required:s.progress.required,percentage:s.progress.percentage}:null}async getAllBadgeDefinitionsWithProgress(e){const t=await this.checkUserBadges(e),a=new Set(t.badges.map(e=>e.id));return Object.values(this.BADGE_DEFINITIONS).map(e=>{const s=t.badges.find(t=>t.id===e.id);return{...e,earned:a.has(e.id),progress:s?.progress,unlockedAt:s?.unlockedAt}})}};const Ne=new class{balanceCache=new Map;CACHE_DURATION=3e4;async getWaxBalance(e,t=!1){if(!e)return"0.0000 WAX";const a=`wax_${e}`,s=this.balanceCache.get(a),n=Date.now();if(!t&&s&&n-s.lastUpdated<this.CACHE_DURATION)return s.balance;try{const t=await ye.getLightApiBalances(e);if(t&&t.balances){const e=t.balances.find(e=>"WAX"===e.currency&&"eosio.token"===e.contract);if(e){const t=`${e.amount} ${e.currency}`;return this.balanceCache.set(a,{balance:t,lastUpdated:n}),t}}}catch(i){G("Light API balance fetch failed, falling back to currency balance API","BalanceService",{error:i})}try{const t=await ye.getWaxCurrencyBalance(e,"eosio.token","WAX");if(t&&t.length>0){const e=t[0].balance;return this.balanceCache.set(a,{balance:e,lastUpdated:n}),e}}catch(i){K("Failed to fetch WAX balance","BalanceService",i)}return"0.0000 WAX"}clearCache(e){e?this.balanceCache.delete(`wax_${e}`):this.balanceCache.clear()}isCached(e){const t=this.balanceCache.get(`wax_${e}`);if(!t)return!1;return Date.now()-t.lastUpdated<this.CACHE_DURATION}},we=a.createContext(void 0),ke=({children:e})=>{const[t,n]=a.useState([]),i=s.useRef(null),[r,l]=a.useState(null),[c,o]=a.useState(()=>{const e=localStorage.getItem("notification-sound-enabled");return null===e||JSON.parse(e)}),[d]=a.useState(5);a.useEffect(()=>{localStorage.setItem("notification-sound-enabled",JSON.stringify(c))},[c]);const u=e=>{const t=Date.now().toString()+Math.random().toString(36).substr(2,9),a={...e,id:t,duration:e.duration??5e3};n(e=>{const t=[...e,a];return t.length>d?t.slice(-d):t}),a.duration&&a.duration>0&&setTimeout(()=>{m(t)},a.duration)},m=e=>{n(t=>t.filter(t=>t.id!==e))},h=e=>{i.current&&(i.current(e),i.current=null),l(null)},p={notifications:t,addNotification:u,removeNotification:m,clearAllNotifications:()=>{n([])},showSuccess:(e,t,a)=>{u({type:"success",message:e,title:t,duration:a})},showError:(e,t,a)=>{u({type:"error",message:e,title:t,duration:a})},showWarning:(e,t,a)=>{u({type:"warning",message:e,title:t,duration:a})},showInfo:(e,t,a)=>{u({type:"info",message:e,title:t,duration:a})},confirm:(e,t,a="Confirm",s="Cancel")=>new Promise(n=>{l({title:e,message:t,confirmText:a,cancelText:s}),i.current=n}),confirmDialog:r,resolveConfirm:h,soundEnabled:c,toggleSound:()=>{o(e=>!e)}};return A.jsxs(we.Provider,{value:p,children:[e,r&&A.jsx("div",{className:"modal-overlay",children:A.jsxs("div",{className:"modal-content confirm-dialog",children:[A.jsx("div",{className:"modal-header",children:A.jsx("h3",{children:r.title||"Confirm Action"})}),A.jsx("div",{className:"modal-body",children:A.jsx("p",{children:r.message})}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"btn-secondary",onClick:()=>h(!1),children:r.cancelText}),A.jsx("button",{className:"btn-primary",onClick:()=>h(!0),children:r.confirmText})]})]})})]})},_e=()=>{const e=a.useContext(we);if(void 0===e)throw new Error("useNotifications must be used within a NotificationProvider");return e},Se=({isOpen:e,onClose:t})=>{const{isConnected:s,login:n,purchaseNFT:i,batchPurchaseNFTs:r}=R(),{showError:l}=_e(),[c,o]=a.useState([]),[d,u]=a.useState({totalWAX:"0.0000 WAX",totalUSD:"$0.00",itemCount:0}),[m,h]=a.useState(!1),[p,f]=a.useState(new Set),[x,g]=a.useState(20),[v,y]=a.useState(!0),j=a.useCallback(async()=>{h(!0);try{await ce.checkAvailability();const t=ce.getCart();o(t),f(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)));try{const e=await ce.calculateTotals();u(e)}catch(e){K("Failed to calculate totals","ShoppingCart",e),l("Calculation Error","Unable to calculate cart totals. Some prices may be outdated.")}}catch(t){K("Failed to load cart data","ShoppingCart",t),l("Cart Error","Unable to load cart data. Please try refreshing the page.")}finally{h(!1)}},[l]);a.useEffect(()=>{e&&j();const t=e=>{o(e),ce.calculateTotals().then(e=>{u(e)}).catch(e=>{K("Failed to calculate totals in cart change handler","ShoppingCart",e)})};return ce.addListener(t),()=>ce.removeListener(t)},[e,j]);const b=e=>{ce.removeFromCart(e),f(t=>{const a=new Set(t);return a.delete(e),a})},N=c.filter(e=>!1!==e.isAvailable),w=c.filter(e=>!1===e.isAvailable);if(!e)return null;return A.jsx("div",{className:"modal-backdrop",onClick:e=>{e.target===e.currentTarget&&t()},role:"dialog","aria-modal":"true","aria-labelledby":"cart-title",children:A.jsxs("div",{className:"modal-content shopping-cart-modal",children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h2",{className:"modal-title",id:"cart-title",children:["Shopping Cart (",d.itemCount," ",1===d.itemCount?"item":"items",")"]}),A.jsx("button",{className:"modal-close",onClick:t,"aria-label":"Close shopping cart",type:"button",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsx("div",{className:"modal-body cart-body",children:m?A.jsxs("div",{className:"cart-loading",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Checking item availability..."})]}):0===c.length?A.jsxs("div",{className:"cart-empty",children:[A.jsx("div",{className:"empty-cart-icon",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"9",cy:"21",r:"1"}),A.jsx("circle",{cx:"20",cy:"21",r:"1"}),A.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})}),A.jsx("h3",{children:"Your cart is empty"}),A.jsx("p",{children:"Add some NFTs from the marketplace to get started!"})]}):A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:"cart-controls",children:[A.jsxs("div",{className:"cart-actions-left",children:[A.jsx("button",{className:"btn-select-all",onClick:()=>{const e=c.filter(e=>!1!==e.isAvailable);e.filter(e=>e.selected).length===e.length&&e.length>0?ce.deselectAll():ce.selectAll();const t=ce.getCart();o(t),f(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)))},"aria-label":p.size===N.length&&N.length>0?`Deselect all ${N.length} items`:`Select all ${N.length} items`,type:"button",children:p.size===N.length&&N.length>0?"Deselect All":"Select All"}),w.length>0&&A.jsxs("button",{className:"btn-cleanup",onClick:()=>{ce.cleanupUnavailableItems()},"aria-label":`Remove ${w.length} unavailable items from cart`,type:"button",children:["Remove Unavailable (",w.length,")"]})]}),A.jsx("button",{className:"btn-clear-cart",onClick:()=>{confirm("Are you sure you want to clear your entire cart?")&&(ce.clearCart(),f(new Set))},"aria-label":"Clear all items from cart",type:"button",children:"Clear Cart"})]}),N.length>1&&A.jsxs("div",{className:"batch-settings",role:"group","aria-labelledby":"batch-settings-label",children:[A.jsxs("div",{className:"batch-toggle",children:[A.jsxs("label",{children:[A.jsx("input",{type:"checkbox",checked:v,onChange:e=>y(e.target.checked),"aria-describedby":"batch-purchase-description"}),A.jsx("span",{id:"batch-settings-label",children:"Use batch purchasing"})]}),A.jsx("div",{id:"batch-purchase-description",className:"sr-only",children:"Batch purchasing allows you to buy multiple items in a single transaction, which is faster and more efficient."})]}),v&&A.jsxs("div",{className:"batch-controls",children:[A.jsx("label",{htmlFor:"items-per-tx",children:"Items per transaction:"}),A.jsxs("div",{className:"batch-slider",children:[A.jsx("input",{id:"items-per-tx",type:"range",min:"1",max:"50",value:x,onChange:e=>g(parseInt(e.target.value))}),A.jsx("span",{className:"batch-value",children:x})]}),A.jsx("div",{className:"batch-info",children:p.size>x&&A.jsxs("small",{children:["Will create ",Math.ceil(p.size/x)," transaction",Math.ceil(p.size/x)>1?"s":""]})})]})]}),N.length>0&&A.jsxs("div",{className:"cart-section",children:[A.jsx("h3",{className:"section-title",children:"Available Items"}),A.jsx("div",{className:"cart-items",children:N.map(e=>A.jsxs("div",{className:"cart-item",children:[A.jsx("div",{className:"item-checkbox",children:A.jsx("input",{type:"checkbox",checked:p.has(e.nft.asset_id),onChange:()=>(e=>{ce.toggleSelection(e);const t=ce.getCart();o(t),f(new Set(t.filter(e=>e.selected).map(e=>e.nft.asset_id)))})(e.nft.asset_id),"aria-label":`Select ${e.nft.name} for purchase`,id:`item-${e.nft.asset_id}`})}),A.jsx("div",{className:"item-image",children:e.nft.video?A.jsx("video",{src:e.nft.video,className:"cart-item-media",muted:!0,onError:t=>{const a=document.createElement("img");a.src=e.nft.image,a.className="cart-item-media",a.alt=e.nft.name,t.currentTarget.parentNode?.replaceChild(a,t.currentTarget)}}):A.jsx("img",{src:e.nft.image,alt:`${e.nft.name} from ${e.nft.collection}`,className:"cart-item-media"})}),A.jsxs("div",{className:"item-details",children:[A.jsx("h4",{className:"item-name",children:e.nft.name}),A.jsx("p",{className:"item-collection",children:e.nft.collection}),A.jsx("div",{className:"item-price","aria-label":`Price: ${e.nft.price}`,children:A.jsx("span",{className:"price-wax",children:e.nft.price})})]}),A.jsx("button",{className:"btn-remove",onClick:()=>b(e.nft.asset_id),title:"Remove from cart","aria-label":`Remove ${e.nft.name} from cart`,type:"button",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[A.jsx("polyline",{points:"3,6 5,6 21,6"}),A.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]})})]},e.nft.asset_id))})]}),w.length>0&&A.jsxs("div",{className:"cart-section",children:[A.jsxs("h3",{className:"section-title unavailable-title",children:["Unavailable Items (",w.length,")"]}),A.jsx("div",{className:"cart-items unavailable-items",children:w.map(e=>A.jsxs("div",{className:"cart-item unavailable",children:[A.jsxs("div",{className:"item-image",children:[A.jsx("img",{src:e.nft.image,alt:e.nft.name,className:"cart-item-media"}),A.jsx("div",{className:"unavailable-overlay",children:"Unavailable"})]}),A.jsxs("div",{className:"item-details",children:[A.jsx("h4",{className:"item-name",children:e.nft.name}),A.jsx("p",{className:"item-collection",children:e.nft.collection}),A.jsx("div",{className:"item-price",children:A.jsx("span",{className:"price-wax",children:e.nft.price})})]}),A.jsx("button",{className:"btn-remove",onClick:()=>b(e.nft.asset_id),title:"Remove from cart",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("polyline",{points:"3,6 5,6 21,6"}),A.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]})})]},e.nft.asset_id))})]})]})}),c.length>0&&A.jsxs("div",{className:"modal-footer cart-footer",children:[A.jsx("div",{className:"cart-totals",children:A.jsxs("div",{className:"total-line",children:[A.jsxs("span",{className:"total-label",children:["Total (",p.size," selected):"]}),A.jsxs("div",{className:"total-prices",children:[A.jsx("span",{className:"total-wax",children:d.totalWAX}),A.jsx("span",{className:"total-usd",children:d.totalUSD})]})]})}),A.jsxs("div",{className:"cart-actions",children:[A.jsx("button",{className:"btn-secondary",onClick:t,type:"button","aria-label":"Continue shopping and close cart",children:"Continue Shopping"}),A.jsxs("button",{className:"btn-primary",onClick:async()=>{const e=ce.getSelectedItems().filter(e=>!1!==e.isAvailable);if(0===e.length)return void alert("Please select items to purchase");if(!s)try{await n()}catch(o){return K("Login failed","ShoppingCart",o),void l("Login Failed","Please connect your wallet to purchase NFTs")}let t=0;const a=[];if(v&&e.length>1){const s=[];for(let t=0;t<e.length;t+=x)s.push(e.slice(t,t+x));for(let e=0;e<s.length;e++){const n=s[e],i=n.filter(e=>e.nft.sale_id&&e.nft.price).map(e=>({saleId:e.nft.sale_id,price:e.nft.price.replace(" WAX","")}));if(0!==i.length)try{await r(i),n.forEach(e=>{e.nft.sale_id&&(ce.removeFromCart(e.nft.asset_id),f(t=>{const a=new Set(t);return a.delete(e.nft.asset_id),a}),t++)}),e<s.length-1&&await new Promise(e=>setTimeout(e,2e3))}catch(o){K("Batch purchase failed","ShoppingCart",o),l("Batch Purchase Failed",`Failed to purchase batch of ${n.length} items`),n.forEach(e=>{a.push(`${e.nft.name} (batch failed: ${o instanceof Error?o.message:"Unknown error"})`)})}else n.forEach(e=>{e.nft.sale_id||a.push(`${e.nft.name} (not for sale)`)})}}else for(const s of e)try{if(!s.nft.sale_id||!s.nft.price){a.push(`${s.nft.name} (not for sale)`);continue}await i(s.nft.sale_id,s.nft.price.replace(" WAX","")),t++,ce.removeFromCart(s.nft.asset_id),f(e=>{const t=new Set(e);return t.delete(s.nft.asset_id),t}),e.length>1&&await new Promise(e=>setTimeout(e,1e3))}catch(o){K(`Purchase failed for ${s.nft.name}`,"ShoppingCart",o),l("Purchase Failed",`Failed to purchase ${s.nft.name}`),a.push(`${s.nft.name} (${o instanceof Error?o.message:"Unknown error"})`)}let c="Purchase completed!\n\n";t>0&&(c+=`✅ Successfully purchased ${t} item${1!==t?"s":""}\n`),a.length>0&&(c+=`\n❌ Failed purchases:\n${a.join("\n")}`),alert(c)},disabled:0===p.size,type:"button","aria-label":`Buy ${p.size} selected items`,"aria-describedby":"cart-totals",children:["Buy Selected (",p.size,")"]})]})]})]})})};const Ce=new class{preferences;focusStack=[];trapFocusElements=[];isInitialized=!1;mediaQueryListeners=[];keyboardNavigationActive=!1;constructor(){this.preferences=this.getDefaultPreferences(),this.detectSystemPreferences()}getDefaultPreferences(){return{reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0}}async initialize(){if(!this.isInitialized)try{this.loadPreferences(),this.setupMediaQueryListeners(),this.setupKeyboardNavigation(),this.applyAccessibilitySettings(),this.setupFocusManagement(),this.isInitialized=!0,me.trackEvent("accessibility_service_initialized",{preferences:this.preferences,systemPreferences:this.detectSystemPreferences()}),q.info("Accessibility service initialized","ACCESSIBILITY")}catch(e){q.error("Failed to initialize accessibility service","ACCESSIBILITY",e),me.reportError(e,"accessibility_init_error")}}detectSystemPreferences(){const e={};return window.matchMedia&&(e.reducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches,e.highContrast=window.matchMedia("(prefers-contrast: high)").matches),e.screenReader=this.detectScreenReader(),e}detectScreenReader(){return navigator.userAgent.includes("NVDA")||navigator.userAgent.includes("JAWS")||navigator.userAgent.includes("VoiceOver")||void 0!==window.speechSynthesis}setupMediaQueryListeners(){if(!window.matchMedia)return;const e=window.matchMedia("(prefers-reduced-motion: reduce)");e.addEventListener("change",e=>{this.updatePreference("reducedMotion",e.matches)}),this.mediaQueryListeners.push(e);const t=window.matchMedia("(prefers-contrast: high)");t.addEventListener("change",e=>{this.updatePreference("highContrast",e.matches)}),this.mediaQueryListeners.push(t)}setupKeyboardNavigation(){document.addEventListener("keydown",e=>{"Tab"===e.key&&(this.keyboardNavigationActive=!0,document.body.classList.add("a11y-keyboard-navigation"))}),document.addEventListener("mousedown",()=>{this.keyboardNavigationActive=!1,document.body.classList.remove("a11y-keyboard-navigation")})}setupFocusManagement(){document.addEventListener("focusin",e=>{const t=e.target;t&&this.keyboardNavigationActive&&this.announceToScreenReader(`Focused on ${this.getElementDescription(t)}`)})}applyAccessibilitySettings(){const e=document.documentElement;this.preferences.reducedMotion?e.classList.add("a11y-reduce-motion"):e.classList.remove("a11y-reduce-motion"),this.preferences.highContrast?e.classList.add("a11y-high-contrast"):e.classList.remove("a11y-high-contrast"),this.preferences.largeText?e.classList.add("a11y-large-text"):e.classList.remove("a11y-large-text"),this.preferences.screenReader?e.classList.add("a11y-screen-reader-active"):e.classList.remove("a11y-screen-reader-active")}updatePreference(e,t){this.preferences[e]=t,this.applyAccessibilitySettings(),this.savePreferences(),me.trackEvent("accessibility_preference_changed",{preference:e,value:t,allPreferences:this.preferences})}getPreferences(){return{...this.preferences}}setAriaLabel(e,t){e.setAttribute("aria-label",t)}setAriaDescribedBy(e,t){e.setAttribute("aria-describedby",t)}setAriaExpanded(e,t){e.setAttribute("aria-expanded",t.toString())}setAriaSelected(e,t){e.setAttribute("aria-selected",t.toString())}setAriaChecked(e,t){e.setAttribute("aria-checked",t.toString())}setAriaHidden(e,t){e.setAttribute("aria-hidden",t.toString())}focusElement(e,t){try{e.focus(t),this.focusStack.push(e)}catch(a){q.warn("Failed to focus element","ACCESSIBILITY",a)}}restoreFocus(){const e=this.focusStack.pop();e&&document.contains(e)&&this.focusElement(e)}trapFocus(e){const t=this.getFocusableElements(e);t.forEach((e,t)=>{this.trapFocusElements.push({element:e,tabIndex:t,originalTabIndex:e.tabIndex})}),t.length>0&&this.focusElement(t[0]);e.addEventListener("keydown",e=>{if("Tab"===e.key){const a=t[0],s=t[t.length-1];e.shiftKey?document.activeElement===a&&(e.preventDefault(),this.focusElement(s)):document.activeElement===s&&(e.preventDefault(),this.focusElement(a))}"Escape"===e.key&&this.releaseFocusTrap()}),e.setAttribute("data-focus-trap-active","true")}releaseFocusTrap(){this.trapFocusElements.forEach(({element:e,originalTabIndex:t})=>{void 0!==t&&(e.tabIndex=t)}),this.trapFocusElements=[],document.querySelectorAll("[data-focus-trap-active]").forEach(e=>{e.removeAttribute("data-focus-trap-active")}),this.restoreFocus()}getFocusableElements(e){const t=["button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","a[href]",'[tabindex]:not([tabindex="-1"])','[contenteditable="true"]'].join(", ");return Array.from(e.querySelectorAll(t)).filter(e=>{const t=e;return null!==t.offsetParent&&!t.hasAttribute("aria-hidden")})}announceToScreenReader(e,t="polite"){const a=document.createElement("div");a.setAttribute("aria-live",t),a.setAttribute("aria-atomic","true"),a.className="sr-only",a.textContent=e,document.body.appendChild(a),setTimeout(()=>{document.body.contains(a)&&document.body.removeChild(a)},1e3)}getElementDescription(e){const t=e.getAttribute("aria-label");if(t)return t;const a=e.textContent?.trim();if(a)return a;if("IMG"===e.tagName){const t=e.alt;if(t)return t}const s=e.getAttribute("title");if(s)return s;return`${e.getAttribute("role")||e.tagName.toLowerCase()} element`}registerKeyboardShortcut(e,t,a){document.addEventListener("keydown",s=>{this.matchesShortcut(s,e)&&(s.preventDefault(),t(s),me.trackEvent("keyboard_shortcut_used",{shortcut:e,description:a}))})}matchesShortcut(e,t){const a=t.toLowerCase().split("+"),s=a.pop(),n={ctrl:e.ctrlKey,alt:e.altKey,shift:e.shiftKey,meta:e.metaKey};for(const i of a)if(!n[i])return!1;return e.key.toLowerCase()===s}calculateLuminance(e,t,a){const[s,n,i]=[e,t,a].map(e=>e/255),[r,l,c]=[s,n,i].map(e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*r+.7152*l+.0722*c}calculateContrastRatio(e,t){const a=this.hexToRgb(e),s=this.hexToRgb(t);if(!a||!s)return 1;const n=this.calculateLuminance(a.r,a.g,a.b),i=this.calculateLuminance(s.r,s.g,s.b);return(Math.max(n,i)+.05)/(Math.min(n,i)+.05)}checkColorContrast(e,t){return this.calculateContrastRatio(e,t)}hexToRgb(e){return 3===(e=e.replace("#","")).length&&(e=e.split("").map(e=>e+e).join("")),6===e.length&&/^[0-9A-Fa-f]{6}$/.test(e)?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16)}:null}meetsContrastRequirements(e,t,a="AA",s="normal"){return this.calculateContrastRatio(e,t)>={AA:{normal:4.5,large:3},AAA:{normal:7,large:4.5}}[a][s]}suggestAccessibleColors(e,t,a="AA"){const s=[],n=this.hexToRgb(e),i=this.hexToRgb(t);if(!n||!i)return s;return[-60,-40,-20,20,40,60,80,100].forEach(n=>{const i=this.adjustBrightness(e,n),r=this.calculateContrastRatio(i,t);this.meetsContrastRequirements(i,t,a)&&s.push({foreground:i,background:t,ratio:r})}),s.sort((e,t)=>t.ratio-e.ratio).slice(0,5)}adjustBrightness(e,t){const a=this.hexToRgb(e);if(!a)return e;const s=t/100,n=e=>s>0?Math.min(255,e+(255-e)*s):Math.max(0,e+e*s),i=Math.round(n(a.r)),r=Math.round(n(a.g)),l=Math.round(n(a.b));return`#${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${l.toString(16).padStart(2,"0")}`}savePreferences(){try{localStorage.setItem("accessibility_preferences",JSON.stringify(this.preferences))}catch(e){q.warn("Failed to save accessibility preferences","ACCESSIBILITY",e)}}loadPreferences(){try{const e=localStorage.getItem("accessibility_preferences");if(e){const t=JSON.parse(e);this.preferences={...this.preferences,...t}}}catch(e){q.warn("Failed to load accessibility preferences","ACCESSIBILITY",e)}}destroy(){this.mediaQueryListeners.forEach(e=>{e.removeEventListener("change",()=>{})}),this.mediaQueryListeners=[],this.releaseFocusTrap(),this.focusStack=[]}},Ae=({isOpen:e,onClose:t})=>{const[s,n]=a.useState({reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0}),[i,r]=a.useState(!1);a.useEffect(()=>{if(e){const e=Ce.getPreferences();n(e),Ce.announceToScreenReader("Accessibility settings dialog opened");const t=document.querySelector(".accessibility-modal button");t&&Ce.focusElement(t)}},[e]);const l=async(e,t)=>{r(!0);try{const a={...s,[e]:t};n(a),Ce.updatePreference(e,t);const i={reducedMotion:"Reduced motion",highContrast:"High contrast",largeText:"Large text",screenReader:"Screen reader optimizations",keyboardNavigation:"Keyboard navigation"};Ce.announceToScreenReader(`${i[e]} ${t?"enabled":"disabled"}`,"assertive"),me.trackEvent("accessibility_preference_changed",{preference:e,value:t,source:"settings_modal"})}catch(a){console.error("Failed to update accessibility preference:",a),me.reportError(a,"accessibility_preference_update_error"),n(a=>({...a,[e]:!t})),Ce.announceToScreenReader("Failed to update preference. Please try again.","assertive")}finally{r(!1)}},c=()=>{Ce.announceToScreenReader("Accessibility settings dialog closed"),Ce.restoreFocus(),t()};return e?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"accessibility-modal-backdrop",onClick:c,"aria-hidden":"true"}),A.jsx("div",{className:"accessibility-modal "+(i?"loading":""),role:"dialog","aria-modal":"true","aria-labelledby":"accessibility-settings-title","aria-describedby":"accessibility-settings-description",onKeyDown:e=>{"Escape"===e.key&&c()},children:A.jsxs("div",{className:"accessibility-modal-content",children:[A.jsxs("div",{className:"accessibility-modal-header",children:[A.jsx("h2",{id:"accessibility-settings-title",className:"accessibility-modal-title",children:"Accessibility Settings"}),A.jsx("button",{onClick:c,className:"accessibility-modal-close","aria-label":"Close accessibility settings",children:A.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A.jsx("p",{id:"accessibility-settings-description",className:"accessibility-modal-description",children:"Customize your accessibility preferences to improve your experience with the application."}),A.jsxs("div",{className:"accessibility-settings-list",children:[A.jsxs("div",{className:"accessibility-setting-item",children:[A.jsxs("div",{className:"accessibility-setting-info",children:[A.jsx("label",{className:"accessibility-setting-label",children:"Reduced Motion"}),A.jsx("p",{className:"accessibility-setting-description",children:"Minimize animations and transitions for a calmer experience."})]}),A.jsx("button",{onClick:()=>l("reducedMotion",!s.reducedMotion),className:"accessibility-toggle "+(s.reducedMotion?"active":""),role:"switch","aria-checked":s.reducedMotion,disabled:i,children:A.jsx("span",{className:"accessibility-toggle-thumb"})})]}),A.jsxs("div",{className:"accessibility-setting-item",children:[A.jsxs("div",{className:"accessibility-setting-info",children:[A.jsx("label",{className:"accessibility-setting-label",children:"High Contrast"}),A.jsx("p",{className:"accessibility-setting-description",children:"Increase color contrast for better visibility"})]}),A.jsx("button",{onClick:()=>l("highContrast",!s.highContrast),className:"accessibility-toggle "+(s.highContrast?"active":""),role:"switch","aria-checked":s.highContrast,disabled:i,children:A.jsx("span",{className:"accessibility-toggle-thumb"})})]}),A.jsxs("div",{className:"accessibility-setting-item",children:[A.jsxs("div",{className:"accessibility-setting-info",children:[A.jsx("label",{className:"accessibility-setting-label",children:"Large Text"}),A.jsx("p",{className:"accessibility-setting-description",children:"Increase text size throughout the application"})]}),A.jsx("button",{onClick:()=>l("largeText",!s.largeText),className:"accessibility-toggle "+(s.largeText?"active":""),role:"switch","aria-checked":s.largeText,disabled:i,children:A.jsx("span",{className:"accessibility-toggle-thumb"})})]}),A.jsxs("div",{className:"accessibility-setting-item",children:[A.jsxs("div",{className:"accessibility-setting-info",children:[A.jsx("label",{className:"accessibility-setting-label",children:"Screen Reader Optimizations"}),A.jsx("p",{className:"accessibility-setting-description",children:"Optimize interface for screen reader users"})]}),A.jsx("button",{onClick:()=>l("screenReader",!s.screenReader),className:"accessibility-toggle "+(s.screenReader?"active":""),role:"switch","aria-checked":s.screenReader,disabled:i,children:A.jsx("span",{className:"accessibility-toggle-thumb"})})]}),A.jsxs("div",{className:"accessibility-setting-item",children:[A.jsxs("div",{className:"accessibility-setting-info",children:[A.jsx("label",{className:"accessibility-setting-label",children:"Enhanced Keyboard Navigation"}),A.jsx("p",{className:"accessibility-setting-description",children:"Show focus indicators and enable keyboard shortcuts"})]}),A.jsx("button",{onClick:()=>l("keyboardNavigation",!s.keyboardNavigation),className:"accessibility-toggle "+(s.keyboardNavigation?"active":""),role:"switch","aria-checked":s.keyboardNavigation,disabled:i,children:A.jsx("span",{className:"accessibility-toggle-thumb"})})]})]}),A.jsxs("div",{className:"accessibility-modal-actions",children:[A.jsx("button",{onClick:()=>{const e={reducedMotion:!1,highContrast:!1,largeText:!1,screenReader:!1,keyboardNavigation:!0};n(e),Object.entries(e).forEach(([e,t])=>{Ce.updatePreference(e,t)}),Ce.announceToScreenReader("Accessibility settings reset to defaults","assertive"),me.trackEvent("accessibility_settings_reset",{source:"settings_modal"})},disabled:i,className:"accessibility-modal-reset",children:"Reset to Defaults"}),A.jsxs("div",{className:"accessibility-modal-buttons",children:[A.jsx("button",{onClick:c,disabled:i,className:"accessibility-modal-cancel",children:"Cancel"}),A.jsx("button",{onClick:c,disabled:i,className:"accessibility-modal-done",children:i?"Saving...":"Done"})]})]}),A.jsxs("div",{className:"accessibility-shortcuts",children:[A.jsx("h3",{className:"accessibility-shortcuts-title",children:"Keyboard Shortcuts"}),A.jsxs("div",{className:"accessibility-shortcuts-list",children:[A.jsxs("div",{className:"accessibility-shortcut",children:[A.jsx("span",{children:"Close modal"}),A.jsx("kbd",{className:"accessibility-kbd",children:"Esc"})]}),A.jsxs("div",{className:"accessibility-shortcut",children:[A.jsx("span",{children:"Navigate settings"}),A.jsx("kbd",{className:"accessibility-kbd",children:"Tab"})]}),A.jsxs("div",{className:"accessibility-shortcut",children:[A.jsx("span",{children:"Toggle setting"}),A.jsx("kbd",{className:"accessibility-kbd",children:"Space"})]}),A.jsxs("div",{className:"accessibility-shortcut",children:[A.jsx("span",{children:"Activate buttons"}),A.jsx("kbd",{className:"accessibility-kbd",children:"Enter"})]})]})]})]})})]}):null},Ee=({currentPage:e})=>{const{isConnected:t,isLoading:s,login:i,logout:r,account:l}=R(),[c,o]=a.useState(!1),[d,u]=a.useState(!1),[m,h]=a.useState(0),[p,f]=a.useState(!1),[x,g]=a.useState(!1),[v,y]=a.useState(!1),[j,b]=a.useState(()=>{if(l){const e=localStorage.getItem(`userSettings_${l}`);if(e){const t=JSON.parse(e);return void 0===t.darkMode||t.darkMode}}const e=localStorage.getItem("darkMode");return!e||JSON.parse(e)}),{settings:N,updateSetting:w}=ue(),[k,_]=a.useState("0.0000"),[S,C]=a.useState([]),[E,P]=a.useState(0),[T,I]=a.useState(!1),[F,$]=a.useState(!1),L=a.useRef(null);a.useEffect(()=>{const e=()=>{u(window.scrollY>10)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]),a.useEffect(()=>{if(document.documentElement.setAttribute("data-theme",j?"dark":"light"),localStorage.setItem("darkMode",JSON.stringify(j)),l){const e=localStorage.getItem(`userSettings_${l}`);if(e){const t={...JSON.parse(e),darkMode:j};localStorage.setItem(`userSettings_${l}`,JSON.stringify(t))}}},[j,l]);const M=()=>{const e=!j;if(b(e),l){const t=localStorage.getItem(`userSettings_${l}`);if(t){const a={...JSON.parse(t),darkMode:e};localStorage.setItem(`userSettings_${l}`,JSON.stringify(a))}else{const t={emailNotifications:!0,priceAlerts:!0,marketingEmails:!1,darkMode:e,language:"en",currency:"WAX"};localStorage.setItem(`userSettings_${l}`,JSON.stringify(t))}}};a.useEffect(()=>{const e=()=>{h(ce.getCartCount())};return e(),ce.addListener(e),()=>ce.removeListener(e)},[]);const W=()=>{o(!c)},O=()=>{o(!1)},D=()=>{g(!1)},B=a.useCallback(async(e=!1)=>{if(l&&t)try{const t=await Ne.getWaxBalance(l,e);_(t),P(Date.now())}catch(a){K("Failed to fetch WAX balance","Navigation",a)}},[l,t]),U=a.useCallback(async()=>{if(l&&t)try{const e=await be.checkUserBadges(l);C(e.badges)}catch(e){K("Failed to check user badges","Navigation",e)}},[l,t]);return a.useEffect(()=>{const e=e=>{L.current&&!L.current.contains(e.target)&&D()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),a.useEffect(()=>{t&&l?(B(),U()):(_("0.0000"),C([]))},[t,l,B,U]),A.jsxs(A.Fragment,{children:[A.jsx("a",{href:"#main-content",className:"a11y-skip-link",children:"Skip to main content"}),A.jsx("a",{href:"#navigation",className:"a11y-skip-link",children:"Skip to navigation"}),A.jsx("nav",{className:"navbar "+(d?"scrolled":""),role:"navigation","aria-label":"Main navigation",id:"navigation",children:A.jsxs("div",{className:"navbar-container",children:[A.jsxs(n,{to:"/marketplace",className:"navbar-logo","aria-label":"PxMarket - Go to marketplace home",children:[A.jsx("img",{src:"https://pixeljourney.xyz/img/logo.png",alt:"PxMarket logo",className:"logo-image"}),A.jsx("span",{className:"logo-text",children:"PxMarket"})]}),A.jsxs("div",{className:"navbar-nav",role:"menubar","aria-label":"Main menu",children:[A.jsx(n,{to:"/rwax",className:"nav-link "+("rwax"===e?"active":""),role:"menuitem","aria-current":"rwax"===e?"page":void 0,children:"RWAX"}),A.jsx(n,{to:"/collections",className:"nav-link "+("collections"===e?"active":""),role:"menuitem","aria-current":"collections"===e?"page":void 0,children:"Collections"}),A.jsx(n,{to:"/auctions",className:"nav-link "+("auctions"===e?"active":""),role:"menuitem","aria-current":"auctions"===e?"page":void 0,children:"Auctions"}),A.jsx(n,{to:"/activity",className:"nav-link "+("activity"===e?"active":""),role:"menuitem","aria-current":"activity"===e?"page":void 0,children:"Activity"}),A.jsx(n,{to:"/learn",className:"nav-link "+("learn"===e?"active":""),role:"menuitem","aria-current":"learn"===e?"page":void 0,children:"Learn"}),A.jsx(n,{to:"/rewards",className:"nav-link "+("rewards"===e?"active":""),role:"menuitem","aria-current":"rewards"===e?"page":void 0,children:"Rewards"})]}),A.jsxs("div",{className:"navbar-actions",children:[A.jsx("button",{onClick:()=>y(!0),className:"accessibility-btn","aria-label":"Open accessibility settings",title:"Accessibility Settings",children:A.jsx("svg",{className:"accessibility-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.94-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"})})}),t&&m>0&&A.jsxs("button",{onClick:()=>f(!0),className:"cart-btn","aria-label":`Open Shopping Cart (${m} items)`,"aria-describedby":"cart-count",children:[A.jsxs("svg",{className:"cart-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[A.jsx("circle",{cx:"9",cy:"21",r:"1"}),A.jsx("circle",{cx:"20",cy:"21",r:"1"}),A.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),A.jsx("span",{className:"cart-badge",id:"cart-count","aria-label":`${m} items in cart`,children:m}),A.jsx("span",{className:"cart-text",children:"Cart"})]}),A.jsxs("div",{className:"wallet-container",ref:L,children:[A.jsx("button",{className:"wallet-btn "+(t?"connected":""),onClick:t?()=>{if(g(!x),!x&&t&&l){Date.now()-E>3e4&&B()}}:i,disabled:s,"aria-label":t?`Wallet connected: ${l}. Click to open wallet menu`:"Connect wallet","aria-expanded":t&&x,"aria-haspopup":"menu",children:s?A.jsx("span",{className:"loading-spinner",children:"⟳"}):t?A.jsxs(A.Fragment,{children:[A.jsx("svg",{className:"wallet-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),l||"Connected"]}):"Connect"}),t&&x&&A.jsxs("div",{className:"wallet-dropdown",role:"menu","aria-label":"Wallet menu",onKeyDown:e=>{"Escape"===e.key&&(D(),Ce.announceToScreenReader("Wallet menu closed"))},children:[A.jsx("div",{className:"wallet-dropdown-header",role:"group","aria-label":"Wallet information",children:A.jsx("div",{className:"wallet-account","aria-label":`Wallet account: ${l}`,children:l})}),A.jsxs(n,{to:"/inventory",className:"wallet-inventory-btn","aria-label":"Open Inventory",onClick:()=>g(!1),role:"menuitem",children:[A.jsxs("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[A.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),A.jsx("path",{d:"M9 9h6v6H9z"})]}),A.jsx("span",{children:"My Inventory"})]}),A.jsxs(n,{to:"/profile",className:"wallet-inventory-btn","aria-label":"View Profile",onClick:()=>g(!1),role:"menuitem",children:[A.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),A.jsx("span",{children:"My Profile"})]}),A.jsxs(n,{to:"/watchlist",className:"wallet-inventory-btn","aria-label":"View Watchlist",onClick:()=>g(!1),role:"menuitem",children:[A.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),A.jsx("span",{children:"My Watchlist"})]}),A.jsxs("div",{className:"wallet-balance",role:"group","aria-label":"Wallet balance information",children:[A.jsx("span",{className:"balance-label",children:"WAX Balance:"}),A.jsx("span",{className:"balance-amount","aria-label":`Balance: ${k} WAX`,children:k})]}),A.jsxs("div",{className:"wallet-badges",role:"group","aria-label":"User badges",children:[A.jsxs("div",{className:"badges-header",onClick:()=>$(!F),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0"},children:[A.jsx("span",{className:"badges-label",children:"PxBadges:"}),A.jsx("span",{style:{fontSize:"12px",color:"#888"},children:F?"▼":"▶"})]}),F?A.jsx("div",{className:"badges-expanded",style:{display:"flex",flexDirection:"column",gap:"8px"},children:be.getAllBadgeDefinitions().map(e=>{const t=S.some(t=>t.id===e.id);return A.jsxs("div",{className:"badge-item "+(t?"earned":"unearned"),style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px",borderRadius:"6px",background:t?`${e.color}15`:"rgba(128, 128, 128, 0.05)",border:`1px solid ${t?e.borderColor:"rgba(128, 128, 128, 0.1)"}`},children:[A.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[A.jsx("span",{style:{fontSize:"16px",opacity:t?1:.5},children:e.icon}),A.jsxs("div",{children:[A.jsxs("div",{style:{fontSize:"12px",fontWeight:"500",color:t?e.color:"#666"},children:[e.name," ",t&&"✓"]}),A.jsx("div",{style:{fontSize:"10px",color:"#888"},children:e.requirements})]})]}),!t&&A.jsx("button",{onClick:()=>{let t="/marketplace";"pxj-whale"===e.id||"pxj-holder"===e.id?(t="https://waxonedge.app/swap/WAX_eosio.token/PXJ_pixeljourney",window.open(t,"_blank")):"pixal-pfp"===e.id?(t="/marketplace?collection=pixeljourney&template=781515",window.location.href=t):"waxrock"===e.id?(t="/marketplace?category=waxrock",window.location.href=t):"ingredients"===e.id?(t="/marketplace?category=ingredients",window.location.href=t):(t="/marketplace?collection=pixeljourney",window.location.href=t)},style:{fontSize:"10px",padding:"4px 8px",background:e.color,color:"white",border:"none",borderRadius:"4px",cursor:"pointer",transition:"opacity 0.2s"},onMouseEnter:e=>e.target.style.opacity="0.8",onMouseLeave:e=>e.target.style.opacity="1",children:"Buy"})]},e.id)})}):A.jsxs("div",{className:"badges-collapsed",style:{display:"flex",gap:"4px",flexWrap:"wrap"},children:[be.getAllBadgeDefinitions().filter(e=>S.some(t=>t.id===e.id)).map(e=>A.jsx("span",{className:"badge-icon earned",style:{fontSize:"16px",padding:"4px",borderRadius:"4px",background:`${e.color}20`,color:e.color,border:`1px solid ${e.borderColor}`,cursor:"pointer"},title:`${e.name}: ${e.description} ✓ Earned`,children:e.icon},e.id)),0===S.length&&A.jsx("span",{style:{fontSize:"12px",color:"#888",fontStyle:"italic"},children:"No badges earned yet"})]})]}),A.jsx("div",{className:"wallet-settings",children:A.jsx("div",{className:"settings-menu",children:A.jsxs("div",{className:"settings-section",children:[A.jsxs("div",{className:"settings-header",onClick:()=>I(!T),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0"},children:[A.jsx("h4",{children:"Display Options"}),A.jsx("span",{style:{fontSize:"12px",color:"#888"},children:T?"▼":"▶"})]}),T?A.jsxs("div",{className:"filter-options",children:[A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.showOtherCollections,onChange:e=>w("showOtherCollections",e.target.checked)}),A.jsx("span",{children:"Show other collections"})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.showWhitelistedOnly,onChange:e=>w("showWhitelistedOnly",e.target.checked)}),A.jsx("span",{children:"Displays only whitelisted collections in overviews"})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.enableAnimatedNFTs,onChange:e=>w("enableAnimatedNFTs",e.target.checked)}),A.jsx("span",{children:"Enables animated NFTs to play in overviews"})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.showExplicitContent,onChange:e=>w("showExplicitContent",e.target.checked)}),A.jsx("span",{children:"Enables explicit content to be shown in overviews"})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.showChatButton,onChange:e=>w("showChatButton",e.target.checked)}),A.jsx("span",{children:"Show chat button"})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.blockNSFW,onChange:e=>w("blockNSFW",e.target.checked)}),A.jsx("span",{children:"Blocks NSFW collections from the platform"})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.blockAI,onChange:e=>w("blockAI",e.target.checked)}),A.jsx("span",{children:"Blocks AI collections from the platform"})]}),A.jsxs("div",{className:"theme-toggle-option",children:[A.jsx("span",{children:"Dark Mode"}),A.jsx("button",{className:"theme-toggle "+(j?"active":""),onClick:M,children:A.jsxs("div",{className:"toggle-slider",children:[A.jsxs("svg",{className:"sun-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"5"}),A.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),A.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),A.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),A.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),A.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),A.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),A.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),A.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),A.jsx("svg",{className:"moon-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})]})})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.showPricesInUSD,onChange:e=>w("showPricesInUSD",e.target.checked)}),A.jsx("span",{children:"Show Prices in USD"})]}),A.jsxs("div",{className:"currency-selection",children:[A.jsx("label",{children:"Currency Comparison:"}),A.jsxs("select",{value:N.selectedCurrency,onChange:e=>w("selectedCurrency",e.target.value),className:"currency-select",children:[A.jsx("option",{value:"USD",children:"USD - US Dollar"}),A.jsx("option",{value:"EUR",children:"EUR - Euro"}),A.jsx("option",{value:"DKK",children:"DKK - Danish Krone"}),A.jsx("option",{value:"AED",children:"AED - UAE Dirham"}),A.jsx("option",{value:"INR",children:"INR - Indian Rupee"}),A.jsx("option",{value:"RUB",children:"RUB - Russian Ruble"}),A.jsx("option",{value:"CNY",children:"CNY - Chinese Yuan"}),A.jsx("option",{value:"JPY",children:"JPY - Japanese Yen"}),A.jsx("option",{value:"BTC",children:"BTC - Bitcoin"}),A.jsx("option",{value:"ETH",children:"ETH - Ethereum"})]})]}),A.jsxs("label",{className:"filter-option",children:[A.jsx("input",{type:"checkbox",checked:N.showRarityRankings,onChange:e=>w("showRarityRankings",e.target.checked)}),A.jsx("span",{children:"Show Rarity Rankings"})]})]}):A.jsxs("div",{className:"theme-toggle-option",style:{marginTop:"8px"},children:[A.jsx("span",{children:"Dark Mode"}),A.jsx("button",{className:"theme-toggle "+(j?"active":""),onClick:M,children:A.jsxs("div",{className:"toggle-slider",children:[A.jsxs("svg",{className:"sun-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"5"}),A.jsx("line",{x1:"12",y1:"1",x2:"12",y2:"3"}),A.jsx("line",{x1:"12",y1:"21",x2:"12",y2:"23"}),A.jsx("line",{x1:"4.22",y1:"4.22",x2:"5.64",y2:"5.64"}),A.jsx("line",{x1:"18.36",y1:"18.36",x2:"19.78",y2:"19.78"}),A.jsx("line",{x1:"1",y1:"12",x2:"3",y2:"12"}),A.jsx("line",{x1:"21",y1:"12",x2:"23",y2:"12"}),A.jsx("line",{x1:"4.22",y1:"19.78",x2:"5.64",y2:"18.36"}),A.jsx("line",{x1:"18.36",y1:"5.64",x2:"19.78",y2:"4.22"})]}),A.jsx("svg",{className:"moon-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"})})]})})]})]})})}),A.jsxs("button",{className:"logout-btn",onClick:r,role:"menuitem","aria-label":"Logout from wallet",children:[A.jsx("span",{className:"logout-icon","aria-hidden":"true",children:"🚪"}),"Logout"]})]})]}),A.jsx("button",{onClick:W,className:"mobile-menu-btn "+(c?"active":""),"aria-label":c?"Close Menu":"Open Menu","aria-expanded":c,"aria-controls":"mobile-menu",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),W(),Ce.announceToScreenReader(c?"Mobile menu closed":"Mobile menu opened"))},children:A.jsxs("div",{className:"hamburger","aria-hidden":"true",children:[A.jsx("span",{}),A.jsx("span",{}),A.jsx("span",{})]})})]})]})}),A.jsxs("div",{className:"mobile-menu "+(c?"open":""),id:"mobile-menu",role:"navigation","aria-expanded":c,"aria-label":"Mobile navigation menu",onKeyDown:e=>{"Escape"===e.key&&(O(),Ce.announceToScreenReader("Mobile menu closed"))},children:[A.jsxs("nav",{className:"mobile-nav-links",role:"navigation","aria-label":"Mobile menu links",children:[A.jsx(n,{to:"/marketplace",onClick:O,className:"mobile-nav-link "+("marketplace"===e?"active":""),children:"Marketplace"}),A.jsx(n,{to:"/collections",onClick:O,className:"mobile-nav-link "+("collections"===e?"active":""),children:"Collections"}),A.jsx(n,{to:"/collections",onClick:O,className:"mobile-nav-link "+("collections"===e?"active":""),children:"Collections"}),A.jsx(n,{to:"/auctions",onClick:O,className:"mobile-nav-link "+("auctions"===e?"active":""),children:"Auctions"}),A.jsx(n,{to:"/activity",onClick:O,className:"mobile-nav-link "+("activity"===e?"active":""),children:"Activity"}),A.jsx(n,{to:"/learn",onClick:O,className:"mobile-nav-link "+("learn"===e?"active":""),children:"Learn"}),A.jsx(n,{to:"/rewards",onClick:O,className:"mobile-nav-link "+("rewards"===e?"active":""),children:"Rewards"})]}),A.jsxs("div",{className:"mobile-menu-actions",children:[t&&m>0&&A.jsxs("button",{onClick:()=>{f(!0),O()},className:"mobile-cart-btn","aria-label":`Open Shopping Cart (${m} items)`,children:[A.jsxs("svg",{className:"cart-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:[A.jsx("circle",{cx:"9",cy:"21",r:"1"}),A.jsx("circle",{cx:"20",cy:"21",r:"1"}),A.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),"Shopping Cart (",m,")"]}),t&&A.jsxs(A.Fragment,{children:[A.jsxs(n,{to:"/inventory",onClick:O,className:"mobile-inventory-btn",children:[A.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),"My Inventory"]}),A.jsxs(n,{to:"/profile",onClick:O,className:"mobile-inventory-btn",children:[A.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"My Profile"]}),A.jsxs(n,{to:"/watchlist",onClick:O,className:"mobile-inventory-btn",children:[A.jsx("svg",{className:"inventory-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),"My Watchlist"]})]})]})]}),c&&A.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[998]",onClick:O}),A.jsx(Se,{isOpen:p,onClose:()=>f(!1)}),A.jsx(Ae,{isOpen:v,onClose:()=>y(!1)})]})};const Pe=new class{serviceWorkerRegistration=null;pushSubscription=null;vapidPublicKey="";isInitialized=!1;permissionState={permission:"default",supported:!1,serviceWorkerReady:!1,subscribed:!1};constructor(){this.checkSupport()}checkSupport(){this.permissionState.supported="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,this.permissionState.supported&&(this.permissionState.permission=Notification.permission)}async initialize(){if(this.isInitialized)return!0;try{return this.permissionState.supported?(await this.registerServiceWorker(),await this.checkExistingSubscription(),this.isInitialized=!0,me.trackEvent("push_notification_service_initialized",{supported:this.permissionState.supported,permission:this.permissionState.permission,subscribed:this.permissionState.subscribed}),!0):(console.warn("Push notifications not supported in this browser"),!1)}catch(e){return W.logError("PushNotificationService.initialize",e),me.reportError(e,"push_notification_init_error"),!1}}async registerServiceWorker(){try{this.serviceWorkerRegistration=await navigator.serviceWorker.register("/sw.js",{scope:"/"}),await navigator.serviceWorker.ready,this.permissionState.serviceWorkerReady=!0,console.log("Service Worker registered successfully"),navigator.serviceWorker.addEventListener("message",this.handleServiceWorkerMessage.bind(this))}catch(e){throw W.logError("PushNotificationService.registerServiceWorker",e),e}}handleServiceWorkerMessage(e){const{type:t,data:a}=e.data||{};switch(t){case"NOTIFICATION_CLICKED":me.trackEvent("notification_clicked",a);break;case"NOTIFICATION_CLOSED":me.trackEvent("notification_closed",a);break;default:console.log("Unknown service worker message:",t)}}async checkExistingSubscription(){if(this.serviceWorkerRegistration)try{this.pushSubscription=await this.serviceWorkerRegistration.pushManager.getSubscription(),this.permissionState.subscribed=!!this.pushSubscription,this.pushSubscription&&(console.log("Existing push subscription found"),await this.validateSubscription())}catch(e){W.logError("PushNotificationService.checkExistingSubscription",e)}}async requestPermission(){if(!this.permissionState.supported)throw new Error("Push notifications not supported");try{const e=await Notification.requestPermission();return this.permissionState.permission=e,me.trackEvent("notification_permission_requested",{permission:e,previousPermission:this.permissionState.permission}),e}catch(e){throw W.logError("PushNotificationService.requestPermission",e),me.reportError(e,"notification_permission_error"),e}}async subscribe(e){if(this.isInitialized||await this.initialize(),!this.serviceWorkerRegistration)throw new Error("Service worker not registered");if("granted"!==this.permissionState.permission){if("granted"!==await this.requestPermission())throw new Error("Notification permission denied")}try{this.pushSubscription&&await this.unsubscribe();const t={userVisibleOnly:!0,applicationServerKey:this.vapidPublicKey?this.urlBase64ToUint8Array(this.vapidPublicKey):void 0};this.pushSubscription=await this.serviceWorkerRegistration.pushManager.subscribe(t),this.permissionState.subscribed=!0;const a={endpoint:this.pushSubscription.endpoint,keys:{p256dh:this.arrayBufferToBase64(this.pushSubscription.getKey("p256dh")),auth:this.arrayBufferToBase64(this.pushSubscription.getKey("auth"))},userId:e,subscriptionTime:Date.now()};return localStorage.setItem("push_subscription",JSON.stringify(a)),await this.sendSubscriptionToServer(a),me.trackEvent("push_notification_subscribed",{userId:e,endpoint:this.pushSubscription.endpoint}),console.log("Push notification subscription successful"),this.pushSubscription}catch(t){throw W.logError("PushNotificationService.subscribe",t),me.reportError(t,"push_subscription_error",{userId:e}),t}}async unsubscribe(){if(!this.pushSubscription)return!0;try{const e=await this.pushSubscription.unsubscribe();return e&&(this.pushSubscription=null,this.permissionState.subscribed=!1,localStorage.removeItem("push_subscription"),await this.removeSubscriptionFromServer(),me.trackEvent("push_notification_unsubscribed"),console.log("Push notification unsubscribed successfully")),e}catch(e){return W.logError("PushNotificationService.unsubscribe",e),me.reportError(e,"push_unsubscription_error"),!1}}async showLocalNotification(e){if(!this.permissionState.supported||"granted"!==this.permissionState.permission)throw new Error("Notifications not available");try{const t={body:e.body,icon:e.icon||"/favicon.svg",badge:e.badge||"/favicon.svg",tag:e.tag,data:e.data,requireInteraction:e.requireInteraction||!1,silent:e.silent||!1},a=new Notification(e.title,t);a.onclick=()=>{me.trackEvent("local_notification_clicked",{tag:e.tag,title:e.title}),a.close()},a.onclose=()=>{me.trackEvent("local_notification_closed",{tag:e.tag,title:e.title})},me.trackEvent("local_notification_shown",{tag:e.tag,title:e.title})}catch(t){throw W.logError("PushNotificationService.showLocalNotification",t),me.reportError(t,"local_notification_error",{title:e.title}),t}}urlBase64ToUint8Array(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(t),s=new Uint8Array(a.length);for(let n=0;n<a.length;++n)s[n]=a.charCodeAt(n);return s}arrayBufferToBase64(e){const t=new Uint8Array(e);let a="";for(let s=0;s<t.byteLength;s++)a+=String.fromCharCode(t[s]);return window.btoa(a)}getAuthToken(){return localStorage.getItem("auth_token")||sessionStorage.getItem("auth_token")||""}getNotificationPreferences(){const e=localStorage.getItem("notification_preferences");if(e)try{return JSON.parse(e)}catch(t){console.warn("Failed to parse notification preferences:",t)}return{priceAlerts:!0,auctionUpdates:!0,newListings:!1,marketTrends:!1,systemNotifications:!0}}async validateSubscription(){if(!this.pushSubscription)return!1;try{const e={endpoint:this.pushSubscription.endpoint,keys:{p256dh:this.arrayBufferToBase64(this.pushSubscription.getKey("p256dh")),auth:this.arrayBufferToBase64(this.pushSubscription.getKey("auth"))}},t=await fetch("/api/push/validate-subscription",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({subscription:e})});if(!t.ok)throw new Error(`Validation failed: ${t.status} ${t.statusText}`);return!0===(await t.json()).valid}catch(e){return console.warn("Subscription validation failed:",e),W.logError("PushNotificationService.validateSubscription",e),!1}}async sendSubscriptionToServer(e){try{const t=await fetch("/api/push/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({...e,userAgent:navigator.userAgent,timestamp:Date.now(),preferences:this.getNotificationPreferences()})});if(!t.ok){const e=await t.json().catch(()=>({}));throw new Error(`Failed to save subscription: ${t.status} ${t.statusText} - ${e.message||"Unknown error"}`)}const a=await t.json();console.log("Subscription successfully saved to server:",a.subscriptionId),localStorage.setItem("push_subscription_id",a.subscriptionId)}catch(t){throw console.error("Failed to send subscription to server:",t),W.logError("PushNotificationService.sendSubscriptionToServer",t,{endpoint:e.endpoint,userId:e.userId}),t}}async removeSubscriptionFromServer(){try{const e=localStorage.getItem("push_subscription_id"),t=localStorage.getItem("push_subscription");if(!e&&!t)return void console.log("No subscription to remove from server");const a=await fetch("/api/push/unsubscribe",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.getAuthToken()}`},body:JSON.stringify({subscriptionId:e,endpoint:this.pushSubscription?.endpoint,timestamp:Date.now()})});if(!a.ok){const e=await a.json().catch(()=>({}));throw new Error(`Failed to remove subscription: ${a.status} ${a.statusText} - ${e.message||"Unknown error"}`)}localStorage.removeItem("push_subscription_id"),console.log("Subscription successfully removed from server")}catch(e){console.error("Failed to remove subscription from server:",e),W.logError("PushNotificationService.removeSubscriptionFromServer",e)}}getPermissionState(){return{...this.permissionState}}isSubscribed(){return this.permissionState.subscribed}getSubscription(){return this.pushSubscription}setVapidKey(e){this.vapidPublicKey=e}async testNotification(){await this.showLocalNotification({title:"PxMarket Test Notification",body:"Push notifications are working correctly!",tag:"test-notification",data:{test:!0}})}async sendPriceAlert(e,t,a){await this.showLocalNotification({title:"Price Alert",body:`${e} is now ${t} (target: ${a})`,tag:"price-alert",icon:"/favicon.svg",requireInteraction:!0,data:{type:"price_alert",assetName:e,currentPrice:t,targetPrice:a}})}async sendTransactionNotification(e,t,a){await this.showLocalNotification({title:"success"===e?"Transaction Successful":"Transaction Failed",body:t,tag:`transaction-${e}`,icon:"/favicon.svg",data:{type:"transaction",status:e,transactionId:a}})}};const Te=new class{watchlist=[];priceAlerts={};notifications={browser:!0,email:!1,sound:!0};listeners=[];priceCheckInterval=null;STORAGE_KEY="pixeljourney_watchlist";ALERTS_KEY="pixeljourney_price_alerts";NOTIFICATIONS_KEY="pixeljourney_notifications";priceCache={};CACHE_DURATION=12e4;endpointFailures={};MAX_FAILURES=3;FAILURE_WINDOW=3e5;DISABLE_DURATION=9e5;constructor(){this.loadFromStorage(),this.startPriceMonitoring(),this.requestNotificationPermission()}loadFromStorage(){try{this.watchlist=le.getJSON(this.STORAGE_KEY,[]),this.priceAlerts=le.getJSON(this.ALERTS_KEY,{}),this.notifications=le.getJSON(this.NOTIFICATIONS_KEY,{browser:!0,email:!1,sound:!0})}catch(e){W.logError("WatchlistService.loadFromStorage",e,{storageKeys:[this.STORAGE_KEY,this.ALERTS_KEY,this.NOTIFICATIONS_KEY]})}}saveToStorage(){try{le.setJSON(this.STORAGE_KEY,this.watchlist)&&le.setJSON(this.ALERTS_KEY,this.priceAlerts)&&le.setJSON(this.NOTIFICATIONS_KEY,this.notifications)||W.logError("WatchlistService.saveToStorage",new Error("Failed to save to storage"),{watchlistSize:this.watchlist.length,alertsCount:Object.keys(this.priceAlerts).length}),this.notifyListeners()}catch(e){W.logError("WatchlistService.saveToStorage",e,{watchlistSize:this.watchlist.length,alertsCount:Object.keys(this.priceAlerts).length})}}async requestNotificationPermission(){"Notification"in window&&"default"===Notification.permission&&await Notification.requestPermission()}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.listeners.forEach(e=>e([...this.watchlist]))}async addToWatchlist(e){if(-1!==this.watchlist.findIndex(t=>t.nft.asset_id===e.asset_id))return!1;const t={nft:e,alertType:"any",addedAt:Date.now(),lastPrice:e.price?parseFloat(e.price):0};return this.watchlist.push(t),this.saveToStorage(),this.notifyListeners(),!0}async removeFromWatchlist(e){this.watchlist=this.watchlist.filter(t=>t.nft.asset_id!==e),delete this.priceAlerts[e],this.saveToStorage(),this.notifyListeners()}async getWatchlist(){return[...this.watchlist]}isInWatchlist(e){return this.watchlist.some(t=>t.nft.asset_id===e)}async setPriceAlert(e,t){this.priceAlerts[e]={...t,lastTriggered:void 0},this.saveToStorage()}async removePriceAlert(e){delete this.priceAlerts[e],this.saveToStorage()}getPriceAlert(e){return this.priceAlerts[e]}updateNotificationSettings(e){this.notifications={...this.notifications,...e},this.saveToStorage()}getNotificationSettings(){return{...this.notifications}}isEndpointDisabled(e){const t=this.endpointFailures[e];return!(!t||!t.disabled)&&(!(Date.now()-t.lastFailure>this.DISABLE_DURATION)||(t.disabled=!1,t.count=0,!1))}recordEndpointFailure(e){const t=Date.now(),a=this.endpointFailures[e]||{count:0,lastFailure:0,disabled:!1};t-a.lastFailure>this.FAILURE_WINDOW&&(a.count=0),a.count++,a.lastFailure=t,a.count>=this.MAX_FAILURES&&(a.disabled=!0,console.warn(`Endpoint ${e} disabled due to ${a.count} failures`)),this.endpointFailures[e]=a}recordEndpointSuccess(e){const t=this.endpointFailures[e];t&&(t.count=0,t.disabled=!1)}notifyEndpointsDisabled(){const e=localStorage.getItem("watchlist_endpoints_disabled_notification"),t=Date.now();e&&t-parseInt(e)<9e5||(localStorage.setItem("watchlist_endpoints_disabled_notification",t.toString()),window.dispatchEvent(new CustomEvent("watchlistEndpointsDisabled",{detail:{message:"Price monitoring temporarily disabled due to API issues. Will retry automatically.",disabledEndpoints:Object.keys(this.endpointFailures).filter(e=>this.endpointFailures[e].disabled),retryTime:Math.max(...Object.values(this.endpointFailures).map(e=>e.lastFailure+this.DISABLE_DURATION))}})))}getEndpointStatus(){const e={};for(const[t,a]of Object.entries(this.endpointFailures))e[t]={healthy:!a.disabled,failures:a.count,disabledUntil:a.disabled?a.lastFailure+this.DISABLE_DURATION:void 0};return e}startPriceMonitoring(){this.priceCheckInterval=setInterval(()=>{this.checkPriceAlerts()},18e4),setTimeout(()=>{this.checkPriceAlerts()},6e4)}stopPriceMonitoring(){this.priceCheckInterval&&(clearInterval(this.priceCheckInterval),this.priceCheckInterval=null)}async checkPriceAlerts(){if(0===this.watchlist.length)return;if(["atomichub","neftyblocks"].every(e=>this.isEndpointDisabled(e)))return console.warn("All price endpoints are disabled, skipping price check"),void this.notifyEndpointsDisabled();try{const e=Object.values(this.endpointFailures).filter(e=>e.disabled).length,t=e>0?2:3,a=[];for(let s=0;s<this.watchlist.length;s+=t)a.push(this.watchlist.slice(s,s+t));for(let s=0;s<a.length;s++){const t=a[s];s>0&&await new Promise(e=>setTimeout(e,2e3));const n=t.map(async e=>{try{const t=await this.fetchCurrentPrice(e),a=e.lastPrice>0?(t-e.lastPrice)/e.lastPrice*100:0;e.lastPrice=t,e.priceChange=a;const s=this.priceAlerts[e.nft.asset_id];return s&&s.enabled&&t>0&&await this.checkAlertCondition(e,s,t),e}catch(t){return W.logError("WatchlistService.checkPriceAlerts.priceCheck",t,{assetId:e.nft.asset_id,nftName:e.nft.name}),e}});if(await Promise.allSettled(n),a.indexOf(t)<a.length-1){const t=e>0?2e3:1e3;await new Promise(e=>setTimeout(e,t))}}this.saveToStorage()}catch(e){W.logError("WatchlistService.checkPriceAlerts",e,{watchlistSize:this.watchlist.length,disabledEndpoints:Object.keys(this.endpointFailures).filter(e=>this.endpointFailures[e].disabled)})}}async fetchCurrentPrice(e){const t=e.nft.asset_id,a=Date.now(),s=this.priceCache[t];if(s&&a-s.timestamp<this.CACHE_DURATION)return s.price;const n=await this.getCurrentPrice(t);return this.priceCache[t]={price:n,timestamp:a},n}async getCurrentPrice(e){try{const a=["atomichub","neftyblocks"];for(const s of a)if(!this.isEndpointDisabled(s))try{let t=0;switch(s){case"atomichub":t=await this.fetchAtomicHubPrice(e);break;case"neftyblocks":t=await this.fetchNeftyBlocksPrice(e)}if(t>0)return this.recordEndpointSuccess(s),t}catch(t){this.recordEndpointFailure(s),console.warn(`Failed to fetch price from ${s}:`,t)}return console.warn("All price endpoints failed, using template floor price fallback"),await this.fetchTemplateFloorPrice(e)}catch(t){W.logError("WatchlistService.getCurrentPrice",t,{assetId:e});const a=this.watchlist.find(t=>t.nft.asset_id===e);return a?.lastPrice||0}}async fetchAtomicHubPrice(e){const t="atomichub";try{const{apiService:a}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),s=`${a.atomicMarketAPI}/atomicmarket/v1/sales?state=1&asset_id=${e}&limit=1`,n=await a.fetchWithRetry(s),i=await n.json();if(i.success&&i.data&&i.data.length>0){const e=i.data[0];if(e.price&&e.price.amount)return this.recordEndpointSuccess(t),parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}return 0}catch(a){return this.recordEndpointFailure(t),W.logError("WatchlistService.fetchAtomicHubPrice",a,{assetId:e,endpoint:t,failureCount:this.endpointFailures[t]?.count||0}),0}}async fetchNeftyBlocksPrice(e){const t="neftyblocks";try{const{apiService:a}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),s=`https://aa-wax-public1.neftyblocks.com/atomicmarket/v1/sales?state=1&asset_id=${e}&limit=1`,n=await a.fetchWithRetry(s),i=await n.json();if(i.success&&i.data&&i.data.length>0){const e=i.data[0];if(e.price&&e.price.amount)return this.recordEndpointSuccess(t),parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}return 0}catch(a){return this.recordEndpointFailure(t),W.logError("WatchlistService.fetchNeftyBlocksPrice",a,{assetId:e,endpoint:t,failureCount:this.endpointFailures[t]?.count||0}),0}}async fetchTemplateFloorPrice(e){try{const{apiService:t}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),a=`${t.atomicAssetsAPI}/atomicassets/v1/assets/${e}`,s=await t.fetchWithRetry(a),n=await s.json();if(n.success&&n.data&&n.data.template){const e=n.data.template.template_id,a=`${t.atomicMarketAPI}/atomicmarket/v1/sales?state=1&template_id=${e}&sort=price&order=asc&limit=1`,s=await t.fetchWithRetry(a),i=await s.json();if(i.success&&i.data&&i.data.length>0){const e=i.data[0];if(e.price&&e.price.amount)return parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8)}}return 0}catch{return 0}}async checkAlertCondition(e,t,a){const s=Date.now();if(t.lastTriggered&&s-t.lastTriggered<36e5)return;let n=!1,i="";switch(t.alertType){case"below":a<=t.targetPrice&&(n=!0,i=`${e.nft.name} price dropped to ${a.toFixed(2)} WAX (target: ${t.targetPrice} WAX)`);break;case"above":a>=t.targetPrice&&(n=!0,i=`${e.nft.name} price rose to ${a.toFixed(2)} WAX (target: ${t.targetPrice} WAX)`);break;case"any":{const t=Math.abs(e.priceChange||0);if(t>=5){n=!0;const s=(e.priceChange||0)>0?"increased":"decreased";i=`${e.nft.name} price ${s} by ${t.toFixed(1)}% to ${a.toFixed(2)} WAX`}break}}n&&(await this.triggerAlert(e,i),t.lastTriggered=s)}async triggerAlert(e,t){this.notifications.browser&&"Notification"in window&&"granted"===Notification.permission&&new Notification("Price Alert - Pixel Journey",{body:t,icon:e.nft.image||"/favicon.ico",tag:`price-alert-${e.nft.asset_id}`,requireInteraction:!0}),this.notifications.sound&&this.playNotificationSound();try{await Pe.sendPriceAlert(e.nft.name,`${e.lastPrice} WAX`,t)}catch(a){console.warn("Failed to send push notification for price alert:",a)}window.dispatchEvent(new CustomEvent("priceAlert",{detail:{item:e,message:t}}))}playNotificationSound(){try{const e=new Audio("/notification.mp3");e.volume=.3,e.play().catch(e=>{console.log("Could not play notification sound:",e)})}catch(e){console.log("Notification sound not available:",e)}}getWatchlistStats(){const e=this.watchlist.length,t=Object.keys(this.priceAlerts).filter(e=>this.priceAlerts[e].enabled).length,a=this.watchlist.map(e=>e.priceChange||0).filter(e=>0!==e);return{totalItems:e,activeAlerts:t,averagePriceChange:a.length>0?a.reduce((e,t)=>e+t,0)/a.length:0}}clearWatchlist(){this.watchlist=[],this.priceAlerts={},this.saveToStorage()}subscribe(e){return this.listeners.push(e),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}exportWatchlist(){return JSON.stringify({watchlist:this.watchlist,priceAlerts:this.priceAlerts,exportedAt:Date.now()},null,2)}importWatchlist(e){try{const t=JSON.parse(e);return!(!t.watchlist||!Array.isArray(t.watchlist))&&(this.watchlist=t.watchlist,this.priceAlerts=t.priceAlerts||{},this.saveToStorage(),!0)}catch(t){return W.logError("WatchlistService.importWatchlist",t,{dataLength:e.length}),!1}}};const Ie=new class{sessionKit=null;currentSession=null;listeners=[];constructor(){this.initializeSessionKit(),this.restoreSession()}initializeSessionKit(){try{const e={appName:"PxMarket2",chains:[{id:"1064487b3cd1a897ce03ae5b6a865651747e2e152090f99c1d19d44e01aea5a4",url:te.WAX_CHAIN.GREYMASS}],ui:new g,walletPlugins:[new p,new f,new x]};this.sessionKit=new v(e)}catch(e){W.logError("WharfKitService.initialize",e)}}async restoreSession(){if(this.sessionKit)try{const e=await this.sessionKit.restore();e&&(this.currentSession=e,this.notifyListeners())}catch(e){W.logError("WharfKitService.restoreSession",e)}}async login(){if(!this.sessionKit)return W.logError("WharfKitService.login",new Error("SessionKit not initialized")),null;try{const e=await this.sessionKit.login();if(e.session)return this.currentSession=e.session,this.notifyListeners(),this.currentSession}catch(e){throw W.logError("WharfKitService.login",e),e}return null}async logout(){if(this.sessionKit&&this.currentSession)try{await this.sessionKit.logout(this.currentSession),this.currentSession=null,this.notifyListeners()}catch(e){throw W.logError("WharfKitService.logout",e),e}}isLoggedIn(){return null!==this.currentSession}getSession(){return this.currentSession}getActor(){return this.currentSession?.actor.toString()||null}getAccountName(){return this.currentSession?.actor.toString()||null}async transact(e){if(!this.currentSession)throw new Error("No active session. Please login first.");try{q.debug("Sending transaction with actions","WHARFKIT",{actionsCount:e.length});const t=await this.currentSession.transact({actions:e},{broadcast:!0,expireSeconds:120});return q.info("Transaction successful","WHARFKIT",{result:t}),t}catch(t){throw W.logError("WharfKitService.transact",t,{actions:e}),t}}async purchaseNFT(e,t){if(!this.currentSession)throw new Error("Please login to purchase NFTs");const a=[{account:"eosio.token",name:"transfer",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{from:this.currentSession?.actor.toString()||"",to:"atomicmarket",quantity:`${t} WAX`,memo:"deposit"}},{account:"atomicmarket",name:"purchasesale",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{buyer:this.currentSession?.actor.toString()||"",sale_id:e,intended_delphi_median:0,taker_marketplace:"market.pxj"}}];return q.debug("Crafting transaction actions","WHARFKIT",{actionsCount:a.length}),this.transact(a)}async batchPurchaseNFTs(e){if(!this.currentSession)throw new Error("Please login to purchase NFTs");if(0===e.length)throw new Error("No items to purchase");const t=[],a=e.reduce((e,t)=>e+parseFloat(t.price),0);return t.push({account:"eosio.token",name:"transfer",authorization:[{actor:this.currentSession.actor.toString(),permission:"active"}],data:{from:this.currentSession.actor.toString(),to:"atomicmarket",quantity:`${a.toFixed(4)} WAX`,memo:"deposit"}}),e.forEach(e=>{t.push({account:"atomicmarket",name:"purchasesale",authorization:[{actor:this.currentSession?.actor.toString()||"",permission:"active"}],data:{buyer:this.currentSession?.actor.toString()||"",sale_id:e.saleId,intended_delphi_median:0,taker_marketplace:"market.pxj"}})}),this.transact(t)}async executeCraftingTransaction(e){if(!this.currentSession)throw new Error("No active session");const t=[],a=this.currentSession.actor.toString(),s={craft_green:1832,craft_orange:1833,craft_purple:1834,craft_amber:1835,craft_chartreuse:1836,craft_violet:1837,craft_teal:1838,craft_vermillion:1839,craft_magenta:1841}[e.recipe];if(!s)throw new Error(`Unknown recipe: ${e.recipe}`);const n=e.pxjCost/e.quantity;t.push({account:"nft.hive",name:"boost",authorization:[{actor:a,permission:"active"}],data:{booster:a}});for(let i=0;i<e.quantity;i++){const r=[];for(const t of e.ingredientAssets){const a=t.assetIds.length/e.quantity,s=i*a,n=s+a;r.push(...t.assetIds.slice(s,n))}r.length>0&&t.push({account:"atomicassets",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"nfthivecraft",asset_ids:r,memo:"craft"}}),n>0&&t.push({account:"pixeljourney",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"nfthivecraft",quantity:`${n.toFixed(8)} PXJ`,memo:"craft"}}),t.push({account:"nfthivecraft",name:"craft",authorization:[{actor:a,permission:"active"}],data:{craft_id:s,user_name:a,collection_name:"pixeljourney",timestamp:Date.now().toString(),asset_ids:r,tokens:[`${n.toFixed(8)} PXJ`]}})}return this.transact(t)}subscribe(e){return this.listeners.push(e),e(this.getWalletContext()),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}notifyListeners(){const e=this.getWalletContext();this.listeners.forEach(t=>t(e))}getWalletContext(){return{isConnected:this.isLoggedIn(),account:this.getAccountName(),session:this.currentSession,login:this.login.bind(this),logout:this.logout.bind(this),transact:this.transact.bind(this),purchaseNFT:this.purchaseNFT.bind(this),batchPurchaseNFTs:this.batchPurchaseNFTs.bind(this),executeCraftingTransaction:this.executeCraftingTransaction.bind(this)}}getAPIClient(){return new y({url:te.WAX_CHAIN.GREYMASS})}},Fe=s.memo(({imageUrl:e,videoUrl:t,alt:a,className:s="",controls:n=!0,muted:i=!0,loop:r=!1,autoPlay:l=!1,loading:c="lazy",enableAnimations:o=!0})=>{const d=e=>e?"string"!=typeof e?null:e.startsWith("http")?e:e.startsWith("Qm")?`${te.IPFS.GATEWAYS[0]}${e}`:e:null,u=d(t),m=d(e),h=()=>`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#f3f4f6"/>\n      <text x="100" y="90" text-anchor="middle" font-family="Arial" font-size="14" fill="#6b7280">NFT</text>\n      <text x="100" y="110" text-anchor="middle" font-family="Arial" font-size="12" fill="#9ca3af">No Image</text>\n      <text x="100" y="130" text-anchor="middle" font-family="Arial" font-size="10" fill="#d1d5db">Available</text>\n    </svg>')}`,p=m||h();return u&&o?A.jsxs("video",{className:s,controls:n,muted:i,loop:r,autoPlay:l,poster:m||void 0,onError:e=>{const t=e.target,n=document.createElement("img");n.src=p,n.alt=a,n.className=s,n.loading=c,t.parentNode?.replaceChild(n,t)},children:[A.jsx("source",{src:u,type:"video/mp4"}),A.jsx("source",{src:u,type:"video/webm"}),"Your browser does not support the video tag."]}):u&&!o?A.jsx("img",{src:p,alt:a,className:s,loading:c,onError:e=>{const t=e.target,a=h();t.src!==a&&(t.src=a)}}):A.jsx("img",{src:p,alt:a,className:s,loading:c,onError:e=>{const t=e.target,a=h();t.src!==a&&(t.src=a)}})});function $e({isOpen:e,onClose:t,nft:s}){const{session:n,isConnected:i,account:r}=R(),{settings:l}=ue(),{showSuccess:c,showError:o}=_e(),[d,u]=a.useState("wax"),[m,h]=a.useState(""),[p,f]=a.useState(""),[x,g]=a.useState([]),[v,y]=a.useState([]),[j,b]=a.useState(!1),[N,w]=a.useState(!1),[k,_]=a.useState(!1);a.useEffect(()=>{e&&i&&(async()=>{if(r)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/assets?owner=${r}&collection_name=pixeljourney&limit=1`),t=await e.json();_(t.data&&t.data.length>0)}catch(e){console.error("Error checking Pixal holder status:",e)}})()},[e,i,r]),a.useEffect(()=>{e&&"nft"===d&&(async()=>{if(r&&"nft"===d){w(!0);try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/assets?owner=${r}&limit=100`),t=await e.json(),a=t.data?.map(e=>{const t=e.data?.img||e.data?.image,a=e.data?.video;let s="https://pixeljourney.xyz/img/toppixals/10.webp",n=null;return a&&"string"==typeof a&&(n=a.startsWith("http")?a:`${te.IPFS.GATEWAYS[0]}${a}`),t&&"string"==typeof t&&(s=t.startsWith("http")?t:`${te.IPFS.GATEWAYS[0]}${t}`),{asset_id:e.asset_id||"",name:e.name||`${e.collection?.collection_name||"Unknown"} #${e.asset_id||"N/A"}`,image:s,video:n,collection:e.collection?.collection_name||"Unknown",template_mint:void 0,max_supply:e.template?.max_supply||void 0}})||[];g(a)}catch(e){console.error("Error loading user NFTs:",e)}finally{w(!1)}}})()},[e,d,r]);return e&&s?A.jsx("div",{className:"modal-backdrop",onClick:t,children:A.jsxs("div",{className:"modal-content send-offer-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h3",{children:["Send Offer for ",s.name]}),A.jsx("button",{className:"modal-close",onClick:t,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"target-nft-preview",children:[A.jsx(Fe,{imageUrl:s.image,alt:s.name,enableAnimations:l.enableAnimatedNFTs}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h4",{children:s.name}),A.jsxs("p",{children:["Collection: ","string"==typeof s.collection?s.collection:s.collection?.collection_name||s.collection?.name||"Unknown"]}),s.price&&A.jsxs("p",{children:["Listed Price: ",s.price," WAX"]})]})]}),A.jsxs("div",{className:"offer-type-selection",children:[A.jsx("h4",{children:"Choose Offer Type"}),A.jsxs("div",{className:"offer-type-buttons",children:[A.jsxs("button",{className:"offer-type-btn "+("wax"===d?"active":""),onClick:()=>u("wax"),children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("path",{d:"M12 6v6l4 2"})]}),"WAX Offer"]}),A.jsxs("button",{className:"offer-type-btn "+("nft"===d?"active":""),onClick:()=>u("nft"),children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),A.jsx("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),A.jsx("polyline",{points:"21,15 16,10 5,21"})]}),"NFT Trade"]})]})]}),"wax"===d&&A.jsx("div",{className:"wax-offer-form",children:A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"waxAmount",children:"WAX Amount"}),A.jsx("input",{id:"waxAmount",type:"number",step:"0.0001",min:"0",value:m,onChange:e=>h(e.target.value),placeholder:"Enter WAX amount",className:"form-input"})]})}),"nft"===d&&A.jsxs("div",{className:"nft-trade-form",children:[A.jsx("h4",{children:"Select NFTs to Trade"}),N?A.jsxs("div",{className:"loading-inventory",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading your NFTs..."})]}):A.jsx("div",{className:"user-nfts-grid",children:x.map(e=>A.jsxs("div",{className:"user-nft-item "+(v.includes(e.asset_id)?"selected":""),onClick:()=>{return t=e.asset_id,void y(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[A.jsx(Fe,{imageUrl:e.image,videoUrl:e.video,alt:e.name,enableAnimations:l.enableAnimatedNFTs}),A.jsxs("div",{className:"nft-details",children:[A.jsx("p",{className:"nft-name",children:e.name}),A.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"})]}),v.includes(e.asset_id)&&A.jsx("div",{className:"selection-indicator",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("polyline",{points:"20,6 9,17 4,12"})})})]},e.asset_id))})]}),k&&A.jsxs("div",{className:"custom-memo-section",children:[A.jsxs("div",{className:"pixal-holder-badge",children:[A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("polygon",{points:"12,2 15.09,8.26 22,9 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9 8.91,8.26"})}),"Pixal PFP Holder"]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"customMemo",children:"Custom Memo (Optional)"}),A.jsx("textarea",{id:"customMemo",value:p,onChange:e=>f(e.target.value),placeholder:"Add a custom message to your offer...",className:"form-textarea",rows:3})]})]})]}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"btn-secondary",onClick:t,children:"Cancel"}),A.jsx("button",{className:"btn-primary",onClick:()=>{"wax"===d?(async()=>{if(r&&s&&m&&n){b(!0);try{const e=p||"Trade Offer sent via PxMarket - market.pixeljourney.xyz",a=[{account:"eosio.token",name:"transfer",authorization:[{actor:r,permission:"active"}],data:{from:r,to:"atomicmarket",quantity:`${parseFloat(m).toFixed(8)} WAX`,memo:"deposit"}},{account:"atomicmarket",name:"createbuyo",authorization:[{actor:r,permission:"active"}],data:{buyer:r,recipient:s.owner||s.seller,price:`${parseFloat(m).toFixed(8)} WAX`,asset_ids:[s.asset_id],memo:e,maker_marketplace:"market.pxj"}}];await n.transact({actions:a}),c("WAX offer sent successfully!"),t()}catch(e){console.error("Error sending WAX offer:",e),o("Failed to send WAX offer. Please try again.")}finally{b(!1)}}})():(async()=>{if(r&&s&&0!==v.length&&n){b(!0);try{const e=p||"NFT Trade Offer sent via PxMarket - market.pixeljourney.xyz",a=[{account:"atomicassets",name:"createoffer",authorization:[{actor:r,permission:"active"}],data:{sender:r,recipient:s.owner||s.seller,sender_asset_ids:v,recipient_asset_ids:[s.asset_id],memo:e}}];await n.transact({actions:a}),c("NFT trade offer sent successfully!"),t()}catch(e){console.error("Error sending NFT offer:",e),o("Failed to send NFT offer. Please try again.")}finally{b(!1)}}})()},disabled:j||!i||"wax"===d&&!m||"nft"===d&&0===v.length,children:j?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"spinner-small"}),"Sending..."]}):`Send ${"wax"===d?"WAX":"NFT"} Offer`})]})]})}):null}Fe.displayName="MediaRenderer";const Le=new class{defaultConfig={width:1200,height:630,backgroundColor:"#1a1a2e",textColor:"#ffffff",accentColor:"#ffd700"};generateAchievementShareImage(e,t,a,s,n={}){const{width:i,height:r,textColor:l,accentColor:c}={...this.defaultConfig,...n},o=e.filter(e=>e.unlockedAt).sort((e,t)=>{const a={legendary:4,epic:3,rare:2,common:1};return(a[t.rarity||"common"]||1)-(a[e.rarity||"common"]||1)}).slice(0,3),d=`\n      <svg width="${i}" height="${r}" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#16213e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />\n          </linearGradient>\n          <linearGradient id="titleGradient" x1="0%" y1="0%" x2="100%" y2="0%">\n            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n        \n        \x3c!-- Background --\x3e\n        <rect width="100%" height="100%" fill="url(#bgGradient)"/>\n        \n        \x3c!-- Header --\x3e\n        <text x="${i/2}" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="48" font-weight="bold" fill="url(#titleGradient)" text-anchor="middle">\n          ${s}'s Achievements\n        </text>\n        \n        \x3c!-- Stats Section --\x3e\n        <g transform="translate(${i/2-300}, 150)">\n          \x3c!-- Total Badges --\x3e\n          <rect x="0" y="0" width="180" height="120" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="90" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="${c}" text-anchor="middle">${t}</text>\n          <text x="90" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Total</text>\n          <text x="90" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Badges</text>\n          \n          \x3c!-- Legendary Badges --\x3e\n          <rect x="210" y="0" width="180" height="120" rx="15" fill="rgba(255,140,0,0.2)" stroke="#ff8c00" stroke-width="2"/>\n          <text x="300" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="#ff8c00" text-anchor="middle">${a}</text>\n          <text x="300" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Legendary</text>\n          <text x="300" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Badges</text>\n          \n          \x3c!-- Progress --\x3e\n          <rect x="420" y="0" width="180" height="120" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="510" y="40" font-family="system-ui" font-size="36" font-weight="bold" fill="${c}" text-anchor="middle">${e.filter(e=>e.progress&&!e.unlockedAt).length}</text>\n          <text x="510" y="70" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">In</text>\n          <text x="510" y="90" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Progress</text>\n        </g>\n        \n        \x3c!-- Top Badges Section --\x3e\n        ${o.length>0?`\n        <text x="${i/2}" y="350" font-family="system-ui" font-size="24" font-weight="600" fill="${l}" text-anchor="middle">\n          Featured Achievements\n        </text>\n        \n        <g transform="translate(${i/2-150*o.length}, 380)">\n          ${o.map((e,t)=>{const a=300*t,s="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="280" height="180" rx="15" fill="rgba(255,255,255,0.1)" stroke="${s}" stroke-width="2"/>\n              <text x="140" y="30" font-family="system-ui" font-size="32" text-anchor="middle">${e.icon}</text>\n              <text x="140" y="70" font-family="system-ui" font-size="18" font-weight="600" fill="${s}" text-anchor="middle">${e.name}</text>\n              <text x="140" y="100" font-family="system-ui" font-size="14" fill="#b0b0b0" text-anchor="middle">${e.rarity?.toUpperCase()||"COMMON"}</text>\n              ${e.tier?`<text x="140" y="130" font-family="system-ui" font-size="12" fill="#888" text-anchor="middle">Tier ${e.tier}</text>`:""}\n              <text x="140" y="160" font-family="system-ui" font-size="10" fill="#666" text-anchor="middle">${e.unlockedAt?new Date(e.unlockedAt).toLocaleDateString():""}</text>\n            </g>\n            `}).join("")}\n        </g>\n        `:""}\n        \n        \x3c!-- Footer --\x3e\n        <text x="${i/2}" y="${r-40}" font-family="system-ui" font-size="18" fill="#888" text-anchor="middle">\n          Pixel Journey Ecosystem • PxMarket\n        </text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(d)}`}generateInventoryShareImage(e,t,a,s={}){const{width:n,height:i,textColor:r,accentColor:l}={...this.defaultConfig,...s},c=e.sort((e,t)=>{const a={legendary:4,epic:3,rare:2,common:1};return(a[t.rarity]||1)-(a[e.rarity]||1)}).slice(0,6),o=`\n      <svg width="${n}" height="${i}" xmlns="http://www.w3.org/2000/svg">\n        <defs>\n          <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">\n            <stop offset="0%" style="stop-color:#1a1a2e;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#16213e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#0f3460;stop-opacity:1" />\n          </linearGradient>\n          <linearGradient id="titleGradient" x1="0%" y1="0%" x2="100%" y2="0%">\n            <stop offset="0%" style="stop-color:#ffd700;stop-opacity:1" />\n            <stop offset="50%" style="stop-color:#ffed4e;stop-opacity:1" />\n            <stop offset="100%" style="stop-color:#ffd700;stop-opacity:1" />\n          </linearGradient>\n        </defs>\n        \n        \x3c!-- Background --\x3e\n        <rect width="100%" height="100%" fill="url(#bgGradient)"/>\n        \n        \x3c!-- Header --\x3e\n        <text x="${n/2}" y="80" font-family="system-ui, -apple-system, sans-serif" font-size="48" font-weight="bold" fill="url(#titleGradient)" text-anchor="middle">\n          ${a}'s Collection\n        </text>\n        \n        \x3c!-- Stats --\x3e\n        <g transform="translate(${n/2-200}, 130)">\n          <rect x="0" y="0" width="180" height="100" rx="15" fill="rgba(255,255,255,0.1)" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>\n          <text x="90" y="35" font-family="system-ui" font-size="32" font-weight="bold" fill="${l}" text-anchor="middle">${e.length}</text>\n          <text x="90" y="60" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Selected</text>\n          <text x="90" y="80" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Items</text>\n          \n          <rect x="220" y="0" width="180" height="100" rx="15" fill="rgba(0,212,255,0.2)" stroke="#00d4ff" stroke-width="2"/>\n          <text x="310" y="35" font-family="system-ui" font-size="24" font-weight="bold" fill="#00d4ff" text-anchor="middle">${t}</text>\n          <text x="310" y="60" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Total</text>\n          <text x="310" y="80" font-family="system-ui" font-size="16" fill="#b0b0b0" text-anchor="middle">Value</text>\n        </g>\n        \n        \x3c!-- Items Grid --\x3e\n        ${c.length>0?`\n        <text x="${n/2}" y="290" font-family="system-ui" font-size="24" font-weight="600" fill="${r}" text-anchor="middle">\n          Featured Items\n        </text>\n        \n        <g transform="translate(${n/2-120*Math.min(c.length,3)}, 320)">\n          ${c.slice(0,3).map((e,t)=>{const a=240*t,s="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="220" height="160" rx="15" fill="rgba(255,255,255,0.1)" stroke="${s}" stroke-width="2"/>\n              <rect x="10" y="10" width="60" height="60" rx="8" fill="rgba(0,0,0,0.3)" stroke="${s}" stroke-width="1"/>\n              <text x="40" y="50" font-family="system-ui" font-size="24" text-anchor="middle">🎨</text>\n              <text x="90" y="30" font-family="system-ui" font-size="16" font-weight="600" fill="${r}">${e.name.length>15?e.name.substring(0,15)+"...":e.name}</text>\n              <text x="90" y="50" font-family="system-ui" font-size="14" fill="#b0b0b0">${e.collection}</text>\n              <text x="90" y="70" font-family="system-ui" font-size="12" fill="${s}">${e.rarity.toUpperCase()}</text>\n              ${e.quantity>1?`<text x="200" y="30" font-family="system-ui" font-size="14" fill="${l}" text-anchor="end">x${e.quantity}</text>`:""}\n            </g>\n            `}).join("")}\n        </g>\n        \n        ${c.length>3?`\n        <g transform="translate(${n/2-120*Math.min(c.length-3,3)}, 500)">\n          ${c.slice(3,6).map((e,t)=>{const a=240*t,s="legendary"===e.rarity?"#ff8c00":"epic"===e.rarity?"#a335ee":"rare"===e.rarity?"#0070dd":"#ffd700";return`\n            <g transform="translate(${a}, 0)">\n              <rect x="0" y="0" width="220" height="100" rx="15" fill="rgba(255,255,255,0.1)" stroke="${s}" stroke-width="2"/>\n              <rect x="10" y="10" width="40" height="40" rx="6" fill="rgba(0,0,0,0.3)" stroke="${s}" stroke-width="1"/>\n              <text x="30" y="35" font-family="system-ui" font-size="16" text-anchor="middle">🎨</text>\n              <text x="65" y="25" font-family="system-ui" font-size="14" font-weight="600" fill="${r}">${e.name.length>12?e.name.substring(0,12)+"...":e.name}</text>\n              <text x="65" y="45" font-family="system-ui" font-size="12" fill="${s}">${e.rarity.toUpperCase()}</text>\n              ${e.quantity>1?`<text x="200" y="25" font-family="system-ui" font-size="12" fill="${l}" text-anchor="end">x${e.quantity}</text>`:""}\n            </g>\n            `}).join("")}\n        </g>\n        `:""}\n        `:""}\n        \n        \x3c!-- Footer --\x3e\n        <text x="${n/2}" y="${i-40}" font-family="system-ui" font-size="18" fill="#888" text-anchor="middle">\n          Pixel Journey Ecosystem • PxMarket\n        </text>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(o)}`}downloadImage(e,t){const a=document.createElement("a");a.download=t,a.href=e,document.body.appendChild(a),a.click(),document.body.removeChild(a)}async convertToPNG(e,t=1200,a=630){return new Promise((s,n)=>{const i=new Image;i.onload=()=>{const e=document.createElement("canvas");e.width=t,e.height=a;const r=e.getContext("2d");r?(r.drawImage(i,0,0,t,a),s(e.toDataURL("image/png"))):n(new Error("Could not get canvas context"))},i.onerror=n,i.src=e})}},Me=(e,t,a,s,n)=>Le.generateAchievementShareImage(e,t,a,s,n),Re=(e,t,a,s)=>Le.generateInventoryShareImage(e,t,a,s),We=(e,t)=>Le.downloadImage(e,t),Oe=({isOpen:e,onClose:t,title:s,description:n,imageUrl:i,shareUrl:r,defaultShareText:l,type:c="nft",badges:o,totalBadges:d,legendaryCount:u,username:m,selectedItems:h,totalValue:p})=>{const[f,x]=a.useState(!1),[g,v]=a.useState(""),[y,j]=a.useState(!1),b=()=>{let e=[];switch(c){case"nft":e=[`🎨 Check out this amazing NFT: ${s}! ✨`,`🔥 Discovered this incredible ${s} NFT! 🚀`,`✨ Look at this stunning ${s}! NFT art at its finest 🎭`,`🌟 Found a gem! ${s} is absolutely beautiful 💎`,`🎯 This ${s} NFT caught my eye! Amazing artwork 🎨`,`💫 Showcasing ${s} - a true masterpiece! 🖼️`,`🚀 Blown away by this ${s} NFT! ⭐`,`🎪 Step right up and see ${s}! Fantastic NFT art 🎊`];break;case"collection":e=[`🏛️ Explore the amazing ${s} collection! 🎨`,`🔥 This ${s} collection is absolutely fire! 🚀`,`✨ Dive into the world of ${s}! Incredible NFT collection 🌟`,`💎 Discovered this gem of a collection: ${s}! 🎭`,`🎯 ${s} collection has some amazing pieces! 🖼️`,`🌈 The ${s} collection is a work of art! ✨`,`🚀 Check out the stunning ${s} collection! ⭐`,`🎪 Welcome to ${s} - an NFT wonderland! 🎊`];break;case"template":e=[`🎨 Check out this ${s} template! Perfect for collectors ✨`,`🔥 This ${s} template is incredible! 🚀`,`✨ Found an amazing ${s} template! 🎭`,`🌟 ${s} template - a collector's dream! 💎`,`🎯 This ${s} template caught my attention! 🎨`,`💫 Showcasing the ${s} template! 🖼️`,`🚀 Amazing ${s} template available! ⭐`,`🎪 Don't miss this ${s} template! 🎊`];break;case"achievement":e=["🏆 Just unlocked some amazing achievements! 🎉","🔥 Check out my gaming achievements! 🚀","✨ Proud of my latest achievements! 🎭","🌟 Achievement unlocked! Gaming milestones reached 💎","🎯 Showcasing my gaming achievements! 🎨","💫 Level up! New achievements earned! 🖼️","🚀 Gaming achievements on display! ⭐","🎪 Celebrating my gaming milestones! 🎊"];break;default:e=[l]}return e[Math.floor(Math.random()*e.length)]},[N,w]=a.useState(()=>l||b()),k=l||N,_=r||window.location.href;if(!e)return null;const S=async e=>{try{await navigator.clipboard.writeText(e),x(!0),setTimeout(()=>x(!1),2e3)}catch(t){console.error("Failed to copy to clipboard:",t)}};return A.jsx("div",{className:"social-share-overlay",onClick:t,children:A.jsxs("div",{className:"social-share-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"share-header",children:[A.jsxs("h3",{children:["Share ","collection"===c?"Collection":"template"===c?"Template":"achievement"===c?"Achievement":"NFT"]}),A.jsx("button",{className:"close-btn",onClick:t,children:A.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A.jsxs("div",{className:"share-content",children:[i&&A.jsxs("div",{className:"nft-preview",children:[A.jsx("img",{src:i,alt:s,className:"nft-image"}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h4",{children:s}),n&&A.jsx("p",{children:n})]})]}),A.jsxs("div",{className:"share-text-section",children:[A.jsxs("div",{className:"share-text-header",children:[A.jsx("label",{htmlFor:"share-text",children:"Customize your message:"}),!l&&A.jsx("button",{className:"refresh-message-btn",onClick:()=>{l||w(b())},title:"Generate new random message",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),A.jsx("textarea",{id:"share-text",value:g,onChange:e=>v(e.target.value),placeholder:k,className:"share-textarea",rows:3})]}),A.jsxs("div",{className:"share-url-section",children:[A.jsx("label",{children:"Share URL:"}),A.jsxs("div",{className:"url-input-container",children:[A.jsx("input",{type:"text",value:_,readOnly:!0,className:"url-input"}),A.jsxs("button",{className:"copy-btn "+(f?"copied":""),onClick:()=>S(_),children:[f?A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):A.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),A.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),f?"Copied!":"Copy"]})]})]}),A.jsxs("div",{className:"social-buttons",children:[A.jsxs("button",{className:"social-btn twitter",onClick:()=>{const e="collection"===c?"NFTCollection,WAX,PixelJourney":"template"===c?"NFTTemplate,WAX,PixelJourney":"achievement"===c?"Achievement,Gaming,PixelJourney":"NFT,WAX,PixelJourney",t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(g||k)}&url=${encodeURIComponent(_)}&hashtags=${e}`;window.open(t,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),"Twitter"]}),A.jsxs("button",{className:"social-btn facebook",onClick:()=>{const e=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(_)}`;window.open(e,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),A.jsxs("button",{className:"social-btn reddit",onClick:()=>{const e=g||k,t=`https://reddit.com/submit?url=${encodeURIComponent(_)}&title=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),A.jsxs("button",{className:"social-btn discord",onClick:()=>{S(`${g||k}\n${_}`),alert("Share text copied to clipboard! You can now paste it in Discord.")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})}),"Discord"]}),A.jsxs("button",{className:"social-btn telegram",onClick:()=>{const e=g||k,t=`https://t.me/share/url?url=${encodeURIComponent(_)}&text=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Telegram"]}),A.jsxs("button",{className:"social-btn email",onClick:()=>{const e=`${g||k}\n\nView it here: ${_}`,t=`mailto:?subject=${encodeURIComponent(`Check out: ${s}`)}&body=${encodeURIComponent(e)}`;window.location.href=t},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]})]}),("achievement"===c||"inventory"===c)&&m&&A.jsxs("div",{className:"share-image-section",children:[A.jsx("h4",{children:"Generate Share Image"}),A.jsxs("div",{className:"image-buttons",children:[A.jsx("button",{className:"generate-btn svg",onClick:async()=>{if(m)try{let e,t;if(j(!0),"achievement"===c&&o&&void 0!==d&&void 0!==u)e=Me(o,d,u,m),t=`${m}-achievements-${Date.now()}.svg`;else{if("inventory"!==c||!h||!p)return;e=Re(h,p,m),t=`${m}-inventory-${Date.now()}.svg`}We(e,t)}catch(e){console.error("Error generating share image:",e)}finally{j(!1)}},disabled:y,children:y?"Generating...":"Download SVG"}),A.jsx("button",{className:"generate-btn png",onClick:async()=>{if(m)try{let e,t;if(j(!0),"achievement"===c&&o&&void 0!==d&&void 0!==u)e=Me(o,d,u,m),t=`${m}-achievements-${Date.now()}.png`;else{if("inventory"!==c||!h||!p)return;e=Re(h,p,m),t=`${m}-inventory-${Date.now()}.png`}const a=await((e,t,a)=>Le.convertToPNG(e,t,a))(e);We(a,t)}catch(e){console.error("Error generating PNG share image:",e)}finally{j(!1)}},disabled:y,children:y?"Generating...":"Download PNG"})]})]})]})]})})};const De=new class{CHAT_ACCOUNT="chat.pxj";PXJ_CONTRACT="pixeljourney";PXJ_SYMBOL="PXJ";BASE_COST_PIXAL_HOLDER=1e4;BASE_COST_NON_HOLDER=1e6;SPONSORED_COST=1e6;MIN_MESSAGE_COST=1e4;messageCache=new Map;userRateLimit=new Map;blacklistedAccounts=new Set;moderationSettings={blacklistedAccounts:[],bannedWords:["spam","scam","hack","phishing"],trustedDomains:["wax.io","atomichub.io","wax.bloks.io","pixeljourney.io"],maxMessageLength:240,minTimeBetweenMessages:5};userLastMessageTime=new Map;async calculateMessageCost(e,t){const a=e.length,s=await this.checkPixalPFPOwnership(t),n=s?this.BASE_COST_PIXAL_HOLDER:this.BASE_COST_NON_HOLDER;let i=1;a>50&&(i=1+(a-50)/50);const r=Math.floor(n*(i-1)),l=Math.max(this.MIN_MESSAGE_COST,n+r),c=s?5e4:l;return{baseCost:n,characterCost:r,totalCost:s?Math.min(l,c):l,hasPixalPFP:s,discount:s?99:0}}async checkPixalPFPOwnership(e){try{const t=await ye.getUserInventory(e);if(!t||0===t.length)return!1;return t.some(e=>"781515"===e.template_id)}catch(t){return W.logError("ChatService.checkPixalPFPOwnership",t,{userAccount:e}),!1}}async sendMessage(e,t,a,s=!1){this.validateMessageForSending(e,t);let n=(await this.calculateMessageCost(e,t)).totalCost,i=e;s&&(n=this.SPONSORED_COST,i=`::sponsored:: ${e}`),a&&(i=`::col:${a}:: ${i}`),this.userLastMessageTime.set(t,Date.now());const r={account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.CHAT_ACCOUNT,quantity:`${(n/1e4).toFixed(8)} ${this.PXJ_SYMBOL}`,memo:i}};try{const e=await Ie.transact([r]);if(e&&e.transaction_id)return this.updateRateLimit(t),this.messageCache.clear(),e.transaction_id;throw new Error("Transaction failed")}catch(l){throw W.logError("ChatService.sendMessage",l,{messageLength:e.length}),new Error(`Failed to send message: ${l instanceof Error?l.message:"Unknown error"}`)}}async getMessages(e={},t=50,a=0){const s=JSON.stringify({filters:e,limit:t,offset:a});if(this.messageCache.has(s))return this.messageCache.get(s);try{const n=await ye.getAccountTransfers(this.CHAT_ACCOUNT,this.PXJ_CONTRACT,this.PXJ_SYMBOL,t,a);if(!n||0===n.length)return[];const i=[];for(const t of n){const a=this.parseTransferToMessage(t);a&&this.applyFilters(a,e)&&!this.isMessageBlockedByModeration(a)&&i.push(a)}return i.sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime()),this.messageCache.set(s,i),i}catch(n){return W.logError("ChatService.loadMessages",n),[]}}parseTransferToMessage(e){try{const t=String(e.memo||""),a=e.from,s=e.quantity,n=e.timestamp,i=e.transaction_id;if(this.blacklistedAccounts.has(a))return null;let r,l=t,c=!1,o="normal";t.startsWith("::sponsored::")&&(c=!0,o="sponsored",l=t.replace("::sponsored::","").trim());const d=t.match(/::col:([^:]+)::/);d&&(r=d[1],l=l.replace(d[0],"").trim());return parseFloat(s.split(" ")[0])>=10&&(o="premium"),{id:`${i}_${a}`,sender:a,message:l,timestamp:n,pxjAmount:s,transactionId:i,isSponsored:c,collectionTag:r,messageType:o,characterCount:l.length}}catch(t){const a=t instanceof Error?t:new Error("Failed to parse transfer to message");return W.logError("ChatService.parseTransferToMessage",a,{transfer:e?.transaction_id||"unknown"}),null}}applyFilters(e,t){if(t.collection&&e.collectionTag!==t.collection)return!1;if(t.minPxjAmount){if(parseFloat(e.pxjAmount.split(" ")[0])<t.minPxjAmount)return!1}if(t.maxPxjAmount){if(parseFloat(e.pxjAmount.split(" ")[0])>t.maxPxjAmount)return!1}return(!t.hideSpam||!this.isSpamMessage(e))&&!(t.showOnlySponsored&&!e.isSponsored)}isSpamMessage(e){const t=e.message.toLowerCase();return this.moderationSettings.bannedWords.some(e=>t.includes(e))}updateRateLimit(e){const t=Date.now(),a=this.userRateLimit.get(e)||[];a.push(t),this.userRateLimit.set(e,a)}blacklistAccount(e){this.blacklistedAccounts.add(e)}unblacklistAccount(e){this.blacklistedAccounts.delete(e)}clearCache(){this.messageCache.clear()}async getUserAvatar(e){try{const t=(await ye.getUserInventory(e)).filter(e=>"pixeljourney"===e.collection&&"Pixal"===e.schema);if(t&&t.length>0){const e=t[0];if(e.traits&&e.traits.img&&"string"==typeof e.traits.img)return`${te.IPFS.GATEWAYS[0]}${e.traits.img.startsWith("Qm"),e.traits.img}`}return`${te.AVATAR.DICEBEAR}?seed=${e}`}catch(t){const a=t instanceof Error?t:new Error("Failed to get user avatar");return W.logError("ChatService.getUserAvatar",a,{userAccount:e}),`${te.AVATAR.DICEBEAR}?seed=${e}`}}validateMessageForSending(e,t){if(this.moderationSettings.blacklistedAccounts.includes(t))throw new Error("Account is blacklisted from sending messages.");if(e.length>this.moderationSettings.maxMessageLength)throw new Error(`Message too long. Maximum ${this.moderationSettings.maxMessageLength} characters allowed.`);const a=e.toLowerCase();for(const n of this.moderationSettings.bannedWords)if(a.includes(n.toLowerCase()))throw new Error("Message contains prohibited content.");const s=this.userLastMessageTime.get(t);if(s){const e=(Date.now()-s)/1e3;if(e<this.moderationSettings.minTimeBetweenMessages)throw new Error(`Please wait ${this.moderationSettings.minTimeBetweenMessages-Math.floor(e)} more seconds before sending another message.`)}this.verifyLinksInMessage(e)}isMessageBlockedByModeration(e){if(this.moderationSettings.blacklistedAccounts.includes(e.sender))return!0;const t=e.message.toLowerCase();for(const a of this.moderationSettings.bannedWords)if(t.includes(a.toLowerCase()))return!0;return!1}verifyLinksInMessage(e){const t=e.match(/(https?:\/\/[^\s]+)/g);if(t)for(const s of t)try{const e=new URL(s).hostname.toLowerCase();if(!this.moderationSettings.trustedDomains.some(t=>e===t.toLowerCase()||e.endsWith("."+t.toLowerCase())))throw new Error(`Links to ${e} are not allowed. Only trusted domains are permitted.`)}catch(a){if(a instanceof Error&&a.message.includes("not allowed"))throw a;throw new Error("Invalid URL detected in message.")}}updateModerationSettings(e){this.moderationSettings={...this.moderationSettings,...e}}getModerationSettings(){return{...this.moderationSettings}}},Be=["strong","em","b","i","u","br","p","span"],Ue={span:["class"],p:["class"]};function ze(e){const t=document.createElement("div");return t.innerHTML=e,Xe(t),t.innerHTML}function Xe(e){const t=Array.from(e.children);for(const a of t){const e=a.tagName.toLowerCase();if(!Be.includes(e)){const e=document.createTextNode(a.textContent||"");a.parentNode?.replaceChild(e,a);continue}const t=Ue[e]||[],s=Array.from(a.attributes);for(const n of s)t.includes(n.name)||a.removeAttribute(n.name);Xe(a)}}function He(e){return ze(function(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}(e).replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"))}const qe=({isOpen:e,onClose:t,nft:s})=>{const{account:n,session:i}=R(),{showSuccess:r,showError:l}=_e(),c=a.useRef(null),[o,d]=a.useState([]),[u,m]=a.useState(""),[h,p]=a.useState(!1),[f,x]=a.useState(!1),[g,v]=a.useState(null),[y,j]=a.useState(!1),b=`listing:${s.sale_id||s.asset_id}`,N=a.useCallback(()=>{c.current?.scrollIntoView({behavior:"smooth"})},[]),w=a.useCallback(async(e=!1)=>{if(e||!(o.length>0)){p(!0);try{const e=await De.getMessages({collection:b,hideSpam:!0},50);d(e)}catch(t){console.error("Error loading listing messages:",t),l("Failed to load messages")}finally{p(!1)}}},[b,o.length,l]),k=a.useCallback(async()=>{if(n&&u.trim())try{const e=await De.calculateMessageCost(u,n);v(e)}catch(e){console.error("Error calculating cost:",e)}else v(null)},[n,u]),_=async()=>{if(n&&u.trim()&&i)if(s.seller)if(s.seller!==i.actor?.toString()){x(!0);try{const e=`${b} :${s.seller}: ${u.trim()}`,t=await De.sendMessage(e,n);r("Message sent!",`Transaction: ${t.substring(0,8)}...`),m(""),v(null),setTimeout(()=>{w(!0)},2e3)}catch(e){console.error("Error sending message:",e),l("Failed to send message",e instanceof Error?e.message:"Unknown error")}finally{x(!1)}}else l("You cannot message yourself");else l("Seller information not available");else l("Please connect your wallet to send messages")};return a.useEffect(()=>{e&&w()},[e,w]),a.useEffect(()=>{const e=setTimeout(k,300);return()=>clearTimeout(e)},[k]),a.useEffect(()=>{N()},[o,N]),a.useEffect(()=>{const a=e=>{"Escape"===e.key&&t()};if(e)return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[e,t]),e?A.jsx("div",{className:"listing-chat-modal-backdrop",onClick:t,children:A.jsxs("div",{className:"listing-chat-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"listing-chat-header",children:[A.jsx("div",{className:"listing-chat-header-left",children:A.jsxs("div",{className:"listing-info",children:[A.jsx("img",{src:s.image||"/placeholder-nft.png",alt:s.name,className:"listing-nft-image"}),A.jsxs("div",{className:"listing-details",children:[A.jsx("h3",{className:"listing-title",children:s.name}),A.jsxs("p",{className:"listing-seller",children:["Seller: ",s.seller]}),s.price&&A.jsx("p",{className:"listing-price",children:s.price})]})]})}),A.jsxs("div",{className:"listing-chat-header-right",children:[A.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>w(!0),disabled:h,title:"Refresh messages",children:A.jsx("span",{className:"chat_refresh-icon "+(h?"chat_refresh-icon--spinning":""),children:"🔄"})}),A.jsx("button",{className:"chat_btn chat_btn--icon",onClick:t,title:"Close chat",children:"✕"})]})]}),A.jsxs("div",{className:"listing-chat-messages",children:[h&&0===o.length?A.jsx("div",{className:"chat_loading",children:"Loading messages..."}):0===o.length?A.jsxs("div",{className:"chat_empty",children:[A.jsx("p",{children:"No messages yet for this listing."}),A.jsx("p",{children:"Be the first to start the conversation!"})]}):o.map(e=>A.jsxs("div",{className:`chat_message chat_message--${e.messageType||"normal"}`,children:[A.jsxs("div",{className:"chat_message-header",children:[A.jsx("div",{className:"chat_message-avatar",children:A.jsx("img",{src:`https://wax.atomichub.io/v1/accounts/${e.sender}/avatar`,alt:e.sender,className:"chat_avatar",onError:e=>{e.target.src="/default-avatar.png"}})}),A.jsxs("div",{className:"chat_message-info",children:[A.jsx("span",{className:"chat_sender",children:e.sender}),A.jsx("span",{className:"chat_timestamp",children:new Date(e.timestamp).toLocaleString()}),e.pxjAmount&&A.jsx("span",{className:"chat_amount",children:e.pxjAmount})]}),A.jsx("div",{className:"chat_message-actions",children:e.transactionId&&A.jsx("a",{href:`https://waxblock.io/transaction/${e.transactionId}`,target:"_blank",rel:"noopener noreferrer",className:"chat_tx-link",title:"View transaction",children:"🔗"})})]}),A.jsx("div",{className:"chat_message-content",dangerouslySetInnerHTML:{__html:He(e.message)}})]},e.id)),A.jsx("div",{ref:c})]}),A.jsxs("div",{className:"listing-chat-input-section",children:[g&&A.jsxs("div",{className:"chat_cost-info",children:[A.jsxs("div",{className:"chat_cost-display",children:[A.jsxs("span",{children:["Message Cost: ",A.jsxs("span",{className:"chat_cost-amount",children:[(g.totalCost/1e4).toFixed(4)," PXJ"]})]}),A.jsx("button",{className:"chat_info-btn",onClick:()=>j(!y),title:"View price breakdown",children:"ℹ️"})]}),g.hasPixalPFP&&A.jsxs("span",{className:"chat_discount",children:["Pixal PFP Discount: ",g.discount,"%"]}),A.jsxs("span",{className:"chat_char-count",children:[u.length,"/240 chars"]}),y&&A.jsx("div",{className:"chat_price-tooltip",children:A.jsxs("div",{className:"chat_price-content",children:[A.jsx("h4",{children:"Price Breakdown"}),A.jsxs("div",{className:"price-factor",children:[A.jsx("span",{children:"Base Cost:"}),A.jsxs("span",{children:[(g.baseCost/1e4).toFixed(4)," PXJ"]})]}),A.jsxs("div",{className:"price-factor",children:[A.jsxs("span",{children:["Character Cost (",u.length," chars):"]}),A.jsxs("span",{children:[((g.totalCost-g.baseCost)/1e4).toFixed(4)," PXJ"]})]}),g.hasPixalPFP&&A.jsxs("div",{className:"price-factor discount",children:[A.jsxs("span",{children:["Pixal PFP Discount (",g.discount,"%):"]}),A.jsxs("span",{children:["-",((g.baseCost+(g.totalCost-g.baseCost))*(g.discount/100)/1e4).toFixed(4)," PXJ"]})]}),A.jsxs("div",{className:"price-factor total",children:[A.jsx("span",{children:"Total:"}),A.jsxs("span",{children:[(g.totalCost/1e4).toFixed(4)," PXJ"]})]})]})})]}),A.jsxs("div",{className:"listing-chat-input-wrapper",children:[A.jsx("textarea",{className:"listing-chat-input",value:u,onChange:e=>m(e.target.value),placeholder:`Send a message about ${s.name}...`,maxLength:240,rows:3,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),_())}}),A.jsx("button",{className:"listing-chat-send-btn",onClick:_,disabled:!u.trim()||f||!n,children:f?"⏳":"📤"})]}),!n&&A.jsx("div",{className:"listing-chat-connect-notice",children:"Please connect your wallet to send messages"})]})]})}):null},Je=e=>{const t=te.IPFS.GATEWAYS;return`${t[Math.floor(Math.random()*t.length)]}${e}`},Ve=e=>{if(!e)return;if(e.image&&"string"==typeof e.image)return e.image;let t;return e.data&&"object"==typeof e.data&&"img"in e.data&&(t=e.data.img),t||(t=e.template?.immutable_data?.img||e.img),t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Je(t):t:void 0},Ge=e=>{if(!e)return null;if(e.video&&"string"==typeof e.video)return e.video;let t;return e.data&&"object"==typeof e.data&&"video"in e.data&&(t=e.data.video),t||(t=e.template?.immutable_data?.video||e.video),t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Je(t):t:null},Ke=e=>{if(!e)return;const t=e.immutable_data?.img||e.data?.img||e.img||e.template?.immutable_data?.img;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Je(t):t:void 0},Ye=e=>{if(!e)return null;const t=e.immutable_data?.video||e.data?.video||e.video||e.template?.immutable_data?.video;return t&&"string"==typeof t?t.startsWith("http")?t:t.startsWith("Qm")?Je(t):t:null},Qe=e=>{const t=e?.assets?.[0];return Ve(t)},Ze=e=>{const t=e?.assets?.[0];return Ge(t)},et=({nft:e,isOpen:t,onClose:s,usdPrice:n})=>{const r=i(),{settings:l}=ue(),[c,o]=a.useState("$0.00"),[d,u]=a.useState(!1),[m,h]=a.useState(!1),[p,f]=a.useState(!1),[x,g]=a.useState(!1),[v,y]=a.useState(!1),[j,b]=a.useState(null),{isConnected:N,purchaseNFT:w,login:k}=R(),{showSuccess:_,showError:S,showWarning:C}=_e(),[E,P]=a.useState(null),[T,I]=a.useState([]),[F,$]=a.useState([]);a.useEffect(()=>{(async()=>{try{const e=Ie.getSession();b(e?{...e,actor:e.actor}:null)}catch(e){V("No active session","NFTDetailsModal",e)}})()},[]),a.useEffect(()=>{t&&e&&(L(),M(),W())},[t,e]);const L=async()=>{if(e?.collection)try{const t=await ye.getCollectionStats(e.collection);t&&P({floorPrice:t.floor_price||"0",volume24h:t.volume_24h||"0",totalSales:t.sales||"0",avgPrice:t.averagePrice||"0"})}catch(t){K("Error fetching collection stats","NFTDetailsModal",t)}},M=async()=>{if(e?.collection)try{const t=await ye.getSales({collection_name:e.collection,state:"3",limit:5,sort:"updated",order:"desc"});if(t.success&&t.data){const e=t.data.map(e=>({type:"sale",price:`${(parseFloat(e.price?.amount||"0")/Math.pow(10,e.price?.token_precision||8)).toFixed(4)} ${e.price?.token_symbol||"WAX"}`,time:new Date(1e3*parseInt(e.updated_at_time)).toLocaleString()}));I(e)}}catch(t){K("Error fetching recent activity","NFTDetailsModal",t)}},W=async()=>{if(e?.collection)try{const t=await ye.getCollectionPriceHistory(e.collection,"7d");$(t)}catch(t){K("Error fetching price history","NFTDetailsModal",t),$([])}};a.useEffect(()=>{e&&!n&&e.price&&ie.convertWaxToUSDAsync(e.price).then(o)},[e,n]),a.useEffect(()=>{(async()=>{if(e){const t=ce.getCart();u(t.some(t=>t.nft.asset_id===e.asset_id));const a=await Te.getWatchlist();h(a.some(t=>t.nft.asset_id===e.asset_id))}})()},[e]),a.useEffect(()=>{const t=()=>{if(e){const t=ce.getCart();u(t.some(t=>t.nft.asset_id===e.asset_id))}};ce.addListener(t);const a=Te.subscribe(async()=>{if(e){const t=await Te.getWatchlist();h(t.some(t=>t.nft.asset_id===e.asset_id))}});return()=>{ce.removeListener(t),a()}},[e]);const O=()=>{e&&(s(),r(`/assets/${e.asset_id}`))};if(!t||!e)return null;return A.jsxs("div",{className:"modal-backdrop",onClick:e=>{e.target===e.currentTarget&&s()},children:[A.jsxs("div",{className:"modal-content nft-details-modal",children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{className:"modal-title",children:e.name}),A.jsx("button",{className:"modal-close",onClick:s,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsx("div",{className:"modal-body",children:A.jsx("div",{className:"nft-details-container",children:A.jsxs("div",{className:"nft-details-top",children:[A.jsx("div",{className:"nft-media-section",children:A.jsxs("div",{className:"nft-media-container",children:[A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name,className:"nft-media",controls:!0,loop:!0,muted:!0,enableAnimations:l.enableAnimatedNFTs}),(e.template_mint||e.max_supply)&&A.jsxs("div",{className:"mint-info",children:["Mint: ",void 0!==e.template_mint&&null!==e.template_mint?e.template_mint:"?"," / ","0"===e.max_supply||void 0===e.max_supply||null===e.max_supply?"∞":e.max_supply]})]})}),A.jsxs("div",{className:"nft-info-section",children:[A.jsxs("div",{className:"info-card",children:[A.jsx("h3",{className:"info-title",children:"Basic Information"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Collection:"}),A.jsx("span",{className:"info-value info-link",onClick:()=>{e&&(s(),r(`/collections/${e.collection}`))},title:"View collection on AtomicHub",children:e.collection})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Schema:"}),A.jsx("span",{className:"info-value info-link",onClick:()=>{e&&window.open(`https://wax.atomichub.io/explorer/schema/wax-mainnet/${e.collection}/${e.schema}`,"_blank")},title:"View schema on AtomicHub",children:e.schema})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Asset ID:"}),A.jsx("span",{className:"info-value info-link",onClick:O,title:"View asset on AtomicHub",children:e.asset_id})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Seller:"}),A.jsx("span",{className:"info-value info-link",onClick:()=>{e&&e.seller&&(s(),r(`/user-profile-lookup?user=${encodeURIComponent(e.seller)}`))},title:"View seller profile",children:e.seller})]})]})]}),A.jsxs("div",{className:"info-card",children:[A.jsx("h3",{className:"info-title",children:"Price Information"}),A.jsxs("div",{className:"price-display",children:[A.jsx("div",{className:"price-main",children:e.price}),A.jsx("div",{className:"price-usd",children:n||c})]})]}),e.traits&&Object.keys(e.traits).length>0&&A.jsxs("div",{className:"info-card",children:[A.jsx("h3",{className:"info-title",children:"Attributes"}),A.jsx("div",{className:"attributes-grid",children:(D=e.traits,Object.entries(D).filter(([e,t])=>"img"!==e&&"video"!==e&&"name"!==e&&null!=t)).map(([e,t])=>A.jsxs("div",{className:"attribute-item",children:[A.jsx("div",{className:"attribute-label",children:e}),A.jsx("div",{className:"attribute-value",children:String(t)})]},e))})]}),A.jsxs("div",{className:"info-card",children:[A.jsx("h3",{className:"info-title",children:"Statistics"}),A.jsx("div",{className:"nft-statistics",children:A.jsxs("div",{className:"stats-grid",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-label",children:"Floor Price"}),A.jsx("span",{className:"stat-value",children:E?`${parseFloat(E.floorPrice).toFixed(4)} WAX`:"Loading..."})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-label",children:"24h Volume"}),A.jsx("span",{className:"stat-value",children:E?`${parseFloat(E.volume24h).toFixed(2)} WAX`:"Loading..."})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-label",children:"Total Sales"}),A.jsx("span",{className:"stat-value",children:E?E.totalSales:"Loading..."})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-label",children:"Avg Sale Price"}),A.jsx("span",{className:"stat-value",children:E?`${parseFloat(E.avgPrice).toFixed(4)} WAX`:"Loading..."})]})]})})]})]}),A.jsx("div",{className:"nft-details-bottom",children:A.jsxs("div",{className:"info-card",children:[A.jsx("h3",{className:"info-title",children:"Price History & Activity"}),A.jsxs("div",{className:"nft-statistics",children:[A.jsxs("div",{className:"price-history-section",children:[A.jsx("h4",{className:"price-history-title",children:"Recent Price History"}),A.jsx("div",{className:"price-history-chart",children:F.length>0?A.jsxs("div",{className:"chart-placeholder",children:[A.jsxs("svg",{viewBox:"0 0 400 120",className:"price-chart",children:[[0,1,2,3,4].map(e=>A.jsx("line",{x1:"20",y1:20+20*e,x2:"380",y2:20+20*e,stroke:"var(--border-color)",strokeWidth:"1",opacity:"0.3"},`grid-${e}`)),F.length>1&&A.jsx("polyline",{fill:"none",stroke:"var(--accent-color)",strokeWidth:"2",points:F.map((e,t)=>{const a=20+t/(F.length-1)*360,s=Math.max(...F.map(e=>e.price)),n=Math.min(...F.map(e=>e.price)),i=s-n||1;return`${a},${100-(e.price-n)/i*60}`}).join(" ")}),F.map((e,t)=>{const a=20+t/(F.length-1)*360,s=Math.max(...F.map(e=>e.price)),n=Math.min(...F.map(e=>e.price)),i=s-n||1,r=100-(e.price-n)/i*60;return A.jsx("circle",{cx:a,cy:r,r:"3",fill:"var(--accent-color)"},t)})]}),A.jsxs("div",{className:"chart-labels",children:[A.jsx("span",{children:F.length>0?new Date(F[0].timestamp).toLocaleDateString():"7d ago"}),A.jsx("span",{children:F.length>0?new Date(F[F.length-1].timestamp).toLocaleDateString():"Now"})]})]}):A.jsx("div",{className:"chart-placeholder",children:A.jsx("div",{className:"loading-chart",children:"Loading price history..."})})})]}),A.jsxs("div",{className:"trading-activity",children:[A.jsx("h4",{className:"activity-title",children:"Recent Activity"}),A.jsx("div",{className:"activity-list",children:T.length>0?T.map((e,t)=>A.jsxs("div",{className:"activity-item",children:[A.jsx("span",{className:`activity-type ${e.type}`,children:"sale"===e.type?"Sale":"Listed"}),A.jsx("span",{className:"activity-price",children:e.price}),A.jsx("span",{className:"activity-time",children:e.time})]},t)):A.jsxs("div",{className:"activity-item",children:[A.jsx("span",{className:"activity-type",children:"Loading..."}),A.jsx("span",{className:"activity-price",children:"-"}),A.jsx("span",{className:"activity-time",children:"-"})]})})]})]})]})})]})})}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("div",{className:"modal-actions-left",children:e.sale_id?A.jsxs(A.Fragment,{children:[A.jsxs("button",{className:"btn-primary",onClick:async()=>{if(!N)try{await k()}catch(t){return void K("Login failed","NFTDetailsModal",t)}if(e.sale_id)if(e.sale_id&&e.price)try{await w(e.sale_id,e.price),_("Purchase successful!"),s()}catch(t){K("Purchase failed","NFTDetailsModal",t),S("Purchase failed. Please try again.")}else S("NFT is not available for purchase");else C("This NFT is not for sale")},title:`Buy now for ${e.price} WAX`,children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M9 12l2 2 4-4"}),A.jsx("path",{d:"M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9c1.66 0 3.22.45 4.56 1.23"})]}),"Buy Now"]}),A.jsxs("button",{className:"btn-secondary",onClick:()=>g(!0),title:"Make Offer",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M11 17a4 4 0 0 1 8 0c0 .7-.2 1.4-.5 2H18a3 3 0 0 0 0-6c-.2-1.8-1.9-3.2-4-3.2-.6 0-1.1.1-1.6.4"}),A.jsx("path",{d:"M6.2 15.8A4 4 0 1 0 2 12c0-.7.2-1.4.5-2H3a3 3 0 0 1 0 6c.2 1.8 1.9 3.2 4 3.2.6 0 1.1-.1 1.6-.4"}),A.jsx("path",{d:"M8 12h8"}),A.jsx("circle",{cx:"12",cy:"8",r:"2"})]}),"Make Offer"]}),A.jsx("button",{className:"btn-secondary "+(d?"in-cart":""),onClick:()=>{if(d)ce.removeFromCart(e.asset_id);else{ce.addToCart(e)||C("Item is already in your cart!")}},title:d?"Remove from cart":"Add to cart",children:A.jsxs("div",{className:"cart-icon-container",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"cart-icon",children:[A.jsx("circle",{cx:"9",cy:"21",r:"1"}),A.jsx("circle",{cx:"20",cy:"21",r:"1"}),A.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"cart-action-icon",children:d?A.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"}):A.jsxs(A.Fragment,{children:[A.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),A.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})]})})]}):A.jsxs("button",{className:"btn-disabled",disabled:!0,children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("line",{x1:"4.93",y1:"4.93",x2:"19.07",y2:"19.07"})]}),"Not Available"]})}),A.jsxs("div",{className:"modal-actions-right",children:[A.jsx("button",{className:"btn-icon btn-external",onClick:O,title:"View full asset details page",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),A.jsx("circle",{cx:"12",cy:"12",r:"3"})]})}),e?.seller&&A.jsx("button",{className:"btn-icon btn-message",onClick:()=>{y(!0)},title:"Send Direct Message (1000 PXJ)",disabled:!j||e.seller===j?.actor,children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),A.jsx("button",{className:"btn-icon "+(m?"in-watchlist":""),onClick:async()=>{if(m)await Te.removeFromWatchlist(e.asset_id);else{await Te.addToWatchlist(e)||C("Item is already in your watchlist!")}},title:m?"Remove from watchlist":"Add to watchlist",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:m?A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:"currentColor"}):A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),A.jsx("button",{className:"btn-icon btn-share",onClick:()=>f(!0),title:"Share",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),A.jsx("polyline",{points:"16,6 12,2 8,6"}),A.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})}),A.jsx("button",{className:"btn-icon",onClick:s,title:"Close",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]})]})]}),p&&A.jsx(Oe,{isOpen:p,onClose:()=>f(!1),title:e?.name||"NFT",description:`Check out this amazing NFT: ${e?.name||"Unnamed NFT"}`,imageUrl:Ve(e),shareUrl:`${window.location.origin}/assets/${e?.asset_id}`,defaultShareText:`Check out this NFT: ${e?.name||"Unnamed NFT"} on PxMarket! 🎮✨ View it at market.pixeljourney.xyz`,type:"nft"}),A.jsx($e,{isOpen:x,onClose:()=>g(!1),nft:e}),e&&A.jsx(qe,{isOpen:v,onClose:()=>y(!1),nft:e})]});var D},tt=({isOpen:e,onClose:t,initialNFTs:s=[]})=>{const[n,i]=a.useState(s),[r,l]=a.useState(""),[c,o]=a.useState([]),[d,u]=a.useState(!1),[m,h]=a.useState({showPrice:!0,showRarity:!0,showAttributes:!0,showCollection:!0,showSeller:!0});a.useEffect(()=>{s.length>0&&i(s)},[s]);const p=e=>{if(!e)return"#666";switch(e.toLowerCase()){case"common":return"#9CA3AF";case"rare":return"#3B82F6";case"epic":return"#8B5CF6";case"legendary":return"#F59E0B";case"mythic":return"#EF4444";default:return"#666"}},f=(e,t)=>{if(!e.traits)return"N/A";return e.traits[t]||"N/A"};return e?A.jsx("div",{className:"nft-comparison-overlay",children:A.jsxs("div",{className:"nft-comparison-modal",children:[A.jsxs("div",{className:"comparison-header",children:[A.jsx("h2",{children:"NFT Comparison Tool"}),A.jsx("button",{className:"close-btn",onClick:t,children:A.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A.jsxs("div",{className:"comparison-content",children:[A.jsxs("div",{className:"search-section",children:[A.jsxs("div",{className:"search-input-container",children:[A.jsx("input",{type:"text",placeholder:"Search NFTs to add to comparison...",value:r,onChange:e=>{l(e.target.value),(async e=>{if(e.trim()){u(!0);try{const[t,a,s]=await Promise.all([ye.getWaxRockPixals(20),ye.getFriedFactoryNFTs(20),ye.getCryptoMuffinsNFTs(20)]),n=[...t,...a,...s].filter(t=>t.name.toLowerCase().includes(e.toLowerCase())||t.collection.toLowerCase().includes(e.toLowerCase()));o(n.slice(0,10))}catch(t){console.error("Error searching NFTs:",t),o([])}finally{u(!1)}}else o([])})(e.target.value)},className:"search-input"}),d&&A.jsx("div",{className:"search-loading",children:"Searching..."})]}),c.length>0&&A.jsx("div",{className:"search-results",children:c.map(e=>A.jsxs("div",{className:"search-result-item",onClick:()=>(e=>{n.length>=4?alert("You can compare up to 4 NFTs at once"):n.find(t=>t.asset_id===e.asset_id)?alert("This NFT is already in the comparison"):(i([...n,e]),l(""),o([]))})(e),children:[A.jsx("img",{src:e.image,alt:e.name,className:"result-image"}),A.jsxs("div",{className:"result-info",children:[A.jsx("div",{className:"result-name",children:e.name}),A.jsx("div",{className:"result-collection",children:e.collection}),A.jsx("div",{className:"result-price",children:e.price})]})]},e.asset_id))})]}),A.jsxs("div",{className:"metrics-toggle",children:[A.jsx("h3",{children:"Show Comparison Metrics:"}),A.jsx("div",{className:"toggle-buttons",children:Object.entries(m).map(([e,t])=>A.jsx("button",{className:"toggle-btn "+(t?"active":""),onClick:()=>{return t=e,void h(e=>({...e,[t]:!e[t]}));var t},children:e.replace("show","").replace(/([A-Z])/g," $1").trim()},e))})]}),n.length>0?A.jsx("div",{className:"comparison-table",children:A.jsxs("div",{className:"comparison-grid",children:[A.jsxs("div",{className:"comparison-row header-row",children:[A.jsx("div",{className:"metric-label",children:"NFT"}),n.map(e=>A.jsx("div",{className:"nft-column",children:A.jsxs("div",{className:"nft-header",children:[A.jsx("img",{src:e.image,alt:e.name,className:"nft-image"}),A.jsxs("div",{className:"nft-info",children:[A.jsx("div",{className:"nft-name",children:e.name}),A.jsxs("div",{className:"nft-id",children:["#",e.asset_id]})]}),A.jsx("button",{className:"remove-nft-btn",onClick:()=>{return t=e.asset_id,void i(n.filter(e=>e.asset_id!==t));var t},title:"Remove from comparison",children:"×"})]})},e.asset_id))]}),m.showPrice&&A.jsxs("div",{className:"comparison-row",children:[A.jsx("div",{className:"metric-label",children:"Price"}),n.map(e=>A.jsx("div",{className:"metric-value price",children:e.price},e.asset_id))]}),m.showRarity&&A.jsxs("div",{className:"comparison-row",children:[A.jsx("div",{className:"metric-label",children:"Rarity"}),n.map(e=>A.jsx("div",{className:"metric-value rarity",children:A.jsx("span",{className:"rarity-badge",style:{backgroundColor:p(String(e.traits?.rarity||"Unknown"))},children:e.traits?.rarity||"Unknown"})},e.asset_id))]}),m.showCollection&&A.jsxs("div",{className:"comparison-row",children:[A.jsx("div",{className:"metric-label",children:"Collection"}),n.map(e=>A.jsx("div",{className:"metric-value",children:e.collection},e.asset_id))]}),m.showSeller&&A.jsxs("div",{className:"comparison-row",children:[A.jsx("div",{className:"metric-label",children:"Seller"}),n.map(e=>A.jsx("div",{className:"metric-value",children:e.seller},e.asset_id))]}),m.showAttributes&&(()=>{const e=new Set;return n.forEach(t=>{t.traits&&Object.keys(t.traits).forEach(t=>{"rarity"!==t&&e.add(t)})}),Array.from(e)})().map(e=>A.jsxs("div",{className:"comparison-row",children:[A.jsx("div",{className:"metric-label",children:e}),n.map(t=>A.jsx("div",{className:"metric-value",children:f(t,e)},t.asset_id))]},e))]})}):A.jsxs("div",{className:"empty-comparison",children:[A.jsx("div",{className:"empty-icon",children:"📊"}),A.jsx("h3",{children:"No NFTs to Compare"}),A.jsx("p",{children:"Search and add NFTs above to start comparing their attributes, prices, and more."})]})]})]})}):null},at=({nft:e,isOpen:t,onClose:s})=>{const[n,i]=a.useState(!1),[r,l]=a.useState(""),c=[`🎨 Check out this amazing NFT: ${e.name} from ${e.collection}! ✨`,`🔥 Discovered this incredible ${e.name} NFT! Part of the ${e.collection} collection 🚀`,`✨ Look at this stunning ${e.name} from ${e.collection}! NFT art at its finest 🎭`,`🌟 Found a gem! ${e.name} from the ${e.collection} collection is absolutely beautiful 💎`,`🎯 This ${e.name} NFT caught my eye! Amazing work from ${e.collection} 🎨`,`💫 Showcasing ${e.name} - a masterpiece from ${e.collection}! 🖼️`,`🚀 Blown away by this ${e.name} NFT! ${e.collection} never disappoints ⭐`,`🎪 Step right up and see ${e.name}! Another fantastic piece from ${e.collection} 🎊`],o=()=>{const e=Math.floor(Math.random()*c.length);return c[e]},[d,u]=a.useState(()=>o());if(!t)return null;const m=window.location.pathname;let h=`${window.location.origin}/assets/${e.asset_id}`;m.includes("/listings/")&&(h=window.location.href);const p=async e=>{try{await navigator.clipboard.writeText(e),i(!0),setTimeout(()=>i(!1),2e3)}catch(t){console.error("Failed to copy to clipboard:",t)}};return A.jsx("div",{className:"social-share-overlay",onClick:s,children:A.jsxs("div",{className:"social-share-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"share-header",children:[A.jsx("h3",{children:"Share NFT"}),A.jsx("button",{className:"close-btn",onClick:s,children:A.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A.jsxs("div",{className:"share-content",children:[A.jsxs("div",{className:"nft-preview",children:[A.jsx("img",{src:e.image,alt:e.name,className:"nft-image"}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h4",{children:e.name}),A.jsx("p",{children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),A.jsx("span",{className:"nft-price",children:e.price})]})]}),A.jsxs("div",{className:"share-text-section",children:[A.jsxs("div",{className:"share-text-header",children:[A.jsx("label",{htmlFor:"share-text",children:"Customize your message:"}),A.jsx("button",{className:"refresh-message-btn",onClick:()=>{u(o())},title:"Generate new random message",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),A.jsx("textarea",{id:"share-text",value:r,onChange:e=>l(e.target.value),placeholder:d,className:"share-textarea",rows:3})]}),A.jsxs("div",{className:"share-url-section",children:[A.jsx("label",{children:"Share URL:"}),A.jsxs("div",{className:"url-input-container",children:[A.jsx("input",{type:"text",value:h,readOnly:!0,className:"url-input"}),A.jsxs("button",{className:"copy-btn "+(n?"copied":""),onClick:()=>p(h),children:[n?A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):A.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),A.jsx("path",{d:"M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"})]}),n?"Copied!":"Copy"]})]})]}),A.jsxs("div",{className:"social-buttons",children:[A.jsxs("button",{className:"social-btn twitter",onClick:()=>{const e=`https://twitter.com/intent/tweet?text=${encodeURIComponent(r||d)}&url=${encodeURIComponent(h)}&hashtags=NFT,WAX,PixelJourney`;window.open(e,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"})}),"Twitter"]}),A.jsxs("button",{className:"social-btn facebook",onClick:()=>{const e=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(h)}`;window.open(e,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),"Facebook"]}),A.jsxs("button",{className:"social-btn reddit",onClick:()=>{const e=r||d,t=`https://reddit.com/submit?url=${encodeURIComponent(h)}&title=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z"})}),"Reddit"]}),A.jsxs("button",{className:"social-btn discord",onClick:()=>{p(`${r||d}\n${h}`),alert("Share text copied to clipboard! You can now paste it in Discord.")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3933-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286zM8.02 15.3312c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9555-2.4189 2.157-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419-.0190 1.3332-.9555 2.4189-2.1569 2.4189zm7.9748 0c-1.1825 0-2.1569-1.0857-2.1569-2.419 0-1.3332.9554-2.4189 2.1569-2.4189 1.2108 0 2.1757 1.0952 2.1568 2.419 0 1.3332-.9555 2.4189-2.1568 2.4189Z"})}),"Discord"]}),A.jsxs("button",{className:"social-btn telegram",onClick:()=>{const e=r||d,t=`https://t.me/share/url?url=${encodeURIComponent(h)}&text=${encodeURIComponent(e)}`;window.open(t,"_blank","width=550,height=420")},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Telegram"]}),A.jsxs("button",{className:"social-btn email",onClick:()=>{const t=`Check out this NFT: ${e.name}`,a=`${r||d}\n\nView it here: ${h}`,s=`mailto:?subject=${encodeURIComponent(t)}&body=${encodeURIComponent(a)}`;window.location.href=s},children:[A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email"]})]})]})]})})},st=({title:e,message:t,onRetry:a,showRetry:s=!0,error:n,errorConfig:i,errorType:r,isRetrying:l=!1,retryCount:c=0,maxRetries:o=3})=>{let d;d=i||(r?W.getMessage(r):n?W.formatError(n):{title:e||"Oh no! Something went wrong",message:t||"We're having trouble loading the data right now. Please try again in a moment.",action:"Try Again"});const u=e||d.title,m=t||d.message,h=l?"Retrying...":d.action||"Try Again";return A.jsx("div",{className:"error-message "+(l?"retrying":""),children:A.jsxs("div",{className:"error-content",children:[A.jsx("div",{className:"error-icon "+(l?"spinning":""),children:(()=>{if(l)return"🔄";switch(r){case"NETWORK_ERROR":return"📡";case"TIMEOUT_ERROR":return"⏱️";case"API_ERROR":return"⚠️";case"LOAD_FAILED":return"📂";default:return"😅"}})()}),A.jsx("h3",{className:"error-title",children:u}),A.jsx("p",{className:"error-text",children:m}),c>0&&!l&&A.jsx("div",{className:"retry-status",children:A.jsxs("span",{className:"retry-count",children:["Attempt ",c," of ",o]})}),s&&a&&A.jsxs("button",{className:"error-retry-btn "+(l?"retrying":""),onClick:a,disabled:l||c>=o,children:[l&&A.jsx("span",{className:"retry-spinner"}),h]}),c>=o&&A.jsxs("div",{className:"max-retries-reached",children:[A.jsx("p",{children:"Maximum retry attempts reached. Please refresh the page or try again later."}),A.jsx("button",{className:"error-refresh-btn",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})})},nt="pixeljourney_search_history",it=({searchTerm:e,onSearchChange:t,suggestions:s=[],placeholder:n="Search NFTs, collections, schemas...",showFilters:i=!1,onFilterChange:r,className:l=""})=>{const[c,o]=a.useState(!1),[d,u]=a.useState([]),[m,h]=a.useState({priceRange:{min:"",max:""},rarities:[],collections:[],schemas:[],sortBy:"relevance"}),[p,f]=a.useState(!1),x=a.useRef(null),g=a.useRef(null),[v,y]=a.useState(-1);a.useEffect(()=>{const e=localStorage.getItem(nt);if(e)try{u(JSON.parse(e))}catch(t){console.error("Failed to parse search history:",t)}},[]);const j=a.useCallback(e=>{if(!e.trim()||e.length<2)return;const t=[e,...d.filter(t=>t!==e)].slice(0,10);u(t),localStorage.setItem(nt,JSON.stringify(t))},[d]),b=a.useCallback(()=>{u([]),localStorage.removeItem(nt)},[]),N=a.useCallback(e=>{t(e),y(-1),e.length>=2?o(!0):o(!1)},[t]),w=a.useCallback(()=>{e.trim()&&(j(e.trim()),o(!1),x.current?.blur())},[e,j]),k=a.useCallback(e=>{N(e.text),j(e.text),o(!1)},[N,j]),_=a.useCallback(e=>{if(!c)return;const t=[...d.map(e=>({text:e,type:"history"})),...s];switch(e.key){case"ArrowDown":e.preventDefault(),y(e=>e<t.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),y(e=>e>-1?e-1:-1);break;case"Enter":e.preventDefault(),v>=0&&t[v]?k(t[v]):w();break;case"Escape":o(!1),y(-1),x.current?.blur()}},[c,d,s,v,k,w]),S=a.useCallback(e=>{const t={...m,...e};h(t),r?.(t)},[m,r]);a.useEffect(()=>{const e=e=>{g.current&&!g.current.contains(e.target)&&x.current&&!x.current.contains(e.target)&&(o(!1),y(-1))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const C=[...d.map(e=>({text:e,type:"history"})),...s];return A.jsxs("div",{className:`advanced-search ${l}`,children:[A.jsxs("div",{className:"search-container",children:[A.jsxs("div",{className:"search-input-wrapper",children:[A.jsx("svg",{className:"search-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m21 21-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),A.jsx("input",{ref:x,type:"text",value:e,onChange:e=>N(e.target.value),onKeyDown:_,onFocus:()=>{(e.length>=2||d.length>0)&&o(!0)},placeholder:n,className:"search-input","aria-label":"Search for NFTs, collections, or schemas","aria-describedby":c?"search-suggestions":void 0,"aria-expanded":c,"aria-autocomplete":"list",role:"combobox"}),e&&A.jsx("button",{className:"clear-search",onClick:()=>{N(""),o(!1)},title:"Clear search","aria-label":"Clear search input",type:"button",children:A.jsx("span",{"aria-hidden":"true",children:"✕"})}),i&&A.jsx("button",{className:"filter-toggle "+(p?"active":""),onClick:()=>f(!p),title:"Advanced filters","aria-label":p?"Hide advanced filters":"Show advanced filters","aria-expanded":p,type:"button",children:A.jsx("svg",{fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]}),c&&C.length>0&&A.jsxs("div",{ref:g,className:"search-suggestions",id:"search-suggestions",role:"listbox","aria-label":"Search suggestions",children:[d.length>0&&A.jsxs("div",{className:"suggestions-section",children:[A.jsxs("div",{className:"suggestions-header",children:[A.jsx("span",{id:"recent-searches-label",children:"Recent searches"}),A.jsx("button",{onClick:b,className:"clear-history","aria-label":"Clear search history",type:"button",children:"Clear"})]}),A.jsx("div",{role:"group","aria-labelledby":"recent-searches-label",children:d.map((e,t)=>A.jsxs("div",{className:"suggestion-item history "+(v===t?"selected":""),onClick:()=>k({text:e,type:"history"}),role:"option","aria-selected":v===t,tabIndex:-1,children:[A.jsx("svg",{className:"suggestion-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),A.jsx("span",{children:e})]},`history-${t}`))})]}),s.length>0&&A.jsxs("div",{className:"suggestions-section",children:[d.length>0&&A.jsx("div",{className:"suggestions-divider"}),A.jsx("div",{className:"suggestions-header",children:A.jsx("span",{children:"Suggestions"})}),s.map((e,t)=>{const a=d.length+t;return A.jsxs("div",{className:`suggestion-item ${e.type} ${v===a?"selected":""}`,onClick:()=>k(e),children:[A.jsxs("svg",{className:"suggestion-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:["name"===e.type&&A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"}),"collection"===e.type&&A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"}),"schema"===e.type&&A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})]}),A.jsx("span",{children:e.text}),e.count&&A.jsx("span",{className:"suggestion-count",children:e.count})]},`suggestion-${t}`)})]})]})]}),i&&p&&A.jsxs("div",{className:"advanced-filters",children:[A.jsxs("div",{className:"filters-grid",children:[A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{className:"filter-label",children:"Price Range (WAX)"}),A.jsxs("div",{className:"price-range",children:[A.jsx("input",{type:"number",placeholder:"Min",value:m.priceRange.min,onChange:e=>S({priceRange:{...m.priceRange,min:e.target.value}}),className:"price-input"}),A.jsx("span",{className:"price-separator",children:"to"}),A.jsx("input",{type:"number",placeholder:"Max",value:m.priceRange.max,onChange:e=>S({priceRange:{...m.priceRange,max:e.target.value}}),className:"price-input"})]})]}),A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{className:"filter-label",children:"Sort By"}),A.jsxs("select",{value:m.sortBy,onChange:e=>S({sortBy:e.target.value}),className:"filter-select",children:[A.jsx("option",{value:"relevance",children:"Relevance"}),A.jsx("option",{value:"price_asc",children:"Price: Low to High"}),A.jsx("option",{value:"price_desc",children:"Price: High to Low"}),A.jsx("option",{value:"name_asc",children:"Name: A to Z"}),A.jsx("option",{value:"name_desc",children:"Name: Z to A"}),A.jsx("option",{value:"newest",children:"Newest First"}),A.jsx("option",{value:"oldest",children:"Oldest First"})]})]})]}),A.jsx("div",{className:"filter-actions",children:A.jsx("button",{onClick:()=>{const e={priceRange:{min:"",max:""},rarities:[],collections:[],schemas:[],sortBy:"relevance"};h(e),r?.(e)},className:"filter-reset",children:"Reset Filters"})})]})]})},rt=()=>{const e=i(),{settings:t}=ue(),{showSuccess:s,showError:n,showWarning:r}=_e(),[l,c]=a.useState([]),[o,d]=a.useState("idle"),[u,m]=a.useState(""),[h,p]=a.useState("pixals"),[f,x]=a.useState({}),[g,v]=a.useState(null),[y,j]=a.useState(!1),[b,N]=a.useState(new Set),[w,k]=a.useState(new Set),[_,S]=a.useState(1),[C,E]=a.useState(1),[P,T]=a.useState([]),[I,F]=a.useState(!1),[$,L]=a.useState({min:"",max:""}),[M,R]=a.useState(new Set),[O,D]=a.useState("price_asc"),[B,U]=a.useState({start:"",end:""}),[z,X]=a.useState([]),[H,q]=a.useState([]),[V,G]=a.useState([]),[Y,Q]=a.useState(new Set),[Z,ee]=a.useState(new Map),[te,ae]=a.useState(new Map),[se,ne]=a.useState(new Set),[re,le]=a.useState(new Set),[oe,de]=a.useState(!1),[me,he]=a.useState(!1),[pe,fe]=a.useState(null),[xe,ge]=a.useState(!1),[ve,je]=a.useState(null),[be,Ne]=a.useState(!1),[we,ke]=a.useState(null),[Se,Ce]=a.useState(!1),[Ae,Ee]=a.useState(new Set),[Pe,Le]=a.useState(null),[Me,Re]=a.useState(!1),We=a.useCallback(e=>{Ee(t=>{const a=new Set(t);return a.has(e)?a.delete(e):(a.clear(),a.add(e)),a})},[]),Oe=a.useCallback(()=>{Ee(new Set)},[]),De=a.useCallback((e,t)=>{let a=e;e.startsWith("Qm")||e.startsWith("baf")?a=`https://ipfs.io/ipfs/${e}`:e.startsWith("/ipfs/")?a=`https://ipfs.io${e}`:e.startsWith("ipfs://")&&(a=e.replace("ipfs://","https://ipfs.io/ipfs/")),Le({url:a,name:t}),Re(!0)},[]);a.useEffect(()=>{const e=()=>{Oe()};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[Oe]);const Be=async(e,t=1)=>{1===t?(d("loading"),S(1),T([])):de(!0);try{let a=[];const s=50;switch(e){case"pixals":default:a=await ye.getCheapestPixals(s,t);break;case"waxrocks":a=await ye.getWaxRockPixals(s,t);break;case"ingredients":a=await ye.getPixelIngredients(s,t);break;case"bundles":a=await ye.getBundleListings(s,t);break;case"friedfactory":a=await ye.getFriedFactoryNFTs(s,t);break;case"cryptomuffins":a=await ye.getCryptoMuffinsNFTs(s,t);break;case"akufishheads":case"partners":a=await ye.getPartnerListings(s,t);break;case"pxapproved":a=await ye.getPxApprovedListings(s,t);break;case"ah_verified":a=await ye.getAHVerifiedListings(s,t);break;case"all_wax":a=await ye.getAllWaxListings(s,t)}1===t?T(a):(T(e=>[...e,...a]),S(t)),a.length<s?E(t):E(t+1),d("success"),de(!1)}catch(a){const e=a instanceof Error?a:new Error("Failed to load marketplace data");W.logError("Marketplace.loadMarketplaceData",e,{category:h,page:t,limit:50}),d("error"),de(!1)}},Ue=a.useCallback(async()=>{try{const e=(await ye.getCollectionSchemas("pixeljourney")).map(e=>e.schema_name);G(e)}catch(e){K("Failed to load available schemas","Marketplace",e),G([])}},[]);a.useEffect(()=>{Be(h),Ue()},[h,Ue]);const ze=a.useCallback(async e=>{const t={};for(let a=0;a<e.length;a+=10){const s=e.slice(a,a+10).map(async e=>{if(e.price){const t=await ie.convertWaxToUSDAsync(e.price);return{assetId:e.asset_id,price:t}}return null});(await Promise.all(s)).forEach(e=>{e&&(t[e.assetId]=e.price)})}x(t)},[]);a.useEffect(()=>{l.length>0&&ze(l)},[l,ze]);const Xe=a.useCallback(e=>{if(!e||e.length<2)return void X([]);const t=new Map,a=e.toLowerCase();P.forEach(e=>{if(e.name.toLowerCase().includes(a)){const a=`name:${e.name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.name,type:"name",count:1})}if(e.collection.toLowerCase().includes(a)){const a=`collection:${e.collection}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.collection,type:"collection",count:1})}});const s=Array.from(t.values()).sort((e,t)=>(t.count||0)-(e.count||0)).slice(0,8);X(s)},[P]),He=a.useCallback(e=>{L(e.priceRange),D(e.sortBy)},[]);a.useEffect(()=>{Xe(u)},[u,Xe]),a.useEffect(()=>{const e=()=>{const e=ce.getCart();N(new Set(e.map(e=>e.nft.asset_id)))};return e(),ce.addListener(e),()=>ce.removeListener(e)},[]),a.useEffect(()=>{(async()=>{const e=await Te.getWatchlist();le(new Set(e.map(e=>e.nft.asset_id)))})(),Te.addListener(e=>{le(new Set(e.map(e=>e.nft.asset_id)))})},[]);const Je=a.useCallback(()=>{_<C&&!oe&&Be(h,_+1)},[h,_,C,oe]),Ke=()=>{F(!1)},Ye=a.useCallback(e=>{const t=new Set(M);if(t.has(e))t.delete(e);else{t.add(e);const a=new Set(se);a.add("schemas"),ne(a)}R(t)},[M,se]),Qe=a.useCallback(e=>{const t=new Set(Y);if(t.has(e))t.delete(e);else{t.add(e);const a=new Set(se);a.add("collections"),ne(a)}Q(t)},[Y,se]),Ze=a.useCallback((e,t)=>{const a=new Map(Z),s=a.get(e)||new Set,n=new Set(s);if(n.has(t)?n.delete(t):n.add(t),n.size>0){a.set(e,n);const t=new Set(se);t.add("attributes"),ne(t)}else a.delete(e);ee(a)},[Z,se]),nt=a.useCallback(e=>{const t=new Set(se);t.has(e)?t.delete(e):t.add(e),ne(t)},[se]),rt=a.useMemo(()=>{let e=[...P];if(u){const t=u.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.collection.toLowerCase().includes(t)||e.schema&&e.schema.toLowerCase().includes(t))}return($.min||$.max)&&(e=e.filter(e=>{if(!e.price)return!1;const t=parseFloat(e.price),a=$.min?parseFloat($.min):0,s=$.max?parseFloat($.max):1/0;return t>=a&&t<=s})),M.size>0&&(e=e.filter(e=>e.schema&&M.has(e.schema))),Y.size>0&&(e=e.filter(e=>Y.has(e.collection))),Z.size>0&&(e=e.filter(e=>{if(!e.data||!e.data.attributes||!Array.isArray(e.data.attributes))return!1;for(const[t,a]of Z){const s=e.data.attributes.find(e=>e.key===t);if(!s||!a.has(s.value))return!1}return!0})),e.sort((e,t)=>{switch(O){case"price_asc":return parseFloat(e.price||"0")-parseFloat(t.price||"0");case"price_desc":return parseFloat(t.price||"0")-parseFloat(e.price||"0");case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"newest":return new Date(t.created_at_time||0).getTime()-new Date(e.created_at_time||0).getTime();case"oldest":return new Date(e.created_at_time||0).getTime()-new Date(t.created_at_time||0).getTime();default:return 0}}),e},[P,u,$,M,Y,Z,O]);a.useEffect(()=>{c(rt)},[rt]),a.useEffect(()=>{const e=new Map;let t=P;Y.size>0&&(t=t.filter(e=>Y.has(e.collection))),M.size>0&&(t=t.filter(e=>e.schema&&M.has(e.schema))),t.forEach(t=>{t.data&&t.data.attributes&&Array.isArray(t.data.attributes)&&t.data.attributes.forEach(t=>{e.has(t.key)||e.set(t.key,[]);const a=e.get(t.key);a.includes(t.value)||a.push(t.value)})}),e.forEach((e,t)=>{e.sort()}),ae(e),ee(t=>{const a=new Map;return t.forEach((t,s)=>{if(e.has(s)){const n=e.get(s),i=new Set;t.forEach(e=>{n.includes(e)&&i.add(e)}),i.size>0&&a.set(s,i)}}),a})},[P,Y,M]),a.useEffect(()=>{if(Y.size>0){const e=[...new Set(P.filter(e=>Y.has(e.collection)).map(e=>e.schema).filter(e=>e))].sort();G(e),R(t=>{const a=new Set;return t.forEach(t=>{e.includes(t)&&a.add(t)}),a})}else{const e=[...new Set(P.map(e=>e.schema).filter(e=>e))].sort();G(e)}},[P,Y]);const lt=a.useCallback(e=>{let t=[...e];return($.min||$.max)&&(t=t.filter(e=>{if(!e.price)return!1;const t=parseFloat(e.price.replace(" WAX","")),a=$.min?parseFloat($.min):0,s=$.max?parseFloat($.max):1/0;return t>=a&&t<=s})),M.size>0&&(t=t.filter(e=>M.has(e.schema))),Y.size>0&&(t=t.filter(e=>Y.has(e.collection))),B.start||B.end,t.sort((e,t)=>{const a=e.price?parseFloat(e.price.replace(" WAX","")):0,s=t.price?parseFloat(t.price.replace(" WAX","")):0;switch(O){case"price_asc":return a-s;case"price_desc":return s-a;case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"date_newest":return 0-0;case"date_oldest":return 0-0;default:return 0}}),t},[$,M,Y,O]);a.useEffect(()=>{const e=Array.from(new Set(P.map(e=>e.collection)));q(e)},[P]),a.useEffect(()=>{let e=P.filter(e=>e.name.toLowerCase().includes(u.toLowerCase())||("string"==typeof e.collection?e.collection.toLowerCase():"").includes(u.toLowerCase()));e=lt(e),c(e)},[P,u,$,M,Y,B,O,lt]);const ct=a.useCallback(async e=>{try{if(!Ie.isLoggedIn())return void r("Please connect your wallet to purchase NFTs");if(J("Purchasing NFT","Marketplace",{nft:e}),!e.sale_id||!e.price)return void n("Purchase Error","NFT is not available for purchase");await Ie.purchaseNFT(e.sale_id,e.price.replace(" WAX","")),s(`Successfully purchased ${e.name}!`),Be(h)}catch(t){K("Purchase failed","Marketplace",t instanceof Error?t:new Error(String(t))),n(`Purchase failed: ${t instanceof Error?t.message:"Unknown error"}`)}},[h,r,s,n,Be]),ot=a.useCallback(t=>{e(`/user-profile-lookup?user=${encodeURIComponent(t)}`)},[e]),dt=a.useCallback(t=>{e(`/collections/${encodeURIComponent(t)}`)},[e]),ut=a.useCallback(t=>{t.sale_id?e(`/listings/${t.sale_id}`):e(`/assets/${t.asset_id}`)},[e]),mt=a.useCallback(e=>{const t=new Set(w);t.has(e)?t.delete(e):t.add(e),k(t)},[w]),ht=a.useCallback(()=>{w.size===l.length?k(new Set):k(new Set(l.map(e=>e.asset_id)))},[w,l]),pt=a.useCallback(()=>{l.filter(e=>w.has(e.asset_id)).forEach(e=>{b.has(e.asset_id)||ce.addToCart(e)}),k(new Set)},[l,w,b]);return A.jsxs("div",{className:"marketplace",children:[A.jsxs("div",{className:"container",children:[A.jsx("div",{className:"marketplace-header",children:A.jsx("div",{className:"marketplace-header-content",children:A.jsxs("div",{className:"marketplace-header-text",children:[A.jsx("h1",{className:"marketplace-title",children:"Pixel Journey Marketplace"}),A.jsx("p",{className:"marketplace-subtitle",children:"Discover, collect, and trade unique digital assets from the Pixel Journey ecosystem. This marketplace serves all WAX users, with full market access unlocked for Pixal PFP holders."})]})})}),A.jsxs("div",{className:"marketplace-filters",children:[A.jsx(it,{searchTerm:u,onSearchChange:m,suggestions:z,placeholder:"Search items, collections...",showFilters:!0,onFilterChange:He,className:"marketplace-search"}),A.jsxs("div",{className:"marketplace-controls",children:[A.jsxs("div",{className:"category-tabs-container",children:[A.jsx("h3",{className:"category-section-title",children:"Listings"}),A.jsx("div",{className:"category-tabs-wrapper",children:A.jsxs("div",{className:"category-tabs",children:[A.jsx("button",{className:"category-tab "+("pixals"===h?"active":""),onClick:()=>p("pixals"),children:"Pixals"}),A.jsx("button",{className:"category-tab "+("waxrocks"===h?"active":""),onClick:()=>p("waxrocks"),children:"WaxRocks"}),A.jsx("button",{className:"category-tab "+("ingredients"===h?"active":""),onClick:()=>p("ingredients"),children:"Ingredients"}),A.jsx("button",{className:"category-tab "+("bundles"===h?"active":""),onClick:()=>p("bundles"),children:"📦 Bundles"}),A.jsxs("select",{className:"others-select",value:["friedfactory","cryptomuffins","akufishheads","partners","pxapproved","ah_verified","all_wax"].includes(h)?h:"others",onChange:e=>{const t=e.target.value;"others"!==t&&p(t)},children:[A.jsx("option",{value:"others",children:"Others"}),A.jsxs("optgroup",{label:"Marketplace",children:[A.jsx("option",{value:"pxapproved",children:"PxApproved"}),A.jsx("option",{value:"ah_verified",children:"All AH Verified (Pixals holders+ only)"}),A.jsx("option",{value:"all_wax",children:"All Wax Listings (Pixals holders+ only)"})]}),A.jsxs("optgroup",{label:"Partners",children:[A.jsx("option",{value:"friedfactory",children:"Fried Factory"}),A.jsx("option",{value:"cryptomuffins",children:"CryptoMuffins"}),A.jsx("option",{value:"akufishheads",children:"Aku Fish Heads"})]})]})]})})]}),A.jsxs("div",{className:"filter-sort-section",children:[A.jsx("h3",{className:"filter-sort-title",children:"Filter & Sort"}),A.jsxs("div",{className:"filter-sort-controls",children:[A.jsxs("select",{className:"sort-dropdown",value:O,onChange:e=>D(e.target.value),children:[A.jsx("option",{value:"price_asc",children:"Price: Low to High"}),A.jsx("option",{value:"price_desc",children:"Price: High to Low"}),A.jsx("option",{value:"name_asc",children:"Name: A to Z"}),A.jsx("option",{value:"name_desc",children:"Name: Z to A"}),A.jsx("option",{value:"date_newest",children:"Newest Listings"}),A.jsx("option",{value:"date_oldest",children:"Oldest Listings"})]}),A.jsx("button",{className:"filter-toggle-btn",onClick:()=>{F(!I)},title:"Advanced Filters",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]})]})]})]}),"loading"===o&&A.jsx("div",{className:"loading-grid",children:Array.from({length:8}).map((e,t)=>A.jsxs("div",{className:"nft-card loading",children:[A.jsx("div",{className:"nft-image-placeholder"}),A.jsxs("div",{className:"nft-info",children:[A.jsx("div",{className:"loading-text"}),A.jsx("div",{className:"loading-text short"})]})]},t))}),"error"===o&&A.jsx(st,{errorType:"LOAD_FAILED",onRetry:()=>Be(h),showRetry:!0}),w.size>0&&A.jsxs("div",{className:"bulk-actions-bar",children:[A.jsx("div",{className:"bulk-actions-info",children:A.jsxs("span",{children:[w.size," item",1!==w.size?"s":""," selected"]})}),A.jsxs("div",{className:"bulk-actions-buttons",children:[A.jsx("button",{className:"bulk-btn bulk-cart",onClick:pt,children:"Add Selected to Cart"}),A.jsxs("button",{className:"bulk-btn bulk-compare",onClick:()=>he(!0),disabled:w.size<2||w.size>4,title:w.size<2?"Select 2-4 items to compare":w.size>4?"Maximum 4 items can be compared":"Compare selected items",children:["Compare (",w.size,")"]}),A.jsx("button",{className:"bulk-btn bulk-clear",onClick:()=>k(new Set),children:"Clear Selection"})]})]}),"success"===o&&l.length>0&&A.jsxs("div",{className:"select-all-container",children:[A.jsx("button",{className:"select-all-btn",onClick:ht,children:w.size===l.length?"Deselect All":"Select All"}),_<C&&A.jsx("button",{className:"load-more-btn load-more-top",onClick:Je,disabled:oe,children:oe?"Loading...":"Load More"})]}),"success"===o&&A.jsx("div",{className:"nft-grid",children:l.map(e=>A.jsxs("div",{className:"nft-card "+(w.has(e.asset_id)?"selected":""),children:[A.jsx("div",{className:"nft-select-checkbox",children:A.jsx("input",{type:"checkbox",checked:w.has(e.asset_id),onChange:()=>mt(e.asset_id),className:"select-checkbox"})}),A.jsxs("div",{className:"nft-image-container",children:[A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),className:"nft-image",alt:e.name,autoPlay:!0,loop:!0,enableAnimations:t.enableAnimatedNFTs}),A.jsx("div",{className:"zoom-overlay",onClick:()=>De(Ve(e)||"",e.name||`Asset #${e.asset_id}`),title:"Click to zoom",children:A.jsxs("svg",{className:"zoom-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"11",cy:"11",r:"8"}),A.jsx("path",{d:"m21 21-4.35-4.35"}),A.jsx("path",{d:"M11 8v6M8 11h6"})]})}),(e.template_mint||void 0!==e.max_supply)&&A.jsxs("div",{className:"mint-badge",children:[void 0!==e.template_mint&&null!==e.template_mint?e.template_mint:"?","/","0"===e.max_supply||void 0===e.max_supply||null===e.max_supply?"∞":e.max_supply]})]}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h3",{className:"nft-name",children:A.jsx("span",{className:"asset-link",onClick:()=>ut(e),children:e.name})}),A.jsx("p",{className:"nft-collection",children:A.jsx("span",{className:"collection-link",onClick:()=>dt(e.collection),children:e.collection})}),A.jsxs("div",{className:"nft-price-container",children:[A.jsx("div",{className:"nft-price",children:e.price}),A.jsx("div",{className:"nft-price-usd",children:f[e.asset_id]||"$0.00"})]}),e.seller&&A.jsxs("p",{className:"nft-seller",children:["by ",A.jsx("span",{className:"seller-link",onClick:()=>ot(e.seller),children:e.seller})]}),A.jsxs("div",{className:"nft-actions",children:[A.jsxs("div",{className:"nft-actions-row nft-actions-main",children:[A.jsxs("button",{className:"btn-buy-now",onClick:()=>ct(e),title:"Buy now","aria-label":`Buy ${e.name} for ${e.price}`,type:"button",children:[A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:A.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Buy Now"]}),A.jsxs("button",{className:"details-btn",onClick:()=>{v(e),j(!0)},title:"View Details","aria-label":`View details for ${e.name}`,type:"button",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:[A.jsx("circle",{cx:"11",cy:"11",r:"8"}),A.jsx("path",{d:"m21 21-4.35-4.35"})]}),"Info"]})]}),A.jsxs("div",{className:"nft-actions-row nft-actions-icons",children:[A.jsx("button",{className:"btn-cart "+(b.has(e.asset_id)?"in-cart":""),onClick:()=>{if(b.has(e.asset_id))ce.removeFromCart(e.asset_id);else{ce.addToCart(e)||r("Item is already in your cart!")}},title:b.has(e.asset_id)?"Remove from cart":"Add to cart","aria-label":b.has(e.asset_id)?`Remove ${e.name} from cart`:`Add ${e.name} to cart`,type:"button",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","aria-hidden":"true",children:b.has(e.asset_id)?A.jsxs(A.Fragment,{children:[A.jsx("polyline",{points:"3,6 5,6 21,6"}),A.jsx("path",{d:"m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"})]}):A.jsxs(A.Fragment,{children:[A.jsx("circle",{cx:"9",cy:"21",r:"1"}),A.jsx("circle",{cx:"20",cy:"21",r:"1"}),A.jsx("path",{d:"m1 1 4 4 2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]})})}),A.jsx("button",{className:"btn-make-offer",onClick:t=>{t.stopPropagation(),je(e),Ne(!0)},title:"Make Offer",type:"button",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M11 17a4 4 0 0 1 8 0c0 .7-.2 1.4-.5 2H18a3 3 0 0 0 0-6c-.2-1.8-1.9-3.2-4-3.2-.6 0-1.1.1-1.6.4"}),A.jsx("path",{d:"M6.2 15.8A4 4 0 1 0 2 12c0-.7.2-1.4.5-2H3a3 3 0 0 1 0 6c.2 1.8 1.9 3.2 4 3.2.6 0 1.1-.1 1.6-.4"}),A.jsx("path",{d:"M8 12h8"}),A.jsx("circle",{cx:"12",cy:"8",r:"2"})]})}),A.jsx("button",{className:"btn-message",onClick:()=>(ke(e),void Ce(!0)),title:"Send Direct Message (1000 PXJ)",disabled:!e.seller,children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})})}),A.jsxs("div",{className:"other-actions-dropdown",children:[A.jsx("button",{className:"btn-other-actions",onClick:t=>{t.stopPropagation(),We(e.asset_id)},title:"More Actions",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"1"}),A.jsx("circle",{cx:"19",cy:"12",r:"1"}),A.jsx("circle",{cx:"5",cy:"12",r:"1"})]})}),A.jsxs("div",{className:"other-actions-menu "+(Ae.has(e.asset_id)?"open":""),children:[A.jsxs("button",{className:"other-actions-item",onClick:t=>{t.stopPropagation(),ut(e),Oe()},children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),A.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),"View Full Listing"]}),A.jsxs("button",{className:"other-actions-item",onClick:t=>{t.stopPropagation(),fe(e),ge(!0),Oe()},children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),A.jsx("polyline",{points:"16,6 12,2 8,6"}),A.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]}),"Share NFT"]}),A.jsxs("button",{className:"other-actions-item "+(re.has(e.asset_id)?"in-watchlist":""),onClick:async t=>{if(t.stopPropagation(),re.has(e.asset_id))await Te.removeFromWatchlist(e.asset_id);else{await Te.addToWatchlist(e)||r("Item is already in your watchlist!")}Oe()},children:[A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:re.has(e.asset_id)?A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z",fill:"currentColor"}):A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})}),re.has(e.asset_id)?"Remove from Watchlist":"Add to Watchlist"]})]})]})]})]})]})]},e.asset_id))}),"success"===o&&0===l.length&&A.jsxs("div",{className:"marketplace-empty",children:[A.jsx("svg",{className:"empty-icon",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),A.jsx("h3",{children:"No items found"}),A.jsx("p",{children:"Try adjusting your search or filter criteria"})]}),"success"===o&&_<C&&A.jsxs("div",{className:"load-more-container",children:[A.jsx("button",{className:"load-more-btn",onClick:()=>Be(h,_+1),disabled:oe,children:oe?"Loading...":"Load More"}),A.jsxs("div",{className:"pagination-info",children:["Showing ",l.length," items • Loaded ",_," of ",C>_?C+"+":C," pages"]})]}),"success"===o&&_>=C&&l.length>0&&A.jsx("div",{className:"load-more-container",children:A.jsxs("div",{className:"pagination-info",children:["Showing all ",l.length," items"]})})]}),I&&A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"filter-sidebar-overlay",onClick:Ke}),A.jsxs("div",{className:"filter-sidebar",children:[A.jsxs("div",{className:"filter-sidebar-header",children:[A.jsx("h3",{children:"Advanced Filters"}),A.jsx("button",{className:"close-sidebar-btn",onClick:Ke,children:A.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A.jsxs("div",{className:"filter-section",children:[A.jsxs("div",{className:"filter-section-header",onClick:()=>nt("collections"),children:[A.jsx("h4",{children:"Collections"}),A.jsx("button",{className:"collapse-toggle",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:se.has("collections")?"collapsed":"",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!se.has("collections")&&A.jsx("div",{className:"collection-checkboxes",children:H.slice(0,8).map(e=>A.jsxs("div",{className:"collection-item",children:[A.jsxs("label",{className:"collection-checkbox",children:[A.jsx("input",{type:"checkbox",checked:Y.has(e),onChange:()=>Qe(e)}),A.jsx("span",{className:"checkmark"}),e]}),A.jsx("a",{href:`/analytics/${encodeURIComponent(e)}`,className:"analytics-link",title:`View ${e} analytics`,onClick:e=>e.stopPropagation(),children:"📊"})]},e))})]}),A.jsxs("div",{className:"filter-section",children:[A.jsxs("div",{className:"filter-section-header",onClick:()=>nt("schemas"),children:[A.jsx("h4",{children:"Schema Type"}),A.jsx("button",{className:"collapse-toggle",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:se.has("schemas")?"collapsed":"",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!se.has("schemas")&&A.jsx("div",{className:"schema-checkboxes",children:V.length>0?V.map(e=>A.jsxs("label",{className:"schema-checkbox",children:[A.jsx("input",{type:"checkbox",checked:M.has(e),onChange:()=>Ye(e)}),A.jsx("span",{className:"checkmark"}),e.charAt(0).toUpperCase()+e.slice(1)]},e)):A.jsx("div",{className:"loading-schemas",children:"Loading schemas..."})})]}),A.jsxs("div",{className:"filter-section",children:[A.jsxs("div",{className:"filter-section-header",onClick:()=>nt("price"),children:[A.jsx("h4",{children:"Price Range (WAX)"}),A.jsx("button",{className:"collapse-toggle",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:se.has("price")?"collapsed":"",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!se.has("price")&&A.jsxs("div",{className:"price-range-inputs",children:[A.jsx("input",{type:"number",placeholder:"Min",value:$.min,onChange:e=>L(t=>({...t,min:e.target.value})),className:"price-input"}),A.jsx("span",{children:"to"}),A.jsx("input",{type:"number",placeholder:"Max",value:$.max,onChange:e=>L(t=>({...t,max:e.target.value})),className:"price-input"})]})]}),A.jsxs("div",{className:"filter-section",children:[A.jsxs("div",{className:"filter-section-header",onClick:()=>nt("attributes"),children:[A.jsx("h4",{children:"Attribute Filters"}),A.jsx("button",{className:"collapse-toggle",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:se.has("attributes")?"collapsed":"",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),!se.has("attributes")&&A.jsxs("div",{className:"attribute-filters",children:[Array.from(te.entries()).map(([e,t])=>A.jsxs("div",{className:"attribute-group",children:[A.jsx("h5",{className:"attribute-type",children:e}),A.jsx("div",{className:"attribute-values",children:t.map(t=>A.jsxs("label",{className:"attribute-checkbox",children:[A.jsx("input",{type:"checkbox",checked:Z.get(e)?.has(t)||!1,onChange:()=>Ze(e,t)}),A.jsx("span",{className:"checkmark"}),t]},t))})]},e)),0===te.size&&A.jsx("div",{className:"no-attributes",children:"No attributes available"})]})]}),A.jsxs("div",{className:"filter-section",children:[A.jsx("h4",{children:"Date Range"}),A.jsxs("div",{className:"date-range-inputs",children:[A.jsx("input",{type:"date",value:B.start,onChange:e=>U(t=>({...t,start:e.target.value})),className:"date-input",placeholder:"Start Date"}),A.jsx("span",{children:"to"}),A.jsx("input",{type:"date",value:B.end,onChange:e=>U(t=>({...t,end:e.target.value})),className:"date-input",placeholder:"End Date"})]})]}),A.jsxs("div",{className:"filter-section",children:[A.jsx("h4",{children:"Sort By"}),A.jsxs("select",{value:O,onChange:e=>D(e.target.value),className:"sort-select",children:[A.jsx("option",{value:"price_asc",children:"Price: Low to High"}),A.jsx("option",{value:"price_desc",children:"Price: High to Low"}),A.jsx("option",{value:"name_asc",children:"Name: A to Z"}),A.jsx("option",{value:"name_desc",children:"Name: Z to A"}),A.jsx("option",{value:"date_newest",children:"Newest Listings"}),A.jsx("option",{value:"date_oldest",children:"Oldest Listings"})]})]}),A.jsxs("div",{className:"filter-actions",children:[A.jsx("button",{className:"clear-filters-btn",onClick:()=>{L({min:"",max:""}),R(new Set),Q(new Set),ee(new Map),U({start:"",end:""}),D("price_asc")},children:"Clear All"}),A.jsx("button",{className:"apply-filters-btn",onClick:Ke,children:"Apply Filters"})]})]})]}),A.jsx(et,{nft:g,isOpen:y,onClose:()=>{j(!1),v(null)}}),A.jsx(tt,{initialNFTs:l.filter(e=>w.has(e.asset_id)),isOpen:me,onClose:()=>he(!1)}),pe&&A.jsx(at,{nft:pe,isOpen:xe,onClose:()=>{ge(!1),fe(null)}}),ve&&A.jsx($e,{nft:ve,isOpen:be,onClose:()=>{Ne(!1),je(null)}}),we&&A.jsx(qe,{nft:we,isOpen:Se,onClose:()=>{Ce(!1),ke(null)}}),Me&&Pe&&A.jsx("div",{className:"image-zoom-modal",onClick:()=>Re(!1),children:A.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsx("button",{className:"zoom-modal-close",onClick:()=>Re(!1),"aria-label":"Close zoom modal",children:"×"}),A.jsx("img",{src:Pe.url,alt:Pe.name,className:"zoom-modal-image"}),A.jsx("div",{className:"zoom-modal-title",children:Pe.name})]})})]})},lt=({onPageChange:e})=>A.jsxs("div",{className:"rewards-container",children:[A.jsxs("div",{className:"rewards-header",children:[A.jsx("h1",{className:"rewards-title",children:"Trading Rewards"}),A.jsx("p",{className:"rewards-subtitle",children:"Earn PXJ tokens and Pixel Ingredients for every trade you make on Pixel Market"})]}),A.jsxs("div",{className:"rewards-content",children:[A.jsxs("div",{className:"reward-card",children:[A.jsx("div",{className:"reward-icon pxj-icon",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("path",{d:"M12 6v6l4 2"})]})}),A.jsx("h3",{className:"reward-title",children:"PXJ Token Rewards"}),A.jsx("p",{className:"reward-description",children:"Earn PXJ tokens based on your trading volume. The more you trade, the more you earn!"}),A.jsxs("ul",{className:"reward-benefits",children:[A.jsx("li",{children:"0.1% of trade value in PXJ tokens"}),A.jsx("li",{children:"Bonus multipliers for high-volume traders"}),A.jsx("li",{children:"Weekly bonus distributions"}),A.jsx("li",{children:"Governance voting rights"})]})]}),A.jsxs("div",{className:"reward-card",children:[A.jsx("div",{className:"reward-icon ingredient-icon",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})}),A.jsx("h3",{className:"reward-title",children:"Pixel Ingredients"}),A.jsxs("p",{className:"reward-description",children:["Collect rare Pixel Ingredients that can be used for crafting and enhancing your NFTs. ",A.jsx("strong",{children:"Available to Pixal PFP holders and Fried Factory trait holders only."})]}),A.jsxs("ul",{className:"reward-benefits",children:[A.jsx("li",{children:"Random ingredient drops with each trade"}),A.jsx("li",{children:"Rare ingredients for large transactions"}),A.jsx("li",{children:"Craft unique items and upgrades"}),A.jsx("li",{children:"Trade ingredients with other players"})]})]}),A.jsxs("div",{className:"reward-card full-width",children:[A.jsx("div",{className:"reward-icon volume-icon",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M3 3v18h18"}),A.jsx("path",{d:"M7 12l4-4 4 4 6-6"})]})}),A.jsx("h3",{className:"reward-title",children:"Volume-Based Bonuses"}),A.jsx("p",{className:"reward-description",children:"Unlock additional rewards and benefits as your trading volume increases."}),A.jsxs("div",{className:"volume-tiers",children:[A.jsxs("div",{className:"tier",children:[A.jsx("h4",{children:"Bronze Trader"}),A.jsx("p",{children:"1+ WAX volume"}),A.jsx("span",{className:"tier-bonus",children:"1x rewards"})]}),A.jsxs("div",{className:"tier",children:[A.jsx("h4",{children:"Silver Trader"}),A.jsx("p",{children:"100+ WAX volume"}),A.jsx("span",{className:"tier-bonus",children:"1.5x rewards"})]}),A.jsxs("div",{className:"tier",children:[A.jsx("h4",{children:"Gold Trader"}),A.jsx("p",{children:"1,000+ WAX volume"}),A.jsx("span",{className:"tier-bonus",children:"2x rewards"})]}),A.jsxs("div",{className:"tier",children:[A.jsx("h4",{children:"Diamond Trader"}),A.jsx("p",{children:"10,000+ WAX volume"}),A.jsx("span",{className:"tier-bonus",children:"3x rewards"})]})]})]})]}),A.jsxs("div",{className:"rewards-cta",children:[A.jsx("h3",{children:"Start Trading Today!"}),A.jsx("p",{children:"Connect your wallet and start earning rewards with every transaction."}),A.jsxs("button",{className:"cta-button",onClick:()=>e?.("marketplace"),children:[A.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})}),"Go to Marketplace"]})]})]}),ct=({nft:e,isOpen:t,onClose:s,onSuccess:n,bundleNfts:i=[]})=>{const[r,l]=a.useState(""),[c,o]=a.useState(!1),[d,u]=a.useState(""),[m,h]=a.useState(!1),{session:p}=R(),{showSuccess:f,showError:x}=_e(),g={symbol:"WAX",contract:"eosio.token",precision:8},v=()=>{m||(l(""),o(!1),u(""),s())};return t&&e?A.jsx("div",{className:"modal-overlay",onClick:v,children:A.jsxs("div",{className:"modal-content listing-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"List NFT for Sale"}),A.jsx("button",{className:"modal-close",onClick:v,disabled:m,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"nft-preview enhanced-preview",children:[A.jsx("div",{className:"nft-image",children:A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name||`Asset #${e.asset_id}`,className:"nft-media"})}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h3",{children:e.name}),A.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),A.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&A.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]}),c&&i.length>0&&A.jsxs("p",{className:"bundle-info",children:["+ ",i.length," additional NFT",i.length>1?"s":""]})]})]}),i.length>0&&A.jsxs("div",{className:"bundle-section",children:[A.jsx("div",{className:"bundle-toggle",children:A.jsxs("label",{className:"checkbox-label",children:[A.jsx("input",{type:"checkbox",checked:c,onChange:e=>o(e.target.checked),disabled:m}),A.jsx("span",{className:"checkmark"}),"Create Bundle with ",i.length," additional NFT",i.length>1?"s":""]})}),c&&A.jsxs("div",{className:"bundle-details",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"bundleName",children:"Bundle Name *"}),A.jsx("input",{type:"text",id:"bundleName",value:d,onChange:e=>u(e.target.value),placeholder:"Enter bundle name",disabled:m,className:"bundle-name-input"})]}),A.jsxs("div",{className:"bundle-preview",children:[A.jsx("h4",{children:"Bundle Contents:"}),A.jsxs("div",{className:"bundle-nfts",children:[A.jsxs("div",{className:"bundle-nft-item main-nft",children:[A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name||`Asset #${e.asset_id}`,className:"bundle-nft-image"}),A.jsx("span",{children:e.name})]}),i.slice(0,3).map(e=>A.jsxs("div",{className:"bundle-nft-item",children:[A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name||`Asset #${e.asset_id}`,className:"bundle-nft-image"}),A.jsx("span",{children:e.name})]},e.asset_id)),i.length>3&&A.jsxs("div",{className:"bundle-more",children:["+",i.length-3," more"]})]})]})]})]}),A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!e||!p||!r)return void x("Please fill in all required fields");if(c&&!d.trim())return void x("Please enter a bundle name");const a=parseFloat(r);if(isNaN(a)||a<=0)x("Please enter a valid price");else{h(!0);try{const t=g,r=`${a.toFixed(t.precision)} ${t.symbol}`,o=c&&i.length>0?[e.asset_id,...i.map(e=>e.asset_id)]:[e.asset_id],d={account:"atomicmarket",name:"announcesale",authorization:[{actor:p.actor,permission:p.permission}],data:{seller:p.actor,asset_ids:o,listing_price:r,settlement_symbol:`${t.precision},${t.symbol}`,maker_marketplace:"market.pxj"}};if(await p.transact({actions:[d]})){f(`${c?"Bundle":"NFT"} listed successfully!`),n?.(),s(),l("")}}catch(o){K("Listing failed","ListingModal",o instanceof Error?o:new Error(String(o))),x(`Listing failed: ${o instanceof Error?o.message:"Unknown error"}`)}finally{h(!1)}}},className:"modal-form listing-form",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"price",children:"Price *"}),A.jsxs("div",{className:"price-input-group",children:[A.jsx("input",{type:"number",id:"price",value:r,onChange:e=>l(e.target.value),placeholder:"0.00",step:"0.0001",min:"0",required:!0,disabled:m,className:"price-input"}),A.jsxs("div",{className:"currency-display",children:[A.jsx("span",{className:"currency-symbol",children:g.symbol}),A.jsx("span",{className:"currency-note",children:"(AtomicMarket only supports WAX)"})]})]})]}),A.jsxs("div",{className:"listing-info",children:[A.jsxs("p",{className:"info-text",children:[A.jsx("strong",{children:"Marketplace:"})," AtomicMarket"]}),A.jsxs("p",{className:"info-text",children:[A.jsx("strong",{children:"Marketplace Fee:"})," 2%"]}),A.jsxs("p",{className:"info-text",children:[A.jsx("strong",{children:"Collection Fee:"})," Varies by collection"]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:v,disabled:m,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary",disabled:m||!r,children:m?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"spinner"}),"Listing..."]}):"List for Sale"})]})]})]})]})}):null},ot=({nft:e,isOpen:t,onClose:s,onSuccess:n})=>{const[i,r]=a.useState(""),[l,c]=a.useState(""),[o,d]=a.useState(!1),{session:u}=R(),{showSuccess:m,showError:h}=_e(),p=e=>/^[a-z1-5]{12}$/.test(e),f=()=>{o||(r(""),c(""),s())};return t&&e?A.jsx("div",{className:"modal-overlay",onClick:f,children:A.jsxs("div",{className:"modal-content transfer-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Transfer NFT"}),A.jsx("button",{className:"modal-close",onClick:f,disabled:o,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"nft-preview",children:[A.jsx("div",{className:"nft-image",children:e.video?A.jsx("video",{src:e.video.startsWith("http")?e.video:`https://ipfs.io/ipfs/${e.video}`,muted:!0,loop:!0,autoPlay:!0}):e.img?A.jsx("img",{src:e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name}):A.jsx("div",{className:"no-image",children:"No Image"})}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h3",{children:e.name}),A.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),A.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&A.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]})]})]}),A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e&&u&&i.trim())if(p(i.trim())){d(!0);try{const t={account:"atomicassets",name:"transfer",authorization:[{actor:u.actor,permission:u.permission}],data:{from:u.actor,to:i.trim(),asset_ids:[e.asset_id],memo:l.trim()||"Transferred via PxMarket - market.pixeljourney.xyz"}};await u.transact({actions:[t]})&&(m("Transfer Successful","NFT transferred successfully!"),n?.(),s(),r(""),c(""))}catch(a){K("Transfer failed","TransferModal",a),h("Transfer Failed",a instanceof Error?a.message:"Unknown error occurred")}finally{d(!1)}}else h("Invalid Account Name","Please enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)");else h("Validation Error","Please fill in all required fields")},className:"modal-form transfer-form",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"recipient",children:"Recipient WAX Account *"}),A.jsx("input",{type:"text",id:"recipient",value:i,onChange:e=>r(e.target.value.toLowerCase()),placeholder:"e.g. pixeljourney",maxLength:12,required:!0,disabled:o,className:"recipient-input"}),A.jsx("small",{className:"input-help",children:"Enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)"})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),A.jsx("input",{type:"text",id:"memo",value:l,onChange:e=>c(e.target.value),placeholder:"Optional transfer message",maxLength:256,disabled:o,className:"memo-input"})]}),A.jsxs("div",{className:"transfer-warning",children:[A.jsx("div",{className:"warning-icon",children:"⚠️"}),A.jsxs("div",{className:"warning-text",children:[A.jsx("strong",{children:"Warning:"})," This action cannot be undone. Make sure you trust the recipient and have entered the correct account name."]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:f,disabled:o,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary transfer-btn",disabled:o||!i.trim()||!p(i.trim()),children:o?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"spinner"}),"Transferring..."]}):"Transfer NFT"})]})]})]})]})}):null},dt=({nft:e,isOpen:t,onClose:s,onSuccess:n})=>{const[i,r]=a.useState(""),[l,c]=a.useState(!1),[o,d]=a.useState("warning"),{session:u}=R(),m="BURN",h=()=>{r(""),d("warning")},p=()=>{l||(h(),s())};return t&&e?A.jsx("div",{className:"modal-overlay",onClick:p,children:A.jsxs("div",{className:"modal-content burn-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"🔥 Burn NFT"}),A.jsx("button",{className:"modal-close",onClick:p,disabled:l,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"nft-preview",children:[A.jsx("div",{className:"nft-image",children:e.video?A.jsx("video",{src:e.video.startsWith("http")?e.video:`https://ipfs.io/ipfs/${e.video}`,muted:!0,loop:!0,autoPlay:!0}):e.img?A.jsx("img",{src:e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name}):A.jsx("div",{className:"no-image",children:"No Image"})}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h3",{children:e.name}),A.jsx("p",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),A.jsx("p",{className:"nft-schema",children:e.schema.schema_name}),e.mint_number&&A.jsxs("p",{className:"nft-mint",children:["Mint #",e.mint_number]})]})]}),"warning"===o&&A.jsxs("div",{className:"burn-warning-step",children:[A.jsxs("div",{className:"danger-warning",children:[A.jsx("div",{className:"warning-icon",children:"🚨"}),A.jsxs("div",{className:"warning-content",children:[A.jsx("h3",{children:"PERMANENT ACTION WARNING"}),A.jsxs("ul",{className:"warning-list",children:[A.jsxs("li",{children:["This action will ",A.jsx("strong",{children:"permanently destroy"})," your NFT"]}),A.jsxs("li",{children:["The NFT will be ",A.jsx("strong",{children:"completely removed"})," from the blockchain"]}),A.jsxs("li",{children:["This action ",A.jsx("strong",{children:"cannot be undone or reversed"})]}),A.jsxs("li",{children:["You will ",A.jsx("strong",{children:"not receive any compensation"})]}),A.jsxs("li",{children:["The NFT will ",A.jsx("strong",{children:"disappear forever"})]})]})]})]}),A.jsxs("div",{className:"burn-reasons",children:[A.jsx("h4",{children:"Common reasons for burning NFTs:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Reducing supply to increase rarity"}),A.jsx("li",{children:"Participating in burn-to-earn mechanics"}),A.jsx("li",{children:"Collection cleanup or rebranding"}),A.jsx("li",{children:"Accidental duplicate mints"})]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:p,children:"Cancel"}),A.jsx("button",{type:"button",className:"btn-danger",onClick:()=>{d("confirm")},children:"I Understand, Proceed"})]})]}),"confirm"===o&&A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),e&&u){if(ae.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&ae.isValidWaxRock(t))return void alert(`This is a rare WaxRock Pixal PFP (${t}) and cannot be burned. WaxRock Pixals are protected from burning and recycling on our platform.`)}if(i.toUpperCase()===m){c(!0);try{const t={account:"atomicassets",name:"burnasset",authorization:[{actor:u.actor,permission:u.permission}],data:{asset_owner:u.actor,asset_id:e.asset_id}};await u.transact({actions:[t]})&&(alert("NFT burned successfully!"),n?.(),s(),h())}catch(a){K("Burn failed","BurnModal",a),alert(`Burn failed: ${a instanceof Error?a.message:"Unknown error"}`)}finally{c(!1)}}else alert(`Please type "${m}" to confirm`)}else alert("Session error. Please try again.")},className:"modal-form burn-confirm-step",children:[A.jsxs("div",{className:"final-warning",children:[A.jsx("div",{className:"warning-icon",children:"⚠️"}),A.jsxs("p",{children:[A.jsx("strong",{children:"FINAL WARNING:"})," You are about to permanently destroy this NFT. This action cannot be undone."]})]}),A.jsxs("div",{className:"form-group",children:[A.jsxs("label",{htmlFor:"confirmText",children:["Type ",A.jsxs("strong",{children:['"',m,'"']})," to confirm:"]}),A.jsx("input",{type:"text",id:"confirmText",value:i,onChange:e=>r(e.target.value),placeholder:`Type "${m}" here`,required:!0,disabled:l,className:"confirm-input",autoComplete:"off"})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>d("warning"),disabled:l,children:"Back"}),A.jsx("button",{type:"submit",className:"btn-danger burn-btn",disabled:l||i.toUpperCase()!==m,children:l?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"spinner"}),"Burning..."]}):"🔥 Burn NFT Forever"})]})]})]})]})}):null},ut=({nfts:e,isOpen:t,onClose:s,onSuccess:n})=>{const[i,r]=a.useState({}),[l,c]=a.useState(""),[o,d]=a.useState(!1),[u,m]=a.useState(0),[h,p]=a.useState({}),[f,x]=a.useState(!1),[g,v]=a.useState(!0),[y,j]=a.useState("name_asc"),{session:b}=R(),{showSuccess:N,showError:w}=_e(),k="WAX",_=8,S=(e,t)=>{r(a=>({...a,[e]:t}))},C=a.useCallback(async()=>{if(!e.length||!t)return;x(!0);const a={},s=async(e,t=3)=>{try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),s=await fetch(e,{signal:t.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(a),!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);return await s.json()}catch(a){if(t>0&&a instanceof Error&&!a.name.includes("AbortError"))return console.warn(`Retrying API call (${3-t+1}/3):`,a.message),await new Promise(e=>setTimeout(e,1e3*(3-t+1))),s(e,t-1);throw a}};try{const t=e.reduce((e,t)=>{const a=t.collection.collection_name;return e[a]||(e[a]=[]),e[a].push(t),e},{}),l=Object.entries(t);let c=0;for(const[e,o]of l){try{const t=`${ye.atomicMarketAPI}/atomicmarket/v1/sales?state=3&collection_name=${e}&limit=100&order=desc&sort=updated`;let r=null;try{r=await s(t)}catch(n){console.warn(`Primary API failed for ${e}, trying fallback:`,n);try{const t=`${ye.atomicMarketAPI}/atomicmarket/v1/sales?collection_name=${e}&state=3&limit=50&order=desc`;r=await s(t,1)}catch(i){console.warn(`Fallback API also failed for ${e}:`,i),E(o,a);continue}}if((e=>"object"==typeof e&&null!==e&&"success"in e&&"data"in e&&Array.isArray(e.data))(r)&&r.success&&r.data.length>0){const e=r.data.filter(e=>e.price?.amount).map(e=>{const t=parseFloat(e.price.amount),a=e.price.token_precision||8;return t/Math.pow(10,a)}).filter(e=>e>0&&e<1e4);if(e.length>0){const t=e.sort((e,t)=>e-t),s=Math.floor(.25*t.length),n=Math.floor(.75*t.length),i=t[n]-t[s],r=t[s]-1.5*i,l=t[n]+1.5*i,d=t.filter(e=>e>=r&&e<=l);if(d.length>0){const e=Math.min(...d),t=d.reduce((e,t)=>e+t,0)/d.length,s=d[Math.floor(d.length/2)];let n,i;n=d.length>=10?Math.max(1.03*e,.98*s):Math.max(1.05*e,.95*t),i=d.length>=20?"high":d.length>=10?"medium":"low",o.forEach(s=>{a[s.asset_id]={floorPrice:e,averagePrice:t,suggestedPrice:n,confidence:i,sampleSize:d.length}}),c++}else E(o,a)}else E(o,a)}else E(o,a)}catch(r){console.warn(`Failed to process collection ${e}:`,r),E(o,a)}l.indexOf([e,o])<l.length-1&&await new Promise(e=>setTimeout(e,500))}0===c?w("Price Analysis","Unable to fetch current market data. Using default pricing suggestions."):c<l.length&&console.warn(`Price data available for ${c}/${l.length} collections`),p(a)}catch(r){console.error("Error fetching price suggestions:",r),w("Price Analysis Failed","Unable to analyze market prices. Please set prices manually."),e.forEach(e=>{a[e.asset_id]={floorPrice:1,averagePrice:2,suggestedPrice:1.5,confidence:"low",sampleSize:0}}),p(a)}finally{x(!1)}},[e,t,w]),E=(e,t)=>{e.forEach(e=>{t[e.asset_id]={floorPrice:1,averagePrice:2,suggestedPrice:1.5,confidence:"low",sampleSize:0}})};a.useEffect(()=>{t&&e.length>0&&C()},[t,e,C]);const P=a.useMemo(()=>{const t=[...e];switch(y){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));case"price_asc":return t.sort((e,t)=>parseFloat(i[e.asset_id]||"0")-parseFloat(i[t.asset_id]||"0"));case"price_desc":return t.sort((e,t)=>{const a=parseFloat(i[e.asset_id]||"0");return parseFloat(i[t.asset_id]||"0")-a});default:return t}},[e,y,i]);a.useEffect(()=>{g&&e.length>0&&C()},[g,e,C]);const T=()=>e.reduce((e,t)=>{const a=parseFloat(i[t.asset_id]||"0");return e+(isNaN(a)?0:a)},0);return t?A.jsx("div",{className:"modal-overlay",onClick:s,children:A.jsxs("div",{className:"modal-content bulk-listing-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Bulk List NFTs"}),A.jsx("button",{className:"modal-close",onClick:s,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"listing-summary",children:[A.jsx("h3",{children:"Listing Summary"}),A.jsxs("p",{children:["You are about to list ",A.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})]}),A.jsxs("p",{className:"total-value",children:["Total Value: ",A.jsx("strong",{children:D(T())})]})]}),A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!b||0===e.length)return void w("Validation Error","Please connect your wallet and select NFTs to list");const a=e.filter(e=>{const t=i[e.asset_id];return!t||isNaN(parseFloat(t))||parseFloat(t)<=0});if(a.length>0)w("Invalid Prices",`Please set valid prices for all NFTs. ${a.length} NFT(s) have invalid prices.`);else{d(!0),m(0);try{const t=e.map(e=>{const t=`${parseFloat(i[e.asset_id]).toFixed(_)} ${k}`;return{account:"atomicmarket",name:"announcesale",authorization:[{actor:b.actor,permission:b.permission}],data:{seller:b.actor,asset_ids:[e.asset_id],listing_price:t,settlement_symbol:`${_},${k}`,maker_marketplace:"market.pxj"}}}),a=5,l=[];for(let e=0;e<t.length;e+=a)l.push(t.slice(e,e+a));let o=0;for(const e of l){await b.transact({actions:e})&&(o++,m(o/l.length*100))}N("Listing Successful",`Successfully listed ${e.length} NFT(s) on the marketplace!`),n?.(),s(),r({}),c("")}catch(l){console.error("Bulk listing failed:",l),w("Listing Failed",l instanceof Error?l.message:"Unknown error occurred")}finally{d(!1),m(0)}}},className:"listing-form",children:[A.jsxs("div",{className:"smart-pricing-section",children:[A.jsxs("div",{className:"pricing-header",children:[A.jsx("h4",{children:"Smart Pricing Tools"}),A.jsx("button",{type:"button",className:"toggle-suggestions",onClick:()=>v(!g),children:g?"📊 Hide Analysis":"📊 Show Analysis"})]}),g&&A.jsx("div",{className:"price-analysis",children:f?A.jsxs("div",{className:"loading-suggestions",children:[A.jsx("div",{className:"spinner"}),A.jsx("span",{children:"Analyzing market data..."})]}):A.jsxs("div",{className:"suggestion-controls",children:[A.jsx("button",{type:"button",className:"btn-suggestion suggested",onClick:()=>{const t={};e.forEach(e=>{const a=h[e.asset_id];a&&(t[e.asset_id]=B(a.suggestedPrice,4))}),r(t)},disabled:o||0===Object.keys(h).length,title:"Apply AI-recommended prices based on market analysis",children:"🎯 Apply Suggested Prices"}),A.jsx("button",{type:"button",className:"btn-suggestion floor",onClick:()=>{const t={};e.forEach(e=>{const a=h[e.asset_id];a&&(t[e.asset_id]=B(.99*a.floorPrice,4))}),r(t)},disabled:o||0===Object.keys(h).length,title:"Price 1% below current floor prices for quick sales",children:"⚡ Quick Sale (Floor -1%)"})]})}),A.jsxs("div",{className:"bulk-price-controls",children:[A.jsx("h5",{children:"Manual Bulk Pricing"}),A.jsxs("div",{className:"bulk-input-group",children:[A.jsx("input",{type:"number",value:l,onChange:e=>c(e.target.value),placeholder:"Set same price for all",step:"0.0001",min:"0",disabled:o}),A.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{if(!l)return;const t={};e.forEach(e=>{t[e.asset_id]=l}),r(t)},disabled:!l||o,children:"Apply to All"})]})]})]}),A.jsxs("div",{className:"nft-pricing-list",children:[A.jsxs("div",{className:"pricing-header",children:[A.jsx("h4",{children:"Individual Pricing"}),e.length>1&&A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"nft-sort",children:"Sort by:"}),A.jsxs("select",{id:"nft-sort",className:"sort-select",value:y,onChange:e=>j(e.target.value),children:[A.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),A.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),A.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),A.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),A.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),A.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"}),A.jsx("option",{value:"price_asc",children:"Price (Low-High)"}),A.jsx("option",{value:"price_desc",children:"Price (High-Low)"})]})]})]}),A.jsx("div",{className:"pricing-list-container",children:P.map(e=>{const t=h[e.asset_id];return A.jsxs("div",{className:"nft-pricing-item",children:[A.jsxs("div",{className:"nft-info-bulk",children:[A.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),A.jsxs("div",{className:"nft-details",children:[A.jsx("span",{className:"nft-name",children:e.name}),A.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),e.mint_number&&A.jsxs("span",{className:"nft-mint",children:["#",e.mint_number]}),t&&A.jsxs("div",{className:"price-suggestions",children:[A.jsxs("div",{className:"suggestion-row",children:[A.jsx("span",{className:"suggestion-label",children:"Floor:"}),A.jsx("span",{className:"suggestion-value",children:D(t.floorPrice)})]}),A.jsxs("div",{className:"suggestion-row",children:[A.jsx("span",{className:"suggestion-label",children:"Avg:"}),A.jsx("span",{className:"suggestion-value",children:D(t.averagePrice)})]}),A.jsxs("div",{className:"suggestion-row",children:[A.jsx("span",{className:"suggestion-label",children:"Suggested:"}),A.jsx("span",{className:`suggestion-value confidence-${t.confidence}`,children:D(t.suggestedPrice)}),A.jsx("span",{className:"confidence-badge",children:t.confidence})]}),A.jsxs("div",{className:"sample-size",children:["Based on ",t.sampleSize," recent sales"]})]})]})]}),A.jsxs("div",{className:"price-input-section",children:[A.jsxs("div",{className:"price-input",children:[A.jsx("input",{type:"number",value:i[e.asset_id]||"",onChange:t=>S(e.asset_id,t.target.value),placeholder:"Price in WAX",step:"0.0001",min:"0",required:!0,disabled:o}),A.jsx("span",{className:"currency-label",children:"WAX"})]}),t&&A.jsxs("div",{className:"quick-price-buttons",children:[A.jsx("button",{type:"button",className:"quick-price-btn suggested",onClick:()=>S(e.asset_id,B(t.suggestedPrice,4)),disabled:o,title:"Use suggested price",children:"💡"}),A.jsx("button",{type:"button",className:"quick-price-btn floor",onClick:()=>S(e.asset_id,B(.99*t.floorPrice,4)),disabled:o,title:"Use floor price -1%",children:"⚡"})]})]})]},e.asset_id)})})]}),o&&A.jsxs("div",{className:"listing-progress",children:[A.jsx("div",{className:"progress-bar",children:A.jsx("div",{className:"progress-fill",style:{width:`${u}%`}})}),A.jsxs("p",{children:["Listing NFTs... ",Math.round(u),"% complete"]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:s,disabled:o,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary",disabled:o||0===T(),children:o?"Listing...":`List ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},mt=({nfts:e,isOpen:t,onClose:s,onSuccess:n})=>{const[i,r]=a.useState(""),[l,c]=a.useState(""),[o,d]=a.useState(!1),[u,m]=a.useState(0),[h,p]=a.useState("name_asc"),{session:f}=R(),x=a.useMemo(()=>{const t=[...e];switch(h){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));default:return t}},[e,h]);return t?A.jsx("div",{className:"modal-overlay",onClick:s,children:A.jsxs("div",{className:"modal-content bulk-transfer-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Bulk Transfer NFTs"}),A.jsx("button",{className:"modal-close",onClick:s,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"transfer-summary",children:[A.jsx("h3",{children:"Transfer Summary"}),A.jsxs("p",{children:["You are about to transfer ",A.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})]}),A.jsxs("div",{className:"collection-breakdown",children:[A.jsx("h4",{children:"Collection Breakdown"}),Object.entries(e.reduce((e,t)=>{const a=t.collection.collection_name;return e[a]=(e[a]||0)+1,e},{})).map(([e,t])=>A.jsxs("div",{className:"collection-item",children:[A.jsx("span",{className:"collection-name",children:e}),A.jsxs("span",{className:"collection-count",children:[t," NFT",1!==t?"s":""]})]},e))]}),A.jsxs("div",{className:"rarity-breakdown",children:[A.jsx("h4",{children:"Rarity Distribution"}),Object.entries(e.reduce((e,t)=>{const a=t.template?.immutable_data?.rarity||t.data?.rarity||"Unknown";return e[a.toString()]=(e[a.toString()]||0)+1,e},{})).map(([e,t])=>A.jsxs("div",{className:"rarity-item",children:[A.jsx("span",{className:"rarity-name",children:e}),A.jsx("span",{className:"rarity-count",children:t})]},e))]}),A.jsxs("div",{className:"nft-preview-section",children:[A.jsxs("div",{className:"preview-header",children:[A.jsx("h4",{children:"NFT Preview"}),e.length>1&&A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"transfer-sort",children:"Sort by:"}),A.jsxs("select",{id:"transfer-sort",className:"sort-select",value:h,onChange:e=>p(e.target.value),children:[A.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),A.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),A.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),A.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),A.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),A.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),A.jsxs("div",{className:"nft-preview-list",children:[x.slice(0,5).map(e=>A.jsxs("div",{className:"nft-preview-item",children:[A.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),A.jsx("div",{className:"nft-info-bulk",children:A.jsxs("div",{className:"nft-details",children:[A.jsx("span",{className:"nft-name",children:e.name}),A.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),A.jsxs("span",{className:"nft-mint",children:["#",e.mint_number||"N/A"]}),A.jsxs("span",{className:"nft-id",children:["ID: ",e.asset_id]})]})})]},e.asset_id)),e.length>5&&A.jsxs("div",{className:"nft-preview-more",children:["+",e.length-5," more NFTs"]})]})]})]}),A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!f||!i.trim()||0===e.length)return void alert("Please fill in all required fields");const a=i.trim().toLowerCase();if(a.length<1||a.length>12)alert("Account name must be between 1 and 12 characters");else if(/^[a-z1-5.]+$/.test(a)){d(!0),m(0);try{const t=e.map(e=>({account:"atomicassets",name:"transfer",authorization:[{actor:f.actor,permission:f.permission}],data:{from:f.actor,to:a,asset_ids:[e.asset_id],memo:l||"Bulk transfer from PxMarket - market.pixeljourney.xyz"}})),i=10,o=[];for(let e=0;e<t.length;e+=i)o.push(t.slice(e,e+i));let d=0;for(const e of o){await f.transact({actions:e})&&(d++,m(d/o.length*100))}alert(`Successfully transferred ${e.length} NFT(s) to ${a}!`),n?.(),s(),r(""),c("")}catch(o){console.error("Bulk transfer failed:",o),alert(`Transfer failed: ${o instanceof Error?o.message:"Unknown error"}`)}finally{d(!1),m(0)}}else alert("Account name can only contain lowercase letters, numbers 1-5, and dots")},className:"transfer-form",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"recipient",children:"Recipient Account *"}),A.jsx("input",{type:"text",id:"recipient",value:i,onChange:e=>r(e.target.value),placeholder:"Enter WAX account name",required:!0,disabled:o,maxLength:12}),A.jsx("small",{className:"form-help",children:"Enter a valid WAX account name (1-12 characters, lowercase letters, numbers 1-5, dots)"})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),A.jsx("input",{type:"text",id:"memo",value:l,onChange:e=>c(e.target.value),placeholder:"Optional transfer memo",disabled:o,maxLength:256})]}),o&&A.jsxs("div",{className:"transfer-progress",children:[A.jsx("div",{className:"progress-bar",children:A.jsx("div",{className:"progress-fill",style:{width:`${u}%`}})}),A.jsxs("p",{children:["Transferring... ",Math.round(u),"% complete"]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:s,disabled:o,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary",disabled:o||!i.trim(),children:o?"Transferring...":`Transfer ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},ht=({nfts:e,isOpen:t,onClose:n,onSuccess:i})=>{const[r,l]=a.useState(()=>e.map(e=>({nft:e,recipient:""}))),[c,o]=a.useState(""),[d,u]=a.useState(""),[m,h]=a.useState(!1),[p,f]=a.useState(0),[x,g]=a.useState(10),[v,y]=a.useState("name_asc"),{session:j}=R(),{showSuccess:b,showError:N}=_e(),w=a.useMemo(()=>{const e=[...r];switch(v){case"name_asc":return e.sort((e,t)=>(e.nft.name||"").localeCompare(t.nft.name||""));case"name_desc":return e.sort((e,t)=>(t.nft.name||"").localeCompare(e.nft.name||""));case"collection_asc":return e.sort((e,t)=>e.nft.collection.collection_name.localeCompare(t.nft.collection.collection_name));case"collection_desc":return e.sort((e,t)=>t.nft.collection.collection_name.localeCompare(e.nft.collection.collection_name));case"mint_asc":return e.sort((e,t)=>(e.nft.mint_number||0)-(t.nft.mint_number||0));case"mint_desc":return e.sort((e,t)=>(t.nft.mint_number||0)-(e.nft.mint_number||0));default:return e}},[r,v]);s.useEffect(()=>{l(e.map(e=>({nft:e,recipient:""})))},[e]);if(!t)return null;const k=r.filter(e=>e.recipient.trim()),_=k.length===r.length;return A.jsx("div",{className:"modal-overlay",onClick:n,children:A.jsxs("div",{className:"modal-content distribute-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Distribute NFTs"}),A.jsx("button",{className:"modal-close",onClick:n,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"distribute-summary",children:[A.jsx("h3",{children:"Distribution Summary"}),A.jsxs("p",{children:["You are about to distribute ",A.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]})," to individual recipients"]}),A.jsxs("div",{className:"bulk-addresses-section",children:[A.jsx("h4",{children:"Bulk Address Input"}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"bulk-addresses",children:"Comma-separated addresses (optional)"}),A.jsx("textarea",{id:"bulk-addresses",className:"form-control",value:c,onChange:e=>(e=>{if(o(e),e.trim()){const t=e.split(",").map(e=>e.trim()).filter(e=>e);t.length>0&&l(e=>e.map((e,a)=>({...e,recipient:t[a%t.length]||""})))}})(e.target.value),placeholder:"pixeljourney,market.pxj,council.pxj",rows:3}),A.jsxs("div",{className:"bulk-actions",children:[A.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{if(!c.trim())return void N("No addresses provided","Please enter comma-separated addresses first");const e=c.split(",").map(e=>e.trim()).filter(e=>e);0!==e.length?l(t=>t.map(t=>({...t,recipient:e[Math.floor(Math.random()*e.length)]}))):N("Invalid addresses","Please provide valid comma-separated addresses")},disabled:!c.trim(),children:"🎲 Randomize Distribution"}),A.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{l(e=>e.map(e=>({...e,recipient:""}))),o("")},children:"🗑️ Clear All"})]})]})]}),A.jsxs("div",{className:"batch-config",children:[A.jsx("h4",{children:"Transaction Settings"}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"batch-size",children:"NFTs per transaction (5-200)"}),A.jsx("input",{type:"number",id:"batch-size",className:"form-control",value:x,onChange:e=>g(Math.max(5,Math.min(200,parseInt(e.target.value)||10))),min:5,max:200}),A.jsx("small",{children:"Larger batches are more efficient but may fail if too large"})]})]})]}),A.jsxs("div",{className:"distribution-list",children:[A.jsxs("div",{className:"distribution-header",children:[A.jsxs("h4",{children:["Individual Recipients (",k.length,"/",r.length," configured)"]}),e.length>1&&A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"distribute-sort",children:"Sort by:"}),A.jsxs("select",{id:"distribute-sort",className:"sort-select",value:v,onChange:e=>y(e.target.value),children:[A.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),A.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),A.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),A.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),A.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),A.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),A.jsx("div",{className:"distribution-items",children:w.map(({nft:e,recipient:t})=>A.jsxs("div",{className:"distribution-item",children:[A.jsxs("div",{className:"nft-preview",children:[A.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),A.jsxs("div",{className:"nft-info",children:[A.jsx("span",{className:"nft-name",children:e.name}),A.jsx("span",{className:"nft-collection",children:e.collection.collection_name}),A.jsxs("span",{className:"nft-mint",children:["#",e.mint_number||"N/A"]})]})]}),A.jsx("div",{className:"recipient-input",children:A.jsx("input",{type:"text",className:"form-control",value:t,onChange:t=>((e,t)=>{l(a=>a.map(a=>a.nft.asset_id===e?{...a,recipient:t}:a))})(e.asset_id,t.target.value),placeholder:"Recipient account name"})})]},e.asset_id))})]}),A.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!j)return void N("Wallet Required","Please connect your wallet first");const t=r.filter(e=>!e.recipient.trim());if(t.length>0)N("Missing Recipients",`Please specify recipients for all ${t.length} NFT(s)`);else{h(!0),f(0);try{const e=r.length;let t=0;for(let a=0;a<r.length;a+=x){const s=r.slice(a,a+x),n=s.map(({nft:e,recipient:t})=>({account:"atomicassets",name:"transfer",authorization:[{actor:j.actor.toString(),permission:"active"}],data:{from:j.actor.toString(),to:t.trim(),asset_ids:[e.asset_id],memo:d||"Distributed via PxMarket"}})),i=await j.transact({actions:n},{expireSeconds:30});t+=s.length,f(t/e*100),V("Batch distribution completed","DistributeModal",{batchSize:s.length,completed:t,total:e,transactionId:i.transaction})}b("Distribution Complete",`Successfully distributed ${e} NFT${1!==e?"s":""}`),i?.(),n()}catch(a){K("Distribution failed","DistributeModal",a),N("Distribution Failed",a instanceof Error?a.message:"Unknown error occurred")}finally{h(!1),f(0)}}},className:"distribute-form",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"memo",children:"Memo (optional)"}),A.jsx("input",{type:"text",id:"memo",className:"form-control",value:d,onChange:e=>u(e.target.value),placeholder:"Optional transfer memo",maxLength:256})]}),m&&A.jsxs("div",{className:"progress-container",children:[A.jsx("div",{className:"progress-bar",children:A.jsx("div",{className:"progress-fill",style:{width:`${p}%`}})}),A.jsxs("p",{children:["Distributing NFTs... ",Math.round(p),"%"]})]}),A.jsxs("div",{className:"form-actions",children:[A.jsx("button",{type:"button",className:"btn btn-secondary",onClick:n,disabled:m,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn btn-primary",disabled:m||!_,children:m?"Distributing...":`Distribute ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})})},pt=({nfts:e,isOpen:t,onClose:s,onSuccess:n})=>{const[i,r]=a.useState(!1),[l,c]=a.useState(0),[o,d]=a.useState(""),{session:u}=R();return t?A.jsx("div",{className:"modal-overlay",onClick:s,children:A.jsxs("div",{className:"modal-content bulk-burn-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Bulk Burn NFTs"}),A.jsx("button",{className:"modal-close",onClick:s,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"burn-warning",children:[A.jsx("div",{className:"warning-icon",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),A.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),A.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]})}),A.jsx("h3",{children:"⚠️ Warning: This action cannot be undone!"}),A.jsxs("p",{children:["You are about to permanently burn ",A.jsxs("strong",{children:[e.length," NFT",1!==e.length?"s":""]}),". This will completely destroy these assets and they cannot be recovered."]})]}),A.jsxs("div",{className:"nfts-to-burn",children:[A.jsx("h4",{children:"NFTs to be burned:"}),A.jsx("div",{className:"burn-list-container",children:e.map(e=>A.jsxs("div",{className:"burn-nft-item",children:[A.jsx("img",{src:e.img?.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`,alt:e.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),A.jsxs("div",{className:"nft-details",children:[A.jsx("span",{className:"nft-name",children:e.name}),A.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),e.mint_number&&A.jsxs("span",{className:"nft-mint",children:["#",e.mint_number]}),A.jsxs("span",{className:"nft-id",children:["ID: ",e.asset_id]})]})]},e.asset_id))})]}),A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!u||0===e.length)return void alert("Please connect your wallet and select NFTs to burn");const a=[],i=e.filter(e=>{if(ae.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&ae.isValidWaxRock(t))return a.push(e),!1}return!0});if(a.length>0){const e=a.map(e=>`${e.name} (${e.data?.WaxRock})`).join(", ");if(alert(`${a.length} WaxRock Pixal PFP(s) were excluded from burning for protection: ${e}\n\nWaxRock Pixals are protected from burning and recycling on our platform.`),0===i.length)return void alert("No NFTs remaining to burn after excluding WaxRock Pixals.")}if("BURN"===o){r(!0),c(0);try{const e=i.map(e=>({account:"atomicassets",name:"burnasset",authorization:[{actor:u.actor,permission:u.permission}],data:{asset_owner:u.actor,asset_id:e.asset_id}})),t=10,a=[];for(let s=0;s<e.length;s+=t)a.push(e.slice(s,s+t));let r=0;for(const s of a){await u.transact({actions:s})&&(r++,c(r/a.length*100))}alert(`Successfully burned ${i.length} NFT(s)!`),n?.(),s(),d("")}catch(l){console.error("Bulk burn failed:",l),alert(`Burn failed: ${l instanceof Error?l.message:"Unknown error"}`)}finally{r(!1),c(0)}}else alert('Please type "BURN" to confirm this action')},className:"burn-form",children:[A.jsxs("div",{className:"confirmation-section",children:[A.jsxs("label",{htmlFor:"confirmText",children:["Type ",A.jsx("strong",{children:'"BURN"'})," to confirm this action:"]}),A.jsx("input",{id:"confirmText",type:"text",value:o,onChange:e=>d(e.target.value.toUpperCase()),placeholder:"Type BURN to confirm",disabled:i,required:!0})]}),i&&A.jsxs("div",{className:"burn-progress",children:[A.jsx("div",{className:"progress-bar",children:A.jsx("div",{className:"progress-fill",style:{width:`${l}%`}})}),A.jsxs("p",{children:["Burning NFTs... ",Math.round(l),"% complete"]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:s,disabled:i,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-danger",disabled:i||"BURN"!==o,children:i?"Burning...":`🔥 Burn ${e.length} NFT${1!==e.length?"s":""}`})]})]})]})]})}):null},ft=[{id:781515,pxj:1,wuf:22,pxjUpgrade:0,name:"Pixal PFP",type:"pixals"},{id:820134,pxj:2.22,wuf:5,pxjUpgrade:0,name:"Pixel Ingredient Pack",type:"pixelpack"},{id:858568,pxj:142,wuf:142,pxjUpgrade:0,name:"Black (Primary)",type:"primary"},{id:858569,pxj:.42,wuf:1,pxjUpgrade:0,name:"Blue (Primary)",type:"primary"},{id:858570,pxj:.42,wuf:1,pxjUpgrade:0,name:"Red (Primary)",type:"primary"},{id:858571,pxj:.42,wuf:1,pxjUpgrade:0,name:"Yellow (Primary)",type:"primary"},{id:858572,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Green (Secondary)",type:"secondary"},{id:858573,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Orange (Secondary)",type:"secondary"},{id:858574,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Purple (Secondary)",type:"secondary"},{id:858575,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Amber (Tertiary)",type:"tertiary"},{id:858576,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Chartreuse (Tertiary)",type:"tertiary"},{id:858577,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Violet (Tertiary)",type:"tertiary"},{id:858578,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Teal (Tertiary)",type:"tertiary"},{id:858580,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Vermillion (Tertiary)",type:"tertiary"},{id:859273,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Magenta (Tertiary)",type:"tertiary"}],xt=[{id:"craft_green",name:"Green (Secondary)",description:"Craft Green from Yellow + Blue + 25,000 PXJ",resultTemplateId:858572,ingredients:[{templateId:858571,quantity:1,name:"Yellow (Primary)"},{templateId:858569,quantity:1,name:"Blue (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_orange",name:"Orange (Secondary)",description:"Craft Orange from Red + Yellow + 25,000 PXJ",resultTemplateId:858573,ingredients:[{templateId:858570,quantity:1,name:"Red (Primary)"},{templateId:858571,quantity:1,name:"Yellow (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_purple",name:"Purple (Secondary)",description:"Craft Purple from Red + Blue + 25,000 PXJ",resultTemplateId:858574,ingredients:[{templateId:858570,quantity:1,name:"Red (Primary)"},{templateId:858569,quantity:1,name:"Blue (Primary)"}],pxjCost:25e3,tier:"secondary"},{id:"craft_amber",name:"Amber (Tertiary)",description:"Craft Amber from Orange + Green + 150,000 PXJ",resultTemplateId:858575,ingredients:[{templateId:858573,quantity:1,name:"Orange (Secondary)"},{templateId:858572,quantity:1,name:"Green (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_chartreuse",name:"Chartreuse (Tertiary)",description:"Craft Chartreuse from Green + Purple + 150,000 PXJ",resultTemplateId:858576,ingredients:[{templateId:858572,quantity:1,name:"Green (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_violet",name:"Violet (Tertiary)",description:"Craft Violet from Purple + Orange + 150,000 PXJ",resultTemplateId:858577,ingredients:[{templateId:858574,quantity:1,name:"Purple (Secondary)"},{templateId:858573,quantity:1,name:"Orange (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_teal",name:"Teal (Tertiary)",description:"Craft Teal from Green + Purple + 150,000 PXJ",resultTemplateId:858578,ingredients:[{templateId:858572,quantity:1,name:"Green (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_vermillion",name:"Vermillion (Tertiary)",description:"Craft Vermillion from Orange + Purple + 150,000 PXJ",resultTemplateId:858580,ingredients:[{templateId:858573,quantity:1,name:"Orange (Secondary)"},{templateId:858574,quantity:1,name:"Purple (Secondary)"}],pxjCost:15e4,tier:"tertiary"},{id:"craft_magenta",name:"Magenta (Tertiary)",description:"Craft Magenta from Purple + Orange + 150,000 PXJ",resultTemplateId:859273,ingredients:[{templateId:858574,quantity:1,name:"Purple (Secondary)"},{templateId:858573,quantity:1,name:"Orange (Secondary)"}],pxjCost:15e4,tier:"tertiary"}],gt=e=>ft.find(t=>t.id===e);const vt=new class{cache=[];balanceCache={pxj:0,wuf:0};lastFetch=0;CACHE_DURATION=3e4;virtualLibrary=new Map;virtualLibraryTimestamp=new Map;VIRTUAL_LIBRARY_CACHE_DURATION=3e5;backgroundLoadingPromises=new Map;isBackgroundLoading=new Set;async fetchInventory(e){const t=Date.now();if(this.cache.length>0&&t-this.lastFetch<this.CACHE_DURATION)return this.cache;try{const a=await fetch(`${ye.getCurrentAtomicEndpoint()}/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&burned=false&limit=1000&page=1&order=desc&sort=asset_id`);if(!a.ok)throw new Error(`Failed to fetch inventory: ${a.statusText}`);const s=(await a.json()).data||[],n=new Map;for(const e of s){const t=parseInt(e.template.template_id),a=ft.find(e=>e.id===t);a&&["primary","secondary","tertiary"].includes(a.type)&&(n.has(t)||n.set(t,{templateId:t,name:a.name,assetIds:[],tier:a.type}),n.get(t).assetIds.push(e.asset_id))}return this.cache=Array.from(n.values()).map(e=>({...e,quantity:e.assetIds.length})),this.lastFetch=t,this.cache}catch(a){return W.logError("InventoryService.fetchInventory",a,{account:e}),this.cache=[],[]}}async fetchBalances(e){try{let a=0,s=0;try{const t=await ye.getWaxCurrencyBalance(e,"pixeljourney","PXJ");t&&t.length>0&&(a=parseFloat(t[0].balance.split(" ")[0]))}catch(t){W.logError("InventoryService.getPXJBalance",t,{account:e})}try{const t=await ye.getWaxCurrencyBalance(e,"wuffi","WUF");t&&t.length>0&&(s=parseFloat(t[0].balance.split(" ")[0]))}catch(t){W.logError("InventoryService.getWUFBalance",t,{account:e})}return this.balanceCache={pxj:a,wuf:s},this.balanceCache}catch(t){W.logError("InventoryService.fetchBalances",t,{account:e});const a={pxj:0,wuf:0};return this.balanceCache=a,a}}getIngredientQuantity(e){const t=this.cache.find(t=>t.templateId===e);return t?t.quantity:0}getIngredientAssetIds(e,t){const a=this.cache.find(t=>t.templateId===e);return!a||a.quantity<t?[]:a.assetIds.slice(0,t)}canCraftRecipe(e,t){for(const a of e){if(this.getIngredientQuantity(a.templateId)<a.quantity)return!1}return!(this.balanceCache.pxj<t)}getMaxCraftableQuantity(e,t){let a=1/0;for(const n of e){const e=this.getIngredientQuantity(n.templateId),t=n.quantity,s=Math.floor(e/t);a=Math.min(a,s)}const s=Math.floor(this.balanceCache.pxj/t);return Math.min(a,s)}updateInventoryAfterCraft(e,t){for(const a of e){const e=this.cache.find(e=>e.templateId===a.templateId);e&&(e.quantity=Math.max(0,e.quantity-a.quantity),e.assetIds=e.assetIds.slice(a.quantity))}this.balanceCache.pxj=Math.max(0,this.balanceCache.pxj-t)}async startBackgroundInventoryLoad(e){if(!e||this.isBackgroundLoading.has(e))return;const t=this.virtualLibraryTimestamp.get(e)||0;if(!(Date.now()-t<this.VIRTUAL_LIBRARY_CACHE_DURATION)){this.isBackgroundLoading.add(e);try{console.log(`Starting background inventory load for ${e}`);const t=this.loadFullInventoryInBackground(e);this.backgroundLoadingPromises.set(e,t),await t,console.log(`Background inventory load completed for ${e}`)}catch(a){W.logError("InventoryService.startBackgroundInventoryLoad",a,{account:e})}finally{this.isBackgroundLoading.delete(e),this.backgroundLoadingPromises.delete(e)}}}convertNFTAssetToInventoryNFT(e){return{asset_id:e.asset_id,name:e.name,img:e.image,video:e.video,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:e.max_supply||"0",immutable_data:{img:e.image,video:e.video}},data:{...e.traits,rarity:e.rarity},mint_number:e.template_mint}}async loadFullInventoryInBackground(e){const t=[];let a=1;let s=!0;for(;s;)try{const n=await ye.getUserInventoryWithFilter(e,a,100,"all");if(n&&n.assets&&n.assets.length>0){const e=n.assets.map(e=>this.convertNFTAssetToInventoryNFT(e));t.push(...e),s=n.hasMore,a++,await new Promise(e=>setTimeout(e,100))}else s=!1}catch(n){W.logError("InventoryService.loadFullInventoryInBackground",n,{account:e,page:a}),s=!1}this.virtualLibrary.set(e,t),this.virtualLibraryTimestamp.set(e,Date.now()),console.log(`Loaded ${t.length} NFTs into virtual library for ${e}`)}async getInventoryPage(e,t,a=50){const s=this.virtualLibrary.get(e),n=this.virtualLibraryTimestamp.get(e)||0,i=Date.now();if(s&&i-n<this.VIRTUAL_LIBRARY_CACHE_DURATION){const e=(t-1)*a,n=e+a;return{data:s.slice(e,n),hasMore:n<s.length,totalCount:s.length}}try{const s=await ye.getUserInventoryWithFilter(e,t,a,"all");return{data:s?.assets?s.assets.map(e=>this.convertNFTAssetToInventoryNFT(e)):[],hasMore:s?.hasMore||!1,totalCount:s?.total||0}}catch(r){return W.logError("InventoryService.getInventoryPage",r,{account:e,page:t,limit:a}),{data:[],hasMore:!1,totalCount:0}}}isBackgroundLoadingInProgress(e){return this.isBackgroundLoading.has(e)}getVirtualLibraryStats(e){return{itemCount:this.virtualLibrary.get(e)?.length||0,lastUpdate:this.virtualLibraryTimestamp.get(e)||null,isLoading:this.isBackgroundLoading.has(e)}}clearCache(){this.cache=[],this.balanceCache={pxj:0,wuf:0},this.lastFetch=0}clearVirtualLibrary(e){e?(this.virtualLibrary.delete(e),this.virtualLibraryTimestamp.delete(e),this.isBackgroundLoading.delete(e),this.backgroundLoadingPromises.delete(e)):(this.virtualLibrary.clear(),this.virtualLibraryTimestamp.clear(),this.isBackgroundLoading.clear(),this.backgroundLoadingPromises.clear())}getCachedInventory(){return this.cache}getCachedBalances(){return this.balanceCache}},yt=({isOpen:e,onClose:t,ingredient:s})=>{const{account:n,session:i}=R();ue();const{showError:l,showSuccess:c,showWarning:o}=_e(),[d,u]=a.useState("craft"),[m,h]=a.useState(null),[p,f]=a.useState([]),[x,g]=a.useState(!1),[v,y]=a.useState([]),[j,b]=a.useState({pxj:0,wuf:0}),[N,w]=a.useState(!1),[k,_]=a.useState(1),[S,C]=a.useState(0),[E,P]=a.useState("name_asc"),T=a.useCallback(async()=>{if(n){w(!0);try{const[e,t]=await Promise.all([vt.fetchInventory(n),vt.fetchBalances(n)]);y(e),b(t)}catch(e){console.error("Failed to load inventory:",e),l("Failed to load inventory data",e instanceof Error?e.message:"Unknown error")}finally{w(!1)}}else l("Wallet Required","Please connect your wallet first")},[n,l]);a.useEffect(()=>{e&&n&&T()},[e,n,T]);const I=e=>{const t=v.find(t=>t.templateId===e);return t?t.quantity:0},F=e=>{if(!e)return 0;let t=1/0;for(const s of e.ingredients){const e=I(s.templateId),a=s.quantity,n=Math.floor(e/a);t=Math.min(t,n)}const a=Math.floor(j.pxj/e.pxjCost);return Math.min(t,a)};a.useEffect(()=>{if(m){const e=F(m);C(e),_(Math.min(k,e))}},[m,v,j.pxj,F,k]);const $=a.useMemo(()=>{const e=[...v];switch(E){case"name_asc":return e.sort((e,t)=>e.name.localeCompare(t.name));case"name_desc":return e.sort((e,t)=>t.name.localeCompare(e.name));case"quantity_asc":return e.sort((e,t)=>e.quantity-t.quantity);case"quantity_desc":return e.sort((e,t)=>t.quantity-e.quantity);case"type_asc":return e.sort((e,t)=>{const a=gt(e.templateId),s=gt(t.templateId),n=a?.type||"Unknown",i=s?.type||"Unknown";return n.localeCompare(i)});case"type_desc":return e.sort((e,t)=>{const a=gt(e.templateId),s=gt(t.templateId),n=a?.type||"Unknown";return(s?.type||"Unknown").localeCompare(n)});default:return e}},[v,E]),L=(e,t=1)=>{for(const s of e.ingredients){if(I(s.templateId)<s.quantity*t)return!1}const a=e.pxjCost*t;return!(j.pxj<a)},M=async()=>{if(!s||!n||!i)return void l("Missing Requirements","Ingredient and wallet connection required for upgrading");const e="template"in s?s.template?.template_id:s.id,a=gt("string"==typeof e?parseInt(e):e);if(a&&0!==a.pxjUpgrade)if(j.pxj<a.pxjUpgrade)l("Insufficient PXJ",`You need ${a.pxjUpgrade.toLocaleString()} PXJ to upgrade this ingredient`);else{g(!0);try{const e=[{account:"pixeljourney",name:"transfer",authorization:[{actor:n,permission:"active"}],data:{from:n,to:"upgradepool",quantity:`${a.pxjUpgrade.toFixed(4)} PXJ`,memo:`Upgrade ${a.name}`}}];await Ie.transact(e)&&(c("Upgrade Complete!",`Successfully upgraded ${a.name}`),T(),t())}catch(r){console.error("Upgrade failed:",r),l("Upgrade Failed",r instanceof Error?r.message:"Unknown error occurred")}finally{g(!1)}}else l("Cannot Upgrade","This ingredient cannot be upgraded")};return e?r.createPortal(A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"crafting-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Pixel Ingredient Crafting"}),A.jsx("button",{className:"close-btn",onClick:t,children:"×"})]}),A.jsxs("div",{className:"modal-tabs",children:[A.jsx("button",{className:"tab-btn "+("craft"===d?"active":""),onClick:()=>u("craft"),children:"Craft New"}),A.jsx("button",{className:"tab-btn "+("upgrade"===d?"active":""),onClick:()=>u("upgrade"),disabled:!s,children:"Upgrade Existing"})]}),A.jsx("div",{className:"modal-content",children:"craft"===d?A.jsxs("div",{className:"craft-tab",children:[A.jsxs("div",{className:"craft-layout",children:[A.jsxs("div",{className:"recipe-selection",children:[A.jsx("h3",{children:"Select Recipe"}),A.jsxs("div",{className:"recipe-categories",children:[A.jsxs("div",{className:"recipe-category",children:[A.jsx("h4",{children:"Secondary Ingredients"}),xt.filter(e=>"secondary"===e.tier).map(e=>A.jsxs("div",{className:`recipe-item ${m?.id===e.id?"selected":""} ${L(e)?"":"disabled"}`,onClick:()=>h(e),children:[A.jsx("div",{className:"recipe-name",children:e.name}),A.jsxs("div",{className:"recipe-cost",children:[e.pxjCost.toLocaleString()," PXJ"]}),A.jsx("div",{className:"recipe-ingredients",children:e.ingredients.map((e,t)=>A.jsxs("span",{className:I(e.templateId)>=e.quantity?"available":"unavailable",children:[e.name," (",I(e.templateId),"/",e.quantity,")"]},t))})]},e.id))]}),A.jsxs("div",{className:"recipe-category",children:[A.jsx("h4",{children:"Tertiary Ingredients"}),xt.filter(e=>"tertiary"===e.tier).map(e=>A.jsxs("div",{className:`recipe-item ${m?.id===e.id?"selected":""} ${L(e)?"":"disabled"}`,onClick:()=>h(e),children:[A.jsx("div",{className:"recipe-name",children:e.name}),A.jsxs("div",{className:"recipe-cost",children:[e.pxjCost.toLocaleString()," PXJ"]}),A.jsx("div",{className:"recipe-ingredients",children:e.ingredients.map((e,t)=>A.jsxs("span",{className:I(e.templateId)>=e.quantity?"available":"unavailable",children:[e.name," (",I(e.templateId),"/",e.quantity,")"]},t))})]},e.id))]})]})]}),A.jsxs("div",{className:"craft-controls",children:[m&&A.jsxs("div",{className:"selected-recipe",children:[A.jsx("h3",{children:m.name}),A.jsx("p",{children:m.description}),A.jsxs("div",{className:"quantity-controls",children:[A.jsx("label",{children:"Quantity:"}),A.jsxs("div",{className:"quantity-input",children:[A.jsx("button",{onClick:()=>_(Math.max(1,k-1)),disabled:k<=1,children:"-"}),A.jsx("input",{type:"number",value:k,onChange:e=>_(Math.min(S,Math.max(1,parseInt(e.target.value)||1))),min:"1",max:S}),A.jsx("button",{onClick:()=>_(Math.min(S,k+1)),disabled:k>=S,children:"+"})]}),A.jsxs("span",{className:"max-craftable",children:["Max: ",S]})]}),A.jsx("div",{className:"total-cost",children:A.jsxs("strong",{children:["Total Cost: ",(m.pxjCost*k).toLocaleString()," PXJ"]})}),A.jsx("button",{className:"add-to-queue-btn",onClick:()=>{if(!m||k<=0)return;if(!L(m,k))return void o("Insufficient Resources","You don't have enough ingredients or PXJ for this craft.");const e=p.findIndex(e=>e.recipe.id===m.id);if(e>=0){const t=[...p];t[e].quantity+=k,f(t)}else f([...p,{recipe:m,quantity:k}]);c("Added to Queue",`Added ${k}x ${m.name} to crafting queue`),_(1)},disabled:!L(m,k)||k<=0,children:"Add to Queue"})]}),A.jsxs("div",{className:"inventory-section",children:[A.jsxs("div",{className:"inventory-header",children:[A.jsx("h3",{children:"Your Inventory"}),!N&&v.length>0&&A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"inventory-sort",children:"Sort by:"}),A.jsxs("select",{id:"inventory-sort",className:"sort-select",value:E,onChange:e=>P(e.target.value),children:[A.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),A.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),A.jsx("option",{value:"quantity_asc",children:"Quantity (Low-High)"}),A.jsx("option",{value:"quantity_desc",children:"Quantity (High-Low)"}),A.jsx("option",{value:"type_asc",children:"Type (A-Z)"}),A.jsx("option",{value:"type_desc",children:"Type (Z-A)"})]})]})]}),N?A.jsxs("div",{className:"loading-inventory",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("span",{children:"Loading inventory..."})]}):A.jsx("div",{className:"inventory-grid",children:0===$.length?A.jsx("div",{className:"no-inventory",children:A.jsxs("div",{className:"empty-state",children:[A.jsx("span",{children:"No ingredients found"}),A.jsx("button",{className:"refresh-btn",onClick:T,disabled:N,children:"Refresh Inventory"})]})}):$.map(e=>{const t=gt(e.templateId);return A.jsxs("div",{className:"inventory-item",children:[A.jsx("div",{className:"item-name",children:e.name}),A.jsxs("div",{className:"item-quantity",children:["Qty: ",e.quantity]}),A.jsx("div",{className:"item-tier",children:t?.type||"Unknown"})]},e.templateId)})})]})]})]}),A.jsxs("div",{className:"crafting-queue",children:[A.jsxs("div",{className:"queue-header",children:[A.jsxs("h3",{children:["Crafting Queue (",p.length,")"]}),p.length>0&&A.jsx("button",{className:"clear-queue-btn",onClick:()=>{f([])},children:"Clear All"})]}),p.length>0?A.jsxs("div",{className:"queue-items",children:[p.map((e,t)=>A.jsxs("div",{className:"queue-item",children:[A.jsxs("div",{className:"queue-item-info",children:[A.jsx("span",{className:"item-name",children:e.recipe.name}),A.jsxs("span",{className:"item-quantity",children:["x",e.quantity]}),A.jsxs("span",{className:"item-cost",children:[(e.recipe.pxjCost*e.quantity).toLocaleString()," PXJ"]})]}),A.jsx("button",{className:"remove-item-btn",onClick:()=>{return t=e.recipe.id,void f(p.filter(e=>e.recipe.id!==t));var t},children:"Remove"})]},t)),A.jsx("div",{className:"queue-total",children:A.jsxs("strong",{children:["Total: ",p.reduce((e,t)=>e+t.recipe.pxjCost*t.quantity,0).toLocaleString()," PXJ"]})}),A.jsx("button",{className:"execute-queue-btn",onClick:async()=>{if(0===p.length)return void o("Empty Queue","No items in crafting queue");if(!n||!i)return void l("Wallet Required","Please connect your wallet to craft ingredients");if(x)return;g(!0);let e=0;try{for(const t of p){const{recipe:a,quantity:s}=t,n=[];let i=!0;for(const e of a.ingredients){const t=e.quantity*s,a=vt.getIngredientAssetIds(e.templateId,t);if(a.length<t){l("Insufficient Ingredients",`Not enough ${e.name} available`),i=!1;break}n.push({templateId:e.templateId,assetIds:a})}if(!i)continue;const r={recipe:a.id,quantity:s,ingredientAssets:n,pxjCost:a.pxjCost*s};if(await Ie.executeCraftingTransaction(r)){e++;const t=a.ingredients.map(e=>({templateId:e.templateId,quantity:e.quantity*s}));vt.updateInventoryAfterCraft(t,a.pxjCost*s),c("Craft Successful!",`Successfully crafted ${s}x ${a.name}`)}else l("Craft Failed",`Failed to craft ${a.name}`)}e>0&&(c("Crafting Complete!",`Successfully crafted ${e} recipe(s)`),f([]),T(),t())}catch(a){console.error("Crafting failed:",a),l("Crafting Failed",a instanceof Error?a.message:"Unknown error occurred")}finally{g(!1)}},disabled:x,children:x?"Crafting...":"Craft All"})]}):A.jsx("div",{className:"empty-queue",children:A.jsx("p",{children:"No items in queue. Select a recipe and add it to start crafting."})})]})]}):A.jsx("div",{className:"upgrade-tab",children:s?A.jsx("div",{className:"upgrade-content",children:A.jsxs("div",{className:"ingredient-info",children:[A.jsxs("h3",{children:["Upgrade: ",s.name]}),A.jsxs("p",{children:["Template ID: ","template"in s?s.template?.template_id:s.id]}),(()=>{const e="template"in s?s.template?.template_id:s.id,t=gt("string"==typeof e?parseInt(e):e);return t?0===t.pxjUpgrade?A.jsx("p",{className:"no-upgrade",children:"This ingredient cannot be upgraded."}):A.jsxs("div",{className:"upgrade-details",children:[A.jsx("div",{className:"upgrade-cost",children:A.jsxs("strong",{children:["Upgrade Cost: ",t.pxjUpgrade.toLocaleString()," PXJ"]})}),A.jsxs("div",{className:"balance-info",children:["Your PXJ Balance: ",j.pxj.toLocaleString()]}),A.jsx("button",{className:"upgrade-btn",onClick:M,disabled:x||j.pxj<t.pxjUpgrade,children:x?"Upgrading...":"Upgrade Ingredient"})]}):A.jsx("p",{children:"Template not found"})})()]})}):A.jsx("div",{className:"no-ingredient",children:A.jsx("p",{children:"No ingredient selected for upgrade. Please select an ingredient from your inventory."})})})}),A.jsx("div",{className:"modal-footer",children:A.jsx("div",{className:"resource-display",children:A.jsx("div",{className:"pxj-balance",children:A.jsxs("strong",{children:["PXJ Balance: ",j.pxj.toLocaleString()]})})})})]})}),document.body):null};const jt=new class{atomicMarketContract="atomicmarket";get atomicMarketAPI(){return ye.getCurrentAtomicEndpoint()}async placeBuyOffer(e,t,a,s=""){if(!e)throw new Error("Please connect your wallet first");const n=parseFloat(a);if(isNaN(n)||n<=0)throw new Error("Please enter a valid offer amount");try{const i=`${n.toFixed(8)} WAX`,r=await fetch(`${this.atomicMarketAPI}/atomicassets/v1/assets/${t}`);if(!r.ok)throw new Error("Failed to fetch asset details");const l=await r.json();if(!l.success||!l.data)throw new Error("Asset not found");const c=l.data.owner,o={account:this.atomicMarketContract,name:"announceoffer",authorization:[{actor:e.actor,permission:e.permission}],data:{buyer:e.actor,recipient:c,asset_ids:[t],price:i,memo:s||"Buy offer from PxMarket - market.pixeljourney.xyz",maker_marketplace:"market.pxj"}},d=await e.transact({actions:[o]});return{success:!0,transaction_id:d?.transaction_id||d?.id||"",message:`Buy offer of ${a} WAX placed successfully!`}}catch(i){throw W.logError("OfferService.placeBuyOffer",i,{assetId:t,offerAmount:a,actor:e.actor}),new Error(`Failed to place buy offer: ${i instanceof Error?i.message:"Transaction failed or was rejected"}`)}}async getBuyOffersForAsset(e){try{const t=await fetch(`${this.atomicMarketAPI}/atomicmarket/v1/buyoffers?asset_id=${e}&state=0&sort=price&order=desc&limit=50`);if(!t.ok)throw new Error("Failed to fetch buy offers");const a=await t.json();return a.success&&a.data?a.data:[]}catch(t){return W.logError("OfferService.getBuyOffersForAsset",t,{assetId:e}),[]}}async getUserBuyOffers(e,t){try{let a=`${this.atomicMarketAPI}/atomicmarket/v1/buyoffers?buyer=${e}&sort=created&order=desc&limit=100`;void 0!==t&&(a+=`&state=${t}`);const s=await fetch(a);if(!s.ok)throw new Error("Failed to fetch user buy offers");const n=await s.json();return n.success&&n.data?n.data:[]}catch(a){return W.logError("OfferService.getUserBuyOffers",a,{account:e,state:t}),[]}}async cancelBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"canceloffer",authorization:[{actor:e.actor,permission:e.permission}],data:{offer_id:t}},s=await e.transact({actions:[a]});return{success:!0,transaction_id:s?.transaction_id||s?.id||"",message:"Buy offer cancelled successfully!"}}catch(a){throw W.logError("OfferService.cancelBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to cancel buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}async acceptBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"acceptoffer",authorization:[{actor:e.actor,permission:e.permission}],data:{offer_id:t}},s=await e.transact({actions:[a]});return{success:!0,transaction_id:s?.transaction_id||s?.id||"",message:"Buy offer accepted successfully!"}}catch(a){throw W.logError("OfferService.acceptBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to accept buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}async declineBuyOffer(e,t){if(!e)throw new Error("Please connect your wallet first");try{const a={account:this.atomicMarketContract,name:"declineoffer",authorization:[{actor:e.actor,permission:e.permission}],data:{offer_id:t}},s=await e.transact({actions:[a]});return{success:!0,transaction_id:s?.transaction_id||s?.id||"",message:"Buy offer declined successfully!"}}catch(a){throw W.logError("OfferService.declineBuyOffer",a,{offerId:t,actor:e.actor}),new Error(`Failed to decline buy offer: ${a instanceof Error?a.message:"Transaction failed or was rejected"}`)}}formatPrice(e){return`${(parseFloat(e.amount)/Math.pow(10,e.token_precision)).toFixed(Math.min(4,e.token_precision))} ${e.token_symbol}`}getOfferStateText(e){switch(e){case 0:return"Pending";case 1:return"Invalid";case 2:return"Accepted";case 3:return"Declined";case 4:return"Cancelled";default:return"Unknown"}}},bt=({isOpen:e,onClose:t,nft:s})=>{const{account:n,session:i}=R(),{settings:r}=ue(),{showSuccess:l,showError:c}=_e(),[o,d]=a.useState([]),[u,m]=a.useState(!1),[h,p]=a.useState(null),f=a.useCallback(async()=>{if(s){m(!0);try{const e=await ye.getAssetOffers(s.asset_id);if(e&&e.length>0){const t=e.map(e=>({id:e.id,buyer:e.buyer,price:(parseFloat(e.price)/1e8).toFixed(8),symbol:e.token,timestamp:e.created,memo:e.memo})).sort((e,t)=>parseFloat(t.price)-parseFloat(e.price));d(t)}else d([])}catch(e){console.error("Failed to load offers:",e),d([])}finally{m(!1)}}},[s]);a.useEffect(()=>{e&&s&&f()},[e,s,f]);const x=e=>{const t=new Date,a=new Date(e),s=t.getTime()-a.getTime(),n=Math.floor(s/36e5),i=Math.floor(n/24);if(i>0)return`${i} day${i>1?"s":""} ago`;if(n>0)return`${n} hour${n>1?"s":""} ago`;{const e=Math.floor(s/6e4);return`${e} minute${e>1?"s":""} ago`}};return e&&s?A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"modal-content view-offers-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"View Offers"}),A.jsx("button",{className:"modal-close",onClick:t,children:"×"})]}),A.jsxs("div",{className:"offers-content",children:[A.jsxs("div",{className:"view-offers-nft-info",children:[A.jsx("div",{className:"nft-image",children:A.jsx(Fe,{imageUrl:s.img,alt:s.name,enableAnimations:r.enableAnimatedNFTs})}),A.jsxs("div",{className:"nft-details",children:[A.jsx("h3",{children:s.name}),A.jsxs("div",{className:"nft-id",children:["#",s.asset_id]}),A.jsxs("div",{className:"collection-info",children:["string"==typeof s.collection?s.collection:s.collection?.name||s.collection?.collection_name||"Unknown"," • ",s.schema.schema_name]})]})]}),A.jsxs("div",{className:"offers-section",children:[A.jsxs("div",{className:"offers-header",children:[A.jsxs("h3",{children:["Active Offers (",o.length,")"]}),A.jsxs("button",{className:"refresh-btn",onClick:f,disabled:u,children:[u?"🔄":"↻"," Refresh"]})]}),u?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading offers..."})]}):0===o.length?A.jsxs("div",{className:"empty-offers",children:[A.jsx("div",{className:"empty-icon",children:"📭"}),A.jsx("h4",{children:"No Offers Yet"}),A.jsx("p",{children:"This NFT hasn't received any offers yet. List it on the marketplace to attract buyers!"})]}):A.jsx("div",{className:"offers-list",children:o.map((e,a)=>A.jsxs("div",{className:"offer-card "+(0===a?"highest-offer":""),children:[A.jsxs("div",{className:"offer-header",children:[A.jsxs("div",{className:"buyer-info",children:[A.jsx("strong",{children:e.buyer}),0===a&&A.jsx("span",{className:"highest-badge",children:"🏆 Highest"})]}),A.jsx("div",{className:"offer-time",children:x(e.timestamp)})]}),A.jsxs("div",{className:"offer-price",children:[A.jsx("span",{className:"price-amount",children:parseFloat(e.price).toFixed(2)}),A.jsx("span",{className:"price-symbol",children:e.symbol})]}),e.memo&&A.jsx("div",{className:"offer-memo",children:A.jsxs("em",{children:['"',e.memo,'"']})}),A.jsx("div",{className:"offer-actions",children:A.jsx("button",{className:"accept-btn",onClick:()=>(async e=>{if(!n||!i||!s)return void alert("Please connect your wallet first");if(window.confirm(`Accept offer of ${e.price} ${e.symbol} from ${e.buyer}?\n\nThis action cannot be undone.`)){p(e.id);try{if(!i)return void c("Wallet Not Connected","Please connect your wallet to accept offers.");await jt.acceptBuyOffer(i,e.id),l("Offer Accepted!",`${e.price} ${e.symbol} will be transferred to your account.`),t()}catch(a){c("Failed to Accept Offer",a instanceof Error?a.message:"Failed to accept the offer. Please try again.")}finally{p(null)}}})(e),disabled:null!==h,children:h===e.id?"Accepting...":"Accept Offer"})})]},e.id))})]})]}),A.jsx("div",{className:"modal-footer",children:A.jsx("button",{className:"btn-secondary",onClick:t,children:"Close"})})]})}):null};class Nt{static BLEND_CONTRACT="blend.nefty";static ATOMIC_ASSETS_CONTRACT="atomicassets";static PXJ_CONTRACT="pixeljourney";static RECYCLE_BLEND_ID=37700;static RECYCLE_COST="12000.00000000 PXJ";static PACK_TEMPLATE_ID="820134";static PACK_RECIPE_ID=37701;static GENERIC_PACK_BLEND_ID=37702;static async recyclePixal(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.BLEND_CONTRACT,name:"openbal",authorization:[{actor:t,permission:"active"}],data:{owner:t,token_symbol:"8,PXJ"}},{account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,quantity:this.RECYCLE_COST,memo:"deposit"}},{account:this.BLEND_CONTRACT,name:"announcedepo",authorization:[{actor:t,permission:"active"}],data:{owner:t,count:1}},{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"deposit"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.RECYCLE_BLEND_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async unpackPixelIngredientPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"unpack"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.PACK_RECIPE_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async unpackGenericPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:this.BLEND_CONTRACT,asset_ids:[e],memo:"unpack"}},{account:this.BLEND_CONTRACT,name:"nosecfuse",authorization:[{actor:t,permission:"active"}],data:{claimer:t,blend_id:this.GENERIC_PACK_BLEND_ID,transferred_assets:[e],own_assets:[]}}],transaction_extensions:[]}}static async getBlockInfo(){try{const t=[te.WAX_CHAIN.EOSRIO,te.WAX_CHAIN.WAXSWEDEN,te.WAX_CHAIN.GREYMASS];for(const a of t)try{const e=await fetch(`${a}/v1/chain/get_info`,{method:"GET",headers:{Accept:"application/json"}});if(!e.ok)continue;const t=await e.json(),s=t.head_block_id,n=65535&t.last_irreversible_block_num,i=s.match(/.{2}/g)?.slice(4,8)||["00","00","00","00"];return{ref_block_num:n,ref_block_prefix:parseInt(i.reverse().join(""),16)}}catch(e){q.warn("Failed to fetch block info from endpoint","NEFTY_BLEND",{endpoint:a,error:e});continue}throw new Error("All WAX endpoints failed")}catch(t){W.logError("NeftyBlendService.getBlockInfo",t);const e=Date.now();return{ref_block_num:e/500&65535,ref_block_prefix:4294967295&e}}}static getExpirationTime(){return new Date((new Date).getTime()+18e5).toISOString().slice(0,-5)}static async executeRecycle(e,t){try{if(!t||!t.transact)throw new Error("Wallet not connected or does not support transactions");const a=await t.transact({actions:e.actions});return q.info("Recycle transaction successful","NEFTY_BLEND",{result:a}),!0}catch(a){throw W.logError("NeftyBlendService.executeRecycle",a,{blendId:this.RECYCLE_BLEND_ID,recycleCost:this.RECYCLE_COST,actionsCount:e.actions.length,walletActor:t.actor}),a}}static async executeUnpack(e,t){try{if(!t||!t.transact)throw new Error("Wallet not connected or does not support transactions");const a=await t.transact({actions:e.actions});return q.info("Unpack transaction successful","NEFTY_BLEND",{result:a}),a}catch(a){throw W.logError("NeftyBlendService.executeUnpack",a,{actionsCount:e.actions.length,walletActor:t.actor}),a}}static isPackNFT(e){if(!e||!e.template)return!1;const t=(e.template.name||"").toLowerCase(),a=["pack","container","box","chest"].some(e=>t.includes(e)),s=e.template?.template_id===this.PACK_TEMPLATE_ID;return a||s}static getPackType(e){return this.isPackNFT(e)?e.template?.template_id===this.PACK_TEMPLATE_ID?"pixel_ingredient":"generic":null}static async unpackPixelPack(e,t){const a=await this.getBlockInfo();return{expiration:this.getExpirationTime(),ref_block_num:a.ref_block_num,ref_block_prefix:a.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"neftyblocksp",asset_ids:[e],memo:"unbox"}}],transaction_extensions:[]}}static async unpackPixelPacksBulk(e,t){const a=[];for(let s=0;s<e.length;s+=20){const n=e.slice(s,s+20),i=await this.getBlockInfo(),r={expiration:this.getExpirationTime(),ref_block_num:i.ref_block_num,ref_block_prefix:i.ref_block_prefix,max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:n.map(e=>({account:this.ATOMIC_ASSETS_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"neftyblocksp",asset_ids:[e],memo:"unbox"}})),transaction_extensions:[]};a.push(r)}return a}static isPixelPack(e){return e.template?.template_id===this.PACK_TEMPLATE_ID}}const wt=({isOpen:e,onClose:t,selectedNFTs:s,userAccount:n,walletSession:i,onUnpackComplete:r})=>{const[l,c]=a.useState(!1),o=s.filter(e=>Nt.isPackNFT(e));if(!e)return null;const d=o.length>0;return A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"modal-content unpack-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Unpack NFT"}),A.jsx("button",{className:"modal-close",onClick:t,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"unpack-nft-info",children:[A.jsxs("h3",{children:["Selected Pack NFTs (",o.length,")"]}),o.map(e=>A.jsxs("div",{className:"nft-item",children:[A.jsx("div",{className:"nft-image",children:A.jsx("img",{src:e.img,alt:e.name})}),A.jsxs("div",{className:"nft-details",children:[A.jsx("h4",{children:e.name}),A.jsx("p",{className:"collection-name",children:"string"==typeof e.collection?e.collection:e.collection?.collection_name||e.collection?.name||"Unknown"}),A.jsx("p",{className:"schema-name",children:e.schema.schema_name}),e.mint_number&&A.jsxs("p",{className:"mint-number",children:["Mint #",e.mint_number]})]})]},e.asset_id))]}),d?A.jsxs("div",{className:"unpack-info",children:[A.jsxs("div",{className:"info-box",children:[A.jsx("h4",{children:"📦 Pack Contents"}),A.jsxs("div",{className:"pack-contents",children:[A.jsx("p",{children:"These packs contain random rewards that will be revealed upon unpacking."}),A.jsx("p",{className:"warning",children:"⚠️ Unpacking will burn these packs permanently!"})]})]}),A.jsx("button",{className:"unpack-btn",onClick:async()=>{if(!n||!i)return void alert("Wallet not connected");if(0===o.length)return void alert("No pack NFTs selected");c(!0);const e=[];try{for(const t of o){let a;a="pixel_ingredient"===Nt.getPackType(t)?await Nt.unpackPixelIngredientPack(t.asset_id,n):await Nt.unpackGenericPack(t.asset_id,n);const s=await Nt.executeUnpack(a,i);e.push({nft:t,transaction:s,success:!0})}alert("Packs unpacked successfully!"),r()}catch(t){console.error("Error unpacking NFTs:",t),alert("Failed to unpack NFTs. Please try again.")}finally{c(!1)}},disabled:l||!i,children:l?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"loading-spinner small"}),"Unpacking..."]}):`📦 Unpack ${o.length} Pack${o.length>1?"s":""}`})]}):A.jsx("div",{className:"cannot-unpack",children:A.jsxs("div",{className:"info-box error",children:[A.jsx("h4",{children:"❌ Cannot Unpack"}),A.jsx("p",{children:"No pack NFTs selected for unpacking."}),A.jsx("p",{children:"Only packs, chests, boxes, and containers can be unpacked."})]})})]})]})})},kt=({children:e})=>{const[t,s]=a.useState({isConnected:!1,account:null,session:null,login:async()=>null,logout:async()=>{},transact:async()=>null,purchaseNFT:async()=>null,batchPurchaseNFTs:async()=>null,isLoading:!0}),[n,i]=a.useState(!0);a.useEffect(()=>Ie.subscribe(e=>{s({...e,isLoading:!1}),i(!1)}),[]);const r={...t,isLoading:n};return A.jsx(M.Provider,{value:r,children:e})},_t=()=>{const e=a.useContext(M);if(void 0===e)throw new Error("useWallet must be used within a WalletProvider");return e},St=({nfts:e,isOpen:t,onClose:s,onSuccess:n})=>{const{showSuccess:i,showError:r}=_e(),l=_t(),[c,o]=a.useState(""),[d,u]=a.useState(0),[m,h]=a.useState(1),[p,f]=a.useState(0),[x,g]=a.useState(0),[v,y]=a.useState(""),[j,b]=a.useState(!1),[N,w]=a.useState("name_asc");a.useEffect(()=>{t&&(o(""),u(0),h(1),f(0),g(0),y(""),b(!1))},[t]);const k=a.useMemo(()=>{const t=[...e];switch(N){case"name_asc":return t.sort((e,t)=>(e.name||"").localeCompare(t.name||""));case"name_desc":return t.sort((e,t)=>(t.name||"").localeCompare(e.name||""));case"collection_asc":return t.sort((e,t)=>e.collection.collection_name.localeCompare(t.collection.collection_name));case"collection_desc":return t.sort((e,t)=>t.collection.collection_name.localeCompare(e.collection.collection_name));case"mint_asc":return t.sort((e,t)=>(e.mint_number||0)-(t.mint_number||0));case"mint_desc":return t.sort((e,t)=>(t.mint_number||0)-(e.mint_number||0));default:return t}},[e,N]),_=()=>7*d*24*3600+24*m*3600+3600*p+60*x,S=(e,t)=>{const a=Math.max(0,Math.min(t,C(e)));switch(e){case"weeks":u(a);break;case"days":h(a);break;case"hours":f(a);break;case"minutes":g(a)}},C=e=>{switch(e){case"weeks":return 4;case"days":return 30;case"hours":return 23;case"minutes":return 59;default:return 0}},E=()=>{const e=[];return d>0&&e.push(`${d}w`),m>0&&e.push(`${m}d`),p>0&&e.push(`${p}h`),x>0&&e.push(`${x}m`),e.length>0?e.join(" "):"0m"};return t?A.jsx("div",{className:"modal-overlay",onClick:s,children:A.jsxs("div",{className:"modal-content bulk-auction-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Create Bulk Auction"}),A.jsx("button",{className:"modal-close",onClick:s,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"selected-nfts-section",children:[A.jsxs("div",{className:"selected-nfts-header",children:[A.jsxs("h3",{children:["Selected NFTs (",e.length,")"]}),e.length>1&&A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"auction-sort",children:"Sort by:"}),A.jsxs("select",{id:"auction-sort",className:"sort-select",value:N,onChange:e=>w(e.target.value),children:[A.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),A.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),A.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),A.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),A.jsx("option",{value:"mint_asc",children:"Mint # (Low-High)"}),A.jsx("option",{value:"mint_desc",children:"Mint # (High-Low)"})]})]})]}),A.jsxs("div",{className:"selected-nfts-grid",children:[k.slice(0,6).map(e=>A.jsxs("div",{className:"selected-nft-item",children:[A.jsx("div",{className:"nft-image-container",children:A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name||`Asset #${e.asset_id}`,className:"nft-image"})}),A.jsxs("div",{className:"nft-info",children:[A.jsx("span",{className:"nft-name",children:e.name}),A.jsx("span",{className:"nft-collection",children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"})]})]},e.asset_id)),e.length>6&&A.jsxs("div",{className:"more-nfts-indicator",children:["+",e.length-6," more"]})]})]}),A.jsxs("div",{className:"auction-settings",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"startingPrice",children:"Starting Price (WAX)"}),A.jsx("input",{type:"number",id:"startingPrice",value:c,onChange:e=>o(e.target.value),placeholder:"Enter starting price",min:"0",step:"0.01",disabled:j})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Auction Duration"}),A.jsxs("div",{className:"duration-inputs",children:[A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Weeks"}),A.jsx("input",{type:"number",className:"duration-input",value:d,onChange:e=>S("weeks",parseInt(e.target.value)||0),min:"0",max:C("weeks"),disabled:j})]}),A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Days"}),A.jsx("input",{type:"number",className:"duration-input",value:m,onChange:e=>S("days",parseInt(e.target.value)||0),min:"0",max:C("days"),disabled:j})]}),A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Hours"}),A.jsx("input",{type:"number",className:"duration-input",value:p,onChange:e=>S("hours",parseInt(e.target.value)||0),min:"0",max:C("hours"),disabled:j})]}),A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Minutes"}),A.jsx("input",{type:"number",className:"duration-input",value:x,onChange:e=>S("minutes",parseInt(e.target.value)||0),min:"0",max:C("minutes"),disabled:j})]})]}),A.jsxs("div",{className:"duration-summary",children:[A.jsx("span",{className:"duration-display",children:E()}),A.jsxs("span",{className:"duration-total",children:["(",_().toLocaleString(),"s)"]})]})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"auctionMemo",children:"Memo (Optional)"}),A.jsx("textarea",{id:"auctionMemo",value:v,onChange:e=>y(e.target.value),placeholder:"Add a note about this auction batch...",rows:3,maxLength:256,disabled:j})]})]})]}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"cancel-btn",onClick:s,disabled:j,children:"Cancel"}),A.jsx("button",{className:"create-btn",onClick:async()=>{if(!c||parseFloat(c)<=0)return void r("Invalid Price","Please enter a valid starting price");const t=_();if(t<3600)r("Invalid Duration","Auction duration must be at least 1 hour");else if(t>2592e3)r("Invalid Duration","Auction duration cannot exceed 30 days");else{b(!0);try{const a=`${parseFloat(c).toFixed(8)} WAX`,r=e.map(e=>({account:"atomicmarket",name:"announceauct",authorization:[{actor:l.account||"",permission:"active"}],data:{seller:l.account||"",asset_ids:[parseInt(e.asset_id)],starting_bid:a,duration:t,maker_marketplace:"market.pxj"}}));await l.transact(r);const o=E();i("Bulk Auction Created",`Successfully created auctions for ${e.length} NFT${1!==e.length?"s":""} with starting price ${c} WAX and duration ${o}. Remember to transfer your assets to the atomicmarket contract to activate the auctions.`),n(),s()}catch(a){console.error("Bulk auction creation failed:",a),r("Auction Creation Failed",a instanceof Error?a.message:"Failed to create bulk auctions. Please try again.")}finally{b(!1)}}},disabled:j||!c||parseFloat(c)<=0||_()<3600,children:j?"Creating...":`Create ${e.length} Auction${1!==e.length?"s":""}`})]})]})}):null},Ct=s.memo(({imageUrl:e,videoUrl:t,alt:s,className:n="",loading:i="lazy",enableAnimations:r=!0,placeholder:l,onLoad:c,onError:o})=>{const[d,u]=a.useState(!1),[m,h]=a.useState(!1),[p,f]=a.useState("eager"===i),x=a.useRef(null),g=a.useRef(null),v=e=>e?"string"!=typeof e?null:e.startsWith("http")?e:e.startsWith("Qm")?`${te.IPFS.GATEWAYS[0]}${e}`:e:null,y=v(t),j=v(e),b=()=>{if(l)return l;return`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#f8fafc"/>\n      <rect x="50" y="80" width="100" height="8" rx="4" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" repeatCount="indefinite"/>\n      </rect>\n      <rect x="60" y="100" width="80" height="6" rx="3" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" begin="0.3s" repeatCount="indefinite"/>\n      </rect>\n      <rect x="70" y="120" width="60" height="6" rx="3" fill="#e2e8f0">\n        <animate attributeName="opacity" values="0.5;1;0.5" dur="1.5s" begin="0.6s" repeatCount="indefinite"/>\n      </rect>\n    </svg>')}`},N=()=>`data:image/svg+xml;base64,${btoa('<svg width="200" height="200" xmlns="http://www.w3.org/2000/svg">\n      <rect width="200" height="200" fill="#fef2f2"/>\n      <circle cx="100" cy="80" r="20" fill="#fca5a5"/>\n      <text x="100" y="85" text-anchor="middle" font-family="Arial" font-size="16" fill="#dc2626">!</text>\n      <text x="100" y="120" text-anchor="middle" font-family="Arial" font-size="12" fill="#991b1b">Failed to load</text>\n    </svg>')}`;a.useEffect(()=>{if("eager"===i||p)return;const e=new IntersectionObserver(([t])=>{t.isIntersecting&&(f(!0),e.disconnect())},{rootMargin:"50px"}),t=x.current||g.current;return t&&e.observe(t),()=>e.disconnect()},[i,p]);const w=()=>{u(!0),h(!1),c?.()},k=()=>{h(!0),u(!1),o?.()};return p&&(d||m)?m?A.jsx("img",{src:N(),alt:`Error loading ${s}`,className:n,style:{width:"100%",height:"100%",objectFit:"cover"}}):y&&r&&d?A.jsxs("video",{ref:g,className:n,muted:!0,loop:!0,autoPlay:!0,poster:j||void 0,style:{width:"100%",height:"100%",objectFit:"cover",opacity:d?1:0,transition:"opacity 0.3s ease"},children:[A.jsx("source",{src:y,type:"video/mp4"}),A.jsx("source",{src:y,type:"video/webm"})]}):A.jsx("img",{ref:x,src:j||N(),alt:s,className:n,style:{width:"100%",height:"100%",objectFit:"cover",opacity:d?1:0,transition:"opacity 0.3s ease"}}):A.jsxs("div",{className:`progressive-image-container ${n}`,children:[A.jsx("img",{ref:x,src:b(),alt:`Loading ${s}`,className:"progressive-image-placeholder",style:{width:"100%",height:"100%",objectFit:"cover",filter:"blur(2px)",transition:"filter 0.3s ease"}}),p&&j&&A.jsx("img",{src:j,alt:s,style:{display:"none"},onLoad:w,onError:k}),p&&y&&r&&A.jsx("video",{ref:g,src:y,style:{display:"none"},onLoadedData:w,onError:k,muted:!0,loop:!0})]})});Ct.displayName="ProgressiveImage";const At=a.memo(({nft:e,isMultiSelectMode:t,isSelected:a,settings:s,dropdownOpen:n,onNFTClick:i,onCollectionClick:r,onSchemaClick:l,onToggleSelection:c,onDropdownToggle:o,onListingOpen:d,onTransferOpen:u,onBurnOpen:m,onAuctionOpen:h,onRecyclePixal:p,onCraftingOpen:f,onViewOffers:x,onUnpackPixelPack:g})=>{const v=n===e.asset_id,y="pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name,j="pixeljourney"===e.collection.collection_name&&"ingredients"===e.schema.schema_name,b=ae.isValidWaxRock(e.data.WaxRock);return A.jsxs("div",{className:`inventory-page-card ${t?"selectable":""} ${a?"selected":""}`,children:[t&&A.jsx("div",{className:"selection-checkbox",children:A.jsx("input",{type:"checkbox",checked:a,onChange:()=>c(e.asset_id),onClick:e=>e.stopPropagation()})}),A.jsx("div",{className:"inventory-page-media",onClick:()=>i(e),children:A.jsx(Ct,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name,className:"inventory-media",loading:"lazy",enableAnimations:s.enableAnimatedNFTs})}),A.jsxs("div",{className:"inventory-page-info",children:[A.jsx("h3",{className:"inventory-page-name",onClick:()=>i(e),children:e.name}),A.jsxs("div",{className:"inventory-page-details",children:[A.jsx("span",{className:"inventory-page-collection",onClick:()=>r(e.collection.collection_name),children:"string"==typeof e.collection?e.collection:e.collection?.name||e.collection?.collection_name||"Unknown"}),A.jsx("span",{className:"inventory-page-schema",onClick:()=>l(e.schema.schema_name),children:e.schema.schema_name}),e.mint_number&&A.jsxs("span",{className:"inventory-page-mint",children:["#",e.mint_number]})]}),A.jsxs("div",{className:"inventory-page-actions",children:[A.jsxs("div",{className:"basic-actions",children:[A.jsx("button",{className:"inv-action-btn list-btn",onClick:t=>{t.stopPropagation(),d(e)},title:"List for Sale",children:"💰"}),A.jsx("button",{className:"inv-action-btn transfer-btn",onClick:t=>{t.stopPropagation(),u(e)},title:"Transfer",children:"📤"}),A.jsx("button",{className:"inv-action-btn offers-btn",onClick:t=>{t.stopPropagation(),x(e)},title:"View Offers",children:"👁️"})]}),A.jsxs("div",{className:"more-actions-dropdown","data-dropdown-id":e.asset_id,children:[A.jsx("button",{className:"more-actions-btn",onClick:t=>{t.stopPropagation(),o(e.asset_id)},title:"More Actions",children:"⋮"}),v&&A.jsxs("div",{className:"inv-dropdown-menu",children:[A.jsx("button",{className:"inv-dropdown-item auction-item",onClick:t=>{t.stopPropagation(),h(e)},children:"🏆 Create Auction"}),!b&&A.jsx("button",{className:"inv-dropdown-item burn-item",onClick:t=>{t.stopPropagation(),m(e)},children:"🔥 Burn"}),y&&!b&&A.jsx("button",{className:"inv-dropdown-item recycle-item",onClick:t=>{t.stopPropagation(),p(e)},children:"♻️ Recycle"}),(y||j)&&A.jsxs("button",{className:"inv-dropdown-item craft-item",onClick:t=>{t.stopPropagation(),f(e)},children:["🔨 ",j?"Craft with Ingredient":"Craft"]}),Nt.isPixelPack(e)&&A.jsx("button",{className:"inv-dropdown-item unpack-item",onClick:t=>{t.stopPropagation(),g(e)},children:"📦 Unpack"})]})]})]})]})]})}),Et=()=>{const e=i(),{settings:t}=ue(),{showSuccess:s,showError:n,confirm:r}=_e(),[l,c]=a.useState([]),[o,d]=a.useState(!1),[u,m]=a.useState(!1),[h,p]=a.useState(!1),[f,x]=a.useState(!1),[g,v]=a.useState(!1),[y,j]=a.useState(!1),[b,N]=a.useState(!1),[w,k]=a.useState(!1),[_,S]=a.useState(!1),[C,E]=a.useState(!1),[P,T]=a.useState(!1),[I,F]=a.useState(!1),[$,L]=a.useState(null),[M,W]=a.useState(new Set),[O,D]=a.useState(!1),[B,U]=a.useState(null),[z,X]=a.useState(!1),[H,q]=a.useState(null),[V,Y]=a.useState(!1),[Q,Z]=a.useState(null),[ee,te]=a.useState(""),[se,ne]=a.useState(""),[ie,re]=a.useState([]),[le,ce]=a.useState("all"),[oe,de]=a.useState("all"),[me,he]=a.useState("name_asc"),[pe,fe]=a.useState(""),[xe,ge]=a.useState([]),[ve,je]=a.useState(1),[be,Ne]=a.useState(!1),[we,ke]=a.useState(!1),[Se,Ce]=a.useState(!1),Ae=50,[Ee,Pe]=a.useState(1),{isConnected:Te,account:Ie,login:Fe,session:$e}=R(),Le=a.useCallback(async(e=1,t=!1)=>{if(Ie)if(o||we)J("Skipping loadInventory - already loading","Inventory");else{1===e?(d(!0),je(1)):ke(!0);try{let a,s;J("Loading inventory","Inventory",{filter:le,page:e,ITEMS_PER_PAGE:Ae});const n=(e-1)*Ae;switch(le){case"pixals":s=await ye.getUserInventoryBySchema(Ie,"pixeljourney","pixals",1e3,n);break;case"ingredients":s=await ye.getUserInventoryBySchema(Ie,"pixeljourney","ingredients",1e3,n);break;case"waxrock":s=await ye.getUserInventoryWaxRocks(Ie,1e3,n);break;default:{const t="all"!==oe?oe:void 0;s=await ye.getUserInventoryWithFilter(Ie,e,1e3,t);break}}a={data:s.assets||[],hasMore:s.hasMore,totalCount:s.total||0},J("Inventory Response","Inventory",{itemsReceived:a?.data?.length||0,totalAvailable:a?.totalCount||"unknown",hasMore:a?.hasMore});let i=a.data.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image||e.img,video:e.video||e.traits?.video||e.data?.video||void 0,collection:{name:e.collection||e.collection_name,collection_name:e.collection||e.collection_name},schema:{schema_name:e.schema||e.schema_name},template:{template_id:e.template_id||e.template?.template_id||"0",max_supply:e.max_supply||e.template?.max_supply||"0"},data:e.traits||e.data||{},mint_number:e.template_mint||e.mint_number}));if(1===e&&"all"===le){const e=[...new Set(i.map(e=>e.collection.collection_name).filter(e=>"string"==typeof e&&""!==e.trim()))].sort();ge(e)}t&&e>1?(c(e=>[...e,...i]),je(e)):(c(i),je(1)),Ne(a.hasMore)}catch(a){K("Error loading inventory","Inventory",a);const s=a instanceof Error?a.message:"Unknown error occurred";1!==e||t?G("Failed to load more inventory items","Inventory",{errorMessage:s}):(c([]),G("Failed to load inventory","Inventory",{errorMessage:s})),Ne(!1)}finally{d(!1),ke(!1)}}},[Ie,le,oe,Ae]);a.useEffect(()=>{Te&&Ie&&(J("Inventory reload triggered","Inventory",{filter:le,selectedCollection:oe}),Le(1,!1))},[Te,Ie,le,oe]);const Me=a.useCallback(()=>{be&&!we&&Ie&&Le(ve+1,!0)},[be,we,ve,Ie,Le]),Re=a.useCallback(async()=>{if(!be||Se||!Ie)return void J("LoadAll skipped","Inventory",{hasMore:be,loadingAll:Se,account:Ie});Ce(!0),J("Starting loadAllItems with concurrent requests","Inventory",{currentInventoryLength:l.length,hasMore:be,currentPage:ve});let e=ve+1,t=[],a=!0,s=0;try{for(;a&&s<50;){const n=[],i=[];for(let t=0;t<2&&a;t++){const a=e+t;i.push(a);const s=(async()=>{const e=(a-1)*Ae;try{switch(le){case"pixals":return await ye.getUserInventoryBySchema(Ie,"pixeljourney","pixals",1e3,e);case"ingredients":return await ye.getUserInventoryBySchema(Ie,"pixeljourney","ingredients",Ae,e);case"waxrock":return await ye.getUserInventoryWaxRocks(Ie,1e3,e);default:{const e="all"!==oe?oe:void 0;return await ye.getUserInventoryWithFilter(Ie,a,Ae,e)}}}catch(t){return K("Error in individual request","Inventory",t instanceof Error?t:new Error(String(t))),{assets:[],total:0,hasMore:!1}}})();n.push(s)}J("LoadAll Concurrent Batch","Inventory",{pages:i,currentItems:l.length+t.length});const r=await Promise.allSettled(n);s+=r.length;let o=!1;for(let e=0;e<r.length;e++){const s=r[e],n=i[e];if("fulfilled"===s.status){const e=s.value;if(J("LoadAll Response","Inventory",{page:n,items:e?.assets?.length||0,hasMore:e?.hasMore,total:e?.total}),e&&e.assets&&e.assets.length>0){o=!0;let a=e.assets.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image,video:e.video||e.traits?.video||void 0,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:e.max_supply||"0"},data:e.traits||{},mint_number:e.template_mint}));"waxrock"===le&&(a=a.filter(e=>{const t=e.data.WaxRock;return"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name&&t&&"none"!==t})),t.push(...a)}e&&e.hasMore||(a=!1)}else K("LoadAll Request Failed","Inventory",new Error(`Page ${n}: ${s.reason}`))}o||(a=!1,J("No more items found, stopping LoadAll","Inventory")),e+=2,t.length>0&&(c(e=>{const a=[...e,...t];return J("Updated inventory","Inventory",{previousCount:e.length,newCount:a.length,addedCount:t.length}),a}),je(e-1),t=[]),a&&await new Promise(e=>setTimeout(e,100))}J("LoadAll Complete with concurrent requests","Inventory",{totalItems:l.length,totalRequests:s}),Ne(!1)}catch(n){K("Error loading all items","Inventory",n);const e=n instanceof Error?n.message:"Unknown error occurred";G("Failed to load all inventory items","Inventory",{errorMessage:e}),Ne(!1)}finally{Ce(!1)}},[be,Se,Ie,ve,Ae,le,oe,l.length]);a.useEffect(()=>{const e=e=>{B&&!e.target.closest(".more-actions-dropdown")&&U(null)},t=()=>{if(B){const e=document.querySelector(`[data-dropdown-id="${B}"] .inv-dropdown-menu`);if(e){const t=e.getBoundingClientRect(),a=window.innerWidth;e.classList.remove("dropdown-left","dropdown-down"),t.right>a&&e.classList.add("dropdown-left"),t.top<0&&e.classList.add("dropdown-down")}}};return document.addEventListener("mousedown",e),B&&setTimeout(t,0),()=>document.removeEventListener("mousedown",e)},[B]);const We=t=>{e(`/assets/${t.asset_id}`)},Oe=t=>{e(`/marketplace?collection=${t}`)},De=t=>{e(`/marketplace?schema=${t}`)},Be=e=>{const t=new Set(M);t.has(e)?t.delete(e):t.add(e),W(t)},Ue=()=>{if(0===M.size)return;0!==l.filter(e=>M.has(e.asset_id)).filter(e=>Nt.isPackNFT(e)).length?E(!0):n("No pack NFTs selected. Only packs, chests, boxes, and containers can be unpacked.")},ze=async()=>{if(0===M.size)return;if(!Ie||!$e)return void n("Wallet Required","Please connect your wallet first");const e=l.filter(e=>M.has(e.asset_id)).filter(e=>Nt.isPixelPack(e));if(0!==e.length)try{if(!(await r("Confirm Bulk Unpack",`Are you sure you want to unpack ${e.length} pixelpack(s)?\n\nThis action cannot be undone and will be processed in batches of 20.`,"Unpack All","Cancel")))return;const t=e.map(e=>e.asset_id),a=await Nt.unpackPixelPacksBulk(t,Ie);for(let e=0;e<a.length;e++){const t=a[e];s(`Processing batch ${e+1} of ${a.length}...`,"Bulk Unpack"),await Nt.executeUnpack(t,$e)}s("Bulk Unpack Successful",`Successfully unpacked ${e.length} pixelpack(s)!`),W(new Set),await Le()}catch(t){K("Bulk unpack failed","Inventory",t),n("Bulk Unpack Failed",t instanceof Error?t.message:"Unknown error occurred")}else n("No pixelpack NFTs selected","Please select pixelpack items to unpack.")};a.useEffect(()=>{const e=setTimeout(()=>{ne(ee)},300);return()=>clearTimeout(e)},[ee]);const Xe=a.useCallback(e=>{if(!e||e.length<2)return[];const t=new Map,a=e.toLowerCase();return l.forEach(e=>{if(e.name.toLowerCase().includes(a)){const a=`name:${e.name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.name,type:"name",count:1})}if(e.collection.collection_name.toLowerCase().includes(a)){const a=`collection:${e.collection.collection_name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.collection.collection_name,type:"collection",count:1})}if(e.schema.schema_name.toLowerCase().includes(a)){const a=`schema:${e.schema.schema_name}`;if(t.has(a)){const e=t.get(a);e.count=(e.count||0)+1}else t.set(a,{text:e.schema.schema_name,type:"schema",count:1})}}),Array.from(t.values()).sort((e,t)=>(t.count||0)-(e.count||0)).slice(0,8)},[l]);a.useEffect(()=>{const e=Xe(ee);re(e)},[ee,Xe]);const He=a.useMemo(()=>l.filter(e=>{const t=""===se||e.name.toLowerCase().includes(se.toLowerCase())||e.collection.collection_name.toLowerCase().includes(se.toLowerCase())||e.schema.schema_name.toLowerCase().includes(se.toLowerCase()),a="all"===le||"pixals"===le&&"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name||"waxrock"===le&&"pixeljourney"===e.collection.collection_name&&"pixals"===e.schema.schema_name&&e.data?.WaxRock&&"none"!==e.data.WaxRock||"ingredients"===le&&"pixeljourney"===e.collection.collection_name&&"ingredients"===e.schema.schema_name||"packs"===le&&Nt.isPackNFT(e);return t&&a}).sort((e,t)=>{switch(me){case"name_asc":return e.name.localeCompare(t.name);case"name_desc":return t.name.localeCompare(e.name);case"collection_asc":return e.collection.collection_name.localeCompare(t.collection.collection_name);case"collection_desc":return t.collection.collection_name.localeCompare(e.collection.collection_name);case"mint_asc":return(e.mint_number||0)-(t.mint_number||0);case"mint_desc":return(t.mint_number||0)-(e.mint_number||0);default:return 0}}),[l,se,le,me]),qe=He.length;a.useEffect(()=>{const e=Math.ceil(qe/Ae);Pe(Math.max(1,e))},[qe]);const Je=a.useMemo(()=>{const e=(ve-1)*Ae,t=e+Ae;return He.slice(e,t)},[He,ve,Ae]),Ve=a.useCallback(()=>{ve<Ee&&je(e=>e+1)},[ve,Ee]),Ge=a.useCallback(()=>{ve>1&&je(e=>e-1)},[ve]);return a.useEffect(()=>{je(1)},[le,oe,se,me]),Te?A.jsxs("div",{className:"inventory-container",children:[A.jsxs("div",{className:"inventory-header",children:[A.jsx("h1",{className:"inventory-title",children:"My NFT Inventory"}),A.jsxs("p",{className:"inventory-subtitle",children:["Connected as: ",A.jsx("strong",{children:Ie})]})]}),A.jsxs("div",{className:"inventory-page-filters",children:[A.jsx(it,{searchTerm:ee,onSearchChange:e=>{te(e),je(1)},suggestions:ie,placeholder:"Search NFTs by name, collection, or schema...",showFilters:!1,className:"inventory-search"}),A.jsxs("div",{className:"inventory-controls",children:[A.jsxs("div",{className:"filter-tabs",children:[A.jsx("button",{className:"filter-tab "+("all"===le?"active":""),onClick:()=>{ce("all"),je(1)},children:"All NFTs"}),A.jsx("button",{className:"filter-tab "+("pixals"===le?"active":""),onClick:()=>{ce("pixals"),je(1)},children:"Pixals"}),A.jsx("button",{className:"filter-tab "+("waxrock"===le?"active":""),onClick:()=>{ce("waxrock"),je(1)},children:"WaxRock"}),A.jsx("button",{className:"filter-tab "+("ingredients"===le?"active":""),onClick:()=>{ce("ingredients"),je(1)},children:"Ingredients"}),A.jsx("button",{className:"filter-tab "+("packs"===le?"active":""),onClick:()=>{ce("packs"),je(1)},children:"Packs"})]}),"all"===le&&A.jsx("div",{className:"collection-filter-container",children:A.jsxs("div",{className:"collection-filter-dropdown",children:[A.jsx("input",{type:"text",placeholder:"Filter by collection...",value:pe,onChange:e=>fe(e.target.value),className:"collection-search-input"}),A.jsxs("select",{value:oe,onChange:e=>{de(e.target.value),je(1),Le(1,!1)},className:"collection-select",children:[A.jsx("option",{value:"",children:"All Collections"}),xe.filter(e=>"string"==typeof e&&e.toLowerCase().includes(pe.toLowerCase())).map(e=>A.jsx("option",{value:e,children:e},e))]})]})}),A.jsx("div",{className:"sort-container",children:A.jsxs("select",{value:me,onChange:e=>he(e.target.value),className:"sort-select",children:[A.jsx("option",{value:"name_asc",children:"Name (A-Z)"}),A.jsx("option",{value:"name_desc",children:"Name (Z-A)"}),A.jsx("option",{value:"collection_asc",children:"Collection (A-Z)"}),A.jsx("option",{value:"collection_desc",children:"Collection (Z-A)"}),A.jsx("option",{value:"mint_asc",children:"Mint Number (Low-High)"}),A.jsx("option",{value:"mint_desc",children:"Mint Number (High-Low)"})]})}),A.jsx("button",{className:"multi-select-toggle "+(O?"active":""),onClick:()=>{D(!O),W(new Set)},title:O?"Exit multi-select mode":"Enter multi-select mode",children:O?"✕ Exit Select":"☑ Multi-Select"})]}),O&&A.jsxs("div",{className:"bulk-actions-toolbar",children:[A.jsxs("div",{className:"selection-info",children:[A.jsxs("span",{children:[M.size," item",1!==M.size?"s":""," selected"]}),M.size>0&&A.jsx("button",{className:"clear-selection",onClick:()=>{W(new Set)},children:"Clear"}),A.jsx("button",{className:"select-all",onClick:()=>{const e=new Set(He.map(e=>e.asset_id));if(e.size>0&&[...e].every(e=>M.has(e))){const t=new Set(M);e.forEach(e=>t.delete(e)),W(t)}else{const t=new Set([...M,...e]);W(t)}},children:(()=>{const e=new Set(He.map(e=>e.asset_id));return e.size>0&&[...e].every(e=>M.has(e))?"Deselect All":"Select All"})()})]}),M.size>0&&A.jsxs("div",{className:"bulk-actions",children:[A.jsxs("button",{className:"bulk-btn list-btn",onClick:()=>{0!==M.size&&j(!0)},children:["💰 List (",M.size,")"]}),A.jsxs("button",{className:"bulk-btn auction-btn",onClick:()=>{0!==M.size&&T(!0)},children:["🏆 Auction (",M.size,")"]}),A.jsxs("button",{className:"bulk-btn transfer-btn",onClick:()=>{0!==M.size&&N(!0)},children:["📤 Transfer (",M.size,")"]}),A.jsxs("button",{className:"bulk-btn distribute-btn",onClick:()=>{0!==M.size&&k(!0)},children:["🎯 Distribute (",M.size,")"]}),A.jsxs("button",{className:"bulk-btn burn-btn",onClick:()=>{0!==M.size&&S(!0)},children:["🔥 Burn (",M.size,")"]}),(()=>{const e=l.filter(e=>M.has(e.asset_id)),t=e.filter(e=>Nt.isPackNFT(e)).length,a=e.filter(e=>Nt.isPixelPack(e)).length;return A.jsxs(A.Fragment,{children:[t>0&&A.jsxs("button",{className:"bulk-btn unpack-btn",onClick:Ue,children:["📦 Unpack (",t,")"]}),a>0&&A.jsxs("button",{className:"bulk-btn unpack-btn",onClick:ze,children:["📦 Unpack Pixelpacks (",a,")"]})]})})()]})]})]}),o&&A.jsxs("div",{className:"loading-container",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading your NFTs..."})]}),!o&&A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"inventory-page-stats",children:A.jsxs("p",{children:[qe," NFTs found"]})}),l.length>0?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"inventory-page-grid",children:Je.map(e=>A.jsx(At,{nft:e,isMultiSelectMode:O,isSelected:M.has(e.asset_id),settings:t,dropdownOpen:B,onNFTClick:We,onCollectionClick:Oe,onSchemaClick:De,onToggleSelection:Be,onDropdownToggle:e=>U(B===e?null:e),onListingOpen:e=>{L(e),p(!0)},onTransferOpen:e=>{L(e),x(!0)},onBurnOpen:e=>{L(e),v(!0)},onAuctionOpen:e=>{L(e),F(!0),U(null)},onRecyclePixal:e=>{(async e=>{if(Ie&&$e){if(ae.isPixalPFP(e.template.template_id)){const t=e.data?.WaxRock;if(t&&ae.isValidWaxRock(t))return void n("WaxRock Protection",`This is a rare WaxRock Pixal PFP (${t}) and cannot be recycled. WaxRock Pixals are protected from burning and recycling on our platform.`)}try{if(!(await r("Confirm Recycle",`Are you sure you want to recycle ${e.name}?\n\nThis will cost 12,000 PXJ tokens and cannot be undone.`,"Recycle","Cancel")))return;const t=await Nt.recyclePixal(e.asset_id,Ie);await Nt.executeRecycle(t,$e),s("Recycle Successful","Pixal recycled successfully!"),await Le()}catch(t){K("Recycle failed","Inventory",t),n("Recycle Failed",t instanceof Error?t.message:"Unknown error occurred")}}else n("Wallet Required","Please connect your wallet first")})(e),U(null)},onCraftingOpen:e=>{(e=>{q(e),X(!0)})(e),U(null)},onViewOffers:e=>{(e=>{Z(e),Y(!0)})(e),U(null)},onUnpackPixelPack:e=>{(async e=>{if(Ie&&$e)try{if(!(await r("Confirm Unpack",`Are you sure you want to unpack ${e.name}?\n\nThis action cannot be undone.`,"Unpack","Cancel")))return;const t=await Nt.unpackPixelPack(e.asset_id,Ie);await Nt.executeUnpack(t,$e),s("Unpack Successful","Pixelpack unpacked successfully!"),await Le()}catch(t){K("Unpack failed","Inventory",t),n("Unpack Failed",t instanceof Error?t.message:"Unknown error occurred")}else n("Wallet Required","Please connect your wallet first")})(e),U(null)}},e.asset_id))}),Ee>1&&A.jsxs("div",{className:"pagination-controls",children:[A.jsx("button",{className:"pagination-btn",onClick:Ge,disabled:1===ve,children:"← Previous"}),A.jsxs("div",{className:"pagination-info",children:[A.jsxs("span",{children:["Page ",ve," of ",Ee]}),A.jsxs("span",{className:"pagination-items",children:["(",qe," total items)"]})]}),A.jsx("button",{className:"pagination-btn",onClick:Ve,disabled:ve===Ee,children:"Next →"})]})]}):A.jsxs("div",{className:"empty-inventory",children:[A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"empty-icon",children:A.jsx("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M9 1v6m6-6v6"})}),A.jsx("h3",{children:"No NFTs Found"}),A.jsxs("p",{children:["You don't have any ","all"===le?"Pixel Journey":le," NFTs yet."]}),A.jsx("p",{children:"Visit the marketplace to start collecting!"}),("waxrock"===le||"pixals"===le||"ingredients"===le)&&A.jsx("div",{className:"empty-inventory-cta",style:{marginTop:"20px"},children:A.jsxs("button",{className:"cta-button",onClick:()=>{e(`/marketplace?category=${{waxrock:"waxrocks",pixals:"pixals",ingredients:"ingredients"}[le]}`)},style:{background:"linear-gradient(45deg, #4ecdc4, #45b7d1)",border:"none",padding:"12px 24px",borderRadius:"25px",color:"white",fontSize:"16px",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(78, 205, 196, 0.3)"},onMouseOver:e=>{e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 6px 20px rgba(78, 205, 196, 0.4)"},onMouseOut:e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 15px rgba(78, 205, 196, 0.3)"},children:["🛒 Browse ","waxrock"===le?"WaxRock":le.charAt(0).toUpperCase()+le.slice(1)," Marketplace"]})})]}),l.length>0&&A.jsx("div",{className:"load-more-container",children:be?A.jsxs(A.Fragment,{children:[A.jsx("button",{className:"load-more-btn",onClick:Me,disabled:we||Se,children:we?"Loading...":"Load More NFTs"}),A.jsx("button",{className:"load-more-btn load-all-btn",onClick:Re,disabled:we||Se,style:{marginLeft:"10px",backgroundColor:"var(--success-color)"},children:Se?"Loading All...":"Load All NFTs"})]}):A.jsxs("div",{className:"pagination-info",children:[A.jsxs("p",{children:["📄 Page ",ve," - All NFTs loaded (",l.length," total)"]}),A.jsx("p",{style:{fontSize:"0.9em",color:"var(--text-secondary)",marginTop:"5px"},children:"No more items to load"})]})})]}),A.jsx(et,{nft:$?{sale_id:"",asset_id:$.asset_id,name:$.name,image:$.img,video:$.video,price:"Not for sale",seller:Ie||"",collection:$.collection.collection_name,schema:$.schema.schema_name,template_mint:$.mint_number,max_supply:$.template.max_supply,traits:$.data}:null,isOpen:u,onClose:()=>m(!1)}),A.jsx(ct,{nft:$,isOpen:h,onClose:()=>{p(!1),L(null)},onSuccess:()=>{Le()}}),A.jsx(ot,{nft:$,isOpen:f,onClose:()=>{x(!1),L(null)},onSuccess:()=>{Le()}}),A.jsx(dt,{nft:$,isOpen:g,onClose:()=>{v(!1),L(null)},onSuccess:()=>{Le()}}),A.jsx(yt,{isOpen:z,onClose:()=>{X(!1),q(null)},ingredient:H}),A.jsx(bt,{nft:Q,isOpen:V,onClose:()=>{Y(!1),Z(null)}}),A.jsx(ut,{nfts:l.filter(e=>M.has(e.asset_id)),isOpen:y,onClose:()=>{j(!1)},onSuccess:()=>{W(new Set),D(!1),Le()}}),A.jsx(mt,{nfts:l.filter(e=>M.has(e.asset_id)),isOpen:b,onClose:()=>{N(!1)},onSuccess:()=>{W(new Set),D(!1),Le()}}),A.jsx(ht,{nfts:l.filter(e=>M.has(e.asset_id)),isOpen:w,onClose:()=>{k(!1)},onSuccess:()=>{W(new Set),D(!1),Le()}}),A.jsx(pt,{nfts:l.filter(e=>M.has(e.asset_id)),isOpen:_,onClose:()=>{S(!1)},onSuccess:()=>{W(new Set),D(!1),Le()}}),A.jsx(wt,{selectedNFTs:l.filter(e=>M.has(e.asset_id)),isOpen:C,onClose:()=>{E(!1)},userAccount:Ie||"",walletSession:$e,onUnpackComplete:()=>{W(new Set),D(!1),Le(1,!1),s("Packs unpacked successfully!")}}),A.jsx(St,{nfts:l.filter(e=>M.has(e.asset_id)),isOpen:P,onClose:()=>{T(!1)},onSuccess:()=>{W(new Set),D(!1),Le()}}),$&&A.jsx(St,{nfts:[$],isOpen:I,onClose:()=>{F(!1),L(null)},onSuccess:()=>{Le()}})]}):A.jsxs("div",{className:"inventory-page",children:[A.jsxs("div",{className:"inventory-page-header",children:[A.jsx("h1",{className:"inventory-page-title",children:"My NFT Inventory"}),A.jsx("p",{className:"inventory-page-subtitle",children:"View and manage your Pixel Journey NFTs"})]}),A.jsx("div",{className:"connect-wallet-prompt",children:A.jsxs("div",{className:"connect-wallet-card",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",className:"wallet-icon",children:[A.jsx("path",{d:"M21 12V7H5a2 2 0 0 1 0-4h14v4"}),A.jsx("path",{d:"M3 5v14a2 2 0 0 0 2 2h16v-5"}),A.jsx("circle",{cx:"18",cy:"12",r:"2"})]}),A.jsx("h3",{children:"Connect Your Wallet"}),A.jsx("p",{children:"Connect your wallet to view your NFT inventory and manage your Pixel Journey assets."}),A.jsx("button",{className:"btn-primary",onClick:Fe,children:"Connect Wallet"})]})})]})},Pt=s.memo(({text:e,maxLength:t=240,className:s=""})=>{const[n,i]=a.useState(!1);if(!e||e.length<=t)return A.jsx("span",{className:s,children:e});const r=e.slice(0,t).trim();return A.jsx("span",{className:s,children:n?A.jsxs(A.Fragment,{children:[e,A.jsx("button",{className:"read-more-btn collapse-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),i(!1)},children:"read less"})]}):A.jsxs(A.Fragment,{children:[r,r.endsWith(".")?"":"...",A.jsx("button",{className:"read-more-btn expand-btn",onClick:e=>{e.preventDefault(),e.stopPropagation(),i(!0)},children:"read more"})]})})});Pt.displayName="TruncatedText";const Tt=new class{requestQueue=[];isProcessing=!1;gatewayStats=new Map;MIN_REQUEST_INTERVAL=200;MAX_CONCURRENT_REQUESTS=3;MAX_RETRIES=3;GATEWAY_COOLDOWN=3e4;REQUEST_TIMEOUT=1e4;activeRequests=0;lastRequestTime=0;async requestImage(e){return new Promise((t,a)=>{const s={url:e,resolve:t,reject:a,retryCount:0,timestamp:Date.now()};this.requestQueue.push(s),this.processQueue()})}async processQueue(){if(!this.isProcessing&&0!==this.requestQueue.length){for(this.isProcessing=!0;this.requestQueue.length>0&&this.activeRequests<this.MAX_CONCURRENT_REQUESTS;){const e=this.requestQueue.shift();if(!e)break;if(Date.now()-e.timestamp>this.REQUEST_TIMEOUT){e.reject(new Error("Request timeout in queue"));continue}const t=Date.now()-this.lastRequestTime;if(t<this.MIN_REQUEST_INTERVAL){const e=this.MIN_REQUEST_INTERVAL-t;await this.delay(e)}this.lastRequestTime=Date.now(),this.activeRequests++,this.processRequest(e).finally(()=>{this.activeRequests--,setTimeout(()=>this.processQueue(),0)})}this.isProcessing=!1}}async processRequest(e){try{const t=this.selectBestGateway(e.url);if(!t)throw new Error("No available gateways");const a=await this.makeRequest(e.url,t);this.updateGatewayStats(t,!0),e.resolve(a)}catch(t){const a=this.extractGateway(e.url);if(a&&this.updateGatewayStats(a,!1),e.retryCount<this.MAX_RETRIES)e.retryCount++,q.warn(`Retrying IPFS request (${e.retryCount}/${this.MAX_RETRIES})`,"IPFSRateLimiter",{url:e.url,error:t instanceof Error?t.message:"Unknown error"}),await this.delay(1e3*e.retryCount),this.requestQueue.unshift(e);else{const a=t instanceof Error?t:new Error(String(t));q.error("IPFS request failed after all retries","IPFSRateLimiter",a,{url:e.url}),e.reject(a)}}}async makeRequest(e,t){const a=this.extractIPFSHash(e);if(!a)throw new Error("Invalid IPFS URL");const s=`${t}${a}`;return new Promise((e,t)=>{const a=new Image,n=setTimeout(()=>{a.onload=null,a.onerror=null,t(new Error("Request timeout"))},this.REQUEST_TIMEOUT);a.onload=()=>{clearTimeout(n),e(s)},a.onerror=e=>{clearTimeout(n),t(new Error(`Failed to load image: ${e}`))},a.src=s})}selectBestGateway(e){const t=Date.now(),a=["https://ipfs.io/ipfs/","https://gateway.pinata.cloud/ipfs/","https://dweb.link/ipfs/","https://cf-ipfs.com/ipfs/"].filter(e=>{const a=this.gatewayStats.get(e);return!a||!(a.isBlocked&&t<a.blockUntil)&&(a.isBlocked&&t>=a.blockUntil&&(a.isBlocked=!1,a.errorCount=0),!0)});return 0===a.length?null:(a.sort((e,t)=>{const a=this.gatewayStats.get(e),s=this.gatewayStats.get(t);return(a?a.errorCount/Math.max(a.requestCount,1):0)-(s?s.errorCount/Math.max(s.requestCount,1):0)}),a[0])}updateGatewayStats(e,t){let a=this.gatewayStats.get(e);if(a||(a={lastRequest:0,requestCount:0,errorCount:0,isBlocked:!1,blockUntil:0},this.gatewayStats.set(e,a)),a.lastRequest=Date.now(),a.requestCount++,!t){a.errorCount++;const t=a.errorCount/a.requestCount;t>.5&&a.requestCount>=5&&(a.isBlocked=!0,a.blockUntil=Date.now()+this.GATEWAY_COOLDOWN,q.warn("Blocking gateway due to high error rate","IPFSRateLimiter",{gateway:e,errorRate:t,requestCount:a.requestCount,errorCount:a.errorCount}))}}extractIPFSHash(e){const t=e.match(/\/ipfs\/([a-zA-Z0-9]+)/);return t?t[1]:null}extractGateway(e){const t=e.match(/(https?:\/\/[^\/]+\/ipfs\/)/);return t?t[1]:null}delay(e){return new Promise(t=>setTimeout(t,e))}getStatus(){return{queueLength:this.requestQueue.length,activeRequests:this.activeRequests,gatewayStats:Object.fromEntries(this.gatewayStats)}}reset(){this.requestQueue.forEach(e=>{e.reject(new Error("Rate limiter reset"))}),this.requestQueue=[],this.gatewayStats.clear(),this.activeRequests=0,this.isProcessing=!1}};const It=new class{imageCache=new Map;loadingPromises=new Map;MAX_CACHE_SIZE=500;generateFallbackSVG(e={}){const{width:t=150,height:a=150,backgroundColor:s="#f3f4f6",textColor:n="#6b7280",text:i,type:r="generic"}=e,l=i||this.getDefaultText(r),c=.15*Math.min(t,a),o=`\n      <svg width="${t}" height="${a}" xmlns="http://www.w3.org/2000/svg">\n        <rect width="100%" height="100%" fill="${s}"/>\n        <g transform="translate(${t/2}, ${a/2})">\n          ${this.getIconForType(r,.3*Math.min(t,a),n)}\n          <text \n            x="0" \n            y="${1.5*c}" \n            font-family="system-ui, -apple-system, sans-serif" \n            font-size="${c}" \n            font-weight="500" \n            fill="${n}" \n            text-anchor="middle" \n            dominant-baseline="middle"\n          >\n            ${l}\n          </text>\n        </g>\n      </svg>\n    `;return`data:image/svg+xml;base64,${btoa(o)}`}getDefaultText(e){switch(e){case"nft":return"NFT";case"collection":return"Collection";case"avatar":return"Avatar";case"token":return"Token";default:return"Image"}}getIconForType(e,t,a){const s=t,n=Math.max(1,.08*s);switch(e){case"nft":return`\n          <rect \n            x="${-s/2}" \n            y="${-s/2}" \n            width="${s}" \n            height="${s}" \n            rx="${.1*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <circle \n            cx="0" \n            cy="${.15*-s}" \n            r="${.15*s}" \n            fill="${a}"\n          />\n        `;case"collection":return`\n          <rect \n            x="${-s/2}" \n            y="${-s/2}" \n            width="${.7*s}" \n            height="${.7*s}" \n            rx="${.05*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <rect \n            x="${-s/2+.15*s}" \n            y="${-s/2+.15*s}" \n            width="${.7*s}" \n            height="${.7*s}" \n            rx="${.05*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n        `;case"avatar":return`\n          <circle \n            cx="0" \n            cy="${.1*-s}" \n            r="${.25*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <path \n            d="M ${.35*-s} ${.3*s} Q 0 ${.1*s} ${.35*s} ${.3*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n        `;case"token":return`\n          <circle \n            cx="0" \n            cy="0" \n            r="${.4*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <text \n            x="0" \n            y="${.1*s}" \n            font-family="system-ui, -apple-system, sans-serif" \n            font-size="${.3*s}" \n            font-weight="bold" \n            fill="${a}" \n            text-anchor="middle" \n            dominant-baseline="middle"\n          >\n            $\n          </text>\n        `;default:return`\n          <rect \n            x="${-s/2}" \n            y="${-s/2}" \n            width="${s}" \n            height="${s}" \n            rx="${.1*s}" \n            fill="none" \n            stroke="${a}" \n            stroke-width="${n}"\n          />\n          <path \n            d="M ${.2*-s} ${.1*-s} L ${.2*s} ${.1*-s} L 0 ${.2*s} Z" \n            fill="${a}"\n          />\n        `}}async loadImage(e,t={}){if(!e)return{success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0};const a=this.imageCache.get(e);if(a)return{success:!0,src:a,fallbackUsed:!1};const s=this.loadingPromises.get(e);if(s)return s;const n=this.performImageLoad(e,t);this.loadingPromises.set(e,n);try{return await n}finally{this.loadingPromises.delete(e)}}async performImageLoad(e,t){if(this.isIPFSUrl(e))try{const t=await(a=e,Tt.requestImage(a));return this.addToCache(e,t),{success:!0,src:t,fallbackUsed:!1}}catch(s){return q.warn(`IPFS rate-limited load failed: ${e}`,"ImageService",{error:s}),{success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0,error:s instanceof Error?s:new Error("IPFS load failed")}}var a;return new Promise(a=>{const s=new Image,n=setTimeout(()=>{s.onload=null,s.onerror=null,a({success:!1,src:this.generateFallbackSVG(t),fallbackUsed:!0,error:new Error("Image load timeout")})},1e4);s.onload=()=>{clearTimeout(n),this.addToCache(e,e),a({success:!0,src:e,fallbackUsed:!1})},s.onerror=s=>{clearTimeout(n);const i=this.generateFallbackSVG(t);q.warn(`Failed to load image: ${e}`,"ImageService",{error:s}),a({success:!1,src:i,fallbackUsed:!0,error:s instanceof Error?s:new Error("Image load failed")})},s.src=e})}addToCache(e,t){if(this.imageCache.size>=this.MAX_CACHE_SIZE){const e=this.imageCache.keys().next().value;e&&this.imageCache.delete(e)}this.imageCache.set(e,t)}async preloadImages(e,t={}){const a=e.map(e=>this.loadImage(e,t));return Promise.all(a)}getOptimizedImageUrl(e,t={}){return e?e.startsWith("data:")||e.startsWith("blob:")?e:e.includes("ipfs.io")||e.includes("ipfs://")?this.optimizeIPFSUrl(e):e:this.generateFallbackSVG(t)}isIPFSUrl(e){return e.includes("/ipfs/")||e.startsWith("ipfs://")||e.includes("gateway.pinata.cloud")}optimizeIPFSUrl(e){return this.isIPFSUrl(e),e}clearCache(){this.imageCache.clear(),this.loadingPromises.clear()}getCacheStats(){return{size:this.imageCache.size,maxSize:this.MAX_CACHE_SIZE,hitRate:0}}},Ft=({src:e,alt:t,className:s="",style:n={},width:i,height:r,type:l="generic",fallbackText:c,backgroundColor:o,textColor:d,onLoad:u,onError:m,loading:h="lazy",placeholder:p=!0})=>{const[f,x]=a.useState(""),[g,v]=a.useState(!0),[y,j]=a.useState(null),b=a.useRef(null),N=a.useRef(!1);a.useEffect(()=>{if(N.current)return;N.current=!0;(async()=>{v(!0);const t={width:i,height:r,type:l,text:c,backgroundColor:o,textColor:d};try{const a=await It.loadImage(e||"",t);x(a.src),j(a),u&&u(a),!a.success&&a.error&&m&&m(a.error)}catch(a){const e=It.generateFallbackSVG(t);x(e),j({success:!1,src:e,fallbackUsed:!0,error:a}),m&&m(a)}finally{v(!1),N.current=!1}})()},[e,i,r,l,c,o,d,u,m]);const w={...n,...i&&{width:i},...r&&{height:r}},k=`fallback-image ${s} ${g?"loading":""} ${y?.fallbackUsed?"fallback-used":""}`.trim();return A.jsxs("div",{className:"fallback-image-container",style:{position:"relative",display:"inline-block"},children:[g&&p&&A.jsx("div",{className:"image-placeholder",style:{position:"absolute",top:0,left:0,width:i||"100%",height:r||"100%",backgroundColor:o||"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",zIndex:1},children:A.jsx("div",{className:"loading-spinner",style:{width:"20px",height:"20px",border:"2px solid #e5e7eb",borderTop:"2px solid #3b82f6",borderRadius:"50%",animation:"spin 1s linear infinite"}})}),A.jsx("img",{ref:b,src:f||"",alt:t,className:k,style:{...w,opacity:g?0:1,transition:"opacity 0.3s ease"},loading:h,onLoad:()=>{v(!1)},onError:()=>{if(y&&!y.fallbackUsed){const e={width:i,height:r,type:l,text:c,backgroundColor:o,textColor:d},t=It.generateFallbackSVG(e);x(t),j({success:!1,src:t,fallbackUsed:!0})}v(!1)}}),A.jsx("style",{children:"\n        @keyframes spin {\n          0% { transform: rotate(0deg); }\n          100% { transform: rotate(360deg); }\n        }\n        \n        .fallback-image {\n          display: block;\n          max-width: 100%;\n          height: auto;\n        }\n        \n        .fallback-image.loading {\n          opacity: 0;\n        }\n        \n        .fallback-image.fallback-used {\n          filter: grayscale(0.1);\n        }\n        \n        .image-placeholder {\n          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n          background-size: 200% 100%;\n          animation: shimmer 1.5s infinite;\n        }\n        \n        @keyframes shimmer {\n          0% { background-position: -200% 0; }\n          100% { background-position: 200% 0; }\n        }\n      "})]})},$t=e=>A.jsx(Ft,{...e,type:"nft"}),Lt=e=>A.jsx(Ft,{...e,type:"collection"}),Mt=e=>A.jsx(Ft,{...e,type:"token"}),Rt=[{id:"bronze",name:"Bronze",cost:5e6,costFormatted:"5M PXJ",icon:"🥉",description:"Perfect for new collections getting started",benefits:["Basic marketplace listing","Collection verification badge","Community Discord access","Monthly featured spot rotation"]},{id:"silver",name:"Silver",cost:15e6,costFormatted:"15M PXJ",icon:"🥈",description:"Enhanced visibility and analytics access",benefits:["All Bronze benefits","Priority marketplace placement","Weekly newsletter mentions","Custom collection banner","Analytics dashboard access"]},{id:"gold",name:"Gold",cost:3e7,costFormatted:"30M PXJ",icon:"🥇",description:"Premium promotion and exclusive events",benefits:["All Silver benefits","Homepage featured carousel","Social media promotion","Exclusive events participation","Direct community manager contact"]},{id:"platinum",name:"Platinum",cost:5e7,costFormatted:"50M PXJ",icon:"💎",description:"Ultimate tier with maximum benefits",benefits:["All Gold benefits","Permanent homepage presence","Dedicated marketing campaigns","WaxRock Council consideration","Platform governance participation","White-label marketplace options"]}],Wt=({isOpen:e,onClose:t})=>{const[n,i]=a.useState(""),[r,l]=a.useState(""),[c,o]=a.useState(!1),[d,u]=a.useState(null),[m,h]=a.useState(!1),{session:p,isConnected:f}=R(),{showSuccess:x,showError:g}=_e();s.useEffect(()=>{e&&f&&p&&v()},[e,f,p]);const v=async()=>{if(p){h(!0);try{const e=await ye.getWaxCurrencyBalance(p.actor?.toString()||"","token.pxj","PXJ"),t=e.length>0?parseFloat(e[0].balance.split(" ")[0]):0;u(t)}catch(e){K("Failed to fetch PXJ balance","CollectionTierModal",e),u(0)}finally{h(!1)}}},y=Rt.find(e=>e.id===n);return e?A.jsx("div",{className:"modal-backdrop",onClick:t,children:A.jsxs("div",{className:"modal-content collection-tier-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{className:"modal-title",children:"Upgrade Collection Tier"}),A.jsx("button",{className:"modal-close",onClick:t,children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),A.jsxs("div",{className:"modal-body",children:[A.jsx("div",{className:"balance-section",children:A.jsxs("div",{className:"balance-info",children:[A.jsx("span",{className:"balance-label",children:"Your PXJ Balance:"}),A.jsx("span",{className:"balance-amount",children:m?A.jsx("span",{className:"loading-text",children:"Loading..."}):A.jsx("span",{className:null!==d&&d>0?"balance-positive":"balance-zero",children:null!==d?`${d.toLocaleString()} PXJ`:"Unable to load"})})]})}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"collectionName",children:"Collection Name:"}),A.jsx("input",{type:"text",id:"collectionName",value:r,onChange:e=>l(e.target.value),placeholder:"Enter your collection name",className:"collection-input",disabled:c})]}),A.jsxs("div",{className:"tier-selection",children:[A.jsx("h3",{children:"Select Tier:"}),A.jsx("div",{className:"tier-grid",children:Rt.map(e=>{const t=(e=>null!==d&&d>=e.cost)(e),a=n===e.id;return A.jsxs("div",{className:`tier-card ${a?"selected":""} ${t?"":"unaffordable"}`,onClick:()=>!c&&i(e.id),children:[A.jsxs("div",{className:"tier-header",children:[A.jsx("span",{className:"tier-icon",children:e.icon}),A.jsxs("div",{className:"tier-info",children:[A.jsx("h4",{className:"tier-name",children:e.name}),A.jsx("div",{className:"tier-cost",children:e.costFormatted})]}),!t&&A.jsx("div",{className:"insufficient-badge",children:"Insufficient Balance"})]}),A.jsx("p",{className:"tier-description",children:e.description}),A.jsxs("div",{className:"tier-benefits",children:[A.jsx("h5",{children:"Benefits:"}),A.jsx("ul",{children:e.benefits.map((e,t)=>A.jsx("li",{children:e},t))})]})]},e.id)})})]}),y&&A.jsxs("div",{className:"selected-tier-summary",children:[A.jsx("h4",{children:"Upgrade Summary"}),A.jsxs("div",{className:"summary-content",children:[A.jsxs("div",{className:"summary-item",children:[A.jsx("span",{children:"Collection:"}),A.jsx("span",{children:r||"Not specified"})]}),A.jsxs("div",{className:"summary-item",children:[A.jsx("span",{children:"Tier:"}),A.jsxs("span",{children:[y.icon," ",y.name]})]}),A.jsxs("div",{className:"summary-item",children:[A.jsx("span",{children:"Cost:"}),A.jsx("span",{children:y.costFormatted})]}),A.jsxs("div",{className:"summary-item",children:[A.jsx("span",{children:"Remaining Balance:"}),A.jsx("span",{children:null!==d?`${(d-y.cost).toLocaleString()} PXJ`:"Unknown"})]})]})]})]}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"btn-secondary",onClick:t,disabled:c,children:"Cancel"}),A.jsx("button",{className:"btn-primary",onClick:async()=>{if(!n||!r.trim())return void g("Please select a tier and enter a collection name");if(!f||!p)return void g("Please connect your wallet to proceed with payment");const e=Rt.find(e=>e.id===n);if(e)if(null!==d&&d<e.cost)g(`Insufficient PXJ balance. You need at least ${e.costFormatted} to upgrade to ${e.name} tier.`);else{o(!0);try{const a=`upgrade-collection:${r.toUpperCase()}:${e.id.toUpperCase()}`,s={account:"token.pxj",name:"transfer",authorization:[{actor:p.actor?.toString()||"",permission:"active"}],data:{from:p.actor?.toString()||"",to:"market.pxj",quantity:`${e.cost.toFixed(8)} PXJ`,memo:a}};await Ie.transact([s]),x(`Successfully upgraded ${r} to ${e.name} tier! Your upgrade will be processed by our team.`),t(),i(""),l("")}catch(a){K("Tier upgrade payment failed","CollectionTierModal",a instanceof Error?a:new Error(String(a))),g(`Payment failed: ${a instanceof Error?a.message:"Unknown error"}`)}finally{o(!1)}}else g("Invalid tier selected")},disabled:c||!n||!r.trim()||!f||y&&null!==d&&d<y.cost,children:c?A.jsxs(A.Fragment,{children:[A.jsx("span",{className:"loading-spinner"}),"Processing..."]}):`Upgrade to ${y?.name||"Selected Tier"}`})]})]})}):null},Ot=()=>{const[e,t]=a.useState([]),[s,i]=a.useState(!1),[r,l]=a.useState(null),[c,o]=a.useState(!1),[d,u]=a.useState(""),[m,h]=a.useState("name"),[p,f]=a.useState(12),[x,g]=a.useState(!1),[v,y]=a.useState(!1),[j,b]=a.useState(0),[N,w]=a.useState([{name:"Pixel Journey",collection:"pixeljourney",image:null,description:"The original Pixel Journey collection",tier:"platinum",verified:!0},{name:"Fried Factory",collection:"friedfactory",image:null,description:"3D NFT collection by @Friedfactory the 3D legend (and artist of our Journey Ingredients too)!",tier:"partner",verified:!0},{name:"Crypto Muffins",collection:"crptomuffins",image:null,description:"Delicious crypto-themed NFT collection by AKU!",tier:"gold",verified:!0},{name:"Aku Fish Heads",collection:"akufishheads",image:null,description:"Unique AKU-licious NFT collection",tier:"silver",verified:!0},{name:"Pantheon",collection:"pantheon",image:null,description:"Mythological NFT collection",tier:"bronze",verified:!0},{name:"Pocket People",collection:"pocketsizedp",image:null,description:"Pocket Sized PFPs by our first Partner, Kettleman!",tier:"partner",verified:!0},{name:"NIMAs Odyssey",collection:"nimasodyssey",image:null,description:"NIMAs Odyssey, a Discord RPG Driven NFT Mining Game",tier:"partner",verified:!0}]),k=a.useCallback(async()=>{try{w(e=>{const t=e.filter(e=>!e.image);return 0===t.length||Promise.all(t.map(async e=>{try{const t=await ye.getCollectionDetails(e.collection);return{...e,image:t?.img||null}}catch(t){return G(`Failed to fetch image for ${e.collection}`,"Collections",t),e}})).then(e=>{w(t=>t.map(t=>e.find(e=>e.collection===t.collection)||t))}),e})}catch(e){K("Failed to fetch PxApproved project images","Collections",e)}},[]),_=async e=>{const a=[...e];for(let s=0;s<e.length;s+=5){const n=e.slice(s,s+5);await Promise.all(n.map(async(e,n)=>{const i=s+n;try{const s=await ye.getCollectionFloorPrice(e.collection_name),n=await ye.getCollectionMarketStats({collection_name:e.collection_name});a[i]={...a[i],floor_price:s.floorPrice,volume:n.data?.volume,market_cap:n.data?.volume?(s.floorPrice*parseFloat(n.data.volume)).toFixed(2):void 0,assets:n.data?.sales,loading_market_data:!1},t([...a])}catch(r){a[i]={...a[i],loading_market_data:!1},t([...a]),W.logError("Collections.fetchMarketDataForCollections",r,{collection_name:e.collection_name})}})),s+5<e.length&&await new Promise(e=>setTimeout(e,100))}},S=async(e=50)=>{i(!0),l(null);try{const a=await ye.getCollections({limit:e,whitelistOnly:!0}),s=(a||[]).map(e=>({collection_name:e.collection_name,name:e.name,img:e.img,author:e.author,created_at_time:e.created_at_time,created_at_block:e.created_at_block,loading_market_data:!0}));t(s),b(a?.length||0),_(s)}catch(a){const t=a instanceof Error?a:new Error("Failed to fetch collections");l(t),W.logError("Collections.fetchCollections",t,{limit:e})}finally{i(!1)}};a.useEffect(()=>{S(),k()},[k]);const C=e.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.collection_name.toLowerCase().includes(d.toLowerCase())||e.author.toLowerCase().includes(d.toLowerCase())).sort((e,t)=>{switch(m){case"name":return e.name.localeCompare(t.name);case"author":return e.author.localeCompare(t.author);case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();default:return 0}}),E=N.filter(e=>e.name.toLowerCase().includes(d.toLowerCase())||e.collection.toLowerCase().includes(d.toLowerCase())),P=C.slice(0,p),T=C.length>p||j>=50&&p>=C.length;return A.jsxs("div",{className:"collections-container",children:[A.jsxs("div",{className:"perk-tiers-section",children:[A.jsxs("div",{className:"collections-header",children:[A.jsx("h1",{children:"Collections"}),A.jsx("p",{className:"collections-subtitle",children:"Discover amazing NFT collections on the WAX blockchain"})]}),A.jsxs("div",{className:"info-card",children:[A.jsx("h3",{children:"PxApproved Collections"}),A.jsx("p",{children:"Only PxApproved collections are listed on our marketplace by default. This ensures quality and authenticity for our community."}),A.jsxs("div",{className:"info-actions",children:[A.jsxs("a",{href:"https://discord.gg/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"discord-link",children:[A.jsx("svg",{className:"discord-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.956-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419c0-1.333.955-2.419 2.157-2.419c1.21 0 2.176 1.096 2.157 2.42c0 1.333-.946 2.418-2.157 2.418z"})}),"Join Discord for More Info"]}),A.jsx("button",{className:"payment-button",onClick:()=>o(!0),children:"Upgrade Collection Tier"}),A.jsxs("button",{className:"toggle-tiers-button",onClick:()=>y(!v),children:[v?"Hide Tier Details":"Show Tier Details",A.jsx("svg",{className:"toggle-icon "+(v?"rotated":""),viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"})})]})]})]}),A.jsx("p",{className:"tiers-description",children:"Elevate your collection's status on PxMarket with our tier system. Each tier unlocks exclusive benefits and promotional opportunities."}),v&&A.jsxs("div",{className:"tiers-content",children:[A.jsx("div",{className:"tiers-header",children:A.jsx("h2",{children:"PxApproved Perk Tiers"})}),A.jsxs("div",{className:"tiers-grid",children:[A.jsxs("div",{className:"tier-card tier-bronze",children:[A.jsxs("div",{className:"tier-header",children:[A.jsx("span",{className:"tier-icon",children:"🥉"}),A.jsx("h3",{children:"Bronze"}),A.jsx("div",{className:"tier-cost",children:"5M PXJ"})]}),A.jsxs("div",{className:"tier-benefits",children:[A.jsx("h4",{children:"Benefits:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Basic marketplace listing"}),A.jsx("li",{children:"Collection verification badge"}),A.jsx("li",{children:"Community Discord access"}),A.jsx("li",{children:"Monthly featured spot rotation"})]})]})]}),A.jsxs("div",{className:"tier-card tier-silver",children:[A.jsxs("div",{className:"tier-header",children:[A.jsx("span",{className:"tier-icon",children:"🥈"}),A.jsx("h3",{children:"Silver"}),A.jsx("div",{className:"tier-cost",children:"15M PXJ"})]}),A.jsxs("div",{className:"tier-benefits",children:[A.jsx("h4",{children:"Benefits:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"All Bronze benefits"}),A.jsx("li",{children:"Priority marketplace placement"}),A.jsx("li",{children:"Weekly newsletter mentions"}),A.jsx("li",{children:"Custom collection banner"}),A.jsx("li",{children:"Analytics dashboard access"})]})]})]}),A.jsxs("div",{className:"tier-card tier-gold",children:[A.jsxs("div",{className:"tier-header",children:[A.jsx("span",{className:"tier-icon",children:"🥇"}),A.jsx("h3",{children:"Gold"}),A.jsx("div",{className:"tier-cost",children:"30M PXJ"})]}),A.jsxs("div",{className:"tier-benefits",children:[A.jsx("h4",{children:"Benefits:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"All Silver benefits"}),A.jsx("li",{children:"Homepage featured carousel"}),A.jsx("li",{children:"Social media promotion"}),A.jsx("li",{children:"Exclusive events participation"}),A.jsx("li",{children:"Direct community manager contact"})]})]})]}),A.jsxs("div",{className:"tier-card tier-partner",children:[A.jsxs("div",{className:"tier-header",children:[A.jsx("span",{className:"tier-icon",children:"🤝"}),A.jsx("h3",{children:"Partner"}),A.jsx("div",{className:"tier-cost",children:"Special Agreement"})]}),A.jsxs("div",{className:"tier-benefits",children:[A.jsx("h4",{children:"Benefits:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"All Gold benefits"}),A.jsx("li",{children:"Co-marketing opportunities"}),A.jsx("li",{children:"Revenue sharing programs"}),A.jsx("li",{children:"Joint event hosting"}),A.jsx("li",{children:"Custom integration support"})]})]})]}),A.jsxs("div",{className:"tier-card tier-platinum",children:[A.jsxs("div",{className:"tier-header",children:[A.jsx("span",{className:"tier-icon",children:"💎"}),A.jsx("h3",{children:"Platinum"}),A.jsx("div",{className:"tier-cost",children:"50M PXJ"})]}),A.jsxs("div",{className:"tier-benefits",children:[A.jsx("h4",{children:"Benefits:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"All Partner benefits"}),A.jsx("li",{children:"Permanent homepage presence"}),A.jsx("li",{children:"Dedicated marketing campaigns"}),A.jsx("li",{children:"WaxRock Council consideration"}),A.jsx("li",{children:"Platform governance participation"}),A.jsx("li",{children:"White-label marketplace options"})]})]})]})]})]}),v&&A.jsx("div",{className:"council-note",children:A.jsxs("div",{className:"council-info",children:[A.jsx("span",{className:"council-icon",children:"🏛️"}),A.jsxs("div",{children:[A.jsx("h4",{children:"WaxRock Council Authority"}),A.jsx("p",{children:"The WaxRock Council reserves the right to grant special tier status to exceptional collections through community proposals and voting. Collections may also lobby for tier upgrades through formal governance processes."})]})]})}),v&&A.jsxs("div",{className:"apply-section",children:[A.jsx("h3",{children:"Ready to Upgrade Your Collection?"}),A.jsx("p",{children:"Contact our team to discuss tier upgrades and promotional opportunities."}),A.jsxs("div",{className:"apply-buttons",children:[A.jsx("a",{href:"https://discord.gg/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"apply-btn discord-btn",children:"Apply via Discord"}),A.jsx("button",{className:"apply-btn payment-btn",onClick:()=>o(!0),children:"Instant Tier Upgrade"})]})]})]}),A.jsx(Wt,{isOpen:c,onClose:()=>o(!1)}),A.jsxs("div",{className:"search-filter-section",children:[A.jsxs("div",{className:"search-controls",children:[A.jsxs("div",{className:"search-input-container",children:[A.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("input",{type:"text",placeholder:"Search collections, authors, or names...",value:d,onChange:e=>u(e.target.value),className:"search-input"}),d&&A.jsx("button",{onClick:()=>u(""),className:"clear-search","aria-label":"Clear search",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),A.jsxs("select",{id:"sortBy",value:m,onChange:e=>h(e.target.value),className:"sort-select",children:[A.jsx("option",{value:"name",children:"Name"}),A.jsx("option",{value:"author",children:"Author"}),A.jsx("option",{value:"created",children:"Created Date"})]})]})]}),d&&A.jsx("div",{className:"search-results-info",children:A.jsxs("p",{children:["Found ",C.length+E.length,' results for "',d,'"']})})]}),(!d||E.length>0)&&A.jsxs("div",{className:"pxapproved-section",children:[A.jsxs("h2",{children:["PxApproved ",d&&`(${E.length})`]}),A.jsx("div",{className:"approved-projects-grid",children:E.map((e,t)=>A.jsx(n,{to:`/collections/${e.collection}`,className:"project-card-link",children:A.jsxs("div",{className:`project-card project-card-${e.tier}`,children:[A.jsxs("div",{className:"project-tier-badge",children:[A.jsx("span",{className:`tier-label tier-${e.tier}`,children:e.tier.toUpperCase()}),e.verified&&A.jsx("span",{className:"verified-badge",children:"✓"})]}),A.jsx("img",{src:e.image&&"string"==typeof e.image?e.image.startsWith("http")?e.image:`https://ipfs.io/ipfs/${e.image}`:"/img/placeholder-collection.svg",alt:e.name,className:"project-image",onError:e=>{e.currentTarget.src="/img/placeholder-collection.svg"}}),A.jsxs("div",{className:"project-info",children:[A.jsx("h3",{children:e.name}),A.jsx("p",{className:"project-collection",children:e.collection}),A.jsx(Pt,{text:e.description,maxLength:240,className:"project-description"})]})]})},t))})]}),A.jsxs("div",{className:"all-collections-section",children:[A.jsxs("h2",{children:["More Collections on WAX ",d&&`(${C.length})`]}),r?A.jsx(st,{errorType:"COLLECTION_NOT_FOUND",onRetry:()=>S(),showRetry:!0}):s?A.jsxs("div",{className:"loading-spinner",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading collections..."})]}):A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"collections-grid",children:P.length>0?P.map(e=>A.jsxs(n,{to:`/collections/${e.collection_name}`,className:"collection-card",children:[A.jsx(Lt,{src:e.img?e.img.startsWith("http")?e.img:`https://ipfs.io/ipfs/${e.img}`:void 0,alt:e.collection_name,width:150,height:150,fallbackText:e.collection_name,className:"collection-image"}),A.jsxs("div",{className:"collection-info",children:[A.jsx("div",{className:"collection-row-1",children:A.jsx("h3",{children:e.name})}),A.jsx("div",{className:"collection-row-2",children:A.jsx("p",{className:"collection-name",children:e.collection_name})}),A.jsx("div",{className:"collection-market-data",children:e.loading_market_data?A.jsxs("div",{className:"market-data-loading",children:[A.jsx("div",{className:"mini-spinner"}),A.jsx("span",{children:"Loading market data..."})]}):A.jsxs(A.Fragment,{children:[void 0!==e.floor_price&&e.floor_price>0&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Floor:"}),A.jsxs("span",{className:"stat-value",children:[e.floor_price.toFixed(4)," WAX"]})]}),e.volume&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Volume:"}),A.jsxs("span",{className:"stat-value",children:[parseFloat(e.volume).toLocaleString()," WAX"]})]}),e.assets&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Assets:"}),A.jsx("span",{className:"stat-value",children:e.assets})]})]})})]})]},e.collection_name)):d?A.jsxs("div",{className:"no-results",children:[A.jsx("svg",{className:"no-results-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("h3",{children:"No collections found"}),A.jsx("p",{children:"Try adjusting your search terms or browse all collections"}),A.jsx("button",{onClick:()=>u(""),className:"clear-search-button",children:"Clear Search"})]}):null}),T&&!d&&A.jsx("div",{className:"load-more-container",children:A.jsx("button",{onClick:async()=>{g(!0);try{if(p<e.length)f(e=>e+12);else{const e=j+50,a=await ye.getCollections({limit:e,whitelistOnly:!0});if(a&&a.length>j){const e=a.map(e=>({collection_name:e.collection_name,name:e.name,img:e.img,author:e.author,created_at_time:e.created_at_time,created_at_block:e.created_at_block,loading_market_data:!0}));t(e),b(a.length),f(e=>e+12);const s=e.slice(j);s.length>0&&_(s)}}}catch(a){const e=a instanceof Error?a:new Error("Failed to load more collections");W.logError("Collections.loadMoreCollections",e,{displayedCount:p,totalFetched:j})}finally{g(!1)}},disabled:x,className:"load-more-button",children:x?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"button-spinner"}),"Loading..."]}):`Load More Collections (${C.length-p} remaining)`})})]})]})]})},Dt={pixeljourney:{tier:"platinum",verified:!0,quickLinks:[{label:"Main Website",url:"https://pixeljourney.xyz",icon:"🌐"},{label:"Discord",url:"http://discord.gg/pixel-journey-1130670500776005734",icon:"💬"},{label:"X/Twitter",url:"https://x.com/PXJourney",icon:"🐦"},{label:"Whitepaper",url:"https://docs.pixeljourney.xyz",icon:"📄"}],benefits:["Premium marketplace placement","Exclusive promotional campaigns","Priority customer support","Advanced analytics dashboard","Custom branding options"],ownerMessage:"Welcome to Pixel Journey! Join our community of adventurers exploring the digital realm. Connect with fellow travelers, learn about all the things and discover exclusive content.",discordUrl:"http://discord.gg/pixel-journey-1130670500776005734",learnAboutGrid:[{title:"PXJ Token",description:"Learn about our native utility token, its use cases, and how it powers the Pixel Journey ecosystem.",icon:"🪙",url:"https://docs.pixeljourney.xyz/season-1/kickstarting-the-pxj-economy"},{title:"NFT Collections",description:"Discover our diverse range of NFT collectibles, from Pixal PFPs to Pixel Ingredients and special editions.",icon:"🎨",url:"https://docs.pixeljourney.xyz/season-1/the-pixal-pfps"},{title:"Leaderboards",description:"Explore the PXJourney mechanics, quests, and adventures awaiting in Pixel Journey.",icon:"🎮",url:"https://lb.pixeljourney.xyz/"},{title:"Staking & Rewards",description:"Understand how to stake your NFTs and tokens to earn rewards and participate in governance.",icon:"💎",url:"https://pixeljourney.xyz/staking"},{title:"Roadmap",description:"Check out our development roadmap and upcoming features planned for the ecosystem.",icon:"🗺️",url:"/journeymap"},{title:"Community",description:"Join our vibrant community of adventurers, participate in events, and connect with fellow travelers.",icon:"👥",url:"http://discord.gg/pixel-journey-1130670500776005734"}]},friedfactory:{tier:"partner",verified:!0,quickLinks:[{label:"Artist Portfolio",url:"https://friedfactory.art",icon:"🎨"},{label:"Discord",url:"https://discord.gg/friedfactory",icon:"💬"},{label:"Twitter",url:"https://twitter.com/friedfactory",icon:"🐦"}],benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]},crptomuffins:{tier:"gold",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"ℹ️"},{label:"Discord",url:"#",icon:"💬"}],benefits:["Homepage featured carousel","Social media promotion","Exclusive events participation","Direct community manager contact"]},akufishheads:{tier:"silver",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"ℹ️"}],benefits:["Priority marketplace placement","Weekly newsletter mentions","Custom collection banner","Analytics dashboard access"]},pantheon:{tier:"bronze",verified:!0,benefits:["Basic marketplace listing","Collection verification badge","Community Discord access","Monthly featured spot rotation"]},pocketsizedp:{tier:"partner",verified:!0,quickLinks:[{label:"Collection Info",url:"#",icon:"ℹ️"}],benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]},nimasodyssey:{tier:"partner",verified:!0,benefits:["Co-marketing opportunities","Revenue sharing programs","Joint event hosting","Cross-promotion support"]}};function Bt(e){return Dt[e]||null}function Ut(e){return{platinum:{icon:"💎",label:"Platinum",className:"tier-platinum",color:"#e5e4e2"},partner:{icon:"🤝",label:"Partner",className:"tier-partner",color:"#667eea"},gold:{icon:"🥇",label:"Gold",className:"tier-gold",color:"#ffd700"},silver:{icon:"🥈",label:"Silver",className:"tier-silver",color:"#c0c0c0"},bronze:{icon:"🥉",label:"Bronze",className:"tier-bronze",color:"#cd7f32"}}[e]}const zt=({collectionName:e})=>{const t=Bt(e);if(!t)return null;const a=Ut(t.tier),s=t.quickLinks&&t.quickLinks.length>0;return A.jsxs("div",{className:"quick-links-container",children:[A.jsx("div",{className:"tier-section",children:A.jsxs("div",{className:`tier-badge ${a.className}`,children:[A.jsx("span",{className:"tier-icon",children:a.icon}),A.jsx("span",{className:"tier-label",children:a.label}),t.verified&&A.jsx("span",{className:"verified-icon",children:"✓"})]})}),s&&A.jsxs("div",{className:"links-section",children:[A.jsx("h4",{className:"links-title",children:"Quick Links"}),A.jsx("div",{className:"links-grid",children:t.quickLinks.map((e,t)=>A.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"quick-link",children:[e.icon&&A.jsx("span",{className:"link-icon",children:e.icon}),A.jsx("span",{className:"link-label",children:e.label})]},t))})]}),(t.ownerMessage||t.discordUrl)&&A.jsxs("div",{className:"owner-section",children:[t.ownerMessage&&A.jsxs("div",{className:"owner-message",children:[A.jsxs("div",{className:"owner-title-container",style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"8px"},children:[A.jsx("h4",{className:"owner-title",children:"From the Collection Owner"}),A.jsx("div",{className:"info-tooltip",title:"This message is provided directly by the collection owner to share information about their project, community, or special announcements with collectors and fans.",style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:"16px",height:"16px",borderRadius:"50%",backgroundColor:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",color:"rgba(255, 255, 255, 0.7)",fontSize:"12px",fontWeight:"bold",cursor:"help",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.15)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)",e.currentTarget.style.color="rgba(255, 255, 255, 0.9)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",e.currentTarget.style.color="rgba(255, 255, 255, 0.7)"},children:"?"})]}),A.jsx("p",{className:"owner-text",children:t.ownerMessage})]}),t.discordUrl&&A.jsx("div",{className:"discord-section",children:A.jsxs("a",{href:t.discordUrl,target:"_blank",rel:"noopener noreferrer",className:"discord-link",children:[A.jsx("span",{className:"discord-icon",children:"💬"}),A.jsx("span",{className:"discord-text",children:"Join Our Discord Community"}),A.jsx("span",{className:"external-icon",children:"↗"})]})})]}),t.learnAboutGrid&&A.jsxs("div",{className:"learn-about-section",style:{marginTop:"2rem"},children:[A.jsx("h3",{className:"learn-about-title",children:"Learn About Pixel Journey"}),A.jsx("div",{className:"learn-about-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"16px",marginTop:"16px"},children:t.learnAboutGrid.map((e,t)=>A.jsxs("div",{className:"learn-about-card",style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"12px",padding:"20px",transition:"all 0.3s ease",cursor:e.url?"pointer":"default"},onClick:()=>e.url&&window.open(e.url,"_blank"),onMouseEnter:t=>{e.url&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.08)",t.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)",t.currentTarget.style.transform="translateY(-2px)")},onMouseLeave:t=>{e.url&&(t.currentTarget.style.background="rgba(255, 255, 255, 0.05)",t.currentTarget.style.borderColor="rgba(255, 255, 255, 0.1)",t.currentTarget.style.transform="translateY(0)")},children:[A.jsxs("div",{className:"learn-card-header",style:{display:"flex",alignItems:"center",gap:"12px",marginBottom:"12px"},children:[A.jsx("span",{className:"learn-card-icon",style:{fontSize:"24px",display:"flex",alignItems:"center",justifyContent:"center",width:"40px",height:"40px",background:"rgba(255, 255, 255, 0.1)",borderRadius:"8px"},children:e.icon}),A.jsx("h4",{className:"learn-card-title",style:{margin:0,fontSize:"16px",fontWeight:"600",color:"white"},children:e.title}),e.url&&A.jsx("span",{className:"external-link-icon",style:{marginLeft:"auto",fontSize:"14px",color:"rgba(255, 255, 255, 0.6)"},children:"↗"})]}),A.jsx("p",{className:"learn-card-description",style:{margin:0,fontSize:"14px",lineHeight:"1.5",color:"rgba(255, 255, 255, 0.8)"},children:e.description})]},t))})]})]})},Xt=({collectionName:e})=>{const{account:t,isConnected:s}=R(),{showError:n,showSuccess:i}=_e(),{settings:r}=ue(),[l,c]=a.useState(!1),[o,d]=a.useState(!0),[u,m]=a.useState(!1),[h,p]=a.useState(!1),[f,x]=a.useState([]),[g,v]=a.useState(0),[y,j]=a.useState(null),[b,N]=a.useState(""),[w,k]=a.useState(null),[_,S]=a.useState(!1),[C,E]=a.useState(!0),[P,T]=a.useState(30),[I,F]=a.useState(!1),[$,L]=a.useState(!1),[M,W]=a.useState(!1),[O,D]=a.useState({collection:e||void 0,hideSpam:!0}),B=a.useRef(null),U=a.useRef(null),z=a.useRef(null),X=(e,t="")=>{const a=z.current;if(!a)return;const s=a.selectionStart,n=a.selectionEnd,i=b.substring(s,n),r=b.substring(0,s),l=b.substring(n);N(r+e+i+t+l),setTimeout(()=>{a.focus();const n=s+e.length+i.length+t.length;a.setSelectionRange(n,n)},0)},H=e=>{const t=He(e);return A.jsx("span",{dangerouslySetInnerHTML:{__html:t}})};a.useEffect(()=>{if(0!==f.length)if(y){const e=f.filter(e=>new Date(e.timestamp)>new Date(y));v(e.length)}else v(o?f.length:0);else v(0)},[f,y,o]),a.useEffect(()=>{if(!o&&f.length>0){const e=f[f.length-1];j(e.timestamp),v(0)}},[o,f]);const q=a.useCallback(async(t=!1)=>{t||m(!0);try{const t=e?{...O,collection:e}:O,a=await De.getMessages(t,50,0);x(a)}catch(a){console.error("Error loading messages:",a),t||n("Failed to load chat messages")}finally{t||m(!1)}},[O,e,n]);a.useEffect(()=>{!e||O.collection&&O.collection===e||D(t=>({...t,collection:e}))},[e,O]),a.useEffect(()=>{q()},[q]),a.useEffect(()=>(C&&!o?U.current=setInterval(()=>{q(!0)},1e3*P):U.current&&(clearInterval(U.current),U.current=null),()=>{U.current&&clearInterval(U.current)}),[C,o,P,q]);const J=a.useCallback(async()=>{if(t&&b)try{const e=await De.calculateMessageCost(b,t);k(e)}catch(e){console.error("Error calculating cost:",e)}},[t,b]);if(a.useEffect(()=>{b&&t?J():k(null)},[b,t,J]),a.useEffect(()=>{G()},[f]),!r.showChatButton)return null;const V=async()=>{if(t&&b.trim()){p(!0);try{const a=e?`::col:${e}:: ${b.trim()}`:b.trim(),s=await De.sendMessage(a,t,e,_);i("Message sent!",`Transaction: ${s.substring(0,8)}...`),N(""),k(null),S(!1),setTimeout(()=>{q(!0)},2e3)}catch(a){console.error("Error sending message:",a),n("Failed to send message",a instanceof Error?a.message:"Unknown error")}finally{p(!1)}}},G=()=>{B.current?.scrollIntoView({behavior:"smooth"})},K=e=>{const t=new Date(e),a=(new Date).getTime()-t.getTime(),s=Math.floor(a/6e4),n=Math.floor(a/36e5),i=Math.floor(a/864e5);return s<1?"now":s<60?`${s}m`:n<24?`${n}h`:i<7?`${i}d`:t.toLocaleDateString()},Y=e=>{const t=parseFloat(e.split(" ")[0]);return t>=1e3?`${(t/1e3).toFixed(1)}K PXJ`:`${t.toFixed(0)} PXJ`},Q=e=>e.isSponsored?"chat_message--sponsored":"premium"===e.messageType?"chat_message--premium":"chat_message--normal";return o?A.jsx("div",{className:"chat_widget chat_widget--minimized",children:A.jsxs("button",{className:"chat_toggle-btn",onClick:()=>d(!1),title:"Open Chat",children:[A.jsx("span",{className:"chat_icon",children:"💬"}),g>0&&A.jsx("span",{className:"chat_notification-badge",children:g})]})}):A.jsxs("div",{className:"chat_widget "+(l?"chat_widget--expanded":"chat_widget--normal"),children:[A.jsxs("div",{className:"chat_header",children:[A.jsxs("div",{className:"chat_header-left",children:[A.jsx("span",{className:"chat_title",children:e?`${e} Chat`:"Global Chat"}),A.jsxs("span",{className:"chat_status",children:[f.length," messages"]})]}),A.jsxs("div",{className:"chat_header-right",children:[A.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>q(),disabled:u,title:"Refresh",children:A.jsx("span",{className:"chat_refresh-icon "+(u?"chat_refresh-icon--spinning":""),children:"🔄"})}),A.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>c(!l),title:l?"Minimize":"Expand",children:A.jsx("span",{children:l?"🗗":"🗖"})}),A.jsx("button",{className:"chat_btn chat_btn--icon",onClick:()=>d(!0),title:"Close",children:A.jsx("span",{children:"✕"})})]})]}),!e&&A.jsxs("div",{className:"chat_filters",children:[A.jsxs("select",{className:"chat_select",value:O.collection||"",onChange:e=>D({...O,collection:e.target.value||void 0}),children:[A.jsx("option",{value:"",children:"All Collections"}),A.jsx("option",{value:"pixeljourney",children:"Pixel Journey"}),A.jsx("option",{value:"pixalcards",children:"Pixal Cards"})]}),A.jsxs("label",{className:"chat_checkbox-label",children:[A.jsx("input",{type:"checkbox",checked:O.hideSpam||!1,onChange:e=>D({...O,hideSpam:e.target.checked})}),"Hide Spam"]}),A.jsxs("label",{className:"chat_checkbox-label",children:[A.jsx("input",{type:"checkbox",checked:O.showOnlySponsored||!1,onChange:e=>D({...O,showOnlySponsored:e.target.checked})}),"Sponsored Only"]})]}),A.jsxs("div",{className:"chat_messages",children:[u&&0===f.length?A.jsx("div",{className:"chat_loading",children:"Loading messages..."}):0===f.length?A.jsxs("div",{className:"chat_empty",children:[A.jsx("p",{children:"No messages yet."}),A.jsx("p",{children:"Be the first to start the conversation!"})]}):f.map(e=>A.jsxs("div",{className:`chat_message ${Q(e)}`,children:[A.jsxs("div",{className:"chat_message-header",children:[A.jsx("div",{className:"chat_message-avatar",children:A.jsx("img",{src:`https://api.dicebear.com/7.x/identicon/svg?seed=${e.sender}`,alt:e.sender,className:"chat_avatar"})}),A.jsxs("div",{className:"chat_message-info",children:[A.jsx("span",{className:"chat_sender",children:e.sender}),A.jsx("span",{className:"chat_timestamp",children:K(e.timestamp)}),A.jsx("span",{className:"chat_amount",children:Y(e.pxjAmount)}),e.isSponsored&&A.jsx("span",{className:"chat_sponsored-badge",children:"SPONSORED"})]}),A.jsx("div",{className:"chat_message-actions",children:A.jsx("a",{href:`https://wax.bloks.io/transaction/${e.transactionId}`,target:"_blank",rel:"noopener noreferrer",className:"chat_tx-link",title:"View on Explorer",children:"🔗"})})]}),A.jsx("div",{className:"chat_message-content",children:H(e.message)})]},e.id)),A.jsx("div",{ref:B})]}),s?A.jsxs("div",{className:"chat_input-section",children:[w&&A.jsxs("div",{className:"chat_cost-info",children:[A.jsxs("div",{className:"chat_cost-display",children:[A.jsxs("span",{className:"chat_cost-amount",children:["Cost: ",(w.totalCost/1e4).toFixed(4)," PXJ"]}),A.jsx("button",{className:"chat_info-btn",onClick:()=>W(!M),title:"View price breakdown",children:"ℹ️"})]}),w.hasPixalPFP&&A.jsxs("span",{className:"chat_discount",children:["Pixal PFP Discount: ",w.discount,"%"]}),A.jsxs("span",{className:"chat_char-count",children:[b.length,"/240 chars"]}),M&&A.jsx("div",{className:"chat_price-tooltip",children:A.jsxs("div",{className:"chat_price-content",children:[A.jsx("h4",{children:"Price Breakdown"}),A.jsxs("div",{className:"price-factor",children:[A.jsx("span",{children:"Base Cost:"}),A.jsxs("span",{children:[(w.baseCost/1e4).toFixed(4)," PXJ"]})]}),A.jsxs("div",{className:"price-factor",children:[A.jsxs("span",{children:["Character Cost (",b.length," chars):"]}),A.jsxs("span",{children:[((w.totalCost-w.baseCost)/1e4).toFixed(4)," PXJ"]})]}),w.hasPixalPFP&&A.jsxs("div",{className:"price-factor discount",children:[A.jsxs("span",{children:["Pixal PFP Discount (",w.discount,"%):"]}),A.jsxs("span",{children:["-",((w.baseCost+(w.totalCost-w.baseCost))*(w.discount/100)/1e4).toFixed(4)," PXJ"]})]}),A.jsxs("div",{className:"price-factor total",children:[A.jsx("span",{children:"Total Cost:"}),A.jsxs("span",{children:[(w.totalCost/1e4).toFixed(4)," PXJ"]})]}),A.jsx("div",{className:"price-note",children:A.jsx("small",{children:"Cost increases by 100% per 50 extra characters. Holders capped at 500 PXJ."})})]})})]}),A.jsxs("div",{className:"chat_input-controls",children:[A.jsxs("div",{className:"chat_sponsored-container",children:[A.jsxs("label",{className:"chat_checkbox-label",children:[A.jsx("input",{type:"checkbox",checked:_,onChange:e=>S(e.target.checked)}),"Sponsored (10,000 PXJ)"]}),A.jsx("button",{className:"chat_info-btn",onClick:()=>F(!I),title:"Learn more about sponsored messages",children:"ℹ️"}),I&&A.jsx("div",{className:"chat_info-tooltip",children:A.jsxs("div",{className:"chat_info-content",children:[A.jsx("h4",{children:"Sponsored Messages"}),A.jsx("p",{children:"• Messages appear with special highlighting"}),A.jsx("p",{children:"• Higher visibility in chat feed"}),A.jsx("p",{children:"• Costs 10,000 PXJ regardless of length"}),A.jsx("p",{children:"• Perfect for announcements & promotions"})]})})]}),A.jsxs("label",{className:"chat_checkbox-label",children:[A.jsx("input",{type:"checkbox",checked:C,onChange:e=>E(e.target.checked)}),"Auto-refresh"]})]}),A.jsxs("div",{className:"chat_formatting-toolbar",children:[A.jsx("button",{className:"chat_format-btn",onClick:()=>X("**","**"),title:"Bold",children:A.jsx("strong",{children:"B"})}),A.jsx("button",{className:"chat_format-btn",onClick:()=>X("*","*"),title:"Italic",children:A.jsx("em",{children:"I"})}),A.jsxs("div",{className:"chat_emoji-container",children:[A.jsx("button",{className:"chat_format-btn",onClick:()=>L(!$),title:"Add emoji",children:"😊"}),$&&A.jsx("div",{className:"chat_emoji-picker",children:A.jsx("div",{className:"chat_emoji-grid",children:["😊","😂","❤️","👍","👎","🔥","💯","🚀","💎","🎉","😎","🤔","😍","🥳","💪","👏","🙌","✨","⭐","🌟"].map(e=>A.jsx("button",{className:"chat_emoji-btn",onClick:()=>(e=>{const t=z.current;if(!t)return;const a=t.selectionStart,s=b.substring(0,a),n=b.substring(a);N(s+e+n),L(!1),setTimeout(()=>{t.focus();const s=a+e.length;t.setSelectionRange(s,s)},0)})(e),children:e},e))})})]})]}),A.jsxs("div",{className:"chat_input-wrapper",children:[A.jsx("textarea",{ref:z,className:"chat_input",placeholder:`Type your message... (${e||"global"} chat)`,value:b,onChange:e=>N(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),V())},maxLength:240,rows:l?3:2,disabled:h}),A.jsx("button",{className:"chat_send-btn",onClick:V,disabled:!b.trim()||h,children:h?"⏳":"📤"})]})]}):A.jsx("div",{className:"chat_login-prompt",children:A.jsx("p",{children:"Connect your wallet to join the chat!"})}),l&&A.jsx("div",{className:"chat_settings",children:A.jsxs("div",{className:"chat_setting-group",children:[A.jsx("label",{children:"Auto-refresh interval:"}),A.jsxs("select",{value:P,onChange:e=>T(Number(e.target.value)),className:"chat_select chat_select--small",children:[A.jsx("option",{value:10,children:"10s"}),A.jsx("option",{value:30,children:"30s"}),A.jsx("option",{value:60,children:"1m"}),A.jsx("option",{value:300,children:"5m"})]})]})})]})},Ht=({isOpen:e,imageUrl:t,imageName:a,onClose:n})=>{if(!e)return null;const i=e=>{"Escape"===e.key&&n()};return s.useEffect(()=>(e&&(document.addEventListener("keydown",i),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",i),document.body.style.overflow="unset"}),[e]),A.jsx("div",{className:"image-zoom-modal",onClick:n,children:A.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsx("button",{className:"zoom-modal-close",onClick:n,children:"×"}),A.jsx("img",{src:t,alt:a,className:"zoom-modal-image"}),A.jsx("div",{className:"zoom-modal-info",children:A.jsx("h3",{children:a})})]})})},qt=s.memo(()=>{const{collectionName:e}=l(),{settings:t}=ue(),[s,i]=a.useState(null),[r,c]=a.useState([]),[o,d]=a.useState([]),[u,m]=a.useState(null),[h,p]=a.useState("24"),[f,x]=a.useState({}),[g,v]=a.useState(!1),[y,j]=a.useState("WAX"),[b,N]=a.useState(.05),[w,k]=a.useState([]),[_,S]=a.useState(1),[C,E]=a.useState(!1),[P,T]=a.useState(!0),[I,F]=a.useState([]),[$,L]=a.useState([]),[M,R]=a.useState(1),[W]=a.useState(10),[O,D]=a.useState(!1),[B,U]=a.useState([]),[z,X]=a.useState(null),[H,q]=a.useState(""),[J,V]=a.useState(!1),[G,K]=a.useState(null),[Y,Q]=a.useState("sales"),[Z,ee]=a.useState(""),[ae,se]=a.useState("name"),[ne,ie]=a.useState(!1),[re,le]=a.useState({url:"",name:""}),[ce,oe]=a.useState(!1),de=r.filter(e=>e.schema_name.toLowerCase().includes(Z.toLowerCase())).sort((e,t)=>{switch(ae){case"name":return e.schema_name.localeCompare(t.schema_name);case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();default:return 0}}),me=o.filter(e=>{const t=e.immutable_data?.name&&String(e.immutable_data.name).toLowerCase().includes(Z.toLowerCase())||e.template_id.toLowerCase().includes(Z.toLowerCase()),a=!H||e.schema_name===H;return t&&a}).sort((e,t)=>{switch(ae){case"name":{const a=String(e.immutable_data?.name||`Template #${e.template_id}`),s=String(t.immutable_data?.name||`Template #${t.template_id}`);return a.localeCompare(s)}case"created":return new Date(t.created_at_time).getTime()-new Date(e.created_at_time).getTime();case"supply":return parseInt(t.issued_supply)-parseInt(e.issued_supply);default:return 0}}),he=a.useCallback(async t=>{if(!e)return"0";try{const a=await fetch(`https://wax-api.hivebp.io/v3/volume/${t}/${e}`);if(!a.ok)throw new Error("Failed to fetch volume data");const s=await a.json();return s.volume?String(s.volume):"0"}catch(a){return console.warn(`Failed to fetch ${t}d volume data:`,a),"0"}},[e]),pe=a.useCallback(async()=>{if(!e)return null;try{const t=await fetch(`https://wax-api.hivebp.io/v3/collection-stats/${e}`);if(!t.ok)throw new Error("Failed to fetch collection stats");const a=await t.json();return{numUsers:a.numUsers||0,usdMarketCap:a.usdMarketCap||0,waxMarketCap:a.waxMarketCap||0,numAssets:a.numAssets||0}}catch(t){return console.warn("Failed to fetch collection stats:",t),null}},[e]),fe=a.useCallback(async()=>{if(!e)return;v(!0);const t=["24","7","30","90","365"],a=t.indexOf(h),s=t[(a+1)%t.length];if(f[s])return p(s),void v(!1);const n=await he(s);x(e=>({...e,[s]:n})),p(s),v(!1)},[e,h,f,he]),xe=a.useCallback(async()=>{if(e){V(!0),K(null);try{const[t,a,s]=await Promise.all([ye.getCollectionDetails(e),ye.getCollectionSchemas(e),ye.getCollectionTemplates(e)]);i(t),c(a),d(s),Promise.all([ye.getCollectionAnalytics(e),ye.getEnhancedCollectionStats(e),ye.getCollectionVolumeGraph(e,30),ye.getSimilarCollections(e),ye.getCollectionHolders(e,500),ye.getCollectionTopSales(e,50),he("24"),pe(),ye.getCollectionMarketStats({collection_name:e,symbol:"WAX"})]).then(([e,t,,a,s,n,i,r,l])=>{console.log("API Responses:",{analyticsData:e,enhancedStats:t,collectionStats:r,marketStats:l,salesData:n?.slice(0,3)}),x(e=>({...e,24:i}));const c=l.success&&l.data?{sales:l.data.sales||"0",volume:l.data.volume?String(parseFloat(l.data.volume)/Math.pow(10,8)):"0",suggested_median:l.data.suggested_median?String(parseFloat(l.data.suggested_median)/Math.pow(10,8)):"0",suggested_average:l.data.suggested_average?String(parseFloat(l.data.suggested_average)/Math.pow(10,8)):"0"}:null;X(c);const o={volume:c?.volume||e?.volume||"0",sales:c?.sales||e?.sales||"0",floor_price:t.floorPrice&&!isNaN(t.floorPrice)?String(t.floorPrice):e?.floor_price&&!isNaN(parseFloat(e.floor_price))?e.floor_price:e?.floor&&!isNaN(parseFloat(e.floor))?e.floor:c?.suggested_median&&!isNaN(parseFloat(c.suggested_median))?c.suggested_median:n&&n.length>0?(()=>{const e=n.slice(-5).map(e=>{const t="string"==typeof e.price?e.price:e.price?.amount||"0";return parseFloat(t||"0")}).filter(e=>!isNaN(e)&&e>0);return e.length>0?String(Math.min(...e).toFixed(2)):"0"})():"0",market_cap:r?.waxMarketCap?String(r.waxMarketCap):t.marketCap?String(t.marketCap):e?.market_cap||"0",holders:r?.numUsers||e?.holders||0,assets:r?.numAssets?String(r.numAssets):e?.assets||"0",volume_24h:i||(t.volume24h?String(t.volume24h):e?.volume_24h||e?.volume||"0")};m(o),U(a),k(s),F(n||[])}).catch(e=>{console.warn("Enhanced analytics failed to load:",e)})}catch(t){console.error("Error loading collection data:",t),K(`Failed to load collection "${e}". This collection may not exist or be temporarily unavailable.`)}finally{V(!1)}}},[e]),ge=a.useCallback(async t=>{if(e)try{const a=await ye.getCollectionTemplates(e,t);d(a)}catch(a){console.error("Error loading templates:",a)}},[e]);a.useEffect(()=>{e&&xe()},[e,xe]),a.useEffect(()=>{H&&e&&ge(H)},[H,e,ge]);a.useEffect(()=>{const e=M*W,t=I.slice(0,e);L(t),D(e<I.length)},[I,M,W]);const ve=e=>{if(e)return e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`},je=e=>{if(!e)return"N/A";try{let t;if(e.includes("T"))t=new Date(e);else{const a=parseInt(e);if(a>946684800&&a<4102444800)t=new Date(1e3*a);else{if(!(a>9466848e5&&a<41024448e5))return"N/A";t=new Date(a)}}return isNaN(t.getTime())?"N/A":t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"N/A"}},be=(e,a="template-image")=>{const s=(e=>{if(e.immutable_data?.video){const t=e.immutable_data.video;if("string"==typeof t)return t.startsWith("Qm")?`${te.IPFS.GATEWAYS[0]}${t}`:t}return null})(e),n=(e=>{if(e.immutable_data?.img){const t=e.immutable_data.img;if("string"==typeof t)return t.startsWith("Qm")?`https://ipfs.io/ipfs/${t}`:t}return"https://pixeljourney.xyz/img/toppixals/10.webp"})(e);return A.jsx(Fe,{imageUrl:n,videoUrl:s,alt:String(e.immutable_data?.name||"NFT"),className:a,enableAnimations:t.enableAnimatedNFTs})};return J?A.jsx("div",{className:"collection-detail-container",children:A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading collection details..."})]})}):G?A.jsx("div",{className:"collection-detail-container",children:A.jsxs("div",{className:"error-state",children:[A.jsx("h2",{children:"Collection Error"}),A.jsx("p",{children:G}),A.jsx(n,{to:"/collections",className:"back-link",children:"← Back to Collections"})]})}):s?A.jsxs("div",{className:"collection-profile-page",children:[A.jsxs("div",{className:"collection-hero",children:[A.jsxs("div",{className:"hero-background",children:[A.jsx("img",{src:ve(s.img||""),alt:s.name||s.collection_name,className:"hero-bg-image"}),A.jsx("div",{className:"hero-overlay"})]}),A.jsxs("div",{className:"hero-content",children:[A.jsxs("div",{className:"breadcrumb",children:[A.jsx(n,{to:"/",className:"breadcrumb-link",children:"Home"}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx(n,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx("span",{className:"breadcrumb-current",children:s.name||s.collection_name})]}),A.jsxs("div",{className:"collection-profile",children:[A.jsx("div",{className:"collection-logo-container",children:A.jsx("img",{src:ve(s.img||""),alt:s.name||s.collection_name,className:"collection-logo"})}),A.jsxs("div",{className:"profile-info",children:[A.jsx("div",{className:"title-section",children:A.jsx("h1",{className:"collection-title",children:s.name||s.collection_name})}),A.jsxs("div",{className:"collection-actions-row",style:{display:"flex",alignItems:"center",gap:"12px",marginTop:"8px",marginBottom:"12px"},children:[(()=>{const e=Bt(s.collection_name);if(e){const t=Ut(e.tier);return A.jsxs("div",{className:`collection-tier-badge ${t.className}`,children:[A.jsx("span",{className:"tier-icon",children:t.icon}),A.jsx("span",{className:"tier-label",children:t.label}),e.verified&&A.jsx("span",{className:"verified-icon",children:"✓"})]})}return null})(),A.jsxs("button",{className:"share-button",onClick:()=>oe(!0),style:{background:"rgba(255, 255, 255, 0.1)",border:"1px solid rgba(255, 255, 255, 0.2)",borderRadius:"8px",padding:"8px 12px",color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:"6px",fontSize:"14px",fontWeight:"500",transition:"all 0.2s ease"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.15)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 255, 255, 0.1)",e.currentTarget.style.borderColor="rgba(255, 255, 255, 0.2)"},children:[A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:A.jsx("path",{d:"M18 16.08C17.24 16.08 16.56 16.38 16.04 16.85L8.91 12.7C8.96 12.47 9 12.24 9 12C9 11.76 8.96 11.53 8.91 11.3L15.96 7.19C16.5 7.69 17.21 8 18 8C19.66 8 21 6.66 21 5C21 3.34 19.66 2 18 2C16.34 2 15 3.34 15 5C15 5.24 15.04 5.47 15.09 5.7L8.04 9.81C7.5 9.31 6.79 9 6 9C4.34 9 3 10.34 3 12C3 13.66 4.34 15 6 15C6.79 15 7.5 14.69 8.04 14.19L15.16 18.34C15.11 18.55 15.08 18.77 15.08 19C15.08 20.61 16.39 21.92 18 21.92C19.61 21.92 20.92 20.61 20.92 19C20.92 17.39 19.61 16.08 18 16.08Z",fill:"currentColor"})}),"Share Collection"]})]}),A.jsxs("p",{className:"collection-handle",children:["@",s.collection_name]}),A.jsxs("p",{className:"collection-creator",children:["Created by ",s.author]}),s.data?.description&&A.jsx("div",{className:"collection-description",children:A.jsx(Pt,{text:String(s.data.description||""),maxLength:100,className:"description-text"})})]})]})]})]}),A.jsxs("div",{className:"stats-dashboard",children:[A.jsxs("div",{className:"stats-grid",children:[A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:u?.assets||s.assets||0}),A.jsx("div",{className:"stat-label",children:"Total Assets"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:r.length}),A.jsx("div",{className:"stat-label",children:"Schemas"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:o.length}),A.jsx("div",{className:"stat-label",children:"Templates"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:w.length}),A.jsx("div",{className:"stat-label",children:"Holders"})]})]}),u&&A.jsxs("div",{className:"stats-grid",children:[A.jsxs("div",{className:"stat-card premium clickable",onClick:async()=>{if("WAX"===y){try{const e=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),t=await e.json();t.wax&&t.wax.usd&&N(t.wax.usd)}catch(e){console.warn("Could not fetch WAX price:",e)}j("USD")}else j("WAX")},style:{cursor:"pointer"},children:[A.jsx("div",{className:"stat-value",children:u.market_cap&&"0"!==u.market_cap?"WAX"===y?`${parseFloat(u.market_cap).toLocaleString()} WAX`:`$${(parseFloat(u.market_cap)*b).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`:"N/A"}),A.jsxs("div",{className:"stat-label",children:["Market Cap (",y,")"]})]}),A.jsxs("div",{className:"stat-card premium",children:[A.jsx("div",{className:"stat-value",children:z?.sales&&"0"!==z.sales?`${parseInt(z.sales).toLocaleString()}`:u?.sales&&"0"!==u.sales?`${parseInt(u.sales).toLocaleString()}`:"N/A"}),A.jsx("div",{className:"stat-label",children:"All Time Sales"})]}),A.jsxs("div",{className:"stat-card premium",children:[A.jsx("div",{className:"stat-value",children:z?.volume&&"0"!==z.volume?`${parseFloat(z.volume).toLocaleString()} WAX`:u?.volume&&"0"!==u.volume?`${parseFloat(u.volume).toLocaleString()} WAX`:"N/A"}),A.jsx("div",{className:"stat-label",children:"All Time Volume"})]}),A.jsxs("div",{className:"stat-card premium clickable",onClick:fe,style:{cursor:"pointer"},children:[A.jsx("div",{className:"stat-value",children:g?A.jsx("span",{style:{opacity:.6},children:"Loading..."}):f[h]&&"0"!==f[h]?`${parseFloat(f[h]).toLocaleString()} WAX`:u?.volume_24h&&"0"!==u.volume_24h?`${parseFloat(u.volume_24h).toLocaleString()} WAX`:"N/A"}),A.jsxs("div",{className:"stat-label",children:["24"===h?"24H":"7"===h?"7D":"30"===h?"30D":"90"===h?"90D":"365D"," Volume",A.jsx("span",{style:{fontSize:"0.8em",opacity:.7,marginLeft:"4px"},children:"↻"})]})]}),A.jsxs("div",{className:"stat-card premium",children:[A.jsx("div",{className:"stat-value",children:u.floor_price&&"0"!==u.floor_price&&!isNaN(parseFloat(u.floor_price))&&parseFloat(u.floor_price)>0?`${parseFloat(u.floor_price).toFixed(2)} WAX`:z?.suggested_median&&"0"!==z.suggested_median&&!isNaN(parseFloat(z.suggested_median))?`${parseFloat(z.suggested_median).toFixed(2)} WAX`:I&&I.length>0?(()=>{const e=I.slice(-3).map(e=>{const t="string"==typeof e.price?e.price:e.price?.amount||"0";return parseFloat(t||"0")}).filter(e=>!isNaN(e)&&e>0);return e.length>0?`~${Math.min(...e).toFixed(2)} WAX`:"N/A"})():"N/A"}),A.jsx("div",{className:"stat-label",children:"Floor Price"})]})]})]}),A.jsx(zt,{collectionName:s.collection_name}),A.jsx("div",{className:"collection-content-navigation",children:A.jsxs("div",{className:"collection-nav-container",children:[A.jsxs("div",{className:"collection-nav-tabs",children:[A.jsx("button",{className:"collection-nav-tab "+("sales"===Y?"active":""),onClick:()=>Q("sales"),children:A.jsxs("div",{className:"tab-content",children:[A.jsx("span",{className:"tab-icon",children:"💰"}),A.jsx("span",{className:"tab-text",children:"Top Sales"}),A.jsx("span",{className:"tab-count",children:$.length})]})}),A.jsx("button",{className:"collection-nav-tab "+("holders"===Y?"active":""),onClick:()=>Q("holders"),children:A.jsxs("div",{className:"tab-content",children:[A.jsx("span",{className:"tab-icon",children:"👥"}),A.jsx("span",{className:"tab-text",children:"Holders"}),A.jsx("span",{className:"tab-count",children:w.length})]})}),A.jsx("button",{className:"collection-nav-tab "+("schemas"===Y?"active":""),onClick:()=>Q("schemas"),children:A.jsxs("div",{className:"tab-content",children:[A.jsx("span",{className:"tab-icon",children:"📋"}),A.jsx("span",{className:"tab-text",children:"Schemas"}),A.jsx("span",{className:"tab-count",children:de.length})]})}),A.jsx("button",{className:"collection-nav-tab "+("templates"===Y?"active":""),onClick:()=>Q("templates"),children:A.jsxs("div",{className:"tab-content",children:[A.jsx("span",{className:"tab-icon",children:"🎨"}),A.jsx("span",{className:"tab-text",children:"Templates"}),A.jsx("span",{className:"tab-count",children:me.length})]})}),A.jsx("button",{className:"collection-nav-tab "+("similar"===Y?"active":""),onClick:()=>Q("similar"),children:A.jsxs("div",{className:"tab-content",children:[A.jsx("span",{className:"tab-icon",children:"🔗"}),A.jsx("span",{className:"tab-text",children:"Similar"}),A.jsx("span",{className:"tab-count",children:B.length})]})}),A.jsx("button",{className:"collection-nav-tab "+("chat"===Y?"active":""),onClick:()=>Q("chat"),children:A.jsxs("div",{className:"tab-content",children:[A.jsx("span",{className:"tab-icon",children:"💬"}),A.jsx("span",{className:"tab-text",children:"Chat"}),A.jsx("span",{className:"tab-count",children:"0"})]})})]}),A.jsx("div",{className:"nav-indicator"})]})}),A.jsxs("div",{className:"tab-content-area",children:["sales"===Y&&A.jsxs("div",{className:"sales-section",children:[A.jsx("div",{className:"sales-grid",children:$.length>0?$.map((e,a)=>A.jsxs("div",{className:"sale-item",children:[A.jsxs("div",{className:"sale-rank",children:["#",a+1]}),A.jsxs("div",{className:"sale-media",children:[A.jsx(Fe,{imageUrl:Qe(e),videoUrl:Ze(e),alt:String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"NFT"),className:"sale-image",controls:!0,muted:!0,loop:!0,enableAnimations:t.enableAnimatedNFTs}),A.jsx("div",{className:"zoom-overlay",onClick:()=>{const t=Qe(e),a=String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"NFT");t&&le({url:t,name:a}),ie(!0)},children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),A.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]}),A.jsxs("div",{className:"sale-details",children:[A.jsx("div",{className:"sale-name",children:e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"Unnamed NFT"}),A.jsxs("div",{className:"sale-template",children:["Template #",e.assets?.[0]?.template?.template_id]}),A.jsx("div",{className:"sale-price",children:e.price?(parseInt(e.price.amount)/Math.pow(10,e.price.token_precision)).toFixed(e.price.token_precision)+" "+e.price.token_symbol:"N/A"}),A.jsx("div",{className:"sale-date",children:je(e.updated_at_time||"")})]})]},e.sale_id||a)):A.jsx("div",{className:"no-data",children:"No sales data available"})}),O&&A.jsx("div",{className:"load-more-section",children:A.jsx("button",{className:"load-more-btn",onClick:()=>{O&&R(e=>e+1)},children:"Load More Sales"})})]}),"holders"===Y&&A.jsxs("div",{className:"holders-section",children:[A.jsx("div",{className:"holders-grid",children:w.length>0?w.map((e,t)=>A.jsxs("div",{className:"holder-item",children:[A.jsxs("div",{className:"holder-rank",children:["#",t+1]}),A.jsx(n,{to:`/profile-lookup/${e.account}`,className:"holder-account clickable",children:e.account}),A.jsxs("div",{className:"holder-count",children:[e.assets," assets"]})]},t)):A.jsx("div",{className:"no-data",children:"No holders data available"})}),P&&A.jsx("div",{className:"load-more-section",children:A.jsx("button",{className:"load-more-btn",onClick:async()=>{if(e&&!C&&P){E(!0);try{const t=_+1,a=500*(t-1),s=await ye.getCollectionHolders(e,500,a);s&&s.length>0?(k(e=>[...e,...s]),S(t),T(500===s.length)):T(!1)}catch(t){console.error("Error loading more holders:",t),T(!1)}finally{E(!1)}}},disabled:C,children:C?"Loading...":"Load More Holders"})})]}),"similar"===Y&&A.jsx("div",{className:"similar-collections",children:A.jsx("div",{className:"similar-collections-grid",children:B.length>0?B.slice(0,12).map((e,t)=>A.jsx("div",{className:"similar-collection-item",children:A.jsxs(n,{to:`/collections/${e.collection_name}`,children:[A.jsx("div",{className:"similar-collection-name",children:e.collection_name}),A.jsx("div",{className:"similar-collection-volume",children:"Similar Collection"})]})},t)):A.jsx("div",{className:"no-data",children:"No similar collections found"})})}),"chat"===Y&&A.jsx("div",{className:"chat-section",children:A.jsx("div",{className:"chat-container",children:A.jsx(Xt,{collectionName:e})})}),A.jsxs("div",{className:"search-filter-section",children:[A.jsxs("div",{className:"search-controls",children:[A.jsxs("div",{className:"search-input-container",children:[A.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("input",{type:"text",placeholder:`Search ${Y}...`,value:Z,onChange:e=>ee(e.target.value),className:"search-input"}),Z&&A.jsx("button",{onClick:()=>ee(""),className:"clear-search","aria-label":"Clear search",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),A.jsxs("div",{className:"sort-container",children:[A.jsx("label",{htmlFor:"sortBy",children:"Sort by:"}),A.jsxs("select",{id:"sortBy",value:ae,onChange:e=>se(e.target.value),className:"sort-select",children:[A.jsx("option",{value:"name",children:"Name"}),A.jsx("option",{value:"created",children:"Created Date"}),"templates"===Y&&A.jsx("option",{value:"supply",children:"Supply"})]})]})]}),Z&&A.jsx("div",{className:"search-results-info",children:A.jsxs("p",{children:["Found ","schemas"===Y?de.length:me.length,' results for "',Z,'"']})}),"schemas"===Y&&A.jsx("div",{className:"schemas-section",children:0===de.length?A.jsx("div",{className:"empty-state",children:Z?A.jsxs(A.Fragment,{children:[A.jsx("svg",{className:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("h3",{children:"No schemas found"}),A.jsxs("p",{children:['No schemas match your search "',Z,'"']}),A.jsx("button",{onClick:()=>ee(""),className:"clear-search-button",children:"Clear Search"})]}):A.jsx("p",{children:"No schemas found for this collection."})}):A.jsx("div",{className:"schemas-grid",children:de.map(e=>A.jsxs("div",{className:"schema-card",children:[A.jsxs("div",{className:"schema-header",children:[A.jsx("h3",{children:e.schema_name}),A.jsx("button",{className:"view-templates-btn",onClick:()=>{q(e.schema_name),Q("templates")},children:"View Templates"})]}),A.jsxs("div",{className:"schema-format",children:[A.jsx("h4",{children:"Attributes:"}),A.jsx("div",{className:"attributes-list",children:e.format.map((e,t)=>A.jsxs("div",{className:"attribute",children:[A.jsx("span",{className:"attr-name",children:e.name}),A.jsx("span",{className:"attr-type",children:e.type})]},t))})]})]},e.schema_name))})}),"templates"===Y&&A.jsxs("div",{className:"templates-section",children:[H&&A.jsxs("div",{className:"schema-filter",children:[A.jsx("label",{children:"Filter by Schema:"}),A.jsxs("select",{value:H,onChange:e=>q(e.target.value),children:[A.jsx("option",{value:"",children:"All Schemas"}),r.map(e=>A.jsx("option",{value:e.schema_name,children:e.schema_name},e.schema_name))]})]}),0===me.length?A.jsx("div",{className:"empty-state",children:Z?A.jsxs(A.Fragment,{children:[A.jsx("svg",{className:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("h3",{children:"No templates found"}),A.jsxs("p",{children:['No templates match your search "',Z,'"']}),A.jsx("button",{onClick:()=>ee(""),className:"clear-search-button",children:"Clear Search"})]}):A.jsxs("p",{children:["No templates found",H?` for schema "${H}"`:" for this collection","."]})}):A.jsx("div",{className:"templates-grid",children:me.map(t=>{return A.jsxs(n,{to:`/collections/${e}/templates/${t.template_id}`,className:"template-card",children:[be(t,"template-image"),A.jsxs("div",{className:"template-info",children:[A.jsx("h4",{children:String(t.immutable_data?.name||`Template #${t.template_id}`)}),A.jsxs("p",{className:"template-schema",children:["Template ID: ",t.template_id]}),A.jsxs("p",{className:"template-supply",children:["Supply: ",(a=t.issued_supply,s=t.max_supply,"0"===s?`${a} (Unlimited)`:`${a} / ${s}`)]})]})]},t.template_id);var a,s})})]})]})]}),ne&&A.jsx(Ht,{isOpen:ne,imageUrl:re.url,imageName:re.name,onClose:()=>ie(!1)}),ce&&A.jsx(Oe,{isOpen:ce,onClose:()=>oe(!1),title:s?.name||s?.collection_name||"Collection",description:String(s?.data?.description||`Check out this amazing collection: ${s?.name||s?.collection_name}`),imageUrl:ve(s?.img||""),shareUrl:`${window.location.origin}/collections/${s?.collection_name}`,defaultShareText:`Check out the ${s?.name||s?.collection_name} collection on PxMarket! 🎮✨ Explore it at market.pixeljourney.xyz`,type:"collection"})]}):A.jsx("div",{className:"collection-detail-container",children:A.jsxs("div",{className:"error-state",children:[A.jsx("h2",{children:"Collection Not Found"}),A.jsxs("p",{children:['The collection "',e,'" could not be found.']}),A.jsx(n,{to:"/collections",className:"back-link",children:"← Back to Collections"})]})})});qt.displayName="CollectionDetail";const Jt=()=>{const{collectionName:e,templateId:t}=l(),{settings:s}=ue(),[i,r]=a.useState(null),[c,o]=a.useState(null),[d,u]=a.useState(null),[m,h]=a.useState([]),[p,f]=a.useState(!1),[x,g]=a.useState(!1),[v,y]=a.useState(1),[j,b]=a.useState(!0),[N,w]=a.useState(!1),k=a.useCallback(async()=>{if(e&&t){f(!0);try{const[a,s,n]=await Promise.all([ye.getCollectionTemplates(e),ye.getCollectionDetails(e),ye.getCollectionSchemas(e)]),i=a.find(e=>e.template_id===t);if(r(i||null),o(s),i){const a=await ye.getCollectionAssets(e,void 0,t,1);if(a.length>0){const e=a[0].schema_name,t=n.find(t=>t.schema_name===e);u(t||null)}}}catch(a){console.error("Error loading template data:",a)}finally{f(!1)}}},[e,t,f,r,o,u]),_=a.useCallback(async a=>{if(e&&t){g(!0);try{const s=await ye.getCollectionAssets(e,void 0,t,20);h(1===a?s:e=>[...e,...s]),b(20===s.length),y(a)}catch(s){console.error("Error loading assets:",s)}finally{g(!1)}}},[e,t,g,h,b,y]);a.useEffect(()=>{e&&t&&(k(),_(1))},[e,t,k,_]);const S=e=>new Date(1e3*parseInt(e)).toLocaleDateString(),C=e=>"object"==typeof e&&null!==e?JSON.stringify(e):String(e);return p?A.jsx("div",{className:"template-detail-container",children:A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading template details..."})]})}):i?A.jsxs("div",{className:"template-detail-container",children:[A.jsxs("div",{className:"breadcrumb",children:[A.jsx(n,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx(n,{to:`/collections/${e}`,className:"breadcrumb-link",children:c?.name||e}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx("span",{className:"breadcrumb-current",children:`Template #${t}`})]}),A.jsxs("div",{className:"template-content",children:[A.jsxs("div",{className:"template-header",children:[A.jsx("div",{className:"template-image-container",children:i&&A.jsx(Fe,{imageUrl:Ke(i),videoUrl:Ye(i),alt:"Template",className:"template-image",enableAnimations:s.enableAnimatedNFTs})}),A.jsxs("div",{className:"template-info",children:[A.jsx("h1",{children:`Template #${t}`}),A.jsxs("p",{className:"template-id",children:["Template ID: ",i.template_id]}),A.jsxs("p",{className:"template-schema",children:["Schema: ",d?.schema_name||"Loading..."]}),A.jsxs("p",{className:"template-collection",children:["Collection: ",c?.name||c?.collection_name||"Loading..."]}),A.jsxs("div",{className:"template-stats",children:[A.jsxs("div",{className:"stat",children:[A.jsx("span",{className:"stat-value",children:i.issued_supply}),A.jsx("span",{className:"stat-label",children:"Minted"})]}),A.jsxs("div",{className:"stat",children:[A.jsx("span",{className:"stat-value",children:"0"===i.max_supply?"∞":i.max_supply}),A.jsx("span",{className:"stat-label",children:"Max Supply"})]}),A.jsxs("div",{className:"stat",children:[A.jsx("span",{className:"stat-value",children:m.length}),A.jsx("span",{className:"stat-label",children:"Assets Loaded"})]})]}),A.jsxs("p",{className:"template-created",children:["Created: ",S(i.created_at_time)]}),A.jsxs("button",{className:"share-btn",onClick:()=>w(!0),style:{marginTop:"20px",padding:"12px 24px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:"12px",color:"white",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"8px"},children:[A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"})}),"Share Template"]})]})]}),i.immutable_data&&Object.keys(i.immutable_data).length>0&&A.jsxs("div",{className:"template-attributes",children:[A.jsx("h2",{children:"Template Attributes"}),A.jsx("div",{className:"attributes-grid",children:Object.entries(i.immutable_data).map(([e,t])=>A.jsxs("div",{className:"attribute-item",children:[A.jsx("span",{className:"attribute-name",children:e}),A.jsx("span",{className:"attribute-value",children:C(t)})]},e))})]}),d&&d.format&&A.jsxs("div",{className:"schema-format",children:[A.jsx("h2",{children:"Schema Format"}),A.jsx("div",{className:"format-grid",children:d.format.map((e,t)=>A.jsxs("div",{className:"format-item",children:[A.jsx("span",{className:"format-name",children:String(e.name)}),A.jsx("span",{className:"format-type",children:String(e.type)})]},t))})]}),A.jsxs("div",{className:"assets-section",children:[A.jsxs("h2",{children:["Assets (",i.issued_supply," total)"]}),0!==m.length||x?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"assets-grid",children:m.map(e=>A.jsxs(n,{to:`/assets/${e.asset_id}`,className:"asset-card",children:[A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name||`Asset #${e.asset_id}`,className:"asset-image",enableAnimations:s.enableAnimatedNFTs}),A.jsxs("div",{className:"asset-info",children:[A.jsx("h4",{children:e.name||`Asset #${e.asset_id}`}),A.jsxs("p",{className:"asset-id",children:["#",e.asset_id]}),A.jsxs("p",{className:"asset-owner",children:["Owner: ",e.owner]}),A.jsxs("p",{className:"asset-minted",children:["Minted: ",S(e.minted_at_time)]})]})]},e.asset_id))}),j&&A.jsx("div",{className:"load-more-container",children:A.jsx("button",{className:"load-more-btn",onClick:()=>{!x&&j&&_(v+1)},disabled:x,children:x?"Loading...":"Load More Assets"})})]}):A.jsx("div",{className:"empty-state",children:A.jsx("p",{children:"No assets found for this template."})})]})]}),i&&A.jsx(Oe,{isOpen:N,onClose:()=>w(!1),title:`Template #${t}`,description:`${c?.name||c?.collection_name} collection`,imageUrl:Ke(i),shareUrl:`${window.location.origin}/collections/${e}/templates/${t}`,defaultShareText:`Check out this amazing template: Template #${t} from ${c?.name||c?.collection_name} collection! 🎨✨ View it at ${window.location.origin}/collections/${e}/templates/${t}`,type:"template"})]}):A.jsx("div",{className:"template-detail-container",children:A.jsxs("div",{className:"error-state",children:[A.jsx("h2",{children:"Template Not Found"}),A.jsxs("p",{children:['The template "',t,'" could not be found in collection "',e,'".']}),A.jsx(n,{to:`/collections/${e}`,className:"back-link",children:"← Back to Collection"})]})})},Vt=()=>{const{assetId:e}=l(),[t,s]=a.useState(null),[i,r]=a.useState(!1),[c,o]=a.useState(null),[d,u]=a.useState(!1),[m,h]=a.useState(""),{isConnected:p,purchaseNFT:f,login:x}=R(),{showSuccess:g,showError:v,showWarning:y}=_e(),j=a.useCallback(async()=>{if(e){r(!0);try{const t=await ye.getAssetDetails(e);s(t)}catch(t){console.error("Error loading asset data:",t)}finally{r(!1)}}},[e]),b=a.useCallback(async()=>{if(e){u(!0);try{const s=await ye.getMarketplaceNFTs({page:1,limit:1,asset_id:e});if(s.data&&s.data.length>0){const e=s.data[0],n={sale_id:e.sale_id,asset_id:e.asset_id,name:t?.name||`Asset #${e.asset_id}`,image:String(t?.data?.img||t?.template?.immutable_data?.img||""),price:e.price,seller:e.seller,collection:t?.collection?.collection_name||"Unknown",schema:t?.schema?.schema_name||"Unknown",template_mint:void 0,max_supply:t?.template?.max_supply||void 0,traits:t?.data?Object.fromEntries(Object.entries(t.data).filter(([,e])=>null!=e)):{}};if(o(n),n.price)try{const e=parseFloat(n.price.replace(" WAX","")),t=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd"),a=await t.json(),s=(e*(a.wax?.usd||0)).toFixed(2);h(`$${s} USD`)}catch(a){console.error("Error fetching USD price:",a)}}else o(null),h("")}catch(a){console.error("Error checking listing status:",a),o(null)}finally{u(!1)}}},[e]);a.useEffect(()=>{e&&(j(),b())},[e,j,b]);const N=e=>{return e?e.startsWith("http")?e:(t=e)?t.startsWith("http")?t:Je(t):"":"https://pixeljourney.xyz/img/toppixals/10.webp";var t},w=()=>t?Ve(t)??"https://pixeljourney.xyz/img/toppixals/10.webp":"https://pixeljourney.xyz/img/toppixals/10.webp",k=e=>new Date(1e3*parseInt(e)).toLocaleString(),_=e=>{if(null==e)return A.jsx("span",{className:"null-value",children:"null"});if("boolean"==typeof e)return A.jsx("span",{className:"boolean-value",children:e.toString()});if("number"==typeof e)return A.jsx("span",{className:"number-value",children:e.toLocaleString()});if("object"==typeof e)return A.jsx("pre",{className:"object-value",children:JSON.stringify(e,null,2)});const t=String(e);return t.match(/\.(jpg|jpeg|png|gif|webp)$/i)||t.startsWith("Qm")?A.jsxs("div",{className:"image-attribute",children:[A.jsx("img",{src:N(t),alt:"Attribute image",className:"attribute-image",onError:e=>{e.currentTarget.style.display="none"}}),A.jsx("span",{className:"image-hash",children:t})]}):A.jsx("span",{className:"string-value",children:t})};if(i)return A.jsx("div",{className:"asset-detail-container",children:A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading asset details..."})]})});if(!t)return A.jsx("div",{className:"asset-detail-container",children:A.jsxs("div",{className:"error-state",children:[A.jsx("h2",{children:"Asset Not Found"}),A.jsxs("p",{children:['The asset "',e,'" could not be found.']}),A.jsx(n,{to:"/collections",className:"back-link",children:"← Back to Collections"})]})});const S=t?Ge(t):null,C=t?{...t.template?.immutable_data,...t.data}:{};return A.jsx("div",{className:"asset-detail-container",children:A.jsxs("div",{className:"asset-content",children:[A.jsxs("div",{className:"breadcrumb",children:[A.jsx(n,{to:"/",className:"breadcrumb-link",children:"Home"}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx(n,{to:"/collections",className:"breadcrumb-link",children:"Collections"}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx(n,{to:`/collections/${t.collection.collection_name}`,className:"breadcrumb-link",children:t.collection.name||t.collection.collection_name}),A.jsx("span",{className:"breadcrumb-separator",children:"›"}),A.jsx("span",{className:"breadcrumb-current",children:t.name||`Asset #${e}`})]}),A.jsxs("div",{className:"asset-header",children:[A.jsx("div",{className:"asset-media-container",children:S?A.jsx("video",{src:S,className:"asset-video",controls:!0,poster:w(),children:"Your browser does not support the video tag."}):A.jsx("img",{src:w(),alt:t.name||`Asset #${e}`,className:"asset-image",onError:()=>{}})}),A.jsxs("div",{className:"asset-info",children:[A.jsx("h1",{children:t.name||`Asset #${e}`}),A.jsxs("p",{className:"asset-id",children:["Asset ID: ",t.asset_id]}),A.jsxs("div",{className:"asset-links",children:[A.jsxs("p",{className:"asset-collection",children:["Collection:",A.jsx(n,{to:`/collections/${t.collection.collection_name}`,children:t.collection.name||t.collection.collection_name})]}),A.jsxs("p",{className:"asset-template",children:["Template:",A.jsx(n,{to:`/collections/${t.collection.collection_name}/templates/${t.template.template_id}`,children:t.template?.immutable_data?.name||`#${t.template.template_id}`})]}),A.jsxs("p",{className:"asset-schema",children:["Schema: ",t.schema.schema_name]})]}),A.jsxs("div",{className:"asset-ownership",children:[A.jsxs("div",{className:"owner-info",children:[A.jsx("span",{className:"owner-label",children:"Owner:"}),A.jsx("span",{className:"owner-address",children:t.owner})]}),A.jsxs("div",{className:"author-info",children:[A.jsx("span",{className:"author-label",children:"Collection Author:"}),A.jsx("span",{className:"author-address",children:t.owner||"Unknown"})]})]}),d?A.jsx("div",{className:"listing-status loading",children:A.jsx("span",{children:"Checking listing status..."})}):c?A.jsxs("div",{className:"listing-status available",children:[A.jsxs("div",{className:"listing-info",children:[A.jsx("h3",{children:"Available for Sale"}),A.jsxs("div",{className:"price-display",children:[A.jsx("span",{className:"price-wax",children:c.price}),m&&A.jsx("span",{className:"price-usd",children:m})]})]}),A.jsx("button",{className:"buy-now-btn",onClick:async()=>{if(c)try{if(!p){y("Please connect your wallet to purchase this NFT");try{await x()}catch(e){return void console.error("Login failed:",e)}}if(!c.sale_id||!c.price)return void v("This NFT is not available for purchase");const t=c.price.replace(" WAX","");console.log("Purchasing NFT:",c.sale_id,"for",t,"WAX"),await f(c.sale_id,t),g(`Successfully purchased ${c.name||"NFT"}!`),b()}catch(e){console.error("Purchase failed:",e);const t=e instanceof Error?e.message:"Unknown error occurred";v(`Purchase failed: ${t}`)}},disabled:!p,children:p?"Buy Now":"Connect Wallet to Buy"})]}):A.jsx("div",{className:"listing-status not-listed",children:A.jsx("span",{children:"Not currently listed for sale"})}),A.jsxs("div",{className:"asset-timestamps",children:[A.jsxs("div",{className:"timestamp",children:[A.jsx("span",{className:"timestamp-label",children:"Minted:"}),A.jsx("span",{className:"timestamp-value",children:k(t.minted_at_time)})]}),A.jsxs("div",{className:"timestamp",children:[A.jsx("span",{className:"timestamp-label",children:"Last Transfer:"}),A.jsx("span",{className:"timestamp-value",children:k(t.transferred_at_time)})]}),A.jsxs("div",{className:"timestamp",children:[A.jsx("span",{className:"timestamp-label",children:"Last Update:"}),A.jsx("span",{className:"timestamp-value",children:k(t.updated_at_time)})]})]}),t.burned_by_account&&A.jsxs("div",{className:"burn-info",children:[A.jsx("span",{className:"burn-label",children:"🔥 Burned by:"}),A.jsx("span",{className:"burn-account",children:t.burned_by_account}),A.jsx("span",{className:"burn-time",children:k(t.burned_at_time)})]})]})]}),A.jsxs("div",{className:"template-info-section",children:[A.jsx("h2",{children:"Template Information"}),A.jsxs("div",{className:"template-stats",children:[A.jsxs("div",{className:"template-stat",children:[A.jsx("span",{className:"stat-label",children:"Template ID:"}),A.jsx("span",{className:"stat-value",children:t.template.template_id})]}),A.jsxs("div",{className:"template-stat",children:[A.jsx("span",{className:"stat-label",children:"Max Supply:"}),A.jsx("span",{className:"stat-value",children:"0"===t.template.max_supply?"Unlimited":t.template.max_supply})]}),A.jsxs("div",{className:"template-stat",children:[A.jsx("span",{className:"stat-label",children:"Issued Supply:"}),A.jsx("span",{className:"stat-value",children:t.template.issued_supply})]})]})]}),Object.keys(C).length>0&&A.jsxs("div",{className:"asset-attributes",children:[A.jsx("h2",{children:"Attributes"}),A.jsx("div",{className:"attributes-grid",children:Object.entries(C).map(([e,t])=>A.jsxs("div",{className:"attribute-item",children:[A.jsx("span",{className:"attribute-name",children:e}),A.jsx("div",{className:"attribute-value",children:_(t)})]},e))})]}),A.jsxs("div",{className:"schema-format",children:[A.jsx("h2",{children:"Schema Format"}),A.jsx("div",{className:"format-grid",children:t.schema.format?.map((e,t)=>A.jsxs("div",{className:"format-item",children:[A.jsx("span",{className:"format-name",children:e.name}),A.jsx("span",{className:"format-type",children:e.type})]},t))})]}),t.backed_tokens&&t.backed_tokens.length>0&&A.jsxs("div",{className:"backed-tokens",children:[A.jsx("h2",{children:"Backed Tokens"}),A.jsx("div",{className:"tokens-list",children:t.backed_tokens.map((e,t)=>A.jsx("div",{className:"token-item",children:A.jsx("pre",{children:JSON.stringify(e,null,2)})},t))})]})]})})},Gt=()=>{const{saleId:e}=l(),t=i(),[s,n]=a.useState(null),[r,c]=a.useState(!0),[o,d]=a.useState(null),[u,m]=a.useState(""),[h,p]=a.useState(!1),[f,x]=a.useState(!1),[g,v]=a.useState(!1),[y,j]=a.useState(!1),[b,N]=a.useState(0);a.useEffect(()=>{e&&w()},[e]);const w=async()=>{if(e)try{c(!0),d(null);const t=`${ye.atomicMarketAPI}/atomicmarket/v1/sales/${e}`,a=await ye.fetchWithRetry(t),s=await a.json();if(s.success&&s.data){const e=s.data;N(e.state);const t={sale_id:e.sale_id,asset_id:e.assets[0]?.asset_id||"",name:e.assets[0]?.name||`${e.assets[0]?.collection?.collection_name||"Unknown"} #${e.assets[0]?.asset_id}`,image:k(e.assets[0]),price:`${(parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision)).toFixed(4)} ${e.price.token_symbol}`,seller:e.seller,collection:e.assets[0]?.collection?.collection_name||"Unknown",schema:e.assets[0]?.schema?.schema_name||"Unknown",template_mint:parseInt(e.assets[0]?.template?.template_id||"0")||0,max_supply:e.assets[0]?.template?.max_supply||"0",traits:Object.fromEntries(Object.entries(e.assets[0]?.data||{}).map(([e,t])=>[e,null==t?"":"string"==typeof t||"number"==typeof t||"boolean"==typeof t?t:String(t)]))};n(t);const a=parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision),i=await ye.getUSDPrice(a);m(i)}else d("Listing not found")}catch(t){console.error("Error loading listing:",t),d(`Failed to load listing data: ${t instanceof Error?t.message:"Unknown error"}`)}finally{c(!1)}},k=e=>e?e.data?.img?e.data.img.startsWith("http")?e.data.img:`https://ipfs.io/ipfs/${e.data.img}`:e.data?.image?e.data.image.startsWith("http")?e.data.image:`https://ipfs.io/ipfs/${e.data.image}`:e.template?.immutable_data?.img?e.template.immutable_data.img.startsWith("http")?e.template.immutable_data.img:`https://ipfs.io/ipfs/${e.template.immutable_data.img}`:e.template?.immutable_data?.image?e.template.immutable_data.image.startsWith("http")?e.template.immutable_data.image:`https://ipfs.io/ipfs/${e.template.immutable_data.image}`:"https://pixeljourney.xyz/img/toppixals/10.webp":"",{isConnected:_,purchaseNFT:S,login:C}=R(),{showSuccess:E,showError:P,showWarning:T}=_e();return r?A.jsx("div",{className:"listing-detail-container",children:A.jsxs("div",{className:"loading-container",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading listing..."})]})}):o||!s?A.jsx("div",{className:"listing-detail-container",children:A.jsxs("div",{className:"error-container",children:[A.jsx("h2",{children:"Listing Not Found"}),A.jsx("p",{children:o||"The requested listing could not be found."}),A.jsx("button",{onClick:()=>t("/marketplace"),className:"btn-primary",children:"Back to Marketplace"})]})}):A.jsxs("div",{className:"listing-detail-container",children:[A.jsxs("div",{className:"listing-detail-header",children:[A.jsx("button",{onClick:()=>t(-1),className:"back-button",children:"← Back"}),A.jsx("h1",{children:"Listing Details"})]}),A.jsxs("div",{className:"listing-detail-content",children:[A.jsx("div",{className:"listing-image-section",children:A.jsx("div",{className:"listing-image",children:s.image.includes(".mp4")||s.image.includes(".webm")?A.jsx("video",{src:s.image,controls:!0,muted:!0,loop:!0,className:"listing-media"}):A.jsxs(A.Fragment,{children:[A.jsx("img",{src:s.image,alt:s.name,className:"listing-media",onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),A.jsx("div",{className:"zoom-overlay",onClick:()=>j(!0),children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),A.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]})})}),A.jsxs("div",{className:"listing-info-section",children:[A.jsxs("div",{className:"listing-header",children:[A.jsx("h2",{children:s.name}),A.jsxs("div",{className:"listing-actions",children:[A.jsx("button",{onClick:()=>p(!0),className:"listing-detail-nav-btn",children:"📋 View Details"}),A.jsx("button",{onClick:()=>x(!0),className:"listing-detail-nav-btn",children:"💰 Make Offer"}),A.jsx("button",{onClick:()=>v(!0),className:"listing-detail-nav-btn",children:"🔗 Share"})]})]}),A.jsxs("div",{className:"listing-price-section",children:[A.jsxs("div",{className:"price-display",children:[A.jsx("div",{className:"price-main",children:s.price}),A.jsx("div",{className:"price-usd",children:u}),A.jsx("div",{className:"sale-status-display",children:A.jsx("span",{className:"status-badge "+(1===b?"status-active":3===b?"status-sold":"status-canceled"),children:1===b?"🔄 Available":3===b?"✅ Sold":"❌ Canceled"})})]}),1===b?A.jsx("button",{onClick:async()=>{if(s)try{if(!_){T("Please connect your wallet to purchase this NFT");try{await C()}catch(e){return void console.error("Login failed:",e)}}if(!s.sale_id||!s.price)return void P("This NFT is not available for purchase");const a=s.price.replace(" WAX","");console.log("Purchasing NFT:",s.sale_id,"for",a,"WAX"),await S(s.sale_id,a),E(`Successfully purchased ${s.name||"NFT"}!`),t("/marketplace")}catch(e){console.error("Purchase failed:",e);const t=e instanceof Error?e.message:"Unknown error occurred";P(`Purchase failed: ${t}`)}},className:"listing-detail-nav-btn listing-detail-primary-btn purchase-btn",children:"🛒 Buy Now"}):A.jsx("button",{disabled:!0,className:"listing-detail-nav-btn listing-detail-primary-btn purchase-btn",children:3===b?"✅ Sold":"❌ Not Available"})]}),A.jsxs("div",{className:"listing-details",children:[A.jsxs("div",{className:"detail-item",children:[A.jsx("span",{className:"detail-label",children:"Collection:"}),A.jsx("span",{className:"detail-value link",onClick:()=>{s&&t(`/collections/${s.collection}`)},children:s.collection})]}),A.jsxs("div",{className:"detail-item",children:[A.jsx("span",{className:"detail-label",children:"Schema:"}),A.jsx("span",{className:"detail-value",children:s.schema})]}),A.jsxs("div",{className:"detail-item",children:[A.jsx("span",{className:"detail-label",children:"Asset ID:"}),A.jsx("span",{className:"detail-value link",onClick:()=>{s&&s.asset_id&&t(`/assets/${s.asset_id}`)},children:s.asset_id})]}),A.jsxs("div",{className:"detail-item",children:[A.jsx("span",{className:"detail-label",children:"Seller:"}),A.jsx("span",{className:"detail-value link",onClick:()=>{s&&s.seller&&t(`/user-profile-lookup?user=${encodeURIComponent(s.seller)}`)},children:s.seller})]}),A.jsxs("div",{className:"detail-item",children:[A.jsx("span",{className:"detail-label",children:"Sale ID:"}),A.jsx("span",{className:"detail-value",children:s.sale_id})]}),s.template_mint&&s.template_mint>0&&A.jsxs("div",{className:"detail-item",children:[A.jsx("span",{className:"detail-label",children:"Mint:"}),A.jsxs("span",{className:"detail-value",children:[s.template_mint," / ","0"===s.max_supply?"∞":s.max_supply]})]})]}),s.traits&&Object.keys(s.traits).length>0&&A.jsxs("div",{className:"listing-attributes",children:[A.jsx("h3",{children:"Attributes"}),A.jsx("div",{className:"attributes-grid",children:Object.entries(s.traits).map(([e,t])=>A.jsxs("div",{className:"attribute-item",children:[A.jsx("span",{className:"attribute-name",children:e}),A.jsx("span",{className:"attribute-value",children:t})]},e))})]})]})]}),A.jsx(et,{nft:s,isOpen:h,onClose:()=>p(!1)}),A.jsx($e,{nft:s,isOpen:f,onClose:()=>x(!1)}),A.jsx(at,{nft:s,isOpen:g,onClose:()=>v(!1)}),A.jsx(Ht,{isOpen:y,onClose:()=>j(!1),imageUrl:s.image,imageName:s.name})]})},Kt=()=>{const{transactionId:e}=l(),t=i(),[s,n]=a.useState(null),[r,c]=a.useState(null),[o,d]=a.useState(!0),[u,m]=a.useState(null),[h,p]=a.useState("overview");a.useEffect(()=>{e&&f(e)},[e]);const f=async e=>{try{d(!0),m(null);const t=await fetch("https://wax.eosrio.io/v1/history/get_transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok)throw new Error(`Failed to fetch transaction: ${t.status}`);const a=await t.json();if(!a.id)throw new Error("Transaction not found");const s={transaction_id:a.id,block_num:a.block_num,block_time:a.block_time,action_name:a.trx?.transaction?.actions?.[0]?.name||"unknown",actor:a.trx?.transaction?.actions?.[0]?.authorization?.[0]?.actor||"unknown",receiver:a.trx?.transaction?.actions?.[0]?.account||"unknown",status:"executed"===a.receipt?.status?"success":"failed",cpu_usage_us:a.receipt?.cpu_usage_us||0,net_usage_words:a.receipt?.max_net_usage_words||a.receipt?.net_usage_words||0,traces:a.traces||[]},i=a.trx?.transaction?.actions?.[0]?.data;i&&(i.asset_ids&&(s.asset_id=i.asset_ids[0]),i.from&&(s.from=i.from),i.to&&(s.to=i.to),i.memo&&(s.memo=i.memo),i.listing_price_to_assert&&(s.price=`${parseFloat(i.listing_price_to_assert.split(" ")[0])} WAX`)),n(s);const r=await fetch("https://wax.eosrio.io/v1/chain/get_block",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({block_num_or_id:a.block_num})});if(r.ok){const e=await r.json();c({block_num:e.block_num,block_id:e.id,timestamp:e.timestamp,producer:e.producer,transaction_count:e.transactions?.length||0})}}catch(t){console.error("Error fetching transaction details:",t),m(t instanceof Error?t.message:"Failed to load transaction details")}finally{d(!1)}},x=e=>{t(`/user-profile-lookup?user=${encodeURIComponent(e)}`)};return o?A.jsx("div",{className:"page-content",children:A.jsx("div",{className:"transaction-details-container",children:A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading transaction details..."})]})})}):u||!s?A.jsx("div",{className:"page-content",children:A.jsx("div",{className:"transaction-details-container",children:A.jsxs("div",{className:"error-state",children:[A.jsx("h2",{children:"Transaction Not Found"}),A.jsx("p",{children:u||"The requested transaction could not be found."}),A.jsx("button",{onClick:()=>t(-1),className:"btn btn-primary",children:"Go Back"})]})})}):A.jsx("div",{className:"page-content",children:A.jsxs("div",{className:"transaction-details-container",children:[A.jsxs("div",{className:"transaction-header",children:[A.jsx("button",{onClick:()=>t(-1),className:"back-button",children:"← Back"}),A.jsxs("div",{className:"transaction-title",children:[A.jsx("h1",{children:"Transaction Details"}),A.jsxs("div",{className:"transaction-id",children:[A.jsxs("span",{children:["ID: ",s.transaction_id]}),A.jsx("button",{onClick:()=>{return e=s.transaction_id,void navigator.clipboard.writeText(e);var e},className:"copy-button",title:"Copy transaction ID",children:"📋"})]})]}),A.jsxs("div",{className:`transaction-status ${s.status}`,children:["success"===s.status?"✅":"❌"," ",s.status.toUpperCase()]})]}),A.jsxs("div",{className:"tab-navigation",children:[A.jsx("button",{className:"tab "+("overview"===h?"active":""),onClick:()=>p("overview"),children:"Overview"}),A.jsx("button",{className:"tab "+("traces"===h?"active":""),onClick:()=>p("traces"),children:"Action Traces"}),A.jsx("button",{className:"tab "+("raw"===h?"active":""),onClick:()=>p("raw"),children:"Raw Data"})]}),A.jsxs("div",{className:"tab-content",children:["overview"===h&&A.jsxs("div",{className:"overview-tab",children:[A.jsxs("div",{className:"info-section",children:[A.jsx("h3",{children:"Basic Information"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Block Number:"}),A.jsx("span",{children:s.block_num.toLocaleString()})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Timestamp:"}),A.jsx("span",{children:(g=s.block_time,new Date(g+"Z").toLocaleString())})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Action:"}),A.jsx("span",{className:"action-name",children:s.action_name})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Contract:"}),A.jsx("span",{className:"contract-name",children:s.receiver})]})]})]}),A.jsxs("div",{className:"info-section",children:[A.jsx("h3",{children:"Transaction Parties"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Actor:"}),A.jsx("span",{className:"clickable-account",onClick:()=>x(s.actor),children:s.actor})]}),s.from&&s.from!==s.actor&&A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"From:"}),A.jsx("span",{className:"clickable-account",onClick:()=>x(s.from),children:s.from})]}),s.to&&A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"To:"}),A.jsx("span",{className:"clickable-account",onClick:()=>x(s.to),children:s.to})]})]})]}),(s.asset_id||s.price)&&A.jsxs("div",{className:"info-section",children:[A.jsx("h3",{children:"Asset Information"}),A.jsxs("div",{className:"info-grid",children:[s.asset_id&&A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Asset ID:"}),A.jsx("span",{className:"clickable-asset",onClick:()=>{return e=s.asset_id,void t(`/assets/${e}`);var e},children:s.asset_id})]}),s.asset_name&&A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Asset Name:"}),A.jsx("span",{children:s.asset_name})]}),s.collection_name&&A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Collection:"}),A.jsx("span",{children:"string"==typeof s.collection_name?s.collection_name:s.collection_name?.collection_name||s.collection_name?.name||"Unknown"})]}),s.price&&A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Price:"}),A.jsx("span",{className:"price",children:s.price})]})]})]}),A.jsxs("div",{className:"info-section",children:[A.jsx("h3",{children:"Resource Usage"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"CPU Usage:"}),A.jsxs("span",{children:[s.cpu_usage_us.toLocaleString()," μs"]})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"NET Usage:"}),A.jsxs("span",{children:[s.net_usage_words.toLocaleString()," words"]})]})]})]}),r&&A.jsxs("div",{className:"info-section",children:[A.jsx("h3",{children:"Block Information"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Block ID:"}),A.jsx("span",{className:"block-id",children:r.block_id})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Producer:"}),A.jsx("span",{children:r.producer})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("label",{children:"Transactions in Block:"}),A.jsx("span",{children:r.transaction_count})]})]})]}),s.memo&&A.jsxs("div",{className:"info-section",children:[A.jsx("h3",{children:"Memo"}),A.jsx("div",{className:"memo-content",children:s.memo})]})]}),"traces"===h&&A.jsxs("div",{className:"traces-tab",children:[A.jsx("h3",{children:"Action Traces"}),s.traces&&s.traces.length>0?A.jsx("div",{className:"traces-list",children:s.traces.map((e,t)=>A.jsxs("div",{className:"trace-item",children:[A.jsxs("div",{className:"trace-header",children:[A.jsxs("span",{className:"trace-index",children:["#",t+1]}),A.jsx("span",{className:"trace-action",children:e.act?.name||"unknown"}),A.jsx("span",{className:"trace-account",children:e.act?.account||"unknown"})]}),A.jsx("pre",{className:"trace-data",children:JSON.stringify(e,null,2)})]},t))}):A.jsx("p",{children:"No action traces available for this transaction."})]}),"raw"===h&&A.jsxs("div",{className:"raw-tab",children:[A.jsx("h3",{children:"Raw Transaction Data"}),A.jsx("pre",{className:"raw-data",children:JSON.stringify(s,null,2)})]})]})]})});var g},Yt=({isOpen:e,onClose:t,resourceType:s,action:n,onSuccess:i})=>{const[r,l]=a.useState(""),[c,o]=a.useState(!1),{session:d,transact:u}=R();if(!e)return null;const m=s.toUpperCase(),h="stake"===n?"Stake":"Unstake";return A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h2",{children:[h," ",m]}),A.jsx("button",{className:"modal-close",onClick:t,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"resource-info",children:[A.jsx("div",{className:"resource-icon",children:"cpu"===s?"⚡":"🌐"}),A.jsxs("div",{className:"resource-description",children:[A.jsxs("h3",{children:[m," ",h]}),A.jsx("p",{children:"stake"===n?`Stake WAX to increase your ${m} resources. Staked tokens will be locked for 3 days after unstaking.`:`Unstake WAX from your ${m} resources. Tokens will be available after a 3-day waiting period.`})]})]}),A.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),d&&r&&!(parseFloat(r)<=0)){o(!0);try{const e=`${parseFloat(r).toFixed(8)} WAX`;if("stake"===n){const t=[{account:"eosio",name:"delegatebw",authorization:[{actor:d.actor.toString(),permission:d.permission.toString()}],data:{from:d.actor.toString(),receiver:d.actor.toString(),stake_net_quantity:"net"===s?e:"0.00000000 WAX",stake_cpu_quantity:"cpu"===s?e:"0.00000000 WAX",transfer:!1}}];await u(t)}else{const t=[{account:"eosio",name:"undelegatebw",authorization:[{actor:d.actor.toString(),permission:d.permission.toString()}],data:{from:d.actor.toString(),receiver:d.actor.toString(),unstake_net_quantity:"net"===s?e:"0.00000000 WAX",unstake_cpu_quantity:"cpu"===s?e:"0.00000000 WAX"}}];await u(t)}i?.(),t()}catch(a){console.error(`Failed to ${n} ${s.toUpperCase()}:`,a),alert(`Failed to ${n} ${s.toUpperCase()}. Please try again.`)}finally{o(!1)}}},children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"amount",children:"Amount (WAX)"}),A.jsx("input",{type:"number",id:"amount",value:r,onChange:e=>l(e.target.value),placeholder:"Enter WAX amount",min:"0.00000001",step:"0.00000001",required:!0,disabled:c})]}),A.jsxs("div",{className:"form-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:c,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary",disabled:c||!r||parseFloat(r)<=0,children:c?"Processing...":`${h} ${m}`})]})]})]})]})})},Qt=({isOpen:e,onClose:t,action:s,onSuccess:n})=>{const[i,r]=a.useState(""),[l,c]=a.useState(!1),[o,d]=a.useState(null),[u,m]=a.useState(null),[h,p]=a.useState(!1),{session:f,transact:x}=R(),{showSuccess:g,showError:v}=_e();a.useEffect(()=>{e&&f&&y()},[e,f]);const y=async()=>{if(f){p(!0);try{const e=await fetch("https://wax.greymass.com/v1/chain/get_table_rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"eosio",scope:"eosio",table:"rammarket",limit:1})});if(e.ok){const t=await e.json();if(t.rows&&t.rows.length>0){const e=t.rows[0],a=parseFloat(e.quote.balance.split(" ")[0]),s=parseFloat(e.base.balance.split(" ")[0]);d(a/s)}}const t=await fetch("https://wax.greymass.com/v1/chain/get_account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account_name:f.actor.toString()})});if(t.ok){const e=await t.json();m(e.ram_quota-e.ram_usage)}}catch(e){console.error("Failed to fetch RAM data:",e)}finally{p(!1)}}};if(!e)return null;const j="buy"===s?"Buy":"Sell",b="buy"===s?"Amount (WAX)":"Bytes to Sell",N="buy"===s?"Enter WAX amount":"Enter bytes amount";return A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h2",{children:[j," RAM"]}),A.jsx("button",{className:"modal-close",onClick:t,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"resource-info",children:[A.jsx("div",{className:"resource-icon",children:"💾"}),A.jsxs("div",{className:"resource-description",children:[A.jsxs("h3",{children:["RAM ",j]}),A.jsx("p",{children:"buy"===s?"Purchase RAM with WAX tokens. RAM is used to store account data and smart contract state.":"Sell RAM bytes back to the system for WAX tokens. Only sell RAM you don't need."}),A.jsx("div",{className:"ram-market-info",children:h?A.jsx("div",{className:"loading-info",children:A.jsx("span",{children:"Loading RAM market data..."})}):A.jsxs(A.Fragment,{children:[null!==o&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Current RAM Price:"}),A.jsxs("span",{className:"stat-value",children:[(1024*o).toFixed(8)," WAX/KB"]})]}),"sell"===s&&null!==u&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Available RAM:"}),A.jsxs("span",{className:"stat-value",children:[u.toLocaleString()," bytes"]})]}),"buy"===s&&null!==o&&i&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Estimated RAM:"}),A.jsxs("span",{className:"stat-value",children:[Math.floor(parseFloat(i)/o).toLocaleString()," bytes"]})]}),"sell"===s&&null!==o&&i&&A.jsxs("div",{className:"market-stat",children:[A.jsx("span",{className:"stat-label",children:"Estimated WAX:"}),A.jsxs("span",{className:"stat-value",children:[(parseFloat(i)*o).toFixed(8)," WAX"]})]})]})})]})]}),A.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),f&&i&&!(parseFloat(i)<=0)){if("sell"===s&&null!==u){if(Math.floor(parseFloat(i))>u)return void v("Insufficient RAM",`You only have ${u.toLocaleString()} bytes available to sell.`)}c(!0);try{if("buy"===s){const e=`${parseFloat(i).toFixed(8)} WAX`,t=[{account:"eosio",name:"buyram",authorization:[{actor:f.actor.toString(),permission:f.permission.toString()}],data:{payer:f.actor.toString(),receiver:f.actor.toString(),quant:e}}];await x(t),g("RAM Purchase Successful",`Successfully purchased RAM with ${e}!`)}else{const e=Math.floor(parseFloat(i)),t=[{account:"eosio",name:"sellram",authorization:[{actor:f.actor.toString(),permission:f.permission.toString()}],data:{account:f.actor.toString(),bytes:e}}];await x(t),g("RAM Sale Successful",`Successfully sold ${e.toLocaleString()} bytes of RAM!`)}n?.(),t(),r("")}catch(a){console.error(`Failed to ${s} RAM:`,a);const e=a instanceof Error?a.message:"Unknown error occurred";v(`RAM ${"buy"===s?"Purchase":"Sale"} Failed`,e)}finally{c(!1)}}},children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"amount",children:b}),A.jsx("input",{type:"number",id:"amount",value:i,onChange:e=>r(e.target.value),placeholder:N,min:"buy"===s?"0.00000001":"1",step:"buy"===s?"0.00000001":"1",required:!0,disabled:l}),"buy"===s&&A.jsx("small",{className:"form-hint",children:"Minimum: 0.00000001 WAX"}),"sell"===s&&A.jsx("small",{className:"form-hint",children:"Enter the number of bytes to sell"})]}),A.jsxs("div",{className:"form-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:t,disabled:l,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary",disabled:l||!i||parseFloat(i)<=0,children:l?"Processing...":`${j} RAM`})]})]})]})]})})},Zt=({token:e,isOpen:t,onClose:s,onSuccess:n})=>{const[i,r]=a.useState(""),[l,c]=a.useState(""),[o,d]=a.useState(""),[u,m]=a.useState(!1),[h,p]=a.useState([]),[f,x]=a.useState(!1),{session:g}=R(),{showSuccess:v,showError:y}=_e(),j=e=>/^[a-z1-5.]{1,12}$/.test(e)&&e.length>=1&&e.length<=12,b=t=>{const a=parseFloat(t),s=parseFloat(e?.balance||"0");return a>0&&a<=s},N=()=>l&&0!==h.length?parseFloat(l)/h.length:0,w=e=>{const t=e.split(" ");if(t.length>0){const e=t[0].split(".")[1];return e?e.length:0}return 8},k=()=>{u||(r(""),c(""),d(""),p([]),x(!1),s())};return t&&e?A.jsx("div",{className:"modal-overlay",onClick:k,children:A.jsxs("div",{className:"modal-content token-transfer-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h2",{children:["Transfer ",e.symbol]}),A.jsx("button",{className:"modal-close",onClick:k,disabled:u,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsx("div",{className:"token-preview",children:A.jsxs("div",{className:"token-info",children:[A.jsx("div",{className:"token-icon",children:"🪙"}),A.jsxs("div",{className:"token-details",children:[A.jsx("h3",{children:e.symbol}),A.jsx("p",{className:"token-contract",children:e.contract}),A.jsxs("p",{className:"token-balance",children:["Available: ",e.balance," ",e.symbol]}),"N/A"!==e.value&&"0.00"!==e.value&&A.jsxs("p",{className:"token-usd-value",children:["≈ $",e.value," USD"]})]})]})}),A.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),!(e&&g&&i.trim()&&l.trim()))return void y("Validation Error","Please fill in all required fields");const a=h.filter(e=>!j(e));if(a.length>0)y("Invalid Account Names",`Invalid WAX account names: ${a.join(", ")}. Account names must be 12 characters, lowercase letters and numbers 1-5.`);else if(b(l)){m(!0);try{const t=w(e.balance),a=[];if(f&&h.length>1){const s=N().toFixed(t)+" "+e.symbol;for(const t of h)a.push({account:e.contract,name:"transfer",authorization:[{actor:g.actor,permission:g.permission}],data:{from:g.actor,to:t,quantity:s,memo:o.trim()||"Bulk transfer via PxMarket - market.pixeljourney.xyz"}})}else{const s=parseFloat(l).toFixed(t)+" "+e.symbol;a.push({account:e.contract,name:"transfer",authorization:[{actor:g.actor,permission:g.permission}],data:{from:g.actor,to:h[0]||i.trim(),quantity:s,memo:o.trim()||"Transferred via PxMarket - market.pixeljourney.xyz"}})}if(await g.transact({actions:a})){const t=f?`${l} ${e.symbol} transferred to ${h.length} recipients successfully!`:`${l} ${e.symbol} transferred successfully!`;v("Transfer Successful",t),n?.(),s(),r(""),c(""),d(""),p([]),x(!1)}}catch(u){K("Token transfer failed","TokenTransferModal",u),y("Transfer Failed",u instanceof Error?u.message:"Unknown error occurred")}finally{m(!1)}}else y("Invalid Amount","Please enter a valid amount that does not exceed your balance")},className:"modal-form token-transfer-form",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"recipient",children:f?"Recipients (comma-separated) *":"Recipient WAX Account *"}),A.jsx("input",{type:"text",id:"recipient",value:i,onChange:e=>(e=>{r(e.toLowerCase());const t=e.split(",").map(e=>e.trim().toLowerCase()).filter(e=>e.length>0);p(t),x(t.length>1)})(e.target.value),placeholder:f?"e.g. pixeljourney,market.pxj,council.pxj":"e.g. pixeljourney",required:!0,disabled:u,className:"recipient-input"}),A.jsx("small",{className:"input-help",children:f?`Enter WAX account names separated by commas (${h.length} recipients detected)`:"Enter a valid WAX account name (12 characters, lowercase letters and numbers 1-5)"}),f&&h.length>1&&A.jsxs("div",{className:"recipients-preview",children:[A.jsx("strong",{children:"Recipients:"}),A.jsx("ul",{children:h.map((e,t)=>A.jsxs("li",{className:j(e)?"valid":"invalid",children:[e," ",!j(e)&&"❌"]},t))})]})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"amount",children:"Amount *"}),A.jsxs("div",{className:"amount-input-wrapper",children:[A.jsx("input",{type:"number",id:"amount",value:l,onChange:e=>c(e.target.value),placeholder:"0.00000000",step:"0.00000001",min:"0",max:e.balance.split(" ")[0],required:!0,disabled:u,className:"amount-input"}),A.jsx("button",{type:"button",className:"max-btn",onClick:()=>{if(e){const t=e.balance.split(" ")[0];c(t)}},disabled:u,children:"MAX"})]}),f&&h.length>1&&l&&A.jsxs("small",{className:"distribution-info",children:["Each recipient will receive: ",N().toFixed(w(e.balance))," ",e.symbol]})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"memo",children:"Memo (Optional)"}),A.jsx("input",{type:"text",id:"memo",value:o,onChange:e=>d(e.target.value),placeholder:"Optional transfer message",maxLength:256,disabled:u,className:"memo-input"})]}),A.jsxs("div",{className:"transfer-warning",children:[A.jsx("div",{className:"warning-icon",children:"⚠️"}),A.jsxs("div",{className:"warning-text",children:[A.jsx("strong",{children:"Warning:"})," This action cannot be undone. Make sure you trust the recipient and have entered the correct account name and amount."]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{type:"button",className:"btn-secondary",onClick:k,disabled:u,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn-primary transfer-btn",disabled:u||!i.trim()||!l.trim()||!j(i.trim())||!b(l),children:u?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"spinner"}),f?"Bulk Transferring...":"Transferring..."]}):f?`Bulk Transfer ${e.symbol}`:`Transfer ${e.symbol}`})]})]})]})]})}):null},ea=()=>{const{isConnected:e,account:t}=R(),[s,n]=a.useState(null),[i,r]=a.useState([]),[l,c]=a.useState([]),[o,d]=a.useState([]),[u,m]=a.useState(!1),[h,p]=a.useState("30d"),[f,x]=a.useState("overview"),g=a.useCallback(async e=>{if(t)try{const a=await ye.getUserTransactions(t,1e3),s="7d"===h?7:"30d"===h?30:"90d"===h?90:365,n=[],i=new Date;for(let t=s;t>=0;t--){const s=new Date(i);s.setDate(s.getDate()-t);const r=s.getTime(),l=a.filter(e=>new Date(e.block_time).getTime()<=r);let c=0,o=0;l.forEach(e=>{if("purchase"===e.type&&e.price){const t=parseFloat(e.price.replace(/[^0-9.-]/g,"")||"0");o+=t,c+=t}else if("sale"===e.type&&e.price){const t=parseFloat(e.price.replace(/[^0-9.-]/g,"")||"0");c-=t}}),0===t?(c=e.totalValue,o=e.totalInvested):0===c&&0===o&&(c=0,o=0),n.push({date:s.toISOString().split("T")[0],value:c,invested:o})}d(n)}catch(a){console.error("Error generating time series data:",a);const t=[];for(let s="7d"===h?7:"30d"===h?30:"90d"===h?90:365;s>=0;s--){const a=new Date;a.setDate(a.getDate()-s),t.push({date:a.toISOString().split("T")[0],value:0===s?e.totalValue:.95*e.totalValue,invested:e.totalInvested})}d(t)}},[t,h]),v=a.useCallback(async()=>{if(t){m(!0);try{const e=await ye.getUserInventory(t),a=await ye.getUserTransactions(t);let s=0,i=0;const l={};for(const t of e){const e=parseFloat(t.price||"0");s+=e;const n=a.find(e=>e.asset_id===t.asset_id&&"purchase"===e.type),r=n?parseFloat(n.price||"0"):e;i+=r,l[t.collection]||(l[t.collection]={collection:t.collection,totalValue:0,totalInvested:0,profitLoss:0,profitLossPercentage:0,nftCount:0,averagePrice:0,floorPrice:0,performance:"neutral"}),l[t.collection].totalValue+=e,l[t.collection].totalInvested+=r,l[t.collection].nftCount+=1}const c=Object.values(l).map(e=>(e.profitLoss=e.totalValue-e.totalInvested,e.profitLossPercentage=e.totalInvested>0?e.profitLoss/e.totalInvested*100:0,e.averagePrice=e.nftCount>0?e.totalValue/e.nftCount:0,e.profitLossPercentage>20?e.performance="excellent":e.profitLossPercentage>5?e.performance="good":e.profitLossPercentage>-5?e.performance="neutral":e.performance="poor",e)),o=s-i,d=i>0?o/i*100:0,u=c.sort((e,t)=>t.profitLossPercentage-e.profitLossPercentage),m=u[0]?.collection||"N/A",h=u[u.length-1]?.collection||"N/A",p=45,f={totalValue:s,totalInvested:i,profitLoss:o,profitLossPercentage:d,totalNFTs:e.length,uniqueCollections:c.length,averageHoldingTime:p,bestPerformingCollection:m,worstPerformingCollection:h};n(f),r(c),y(f,c),await g(f)}catch(e){console.error("Error calculating portfolio metrics:",e)}finally{m(!1)}}},[t,g]),y=(e,t)=>{const a=[];e.profitLoss>0?a.push({type:"profit",title:"Portfolio in Profit",description:`Your portfolio has gained ${e.profitLossPercentage.toFixed(1)}% since initial investment`,value:`+${e.profitLoss.toFixed(2)} WAX`}):e.profitLoss<0&&a.push({type:"loss",title:"Portfolio Underperforming",description:`Your portfolio is down ${Math.abs(e.profitLossPercentage).toFixed(1)}% from initial investment`,value:`${e.profitLoss.toFixed(2)} WAX`});const s=t.find(t=>t.collection===e.bestPerformingCollection);s&&s.profitLossPercentage>10&&a.push({type:"profit",title:"Top Performer",description:`${s.collection} is your best performing collection`,value:`+${s.profitLossPercentage.toFixed(1)}%`,collection:s.collection}),t.length<3&&a.push({type:"opportunity",title:"Diversification Opportunity",description:"Consider diversifying across more collections to reduce risk",value:`${t.length} collections`});const n=t.reduce((e,t)=>t.totalValue>e.totalValue?t:e,t[0]);n&&n.totalValue/e.totalValue>.6&&a.push({type:"warning",title:"High Concentration Risk",description:`${n.collection} represents over 60% of your portfolio`,collection:n.collection}),c(a)};a.useEffect(()=>{e&&t&&v()},[e,t,v]);const j=e=>`${e.toFixed(2)} WAX`,b=e=>`${e>=0?"+":""}${e.toFixed(1)}%`;return e?u?A.jsx("div",{className:"portfolio-analytics",children:A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Analyzing your portfolio..."})]})}):A.jsxs("div",{className:"portfolio-analytics",children:[A.jsxs("div",{className:"analytics-header",children:[A.jsx("h2",{children:"Portfolio Analytics"}),A.jsxs("div",{className:"analytics-controls",children:[A.jsx("div",{className:"timeframe-selector",children:["7d","30d","90d","1y"].map(e=>A.jsx("button",{className:"timeframe-btn "+(h===e?"active":""),onClick:()=>p(e),children:e},e))}),A.jsx("div",{className:"view-selector",children:["overview","collections","insights"].map(e=>A.jsx("button",{className:"view-btn "+(f===e?"active":""),onClick:()=>x(e),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),"overview"===f&&s&&A.jsxs("div",{className:"overview-section",children:[A.jsxs("div",{className:"metrics-grid",children:[A.jsxs("div",{className:"metric-card primary",children:[A.jsxs("div",{className:"metric-header",children:[A.jsx("h3",{children:"Total Portfolio Value"}),A.jsx("span",{className:"metric-icon",children:"💰"})]}),A.jsx("div",{className:"metric-value",children:j(s.totalValue)}),A.jsxs("div",{className:"metric-change "+(s.profitLoss>=0?"positive":"negative"),children:[b(s.profitLossPercentage)," (",j(s.profitLoss),")"]})]}),A.jsxs("div",{className:"metric-card",children:[A.jsxs("div",{className:"metric-header",children:[A.jsx("h3",{children:"Total Invested"}),A.jsx("span",{className:"metric-icon",children:"📈"})]}),A.jsx("div",{className:"metric-value",children:j(s.totalInvested)})]}),A.jsxs("div",{className:"metric-card",children:[A.jsxs("div",{className:"metric-header",children:[A.jsx("h3",{children:"NFTs Owned"}),A.jsx("span",{className:"metric-icon",children:"🎨"})]}),A.jsx("div",{className:"metric-value",children:s.totalNFTs}),A.jsxs("div",{className:"metric-subtitle",children:[s.uniqueCollections," collections"]})]}),A.jsxs("div",{className:"metric-card",children:[A.jsxs("div",{className:"metric-header",children:[A.jsx("h3",{children:"Avg. Holding Time"}),A.jsx("span",{className:"metric-icon",children:"⏱️"})]}),A.jsxs("div",{className:"metric-value",children:[s.averageHoldingTime,"d"]})]})]}),A.jsxs("div",{className:"performance-chart",children:[A.jsx("h3",{children:"Portfolio Performance"}),A.jsxs("div",{className:"chart-container",children:[A.jsx("svg",{className:"performance-svg",viewBox:"0 0 800 200",children:o.map((e,t)=>{const a=t/(o.length-1)*780+10,s=190-e.value/Math.max(...o.map(e=>e.value))*180,n=190-e.invested/Math.max(...o.map(e=>e.value))*180;return A.jsxs("g",{children:[t>0&&A.jsxs(A.Fragment,{children:[A.jsx("line",{x1:(t-1)/(o.length-1)*780+10,y1:190-o[t-1].value/Math.max(...o.map(e=>e.value))*180,x2:a,y2:s,stroke:"#4CAF50",strokeWidth:"2"}),A.jsx("line",{x1:(t-1)/(o.length-1)*780+10,y1:190-o[t-1].invested/Math.max(...o.map(e=>e.value))*180,x2:a,y2:n,stroke:"#FF9800",strokeWidth:"2",strokeDasharray:"5,5"})]}),A.jsx("circle",{cx:a,cy:s,r:"3",fill:"#4CAF50"})]},t)})}),A.jsxs("div",{className:"chart-legend",children:[A.jsxs("div",{className:"legend-item",children:[A.jsx("div",{className:"legend-color",style:{backgroundColor:"var(--success-color)"}}),A.jsx("span",{children:"Current Value"})]}),A.jsxs("div",{className:"legend-item",children:[A.jsx("div",{className:"legend-color dashed",style:{backgroundColor:"var(--warning-color)"}}),A.jsx("span",{children:"Invested Amount"})]})]})]})]})]}),"collections"===f&&A.jsxs("div",{className:"collections-section",children:[A.jsx("h3",{children:"Collection Performance"}),A.jsx("div",{className:"collections-grid",children:i.map((e,t)=>A.jsxs("div",{className:`collection-card ${e.performance}`,children:[A.jsxs("div",{className:"collection-header",children:[A.jsx("h4",{children:e.collection}),A.jsx("span",{className:`performance-badge ${e.performance}`,children:e.performance})]}),A.jsxs("div",{className:"collection-metrics",children:[A.jsxs("div",{className:"collection-metric",children:[A.jsx("span",{className:"metric-label",children:"Value:"}),A.jsx("span",{className:"metric-value",children:j(e.totalValue)})]}),A.jsxs("div",{className:"collection-metric",children:[A.jsx("span",{className:"metric-label",children:"P&L:"}),A.jsx("span",{className:"metric-value "+(e.profitLoss>=0?"positive":"negative"),children:b(e.profitLossPercentage)})]}),A.jsxs("div",{className:"collection-metric",children:[A.jsx("span",{className:"metric-label",children:"NFTs:"}),A.jsx("span",{className:"metric-value",children:e.nftCount})]}),A.jsxs("div",{className:"collection-metric",children:[A.jsx("span",{className:"metric-label",children:"Avg Price:"}),A.jsx("span",{className:"metric-value",children:j(e.averagePrice)})]})]})]},t))})]}),"insights"===f&&A.jsxs("div",{className:"insights-section",children:[A.jsx("h3",{children:"Investment Insights"}),A.jsx("div",{className:"insights-grid",children:l.map((e,t)=>A.jsxs("div",{className:`insight-card ${e.type}`,children:[A.jsxs("div",{className:"insight-header",children:[A.jsxs("span",{className:`insight-icon ${e.type}`,children:["profit"===e.type&&"📈","loss"===e.type&&"📉","opportunity"===e.type&&"💡","warning"===e.type&&"⚠️"]}),A.jsx("h4",{children:e.title}),e.value&&A.jsx("span",{className:"insight-value",children:e.value})]}),A.jsx("p",{className:"insight-description",children:e.description}),e.collection&&A.jsxs("div",{className:"insight-collection",children:["Collection: ",e.collection]})]},t))})]})]}):A.jsx("div",{className:"portfolio-analytics",children:A.jsxs("div",{className:"wallet-connection-prompt",children:[A.jsx("h3",{children:"🔗 Connect Your Wallet"}),A.jsx("p",{children:"Connect your WAX wallet to view detailed portfolio analytics and investment insights."})]})})},ta={};function aa(e,t){return e?e*parseFloat(t.weight)/1e15:0}function sa(e,t){if(t<=0)return 0;const a=parseFloat(e.max_price.split(" ")[0]),s=parseFloat(e.min_price.split(" ")[0]);let n=0,i=parseFloat(e.utilization),r=parseFloat(i)+parseFloat(t);i<parseFloat(e.adjusted_utilization)&&(n+=(t=>{let n=s;const i=e.exponent-1;return i<=0?a:(n+=(a-s)*Math.pow(parseFloat(t)/e.weight,i),n)})(parseFloat(e.adjusted_utilization))*Math.min(parseFloat(t),parseFloat(e.adjusted_utilization)-parseFloat(i))/parseFloat(e.weight),i=parseFloat(e.adjusted_utilization)),i<r&&(n+=((t,n)=>{const i=(a-s)/parseFloat(e.exponent),r=t/parseFloat(e.weight),l=n/parseFloat(e.weight);return s*l-s*r+i*(Math.pow(l,parseFloat(e.exponent))-Math.pow(r,parseFloat(e.exponent)))})(i,r));return n<1e-8?n<1e-8?1e-8.toFixed(8):n.toPrecision(1).replace(/e-9/,"0.00000000"):n.toFixed(8)}const na=(e,t)=>{if(!e||void 0===t)return 0;return 1e11*(t/100)},ia=(e,t)=>{if(!e||void 0===t)return 0;return 2e9*((100-t)/100)};function ra(e,t,a,s){const n=aa(e,a),i=aa(t,s);return{cpuAmount:n,netAmount:i,cpuFee:sa(a,n),netFee:sa(s,i)}}const la=(e,t,a,s,n)=>{if(n&&n.virtual_block_cpu_limit&&n.block_cpu_limit){let i=parseFloat(n.block_cpu_limit),r=parseFloat(n.virtual_block_cpu_limit)/i;const l=ra(e,t,a,s).cpuAmount*r;if(!l||l<=0)return"0 ms";const c=l/1e3;return c>=1e3?`${(c/1e3).toFixed(2)} seconds`:`${c.toFixed(2)} ms`}return"0 ms"},ca=()=>{const{account:e}=_t(),[t,s]=a.useState([]),[n,i]=a.useState(!0),[r,l]=a.useState(new Set),[c,o]=a.useState(null),[d,u]=a.useState(!1),m=a.useCallback(async()=>{if(e)try{i(!0);const t=await be.checkUserBadges(e),a=await be.getUserBadgeStats(e);s(t.badges),o(a)}catch(t){console.error("Error loading badges:",t)}finally{i(!1)}},[e]);a.useEffect(()=>{e?m():(s([]),i(!1))},[e,m]);const h=a.useMemo(()=>{const e=be.getAllBadgeDefinitions(),a={holdings:{id:"holdings",name:"Token Holdings",icon:"💰",description:"Achievements for holding various tokens",badges:[]},ownership:{id:"ownership",name:"NFT Collections",icon:"🎭",description:"Achievements for owning NFTs and collectibles",badges:[]},trading:{id:"trading",name:"Trading Mastery",icon:"📈",description:"Achievements for trading activities",badges:[]},social:{id:"social",name:"Community",icon:"👥",description:"Achievements for community participation",badges:[]},achievement:{id:"achievement",name:"Special Achievements",icon:"🏆",description:"Rare and special accomplishments",badges:[]},special:{id:"special",name:"Legendary",icon:"⭐",description:"Ultra-rare legendary achievements",badges:[]}};return e.forEach(e=>{const s=a[e.type]||a.achievement,n=t.find(t=>t.id===e.id);s.badges.push(n||{...e,unlockedAt:void 0})}),Object.values(a).filter(e=>e.badges.length>0)},[t]),p=a.useMemo(()=>{const e=[],a=t.filter(e=>e.id.startsWith("pixal-collector")).sort((e,t)=>(e.tier||0)-(t.tier||0));if(a.length>0){const t=[1,2,3,4,5].map(e=>{const t=a.find(t=>t.tier===e);return{tier:e,earned:!!t?.unlockedAt,current:t?.progress&&!t.unlockedAt}});e.push({name:"Pixal Collector",badges:a,steps:t})}const s=t.filter(e=>e.id.startsWith("waxrock-collector")).sort((e,t)=>(e.tier||0)-(t.tier||0));if(s.length>0){const t=[1,2,3].map(e=>{const t=s.find(t=>t.tier===e);return{tier:e,earned:!!t?.unlockedAt,current:t?.progress&&!t.unlockedAt}});e.push({name:"WaxRock Collector",badges:s,steps:t})}return e},[t]),f=e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})};return e?A.jsxs("div",{className:"pxbadges-container",children:[A.jsxs("div",{className:"pxbadges-header",children:[A.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1rem"},children:[A.jsx("h1",{className:"pxbadges-title",children:"Achievements"}),A.jsx("button",{onClick:()=>u(!0),style:{background:"rgba(255, 215, 0, 0.2)",border:"2px solid #ffd700",borderRadius:"50%",width:"48px",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s ease",color:"#ffd700"},onMouseEnter:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.3)",e.currentTarget.style.transform="scale(1.1)"},onMouseLeave:e=>{e.currentTarget.style.background="rgba(255, 215, 0, 0.2)",e.currentTarget.style.transform="scale(1)"},title:"Share Achievements",children:A.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"})})})]}),A.jsx("p",{className:"pxbadges-subtitle",children:"Track your progress and unlock prestigious badges in the Pixel Journey ecosystem"}),c&&A.jsxs("div",{className:"achievement-stats",children:[A.jsxs("div",{className:"stat-card",children:[A.jsx("span",{className:"stat-number",children:c.totalBadges}),A.jsx("span",{className:"stat-label",children:"Total Earned"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("span",{className:"stat-number",children:c.badgesByRarity?.legendary||0}),A.jsx("span",{className:"stat-label",children:"Legendary"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("span",{className:"stat-number",children:c.badgesByRarity?.epic||0}),A.jsx("span",{className:"stat-label",children:"Epic"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("span",{className:"stat-number",children:c.badgesByRarity?.rare||0}),A.jsx("span",{className:"stat-label",children:"Rare"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("span",{className:"stat-number",children:c.progressBadges?.length||0}),A.jsx("span",{className:"stat-label",children:"In Progress"})]})]})]}),n?A.jsxs("div",{className:"achievements-loading",children:[A.jsx("div",{className:"loading-spinner"}),"Loading achievements..."]}):A.jsxs("div",{className:"achievement-categories",children:[p.length>0&&A.jsxs("div",{className:"category-section",children:[A.jsxs("div",{className:"category-header",children:[A.jsx("span",{className:"category-icon",children:"🏆"}),A.jsx("h2",{className:"category-title",children:"Achievement Series"})]}),p.map(e=>A.jsxs("div",{className:"achievement-card earned",children:[A.jsxs("div",{className:"achievement-header",children:[A.jsx("span",{className:"achievement-icon",children:"🎯"}),A.jsxs("div",{className:"achievement-info",children:[A.jsx("h3",{className:"achievement-name",children:e.name}),A.jsxs("p",{className:"achievement-description",children:["Multi-tier achievement series with ",e.steps.length," levels"]})]})]}),A.jsx("div",{className:"achievement-series",children:e.steps.map(e=>A.jsx("div",{className:"series-step "+(e.earned?"completed":e.current?"current":""),children:e.tier},e.tier))})]},e.name))]}),h.map(e=>{const t=e.badges.filter(e=>e.unlockedAt).length,a=e.badges.length,s=r.has(e.id);return A.jsxs("div",{className:"category-section",children:[A.jsxs("div",{className:"category-header",onClick:()=>(e=>{const t=new Set(r);t.has(e)?t.delete(e):t.add(e),l(t)})(e.id),children:[A.jsx("span",{className:"category-icon",children:e.icon}),A.jsx("h2",{className:"category-title",children:e.name}),A.jsxs("span",{className:"category-progress",children:[t,"/",a]}),A.jsx("span",{className:"category-toggle "+(s?"collapsed":""),children:"▼"})]}),!s&&A.jsx("div",{className:"achievements-grid",children:e.badges.map(e=>{const t=!!e.unlockedAt,a=(e=>"legendary"===e.rarity?"legendary":"epic"===e.rarity?"epic":"rare"===e.rarity?"rare":"")(e);return A.jsxs("div",{className:`achievement-card ${t?"earned":""} ${a}`,children:[A.jsxs("div",{className:"achievement-header",children:[A.jsx("span",{className:"achievement-icon",children:e.icon}),A.jsxs("div",{className:"achievement-info",children:[A.jsx("h3",{className:"achievement-name",children:e.name}),A.jsx("p",{className:"achievement-description",children:e.description}),A.jsx("p",{className:"achievement-requirements",children:e.requirements})]})]}),e.tier&&A.jsxs("div",{className:"achievement-tier",children:["Tier ",e.tier]}),e.progress&&A.jsxs("div",{className:"achievement-progress",children:[A.jsx("div",{className:"progress-bar",children:A.jsx("div",{className:"progress-fill",style:{width:`${e.progress.percentage}%`}})}),A.jsxs("div",{className:"progress-text",children:[e.progress.current.toLocaleString()," / ",e.progress.required.toLocaleString(),"(",e.progress.percentage,"%)"]})]}),t&&e.unlockedAt&&A.jsx("div",{className:"achievement-date",children:f(e.unlockedAt)})]},e.id)})})]},e.id)}),0===h.length&&A.jsxs("div",{className:"no-achievements",children:[A.jsx("div",{className:"no-achievements-icon",children:"🎯"}),A.jsx("div",{className:"no-achievements-text",children:"No Achievements Yet"}),A.jsx("div",{className:"no-achievements-subtitle",children:"Start participating in the Pixel Journey ecosystem to earn your first badges!"})]})]}),A.jsx(Oe,{isOpen:d,onClose:()=>u(!1),title:`${e}'s Achievements`,description:`Check out my achievements in the Pixel Journey ecosystem! I've earned ${c?.totalBadges||0} badges including ${c?.badgesByRarity?.legendary||0} legendary achievements.`,shareUrl:`${window.location.origin}/pxbadges?user=${e}`,defaultShareText:`Check out my achievements in the Pixel Journey ecosystem! I've earned ${c?.totalBadges||0} badges. #PixelJourney #Achievements`,type:"achievement",badges:t,totalBadges:c?.totalBadges||0,legendaryCount:c?.badgesByRarity?.legendary||0,username:e||""})]}):A.jsx("div",{className:"pxbadges-container",children:A.jsxs("div",{className:"no-achievements",children:[A.jsx("div",{className:"no-achievements-icon",children:"🔒"}),A.jsx("div",{className:"no-achievements-text",children:"Connect Your Wallet"}),A.jsx("div",{className:"no-achievements-subtitle",children:"Connect your wallet to view your achievements and progress"})]})})},oa=()=>{const{account:e,isConnected:t,session:s,login:n}=R(),{showError:r}=_e(),l=i(),[c,o]=a.useState("overview"),[d,u]=a.useState([]),[m,p]=a.useState({}),[f,x]=a.useState(null),[g,v]=a.useState(null),[y,j]=a.useState(null),[b,N]=a.useState([]),[w,k]=a.useState("0.0000 WAX"),[_,S]=a.useState(new Set),[C,E]=a.useState(!1),[P,T]=a.useState(!1),[I,F]=a.useState(null),[$,L]=a.useState([]),[M,W]=a.useState("all"),[O,U]=a.useState("all"),[z,X]=a.useState({start:"",end:""}),[H,q]=a.useState(""),[V,Y]=a.useState(1),[Q]=a.useState(10),[Z,ee]=a.useState("date"),[te,ae]=a.useState("desc"),[se,ne]=a.useState(!1),[re,le]=a.useState(!1),[ce,oe]=a.useState(null),[de,ue]=a.useState(null),[me,he]=a.useState({isOpen:!1,resourceType:"cpu",action:"stake"}),[pe,fe]=a.useState({isOpen:!1,action:"buy"}),[xe,ge]=a.useState({isOpen:!1,token:null}),[ve,we]=a.useState(e||""),[ke,Se]=a.useState(100),[Ce,Ae]=a.useState(0),[Ee,Pe]=a.useState(!1),[,Te]=(()=>{const{account:e,session:t}=R(),[s,n]=a.useState(null),[i,r]=a.useState(!1);return[s,a.useCallback(async(a=null)=>{if(!t&&!a)return void console.warn("No wallet session or account name provided");const s=a||e;if(s){r(!0);try{const{apiService:e}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),t=await e.getWaxAccountInfo(s);if(!t)throw new Error("Failed to fetch account resources: No data returned");const a={account_name:s,cpu_limit:{used:t.cpu_limit?.used||0,available:t.cpu_limit?.available||0,max:t.cpu_limit?.max||0},net_limit:{used:t.net_limit?.used||0,available:t.net_limit?.available||0,max:t.net_limit?.max||0},ram_usage:t.ram_usage||0,ram_quota:t.ram_quota||0,total_resources:t.total_resources||{},self_delegated_bandwidth:t.self_delegated_bandwidth||{},refund_request:t.refund_request||null,voter_info:t.voter_info||null};n(a),console.log("Account resources fetched:",a)}catch(I){console.error("Error fetching account resources:",I),n(null)}finally{r(!1)}}else console.warn("No target account found")},[t,e]),i]})(),[Ie,Fe]=(()=>{const[e,t]=a.useState(null),[s,n]=a.useState(!1);return[e,a.useCallback(async()=>{n(!0);try{const{apiService:e}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),a=await e.getPowerupState();if(a.rows&&a.rows.length>0){const e=a.rows[0],s={version:e.version||0,net:{version:e.net?.version||0,weight:e.net?.weight||"0",weight_ratio:e.net?.weight_ratio||"0",assumed_stake_weight:e.net?.assumed_stake_weight||"0",initial_weight_ratio:e.net?.initial_weight_ratio||"0",target_weight_ratio:e.net?.target_weight_ratio||"0",initial_timestamp:e.net?.initial_timestamp||"",target_timestamp:e.net?.target_timestamp||"",exponent:e.net?.exponent||2,decay_secs:e.net?.decay_secs||86400,min_price:e.net?.min_price||"0",max_price:e.net?.max_price||"0",utilization:e.net?.utilization||"0",adjusted_utilization:e.net?.adjusted_utilization||"0",utilization_timestamp:e.net?.utilization_timestamp||""},cpu:{version:e.cpu?.version||0,weight:e.cpu?.weight||"0",weight_ratio:e.cpu?.weight_ratio||"0",assumed_stake_weight:e.cpu?.assumed_stake_weight||"0",initial_weight_ratio:e.cpu?.initial_weight_ratio||"0",target_weight_ratio:e.cpu?.target_weight_ratio||"0",initial_timestamp:e.cpu?.initial_timestamp||"",target_timestamp:e.cpu?.target_timestamp||"",exponent:e.cpu?.exponent||2,decay_secs:e.cpu?.decay_secs||86400,min_price:e.cpu?.min_price||"0",max_price:e.cpu?.max_price||"0",utilization:e.cpu?.utilization||"0",adjusted_utilization:e.cpu?.adjusted_utilization||"0",utilization_timestamp:e.cpu?.utilization_timestamp||""},powerup_days:e.powerup_days||1,min_powerup_fee:e.min_powerup_fee||"0.0001 WAX"};t(s),console.log("Powerup state fetched:",s)}else console.warn("No powerup state data found"),t(null)}catch(I){console.error("Error fetching powerup state:",I),t(null)}finally{n(!1)}},[]),s]})(),[$e,Le]=(()=>{const[e,t]=a.useState(null),[s,n]=a.useState(!1);return[e,a.useCallback(async()=>{n(!0);try{const{apiService:e}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),a=await e.getChainInfo(),s={server_version:a.server_version||"",chain_id:a.chain_id||"",head_block_num:a.head_block_num||0,last_irreversible_block_num:a.last_irreversible_block_num||0,last_irreversible_block_id:a.last_irreversible_block_id||"",head_block_id:a.head_block_id||"",head_block_time:a.head_block_time||"",head_block_producer:a.head_block_producer||"",virtual_block_cpu_limit:a.virtual_block_cpu_limit||0,virtual_block_net_limit:a.virtual_block_net_limit||0,block_cpu_limit:a.block_cpu_limit||0,block_net_limit:a.block_net_limit||0,server_version_string:a.server_version_string||"",fork_db_head_block_num:a.fork_db_head_block_num||0,fork_db_head_block_id:a.fork_db_head_block_id||""};t(s),console.log("Chain info fetched:",s)}catch(I){console.error("Error fetching chain info:",I),t(null)}finally{n(!1)}},[]),s]})(),Me=a.useCallback(async()=>{if(J("loadTransactions called with account","UserProfile",{account:e}),le(!0),oe(null),!e){J("No account connected, using test account","UserProfile");const e="pixeljourney";try{J("Fetching transactions for test account","UserProfile",{testAccount:e});const t=await ye.getUserTransactions(e,20);if(J("Test transactions fetched","UserProfile",{count:t?.length||0,sample:t?.slice(0,2)}),t&&0!==t.length){const e=t.map(e=>({...e,type:e.type,status:e.status||"completed"}));u(e)}else G("No test transactions returned","UserProfile"),u([])}catch(t){K("Error loading test transactions","UserProfile",t,{name:t instanceof Error?t.name:"Unknown",message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0});const e=t instanceof Error?t.message:"Unable to load transaction history. Please try again later.";oe(e),r("Transaction Error",e)}finally{le(!1)}return}try{J("Loading transactions for connected account","UserProfile",{account:e,apiServiceAvailable:!!ye,getUserTransactionsType:typeof ye.getUserTransactions});const t=await ye.getUserTransactions(e,20);if(J("Fetched transactions","UserProfile",{count:t?.length||0,sample:t?.slice(0,2)}),t&&0!==t.length){const e=t.map(e=>({...e,type:e.type,status:e.status||"completed"}));u(e)}else G("No transactions returned from API","UserProfile"),u([])}catch(t){K("Error loading transactions","UserProfile",t,{name:t instanceof Error?t.name:"Unknown",message:t instanceof Error?t.message:String(t),stack:t instanceof Error?t.stack:void 0});const e=t instanceof Error?t.message:"Unable to load transaction history. Please try again later.";oe(e),r("Transaction Error",e)}finally{le(!1)}},[e,r]),Re=a.useCallback(async()=>{if(e)try{const t=await ye.getUserStats(e);x(t),t.favoriteCollections.length>0&&Ye(t.favoriteCollections)}catch(t){throw K("Error loading user stats","UserProfile",t),t}},[e]),We=a.useCallback(async()=>{if(e)try{const t=await ye.getWaxAccountInfo(e);t&&(v(t),t.cpu_limit&&t.net_limit&&t.ram_quota&&j({cpu:{used:t.cpu_limit.used,available:t.cpu_limit.available,max:t.cpu_limit.max},net:{used:t.net_limit.used,available:t.net_limit.available,max:t.net_limit.max},ram:{used:t.ram_usage,available:t.ram_quota-t.ram_usage,max:t.ram_quota}}))}catch(t){K("Failed to fetch account data","UserProfile",t),r("Account Data Error","Unable to fetch account information. Some features may not work properly.")}},[e,r]),Oe=a.useMemo(()=>["swap.taco","alpha.waxfun","beta.waxfun"],[]),De=a.useMemo(()=>[{symbol:"WAX",contract:"eosio.token"},{symbol:"PXJ",contract:"pixeljourney"},{symbol:"WPIXAL",contract:"pixeljourney"},{symbol:"WUF",contract:"wuffi"},{symbol:"TLM",contract:"alien.worlds"}],[]),Be=a.useCallback(async()=>{if(e)try{const a=[],s=De.filter(e=>!Oe.includes(e.contract));for(let n=0;n<s.length;n++){const i=s[n];try{n>0&&await qe(500);const s=await ye.getWaxCurrencyBalance(e,i.contract,i.symbol);if(s&&s.length>0){let n="N/A";const r=parseFloat(s[0].balance.split(" ")[0]);try{if("WAX"===i.symbol&&"eosio.token"===i.contract){const e=await ie.getWaxPriceUSD();n=B(r*e,2)}else if("WPIXAL"===i.symbol&&"pixeljourney"===i.contract){const e=await ie.getWpixalPriceUSD();n=B(r*e,4)}else if("PXJ"===i.symbol&&"pixeljourney"===i.contract){const e=await ie.getPxjPriceUSD();n=B(r*e,6)}else n="WUF"===i.symbol&&"wuffi"===i.contract?"0.00":"N/A"}catch(t){G(`Failed to fetch price for ${i.symbol} in fallback`,"UserProfile",{error:t}),n="0.00"}const l={...s[0],value:n};if("WAX"===i.symbol&&"eosio.token"===i.contract)try{const t=await Ne.getWaxBalance(e);k(t)}catch(t){G("Failed to get WAX balance from balance service, using fallback","UserProfile",{error:t}),k(l.balance)}a.push(l)}}catch(t){K(`Failed to fetch ${i.symbol} balance`,"UserProfile",t)}}N(a)}catch(t){K("Failed to fetch token balances with fallback","UserProfile",t)}},[e,De,Oe]),Ue=a.useCallback(async()=>{if(e)try{const t=await be.checkUserBadges(e);L(t.badges)}catch(t){console.error("Error fetching user badges:",t)}},[e]),ze=a.useCallback(async()=>{if(e)try{const a=await ye.getLightApiBalances(e);if(a&&a.balances){const s=[],n=a.balances.filter(e=>parseFloat(e.amount)>1e-4).sort((e,t)=>parseFloat(t.amount)-parseFloat(e.amount)).sort((e,t)=>{const a=De.some(t=>t.symbol===e.currency&&t.contract===e.contract),s=De.some(e=>e.symbol===t.currency&&e.contract===t.contract);return a&&!s?-1:!a&&s?1:0}).filter(e=>!Oe.includes(e.contract));for(let a=0;a<n.length;a++){const i=n[a];try{a>0&&await qe(300);let n="0.00";const r=parseFloat(i.amount);try{if("WAX"===i.currency&&"eosio.token"===i.contract){const e=await ie.getWaxPriceUSD();n=B(r*e,2)}else if("WPIXAL"===i.currency&&"pixeljourney"===i.contract){const e=await ie.getWpixalPriceUSD();n=B(r*e,4)}else if("PXJ"===i.currency&&"pixeljourney"===i.contract){const e=await ie.getPxjPriceUSD();n=B(r*e,6)}else n="WUF"===i.currency&&"wuffi"===i.contract?"0.00":"N/A"}catch(t){G(`Failed to fetch price for ${i.currency}`,"UserProfile",{error:t}),n="0.00"}const l={balance:`${i.amount} ${i.currency}`,symbol:i.currency,contract:i.contract,value:n};if("WAX"===i.currency&&"eosio.token"===i.contract)try{const t=await Ne.getWaxBalance(e);k(t)}catch(t){G("Failed to get WAX balance from balance service, using fallback","UserProfile",{error:t}),k(l.balance)}s.push(l)}catch(t){K(`Failed to get price for ${i.currency}`,"UserProfile",t);const e={balance:`${i.amount} ${i.currency}`,symbol:i.currency,contract:i.contract,value:"0.00"};s.push(e)}}N(s)}}catch(t){K("Failed to fetch token balances","UserProfile",t),await Be()}},[e,Oe,De,Be]),Xe=a.useCallback(async()=>{if(e){T(!0),F(null);try{await Me(),await Re(),await ze(),await Ue()}catch(t){K("Error loading user data","UserProfile",t),F("Failed to load user data"),r("User Data Error","Unable to load user profile data. Please try refreshing the page.")}finally{T(!1)}}},[e,r,ze,Me,Re,Ue]);a.useEffect(()=>{if(t&&e){(async()=>{try{await Xe(),await We(),await Fe(),await Le(),Te()}catch(e){K("Error initializing user data","UserProfile",e),r("Failed to Load User Data","Unable to initialize user profile. Please try refreshing the page."),F("Failed to load user data")}})()}},[t,e]),a.useEffect(()=>{e&&we(e)},[e]);const He=(e,t)=>0===t?0:e/t*100,qe=e=>new Promise(t=>setTimeout(t,e)),Je=(e,t)=>{he({isOpen:!0,resourceType:e,action:t})},Ve=e=>{fe({isOpen:!0,action:e})},Ge=()=>{ge({isOpen:!1,token:null})},Ke=()=>{We()},Ye=async e=>{const t={};for(const s of e)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/collections/${s}`),a=await e.json();if(a.success&&a.data?.img){const e=a.data.img;t[s]=e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`}}catch(a){K(`Error fetching avatar for collection ${s}`,"UserProfile",a)}p(t)},Qe=d.filter(e=>{if("all"!==M)if("tokens"===M){if("token_send"!==e.type&&"token_receive"!==e.type)return!1}else if(e.type!==M)return!1;if(H){const t=H.toLowerCase(),a=e.asset_name?.toLowerCase().includes(t),s=e.collection_name?.toLowerCase().includes(t),n=e.transaction_id.toLowerCase().includes(t),i=e.from?.toLowerCase().includes(t),r=e.to?.toLowerCase().includes(t);if(!(a||s||n||i||r))return!1}if("all"!==O){const t=new Date(e.block_time);if("custom"===O){if(z.start&&z.end){const e=new Date(z.start),a=new Date(z.end);if(a.setHours(23,59,59,999),t<e||t>a)return!1}else if(z.start){if(t<new Date(z.start))return!1}else if(z.end){const e=new Date(z.end);if(e.setHours(23,59,59,999),t>e)return!1}}else{const e="7d"===O?7:"30d"===O?30:90;if(t<new Date((new Date).getTime()-24*e*60*60*1e3))return!1}}return!0}),Ze=[...Qe].sort((e,t)=>{let a=0;switch(Z){case"date":a=new Date(e.block_time).getTime()-new Date(t.block_time).getTime();break;case"amount":a=parseFloat(e.price?.replace(" WAX","")||"0")-parseFloat(t.price?.replace(" WAX","")||"0");break;case"type":a=e.type.localeCompare(t.type)}return"desc"===te?-a:a}),et=Math.ceil(Ze.length/Q),tt=(V-1)*Q,at=Ze.slice(tt,tt+Q),st=t=>{ne(!0),ue(null);try{let a,s,n;if("csv"===t){const t=[["Transaction ID","Date","Type","Asset Name","Collection","Price","From","To","Status"].join(",")];Qe.forEach(e=>{const a=[e.transaction_id,e.block_time,e.type,e.asset_name||"",e.collection_name||"",e.price||"",e.from||"",e.to||"",e.status].map(e=>`"${e}"`);t.push(a.join(","))}),a=t.join("\n"),s=`transactions_${e}_${(new Date).toISOString().split("T")[0]}.csv`,n="text/csv"}else a=JSON.stringify(Qe,null,2),s=`transactions_${e}_${(new Date).toISOString().split("T")[0]}.json`,n="application/json";const i=new Blob([a],{type:n}),r=URL.createObjectURL(i),l=document.createElement("a");l.href=r,l.download=s,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r)}catch(a){K("Export failed","UserProfile",a);const e=a instanceof Error?a.message:"Failed to export transactions. Please try again.";ue(e),r("Export Error",e)}finally{ne(!1)}};return t?A.jsxs("div",{className:"user-profile",children:[A.jsxs("div",{className:"profile-container",children:[A.jsxs("div",{className:"profile-header",children:[A.jsx("div",{className:"profile-avatar",children:A.jsx("div",{className:"avatar-placeholder",children:e?.charAt(0).toUpperCase()})}),A.jsxs("div",{className:"profile-info",children:[A.jsx("h1",{children:e}),A.jsxs("div",{className:"profile-badges",children:[$.map(e=>A.jsxs("span",{className:`badge ${e.id}`,title:e.description,children:[e.icon," ",e.name]},e.id)),0===$.length&&A.jsx("span",{className:"badge no-badges",children:"No badges earned yet"})]})]}),A.jsx("div",{className:"profile-stats-quick",children:f&&A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:f.nftsOwned}),A.jsx("span",{className:"stat-label",children:"NFTs Owned"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:f.totalPurchases}),A.jsx("span",{className:"stat-label",children:"Purchases"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:f.totalSales}),A.jsx("span",{className:"stat-label",children:"Sales"})]})]})})]}),A.jsxs("div",{className:"profile-tabs",children:[A.jsxs("div",{className:"tab-row",children:[A.jsx("button",{className:"tab-button "+("overview"===c?"active":""),onClick:()=>o("overview"),children:"Overview"}),A.jsx("button",{className:"tab-button "+("transactions"===c?"active":""),onClick:()=>o("transactions"),children:"Transactions"}),A.jsx("button",{className:"tab-button "+("portfolio"===c?"active":""),onClick:()=>o("portfolio"),children:"Portfolio Analytics"}),A.jsx("button",{className:"tab-button "+("pxbadges"===c?"active":""),onClick:()=>o("pxbadges"),children:"PxBadges"})]}),A.jsxs("div",{className:"tab-row",children:[A.jsx("button",{className:"tab-button "+("network-resources"===c?"active":""),onClick:()=>o("network-resources"),children:"Network Resources"}),A.jsx("button",{className:"tab-button "+("powerup"===c?"active":""),onClick:()=>o("powerup"),children:"Powerup"}),A.jsx("button",{className:"tab-button "+("token-balances"===c?"active":""),onClick:()=>o("token-balances"),children:"Token Balances"})]})]}),A.jsxs("div",{className:"profile-content",children:[P&&A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading profile data..."})]}),I&&A.jsxs("div",{className:"error-state",children:[A.jsx("p",{children:I}),A.jsx("button",{onClick:Xe,className:"retry-button",children:"Retry"})]}),!P&&!I&&A.jsxs(A.Fragment,{children:["overview"===c&&f&&A.jsxs("div",{className:"overview-tab",children:[A.jsxs("div",{className:"balance-info",children:[A.jsxs("div",{className:"balance-item",children:[A.jsx("span",{className:"balance-label",children:"WAX Balance:"}),A.jsx("span",{className:"balance-value",children:w})]}),A.jsxs("div",{className:"balance-item",children:[A.jsx("span",{className:"balance-label",children:"USD Value:"}),A.jsx("span",{className:"balance-value",children:"$0.00"})]})]}),A.jsxs("div",{className:"account-info",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Account Name:"}),A.jsx("span",{className:"info-value",children:e})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Created:"}),A.jsx("span",{className:"info-value",children:g?.created?new Date(g.created).toLocaleDateString():"Loading..."})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Last Active:"}),A.jsx("span",{className:"info-value",children:g?.last_code_update?new Date(g.last_code_update).toLocaleDateString():"Loading..."})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"info-label",children:"Reputation:"}),A.jsx("span",{className:"info-value",children:f?.reputation||"⭐⭐⭐⭐⭐ (4.8/5)"})]})]}),A.jsxs("div",{className:"stats-grid",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:f?.nftsOwned||0}),A.jsx("div",{className:"stat-label",children:"NFTs Owned"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:f?.totalTransactions||0}),A.jsx("div",{className:"stat-label",children:"Transactions"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:f?.totalEarned||"0"}),A.jsx("div",{className:"stat-label",children:"WAX Earned"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:f?.tierStatus||"Bronze"}),A.jsx("div",{className:"stat-label",children:"Tier Status"})]})]}),A.jsxs("div",{className:"favorite-collections",children:[A.jsx("h3",{children:"Favorite Collections"}),A.jsx("div",{className:"collections-list",children:f.favoriteCollections.map((e,t)=>A.jsxs("div",{className:"collection-item",children:[A.jsxs("div",{className:"user-collection-avatar",children:[m[e]?A.jsx("img",{src:m[e],alt:`${e} avatar`,onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}):null,A.jsx("div",{className:"fallback-avatar",style:{display:m[e]?"none":"flex"},children:e.charAt(0).toUpperCase()})]}),A.jsx("span",{className:"collection-name",children:e})]},t))})]})]}),"transactions"===c&&A.jsxs("div",{className:"transactions-tab",children:[!t&&A.jsx("div",{className:"wallet-connection-prompt",children:A.jsxs("div",{className:"prompt-content",children:[A.jsx("h3",{children:"🔗 Connect Your Wallet"}),A.jsx("p",{children:"Connect your WAX wallet to view your personal transaction history and account details."}),A.jsx("button",{className:"connect-wallet-btn",onClick:n,children:"Connect Wallet"}),A.jsx("div",{className:"demo-notice",children:A.jsxs("p",{children:["📊 Currently showing demo data from account: ",A.jsx("strong",{children:"pixeljourney"})]})})]})}),A.jsxs("div",{className:"quick-filters",children:[A.jsx("button",{className:"filter-btn "+("all"===M?"active":""),onClick:()=>W("all"),children:"🔍 All Activity"}),A.jsx("button",{className:"filter-btn "+("purchase"===M?"active":""),onClick:()=>W("purchase"),children:"🛒 Purchases"}),A.jsx("button",{className:"filter-btn "+("sale"===M?"active":""),onClick:()=>W("sale"),children:"💰 Sales"}),A.jsx("button",{className:"filter-btn "+("transfer"===M?"active":""),onClick:()=>W("transfer"),children:"🔄 Transfers"}),A.jsx("button",{className:"filter-btn "+("tokens"===M?"active":""),onClick:()=>W("tokens"),children:"💸 Tokens"})]}),A.jsxs("div",{className:"transactions-header",children:[A.jsxs("div",{className:"transactions-stats",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:Ze.length}),A.jsx("span",{className:"stat-label",children:"Total Found"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:d.length}),A.jsx("span",{className:"stat-label",children:"All Transactions"})]})]}),A.jsxs("div",{className:"transactions-actions",children:[A.jsxs("button",{className:"export-btn",onClick:()=>st("csv"),disabled:se||0===Qe.length,children:[se?"⏳":"📊"," Export CSV"]}),A.jsxs("button",{className:"export-btn",onClick:()=>st("json"),disabled:se||0===Qe.length,children:[se?"⏳":"📄"," Export JSON"]})]})]}),A.jsxs("div",{className:"transactions-controls",children:[A.jsx("div",{className:"search-section",children:A.jsxs("div",{className:"search-input-wrapper",children:[A.jsx("input",{type:"text",placeholder:"Search by asset name, collection, transaction ID, or address...",value:H,onChange:e=>{q(e.target.value),Y(1)},className:"search-input"}),A.jsx("span",{className:"search-icon",children:"🔍"})]})}),A.jsxs("div",{className:"filters-section",children:[A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{children:"Type:"}),A.jsxs("select",{value:M,onChange:e=>{W(e.target.value),Y(1)},className:"filter-select",children:[A.jsx("option",{value:"all",children:"All Types"}),A.jsx("option",{value:"purchase",children:"🛒 Purchases"}),A.jsx("option",{value:"sale",children:"💰 Sales"}),A.jsx("option",{value:"transfer",children:"🔄 Transfers"}),A.jsx("option",{value:"tokens",children:"💸 Token Transactions"})]})]}),A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{children:"Date:"}),A.jsxs("select",{value:O,onChange:e=>{U(e.target.value),Y(1)},className:"filter-select",children:[A.jsx("option",{value:"7d",children:"Last 7 days"}),A.jsx("option",{value:"30d",children:"Last 30 days"}),A.jsx("option",{value:"90d",children:"Last 90 days"}),A.jsx("option",{value:"all",children:"All time"}),A.jsx("option",{value:"custom",children:"📅 Custom Range"})]}),"custom"===O&&A.jsxs("div",{className:"custom-date-range",children:[A.jsxs("div",{className:"date-input-group",children:[A.jsx("label",{children:"From:"}),A.jsx("input",{type:"date",className:"date-input",value:z.start,onChange:e=>{X(t=>({...t,start:e.target.value})),Y(1)}})]}),A.jsxs("div",{className:"date-input-group",children:[A.jsx("label",{children:"To:"}),A.jsx("input",{type:"date",className:"date-input",value:z.end,onChange:e=>{X(t=>({...t,end:e.target.value})),Y(1)}})]})]})]}),A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{children:"Sort:"}),A.jsxs("select",{value:`${Z}-${te}`,onChange:e=>{const[t,a]=e.target.value.split("-");ee(t),ae(a)},className:"filter-select",children:[A.jsx("option",{value:"date-desc",children:"📅 Newest First"}),A.jsx("option",{value:"date-asc",children:"📅 Oldest First"}),A.jsx("option",{value:"amount-desc",children:"💰 Highest Amount"}),A.jsx("option",{value:"amount-asc",children:"💰 Lowest Amount"}),A.jsx("option",{value:"type-asc",children:"🔤 Type A-Z"}),A.jsx("option",{value:"type-desc",children:"🔤 Type Z-A"})]})]})]})]}),re&&A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner",children:"⏳"}),A.jsx("h3",{children:"Loading Transactions..."}),A.jsx("p",{children:"Fetching your transaction history from the blockchain."})]}),ce&&!re&&A.jsxs("div",{className:"error-state",children:[A.jsx("div",{className:"error-icon",children:"❌"}),A.jsx("h3",{children:"Failed to Load Transactions"}),A.jsx("p",{children:ce}),A.jsx("button",{className:"retry-btn",onClick:()=>Me(),children:"🔄 Retry"})]}),de&&A.jsxs("div",{className:"export-error",children:[A.jsxs("span",{className:"error-text",children:["Export failed: ",de]}),A.jsx("button",{className:"dismiss-error-btn",onClick:()=>ue(null),children:"✕"})]}),A.jsx("div",{className:"transactions-list",children:re||ce||0!==at.length?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"transactions-grid",children:at.map(t=>{return A.jsxs("div",{className:"transaction-card",children:[A.jsxs("div",{className:"transaction-header",children:[A.jsxs("div",{className:"transaction-icon",children:["purchase"===t.type&&"🛒","sale"===t.type&&"💰","transfer"===t.type&&"🔄","token_send"===t.type&&"📤","token_receive"===t.type&&"📥","mint"===t.type&&"✨"]}),A.jsx("div",{className:"transaction-type-badge",children:A.jsx("span",{className:`type-badge ${t.type}`,children:t.type.charAt(0).toUpperCase()+t.type.slice(1).replace("_"," ")})}),A.jsx("div",{className:"transaction-status",children:A.jsxs("span",{className:`status-badge ${t.status}`,children:["completed"===t.status&&"✅","pending"===t.status&&"⏳","failed"===t.status&&"❌"]})})]}),A.jsxs("div",{className:"transaction-content",children:[A.jsxs("div",{className:"asset-info",children:[A.jsx("h4",{className:"asset-name",children:t.asset_name||"Unknown Asset"}),t.collection_name&&A.jsx("span",{className:"collection-name",children:t.collection_name})]}),t.price&&A.jsx("div",{className:"transaction-amount",children:A.jsxs("span",{className:"amount "+("sale"===t.type||"token_receive"===t.type?"positive":"negative"),children:["sale"===t.type||"token_receive"===t.type?"+":"-",(s=t.price,D(parseFloat(s.replace(" WAX",""))))]})}),A.jsxs("div",{className:"transaction-meta",children:[A.jsxs("div",{className:"meta-row",children:[A.jsx("span",{className:"meta-label",children:"Date:"}),A.jsx("span",{className:"meta-value",children:(a=t.block_time,new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))})]}),t.from&&t.from!==e&&A.jsxs("div",{className:"meta-row",children:[A.jsx("span",{className:"meta-label",children:"From:"}),A.jsx("span",{className:"meta-value address",children:t.from})]}),t.to&&t.to!==e&&A.jsxs("div",{className:"meta-row",children:[A.jsx("span",{className:"meta-label",children:"To:"}),A.jsx("span",{className:"meta-value address",children:t.to})]}),A.jsxs("div",{className:"meta-row",children:[A.jsx("span",{className:"meta-label",children:"TX ID:"}),A.jsxs("span",{className:"meta-value transaction-id-link",onClick:()=>l(`/transactions/${t.transaction_id}`),title:"View transaction details",children:[t.transaction_id.slice(0,12),"..."]})]}),t.memo&&A.jsxs("div",{className:"meta-row",children:[A.jsx("span",{className:"meta-label",children:"Memo:"}),A.jsx("span",{className:"meta-value memo",children:t.memo})]})]})]})]},t.transaction_id);var a,s})}),et>1&&A.jsxs("div",{className:"pagination",children:[A.jsx("div",{className:"pagination-info",children:A.jsxs("span",{children:["Showing ",tt+1,"-",Math.min(tt+Q,Ze.length)," of ",Ze.length," transactions"]})}),A.jsxs("div",{className:"pagination-controls",children:[A.jsx("button",{className:"pagination-btn",onClick:()=>Y(1),disabled:1===V,title:"First page",children:"⏮️"}),A.jsx("button",{className:"pagination-btn",onClick:()=>Y(V-1),disabled:1===V,title:"Previous page",children:"⏪"}),A.jsx("div",{className:"page-numbers",children:Array.from({length:Math.min(5,et)},(e,t)=>{let a;return a=et<=5||V<=3?t+1:V>=et-2?et-4+t:V-2+t,A.jsx("button",{className:"page-number "+(V===a?"active":""),onClick:()=>Y(a),children:a},a)})}),A.jsx("button",{className:"pagination-btn",onClick:()=>Y(V+1),disabled:V===et,title:"Next page",children:"⏩"}),A.jsx("button",{className:"pagination-btn",onClick:()=>Y(et),disabled:V===et,title:"Last page",children:"⏭️"})]})]})]}):A.jsxs("div",{className:"no-transactions",children:[A.jsx("div",{className:"no-transactions-icon",children:"📭"}),A.jsx("h3",{children:"No transactions found"}),A.jsx("p",{children:H?`No transactions match your search "${H}"`:"No transactions found for the selected filters."}),(H||"all"!==M||"all"!==O)&&A.jsx("button",{className:"clear-filters-btn",onClick:()=>{q(""),W("all"),U("all"),X({start:"",end:""}),Y(1)},children:"Clear All Filters"})]})})]}),"portfolio"===c&&A.jsx("div",{className:"portfolio-tab",children:A.jsx(ea,{})}),"pxbadges"===c&&A.jsx(ca,{}),"network-resources"===c&&A.jsxs("div",{className:"network-resources-tab",children:[A.jsxs("div",{className:"resources-header",children:[A.jsx("h2",{children:"Network Resources"}),A.jsx("p",{children:"Manage your WAX account resources (CPU, NET, RAM)"})]}),A.jsxs("div",{className:"resources-grid",children:[A.jsxs("div",{className:"resource-card cpu",children:[A.jsxs("div",{className:"resource-header",children:[A.jsx("div",{className:"resource-icon",children:"⚡"}),A.jsxs("div",{className:"resource-info",children:[A.jsx("h3",{children:"CPU"}),A.jsx("p",{children:"Processing power for transactions"})]})]}),A.jsxs("div",{className:"resource-stats",children:[A.jsx("div",{className:"usage-bar",children:A.jsx("div",{className:"usage-fill cpu",style:{width:y?y.cpu.used/y.cpu.max*100+"%":"45%"}})}),A.jsx("div",{className:"usage-text",children:y?`${(y.cpu.used/y.cpu.max*100).toFixed(1)}% used (${(y.cpu.used/1e3).toFixed(1)}ms / ${(y.cpu.max/1e3).toFixed(1)}ms)`:"45% used (4.5ms / 10ms)"})]}),A.jsxs("div",{className:"resource-actions",children:[A.jsx("button",{className:"stake-btn",onClick:()=>Je("cpu","stake"),children:"Stake CPU"}),A.jsx("button",{className:"unstake-btn",onClick:()=>Je("cpu","unstake"),children:"Unstake CPU"})]})]}),A.jsxs("div",{className:"resource-card net",children:[A.jsxs("div",{className:"resource-header",children:[A.jsx("div",{className:"resource-icon",children:"🌐"}),A.jsxs("div",{className:"resource-info",children:[A.jsx("h3",{children:"NET"}),A.jsx("p",{children:"Network bandwidth for transactions"})]})]}),A.jsxs("div",{className:"resource-stats",children:[A.jsx("div",{className:"usage-bar",children:A.jsx("div",{className:"usage-fill net",style:{width:y?y.net.used/y.net.max*100+"%":"30%"}})}),A.jsx("div",{className:"usage-text",children:y?`${(y.net.used/y.net.max*100).toFixed(1)}% used (${(y.net.used/1024).toFixed(1)}KB / ${(y.net.max/1024).toFixed(1)}KB)`:"30% used (3KB / 10KB)"})]}),A.jsxs("div",{className:"resource-actions",children:[A.jsx("button",{className:"stake-btn",onClick:()=>Je("net","stake"),children:"Stake NET"}),A.jsx("button",{className:"unstake-btn",onClick:()=>Je("net","unstake"),children:"Unstake NET"})]})]}),A.jsxs("div",{className:"resource-card ram",children:[A.jsxs("div",{className:"resource-header",children:[A.jsx("div",{className:"resource-icon",children:"💾"}),A.jsxs("div",{className:"resource-info",children:[A.jsx("h3",{children:"RAM"}),A.jsx("p",{children:"Storage space for account data"})]})]}),A.jsxs("div",{className:"resource-stats",children:[A.jsx("div",{className:"usage-bar",children:A.jsx("div",{className:"usage-fill ram",style:{width:y?y.ram.used/y.ram.max*100+"%":"65%"}})}),A.jsx("div",{className:"usage-text",children:y?`${(y.ram.used/y.ram.max*100).toFixed(1)}% used (${(y.ram.used/1024).toFixed(1)}KB / ${(y.ram.max/1024).toFixed(1)}KB)`:"65% used (6.5KB / 10KB)"})]}),A.jsxs("div",{className:"resource-actions",children:[A.jsx("button",{className:"buy-ram-btn",onClick:()=>Ve("buy"),children:"Buy RAM"}),A.jsx("button",{className:"sell-ram-btn",onClick:()=>Ve("sell"),children:"Sell RAM"})]})]})]})]}),"powerup"===c&&A.jsxs("div",{className:"powerup-tab",children:[A.jsxs("div",{className:"powerup-header",children:[A.jsx("h2",{children:"Powerup Resources"}),A.jsx("p",{children:"Boost your account resources for 24 hours"})]}),A.jsx("div",{className:"powerup-stats",children:A.jsxs("div",{className:"current-usage",children:[A.jsx("h3",{children:"Current Resource Usage"}),A.jsxs("div",{className:"usage-grid",children:[A.jsxs("div",{className:"usage-item",children:[A.jsx("span",{className:"usage-label",children:"CPU:"}),A.jsx("div",{className:"usage-bar",children:A.jsx("div",{className:"usage-fill",style:{width:y?`${He(y.cpu.used,y.cpu.max)}%`:"0%"}})}),A.jsx("span",{className:"usage-percent",children:y?`${He(y.cpu.used,y.cpu.max).toFixed(1)}%`:"0%"})]}),A.jsxs("div",{className:"usage-item",children:[A.jsx("span",{className:"usage-label",children:"NET:"}),A.jsx("div",{className:"usage-bar",children:A.jsx("div",{className:"usage-fill",style:{width:y?`${He(y.net.used,y.net.max)}%`:"0%"}})}),A.jsx("span",{className:"usage-percent",children:y?`${He(y.net.used,y.net.max).toFixed(1)}%`:"0%"})]})]})]})}),A.jsxs("div",{className:"powerup-form",children:[A.jsxs("div",{className:"form-section",children:[A.jsx("label",{children:"Account to Boost:"}),A.jsx("input",{type:"text",placeholder:"Enter account name",value:ve,onChange:e=>we(e.target.value)})]}),A.jsxs("div",{className:"form-section",children:[A.jsx("label",{children:"WAX Amount to Spend:"}),A.jsxs("div",{className:"amount-input-container",children:[A.jsx("input",{type:"number",placeholder:"0.0000",value:Ce||"",onChange:e=>{const t=e.target.value;if((""===t||/^\d*\.?\d*$/.test(t))&&(""===t||!isNaN(Number(t)))){if(""!==t){const e=parseFloat(w.split(" ")[0]);if(Number(t)>e)return}Ae(Number(t))}},step:"0.0001",min:"0",max:parseFloat(w.split(" ")[0])}),A.jsx("span",{className:"wax-label",children:"WAX"})]}),A.jsxs("div",{className:"slider-container",children:[A.jsx("input",{type:"range",min:"0",max:"100",value:parseFloat(w.split(" ")[0])>0?Ce/parseFloat(w.split(" ")[0])*100:0,onChange:e=>{const t=Number(e.target.value),a=parseFloat(w.split(" ")[0]),s=Number(a*t/100).toFixed(8);Ae(Number(s))},className:"slider"}),A.jsxs("div",{className:"slider-value",children:[D(Ce)," (Max: ",w,")"]})]})]}),A.jsxs("div",{className:"form-section",children:[A.jsxs("label",{children:["CPU/NET Ratio: ",ke,"% CPU / ",100-ke,"% NET"]}),A.jsxs("div",{className:"progress-container",children:[A.jsxs("div",{className:"progress-bar-container",children:[A.jsx("div",{className:"progress-bar cpu",style:{width:`${ke}%`}}),A.jsx("div",{className:"progress-bar net",style:{width:100-ke+"%"}})]}),A.jsxs("div",{className:"progress-text",children:[A.jsxs("span",{className:"cpu-text",children:[ke,"% CPU"]}),A.jsx("span",{className:"separator",children:" / "}),A.jsxs("span",{className:"net-text",children:[100-ke,"% NET"]})]})]}),A.jsx("div",{className:"slider-container",children:A.jsx("input",{type:"range",min:"0",max:"100",value:ke,onChange:e=>{const t=Number(e.target.value);Se(t)},className:"slider"})})]}),Ce>0&&Ie&&$e&&A.jsxs("div",{className:"powerup-estimation",children:[A.jsx("h4",{children:"Estimated Boost (24 hours):"}),A.jsxs("div",{className:"boost-details",children:[A.jsxs("div",{className:"boost-item",children:[A.jsx("span",{children:"CPU:"}),A.jsx("span",{children:la(na(Ce,ke),ia(Ce,ke),Ie?.cpu,Ie?.net,$e)})]}),A.jsxs("div",{className:"boost-item",children:[A.jsx("span",{children:"NET:"}),A.jsx("span",{children:(nt=ra(na(Ce,ke),ia(Ce,ke),Ie?.cpu,Ie?.net).netAmount,!nt||nt<=0?"0 bytes":nt>=1048576?`${(nt/1048576).toFixed(2)} MB`:nt>=1024?`${(nt/1024).toFixed(2)} KB`:`${nt} bytes`)})]})]}),A.jsxs("div",{className:"cost-info",children:[A.jsxs("div",{className:"cost-item",children:[A.jsx("span",{children:"CPU Cost:"}),A.jsxs("span",{children:[ra(na(Ce,ke),ia(Ce,ke),Ie?.cpu,Ie?.net).cpuFee.toFixed(8)," WAX"]})]}),A.jsxs("div",{className:"cost-item",children:[A.jsx("span",{children:"NET Cost:"}),A.jsxs("span",{children:[ra(na(Ce,ke),ia(Ce,ke),Ie?.cpu,Ie?.net).netFee.toFixed(8)," WAX"]})]})]})]}),A.jsx("button",{className:"powerup-btn",disabled:!Ce||Ce<=0||!ve||Ee,onClick:()=>{if(Ce>0&&ve&&s){const e=na(Ce,ke),t=ia(Ce,ke);(async(e,t,a,s,n,i,r,l,c)=>{if(i(!0),r("Awaiting confirmation..."),null==localStorage.getItem("wharf--session"))return void r("You are not logged in. Click the wallet icon in the top menu");const o=c;let d=`${Number(a).toFixed(8)} WAX`;const u=[{account:"waxdao",name:"powerup",authorization:[o.permissionLevel],data:{}},{account:"eosio",name:"powerup",authorization:[o.permissionLevel],data:{payer:o.actor,receiver:t,days:1,net_frac:parseFloat(n).toFixed(0),cpu_frac:parseFloat(s).toFixed(0),max_payment:d}}];try{await o.transact({actions:u},ta),l(!0),r("Processing transaction...");const a=setTimeout(()=>{r(`${t} has been boosted with ${d}`),e(e=>!e),l(!1)},3e3);return()=>clearTimeout(a)}catch(m){console.log("ERROR: ",m),r(m.message)}})(ve,Ce,e,t,Pe,s)}},children:Ee?"Processing...":"Boost Resources"})]})]}),"token-balances"===c&&A.jsxs("div",{className:"token-balances-tab",children:[A.jsxs("div",{className:"balances-header",children:[A.jsx("h2",{children:"Token Balances"}),A.jsx("p",{children:"View your token balances with USD values"}),A.jsxs("div",{className:"balance-summary",children:[A.jsxs("div",{className:"balance-summary-item",children:[A.jsx("span",{className:"balance-summary-label",children:"Total Tokens:"}),A.jsx("span",{className:"balance-summary-value",children:b.length})]}),A.jsxs("div",{className:"balance-summary-item",children:[A.jsx("span",{className:"balance-summary-label",children:"With USD Values:"}),A.jsx("span",{className:"balance-summary-value",children:b.filter(e=>"N/A"!==e.value&&"0.00"!==e.value).length})]})]})]}),A.jsxs("div",{className:"balances-controls",children:[A.jsxs("div",{className:"search-sort",children:[A.jsx("input",{type:"text",placeholder:"Search tokens...",className:"search-input"}),A.jsxs("select",{className:"sort-select",children:[A.jsx("option",{value:"balance",children:"Sort by Balance"}),A.jsx("option",{value:"value",children:"Sort by Value"}),A.jsx("option",{value:"name",children:"Sort by Name"})]})]}),A.jsxs("div",{className:"bulk-actions",children:[A.jsx("button",{className:"select-all-btn",onClick:()=>{if(_.size===b.length)S(new Set);else{const e=b.map((e,t)=>t.toString());S(new Set(e))}},children:_.size===b.length?"Deselect All":"Select All"}),A.jsxs("span",{className:"selected-info",children:[_.size," selected"]}),A.jsx("button",{className:"bulk-sell-btn",onClick:async()=>{if(0!==_.size&&e){E(!0);try{const e=Array.from(_).map(e=>b[parseInt(e)]).filter(e=>"PXJ"!==e.symbol);if(0===e.length)return void alert("No valid tokens selected for swap (PXJ cannot be swapped for itself)");let a=0;const s=[];for(const l of e)try{const e=parseFloat(l.balance.split(" ")[0]),t=await ye.getAlcorSwapQuote({from_token:l.symbol,from_contract:l.contract,to_token:"PXJ",to_contract:"pixeljourney",amount:e.toString(),slippage:.5});t&&parseFloat(t.output.amount)>0?(s.push({token:l.symbol,amount:e,pxjReceived:parseFloat(t.output.amount),success:!0}),a+=parseFloat(t.output.amount)):s.push({token:l.symbol,amount:e,pxjReceived:0,success:!1,error:"No liquidity available"})}catch(t){K(`Failed to get swap quote for ${l.symbol}`,"UserProfile",t),s.push({token:l.symbol,amount:parseFloat(l.balance.split(" ")[0]),pxjReceived:0,success:!1,error:"Swap quote failed"})}const n=s.filter(e=>e.success),i=s.filter(e=>!e.success);let r="Bulk Sell Summary:\n\n";n.length>0&&(r+=`Successful swaps (${n.length}):\n`,n.forEach(e=>{r+=`• ${e.amount} ${e.token} → ${e.pxjReceived.toFixed(8)} PXJ\n`}),r+=`\nTotal PXJ received: ${a.toFixed(8)} PXJ\n`),i.length>0&&(r+=`\nFailed swaps (${i.length}):\n`,i.forEach(e=>{r+=`• ${e.amount} ${e.token} - ${e.error}\n`})),r+="\nNote: This is a preview. Actual swaps would require wallet confirmation.",alert(r),S(new Set),n.length>0&&await ze()}catch(t){K("Bulk sell failed","UserProfile",t),alert("Bulk sell failed. Please try again.")}finally{E(!1)}}},disabled:0===_.size||C,children:C?"Processing...":"Bulk Sell into PXJ "+(_.size>0?`(${_.size})`:"(Coming Soon)")})]})]}),A.jsx("div",{className:"token-balances-grid",children:0===b.length?A.jsxs("div",{className:"no-tokens-message",children:[A.jsx("div",{className:"no-tokens-icon",children:"🪙"}),A.jsx("h3",{children:"No Token Balances Found"}),A.jsx("p",{children:"Your account doesn't have any token balances or they're still loading."})]}):b.map((e,t)=>A.jsxs("div",{className:"token-balance-card",children:[A.jsxs("div",{className:"token-header",children:[A.jsx("div",{className:"token-icon",children:"🪙"}),A.jsxs("div",{className:"token-details",children:[A.jsx("h3",{children:e.symbol}),A.jsx("p",{className:"token-contract",children:e.contract})]})]}),A.jsxs("div",{className:"token-amounts",children:[A.jsxs("div",{className:"token-balance",children:[A.jsx("span",{className:"balance-label",children:"Balance:"}),A.jsx("span",{className:"balance-value",children:e.balance})]}),A.jsxs("div",{className:"token-usd-value",children:[A.jsx("span",{className:"usd-label",children:"USD Value:"}),A.jsx("span",{className:"usd-value "+("N/A"===e.value?"unavailable":"0.00"===e.value?"zero":"available"),children:"N/A"===e.value?"N/A":`$${e.value}`})]})]}),A.jsxs("div",{className:"token-actions",children:[A.jsx("button",{className:"token-action-btn transfer",onClick:()=>(e=>{ge({isOpen:!0,token:e})})(e),children:"Transfer"}),A.jsx("button",{className:"token-action-btn trade",disabled:!0,children:"Trade"})]})]},`${e.contract}-${e.symbol}-${t}`))})]})]})]})]}),A.jsx(Yt,{isOpen:me.isOpen,onClose:()=>{he({isOpen:!1,resourceType:"cpu",action:"stake"})},resourceType:me.resourceType,action:me.action,onSuccess:Ke}),A.jsx(Qt,{isOpen:pe.isOpen,onClose:()=>{fe({isOpen:!1,action:"buy"})},action:pe.action,onSuccess:Ke}),A.jsx(Zt,{isOpen:xe.isOpen,onClose:Ge,token:xe.token,onSuccess:()=>{We(),Ge()}})]}):A.jsx("div",{className:"user-profile",children:A.jsx("div",{className:"profile-container",children:A.jsxs("div",{className:"not-connected",children:[A.jsx("div",{className:"not-connected-icon",children:"🔒"}),A.jsx("h2",{children:"Connect Your Wallet"}),A.jsx("p",{children:"Please connect your wallet to view your profile and transaction history."})]})})});var nt},da=()=>{const{account:e}=l(),[t]=c(),s=i(),n=e||t.get("user"),[r,o]=a.useState(null),[d,u]=a.useState(null),[m,h]=a.useState(null),[p,f]=a.useState("0.0000"),[x,g]=a.useState([]),[v,y]=a.useState(null),[j,b]=a.useState(!1),[N,w]=a.useState(null),[k,_]=a.useState(null),[S,C]=a.useState(!1),[E,P]=a.useState({}),[T,I]=a.useState(1),[F,$]=a.useState("all"),[L,M]=a.useState([]),[R,W]=a.useState({Body:"",Eyes:"",Head:"",Mouth:"",WaxRock:"",PixelPet:"",Background:"","Hats and Hair":"","Glasses and Masks":"","Special Accessories":""}),[O,D]=a.useState({}),B=a.useCallback(async e=>{try{const a=["token.pxj","eosio.token"],s=[];for(const n of a)try{const t=await ye.getWaxCurrencyBalance(e,n),a=await Promise.all(t.map(async e=>({...e,contract:n,value:await H(e.balance,e.symbol)})));s.push(...a)}catch(t){console.error(`Failed to fetch balance for ${n}:`,t)}g(s)}catch(t){console.error("Error fetching token balances:",t)}},[]),U=a.useCallback(async()=>{if(n){b(!0),w(null);try{const e=await ye.getUserInventory(n),t=[...new Set(e.map(e=>e.collection))],a=await be.checkUserBadges(n);M(a.badges);const s=e.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema),i={Body:new Set,Eyes:new Set,Head:new Set,Mouth:new Set,WaxRock:new Set,PixelPet:new Set,Background:new Set,"Hats and Hair":new Set,"Glasses and Masks":new Set,"Special Accessories":new Set};s.forEach(e=>{Object.keys(i).forEach(t=>{const a=e.data?.[t];a&&"none"!==a&&""!==a&&i[t].add(a)})});const r={};Object.entries(i).forEach(([e,t])=>{r[e]=Array.from(t).sort()}),D(r),await Promise.all([z(n),X(n),B(n)]);const l=await(async e=>{try{const t=await ye.getWaxAccountInfo(e);if(t&&t.created)return new Date(t.created).toISOString().split("T")[0]}catch(N){console.warn("Could not fetch account creation date:",N)}try{const t=await ye.getUserTransactions(e,1);if(t&&t.length>0){const e=t[t.length-1];if(e.block_time)return new Date(e.block_time).toISOString().split("T")[0]}}catch(N){console.warn("Could not fetch first transaction date:",N)}return"2023-01-01"})(n),c={account:n,nftsOwned:e,totalNFTs:e.length,collections:t,joinDate:l,isVerified:a.badges.some(e=>"pixal-pfp"===e.id),badges:a.badges.map(e=>e.name)},d=await q(e),m={totalAssets:e.length,uniqueCollections:t.length,totalValue:d,rareAssets:e.filter(e=>e.template_mint&&e.template_mint<=100).length};o(c),u(m),t.length>0&&V(t)}catch(e){console.error("Error loading user profile:",e),w("Failed to load user profile. Please check the account name and try again.")}finally{b(!1)}}},[n,B]);a.useEffect(()=>{n&&U()},[n,U]);const z=async e=>{try{const t=await ye.getWaxAccountInfo(e);if(h(t),t){const e={cpu:{used:t.cpu_limit.used,available:t.cpu_limit.available,max:t.cpu_limit.max},net:{used:t.net_limit.used,available:t.net_limit.available,max:t.net_limit.max},ram:{used:t.ram_usage,available:t.ram_quota-t.ram_usage,max:t.ram_quota}};y(e)}}catch(t){console.error("Failed to fetch WAX account info:",t)}},X=async e=>{try{const t=await Ne.getWaxBalance(e);f(t)}catch(t){console.error("Failed to fetch WAX balance:",t)}},H=async(e,t)=>{const a=parseFloat(e.split(" ")[0]);try{const e={TLM:"alien.worlds",NEFTY:"neftyblocksp",SEST:"sest.token"}[t];if(e){const s=await ye.getAlcorTokenPrice(t,e);if(s&&s.usd_price)return`$${(a*s.usd_price).toFixed(4)}`}return`$${(a*({TLM:.02,NEFTY:.001,SEST:1e-4}[t]||.001)).toFixed(4)}`}catch(s){console.error(`Error fetching price for ${t}:`,s);return`$${(a*({TLM:.02,NEFTY:.001,SEST:1e-4}[t]||.001)).toFixed(4)}`}},q=async e=>{if(0===e.length)return"0.00 WAX";try{const a=e.reduce((e,t)=>{const a=t.collection;return e[a]||(e[a]=[]),e[a].push(t),e},{});let s=0;for(const[e,n]of Object.entries(a))try{const t=await ye.getCollectionStats(e);let a=0;if(t&&t.floor_price)a=parseFloat(t.floor_price);else{const t=await fetch(`${ye.atomicMarketAPI}/atomicmarket/v1/sales?state=3&collection_name=${e}&limit=50&order=desc&sort=updated`),s=await t.json();if(s.success&&s.data?.length>0){const e=s.data.filter(e=>e.price?.amount).map(e=>parseFloat(e.price.amount)/Math.pow(10,e.price.token_precision||8));e.length>0&&(a=Math.min(...e))}}0===a&&(a=1),n.forEach(e=>{let t=a;e.template_mint&&(e.template_mint<=10?t*=3:e.template_mint<=50?t*=2:e.template_mint<=100&&(t*=1.5)),s+=t})}catch(t){console.warn(`Failed to get market data for collection ${e}, using fallback pricing:`,t),s+=1.5*n.length}return`${s.toFixed(2)} WAX`}catch(t){console.error("Error calculating total portfolio value:",t);return`${(2*e.length).toFixed(2)} WAX`}},J=()=>{if(!r)return[];let e=r.nftsOwned;switch(F){case"pixals":e=e.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema),Object.entries(R).forEach(([t,a])=>{a&&""!==a&&(e=e.filter(e=>{const s=e.data?.[t];return s&&s.toLowerCase().includes(a.toLowerCase())}))});break;case"waxrock":e=e.filter(e=>{const t=e.data?.WaxRock;return"pixeljourney"===e.collection&&"pixals"===e.schema&&t&&"none"!==t});break;case"ingredients":e=e.filter(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema)}return e},V=async e=>{const t={};for(const s of e)try{const e=await fetch(`https://aa.dapplica.io/atomicassets/v1/collections/${s}`),a=await e.json();if(a.success&&a.data?.img){const e=a.data.img;t[s]=e.startsWith("http")?e:`https://ipfs.io/ipfs/${e}`}}catch(a){console.error(`Error fetching avatar for collection ${s}:`,a)}P(t)},G=e=>{I(e),window.scrollTo({top:0,behavior:"smooth"})};if(j)return A.jsx("div",{className:"user-profile-lookup",children:A.jsx("div",{className:"profile-container",children:A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading user profile..."})]})})});if(N)return A.jsx("div",{className:"user-profile-lookup",children:A.jsx("div",{className:"profile-container",children:A.jsxs("div",{className:"error-state",children:[A.jsx("div",{className:"error-icon",children:"⚠️"}),A.jsx("h2",{children:"Profile Not Found"}),A.jsx("p",{children:N}),A.jsxs("div",{className:"error-actions",children:[A.jsx("button",{onClick:()=>s(-1),className:"btn-secondary",children:"Go Back"}),A.jsx("button",{onClick:U,className:"btn-primary",children:"Try Again"})]})]})})});if(!r||!d)return A.jsx("div",{className:"user-profile-lookup",children:A.jsx("div",{className:"profile-container",children:A.jsx("div",{className:"no-data",children:A.jsx("p",{children:"No profile data available"})})})});const K=J(),Y=(()=>{const e=J(),t=20*(T-1);return e.slice(t,t+20)})(),Q=(()=>{const e=J();return Math.ceil(e.length/20)})();return A.jsxs("div",{className:"user-profile-lookup",children:[A.jsxs("div",{className:"profile-container",children:[A.jsxs("div",{className:"profile-header",children:[A.jsx("div",{className:"profile-avatar",children:A.jsx("div",{className:"avatar-placeholder",children:n?.charAt(0).toUpperCase()})}),A.jsxs("div",{className:"profile-info",children:[A.jsx("h1",{children:n}),A.jsxs("div",{className:"profile-badges",children:[r.isVerified&&A.jsx("span",{className:"badge verified",children:"✓ Verified"}),L.map(e=>A.jsxs("span",{className:`badge ${e.id}`,title:e.description,children:[e.icon," ",e.name]},e.id))]})]}),A.jsxs("div",{className:"profile-stats-quick",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:d.totalAssets}),A.jsx("span",{className:"stat-label",children:"NFTs Owned"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:d.uniqueCollections}),A.jsx("span",{className:"stat-label",children:"Collections"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("span",{className:"stat-value",children:d.rareAssets}),A.jsx("span",{className:"stat-label",children:"Rare Assets"})]})]})]}),m&&A.jsxs("div",{className:"account-info-section",children:[A.jsx("h3",{children:"Account Information"}),A.jsxs("div",{className:"account-info-grid",children:[A.jsxs("div",{className:"user-info-card",children:[A.jsx("div",{className:"info-icon",children:"👤"}),A.jsxs("div",{className:"info-details",children:[A.jsx("h4",{children:"Account Name"}),A.jsx("p",{children:m.account_name})]})]}),A.jsxs("div",{className:"user-info-card",children:[A.jsx("div",{className:"info-icon",children:"📅"}),A.jsxs("div",{className:"info-details",children:[A.jsx("h4",{children:"Created"}),A.jsx("p",{children:new Date(m.created).toLocaleDateString()})]})]}),A.jsxs("div",{className:"user-info-card",children:[A.jsx("div",{className:"info-icon",children:"🔑"}),A.jsxs("div",{className:"info-details",children:[A.jsx("h4",{children:"Permissions"}),A.jsxs("p",{children:[m.permissions?.length||0," keys"]})]})]})]})]}),A.jsxs("div",{className:"balance-section",children:[A.jsx("h3",{children:"Balances"}),A.jsxs("div",{className:"balance-grid",children:[A.jsxs("div",{className:"balance-card primary",children:[A.jsx("div",{className:"balance-icon",children:"💰"}),A.jsxs("div",{className:"balance-details",children:[A.jsx("h4",{children:"WAX Balance"}),A.jsx("p",{className:"balance-value",children:p})]})]}),x.map((e,t)=>A.jsxs("div",{className:"balance-card",children:[A.jsx("div",{className:"balance-icon",children:"🪙"}),A.jsxs("div",{className:"balance-details",children:[A.jsx("h4",{children:e.symbol}),A.jsx("p",{className:"balance-value",children:e.balance}),A.jsx("p",{className:"balance-usd",children:e.value})]})]},t))]})]}),v&&A.jsxs("div",{className:"resources-section",children:[A.jsx("h3",{children:"Resources"}),A.jsxs("div",{className:"resources-grid",children:[A.jsxs("div",{className:"resource-card",children:[A.jsxs("div",{className:"resource-header",children:[A.jsx("span",{className:"resource-icon",children:"⚡"}),A.jsx("h4",{children:"CPU"})]}),A.jsx("div",{className:"resource-bar",children:A.jsx("div",{className:"resource-fill",style:{width:v.cpu.used/v.cpu.max*100+"%"}})}),A.jsxs("div",{className:"resource-stats",children:[A.jsxs("span",{children:[v.cpu.used.toLocaleString()," / ",v.cpu.max.toLocaleString()]}),A.jsxs("span",{children:[(v.cpu.used/v.cpu.max*100).toFixed(1),"%"]})]})]}),A.jsxs("div",{className:"resource-card",children:[A.jsxs("div",{className:"resource-header",children:[A.jsx("span",{className:"resource-icon",children:"🌐"}),A.jsx("h4",{children:"NET"})]}),A.jsx("div",{className:"resource-bar",children:A.jsx("div",{className:"resource-fill",style:{width:v.net.used/v.net.max*100+"%"}})}),A.jsxs("div",{className:"resource-stats",children:[A.jsxs("span",{children:[v.net.used.toLocaleString()," / ",v.net.max.toLocaleString()]}),A.jsxs("span",{children:[(v.net.used/v.net.max*100).toFixed(1),"%"]})]})]}),A.jsxs("div",{className:"resource-card",children:[A.jsxs("div",{className:"resource-header",children:[A.jsx("span",{className:"resource-icon",children:"💾"}),A.jsx("h4",{children:"RAM"})]}),A.jsx("div",{className:"resource-bar",children:A.jsx("div",{className:"resource-fill",style:{width:v.ram.used/v.ram.max*100+"%"}})}),A.jsxs("div",{className:"resource-stats",children:[A.jsxs("span",{children:[(v.ram.used/1024).toFixed(2)," KB / ",(v.ram.max/1024).toFixed(2)," KB"]}),A.jsxs("span",{children:[(v.ram.used/v.ram.max*100).toFixed(1),"%"]})]})]})]})]}),A.jsxs("div",{className:"stats-grid",children:[A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-icon",children:"🎨"}),A.jsxs("div",{className:"stat-details",children:[A.jsx("h3",{children:"Total Assets"}),A.jsx("p",{className:"stat-value",children:d.totalAssets})]})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-icon",children:"📚"}),A.jsxs("div",{className:"stat-details",children:[A.jsx("h3",{children:"Collections"}),A.jsx("p",{className:"stat-value",children:d.uniqueCollections})]})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-icon",children:"💎"}),A.jsxs("div",{className:"stat-details",children:[A.jsx("h3",{children:"Estimated Value"}),A.jsx("p",{className:"stat-value",children:d.totalValue})]})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-icon",children:"⭐"}),A.jsxs("div",{className:"stat-details",children:[A.jsx("h3",{children:"Rare Assets"}),A.jsx("p",{className:"stat-value",children:d.rareAssets})]})]})]}),A.jsxs("div",{className:"collections-section",children:[A.jsxs("h3",{children:["Collections (",r.collections.length,")"]}),A.jsx("div",{className:"collections-list",children:r.collections.map((e,t)=>A.jsxs("div",{className:"collection-item",onClick:()=>s(`/collections/${e}`),children:[A.jsxs("div",{className:"user-collection-avatar",children:[E[e]?A.jsx("img",{src:E[e],alt:`${e} avatar`,onError:e=>{e.currentTarget.style.display="none",e.currentTarget.nextElementSibling.style.display="flex"}}):null,A.jsx("div",{className:"fallback-avatar",style:{display:E[e]?"none":"flex"},children:e.charAt(0).toUpperCase()})]}),A.jsx("span",{className:"collection-name",children:e}),A.jsx("span",{className:"collection-count",children:r.nftsOwned.filter(t=>t.collection===e).length})]},t))})]}),A.jsxs("div",{className:"inventory-section",children:[A.jsxs("div",{className:"inventory-header",children:[A.jsxs("h3",{children:["NFT Inventory (",K.length,")"]}),A.jsxs("div",{className:"filter-tabs",children:[A.jsxs("button",{className:"filter-tab "+("all"===F?"active":""),onClick:()=>{$("all"),I(1)},children:["All (",r.nftsOwned.length,")"]}),A.jsxs("button",{className:"filter-tab "+("pixals"===F?"active":""),onClick:()=>{$("pixals"),I(1)},children:["Pixals (",r.nftsOwned.filter(e=>"pixeljourney"===e.collection&&"pixals"===e.schema).length,")"]}),A.jsxs("button",{className:"filter-tab "+("waxrock"===F?"active":""),onClick:()=>{$("waxrock"),I(1)},children:["WaxRock (",r.nftsOwned.filter(e=>{const t=e.data?.WaxRock;return"pixeljourney"===e.collection&&"pixals"===e.schema&&t&&"none"!==t}).length,")"]}),A.jsxs("button",{className:"filter-tab "+("ingredients"===F?"active":""),onClick:()=>{$("ingredients"),I(1)},children:["Ingredients (",r.nftsOwned.filter(e=>"pixeljourney"===e.collection&&"ingredients"===e.schema).length,")"]})]}),"pixals"===F&&A.jsxs("div",{className:"pixal-filters",children:[A.jsx("h4",{children:"Filter by Traits"}),A.jsx("div",{className:"filters-grid",children:Object.entries(R).map(([e,t])=>A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{children:e}),A.jsxs("select",{value:t,onChange:t=>{W(a=>({...a,[e]:t.target.value})),I(1)},children:[A.jsxs("option",{value:"",children:["All ",e]}),O[e]?.map(e=>A.jsx("option",{value:e,children:e},e))]})]},e))}),A.jsx("button",{className:"clear-filters-btn",onClick:()=>{W({Body:"",Eyes:"",Head:"",Mouth:"",WaxRock:"",PixelPet:"",Background:"","Hats and Hair":"","Glasses and Masks":"","Special Accessories":""}),I(1)},children:"Clear All Filters"})]})]}),0===Y.length?A.jsxs("div",{className:"empty-inventory",children:[A.jsx("div",{className:"empty-icon",children:"📦"}),A.jsx("h3",{children:"No NFTs Found"}),A.jsx("p",{children:"This user doesn't have any NFTs in the selected category."})]}):A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"nft-grid",children:Y.map(e=>A.jsxs("div",{className:"nft-card",onClick:()=>(e=>{_(e),C(!0)})(e),children:[A.jsx("div",{className:"nft-image",children:e.video?A.jsx("video",{src:e.video,className:"nft-media",muted:!0,loop:!0,onMouseEnter:e=>e.currentTarget.play(),onMouseLeave:e=>e.currentTarget.pause(),onError:t=>{const a=document.createElement("img");a.src=e.image,a.className="nft-media",a.alt=e.name,a.loading="lazy",t.currentTarget.parentNode?.replaceChild(a,t.currentTarget)}}):A.jsx("img",{src:e.image,alt:e.name,className:"nft-media",loading:"lazy"})}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h4",{className:"nft-name",children:e.name}),A.jsx("p",{className:"nft-collection",children:e.collection}),A.jsxs("div",{className:"nft-schema-template",children:[A.jsx("span",{className:"nft-schema",children:e.schema}),e.template_id&&A.jsxs("span",{className:"nft-template",children:["T#",e.template_id]})]}),A.jsxs("div",{className:"nft-details",children:[A.jsxs("span",{className:"nft-mint",children:["#",e.template_mint]}),e.max_supply&&parseInt(e.max_supply)>0&&A.jsxs("span",{className:"nft-supply",children:["/",e.max_supply]})]})]})]},e.asset_id))}),Q>1&&A.jsxs("div",{className:"pagination",children:[A.jsx("button",{className:"pagination-btn",onClick:()=>G(T-1),disabled:1===T,children:"Previous"}),A.jsx("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,Q)},(e,t)=>{let a;return a=Q<=5||T<=3?t+1:T>=Q-2?Q-4+t:T-2+t,A.jsx("button",{className:"pagination-number "+(T===a?"active":""),onClick:()=>G(a),children:a},a)})}),A.jsx("button",{className:"pagination-btn",onClick:()=>G(T+1),disabled:T===Q,children:"Next"})]})]})]})]}),k&&A.jsx(et,{nft:k,isOpen:S,onClose:()=>{C(!1),_(null)}})]})},ua=()=>{const{settings:e}=ue(),{showSuccess:t,showError:s}=_e(),[n,i]=a.useState([]),[r,l]=a.useState(!1),[c,o]=a.useState(null),[d,u]=a.useState(!1),[m,h]=a.useState(new Set),[p,f]=a.useState(!1),[x,g]=a.useState(!1),[v,y]=a.useState(""),[j,b]=a.useState(""),[N,w]=a.useState(1),[k,_]=a.useState(!1),[S,C]=a.useState(1),{isConnected:E,account:P,login:T,session:I}=R();a.useEffect(()=>{const e=setTimeout(()=>{b(v)},300);return()=>clearTimeout(e)},[v]);const F=a.useCallback(async(e=1,t=!1)=>{if(P){1===e&&l(!0);try{const a=await ye.getUserInventoryPaginated(P,e,100),s=a.assets.map(e=>({asset_id:e.asset_id,name:e.name,img:e.image,video:e.video||e.traits?.video||void 0,collection:{name:e.collection,collection_name:e.collection},schema:{schema_name:e.schema},template:{template_id:e.template_id?.toString()||"0",max_supply:(e.max_supply||0).toString()},data:e.traits||{},mint_number:e.template_mint})).filter(e=>Nt.isPackNFT(e));t?i(e=>[...e,...s]):(i(s),w(1)),_(100===a.assets.length),C(e)}catch(a){console.error("Error loading packs:",a),s("Failed to load pack inventory")}finally{l(!1)}}},[P,s]);a.useEffect(()=>{E&&P?F(1,!1):i([])},[E,P,F]);const $=a.useMemo(()=>{if(!j)return n;const e=j.toLowerCase();return n.filter(t=>t.name.toLowerCase().includes(e)||t.collection.collection_name.toLowerCase().includes(e)||t.schema.schema_name.toLowerCase().includes(e))},[n,j]),L=a.useMemo(()=>{const e=20*(N-1),t=e+20;return $.slice(e,t)},[$,N,20]),M=Math.ceil($.length/20),W=$.length,O=e=>{w(e),window.scrollTo({top:0,behavior:"smooth"})};return E?A.jsxs("div",{className:"page-content packs-page",children:[A.jsxs("div",{className:"page-header",children:[A.jsx("h1",{children:"Pack Inventory"}),A.jsx("p",{children:"Manage and unpack your NFT packs, chests, boxes, and containers"})]}),A.jsxs("div",{className:"inventory-controls",children:[A.jsx("div",{className:"search-container",children:A.jsx("input",{type:"text",placeholder:"Search packs...",value:v,onChange:e=>y(e.target.value),className:"search-input"})}),A.jsxs("div",{className:"control-buttons",children:[A.jsx("button",{className:"multi-select-btn "+(p?"active":""),onClick:()=>{f(!p),h(new Set)},children:p?"✓ Multi-Select":"Multi-Select"}),p&&m.size>0&&A.jsxs("button",{className:"bulk-btn unpack-btn",onClick:()=>{0!==m.size&&g(!0)},children:["📦 Unpack (",m.size,")"]})]})]}),r&&A.jsxs("div",{className:"loading-container",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading your packs..."})]}),!r&&A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"inventory-page-stats",children:A.jsxs("p",{children:[W," packs found"]})}),n.length>0?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"inventory-page-grid",children:L.map(t=>A.jsxs("div",{className:"nft-card "+(p&&m.has(t.asset_id)?"selected":""),onClick:()=>(e=>{if(p){const t=new Set(m);t.has(e.asset_id)?t.delete(e.asset_id):t.add(e.asset_id),h(t)}else o(e),u(!0)})(t),children:[p&&A.jsx("div",{className:"selection-checkbox",children:A.jsx("input",{type:"checkbox",checked:m.has(t.asset_id),onChange:()=>{}})}),A.jsxs("div",{className:"nft-image-container",children:[A.jsx(Fe,{imageUrl:Ve({img:t.img}),videoUrl:t.video?Ge({video:t.video}):void 0,alt:t.name,className:"w-full h-full object-cover",controls:e.showVideoControls,autoPlay:e.autoPlayVideos,muted:e.muteVideos}),A.jsx("div",{className:"pack-indicator",children:"📦 Pack"})]}),A.jsxs("div",{className:"nft-info",children:[A.jsx("h3",{className:"nft-name",children:t.name}),A.jsx("p",{className:"nft-collection",children:"string"==typeof t.collection?t.collection:t.collection?.collection_name||t.collection?.name||"Unknown"}),A.jsx("p",{className:"nft-schema",children:t.schema.schema_name}),t.mint_number&&A.jsxs("p",{className:"nft-mint",children:["Mint #",t.mint_number]})]})]},t.asset_id))}),k&&A.jsx("div",{className:"load-more-container",children:A.jsx("button",{className:"load-more-btn",onClick:()=>{k&&F(S+1,!0)},children:"Load More Packs"})}),M>1&&A.jsxs("div",{className:"pagination-container",children:[A.jsxs("div",{className:"pagination",children:[A.jsx("button",{className:"pagination-btn",onClick:()=>O(N-1),disabled:1===N,children:"Previous"}),Array.from({length:Math.min(5,M)},(e,t)=>{const a=t+1;return A.jsx("button",{className:"pagination-btn "+(N===a?"active":""),onClick:()=>O(a),children:a},a)}),A.jsx("button",{className:"pagination-btn",onClick:()=>O(N+1),disabled:N===M,children:"Next"})]}),A.jsxs("div",{className:"pagination-info",children:["Page ",N," of ",M]})]})]}):A.jsxs("div",{className:"empty-state",children:[A.jsx("div",{className:"empty-icon",children:"📦"}),A.jsx("h3",{children:"No Packs Found"}),A.jsx("p",{children:"You don't have any pack NFTs in your inventory yet."}),A.jsx("p",{children:"Packs, chests, boxes, and containers will appear here when you acquire them."})]})]}),c&&A.jsx(et,{nft:{asset_id:c.asset_id,name:c.name,image:c.img,collection:c.collection.collection_name,schema:c.schema.schema_name,template_mint:c.mint_number,traits:c.data,price:null,sale_id:null,seller:null},isOpen:d,onClose:()=>{u(!1),o(null)}}),A.jsx(wt,{selectedNFTs:n.filter(e=>m.has(e.asset_id)),isOpen:x,onClose:()=>{g(!1)},userAccount:P||"",walletSession:I,onUnpackComplete:()=>{h(new Set),f(!1),F(1,!1),t("Packs unpacked successfully!")}})]}):A.jsxs("div",{className:"page-content",children:[A.jsxs("div",{className:"page-header",children:[A.jsx("h1",{children:"Pack Inventory"}),A.jsx("p",{children:"Manage and unpack your NFT packs"})]}),A.jsx("div",{className:"connect-wallet-prompt",children:A.jsxs("div",{className:"connect-card",children:[A.jsx("h3",{children:"Connect Your Wallet"}),A.jsx("p",{children:"Connect your WAX wallet to view your pack inventory"}),A.jsx("button",{className:"connect-btn",onClick:T,children:"Connect Wallet"})]})})]})},ma=()=>{const[e,t]=a.useState([]),[s,n]=a.useState(!0),[i,r]=a.useState({}),[l,c]=a.useState(null),[o,d]=a.useState(""),[u,m]=a.useState("below");a.useEffect(()=>{h()},[]),a.useEffect(()=>{e.length>0&&(async()=>{const t={};for(const a of e)a.nft.price&&(t[a.nft.asset_id]=await ie.convertWaxToUSDAsync(a.nft.price));r(t)})()},[e]);const h=async()=>{try{n(!0);const e=await Te.getWatchlist();t(e)}catch(e){K("Error loading watchlist","Watchlist",e)}finally{n(!1)}},p=e=>e?e>0?"↗":"↘":"";return s?A.jsx("div",{className:"watchlist-container",children:A.jsxs("div",{className:"watchlist-loading",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading your watchlist..."})]})}):A.jsxs("div",{className:"watchlist-container",children:[A.jsxs("div",{className:"watchlist-header",children:[A.jsx("h1",{children:"My Watchlist"}),A.jsx("p",{className:"watchlist-subtitle",children:"Track your favorite NFTs and get notified when prices change"})]}),0===e.length?A.jsxs("div",{className:"watchlist-empty",children:[A.jsx("div",{className:"empty-icon",children:"👁️"}),A.jsx("h3",{children:"Your watchlist is empty"}),A.jsx("p",{children:"Add NFTs to your watchlist from the marketplace to track their prices"}),A.jsx("a",{href:"/marketplace",className:"btn-primary",children:"Browse Marketplace"})]}):A.jsx("div",{className:"watchlist-grid",children:e.map(e=>{return A.jsxs("div",{className:"watchlist-card",children:[A.jsxs("div",{className:"watchlist-card-image",children:[A.jsx("img",{src:e.nft.image,alt:e.nft.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}}),e.targetPrice&&A.jsx("div",{className:"alert-badge",children:A.jsx("span",{className:"alert-icon",children:"🔔"})})]}),A.jsxs("div",{className:"watchlist-card-content",children:[A.jsx("h3",{className:"nft-name",children:e.nft.name}),A.jsx("p",{className:"nft-collection",children:e.nft.collection}),A.jsxs("div",{className:"price-info",children:[A.jsxs("div",{className:"current-price",children:[A.jsx("span",{className:"price-label",children:"Current Price:"}),A.jsxs("div",{className:"price-values",children:[A.jsxs("span",{className:"wax-price",children:[e.nft.price," WAX"]}),i[e.nft.asset_id]&&A.jsxs("span",{className:"usd-price",children:["$",i[e.nft.asset_id]]})]})]}),void 0!==e.priceChange&&A.jsxs("div",{className:"price-change",style:{color:(a=e.priceChange,a?a>0?"var(--success-color)":"var(--error-color)":"var(--text-secondary)")},children:[A.jsx("span",{className:"change-icon",children:p(e.priceChange)}),A.jsxs("span",{children:[Math.abs(e.priceChange).toFixed(2),"%"]})]})]}),e.targetPrice&&A.jsxs("div",{className:"price-alert-info",children:[A.jsxs("span",{className:"alert-label",children:["Alert when price is ",e.alertType,":"]}),A.jsxs("span",{className:"alert-price",children:[e.targetPrice," WAX"]})]}),A.jsxs("div",{className:"watchlist-actions",children:[e.targetPrice?A.jsx("button",{className:"btn-secondary btn-sm",onClick:()=>(async e=>{try{await Te.removePriceAlert(e),t(t=>t.map(t=>t.nft.asset_id===e?{...t,targetPrice:void 0,alertType:"any"}:t))}catch(a){K("Error removing price alert","Watchlist",a)}})(e.nft.asset_id),children:"Remove Alert"}):A.jsx("button",{className:"btn-primary btn-sm",onClick:()=>c(e.nft.asset_id),children:"Add Price Alert"}),A.jsx("button",{className:"btn-danger btn-sm",onClick:()=>(async e=>{try{await Te.removeFromWatchlist(e),t(t=>t.filter(t=>t.nft.asset_id!==e))}catch(a){K("Error removing from watchlist","Watchlist",a)}})(e.nft.asset_id),children:"Remove"})]})]}),l===e.nft.asset_id&&A.jsxs("div",{className:"price-alert-form",children:[A.jsx("h4",{children:"Set Price Alert"}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Alert Type:"}),A.jsxs("select",{value:u,onChange:e=>m(e.target.value),children:[A.jsx("option",{value:"below",children:"Price drops below"}),A.jsx("option",{value:"above",children:"Price rises above"}),A.jsx("option",{value:"any",children:"Any price change"})]})]}),"any"!==u&&A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Target Price (WAX):"}),A.jsx("input",{type:"number",step:"0.01",value:o,onChange:e=>d(e.target.value),placeholder:"Enter price in WAX"})]}),A.jsxs("div",{className:"form-actions",children:[A.jsx("button",{className:"btn-primary btn-sm",onClick:()=>(async e=>{if(o)try{await Te.setPriceAlert(e,{targetPrice:parseFloat(o),alertType:u,enabled:!0}),t(t=>t.map(t=>t.nft.asset_id===e?{...t,targetPrice:parseFloat(o),alertType:u}:t)),c(null),d("")}catch(a){K("Error adding price alert","Watchlist",a)}})(e.nft.asset_id),disabled:"any"!==u&&!o,children:"Set Alert"}),A.jsx("button",{className:"btn-secondary btn-sm",onClick:()=>c(null),children:"Cancel"})]})]})]},e.nft.asset_id);var a})})]})},ha=()=>{const e=[{title:"Pixel Journey",url:"https://pixeljourney.xyz",icon:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("path",{d:"M8 14s1.5 2 4 2 4-2 4-2"}),A.jsx("line",{x1:"9",y1:"9",x2:"9.01",y2:"9"}),A.jsx("line",{x1:"15",y1:"9",x2:"15.01",y2:"9"})]})},{title:"Documentation",url:"https://docs.pixeljourney.xyz",icon:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),A.jsx("polyline",{points:"14,2 14,8 20,8"}),A.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),A.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),A.jsx("polyline",{points:"10,9 9,9 8,9"})]})},{title:"Discord",url:"http://discord.gg/pixel-journey-1130670500776005734",icon:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0 12.64 12.64 0 0 0-.617-1.25.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057 19.9 19.9 0 0 0 5.993 3.03.078.078 0 0 0 .084-.028c.462-.63.874-1.295 1.226-1.994a.076.076 0 0 0-.041-.106 13.107 13.107 0 0 1-1.872-.892.077.077 0 0 1-.008-.128 10.2 10.2 0 0 0 .372-.292.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127 12.299 12.299 0 0 1-1.873.892.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028 19.839 19.839 0 0 0 6.002-3.03.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.061.061 0 0 0-.031-.03zM8.02 15.33c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.956-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.956 2.418-2.157 2.418zm7.975 0c-1.183 0-2.157-1.085-2.157-2.419 0-1.333.955-2.419 2.157-2.419 1.21 0 2.176 1.096 2.157 2.42 0 1.333-.946 2.418-2.157 2.418z"})})},{title:"Twitter/X",url:"https://x.com/PXJourney",icon:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"})})}];return A.jsx("footer",{className:"footer",children:A.jsxs("div",{className:"footer-container",children:[A.jsxs("div",{className:"footer-content",children:[A.jsxs("div",{className:"footer-brand",children:[A.jsxs("a",{href:"https://pixeljourney.xyz",className:"footer-logo",target:"_blank",rel:"noopener noreferrer",children:[A.jsx("img",{src:"https://pixeljourney.xyz/img/logo.png",alt:"Pixel Journey",className:"footer-logo-image"}),A.jsx("span",{className:"footer-logo-text",children:"Pixel Journey"})]}),A.jsx("p",{className:"footer-description",children:"Explore the Pixel Journey ecosystem - a comprehensive NFT marketplace and gaming platform across multiple blockchains."})]}),A.jsxs("div",{className:"footer-section footer-center",children:[A.jsx("h3",{className:"footer-section-title",children:"PXJourney across Web3"}),A.jsxs("div",{className:"blockchain-grid",children:[A.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-eth",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[A.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/ethereum.svg",alt:"Ethereum",className:"blockchain-logo"}),A.jsx("span",{className:"blockchain-name",children:"Ethereum"})]}),A.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-polygon",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[A.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/polygon.jpeg",alt:"Polygon",className:"blockchain-logo"}),A.jsx("span",{className:"blockchain-name",children:"Polygon"})]}),A.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-base",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[A.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/base.jpg",alt:"Base",className:"blockchain-logo"}),A.jsx("span",{className:"blockchain-name",children:"Base"})]}),A.jsxs("a",{href:"https://nft.monbase.com/collections/66c4eb2ca339b05c5a660e44/detail",target:"_blank",rel:"noopener noreferrer",className:"blockchain-item",children:[A.jsx("img",{src:"https://pixeljourney.xyz/img/blockchain-icons/BSC.png",alt:"BNB Chain",className:"blockchain-logo"}),A.jsx("span",{className:"blockchain-name",children:"BNB Chain"})]})]}),A.jsx("div",{className:"bridge-section",children:A.jsx("a",{href:"https://bridge.mycloudwallet.com/",target:"_blank",rel:"noopener noreferrer",className:"bridge-link",children:"Bridge Now"})})]}),A.jsxs("div",{className:"footer-section footer-wax",children:[A.jsx("h3",{className:"footer-section-title",children:A.jsx("a",{href:"https://wax.io/",target:"_blank",rel:"noopener noreferrer",className:"wax-title-link",children:"PXJourney across WAX"})}),A.jsxs("div",{className:"wax-dapps-grid",children:[A.jsxs("a",{href:"https://market.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item purple-glow",children:[A.jsx("span",{className:"dapp-icon",children:"🛍️"}),A.jsx("span",{className:"dapp-name",children:"PxMarket"})]}),A.jsxs("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item green-glow",children:[A.jsx("span",{className:"dapp-icon",children:"🧑‍🌾"}),A.jsx("span",{className:"dapp-name",children:"PxStaking"})]}),A.jsxs("a",{href:"https://lb.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"wax-dapp-item golden-glow",children:[A.jsx("span",{className:"dapp-icon",children:"🏆"}),A.jsx("span",{className:"dapp-name",children:"PxLeaderboards"})]}),A.jsxs("a",{href:"/pxcrafting",className:"wax-dapp-item craft-glow",children:[A.jsx("span",{className:"dapp-icon",children:"♻️"}),A.jsx("span",{className:"dapp-name",children:"PxCraft"})]})]}),A.jsx("div",{className:"journey-section",children:A.jsx("a",{href:"/journeymap",className:"journey-link",children:"Journey Map"})})]}),A.jsxs("div",{className:"footer-section footer-right",children:[A.jsx("h4",{className:"footer-title",children:"Quick Links"}),A.jsx("div",{className:"footer-links",children:e.map((e,t)=>A.jsxs("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"footer-link",children:[A.jsx("span",{className:"footer-link-icon",children:e.icon}),e.title]},t))})]})]}),A.jsx("div",{className:"footer-bottom",children:A.jsxs("div",{className:"footer-bottom-content",children:[A.jsx("p",{className:"footer-copyright",children:"© 2025 Pixel Journey. All rights reserved."}),A.jsx("div",{className:"footer-bottom-links",children:A.jsx("span",{className:"footer-note",children:"Requires a Pixal PFP to unlock full market access"})})]})})]})})},pa=s.memo(()=>{const e=i(),{settings:t}=ue(),[s,n]=a.useState("activity"),[r,l]=a.useState([]),[c,o]=a.useState([]),[d,u]=a.useState(null),[m,h]=a.useState(null),[p,f]=a.useState([]),[x,g]=a.useState([]),[v,y]=a.useState(!1),[j,b]=a.useState(null),[N,w]=a.useState(!1),k=async()=>{try{y(!0),b(null);const e=await ye.getRecentSales(50);l(e.map(e=>{const t=e.assets[0];return{sale_id:e.sale_id,asset_id:t?.asset_id||"",collection_name:t?.collection?.collection_name||"",schema_name:t?.schema?.schema_name||"",template_id:t?.template?.template_id||"",asset_name:t?.name||"",seller:e.seller||"",buyer:e.buyer||"",price:e.listing_price||"0",updated_at_time:e.updated_at_time||"",state:e.state||0,image:t?.data?.img||void 0,video:t?.data?.video||void 0}}))}catch(e){console.error("Error loading activity data:",e),b("Failed to load activity data")}finally{y(!1)}},_=async()=>{try{y(!0),b(null);const e=await ye.getCollections({limit:20,whitelistOnly:!0});if(e.length>0){const t=e.slice(0,10).map(async e=>{try{const t=await ye.getCollectionStats(e.collection_name);return{collection_name:e.collection_name,assets:"0",burned:"0",templates:"0",schemas:"0",volume:t?.volume||"0",sales:t?.sales||"0",floor_price:t?.floor||"0"}}catch{return{collection_name:e.collection_name,assets:"0",burned:"0",templates:"0",schemas:"0",volume:"0",sales:"0",floor_price:"0"}}}),a=await Promise.all(t);o(a)}const t=await ye.getMarketStats();if(t&&t.results&&t.results.length>0){const e=t.results[t.results.length-1];u({total_sales:e.sales||"0",total_volume:e.volume||"0",total_assets:"0",active_listings:"0"})}const[a,s,n]=await Promise.all([ye.getNFTTradingStats(),ye.getTopCollectionsByVolume(10),ye.getRecentNFTTrades(20)]);a&&h({dailyVolume:a.dailyVolume||"0",dailySales:a.dailySales||0,totalTransactions:a.totalTransactions||0,activeListings:a.activeListings||0,averagePrice:a.averagePrice||"0",topCollectionsByVolume:s.map(e=>({collection_name:e.collection_name,volume_24h:"0",sales_24h:0,floor_price:"0",assets_count:"0"}))}),g(s.map(e=>({collection_name:e.collection_name,volume_24h:"0",sales_24h:0,floor_price:"0",assets_count:"0"}))||[]),f((n||[]).map(e=>({sale_id:e.sale_id,collection_name:e.collection_name||"",asset_name:String(e.assets?.[0]?.data?.name||e.assets?.[0]?.template?.immutable_data?.name||"Unknown Asset"),price:String(e.listing_price||e.price?.amount||"0"),buyer:e.buyer||"",seller:e.seller||"",timestamp:e.updated_at_time||""})))}catch(e){console.error("Error loading stats data:",e),b("Failed to load statistics data")}finally{y(!1)}},S=a.useCallback(async()=>{w(!0),"activity"===s?await k():await _(),w(!1)},[s]),C=a.useCallback(t=>{e(`/user-profile-lookup?user=${encodeURIComponent(t)}`)},[e]),E=a.useCallback(t=>{e(`/assets/${t}`)},[e]),P=a.useCallback(t=>{e(`/collections/${encodeURIComponent(t)}`)},[e]),T=a.useCallback(t=>{e(`/listings/${t}`)},[e]),I=a.useCallback(t=>{e(`/listings/${t}`)},[e]);a.useEffect(()=>{"activity"===s?k():_()},[s]);const F=e=>{if("string"==typeof e&&e.includes("WAX"))return e;const t=parseFloat(e)/1e8;return D(t)},$=e=>{const t=parseInt(e);return t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString()},L=e=>new Date(1e3*parseInt(e)).toLocaleString();return A.jsxs("div",{className:"activity-stats-page",children:[A.jsxs("div",{className:"activity-stats-header",children:[A.jsx("h1",{className:"activity-stats-title",children:"Market Activity & Statistics"}),A.jsx("p",{className:"activity-stats-subtitle",children:"Real-time marketplace data and analytics"})]}),A.jsxs("div",{className:"activity-stats-tabs",children:[A.jsxs("button",{className:"tab-btn "+("activity"===s?"active":""),onClick:()=>n("activity"),children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M3 3v18h18"}),A.jsx("path",{d:"M7 12l4-4 4 4 6-6"})]}),"Activity Feed"]}),A.jsxs("button",{className:"tab-btn "+("stats"===s?"active":""),onClick:()=>n("stats"),children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),A.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),A.jsx("line",{x1:"15",y1:"11",x2:"15",y2:"15"})]}),"Statistics"]}),A.jsxs("button",{className:"refresh-btn "+(N?"refreshing":""),onClick:S,disabled:N,children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("polyline",{points:"23 4 23 10 17 10"}),A.jsx("polyline",{points:"1 20 1 14 7 14"}),A.jsx("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})]}),N?"Refreshing...":"Refresh"]})]}),j&&A.jsxs("div",{className:"error-message",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),A.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),j]}),"activity"===s&&A.jsxs("div",{className:"activity-content",children:[A.jsxs("div",{className:"section-header",children:[A.jsx("h2",{children:"Recent Sales"}),A.jsx("p",{children:"Latest NFT sales across all collections"})]}),v?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading recent sales..."})]}):A.jsxs("div",{className:"sales-feed",children:[r.map(e=>A.jsxs("div",{className:"sale-item clickable-sale",onClick:()=>T(e.sale_id),children:[A.jsx("div",{className:"sale-media",children:A.jsx(Fe,{imageUrl:e.image,videoUrl:e.video,alt:e.asset_name||`Asset #${e.asset_id}`,className:"sale-image",enableAnimations:t.enableAnimatedNFTs})}),A.jsxs("div",{className:"sale-info",children:[A.jsxs("div",{className:"sale-asset",children:[A.jsx("h4",{className:"clickable-asset-name",onClick:t=>{t.stopPropagation(),E(e.asset_id)},children:e.asset_name||`Asset #${e.asset_id}`}),A.jsx("p",{className:"sale-collection clickable-collection",onClick:t=>{t.stopPropagation(),P(e.collection_name)},children:e.collection_name})]}),A.jsxs("div",{className:"sale-details",children:[A.jsx("div",{className:"sale-price",children:F(e.price)}),A.jsx("div",{className:"sale-time",children:L(e.updated_at_time)}),A.jsx("div",{className:"sale-status",children:3===e.state?A.jsx("span",{className:"status-sold",children:"✅ Sold"}):2===e.state?A.jsx("span",{className:"status-canceled",children:"❌ Canceled"}):(e.state,A.jsx("span",{className:"status-active",children:"🔄 Active"}))})]})]}),A.jsxs("div",{className:"sale-parties",children:[A.jsxs("div",{className:"sale-party",children:[A.jsx("span",{className:"party-label",children:"Seller:"}),A.jsx("span",{className:"party-name clickable",onClick:t=>{t.stopPropagation(),C(e.seller)},children:e.seller})]}),A.jsxs("div",{className:"sale-party",children:[A.jsx("span",{className:"party-label",children:"Buyer:"}),A.jsx("span",{className:"party-name clickable",onClick:t=>{t.stopPropagation(),C(e.buyer)},children:e.buyer})]}),A.jsxs("div",{className:"sale-party",children:[A.jsx("span",{className:"party-label",children:"Sale ID:"}),A.jsxs("span",{className:"sale-id-link clickable",onClick:t=>{t.stopPropagation(),T(e.sale_id)},title:"View sale details",children:[e.sale_id.slice(0,8),"..."]})]})]})]},e.sale_id)),0===r.length&&!v&&A.jsxs("div",{className:"empty-state",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("path",{d:"M12 6v6l4 2"})]}),A.jsx("h3",{children:"No recent sales"}),A.jsx("p",{children:"No sales data available at the moment"})]})]})]}),"stats"===s&&A.jsxs("div",{className:"stats-content",children:[d&&A.jsxs("div",{className:"market-overview",children:[A.jsx("h2",{children:"Market Overview"}),A.jsxs("div",{className:"stats-grid",children:[A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:$(d.total_sales)}),A.jsx("div",{className:"stat-label",children:"Total Sales"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:F(d.total_volume)}),A.jsx("div",{className:"stat-label",children:"Total Volume"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:$(d.total_assets)}),A.jsx("div",{className:"stat-label",children:"Total Assets"})]}),A.jsxs("div",{className:"stat-card",children:[A.jsx("div",{className:"stat-value",children:$(d.active_listings)}),A.jsx("div",{className:"stat-label",children:"Active Listings"})]})]})]}),m&&A.jsxs("div",{className:"nft-trading-stats-section",children:[A.jsx("h2",{children:"WAX NFT Trading Data"}),A.jsxs("div",{className:"nft-stats-grid",children:[A.jsxs("div",{className:"stat-card nft-card",children:[A.jsxs("div",{className:"stat-value",children:[m.dailyVolume," WAX"]}),A.jsx("div",{className:"stat-label",children:"24h Trading Volume"})]}),A.jsxs("div",{className:"stat-card nft-card",children:[A.jsx("div",{className:"stat-value",children:$(m.dailySales.toString())}),A.jsx("div",{className:"stat-label",children:"24h Sales"})]}),A.jsxs("div",{className:"stat-card nft-card",children:[A.jsx("div",{className:"stat-value",children:$(m.activeListings.toString())}),A.jsx("div",{className:"stat-label",children:"Active Listings"})]}),A.jsxs("div",{className:"stat-card nft-card",children:[A.jsxs("div",{className:"stat-value",children:[m.averagePrice," WAX"]}),A.jsx("div",{className:"stat-label",children:"Average Sale Price"})]})]}),x.length>0&&A.jsxs("div",{className:"top-collections-section",children:[A.jsx("h3",{children:"Top Collections by Volume"}),A.jsx("div",{className:"top-collections-grid",children:x.slice(0,6).map(e=>A.jsxs("div",{className:"collection-card",children:[A.jsx("div",{className:"collection-name",children:e.collection_name}),A.jsxs("div",{className:"collection-volume",children:[e.volume_24h," WAX"]}),A.jsxs("div",{className:"collection-sales",children:[e.sales_24h," sales"]}),A.jsxs("div",{className:"collection-floor",children:["Floor: ",e.floor_price," WAX"]})]},e.collection_name))})]}),p.length>0&&A.jsxs("div",{className:"recent-trades-section",children:[A.jsx("h3",{children:"Recent NFT Trades"}),A.jsx("div",{className:"recent-trades-list",children:p.slice(0,8).map(e=>A.jsxs("div",{className:"trade-item clickable-trade",onClick:()=>I(e.sale_id),children:[A.jsxs("div",{className:"trade-asset",children:[A.jsx("span",{className:"asset-name clickable-asset-name",onClick:t=>{t.stopPropagation(),I(e.sale_id)},children:e.asset_name}),A.jsx("span",{className:"collection-name clickable-collection",onClick:t=>{t.stopPropagation(),P(e.collection_name)},children:e.collection_name})]}),A.jsxs("div",{className:"trade-price",children:[e.price," WAX"]}),A.jsx("div",{className:"trade-time",children:L(e.timestamp)})]},e.sale_id))})]})]}),A.jsxs("div",{className:"section-header",children:[A.jsx("h2",{children:"Collection Statistics"}),A.jsx("p",{children:"Performance metrics for top collections"})]}),v?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading collection statistics..."})]}):A.jsxs("div",{className:"collections-table",children:[A.jsxs("div",{className:"table-header",children:[A.jsx("div",{className:"table-cell",children:"Collection"}),A.jsx("div",{className:"table-cell",children:"Assets"}),A.jsx("div",{className:"table-cell",children:"Volume"}),A.jsx("div",{className:"table-cell",children:"Sales"}),A.jsx("div",{className:"table-cell",children:"Floor Price"})]}),c.map(e=>A.jsxs("div",{className:"table-row",children:[A.jsx("div",{className:"table-cell collection-name",children:e.collection_name}),A.jsx("div",{className:"table-cell",children:$(e.assets)}),A.jsx("div",{className:"table-cell",children:F(e.volume)}),A.jsx("div",{className:"table-cell",children:$(e.sales)}),A.jsx("div",{className:"table-cell",children:F(e.floor_price)})]},e.collection_name)),0===c.length&&!v&&A.jsxs("div",{className:"empty-state",children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),A.jsx("line",{x1:"9",y1:"9",x2:"9",y2:"15"}),A.jsx("line",{x1:"15",y1:"11",x2:"15",y2:"15"})]}),A.jsx("h3",{children:"No statistics available"}),A.jsx("p",{children:"Statistics data is currently unavailable"})]})]})]})]})});pa.displayName="ActivityStats";const fa=new class{subscriptions=new Map;pollInterval=null;isPolling=!1;POLL_INTERVAL=3e4;MAX_REQUESTS_PER_MINUTE=30;REQUEST_DELAY=2e3;lastRequestTime=0;requestCount=0;requestResetTime=Date.now()+6e4;auctionCache=new Map;CACHE_DURATION=15e3;subscribe(e,t){this.subscriptions.has(e)||this.subscriptions.set(e,[]);const a={auction_id:e,callback:t};return this.subscriptions.get(e).push(a),this.startPolling(),()=>{const t=this.subscriptions.get(e);if(t){const s=t.indexOf(a);s>-1&&t.splice(s,1),0===t.length&&this.subscriptions.delete(e)}0===this.subscriptions.size&&this.stopPolling()}}startPolling(){this.isPolling||(this.isPolling=!0,this.pollInterval=setInterval(()=>{this.pollAuctionUpdates()},this.POLL_INTERVAL))}stopPolling(){this.pollInterval&&(clearInterval(this.pollInterval),this.pollInterval=null),this.isPolling=!1}async pollAuctionUpdates(){const e=Array.from(this.subscriptions.keys());if(0!==e.length)try{this.clearExpiredCache();(await this.fetchAuctionUpdates(e)).forEach(e=>{const t=this.subscriptions.get(e.auction_id);t&&t.forEach(t=>{try{t.callback(e)}catch(a){W.logError("AuctionService.pollAuctionUpdates.callback",a,{auctionId:e.auction_id})}})})}catch(t){W.logError("AuctionService.pollAuctionUpdates",t,{auctionIds:e})}else this.stopPolling()}async fetchAuctionUpdates(e){const t=[],a=Date.now();a>this.requestResetTime&&(this.requestCount=0,this.requestResetTime=a+6e4);for(const n of e){const e=this.auctionCache.get(n);if(e&&a-e.timestamp<this.CACHE_DURATION){t.push(e.data);continue}if(this.requestCount>=this.MAX_REQUESTS_PER_MINUTE){q.warn("Rate limit reached, skipping auction","AUCTION",{auctionId:n}),e&&t.push(e.data);continue}const i=a-this.lastRequestTime;i<this.REQUEST_DELAY&&await new Promise(e=>setTimeout(e,this.REQUEST_DELAY-i));try{const e=`${ye.getCurrentAtomicEndpoint()}/atomicmarket/v1/auctions/${n}`,a=await ye.fetchWithRetry(e),s=await a.json();if(this.requestCount++,this.lastRequestTime=Date.now(),s.success&&s.data){const e=s.data,a={auction_id:n,current_bid:e.current_bid,bidder:e.current_bidder,end_time:e.end_time,status:this.getAuctionStatus(e),bid_count:e.bid_count||0,last_bid_time:e.updated_at_time};this.auctionCache.set(n,{data:a,timestamp:Date.now()}),t.push(a)}}catch(s){W.logError("AuctionService.fetchAuctionUpdates.single",s,{auctionId:n}),e&&t.push(e.data)}}return t}getAuctionStatus(e){const t=Date.now(),a=new Date(e.end_time+"Z").getTime();return 3===e.state?"cancelled":t>a?"ended":"active"}async getAuctionBids(e){try{const t=await ye.getAuctions({limit:1});if(!t.success||!t.data.length)return[];const a=t.data[0].assets.map(e=>e.asset_id);return(await this.fetchAuctionBidHistory(e,a)).sort((e,t)=>new Date(t.timestamp).getTime()-new Date(e.timestamp).getTime())}catch(t){return W.logError("AuctionService.getAuctionBids",t,{auctionId:e}),[]}}async fetchAuctionBidHistory(e,t){try{const t=[te.WAX_CHAIN.EOSRIO,te.WAX_CHAIN.WAXSWEDEN,te.HYPERION[2]];for(const s of t)try{const t=await fetch(`${s}/v2/history/get_actions?account=atomicmarket&filter=atomicmarket:auctionbid&limit=100&sort=desc&after=${new Date(Date.now()-6048e5).toISOString()}`,{method:"GET",headers:{Accept:"application/json"}});if(!t.ok)continue;const a=await t.json(),n=[];if(a.actions)for(const s of a.actions)s.act?.data?.auction_id===e&&n.push({bidder:s.act.data.bidder||s.act.authorization?.[0]?.actor||"unknown",bid_amount:s.act.data.bid||"0.0000 WAX",timestamp:s.timestamp,transaction_id:s.trx_id});return n}catch(a){q.warn("Failed to fetch from endpoint","AUCTION",{endpoint:s,error:a});continue}return[]}catch(s){return W.logError("AuctionService.fetchAuctionBidHistory",s,{auctionId:e,assetIds:t}),[]}}getTimeRemaining(e){const t=Date.now();let a;if(!e)return{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};if(e.includes("T")&&!e.endsWith("Z"))a=new Date(e+"Z").getTime();else if(e.includes("T")&&e.endsWith("Z"))a=new Date(e).getTime();else{const t=parseInt(e);a=isNaN(t)?new Date(e).getTime():t>1e12?t:1e3*t}if(isNaN(a))return q.warn("Invalid endTime format","AUCTION",{endTime:e}),{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};const s=a-t;if(s<=0)return{total:0,days:0,hours:0,minutes:0,seconds:0,isExpired:!0};return{total:s,days:Math.floor(s/864e5),hours:Math.floor(s%864e5/36e5),minutes:Math.floor(s%36e5/6e4),seconds:Math.floor(s%6e4/1e3),isExpired:!1}}formatTimeRemaining(e){const t=this.getTimeRemaining(e);return t.isExpired?"Auction ended":t.days>0?`${t.days}d ${t.hours}h ${t.minutes}m`:t.hours>0?`${t.hours}h ${t.minutes}m ${t.seconds}s`:t.minutes>0?`${t.minutes}m ${t.seconds}s`:`${t.seconds}s`}isEndingSoon(e){const t=this.getTimeRemaining(e);return!t.isExpired&&t.total<3e5}clearExpiredCache(){const e=Date.now();for(const[t,a]of this.auctionCache.entries())e-a.timestamp>2*this.CACHE_DURATION&&this.auctionCache.delete(t)}cleanup(){this.subscriptions.clear(),this.stopPolling(),this.auctionCache.clear()}},xa=()=>{const e=i(),{isConnected:t,account:s,session:n}=_t(),{showSuccess:r,showError:l}=_e(),[c,o]=a.useState([]),[d,u]=a.useState(!0),[m,h]=a.useState(!1),[p,f]=a.useState(null),[x,g]=a.useState(1),[v,y]=a.useState(!0),[j,b]=a.useState(1),[N,w]=a.useState("all"),[k,_]=a.useState("created_desc"),[S,C]=a.useState(""),[E,P]=a.useState(""),[T,I]=a.useState(!1),[F,$]=a.useState(!1),[L,M]=a.useState(!1),[R,W]=a.useState(null),[O,B]=a.useState(""),[U,z]=a.useState(!1),[X,H]=a.useState(!1),[q,J]=a.useState(new Set),[V,G]=a.useState([]),[Y,Q]=a.useState(!1),[Z,ee]=a.useState(""),[te,ae]=a.useState(0),[se,ne]=a.useState(1),[ie,re]=a.useState(0),[le,ce]=a.useState(0),[oe,de]=a.useState(""),[ue,me]=a.useState([]),he=a.useCallback(()=>{switch(k){case"price_asc":case"price_desc":return"price";default:return"created"}},[k]),pe=a.useCallback(()=>{switch(k){case"price_asc":case"created_asc":return"asc";default:return"desc"}},[k]),fe=a.useCallback(async(e=1,t=!1)=>{try{1===e?(u(!0),g(1),y(!0)):h(!0),f(null);const a=await ye.getAuctions({state:1,limit:36,offset:36*(e-1),sort:he(),order:pe(),hide_empty_auctions:T,search:S||void 0,collection_name:E||void 0,collection_blacklist:"flinttffunko,onlyfanzgaly,farmerpetsco,fantaspeop",seller_blacklist:"dximg.wam,xpvrs.wam,5rrrc.wam,nnmnmnmnn.gm",symbol:"WAX"});if(!a.success||!a.data)throw new Error("Failed to fetch auctions data");const s=a.data.map(e=>({auction_id:e.auction_id,asset_id:e.asset_id,seller:e.seller,price:e.price,end_time:e.end_time,collection_name:e.collection_name,template_id:e.template_id,asset_name:e.asset_name,image:e.image,current_bid:e.current_bid||null,bidder:e.bidder||null,collection_info:void 0}));o(t&&e>1?e=>[...e,...s]:s);const n=36,i=s.length===n;y(i),g(e),b(i?e+1:e)}catch(a){K("Error loading auctions","Auctions",a),f("Failed to load auctions. Please try again later.")}finally{u(!1),h(!1)}},[he,pe,T,S,E]),xe=a.useCallback(()=>{!m&&v&&fe(x+1,!0)},[fe,x,v,m]),ge=a.useCallback(()=>{g(1),y(!0),fe(1,!1)},[fe]);a.useEffect(()=>{ge()},[ge,N,S,E,T,k]),a.useEffect(()=>{(async()=>{try{const e=await ye.getCollections({limit:50,whitelistOnly:!0});if(e&&e.length>0){const t=e.map(e=>({collection_name:e.collection_name,name:e.name||e.collection_name}));me(t)}}catch(e){K("Failed to load collections","Auctions",e),me([{collection_name:"pixeljourney",name:"Pixel Journey"},{collection_name:"friedfactory",name:"Fried Factory"}])}})()},[]);const ve=e=>{const t=parseFloat(e)/1e8;return D(t)},je=a.useMemo(()=>c.filter(e=>{if(S){const t=S.toLowerCase();if(!(e.asset_name?.toLowerCase().includes(t)||e.asset_id?.toString().includes(t)||e.collection_name?.toLowerCase().includes(t)))return!1}return(!E||e.collection_name===E)&&!!(!T||e.bidder&&e.current_bid&&"0"!==e.current_bid)}),[c,S,E,T]);a.useEffect(()=>{const e=[];return je.forEach(t=>{const a=fa.subscribe(t.auction_id,e=>{o(t=>t.map(t=>t.auction_id===e.auction_id?{...t,current_bid:e.current_bid||t.current_bid,bidder:e.bidder||t.bidder,end_time:e.end_time}:t))});e.push(a)}),()=>{e.forEach(e=>e())}},[je]);const be=()=>7*te*24*60*60+24*se*60*60+60*ie*60+60*le,Ne=(e,t)=>{const a=Math.max(0,Math.min(t,we(e)));switch(e){case"weeks":ae(a);break;case"days":ne(a);break;case"hours":re(a);break;case"minutes":ce(a)}},we=e=>{switch(e){case"weeks":return 4;case"days":return 30;case"hours":return 23;case"minutes":return 59;default:return 0}};return A.jsxs("div",{className:"auctions-page",children:[A.jsx("div",{className:"page-header",children:A.jsxs("div",{className:"header-content",children:[A.jsxs("div",{className:"header-text",children:[A.jsx("h1",{children:"Auctions"}),A.jsx("p",{children:"Discover and bid on unique NFTs from the WAX ecosystem"})]}),A.jsx("button",{className:"create-auction-btn",onClick:()=>{$(!0),s&&(async()=>{if(s){Q(!0);try{const e=`${ye.atomicAssetsAPI}/atomicassets/v1/assets?owner=${s}&limit=100`,t=await ye.fetchWithRetry(e),a=await t.json();if(a.success&&a.data){const e=a.data.map(e=>({asset_id:e.asset_id,name:e.name||`${e.collection.collection_name} #${e.template_mint||e.asset_id}`,collection_name:e.collection.collection_name,image:e.data?.img?`https://ipfs.io/ipfs/${e.data.img}`:void 0,template_mint:e.template_mint,isSelected:!1}));G(e)}}catch(e){K("Error loading user assets","Auctions",e),G([])}finally{Q(!1)}}})()},children:"Create Auction"})]})}),A.jsxs("div",{className:"auctions-controls",children:[A.jsx("div",{className:"search-section",children:A.jsxs("div",{className:"search-input-wrapper",children:[A.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("input",{type:"text",placeholder:"Search auctions by name or asset ID...",value:S,onChange:e=>C(e.target.value),className:"search-input"})]})}),A.jsxs("div",{className:"filters-section",children:[A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{children:"Collection:"}),A.jsxs("select",{value:E,onChange:e=>P(e.target.value),className:"collection-filter",children:[A.jsx("option",{value:"",children:"All Collections"}),ue.map(e=>A.jsx("option",{value:e.collection_name,children:e.name},e.collection_name))]})]}),A.jsxs("div",{className:"filter-group",children:[A.jsx("label",{children:"Sort by:"}),A.jsxs("select",{value:k,onChange:e=>_(e.target.value),className:"sort-filter",children:[A.jsx("option",{value:"price_asc",children:"Price: Low to High"}),A.jsx("option",{value:"price_desc",children:"Price: High to Low"}),A.jsx("option",{value:"created_desc",children:"Newest First"}),A.jsx("option",{value:"created_asc",children:"Oldest First"})]})]}),A.jsx("div",{className:"filter-group",children:A.jsxs("label",{className:"checkbox-label",children:[A.jsx("input",{type:"checkbox",checked:T,onChange:e=>I(e.target.checked)}),A.jsx("span",{className:"checkmark"}),"Hide auctions without bids"]})})]}),A.jsxs("div",{className:"auctions-filters",children:[A.jsx("button",{className:"filter-btn "+("all"===N?"active":""),onClick:()=>w("all"),children:"All Auctions"}),A.jsx("button",{className:"filter-btn "+("ending-soon"===N?"active":""),onClick:()=>w("ending-soon"),children:"Ending Soon"}),A.jsx("button",{className:"filter-btn "+("new"===N?"active":""),onClick:()=>w("new"),children:"New Auctions"})]})]}),d&&A.jsxs("div",{className:"loading-container",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading auctions..."})]}),p&&A.jsxs("div",{className:"error-container",children:[A.jsx("p",{className:"error-message",children:p}),A.jsx("button",{onClick:()=>fe(),className:"retry-btn",children:"Try Again"})]}),!d&&!p&&0===je.length&&c.length>0&&A.jsxs("div",{className:"empty-state",children:[A.jsx("h3",{children:"No Matching Auctions"}),A.jsx("p",{children:"No auctions match your current filters. Try adjusting your search criteria."})]}),!d&&!p&&0===c.length&&A.jsxs("div",{className:"empty-state",children:[A.jsx("h3",{children:"No Active Auctions"}),A.jsx("p",{children:"There are currently no active auctions. Check back later!"})]}),!d&&!p&&je.length>0&&A.jsx("div",{className:"auctions-grid",children:je.map(a=>A.jsxs("div",{className:"auction-card clickable-card",onClick:()=>e(`/auctions/${a.auction_id}`),children:[A.jsxs("div",{className:"auction-image",children:[A.jsx(Fe,{imageUrl:a.image,videoUrl:a.video,alt:a.asset_name,className:"auction-media",enableAnimations:!0}),A.jsx("div",{className:"auction-timer",children:fa.formatTimeRemaining(a.end_time)})]}),A.jsxs("div",{className:"auction-info",children:[A.jsx("h3",{className:"auction-title",children:a.asset_name}),A.jsxs("div",{className:"auction-collection-info",children:[a.collection_info?.img&&A.jsx("img",{src:a.collection_info.img,alt:a.collection_info.name,className:"collection-avatar"}),A.jsxs("div",{className:"collection-details",children:[A.jsx("p",{className:"collection-name",children:a.collection_info?.name||a.collection_name}),a.collection_info?.description&&A.jsx("p",{className:"collection-description",children:a.collection_info.description.length>60?`${a.collection_info.description.substring(0,60)}...`:a.collection_info.description})]})]}),A.jsxs("div",{className:"seller-info",children:[A.jsx("span",{className:"label",children:"Seller: "}),A.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(a.seller)}`)},className:"seller-account",children:a.seller})]}),A.jsxs("div",{className:"auction-pricing",children:[A.jsxs("div",{className:"current-bid",children:[A.jsx("span",{className:"label",children:a.current_bid?"Current Bid:":"Starting Price:"}),A.jsx("span",{className:"price",children:a.current_bid?ve(a.current_bid):ve(a.price)})]}),a.bidder&&A.jsxs("div",{className:"bidder",children:[A.jsx("span",{className:"label",children:"Top Bidder:"}),A.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(a.bidder||"")}`)},className:"account",children:a.bidder})]})]}),A.jsxs("div",{className:"auction-actions",children:[A.jsx("button",{className:"bid-btn",onClick:e=>{e.stopPropagation(),(e=>{t&&s?e.seller!==s?(W(e),B(""),M(!0)):l("Invalid Action","You cannot bid on your own auction"):l("Wallet Required","Please connect your wallet to place bids")})(a)},disabled:!t||a.seller===s,children:t?a.seller===s?"Your Auction":"Place Bid":"Connect Wallet"}),A.jsx("button",{className:"view-btn",onClick:t=>{t.stopPropagation(),(t=>{e(`/assets/${t.asset_id}`)})(a)},children:"View Details"})]})]})]},a.auction_id))}),!d&&!p&&je.length>0&&A.jsxs("div",{className:"pagination-container",children:[v&&A.jsx("button",{className:"load-more-btn",onClick:xe,disabled:m,children:m?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"loading-spinner small"}),"Loading more..."]}):"Load More Auctions"}),A.jsxs("div",{className:"pagination-info",children:[A.jsxs("span",{children:["Page ",x," of ",j]}),A.jsxs("span",{children:[je.length," auctions loaded"]})]})]}),A.jsxs("div",{className:"coming-soon-notice",children:[A.jsx("h3",{children:"🚧 Integration in Progress"}),A.jsx("p",{children:"Full AtomicMarket auction integration is currently being implemented. This page will soon display live auction data and allow bidding functionality."})]}),L&&R&&A.jsx("div",{className:"modal-overlay",onClick:()=>M(!1),children:A.jsxs("div",{className:"bid-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"bid-modal-header",children:[A.jsx("h2",{children:"Place Your Bid"}),A.jsx("button",{className:"close-btn",onClick:()=>M(!1),children:"×"})]}),A.jsxs("div",{className:"bid-modal-body",children:[A.jsxs("div",{className:"bid-auction-summary",children:[A.jsxs("div",{className:"bid-asset-image",children:[A.jsx(Fe,{imageUrl:R.image,videoUrl:R.video,alt:R.asset_name,className:"bid-modal-media",enableAnimations:!0}),A.jsx("div",{className:"auction-timer-small",children:fa.formatTimeRemaining(R.end_time)})]}),A.jsxs("div",{className:"bid-asset-info",children:[A.jsx("h3",{children:R.asset_name}),A.jsxs("div",{className:"bid-collection-info",children:[R.collection_info?.img&&A.jsx("img",{src:R.collection_info.img,alt:R.collection_info.name,className:"collection-avatar-small"}),A.jsx("span",{className:"collection-name",children:R.collection_info?.name||R.collection_name})]}),A.jsxs("div",{className:"bid-current-info",children:[A.jsxs("div",{className:"current-bid-display",children:[A.jsx("span",{className:"label",children:R.current_bid?"Current Bid":"Starting Price"}),A.jsx("span",{className:"amount",children:ve(R.current_bid||R.price)})]}),R.bidder&&A.jsxs("div",{className:"current-bidder",children:[A.jsx("span",{className:"label",children:"Leading Bidder"}),A.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(R.bidder||"")}`)},className:"bidder-account",children:R.bidder})]})]})]})]}),A.jsx("div",{className:"bid-input-section",children:A.jsxs("div",{className:"bid-form-group",children:[A.jsx("label",{children:"Your Bid Amount"}),A.jsxs("div",{className:"bid-input-wrapper",children:[A.jsx("input",{type:"number",value:O,onChange:e=>B(e.target.value),placeholder:"0.0000",step:"0.0001",min:R.current_bid&&R.bidder?parseFloat(R.current_bid)/1e8+1e-4:parseFloat(R.price)/1e8,className:"bid-amount-input",disabled:U}),A.jsx("span",{className:"currency-label",children:"WAX"})]}),A.jsxs("div",{className:"bid-requirements",children:[A.jsx("p",{className:"minimum-bid",children:R.current_bid&&R.bidder?`Minimum: ${D(parseFloat(R.current_bid)/1e8+1e-4)}`:`Starting Price: ${D(parseFloat(R.price)/1e8)}`}),O&&A.jsxs("p",{className:"bid-total",children:["Total: ",D(parseFloat(O))]})]})]})}),A.jsxs("div",{className:"previous-bids-section",children:[A.jsx("h4",{children:"Bid History"}),A.jsx("div",{className:"bids-list",children:R.bidder?A.jsxs("div",{className:"bid-item",children:[A.jsxs("div",{className:"bidder-info",children:[A.jsx("button",{onClick:t=>{t.stopPropagation(),e(`/user-profile-lookup?user=${encodeURIComponent(R.bidder||"")}`)},className:"bidder",children:R.bidder}),A.jsx("span",{className:"bid-time",children:"Current leading bid"})]}),A.jsx("span",{className:"bid-amount",children:ve(R.current_bid||R.price)})]}):A.jsx("div",{className:"no-bids",children:A.jsx("p",{children:"No bids yet - be the first to bid!"})})})]}),A.jsxs("div",{className:"bid-notice",children:[A.jsx("div",{className:"notice-icon",children:"💡"}),A.jsx("div",{className:"notice-text",children:A.jsxs("p",{children:[A.jsx("strong",{children:"Important:"})," Ensure you have sufficient WAX balance for your bid. Bids are binding and cannot be cancelled."]})})]})]}),A.jsxs("div",{className:"bid-modal-footer",children:[A.jsx("button",{className:"cancel-bid-btn",onClick:()=>M(!1),disabled:U,children:"Cancel"}),A.jsx("button",{className:"submit-bid-btn",onClick:async()=>{if(!R||!n||!s)return void l("Error","Please connect your wallet first");const e=parseFloat(O);if(isNaN(e)||e<=0)return void l("Invalid Bid","Please enter a valid bid amount");const t=parseFloat(R.current_bid||R.price)/1e8,a=R.current_bid&&R.bidder;if(a&&e<=t)l("Invalid Bid",`Bid must be higher than current bid of ${D(t)}`);else if(!a&&e<t)l("Invalid Bid",`Bid must be at least the starting price of ${D(t)}`);else{z(!0);try{const t=`${e.toFixed(8)} WAX`,a={account:"atomicmarket",name:"auctionbid",authorization:[{actor:s,permission:n.permission}],data:{bidder:s,auction_id:R.auction_id,bid:t,taker_marketplace:"market.pxj"}};await n.transact({actions:[a]})&&(r("Bid Placed",`Successfully placed bid of ${D(e)}`),M(!1),B(""),W(null),fe())}catch(i){K("Error placing bid","Auctions",i);const e=i instanceof Error?i.message:"Failed to place bid. Please try again.";l("Bid Failed",e)}finally{z(!1)}}},disabled:U||!O||(R.current_bid&&R.bidder?parseFloat(O)<=parseFloat(R.current_bid)/1e8:parseFloat(O)<parseFloat(R.price)/1e8),children:U?A.jsxs(A.Fragment,{children:[A.jsx("span",{className:"loading-spinner-small"}),"Placing Bid..."]}):`Place Bid • ${O||"0.0000"} WAX`})]})]})}),F&&A.jsx("div",{className:"modal-overlay auction-modal",onClick:()=>$(!1),children:A.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Create Auction"}),A.jsx("button",{className:"close-btn",onClick:()=>$(!1),children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsx("div",{className:"asset-selection-section",children:A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Select Assets to Auction"}),A.jsx("div",{className:"asset-selection-container",children:Y?A.jsxs("div",{className:"loading-assets",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("span",{children:"Loading your assets..."})]}):V.length>0?A.jsx("div",{className:"assets-grid",children:V.map(e=>A.jsxs("div",{className:"asset-item "+(q.has(e.asset_id)?"selected":""),onClick:()=>(e=>{const t=new Set(q);t.has(e)?t.delete(e):t.add(e),J(t)})(e.asset_id),children:[A.jsxs("div",{className:"asset-image",children:[A.jsx(Fe,{imageUrl:Ve(e),videoUrl:Ge(e),alt:e.name||`Asset #${e.asset_id}`,className:"asset-media",enableAnimations:!0,loading:"lazy"}),q.has(e.asset_id)&&A.jsx("div",{className:"selection-indicator",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M9,20.42l-6.21,-6.21l2.83,-2.83L9,14.77l9.88,-9.89l2.83,2.83L9,20.42z"})})})]}),A.jsxs("div",{className:"asset-info",children:[A.jsx("div",{className:"asset-name",children:e.name||`Asset #${e.asset_id}`}),A.jsx("div",{className:"asset-collection",children:e.collection_name}),e.template_mint&&A.jsxs("div",{className:"asset-mint-info",children:["Mint #",e.template_mint]})]})]},e.asset_id))}):A.jsxs("div",{className:"no-assets",children:[A.jsx("svg",{className:"no-assets-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M20,7l-8,-4l-8,4m16,0l-8,4m8,-4v10l-8,4m0,-10L4,7m8,4v10M4,7v10l8,4"})}),A.jsx("h3",{children:"No Assets Found"}),A.jsx("p",{children:"You don't have any assets to auction. Visit the marketplace to acquire some NFTs first."})]})}),q.size>0&&A.jsx("div",{className:"selection-summary",children:A.jsxs("span",{children:[q.size," asset",q.size>1?"s":""," selected"]})})]})}),A.jsxs("div",{className:"auction-form-section",children:[A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Starting Price (WAX)"}),A.jsx("input",{type:"number",placeholder:"0.0000",step:"0.0001",min:"0",value:Z,onChange:e=>ee(e.target.value),className:"form-input"})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Auction Duration"}),A.jsxs("div",{className:"duration-inputs",children:[A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Weeks"}),A.jsx("input",{type:"number",min:"0",max:"4",value:te,onChange:e=>Ne("weeks",parseInt(e.target.value)||0),className:"duration-input"})]}),A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Days"}),A.jsx("input",{type:"number",min:"0",max:"30",value:se,onChange:e=>Ne("days",parseInt(e.target.value)||0),className:"duration-input"})]}),A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Hours"}),A.jsx("input",{type:"number",min:"0",max:"23",value:ie,onChange:e=>Ne("hours",parseInt(e.target.value)||0),className:"duration-input"})]}),A.jsxs("div",{className:"duration-field",children:[A.jsx("label",{className:"duration-label",children:"Minutes"}),A.jsx("input",{type:"number",min:"0",max:"59",value:le,onChange:e=>Ne("minutes",parseInt(e.target.value)||0),className:"duration-input"})]})]}),A.jsxs("div",{className:"duration-summary",children:[A.jsx("span",{className:"duration-display",children:(()=>{const e=[];return te>0&&e.push(`${te} week${te>1?"s":""}`),se>0&&e.push(`${se} day${se>1?"s":""}`),ie>0&&e.push(`${ie} hour${ie>1?"s":""}`),le>0&&e.push(`${le} minute${le>1?"s":""}`),0===e.length?"No duration set":e.join(", ")})()}),A.jsxs("span",{className:"duration-total",children:["Total: ",Math.floor(be()/3600),"h ",Math.floor(be()%3600/60),"m"]})]})]}),A.jsxs("div",{className:"form-group",children:[A.jsx("label",{children:"Memo (Optional)"}),A.jsx("textarea",{placeholder:"Add a description for your auction",className:"form-textarea",rows:3,value:oe,onChange:e=>de(e.target.value)})]})]})]}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"cancel-btn",onClick:()=>$(!1),children:"Cancel"}),A.jsx("button",{className:"create-btn",onClick:async()=>{if(0===q.size)return void l("No Assets Selected","Please select at least one asset to auction");if(!Z||parseFloat(Z)<=0)return void l("Invalid Price","Please enter a valid starting price");const e=be();if(e<3600)l("Invalid Duration","Auction duration must be at least 1 hour");else if(e>2592e3)l("Invalid Duration","Auction duration cannot exceed 30 days");else try{H(!0);const t=Array.from(q).map(e=>parseInt(e)),a=`${parseFloat(Z).toFixed(8)} WAX`,i=[{account:"atomicmarket",name:"announceauct",authorization:[{actor:s||"",permission:n?.permission||"active"}],data:{seller:s||"",asset_ids:t,starting_bid:a,duration:e,maker_marketplace:"market.pxj"}}];n&&await n.transact({actions:i}),r("Auction Created",`Successfully created auction for ${q.size} asset(s). Remember to transfer your assets to the atomicmarket contract to activate the auction.`),$(!1),J(new Set),ee(""),ae(0),ne(1),re(0),ce(0),de(""),fe()}catch(t){K("Failed to create auction","Auctions",t),l("Auction Creation Failed",t instanceof Error?t.message:"Failed to create auction")}finally{H(!1)}},disabled:0===q.size||!Z||parseFloat(Z)<=0||X,children:X?A.jsxs(A.Fragment,{children:[A.jsx("span",{className:"loading-spinner-small"}),"Creating Auction..."]}):"Create Auction"+(q.size>0?` (${q.size} asset${q.size>1?"s":""})`:"")})]})]})})]})},ga=()=>{const{id:e}=l(),t=i(),{isConnected:s,account:n,session:r}=_t(),{showSuccess:c,showError:o}=_e(),[d,u]=a.useState(null),[m,h]=a.useState(!0),[p,f]=a.useState(null),[x,g]=a.useState(!1),[v,y]=a.useState(""),[j,b]=a.useState(!1),N=a.useCallback(async()=>{if(e){h(!0),f(null);try{const t=await ye.getAuction(e);if(!t.success||!t.data)return void f("Auction not found");u(t.data)}catch(t){console.error("Error loading auction:",t),f("Failed to load auction details")}finally{h(!1)}}},[e]);a.useEffect(()=>{e&&N()},[e,N]),a.useEffect(()=>{if(!d)return;const e=fa.subscribe(d.auction_id,e=>{u(t=>t?{...t,current_bid:e.current_bid||t.current_bid,bidder:e.bidder||t.bidder,end_time:e.end_time}:null)});return()=>e()},[d]);const w=e=>`${(parseFloat(e)/1e8).toFixed(4)} WAX`,k=e=>{t(`/user-profile-lookup?user=${encodeURIComponent(e)}`)};if(m)return A.jsx("div",{className:"auction-detail-page",children:A.jsxs("div",{className:"loading-container",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading auction details..."})]})});if(p||!d)return A.jsx("div",{className:"auction-detail-page",children:A.jsxs("div",{className:"error-container",children:[A.jsx("h2",{children:"Auction Not Found"}),A.jsx("p",{children:p||"The requested auction could not be found."}),A.jsx("button",{className:"btn-primary",onClick:()=>t("/auctions"),children:"Back to Auctions"})]})});const _=(S=d.end_time,fa.formatTimeRemaining(S));var S;const C="Auction ended"===_,E=d.current_bid?w(d.current_bid):w(d.price);return A.jsxs("div",{className:"auction-detail-page",children:[A.jsxs("div",{className:"auction-detail-container",children:[A.jsx("button",{className:"back-button",onClick:()=>t("/auctions"),children:"← Back to Auctions"}),A.jsxs("div",{className:"auction-detail-content",children:[A.jsxs("div",{className:"auction-image-section",children:[A.jsx("div",{className:"auction-image-container",children:A.jsx(Fe,{imageUrl:d.image?`${te.IPFS.GATEWAYS[0]}${d.image}`:void 0,videoUrl:d.video?`${te.IPFS.GATEWAYS[0]}${d.video}`:void 0,alt:d.asset_name||"NFT",className:"auction-image",enableAnimations:!0})}),A.jsxs("div",{className:"auction-basic-info",children:[A.jsx("h1",{className:"auction-title",children:d.asset_name||`Asset #${d.asset_id||"Unknown"}`}),A.jsxs("div",{className:"auction-collection",children:["Collection: ",d.collection_name||"Unknown"]}),A.jsxs("div",{className:"auction-id",children:["Auction ID: ",d.auction_id]})]})]}),A.jsxs("div",{className:"auction-info-section",children:[A.jsxs("div",{className:"auction-status",children:[A.jsx("div",{className:"status-badge "+(C?"ended":"active"),children:C?"Ended":"Active"}),!C&&A.jsxs("div",{className:"time-remaining",children:[A.jsx("span",{className:"time-label",children:"Time Remaining:"}),A.jsx("span",{className:"time-value",children:_})]})]}),A.jsx("div",{className:"price-section",children:A.jsxs("div",{className:"current-price",children:[A.jsx("span",{className:"price-label",children:d.current_bid?"Current Bid:":"Starting Price:"}),A.jsx("span",{className:"price-value",children:E})]})}),A.jsxs("div",{className:"participants-section",children:[A.jsxs("div",{className:"seller-info",children:[A.jsx("span",{className:"participant-label",children:"Seller:"}),A.jsx("button",{className:"participant-link",onClick:()=>k(d.seller),children:d.seller})]}),d.bidder&&A.jsxs("div",{className:"bidder-info",children:[A.jsx("span",{className:"participant-label",children:"Top Bidder:"}),A.jsx("button",{className:"participant-link",onClick:()=>k(d.bidder||""),children:d.bidder})]})]}),A.jsx("div",{className:"auction-actions",children:!C&&A.jsx("button",{className:"btn-primary bid-button",onClick:()=>{s&&n?d?.seller!==n?(y(""),g(!0)):o("Invalid Action","You cannot bid on your own auction"):o("Wallet Required","Please connect your wallet to place bids")},disabled:!s||d.seller===n,children:s?d.seller===n?"Your Auction":"Place Bid":"Connect Wallet"})})]})]})]}),x&&A.jsx("div",{className:"modal-overlay",onClick:()=>g(!1),children:A.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h3",{children:"Place Bid"}),A.jsx("button",{className:"modal-close",onClick:()=>g(!1),children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"auction-summary",children:[A.jsx(Fe,{imageUrl:d.image?`${te.IPFS.GATEWAYS[0]}${d.image}`:void 0,videoUrl:d.video?`${te.IPFS.GATEWAYS[0]}${d.video}`:void 0,alt:d.asset_name||"NFT",className:"modal-nft-image",enableAnimations:!0}),A.jsxs("div",{className:"modal-nft-info",children:[A.jsx("h4",{children:d.asset_name||`Asset #${d.asset_id||"Unknown"}`}),A.jsxs("p",{children:["Current: ",E]})]})]}),d.bidder&&A.jsxs("div",{className:"current-bidder",children:[A.jsx("span",{className:"label",children:"Leading Bidder"}),A.jsx("button",{className:"bidder-account",onClick:()=>k(d.bidder),children:d.bidder})]}),A.jsxs("div",{className:"bid-input-section",children:[A.jsx("label",{htmlFor:"bidAmount",children:"Your Bid (WAX)"}),A.jsx("input",{id:"bidAmount",type:"number",step:"0.0001",placeholder:"Enter bid amount",value:v,onChange:e=>y(e.target.value),min:d.current_bid&&d.bidder?parseFloat(d.current_bid)/1e8+1e-4:parseFloat(d.price)/1e8}),A.jsxs("div",{className:"bid-requirement",children:["Minimum: ",d.current_bid&&d.bidder?`${(parseFloat(d.current_bid)/1e8+1e-4).toFixed(4)} WAX`:`${(parseFloat(d.price)/1e8).toFixed(4)} WAX`]})]})]}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"btn-secondary",onClick:()=>g(!1),disabled:j,children:"Cancel"}),A.jsx("button",{className:"btn-primary",onClick:async()=>{if(!d||!r||!n)return void o("Error","Please connect your wallet first");const e=parseFloat(v);if(isNaN(e)||e<=0)return void o("Invalid Bid","Please enter a valid bid amount");const t=parseFloat(d.current_bid||d.price)/1e8,a=d.current_bid&&d.bidder;if(a&&e<=t)o("Invalid Bid",`Bid must be higher than current bid of ${t.toFixed(4)} WAX`);else if(!a&&e<parseFloat(d.price)/1e8)o("Invalid Bid",`Bid must be at least ${(parseFloat(d.price)/1e8).toFixed(4)} WAX`);else{b(!0);try{const t=Math.floor(1e8*e);await r.transact({actions:[{account:"atomicmarket",name:"auctionbid",authorization:[{actor:n,permission:"active"}],data:{bidder:n,auction_id:d.auction_id,bid:`${t} WAX`,taker_marketplace:"market.pxj"}}]})&&(c("Bid Placed",`Successfully placed bid of ${e.toFixed(4)} WAX`),g(!1),y(""),u(e=>e?{...e,current_bid:t.toString(),bidder:n}:null))}catch(s){console.error("Error placing bid:",s),o("Bid Failed",s instanceof Error?s.message:"Failed to place bid")}finally{b(!1)}}},disabled:j||!v,children:j?"Placing Bid...":"Place Bid"})]})]})})]})},va=()=>{const[e,t]=a.useState("getting-started"),s=[{id:"getting-started",title:"Getting Started on WAX",content:A.jsxs("div",{className:"guide-content",children:[A.jsx("h3",{children:"Welcome to the WAX Blockchain!"}),A.jsx("p",{children:"WAX (Worldwide Asset eXchange) is a purpose-built blockchain for NFTs and gaming. Here's how to get started:"}),A.jsxs("div",{className:"step-list",children:[A.jsxs("div",{className:"step",children:[A.jsx("div",{className:"step-number",children:"1"}),A.jsxs("div",{className:"step-content",children:[A.jsx("h4",{children:"Create a WAX Wallet"}),A.jsxs("p",{children:["Visit ",A.jsx("a",{href:"https://wallet.wax.io",target:"_blank",rel:"noopener noreferrer",children:"wallet.wax.io"})," to create your free WAX account. No gas fees required!"]})]})]}),A.jsxs("div",{className:"step",children:[A.jsx("div",{className:"step-number",children:"2"}),A.jsxs("div",{className:"step-content",children:[A.jsx("h4",{children:"Get Some WAX Tokens"}),A.jsx("p",{children:"Purchase WAX tokens from exchanges like Binance, KuCoin, or use the built-in WAX wallet exchange."})]})]}),A.jsxs("div",{className:"step",children:[A.jsx("div",{className:"step-number",children:"3"}),A.jsxs("div",{className:"step-content",children:[A.jsx("h4",{children:"Connect Your Wallet"}),A.jsx("p",{children:'Use the "Connect Wallet" button in the top right to connect your WAX wallet to PxMarket.'})]})]}),A.jsxs("div",{className:"step",children:[A.jsx("div",{className:"step-number",children:"4"}),A.jsxs("div",{className:"step-content",children:[A.jsx("h4",{children:"Start Trading!"}),A.jsx("p",{children:"Browse collections, buy NFTs, and start building your digital asset portfolio."})]})]})]})]})},{id:"pixel-journey",title:"About Pixel Journey",content:A.jsxs("div",{className:"guide-content",children:[A.jsx("h3",{children:"Welcome to Pixel Journey!"}),A.jsx("p",{children:"Pixel Journey is a comprehensive NFT ecosystem on the WAX blockchain, featuring unique pixel art collections and gaming utilities."}),A.jsxs("div",{className:"feature-grid",children:[A.jsxs("div",{className:"feature-card",children:[A.jsx("h4",{children:"🎨 Pixel Art NFTs"}),A.jsx("p",{children:"Collect unique pixel art characters, items, and accessories with various rarity levels."})]}),A.jsxs("div",{className:"feature-card",children:[A.jsx("h4",{children:"🎮 Gaming Integration"}),A.jsx("p",{children:"Use your NFTs in games and earn rewards through various gameplay mechanics."})]}),A.jsxs("div",{className:"feature-card",children:[A.jsx("h4",{children:"💎 Staking Rewards"}),A.jsx("p",{children:"Stake your Pixel Journey NFTs to earn PXJ tokens and other rewards."})]}),A.jsxs("div",{className:"feature-card",children:[A.jsx("h4",{children:"🏪 Marketplace"}),A.jsx("p",{children:"Trade your NFTs on our integrated marketplace with zero fees for holders."})]})]}),A.jsxs("div",{className:"collections-info",children:[A.jsx("h4",{children:"Main Collections:"}),A.jsxs("ul",{children:[A.jsxs("li",{children:[A.jsx("strong",{children:"Pixals:"})," The main character collection with various traits and rarities"]}),A.jsxs("li",{children:[A.jsx("strong",{children:"Pixel Ingredients:"})," Crafting materials and consumables"]}),A.jsxs("li",{children:[A.jsx("strong",{children:"Pixel Tools:"})," Equipment and utility items"]}),A.jsxs("li",{children:[A.jsx("strong",{children:"Pixel Lands:"})," Virtual land parcels for building and development"]})]})]})]})},{id:"trading-tips",title:"Trading Tips & Strategies",content:A.jsxs("div",{className:"guide-content",children:[A.jsx("h3",{children:"Smart Trading on WAX"}),A.jsxs("div",{className:"tip-section",children:[A.jsx("h4",{children:"🔍 Research Before Buying"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Check the collection's total supply and rarity distribution"}),A.jsx("li",{children:"Look at recent sales history and price trends"}),A.jsx("li",{children:"Verify the authenticity of the collection"}),A.jsx("li",{children:"Join the project's Discord or Telegram for community insights"})]})]}),A.jsxs("div",{className:"tip-section",children:[A.jsx("h4",{children:"💰 Pricing Strategies"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Use floor price as a baseline for common items"}),A.jsx("li",{children:"Factor in rarity and trait combinations for pricing"}),A.jsx("li",{children:"Consider market timing and overall WAX ecosystem trends"}),A.jsx("li",{children:"Set competitive prices for quick sales or premium prices for rare items"})]})]}),A.jsxs("div",{className:"tip-section",children:[A.jsx("h4",{children:"⚠️ Risk Management"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Never invest more than you can afford to lose"}),A.jsx("li",{children:"Diversify across different collections and projects"}),A.jsx("li",{children:"Be aware of market volatility and seasonal trends"}),A.jsx("li",{children:"Keep some WAX liquid for opportunities"})]})]})]})},{id:"faq",title:"Frequently Asked Questions",content:A.jsxs("div",{className:"guide-content",children:[A.jsx("h3",{children:"Common Questions"}),A.jsxs("div",{className:"faq-list",children:[A.jsxs("div",{className:"faq-item",children:[A.jsx("h4",{children:"Q: Are there any fees for trading on PxMarket?"}),A.jsx("p",{children:"A: PxMarket charges a small marketplace fee on sales. However, Pixel Journey NFT holders may receive fee discounts or exemptions."})]}),A.jsxs("div",{className:"faq-item",children:[A.jsx("h4",{children:"Q: How do I know if an NFT is authentic?"}),A.jsx("p",{children:"A: Always verify the collection name and creator account. Authentic Pixel Journey NFTs are minted by verified accounts and will show the official collection badge."})]}),A.jsxs("div",{className:"faq-item",children:[A.jsx("h4",{children:"Q: Can I cancel a listing after it's posted?"}),A.jsx("p",{children:"A: Yes, you can cancel your listings at any time from your inventory or profile page. There's no fee for canceling listings."})]}),A.jsxs("div",{className:"faq-item",children:[A.jsx("h4",{children:"Q: What happens if I lose access to my WAX wallet?"}),A.jsx("p",{children:"A: Always keep your private keys and recovery phrases secure. If you lose access, you may lose your NFTs permanently. Consider using hardware wallets for valuable collections."})]}),A.jsxs("div",{className:"faq-item",children:[A.jsx("h4",{children:"Q: How do I participate in NFT drops and launches?"}),A.jsx("p",{children:"A: Follow Pixel Journey on social media and join our Discord for announcements. Most drops happen directly through our platform or partner sites."})]}),A.jsxs("div",{className:"faq-item",children:[A.jsx("h4",{children:"Q: Can I use my NFTs in games?"}),A.jsx("p",{children:"A: Many Pixel Journey NFTs have gaming utility. Check the NFT details page for specific game integrations and benefits."})]})]})]})},{id:"advanced",title:"Advanced Features",content:A.jsxs("div",{className:"guide-content",children:[A.jsx("h3",{children:"Power User Features"}),A.jsxs("div",{className:"advanced-section",children:[A.jsx("h4",{children:"🔧 Bulk Operations"}),A.jsx("p",{children:"Use our bulk tools to:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"List multiple NFTs at once with smart pricing"}),A.jsx("li",{children:"Transfer multiple items to different recipients"}),A.jsx("li",{children:"Burn unwanted NFTs in batches"}),A.jsx("li",{children:"Stake multiple NFTs for rewards"})]})]}),A.jsxs("div",{className:"advanced-section",children:[A.jsx("h4",{children:"📊 Analytics & Tracking"}),A.jsx("p",{children:"Monitor your portfolio with:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Real-time portfolio value tracking"}),A.jsx("li",{children:"Transaction history and profit/loss analysis"}),A.jsx("li",{children:"Collection performance metrics"}),A.jsx("li",{children:"Market trend indicators"})]})]}),A.jsxs("div",{className:"advanced-section",children:[A.jsx("h4",{children:"🎯 Watchlists & Alerts"}),A.jsx("p",{children:"Stay informed with:"}),A.jsxs("ul",{children:[A.jsx("li",{children:"Custom watchlists for tracking specific NFTs"}),A.jsx("li",{children:"Price alerts for collections you're interested in"}),A.jsx("li",{children:"New listing notifications"}),A.jsx("li",{children:"Auction ending reminders"})]})]})]})}];return A.jsxs("div",{className:"learn-page",children:[A.jsxs("div",{className:"page-header",children:[A.jsx("h1",{children:"Learn Hub"}),A.jsx("p",{children:"Everything you need to know about WAX, NFTs, and Pixel Journey"})]}),A.jsxs("div",{className:"learn-container",children:[A.jsx("div",{className:"learn-sidebar",children:A.jsx("nav",{className:"learn-nav",children:s.map(a=>A.jsx("button",{className:"nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id),children:a.title},a.id))})}),A.jsx("div",{className:"learn-content",children:s.find(t=>t.id===e)?.content})]}),A.jsxs("div",{className:"help-section",children:[A.jsx("h3",{children:"Need More Help?"}),A.jsx("p",{children:"Access our documentation and join our community for support:"}),A.jsxs("div",{className:"community-links",children:[A.jsxs("a",{href:"https://docs.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"community-link docs",children:[A.jsx("span",{className:"icon",children:"📚"}),"Documentation"]}),A.jsxs("a",{href:"#",className:"community-link discord",children:[A.jsx("span",{className:"icon",children:"💬"}),"Discord Community"]}),A.jsxs("a",{href:"#",className:"community-link telegram",children:[A.jsx("span",{className:"icon",children:"📱"}),"Telegram Group"]}),A.jsxs("a",{href:"#",className:"community-link twitter",children:[A.jsx("span",{className:"icon",children:"🐦"}),"Twitter Updates"]})]})]})]})},ya=()=>{const[e,t]=a.useState("overview"),s=[{id:"overview",title:"Overview",content:A.jsxs("div",{className:"section-content",children:[A.jsx("h3",{children:"PxMarket Journey Map"}),A.jsx("p",{children:"Welcome to the comprehensive roadmap of the Pixel Journey ecosystem. This page serves as both a sitemap for current features and a development roadmap for future enhancements."}),A.jsxs("div",{className:"ecosystem-grid",children:[A.jsxs("div",{className:"ecosystem-card current",children:[A.jsx("h4",{children:"🏪 Current Platform"}),A.jsx("p",{children:"PxMarket - Your gateway to the Pixel Journey NFT ecosystem"})]}),A.jsxs("div",{className:"ecosystem-card future",children:[A.jsx("h4",{children:"🚀 Future dApps"}),A.jsx("p",{children:"Expanding ecosystem of interconnected applications"})]})]})]})},{id:"pxmarket-features",title:"PxMarket Features",content:A.jsxs("div",{className:"section-content",children:[A.jsx("h3",{children:"PxMarket Feature Map"}),A.jsx("p",{children:"Explore all the features available in the current PxMarket platform:"}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"🛒 Marketplace Core"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"NFT Marketplace"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Collection Browser"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Asset Details"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Advanced Filtering"}),A.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"👤 User Features"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"User Profiles"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Inventory Management"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Watchlist"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Activity Tracking"}),A.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"💰 Trading & Economy"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Buy/Sell NFTs"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Bulk Operations"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Price Analytics"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Auctions"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Offers System"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Shopping Cart"}),A.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"🔄 WAX Integration"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"RWAX Tokenization"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"WAX Balance Management"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Resource Management (CPU/NET/RAM)"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Multi-Wallet Support"}),A.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"🏆 Staking & Rewards"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"NFT Staking"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Token Staking"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Reward Distribution"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"PXJ Badge System"}),A.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"🎁 Rewards & Gamification"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Pack Opening"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Chat System"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Live Transactions Feed"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Social Sharing"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item planned",children:[A.jsx("span",{className:"feature-name",children:"Achievement System"}),A.jsx("span",{className:"status-badge planned",children:"Planned"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"🛠️ Advanced Features"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"NFT Comparison Tool"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Portfolio Analytics"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Price Alerts"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Collection Analytics"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"Accessibility Features"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsxs("div",{className:"feature-item live",children:[A.jsx("span",{className:"feature-name",children:"PWA Support"}),A.jsx("span",{className:"status-badge live",children:"Live"})]})]})]}),A.jsxs("div",{className:"feature-category",children:[A.jsx("h4",{children:"🎨 Crafting & Creation"}),A.jsxs("div",{className:"feature-list",children:[A.jsxs("div",{className:"feature-item beta",children:[A.jsx("span",{className:"feature-name",children:"NFT Crafting System"}),A.jsx("span",{className:"status-badge beta",children:"Beta"})]}),A.jsxs("div",{className:"feature-item planned",children:[A.jsx("span",{className:"feature-name",children:"Custom Templates"}),A.jsx("span",{className:"status-badge planned",children:"Planned"})]}),A.jsxs("div",{className:"feature-item planned",children:[A.jsx("span",{className:"feature-name",children:"Community Creations"}),A.jsx("span",{className:"status-badge planned",children:"Planned"})]})]})]})]})},{id:"wax-ecosystem",title:"WAX Ecosystem",content:A.jsxs("div",{className:"section-content",children:[A.jsx("h3",{children:"PXJourney across WAX"}),A.jsx("p",{children:"Explore the expanding Pixel Journey ecosystem on the WAX blockchain:"}),A.jsxs("div",{className:"dapp-grid",children:[A.jsxs("div",{className:"dapp-card live purple-glow",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxMarket"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsx("p",{children:"NFT marketplace and trading platform"}),A.jsx("a",{href:"https://market.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxMarket →"})]}),A.jsxs("div",{className:"dapp-card live green-glow",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxStaking"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsx("p",{children:"Stake your Pixel Journey NFTs for rewards"}),A.jsx("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxStaking →"})]}),A.jsxs("div",{className:"dapp-card live golden-glow",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxLeaderboards"}),A.jsx("span",{className:"status-badge live",children:"Live"})]}),A.jsx("p",{children:"Track rankings and compete with other players"}),A.jsx("a",{href:"https://lb.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"dapp-link",children:"Visit PxLeaderboards →"})]}),A.jsxs("div",{className:"dapp-card planned",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxDeFi"}),A.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),A.jsx("p",{children:"Decentralized finance features for the ecosystem"}),A.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]}),A.jsxs("div",{className:"dapp-card coming-soon",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxCraft"}),A.jsx("span",{className:"status-badge coming-soon",children:"Coming Soon"})]}),A.jsx("p",{children:"Craft and create new NFTs from existing assets"}),A.jsx("div",{className:"dapp-link disabled",children:"In Development"})]}),A.jsxs("div",{className:"dapp-card coming-soon",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxMilestones"}),A.jsx("span",{className:"status-badge coming-soon",children:"Coming Soon"})]}),A.jsx("p",{children:"Achievement and milestone tracking system"}),A.jsx("div",{className:"dapp-link disabled",children:"In Development"})]}),A.jsxs("div",{className:"dapp-card planned",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxQuest"}),A.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),A.jsx("p",{children:"Quest and mission system for earning rewards"}),A.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]}),A.jsxs("div",{className:"dapp-card planned",children:[A.jsxs("div",{className:"dapp-header",children:[A.jsx("h4",{children:"PxDAO"}),A.jsx("span",{className:"status-badge planned",children:"ETA TBD"})]}),A.jsx("p",{children:"Decentralized governance for the ecosystem"}),A.jsx("div",{className:"dapp-link disabled",children:"Coming via PxMilestones"})]})]})]})},{id:"external-links",title:"External Platforms",content:A.jsxs("div",{className:"section-content",children:[A.jsx("h3",{children:"Pixel Journey Across Platforms"}),A.jsx("p",{children:"Find Pixel Journey on various platforms and marketplaces:"}),A.jsxs("div",{className:"platform-category",children:[A.jsx("h4",{children:"🌐 Official Websites"}),A.jsxs("div",{className:"link-grid",children:[A.jsxs("a",{href:"https://pixeljourney.xyz/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"Main Website"}),A.jsx("span",{className:"platform-desc",children:"Official Pixel Journey homepage"})]}),A.jsxs("a",{href:"https://docs.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"Documentation"}),A.jsx("span",{className:"platform-desc",children:"Complete project documentation"})]})]})]}),A.jsxs("div",{className:"platform-category",children:[A.jsx("h4",{children:"🛒 NFT Marketplaces (WAX)"}),A.jsxs("div",{className:"link-grid",children:[A.jsxs("a",{href:"https://atomichub.io/explorer/collection/wax-mainnet/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"AtomicHub"}),A.jsx("span",{className:"platform-desc",children:"Primary WAX marketplace"})]}),A.jsxs("a",{href:"https://neftyblocks.com/collection/pixeljourney/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"NeftyBlocks"}),A.jsx("span",{className:"platform-desc",children:"WAX NFT marketplace"})]}),A.jsxs("a",{href:"https://nfthive.io/collection/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"NFTHive"}),A.jsx("span",{className:"platform-desc",children:"WAX marketplace and drops"})]}),A.jsxs("a",{href:"https://www.pfpwizard.xyz/pfp/pixals/ranking/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"PFP Wizard"}),A.jsx("span",{className:"platform-desc",children:"Pixal PFP marketplace"})]})]})]}),A.jsxs("div",{className:"platform-category",children:[A.jsx("h4",{children:"🌉 Cross-Chain Marketplaces"}),A.jsxs("div",{className:"link-grid",children:[A.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-polygon",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"OpenSea (Polygon)"}),A.jsx("span",{className:"platform-desc",children:"Polygon bridged collection"})]}),A.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-base",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"OpenSea (Base)"}),A.jsx("span",{className:"platform-desc",children:"Base bridged collection"})]}),A.jsxs("a",{href:"https://opensea.io/collection/pixeljourney-eth",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"OpenSea (Ethereum)"}),A.jsx("span",{className:"platform-desc",children:"Ethereum bridged collection"})]}),A.jsxs("a",{href:"https://nft.monbase.com/collections/66c4eb2ca339b05c5a660e44/detail",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"MonBase"}),A.jsx("span",{className:"platform-desc",children:"Base chain marketplace"})]})]})]}),A.jsxs("div",{className:"platform-category",children:[A.jsx("h4",{children:"💰 DeFi & Staking"}),A.jsxs("div",{className:"link-grid",children:[A.jsxs("a",{href:"https://waxdao.io/v2/farm/pixeljourney",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"WaxDAO Farm"}),A.jsx("span",{className:"platform-desc",children:"NFT staking rewards"})]}),A.jsxs("a",{href:"https://www.pfpwizard.xyz/pfp/pixals/buy/",target:"_blank",rel:"noopener noreferrer",className:"platform-link",children:[A.jsx("span",{className:"platform-name",children:"PFP Wizard Buy"}),A.jsx("span",{className:"platform-desc",children:"Get your Pixal PFP"})]})]})]})]})},{id:"social-community",title:"Social & Community",content:A.jsxs("div",{className:"section-content",children:[A.jsx("h3",{children:"Join the Community"}),A.jsx("p",{children:"Connect with the Pixel Journey community across various platforms:"}),A.jsxs("div",{className:"social-grid",children:[A.jsxs("a",{href:"https://twitter.com/PxJourney",target:"_blank",rel:"noopener noreferrer",className:"social-link twitter",children:[A.jsx("div",{className:"social-icon",children:"🐦"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"Twitter/X"}),A.jsx("span",{className:"social-desc",children:"Latest updates and announcements"})]})]}),A.jsxs("a",{href:"https://t.me/pixel_journey",target:"_blank",rel:"noopener noreferrer",className:"social-link telegram",children:[A.jsx("div",{className:"social-icon",children:"📱"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"Telegram"}),A.jsx("span",{className:"social-desc",children:"Community chat and discussions"})]})]}),A.jsxs("a",{href:"https://discord.gg/waxblockchain",target:"_blank",rel:"noopener noreferrer",className:"social-link discord",children:[A.jsx("div",{className:"social-icon",children:"💬"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"WAX Discord"}),A.jsx("span",{className:"social-desc",children:"Join the broader WAX community"})]})]}),A.jsxs("a",{href:"https://instagram.com/pixeljourney_xyz",target:"_blank",rel:"noopener noreferrer",className:"social-link instagram",children:[A.jsx("div",{className:"social-icon",children:"📸"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"Instagram"}),A.jsx("span",{className:"social-desc",children:"Visual updates and behind-the-scenes"})]})]}),A.jsxs("a",{href:"https://coinmarketcap.com/community/profile/pixeljourney/",target:"_blank",rel:"noopener noreferrer",className:"social-link cmc",children:[A.jsx("div",{className:"social-icon",children:"📊"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"CoinMarketCap"}),A.jsx("span",{className:"social-desc",children:"Project profile and metrics"})]})]}),A.jsxs("a",{href:"https://dappradar.com/nft-collection/pixel-journey",target:"_blank",rel:"noopener noreferrer",className:"social-link dappradar",children:[A.jsx("div",{className:"social-icon",children:"📈"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"DappRadar"}),A.jsx("span",{className:"social-desc",children:"NFT collection analytics"})]})]}),A.jsxs("a",{href:"https://pixel-journey.uncut.network/",target:"_blank",rel:"noopener noreferrer",className:"social-link uncut",children:[A.jsx("div",{className:"social-icon",children:"🎮"}),A.jsxs("div",{className:"social-info",children:[A.jsx("span",{className:"social-name",children:"Uncut Network"}),A.jsx("span",{className:"social-desc",children:"Gaming community presence"})]})]})]})]})},{id:"roadmap",title:"Development Roadmap",content:A.jsxs("div",{className:"section-content",children:[A.jsx("h3",{children:"Future Development Roadmap"}),A.jsx("p",{children:"Planned features and enhancements for the Pixel Journey ecosystem:"}),A.jsxs("div",{className:"roadmap-timeline",children:[A.jsxs("div",{className:"roadmap-phase completed",children:[A.jsxs("div",{className:"phase-header",children:[A.jsx("h4",{children:"Phase 1: Foundation"}),A.jsx("span",{className:"phase-status completed",children:"Completed"})]}),A.jsxs("ul",{children:[A.jsx("li",{children:"✅ PxMarket NFT marketplace launch"}),A.jsx("li",{children:"✅ Basic trading functionality"}),A.jsx("li",{children:"✅ User profiles and inventory"}),A.jsx("li",{children:"✅ PXJ token integration"})]})]}),A.jsxs("div",{className:"roadmap-phase current",children:[A.jsxs("div",{className:"phase-header",children:[A.jsx("h4",{children:"Phase 2: Enhancement"}),A.jsx("span",{className:"phase-status current",children:"Current"})]}),A.jsxs("ul",{children:[A.jsx("li",{children:"✅ Advanced filtering and search"}),A.jsx("li",{children:"✅ Bulk operations"}),A.jsx("li",{children:"🔄 Auction system (Beta)"}),A.jsx("li",{children:"🔄 Enhanced analytics"})]})]}),A.jsxs("div",{className:"roadmap-phase planned",children:[A.jsxs("div",{className:"phase-header",children:[A.jsx("h4",{children:"Phase 3: Ecosystem Expansion"}),A.jsx("span",{className:"phase-status planned",children:"Q2 2024"})]}),A.jsxs("ul",{children:[A.jsx("li",{children:"🔮 PxCraft crafting system"}),A.jsx("li",{children:"🔮 PxMilestones achievement system"}),A.jsx("li",{children:"🔮 Enhanced gamification"}),A.jsx("li",{children:"🔮 Cross-platform integration"})]})]}),A.jsxs("div",{className:"roadmap-phase future",children:[A.jsxs("div",{className:"phase-header",children:[A.jsx("h4",{children:"Phase 4: Advanced Features"}),A.jsx("span",{className:"phase-status future",children:"Q3-Q4 2024"})]}),A.jsxs("ul",{children:[A.jsx("li",{children:"🔮 PxQuest mission system"}),A.jsx("li",{children:"🔮 PxDeFi financial features"}),A.jsx("li",{children:"🔮 PxDAO governance"}),A.jsx("li",{children:"🔮 Mobile applications"})]})]})]})]})}];return A.jsxs("div",{className:"journeymap-page",children:[A.jsxs("div",{className:"page-header",children:[A.jsx("h1",{children:"Journey Map"}),A.jsx("p",{children:"Your comprehensive guide to the Pixel Journey ecosystem - current features, future roadmap, and community links"})]}),A.jsxs("div",{className:"journeymap-container",children:[A.jsx("div",{className:"journeymap-sidebar",children:A.jsx("nav",{className:"journeymap-nav",children:s.map(a=>A.jsx("button",{className:"nav-item "+(e===a.id?"active":""),onClick:()=>t(a.id),children:a.title},a.id))})}),A.jsx("div",{className:"journeymap-content",children:s.find(t=>t.id===e)?.content})]})]})};const ja=new class{MAX_BATCH_SIZE=10;RETRY_ATTEMPTS=3;RETRY_DELAY=1e3;FARMS_CONTRACT="farms.waxdao";TOKEN_FARMS_CONTRACT="tf.waxdao";PXJ_CONTRACT="pixeljourney";WUF_CONTRACT="wuffi";PXJ_FARM_NAME="pxjfarm1";async stakeNFTsBatch(e,t,a="pixeljourney"){const s={success:!0,successful_transactions:[],failed_transactions:[],total_gas_used:0};try{const i=this.createBatches(t,this.MAX_BATCH_SIZE);for(const t of i)try{const n=await this.processBatch(e,t,"stake",a);s.successful_transactions.push(...n.successful_transactions),s.failed_transactions.push(...n.failed_transactions),s.total_gas_used+=n.total_gas_used,i.indexOf(t)<i.length-1&&await this.delay(500)}catch(n){t.forEach(e=>{s.failed_transactions.push({asset_id:e,error:n instanceof Error?n.message:"Batch processing failed"})})}return s.success=0===s.failed_transactions.length,q.info("NFT Staking Batch Operation","StakingService",{total_assets:t.length,successful:s.successful_transactions.length,failed:s.failed_transactions.length,farm_name:a}),s}catch(n){return q.error("stakeNFTsBatch failed","StakingService",n,{asset_ids:t,farm_name:a}),{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:n instanceof Error?n.message:"Unknown error"})),total_gas_used:0}}}async unstakeNFTsBatch(e,t){const a={success:!0,successful_transactions:[],failed_transactions:[],total_gas_used:0};try{const n=this.createBatches(t,this.MAX_BATCH_SIZE);for(const t of n)try{const s=await this.processBatch(e,t,"unstake");a.successful_transactions.push(...s.successful_transactions),a.failed_transactions.push(...s.failed_transactions),a.total_gas_used+=s.total_gas_used,n.indexOf(t)<n.length-1&&await this.delay(500)}catch(s){t.forEach(e=>{a.failed_transactions.push({asset_id:e,error:s instanceof Error?s.message:"Batch processing failed"})})}return a.success=0===a.failed_transactions.length,q.info("NFT Unstaking Batch Operation","StakingService",{total_assets:t.length,successful:a.successful_transactions.length,failed:a.failed_transactions.length}),a}catch(s){return q.error("unstakeNFTsBatch failed","StakingService",s,{asset_ids:t}),{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:s instanceof Error?s.message:"Unknown error"})),total_gas_used:0}}}async claimAllRewards(e,t="pixeljourney"){try{const a=[{account:this.FARMS_CONTRACT,name:"claimreward",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{owner:e.actor.toString(),farm_name:t}}],s=await this.executeTransactionWithRetry(e,a);return s.success&&q.info("Rewards Claimed Successfully","StakingService",{user:e.actor.toString(),farm_name:t,transaction_id:s.transaction_id}),s}catch(a){return q.error("claimAllRewards failed","StakingService",a,{user:e.actor.toString(),farm_name:t}),{success:!1,error:a instanceof Error?a.message:"Failed to claim rewards"}}}async getStakingInfo(e,t="pixeljourney"){try{const a=await fetch(`${te.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.FARMS_CONTRACT,scope:this.FARMS_CONTRACT,table:"stakers",lower_bound:e,upper_bound:e,limit:1e3})});if(!a.ok)throw new Error(`Failed to fetch staking info: ${a.statusText}`);const s=(await a.json()).rows.find(t=>t.user===e)||{},n=s.staked_assets||[],i=s.pending_rewards||[],r=n.map(e=>({asset_id:e,template_id:"0",farm_name:t,stake_time:Date.now()/1e3,rewards_per_hour:{pxj:0,wuf:0},multiplier:1}))||[],l=i.map(e=>({token:e.quantity.split(" ")[1],amount:parseFloat(e.quantity.split(" ")[0]),contract:e.contract,precision:4})),c=r.reduce((e,t)=>e+Object.values(t.rewards_per_hour).reduce((e,t)=>e+t,0)*t.multiplier,0),o=[{token:"PXJ",amount:r.reduce((e,t)=>e+24*(t.rewards_per_hour.pxj||0),0),contract:this.PXJ_CONTRACT,precision:4},{token:"WUF",amount:r.reduce((e,t)=>e+24*(t.rewards_per_hour.wuf||0),0),contract:this.WUF_CONTRACT,precision:4}];return{staked_nfts:r,pending_rewards:l,total_staking_power:c,estimated_daily_rewards:o}}catch(a){return q.error("getStakingInfo failed","StakingService",a,{account:e,farm_name:t}),{staked_nfts:[],pending_rewards:[],total_staking_power:0,estimated_daily_rewards:[]}}}async stakeTokens(e,t,a=this.PXJ_FARM_NAME){try{const s=[{account:this.PXJ_CONTRACT,name:"transfer",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{from:e.actor.toString(),to:this.TOKEN_FARMS_CONTRACT,quantity:t,memo:`stake:${a}`}}],n=await this.executeTransactionWithRetry(e,s);return n.success&&q.info("Token staked successfully","StakingService",{type:"token_stake",user:e.actor.toString(),amount:t,farm_name:a}),n}catch(s){return q.error("stakeTokens failed","StakingService",s,{user:e.actor.toString(),amount:t,farm_name:a}),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async unstakeTokens(e,t,a=this.PXJ_FARM_NAME){try{const s=[{account:this.TOKEN_FARMS_CONTRACT,name:"unstake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farm_name:a,quantity:t}}],n=await this.executeTransactionWithRetry(e,s);return n.success&&q.info("Token unstaked successfully","StakingService",{type:"token_unstake",user:e.actor.toString(),amount:t,farm_name:a}),n}catch(s){return q.error("unstakeTokens failed","StakingService",s,{user:e.actor.toString(),amount:t,farm_name:a}),{success:!1,error:s instanceof Error?s.message:"Unknown error"}}}async claimTokenFarmRewards(e,t=this.PXJ_FARM_NAME){try{const a=[{account:this.TOKEN_FARMS_CONTRACT,name:"getreward",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{user:e.actor.toString(),farm_name:t}}],s=await this.executeTransactionWithRetry(e,a);return s.success&&q.info("Token farm rewards claimed successfully","StakingService",{type:"token_claim_rewards",user:e.actor.toString(),farm_name:t}),s}catch(a){return q.error("claimTokenFarmRewards failed","StakingService",a,{user:e.actor.toString(),farm_name:t}),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}async getTokenFarmInfo(e=this.PXJ_FARM_NAME){try{const t=await fetch(`${te.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.TOKEN_FARMS_CONTRACT,scope:this.TOKEN_FARMS_CONTRACT,table:"farms",lower_bound:e,upper_bound:e,limit:1})});if(!t.ok)throw new Error(`Failed to fetch farm info: ${t.statusText}`);const a=(await t.json()).rows.find(t=>t.farm_name===e);return a?{farm_name:a.farm_name,creator:a.creator,time_created:a.time_created,staking_token:a.staking_token,incentive_count:a.incentive_count,total_staked:a.total_staked,vesting_time:a.vesting_time,last_update_time:a.last_update_time}:null}catch(t){return q.error("getTokenFarmInfo failed","StakingService",t,{farm_name:e}),null}}async getTokenStakingInfo(e,t=this.PXJ_FARM_NAME){try{const a=await fetch(`${te.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.TOKEN_FARMS_CONTRACT,scope:t,table:"stakers",lower_bound:e,upper_bound:e,limit:1})});if(!a.ok)throw new Error(`Failed to fetch token staking info: ${a.statusText}`);const s=(await a.json()).rows.find(t=>t.user===e);if(!s)return null;const n=(s.pending_rewards||[]).map(e=>({token:e.quantity.split(" ")[1],amount:parseFloat(e.quantity.split(" ")[0]),contract:e.contract,precision:4}));return{farm_name:t,user:s.user,staked_amount:s.staked_amount,stake_time:s.stake_time,pending_rewards:n,vesting_time:s.vesting_time,last_claim_time:s.last_claim_time}}catch(a){return q.error("getTokenStakingInfo failed","StakingService",a,{account:e,farm_name:t}),null}}async calculateOptimalStakingStrategy(e,t="pixeljourney"){try{const a=await this.getStakingInfo(e,t),s=new Set(a.staked_nfts.map(e=>e.asset_id)),n=await fetch(`${ye.atomicAssetsAPI}/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&page=1&limit=1000&order=desc&sort=asset_id`);if(!n.ok)throw new Error("Failed to fetch available NFTs");const i=await n.json(),r=i.data?.filter(e=>!s.has(e.asset_id)).map(e=>({asset_id:e.asset_id,template_id:e.template.template_id,farm_name:t,stake_time:0,rewards_per_hour:this.calculateRewardsPerHour(e.template.template_id),multiplier:1}))||[],l=await this.getTemplateRewards(),c=r.map(e=>{const t=l[e.template_id]||{pxj:0,wuf:0},a=this.getRarityMultiplier(this.getTemplateRarity(e.template_id)),s=24*(t.pxj+t.wuf)*a;return{asset_id:e.asset_id,expected_daily_return:s,priority:this.calculateStakingPriority(this.getTemplateRarity(e.template_id),s)}}).sort((e,t)=>t.priority-e.priority),o=c.reduce((e,t)=>e+t.expected_daily_return,0);return{recommended_stakes:c,total_expected_daily_return:o,optimization_tips:this.generateOptimizationTips(c,r),available_nfts:r}}catch(a){return q.error("calculateOptimalStakingStrategy failed","StakingService",a,{account:e}),{recommended_stakes:[],total_expected_daily_return:0,optimization_tips:["Unable to calculate optimal strategy. Please try again later."],available_nfts:[]}}}async processBatch(e,t,a,s){const n=t.map(t=>"stake"===a?{account:this.FARMS_CONTRACT,name:"stake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{owner:e.actor.toString(),asset_id:t,farm_name:s||"pixeljourney"}}:{account:this.FARMS_CONTRACT,name:"unstake",authorization:[{actor:e.actor.toString(),permission:e.permission.toString()}],data:{owner:e.actor.toString(),asset_id:t}});try{const a=await this.executeTransactionWithRetry(e,n);return a.success?{success:!0,successful_transactions:t,failed_transactions:[],total_gas_used:a.gas_used||0}:{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:a.error||"Transaction failed"})),total_gas_used:0}}catch(i){return{success:!1,successful_transactions:[],failed_transactions:t.map(e=>({asset_id:e,error:i instanceof Error?i.message:"Unknown error"})),total_gas_used:0}}}async executeTransactionWithRetry(e,t,a=1){try{const a=await e.transact({actions:t});return{success:!0,transaction_id:a?.transaction_id||a?.id||"",gas_used:a?.cpu_usage_us||a?.max_net_usage_words||0}}catch(s){return a<this.RETRY_ATTEMPTS?(await this.delay(this.RETRY_DELAY*a),this.executeTransactionWithRetry(e,t,a+1)):{success:!1,error:s instanceof Error?s.message:"Transaction failed"}}}createBatches(e,t){const a=[];for(let s=0;s<e.length;s+=t)a.push(e.slice(s,s+t));return a}delay(e){return new Promise(t=>setTimeout(t,e))}async getTemplateRewards(){try{const e=await fetch(`${te.WAX_CHAIN.GREYMASS}/v1/chain/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:this.FARMS_CONTRACT,scope:this.FARMS_CONTRACT,table:"templrewards",limit:1e3})});if(!e.ok)throw new Error("Failed to fetch template rewards");const t=await e.json(),a={};return t.rows.forEach(e=>{const t={pxj:0,wuf:0};e.hourly_rewards&&Array.isArray(e.hourly_rewards)&&e.hourly_rewards.forEach(e=>{const a=parseFloat(e.quantity.split(" ")[0]),s=e.quantity.split(" ")[1];"PXJ"===s&&(t.pxj=a),"WUF"===s&&(t.wuf=a)}),a[e.template_id]=t}),a}catch{return{1001:{pxj:50,wuf:25},1002:{pxj:10,wuf:5},1003:{pxj:2,wuf:1},1004:{pxj:.5,wuf:.25},1005:{pxj:.1,wuf:.05}}}}getRarityMultiplier(e){switch(e.toLowerCase()){case"legendary":return 5;case"epic":return 3;case"rare":return 2;case"uncommon":return 1.5;default:return 1}}calculateStakingPriority(e,t){return 100*this.getRarityMultiplier(e)+10*t}generateOptimizationTips(e,t){const a=[],s=t.reduce((e,t)=>{const a=this.getTemplateRarity(t.template_id);return e[a]=(e[a]||0)+1,e},{});s.Legendary>0&&a.push("Prioritize staking Legendary ingredients for maximum rewards"),s.Epic>5&&a.push("Consider staking Epic ingredients in batches to optimize gas costs"),e.length>20&&a.push("Use batch staking to reduce transaction costs for large collections");return e.reduce((e,t)=>e+t.expected_daily_return,0)>100&&a.push("Your collection has high earning potential - consider staking all eligible NFTs"),0===a.length&&a.push("Stake your highest rarity NFTs first for optimal returns"),a}calculateRewardsPerHour(e){return{1001:{pxj:50,wuf:25},1002:{pxj:10,wuf:5},1003:{pxj:2,wuf:1},1004:{pxj:.5,wuf:.25},1005:{pxj:.1,wuf:.05}}[e]||{pxj:0,wuf:0}}getTemplateRarity(e){return{1001:"Legendary",1002:"Epic",1003:"Rare",1004:"Uncommon",1005:"Common"}[e]||"Common"}},ba=({isOpen:e,onClose:t,templateId:s,templateName:n,action:i,onSuccess:r})=>{const[l,c]=a.useState([]),[o,d]=a.useState([]),[u,m]=a.useState(!1),[p,f]=a.useState(!1),[x,g]=a.useState(null),[v,y]=a.useState(null),{session:j,account:b}=R(),{addNotification:N,showSuccess:w,showError:k}=_e();a.useEffect(()=>{e&&b&&_()},[e,b,s]);const _=async()=>{if(b){m(!0);try{if("stake"===i){const{apiService:e}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),t=`${e.atomicAssetsAPI}/atomicassets/v1/assets?owner=${b}&template_id=${s}&page=1&limit=100&order=desc&sort=asset_id`,a=await e.fetchWithRetry(t),n=await a.json();c(n.data||[])}else{const{apiService:e}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),t=await e.waxRpcCall("/v1/chain/get_table_rows",{json:!0,code:"farms.waxdao",scope:"farms.waxdao",table:"stakers",lower_bound:b,upper_bound:b,limit:1}),a=t.rows.find(e=>e.user===b),s=a?.staked_assets||[];if(0===s.length)c([]);else{const t=await e.fetchWithRetry(`${e.atomicAssetsAPI}/atomicassets/v1/assets?ids=${s.join(",")}&page=1&limit=1000`);if(!t.ok)throw new Error("Failed to fetch asset details");const a=await t.json();c(a.data||[])}}}catch(e){console.error("Error fetching assets:",e),N({type:"error",message:"Failed to load assets"})}finally{m(!1)}}};return e?A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"modal-content nft-staking-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h2",{children:["stake"===i?"Stake":"Unstake"," ",n," NFTs"]}),A.jsx("button",{className:"modal-close",onClick:t,children:"×"})]}),A.jsx("div",{className:"modal-body",children:u?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsxs("p",{children:["Loading your ",n," NFTs..."]})]}):p?A.jsxs("div",{className:"processing-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsxs("p",{children:["stake"===i?"Staking":"Unstaking"," your NFTs..."]}),x&&A.jsxs("div",{className:"batch-progress",children:[A.jsx("div",{className:"progress-bar",children:A.jsx("div",{className:"progress-fill",style:{width:x.current/x.total*100+"%"}})}),A.jsxs("p",{children:["Processing ",x.current," of ",x.total," NFTs"]})]}),v&&A.jsxs("div",{className:"transaction-results",children:[A.jsxs("div",{className:"results-summary",children:[A.jsxs("div",{className:"success-count",children:["✅ ",v.successful_transactions.length," successful"]}),v.failed_transactions.length>0&&A.jsxs("div",{className:"error-count",children:["❌ ",v.failed_transactions.length," failed"]})]}),v.failed_transactions.length>0&&A.jsxs("div",{className:"failed-transactions",children:[A.jsx("h4",{children:"Failed Transactions:"}),v.failed_transactions.slice(0,5).map(e=>A.jsxs("div",{className:"failure-item",children:[A.jsxs("span",{children:["#",e.asset_id]}),A.jsx("span",{className:"error-message",children:e.error})]},e.asset_id)),v.failed_transactions.length>5&&A.jsxs("p",{children:["... and ",v.failed_transactions.length-5," more"]})]})]})]}):A.jsxs(A.Fragment,{children:[A.jsxs("div",{className:"selection-controls",children:[A.jsx("button",{className:"btn btn-secondary",onClick:()=>{o.length===l.length?d([]):d(l.map(e=>e.asset_id))},children:o.length===l.length?"Deselect All":"Select All"}),A.jsxs("span",{className:"selection-count",children:[o.length," of ",l.length," selected"]})]}),A.jsx("div",{className:"asset-grid",children:0===l.length?A.jsx("div",{className:"no-assets",children:A.jsxs("p",{children:["No ",n," NFTs available to ",i]})}):l.map(e=>A.jsxs("div",{className:"asset-item "+(o.includes(e.asset_id)?"selected":""),onClick:()=>{return t=e.asset_id,void d(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},children:[A.jsx($t,{src:e.image||`https://ipfs.io/ipfs/${e.data?.img||"placeholder"}`,alt:e.name}),A.jsxs("div",{className:"asset-id",children:["#",e.asset_id]}),o.includes(e.asset_id)&&A.jsx("div",{className:"selection-indicator",children:"✓"})]},e.asset_id))})]})}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"btn btn-secondary",onClick:t,children:"Cancel"}),A.jsx("button",{className:"btn btn-primary",onClick:async()=>{if(j&&0!==o.length){f(!0),g({current:0,total:o.length}),y(null);try{let e;if(e="stake"===i?await ja.stakeNFTsBatch(j,o,"pixeljourney"):await ja.unstakeNFTsBatch(j,o),y(e),e.success)w("Transaction Successful",`Successfully ${i}d ${e.successful_transactions.length} ${n} NFT${e.successful_transactions.length>1?"s":""}`),setTimeout(()=>{r?.(),t()},2e3);else{const t=e.successful_transactions.length,a=e.failed_transactions.length;t>0?w("Partial Success",`${t} NFTs ${i}d successfully, ${a} failed`):k("Transaction Failed",`Failed to ${i} NFTs. Please try again.`)}}catch(e){console.error(`Error ${i}ing NFTs:`,e);const t=e instanceof Error?e.message:`Failed to ${i} NFTs`;k("Transaction Error",t)}finally{f(!1),g(null)}}},disabled:0===o.length||p,children:p?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"loading-spinner"}),"stake"===i?"Staking...":"Unstaking..."]}):`${"stake"===i?"Stake":"Unstake"} ${o.length} NFT${1!==o.length?"s":""}`})]})]})}):null},Na=e=>({PXJ:"/img/tokens/pxj.png",WUF:"/img/tokens/wuf.png",WAX:"/img/tokens/wax.png",PIXAL:"/img/tokens/pixal.png"}[e.toUpperCase()]||"/img/tokens/default.png"),wa=({isOpen:e,onClose:t,action:s,farmName:n="pxjfarm1",onSuccess:i})=>{const{session:r}=R(),{showSuccess:l,showError:c}=_e(),[o,d]=a.useState(""),[u,m]=a.useState(!1),[h,p]=a.useState(null),[f,x]=a.useState(null),[g,v]=a.useState(0),[y,j]=a.useState(!1),b=a.useCallback(async()=>{if(r){j(!0);try{const e=await ja.getTokenFarmInfo(n);p(e);const t=await ja.getTokenStakingInfo(r.actor.toString(),n);x(t);const a=await fetch("https://wax.greymass.com/v1/chain/get_currency_balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"pixeljourney",account:r.actor.toString(),symbol:"PXJ"})});if(a.ok){const e=await a.json(),t=e.length>0?parseFloat(e[0].split(" ")[0]):0;v(t)}}catch(e){console.error("Error fetching data:",e),c("Failed to load staking data")}finally{j(!1)}}},[r,j,n,p,x,v,c]);a.useEffect(()=>{e&&r&&b()},[e,r,n,b]);const N=e=>e.toLocaleString(void 0,{minimumFractionDigits:4,maximumFractionDigits:4});if(!e)return null;return A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"modal-content token-staking-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h3",{children:(()=>{switch(s){case"stake":return"Stake PXJ Tokens";case"unstake":return"Unstake PXJ Tokens";case"claim":return"Claim Rewards";default:return"Token Staking"}})()}),A.jsx("button",{className:"close-btn",onClick:t,children:"×"})]}),A.jsx("div",{className:"modal-body",children:y?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading staking data..."})]}):A.jsxs(A.Fragment,{children:[h&&A.jsxs("div",{className:"farm-info-section",children:[A.jsx("h4",{children:"Farm Information"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"label",children:"Farm:"}),A.jsx("span",{className:"value",children:h.farm_name})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"label",children:"Total Staked:"}),A.jsxs("span",{className:"value",children:[N(h.total_staked)," PXJ"]})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"label",children:"Vesting Period:"}),A.jsxs("span",{className:"value",children:[Math.floor(h.vesting_time/86400)," days"]})]})]})]}),f&&A.jsxs("div",{className:"user-stake-info",children:[A.jsx("h4",{children:"Your Staking Position"}),A.jsxs("div",{className:"info-grid",children:[A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"label",children:"Staked Amount:"}),A.jsxs("span",{className:"value",children:[N(f.staked_amount)," PXJ"]})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"label",children:"Pending Rewards:"}),A.jsx("span",{className:"value",children:f.pending_rewards.map(e=>`${N(e.amount)} ${e.token}`).join(", ")||"None"})]}),A.jsxs("div",{className:"info-item",children:[A.jsx("span",{className:"label",children:"Unlock Time:"}),A.jsx("span",{className:"value",children:(e=>{const t=e-Date.now()/1e3;if(t<=0)return"Available now";const a=Math.floor(t/86400),s=Math.floor(t%86400/3600),n=Math.floor(t%3600/60);return a>0?`${a}d ${s}h remaining`:s>0?`${s}h ${n}m remaining`:`${n}m remaining`})(f.vesting_time)})]})]})]}),A.jsx("div",{className:"balance-info",children:A.jsxs("div",{className:"balance-item",children:[A.jsx(Mt,{src:Na("PXJ"),alt:"PXJ"}),A.jsxs("span",{children:["Available: ",N(g)," PXJ"]})]})}),A.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),r&&!u)if("claim"===s||o&&!(parseFloat(o)<=0))if("stake"===s&&parseFloat(o)>g)c("Insufficient PXJ balance");else if("unstake"===s&&f&&parseFloat(o)>f.staked_amount)c("Amount exceeds staked balance");else{m(!0);try{let e;const a=`${parseFloat(o).toFixed(4)} PXJ`;switch(s){case"stake":e=await ja.stakeTokens(r,a,n);break;case"unstake":e=await ja.unstakeTokens(r,a,n);break;case"claim":e=await ja.claimTokenFarmRewards(r,n);break;default:throw new Error("Invalid action")}e.success?(l(`Successfully ${"stake"===s?"staked":"unstake"===s?"unstaked":"claimed"} tokens!`),i?.(),t()):c(e.error||`Failed to ${s} tokens`)}catch(a){console.error(`Error ${s}ing tokens:`,a),c(a instanceof Error?a.message:`Failed to ${s} tokens`)}finally{m(!1)}}else c("Please enter a valid amount")},className:"staking-form",children:["claim"!==s&&A.jsxs("div",{className:"form-group",children:[A.jsx("label",{htmlFor:"amount",children:"Amount (PXJ)"}),A.jsxs("div",{className:"input-group",children:[A.jsx("input",{type:"number",id:"amount",value:o,onChange:e=>d(e.target.value),placeholder:"0.0000",step:"0.0001",min:"0",max:"stake"===s?g:f?.staked_amount||0,required:!0,disabled:u}),A.jsx("button",{type:"button",className:"max-btn",onClick:()=>{d(("stake"===s?g:f?.staked_amount||0).toFixed(4))},disabled:u,children:"MAX"})]})]}),"claim"===s&&f&&f.pending_rewards.length>0&&A.jsxs("div",{className:"rewards-preview",children:[A.jsx("h4",{children:"Rewards to Claim:"}),A.jsx("div",{className:"rewards-list",children:f.pending_rewards.map((e,t)=>A.jsxs("div",{className:"reward-item",children:[A.jsx(Mt,{src:Na(e.token),alt:e.token}),A.jsxs("span",{children:[N(e.amount)," ",e.token]})]},t))})]}),A.jsxs("div",{className:"form-actions",children:[A.jsx("button",{type:"button",className:"btn btn-secondary",onClick:t,disabled:u,children:"Cancel"}),A.jsx("button",{type:"submit",className:"btn btn-primary",disabled:u||"claim"!==s&&!o,children:(()=>{if(u)return"Processing...";switch(s){case"stake":return"Stake Tokens";case"unstake":return"Unstake Tokens";case"claim":return"Claim Rewards";default:return"Submit"}})()})]})]})]})})]})})},ka=async(e,t)=>{try{const t=await ye.getSales({template:e,limit:10});if(t&&t.data.length>0){const e=t.data.reduce((e,t)=>e+parseFloat(t.price?.amount||"0"),0)/t.data.length;return Math.floor(100*e)}}catch(a){G("Could not fetch template sales data","Staking",a)}return{Common:1e3,Uncommon:2500,Rare:5e3,Epic:15e3,Legendary:5e4}[t]||1e3},_a=async e=>{try{const t=await ye.getSales({template:e,limit:5});if(t&&t.data.length>0){const e=t.data.map(e=>parseFloat(e.price?.amount||"0")),a=Math.min(...e.filter(e=>e>0));return Math.floor(a)}}catch(t){G("Could not fetch template listings","Staking",t)}return 50},Sa=({template:e,isOpen:t,onClose:a})=>t&&e?A.jsx("div",{className:"modal-overlay",onClick:a,children:A.jsxs("div",{className:"modal-content quick-buy-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsxs("h3",{children:["Quick Buy - ",e.name]}),A.jsx("button",{className:"close-btn",onClick:a,children:"×"})]}),A.jsx("div",{className:"modal-body",children:A.jsxs("div",{className:"buy-item-preview",children:[A.jsx($t,{src:e.image,alt:e.name}),A.jsxs("div",{className:"item-details",children:[A.jsx("h4",{children:e.name}),A.jsx("p",{className:"rarity",children:e.rarity}),A.jsxs("p",{className:"price",children:[e.market_price||"N/A"," WAX"]}),A.jsxs("p",{className:"available",children:[e.available_for_sale||0," available"]})]})]})}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"}),A.jsx("button",{className:"btn btn-primary",children:"Buy Now"})]})]})}):null,Ca=()=>{const{session:e,isConnected:t,login:s}=R(),{showSuccess:i,showError:r}=_e(),[l,c]=a.useState(!1),[o,d]=a.useState([]),[u,m]=a.useState({pxj:0,wuf:0}),[p,f]=a.useState(!1),[x,g]=a.useState(0),[v,y]=a.useState(null),[j,b]=a.useState(!1),[N,w]=a.useState(!1),[k,_]=a.useState(!1),[S,C]=a.useState(null),[E,P]=a.useState(!1),[T,I]=a.useState(null),[F,$]=a.useState(null),[L,M]=a.useState(!1),[W,O]=a.useState("stake"),[D,B]=a.useState(!1),[U,z]=a.useState(0),X=a.useMemo(()=>[{template_id:"1001",name:"Black Ingredient",type:"Legendary",rarity:"Legendary",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:50,wuf:25},estimated_value:1e5,apr:120,market_price:2500,available_for_sale:3},{template_id:"1002",name:"Tertiary Ingredient",type:"Epic",rarity:"Epic",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:10,wuf:5},estimated_value:25e3,apr:80,market_price:500,available_for_sale:12},{template_id:"1003",name:"Secondary Ingredient",type:"Rare",rarity:"Rare",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:2,wuf:1},estimated_value:5e3,apr:40,market_price:100,available_for_sale:25},{template_id:"1004",name:"Primary Ingredient",type:"Common",rarity:"Common",image:"",owned_count:0,staked_count:0,rewards_per_hour:{pxj:.1,wuf:.05},estimated_value:1e3,apr:10,market_price:25,available_for_sale:50}],[]),H=a.useCallback(async()=>{f(!0);try{if(!e)return d(X),void f(!1);try{const{apiService:t}=await h(async()=>{const{apiService:e}=await Promise.resolve().then(()=>je);return{apiService:e}},void 0),a=await t.fetchWithRetry(`${t.atomicAssetsAPI}/atomicassets/v1/templates?collection_name=pixeljourney&schema_name=ingredients&page=1&limit=100&order=desc&sort=created`);if(!a.ok)throw new Error("AtomicAssets API failed");const s=await a.json(),n=s.data.slice(0,10).map(e=>e.template_id),i=await t.getAssetCountsBatch(n,e.actor.toString()),r=(await Promise.all(s.data.slice(0,10).map(async t=>{try{const s=i.data[t.template_id]||0;let n=0;try{const t=await fetch("https://wax.greymass.com/v1/chain/get_table_rows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({json:!0,code:"farms.waxdao",scope:"farms.waxdao",table:"stakers",lower_bound:e.actor,upper_bound:e.actor,limit:1})});if(t.ok){const a=(await t.json()).rows.find(t=>t.user===e.actor.toString());n=(a?.staked_assets||[]).length}}catch(a){G("Failed to fetch staked count for template","Staking",{templateId:t.template_id,error:a})}const r=String(t.immutable_data?.rarity||"Common");let l=.1,c=5;switch(r.toLowerCase()){case"legendary":l=50,c=120;break;case"epic":l=10,c=80;break;case"rare":l=2,c=40;break;case"uncommon":l=.5,c=20;break;default:l=.1,c=10}return{template_id:t.template_id,name:t.immutable_data?.name||`Template ${t.template_id}`,type:t.immutable_data?.type||r,rarity:r,image:t.immutable_data?.img?`https://ipfs.io/ipfs/${t.immutable_data.img}`:"",owned_count:s,staked_count:n,rewards_per_hour:{pxj:l,wuf:.5*l},estimated_value:await ka(t.template_id,r),apr:c,market_price:await _a(t.template_id),available_for_sale:Math.floor(20*Math.random())+1}}catch(a){return K("Error processing template","Staking",a),null}}))).filter(e=>null!==e);d(r.length>0?r:X),i.errors.length>0&&G("Some template counts could not be fetched","Staking",{errors:i.errors})}catch(t){G("API fetch failed, using default templates","Staking",t),d(X)}}catch(a){K("Failed to fetch NFT templates","Staking",a),d(X)}finally{f(!1)}},[e,f,d,X]),q=a.useCallback(async()=>{if(e)try{const t=await ja.getStakingInfo(e.actor.toString()),a=t.pending_rewards.reduce((e,t)=>("PXJ"===t.token?e.pxj=t.amount:"WUF"===t.token&&(e.wuf=t.amount),e),{pxj:0,wuf:0});m(a),g(t.total_staking_power);const s=o.map(e=>{const a=t.staked_nfts.filter(t=>t.template_id===e.template_id);return{...e,staked_count:a.length,rewards_per_hour:a.length>0?a[0].rewards_per_hour:e.rewards_per_hour}});d(s)}catch(t){K("Failed to fetch rewards","Staking",t);const a=Date.now(),s=localStorage.getItem(`lastClaimTime_${e.actor}`)||a.toString(),n=(a-parseInt(s))/1e3/3600,i=o.reduce((e,t)=>{const a=t.staked_count*t.rewards_per_hour.pxj*Math.floor(n),s=t.staked_count*t.rewards_per_hour.wuf*Math.floor(n);return{pxj:e.pxj+a,wuf:e.wuf+s}},{pxj:0,wuf:0});m(i)}},[e,o,m,g,d]),J=a.useCallback(async()=>{if(e){B(!0);try{const t=await ja.getTokenFarmInfo("pxjfarm1");$(t);const a=await ja.getTokenStakingInfo(e.actor.toString(),"pxjfarm1");I(a);const s=await fetch("https://wax.greymass.com/v1/chain/get_currency_balance",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"pixeljourney",account:e.actor.toString(),symbol:"PXJ"})});if(s.ok){const e=await s.json(),t=e.length>0?parseFloat(e[0].split(" ")[0]):0;z(t)}}catch(t){K("Failed to fetch token staking data","Staking",t)}finally{B(!1)}}},[e,B,$,I,z]),V=e=>{O(e),M(!0)},Y=e=>{C(e),_(!0)},Q=()=>{_(!1),C(null)},Z=e=>{switch(e.toLowerCase()){case"legendary":return"#f59e0b";case"epic":return"#8b5cf6";case"rare":return"#3b82f6";case"uncommon":return"#10b981";default:return"#6b7280"}};return a.useEffect(()=>{H(),e&&(q(),J())},[e,H,q,J]),a.useEffect(()=>{const t=setInterval(()=>{e&&(q(),J())},3e4);return()=>clearInterval(t)},[e,o,q,J]),a.useEffect(()=>{const e=o.reduce((e,t)=>e+t.staked_count*(t.rewards_per_hour.pxj+t.rewards_per_hour.wuf),0);g(e)},[o]),t?A.jsxs("div",{className:"staking-container",children:[A.jsx("div",{className:"staking-header",children:A.jsxs("div",{className:"header-content",children:[A.jsx("h1",{children:"NFT Staking Dashboard"}),A.jsxs("button",{className:"refresh-btn",onClick:async()=>{c(!0),await Promise.all([H(),q(),J()]),c(!1)},disabled:l,children:[l?"🔄":"↻"," Refresh"]})]})}),A.jsxs("div",{className:"stats-bar",style:{display:"none"},children:[A.jsxs("div",{className:"stat",children:[A.jsx(Mt,{src:"/img/tokens/pxj.png",alt:"PXJ"}),A.jsx("span",{children:"PXJ Balance: 0"})]}),A.jsxs("div",{className:"stat",children:[A.jsx(Mt,{src:"/img/tokens/wuf.png",alt:"WUF"}),A.jsx("span",{children:"WUF Balance: 0"})]})]}),A.jsxs("div",{className:"dashboard-row",children:[A.jsxs("div",{className:"rewards-section",id:"rewardsSection",style:{display:u.pxj>0||u.wuf>0?"block":"none"},children:[A.jsxs("div",{className:"rewards-header",children:[A.jsx("h3",{children:"Claimable Rewards"}),A.jsx("div",{className:"simulation-toggle",onClick:()=>P(!E),children:A.jsx("div",{className:"toggle "+(E?"active":"")})})]}),A.jsxs("div",{id:"claimableRewards",children:[u.pxj.toFixed(2)," PXJ + ",u.wuf.toFixed(2)," WUF"]}),A.jsx("button",{className:"claim-btn",onClick:async()=>{if(e)if(0!==u.pxj||0!==u.wuf){c(!0);try{const t=await ja.claimAllRewards(e,"pixeljourney");if(t.success){const t=`PXJ: ${u.pxj.toFixed(1)} | WUF: ${u.wuf.toFixed(1)}`;i("Success",`Rewards claimed successfully! ${t}`),m({pxj:0,wuf:0}),await q();const a=Date.now();localStorage.setItem(`lastClaimTime_${e.actor}`,a.toString())}else r("Error",t.error||"Failed to claim rewards")}catch(t){K("Failed to claim rewards","Staking",t),r("Error","Failed to claim rewards. Please try again.")}finally{c(!1)}}else r("Error","No rewards available to claim");else r("Error","Please connect your wallet first")},disabled:l,children:l?"Claiming...":"Claim All Rewards"}),E&&A.jsx("div",{className:"simulation-status",children:"🔴 SIMULATION MODE ACTIVE"})]}),A.jsxs("div",{className:"quick-claim-section",children:[A.jsx("h4",{children:"Quick Actions"}),A.jsx("button",{className:"quick-claim-btn",onClick:()=>w(!0),children:"Open Crafting"})]})]}),x>0&&A.jsxs("div",{className:"total-power",children:[A.jsx("h3",{children:"Total Staking Power"}),A.jsxs("div",{className:"power-value-container",children:[A.jsx("div",{className:"power-value",children:x.toFixed(1)}),A.jsx("div",{className:"power-rate",children:"/hr"})]}),A.jsx("p",{children:"Combined rewards per hour from all staked NFTs"})]}),A.jsxs("div",{className:"token-staking-section",children:[A.jsxs("div",{className:"token-staking-header",children:[A.jsx("h2",{children:"PXJ Token Staking"}),A.jsx("p",{className:"section-description",children:"Stake your PXJ tokens in the pxjfarm1 to earn additional rewards"})]}),D?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading token staking data..."})]}):A.jsxs("div",{className:"token-staking-content",children:[F&&A.jsxs("div",{className:"token-farm-card",children:[A.jsxs("div",{className:"farm-header",children:[A.jsx("div",{className:"farm-icon",children:A.jsx(Mt,{src:"/img/tokens/pxj.png",alt:"PXJ"})}),A.jsxs("div",{className:"farm-info",children:[A.jsx("h3",{children:F.farm_name}),A.jsx("p",{className:"farm-description",children:"PXJ Token Farm"})]})]}),A.jsxs("div",{className:"farm-stats",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-label",children:"Total Staked"}),A.jsxs("div",{className:"stat-value",children:[F.total_staked.toLocaleString()," PXJ"]})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-label",children:"Vesting Period"}),A.jsxs("div",{className:"stat-value",children:[Math.floor(F.vesting_time/86400)," days"]})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-label",children:"Your Balance"}),A.jsxs("div",{className:"stat-value",children:[U.toLocaleString()," PXJ"]})]})]}),T&&A.jsxs("div",{className:"user-position",children:[A.jsx("h4",{children:"Your Staking Position"}),A.jsxs("div",{className:"position-stats",children:[A.jsxs("div",{className:"position-item",children:[A.jsx("span",{className:"label",children:"Staked:"}),A.jsxs("span",{className:"value",children:[T.staked_amount.toLocaleString()," PXJ"]})]}),A.jsxs("div",{className:"position-item",children:[A.jsx("span",{className:"label",children:"Pending Rewards:"}),A.jsx("span",{className:"value",children:T.pending_rewards.length>0?T.pending_rewards.map(e=>`${e.amount.toFixed(4)} ${e.token}`).join(", "):"None"})]}),A.jsxs("div",{className:"position-item",children:[A.jsx("span",{className:"label",children:"Unlock Time:"}),A.jsx("span",{className:"value",children:T.vesting_time>Date.now()/1e3?`${Math.ceil((T.vesting_time-Date.now()/1e3)/86400)} days remaining`:"Available now"})]})]})]}),A.jsxs("div",{className:"token-actions",children:[A.jsx("button",{className:"btn btn-primary",onClick:()=>V("stake"),disabled:!t||U<=0,children:"Stake PXJ"}),A.jsx("button",{className:"btn btn-secondary",onClick:()=>V("unstake"),disabled:!t||!T||T.staked_amount<=0,children:"Unstake PXJ"}),A.jsx("button",{className:"btn btn-accent",onClick:()=>V("claim"),disabled:!t||!T||0===T.pending_rewards.length,children:"Claim Rewards"})]})]}),!t&&A.jsxs("div",{className:"connect-prompt",children:[A.jsx("h3",{children:"Connect Your Wallet"}),A.jsx("p",{children:"Connect your WAX wallet to view and manage your PXJ token staking"}),A.jsx("button",{className:"btn btn-primary",onClick:s,children:"Connect Wallet"})]})]})]}),A.jsxs("div",{className:"nft-staking-section",children:[A.jsxs("div",{className:"nft-staking-header",children:[A.jsx("h2",{children:"Pixel Journey NFT Staking"}),A.jsx("p",{className:"section-description",children:"Stake your ingredients to earn PXJ and WUF rewards"})]}),p?A.jsxs("div",{className:"loading-state",children:[A.jsx("div",{className:"loading-spinner"}),A.jsx("p",{children:"Loading NFT staking data..."})]}):A.jsx("div",{className:"template-grid",children:o.map(e=>A.jsxs("div",{className:"template-card",children:[A.jsxs("div",{className:"template-image",style:{backgroundImage:`url(${e.image})`},children:[e.owned_count>0&&A.jsx("div",{className:"asset-count",children:e.owned_count}),e.staked_count>0&&A.jsxs("div",{className:"staked-count",children:["⚡",e.staked_count]}),A.jsx("div",{className:"rarity-badge",style:{backgroundColor:Z(e.rarity)},children:e.rarity}),e.image.includes("placeholder")?e.name:null]}),A.jsxs("div",{className:"template-info",children:[A.jsxs("div",{className:"template-header",children:[A.jsx("div",{className:"template-name",children:e.name}),A.jsxs("div",{className:"template-apr",children:[e.apr,"% APR"]})]}),A.jsxs("div",{className:"template-stats",children:[A.jsxs("div",{className:"stat-row",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:e.rewards_per_hour.pxj}),A.jsx("div",{className:"stat-label",children:"PXJ/hr"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:e.rewards_per_hour.wuf}),A.jsx("div",{className:"stat-label",children:"WUF/hr"})]})]}),A.jsx("div",{className:"staking-status",children:A.jsxs("span",{children:["Staked: ",e.staked_count,"/",e.owned_count]})})]}),A.jsx("div",{className:"template-actions",children:e.owned_count>0?A.jsx("button",{className:"btn btn-primary",onClick:()=>(e=>{y(e),b(!0)})(e),children:"Manage Staking"}):A.jsx("button",{className:"btn btn-secondary",onClick:()=>Y(e),children:"Quick Buy"})})]})]},e.template_id))})]}),A.jsxs("div",{className:"crafting-mechanics",children:[A.jsx("h2",{children:"PXJ Lockup & Crafting Mechanics"}),A.jsxs("div",{className:"mechanics-content",children:[A.jsxs("div",{className:"mechanics-overview",children:[A.jsx("h3",{children:"🔒 PXJ Lockup System"}),A.jsx("p",{children:"Lock your PXJ tokens to participate in advanced crafting and upgrade systems. Each month, we distribute additional NFT rewards to collectors based on their PXJ lockup value."}),A.jsx("div",{className:"leaderboard-info",children:A.jsxs("div",{className:"leaderboard-card",children:[A.jsxs("div",{className:"leaderboard-header",children:[A.jsx("span",{className:"leaderboard-icon",children:"🏆"}),A.jsx("h4",{children:"Monthly Leaderboard Rewards"})]}),A.jsxs("div",{className:"leaderboard-details",children:[A.jsxs("p",{children:[A.jsx("strong",{children:"Entry Requirement:"})," 25,000 PXJ locked per entry"]}),A.jsx("p",{children:"Rewards distributed based on upgraded ingredient lockup value"}),A.jsx("a",{href:"https://lb.pixeljourney.xyz/",target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",children:"View Leaderboard"})]})]})})]}),A.jsxs("div",{className:"crafting-process",children:[A.jsx("h3",{children:"⚗️ Ingredient Combination System"}),A.jsxs("div",{className:"process-flow",children:[A.jsxs("div",{className:"process-step",children:[A.jsx("div",{className:"step-icon",children:"🧪"}),A.jsx("h4",{children:"Primary Ingredients"}),A.jsx("p",{children:"Common base materials that form the foundation of all crafting recipes"})]}),A.jsx("div",{className:"process-arrow",children:"→"}),A.jsxs("div",{className:"process-step",children:[A.jsx("div",{className:"step-icon",children:"⚡"}),A.jsx("h4",{children:"Secondary Ingredients"}),A.jsx("p",{children:"Rare catalysts that enhance and modify the properties of primary ingredients"})]}),A.jsx("div",{className:"process-arrow",children:"→"}),A.jsxs("div",{className:"process-step",children:[A.jsx("div",{className:"step-icon",children:"💎"}),A.jsx("h4",{children:"Tertiary Ingredients"}),A.jsx("p",{children:"Epic components that unlock powerful abilities and unique traits"})]}),A.jsx("div",{className:"process-arrow",children:"→"}),A.jsxs("div",{className:"process-step",children:[A.jsx("div",{className:"step-icon",children:"🌟"}),A.jsx("h4",{children:"Black Ingredients"}),A.jsx("p",{children:"Legendary materials that create the most powerful and sought-after items"})]})]})]}),A.jsx("div",{className:"learn-more-section",children:A.jsxs("div",{className:"learn-more-card",children:[A.jsx("h3",{children:"📚 Want to Learn More?"}),A.jsx("p",{children:"Dive deeper into the Pixel Journey ecosystem with our comprehensive documentation covering all aspects of crafting, staking, and gameplay mechanics."}),A.jsxs("div",{className:"learn-actions",children:[A.jsx(n,{to:"/learn",className:"btn-primary",children:"Visit Learn Page"}),A.jsx("a",{href:"https://docs.pixeljourney.xyz/season-1/recycling-and-crafting",target:"_blank",rel:"noopener noreferrer",className:"btn-secondary",children:"Journey Docs"})]})]})})]})]}),A.jsx(ba,{isOpen:j,onClose:()=>{b(!1),y(null)},templateId:v?.template_id||"",templateName:v?.name||"",action:"stake",onSuccess:()=>{H(),q()}}),A.jsx(wa,{isOpen:L,onClose:()=>{M(!1)},action:W,farmName:"pxjfarm1",onSuccess:()=>{J(),q()}}),A.jsx(yt,{isOpen:N,onClose:()=>w(!1),ingredient:null}),A.jsx(Sa,{template:S,isOpen:k,onClose:Q})]}):A.jsxs("div",{className:"staking-container",children:[A.jsxs("div",{className:"connect-wallet-prompt",children:[A.jsx("h2",{children:"Connect Your Wallet"}),A.jsx("p",{children:"Connect your WAX wallet to access NFT staking features"}),A.jsx("button",{className:"btn btn-primary",onClick:s,children:"Connect Wallet"})]}),A.jsxs("div",{className:"nft-staking-section",children:[A.jsx("h2",{children:"Pixel Journey NFT Staking"}),A.jsx("p",{className:"section-description",children:"Stake your Pixel Journey ingredients to earn PXJ and WUF rewards"}),A.jsx("div",{className:"template-grid",children:X.map(e=>A.jsxs("div",{className:"template-card",children:[A.jsxs("div",{className:"template-image",children:[A.jsx($t,{src:e.image,alt:e.name,width:160,height:160,fallbackText:e.name}),A.jsx("div",{className:"rarity-badge",style:{backgroundColor:Z(e.rarity)},children:e.rarity})]}),A.jsxs("div",{className:"template-info",children:[A.jsxs("div",{className:"template-header",children:[A.jsx("div",{className:"template-name",children:e.name}),A.jsxs("div",{className:"template-apr",children:[e.apr,"% APR"]})]}),A.jsxs("div",{className:"template-stats",children:[A.jsxs("div",{className:"stat-row",children:[A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:e.rewards_per_hour.pxj}),A.jsx("div",{className:"stat-label",children:"PXJ/hr"})]}),A.jsxs("div",{className:"stat-item",children:[A.jsx("div",{className:"stat-value",children:e.rewards_per_hour.wuf}),A.jsx("div",{className:"stat-label",children:"WUF/hr"})]})]}),A.jsx("div",{className:"staking-status",children:A.jsx("span",{children:"Connect wallet to view your assets"})})]}),A.jsx("div",{className:"template-actions",children:A.jsx("button",{className:"btn btn-secondary",onClick:()=>Y(e),children:"Quick Buy"})})]})]},e.template_id))})]}),A.jsx(Sa,{template:S,isOpen:k,onClose:Q})]})};const Aa=new class{WAX_API_BASE="https://wax.eosrio.io/v1/chain";ATOMIC_API_BASE="https://wax-api.hivebp.io/api";async getFeeTokens(){for(let t=1;t<=3;t++)try{const e=new AbortController,t=setTimeout(()=>e.abort(),1e4),a=await fetch(`${this.WAX_API_BASE}/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"rwax",scope:"rwax",table:"feetokens",json:!0,limit:100}),signal:e.signal});if(clearTimeout(t),!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const s=await a.json();if(!s.rows||!Array.isArray(s.rows))return K("Invalid fee tokens response structure:",s),[];const n=s.rows.map(e=>{const t=e.fee.match(/([0-9.]+)\s+([A-Z]+)/),a=t?t[2]:"UNKNOWN",s=t?t[1]:"0";let n;if("WAX"!==a&&e.exchange_rate){const t=parseFloat(e.exchange_rate),a=parseFloat(s);isNaN(t)||isNaN(a)||(n=(a/t).toFixed(8))}return{fee:e.fee,contract:e.contract,exchange_rate:e.exchange_rate,symbol:a,amount:s,wax_value:n}});return V(`Successfully fetched ${n.length} fee tokens with WAX conversions`),n}catch(e){if(K(`Attempt ${t} failed to fetch fee tokens:`,e instanceof Error?e.message:String(e)),3===t)throw new Error(`Failed to fetch fee tokens after 3 attempts: ${e}`);await new Promise(e=>setTimeout(e,1e3))}return[]}async getAssetPoolInfo(e){for(let a=1;a<=3;a++)try{const t=new AbortController,a=setTimeout(()=>t.abort(),1e4),s=await fetch(`${this.WAX_API_BASE}/get_table_rows`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:"rwax",scope:"WPIXAL",table:"assetpools",json:!0,limit:1,lower_bound:e,upper_bound:e,key_type:"i64"}),signal:t.signal});if(clearTimeout(a),!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const n=await s.json();if(!n.rows||!Array.isArray(n.rows)||0===n.rows.length)return null;const i=n.rows[0];return{assetId:i.asset_id,issuedTokens:i.issued_tokens}}catch(t){if(K(`Attempt ${a} failed to fetch asset pool info for ${e}:`,t instanceof Error?t.message:String(t)),3===a)return K(`Failed to fetch asset pool info after 3 attempts: ${t}`),null;await new Promise(e=>setTimeout(e,1e3))}return null}async getTokenizedAssets(e=36,t=0,a="rarity_score_desc",s=""){let n=null;for(let r=1;r<=3;r++)try{const n=new URLSearchParams({term:"",owner:"rwax",collection:"pixeljourney",schema:"pixals",category:"",recent:"",order_by:a,limit:e.toString(),search_type:"inventory",offer_type:"sales",min_price:"0",max_price:"0",offset:t.toString(),verified:"all",favorites:"false",user:"pixeljourney",contract:"",attributes:s,only:"rwax",rwax_contract:"pixeljourney",rwax_symbol:"WPIXAL"}),i=`${this.ATOMIC_API_BASE}/assets?${n.toString()}`;V(`Fetching tokenized assets from: ${i}`,"RWaxService");const r=await fetch(i,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);const l=await r.json();return console.log("RWAX API Response:",l),Array.isArray(l)?l:[]}catch(i){if(n=i instanceof Error?i:new Error(String(i)),K(`Attempt ${r}/3 failed:`,"RWaxService.getTokenizedAssets",n),3===r){console.log("API failed, returning test data with original structure");return[{assetId:1099932947523,name:"Pixal 09106",schema:"pixals",owner:"rwax",burned:!1,mint:9106,contract:"atomicassets",collection:{collectionName:"pixeljourney",displayName:"Pixel Journey",collectionImage:"QmVnrLdB1xQ9EMzgw5srW6u8WKQpTjmYz6fBi2g7ic8iob",verification:!0,blacklisted:!1},transferable:!0,burnable:!0,mutableData:[],immutableData:[{key:"Background",value:["string","Nefty Spot"]},{key:"Body",value:["string","Pink-Blue Overalls"]},{key:"Eyes",value:["string","Kawaii Green"]},{key:"Head",value:["string","Grey"]},{key:"img",value:["string","Qma9rcg1NHxhvG5CMDecS3bo14gpQSr6QFieUXsFPrG14T"]},{key:"name",value:["string","Pixal 09106"]}],rarityScore:419.80619503583694,attributesFloor:501,rwax:{symbol:"WPIXAL",contract:"pixeljourney",decimals:8,tokenName:"Wrapped Pixal",redeemAmount:1.09997216},image:"Qma9rcg1NHxhvG5CMDecS3bo14gpQSr6QFieUXsFPrG14T",template:{templateId:781515}},{assetId:1099931322703,name:"Pixal 06238",schema:"pixals",owner:"rwax",burned:!1,mint:6238,contract:"atomicassets",collection:{collectionName:"pixeljourney",displayName:"Pixel Journey",verification:!0,blacklisted:!1},transferable:!0,burnable:!0,mutableData:[],immutableData:[{key:"Background",value:["string","Blue Sky"]},{key:"Body",value:["string","Red Shirt"]},{key:"Eyes",value:["string","Brown"]},{key:"Head",value:["string","Black Hair"]},{key:"img",value:["string","QmTestImage2"]},{key:"name",value:["string","Pixal 06238"]}],rarityScore:350.5,attributesFloor:400,rwax:{symbol:"WPIXAL",contract:"pixeljourney",decimals:8,tokenName:"Wrapped Pixal",redeemAmount:1.25},image:"QmTestImage2",template:{templateId:781516}}].slice(t,t+e)}}throw n||new Error("Failed to fetch tokenized assets")}async getAssetWPIXALAmount(e){try{const t=`${this.WAX_API_BASE}/get_table_rows`,a={code:"pixeljourney",index_position:"primary",json:!0,key_type:"i64",limit:1,reverse:!1,lower_bound:e,upper_bound:e,scope:"pixeljourney",show_payer:!1,table:"assetpools",table_key:""},s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!s.ok)throw new Error(`Failed to fetch WPIXAL amount: ${s.statusText}`);const n=await s.json();return n.rows&&n.rows.length>0?n.rows[0].issued_tokens:"0.00000000 WPIXAL"}catch(t){return K("Error fetching WPIXAL amount:","RWaxService.getAssetWPIXALAmount",t instanceof Error?t:new Error(String(t))),"0.00000000 WPIXAL"}}async getUserPixalAssets(e,t=36,a=0){let s=null;for(let i=1;i<=3;i++)try{const s=`https://wax.api.atomicassets.io/atomicassets/v1/assets?owner=${e}&collection_name=pixeljourney&schema_name=pixals&limit=${t}&page=${Math.floor(a/t)+1}&order=desc&sort=asset_id`;V(`Fetching user assets from: ${s}`,"RWaxService");const n=await fetch(s,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=await n.json();return i&&i.data&&Array.isArray(i.data)?i.data.map(e=>{let t="";const a=[e.data?.img,e.data?.image,e.immutable_data?.img,e.immutable_data?.image,e.template?.immutable_data?.img,e.template?.immutable_data?.image];for(const s of a)if(s&&"string"==typeof s){t=s;break}return t&&!t.startsWith("http")&&(t.startsWith("Qm")||t.startsWith("/ipfs/")?t=`https://ipfs.io/ipfs/${t.replace("/ipfs/","")}`:t.startsWith("ipfs://")&&(t=t.replace("ipfs://","https://ipfs.io/ipfs/"))),{assetId:parseInt(e.asset_id)||0,name:e.name||e.data?.name||e.immutable_data?.name||`Pixal #${e.asset_id}`,image:t,schema:e.schema?.schema_name||e.schema_name||"pixals",owner:e.owner||"",burned:e.burned||!1,mint:e.template_mint||0,contract:e.contract||"atomicassets",collection:{collectionName:e.collection?.collection_name||e.collection_name||"pixeljourney",displayName:e.collection?.name||e.collection?.collection_name||"Pixel Journey",verification:e.collection?.authorized_accounts?.length>0||!0,blacklisted:!1},transferable:!1!==e.transferable,burnable:!1!==e.burnable,mutableData:Array.isArray(e.mutable_data)?e.mutable_data:[],immutableData:Array.isArray(e.immutable_data)?e.immutable_data:[],template:{templateId:parseInt(e.template?.template_id||e.template_id||"0")}}}):(K("Invalid user assets API response structure:",i),[])}catch(n){if(s=n instanceof Error?n:new Error(String(n)),K(`Attempt ${i}/3 failed:`,"RWaxService.getUserPixalAssets",s),3===i)return K("All attempts failed, returning empty array","RWaxService.getUserPixalAssets"),[];await new Promise(e=>setTimeout(e,1e3*i))}return[]}async executeTokenization(e,t,a){try{const s={expiration:new Date(Date.now()+18e5).toISOString().slice(0,-5),ref_block_num:Math.floor(65536*Math.random()),ref_block_prefix:Math.floor(4294967296*Math.random()),max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:"nft.hive",name:"boost",authorization:[{actor:a,permission:"active"}],data:{booster:a}},{account:t.contract,name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"rwax",quantity:t.fee,memo:"payfee"}},{account:"atomicassets",name:"transfer",authorization:[{actor:a,permission:"active"}],data:{from:a,to:"rwax",asset_ids:e,memo:"deposit"}},{account:"rwax",name:"tokenizenfts",authorization:[{actor:a,permission:"active"}],data:{user:a,asset_ids:e,fee_currency:`8,${t.symbol}`}}],transaction_extensions:[]};return V("Tokenization transaction prepared","RWaxService.executeTokenization",{transaction:"prepared"}),s}catch(s){throw K("Error executing tokenization:","RWaxService.executeTokenization",s instanceof Error?s:new Error(String(s))),s}}async executeRedemption(e,t,a,s){try{const n={expiration:new Date(Date.now()+18e5).toISOString().slice(0,-5),ref_block_num:Math.floor(65536*Math.random()),ref_block_prefix:Math.floor(4294967296*Math.random()),max_net_usage_words:0,max_cpu_usage_ms:0,delay_sec:0,context_free_actions:[],actions:[{account:"nft.hive",name:"boost",authorization:[{actor:s,permission:"active"}],data:{booster:s}},{account:a.contract,name:"transfer",authorization:[{actor:s,permission:"active"}],data:{from:s,to:"rwax",quantity:a.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:s,permission:"active"}],data:{from:s,to:"rwax",quantity:t,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:s,permission:"active"}],data:{redeemer:s,contract:"pixeljourney",quantity:t,asset_id:e,fee_currency:`8,${a.symbol}`}}],transaction_extensions:[]};return V("Redemption transaction prepared","RWaxService.executeRedemption",{transaction:"prepared"}),n}catch(n){throw K("Error executing redemption:","RWaxService.executeRedemption",n instanceof Error?n:new Error(String(n))),n}}};const Ea=new class{baseUrl="https://wax-api.hivebp.io/api";async getAttributeFilters(e,t){try{const a=new URL(`${this.baseUrl}/filter-attributes/${e}`);t&&a.searchParams.append("schema",t);const s=await fetch(a.toString());if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return await s.json()}catch(a){return K("Error fetching attribute filters from API, will use fallback","AttributeService",a),{}}}extractAttributesFromNFTs(e,t){const a=new Map;(t?e.filter(e=>e.schema===t):e).forEach(e=>{e.traits&&Object.entries(e.traits).forEach(([e,t])=>{if(null!=t){a.has(e)||a.set(e,new Map);const s=a.get(e),n=String(t),i=s.get(n)||0;s.set(n,i+1)}})});const s={};return a.forEach((e,t)=>{const a=[];e.forEach((e,t)=>{a.push({value:t,numMinted:e,maxSupply:e})}),a.sort((e,t)=>t.numMinted-e.numMinted),s[t]={values:a}}),s}formatAttributesForQuery(e){const t=[];return Object.entries(e).forEach(([e,a])=>{a.forEach(a=>{t.push(`${e}:${encodeURIComponent(a)}`)})}),t.join("&")}parseAttributeQuery(e){const t={};if(!e)return t;return e.split("&").forEach(e=>{const[a,s]=e.split(":");if(a&&s){const e=decodeURIComponent(s);t[a]||(t[a]=[]),t[a].push(e)}}),t}};const Pa=new class{ALCOR_API_BASE="https://wax.alcor.exchange/api";WAX_CONTRACT="eosio.token";WPIXAL_CONTRACT="pixeljourney";WAX_SYMBOL="WAX";WPIXAL_SYMBOL="WPIXAL";async getSwapQuote(e){try{const t=`${this.ALCOR_API_BASE}/swap/quote`,a=new URLSearchParams({token_in:`${this.WAX_SYMBOL}@${this.WAX_CONTRACT}`,token_out:`${this.WPIXAL_SYMBOL}@${this.WPIXAL_CONTRACT}`,amount_in:this.parseWaxAmount(e)}),s=await fetch(`${t}?${a}`);if(!s.ok)throw new Error(`Failed to get swap quote: ${s.statusText}`);const n=await s.json();if(!n.success)throw new Error(n.error||"Failed to get swap quote");return{input_amount:n.input_amount,output_amount:n.output_amount,price_impact:n.price_impact,minimum_received:n.minimum_received,route:n.route||[]}}catch(t){throw K("Error getting swap quote:","AlcorService.getSwapQuote",t instanceof Error?t:new Error(String(t))),t}}async executeSwap(e,t,a=.5){try{const s=await this.getSwapQuote(e),n=this.calculateMinAmountOut(s.output_amount,a),i={actions:[{account:this.WAX_CONTRACT,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"swap.alcor",quantity:`${parseFloat(e).toFixed(8)} ${this.WAX_SYMBOL}`,memo:`swap,0,${n}`}}],transaction_extensions:[]};return V("Swap transaction prepared","AlcorService.executeSwap",{waxAmount:e,expectedWpixal:s.output_amount,minAmountOut:n}),i}catch(s){throw K("Error executing swap:","AlcorService.executeSwap",s instanceof Error?s:new Error(String(s))),s}}async getExchangeRate(){try{const e=await this.getSwapQuote("1.00000000");return parseFloat(e.output_amount)}catch(e){return K("Error getting exchange rate:","AlcorService.getExchangeRate",e instanceof Error?e:new Error(String(e))),1e3}}async checkLiquidity(e){try{const t=await this.getSwapQuote(e);return parseFloat(t.price_impact)<5}catch(t){return K("Error checking liquidity:","AlcorService.checkLiquidity",t instanceof Error?t:new Error(String(t))),!1}}parseWaxAmount(e){const t=parseFloat(e);if(isNaN(t)||t<=0)throw new Error("Invalid WAX amount");return`${t.toFixed(8)} ${this.WAX_SYMBOL}`}calculateMinAmountOut(e,t){return`${(parseFloat(e)*(1-t/100)).toFixed(8)} ${this.WPIXAL_SYMBOL}`}async estimateWaxNeeded(e){try{const t=await this.getExchangeRate();return(parseFloat(e)/t).toFixed(8)}catch(t){throw K("Error estimating WAX needed:","AlcorService.estimateWaxNeeded",t instanceof Error?t:new Error(String(t))),t}}},Ta=({isOpen:e,onClose:t,onSuccess:s})=>{const{account:n}=_t(),{showSuccess:i,showError:l}=_e(),[c,o]=a.useState([]),[d,u]=a.useState([]),[m,h]=a.useState(new Set),[p,f]=a.useState(null),[x,g]=a.useState(!1),[v,y]=a.useState(""),[j,b]=a.useState(1),[N,w]=a.useState(0),k=a.useCallback(async(e=1)=>{if(n){g(!0),y("");try{const t=12*(e-1),a=await Aa.getUserPixalAssets(n,12,t);o(a),w(a.length)}catch(t){console.error("Error loading user assets:",t),y("Failed to load your Pixal assets. Please try again."),l("Failed to load assets")}finally{g(!1)}}},[n,12,l]),_=a.useCallback(async()=>{try{const e=await Aa.getFeeTokens();u(e)}catch(e){console.error("Error loading fee tokens:",e),l("Failed to load fee tokens")}},[l]);a.useEffect(()=>{e&&n&&(k(j),_())},[e,n,j,k,_]);const S=e=>{b(e),h(new Set)};if(!e)return null;const C=Math.ceil(N/12),E=m.size;return r.createPortal(A.jsx("div",{className:"modal-overlay",onClick:t,children:A.jsxs("div",{className:"tokenize-inventory-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Tokenize from Inventory"}),A.jsx("button",{className:"close-button",onClick:t,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[v&&A.jsx("div",{className:"error-message",children:v}),A.jsxs("div",{className:"selection-controls",children:[A.jsx("div",{className:"selection-info",children:A.jsxs("span",{children:[E," asset",1!==E?"s":""," selected"]})}),A.jsxs("div",{className:"selection-actions",children:[A.jsx("button",{className:"select-all-btn",onClick:()=>{const e=new Set(c.map(e=>e.assetId.toString()));h(e)},disabled:x,children:"Select All on Page"}),A.jsx("button",{className:"clear-all-btn",onClick:()=>{h(new Set)},disabled:x||0===E,children:"Clear All"})]})]}),A.jsxs("div",{className:"assets-section",children:[A.jsx("h3",{children:"Your Pixal Assets"}),x?A.jsxs("div",{className:"loading-spinner",children:[A.jsx("div",{className:"spinner"}),A.jsx("p",{children:"Loading your assets..."})]}):A.jsx("div",{className:"assets-grid",children:c.map(e=>A.jsxs("div",{className:"asset-card "+(m.has(e.assetId.toString())?"selected":""),onClick:()=>(e=>{const t=new Set(m);t.has(e)?t.delete(e):t.add(e),h(t)})(e.assetId.toString()),children:[A.jsxs("div",{className:"asset-image-container",children:[A.jsx(Fe,{imageUrl:e.image,alt:e.name,className:"asset-image"}),m.has(e.assetId.toString())&&A.jsx("div",{className:"selection-indicator",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})})]}),A.jsxs("div",{className:"asset-info",children:[A.jsx("h4",{className:"asset-name",children:e.name}),A.jsxs("p",{className:"asset-id",children:["#",e.assetId.toString()]})]})]},e.assetId))}),C>1&&A.jsxs("div",{className:"pagination",children:[A.jsx("button",{className:"pagination-btn",onClick:()=>S(j-1),disabled:1===j||x,children:"Previous"}),A.jsxs("span",{className:"pagination-info",children:["Page ",j," of ",C]}),A.jsx("button",{className:"pagination-btn",onClick:()=>S(j+1),disabled:j===C||x,children:"Next"})]})]}),E>0&&A.jsxs("div",{className:"fee-selection",children:[A.jsx("h3",{children:"Select Fee Token"}),A.jsx("div",{className:"fee-tokens-grid",children:d.map((e,t)=>A.jsxs("div",{className:"fee-option "+(p===e?"selected":""),onClick:()=>f(e),children:[A.jsxs("div",{className:"fee-info",children:[A.jsx("span",{className:"fee-amount",children:e.fee}),A.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&A.jsxs("div",{className:"wax-equivalent",children:["≈ ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]})]}),A.jsxs("div",{className:"modal-footer",children:[A.jsx("button",{className:"cancel-button",onClick:t,disabled:x,children:"Cancel"}),A.jsx("button",{className:"tokenize-button",onClick:async()=>{if(n&&0!==m.size&&p){g(!0);try{const e=Array.from(m),a=await Aa.executeTokenization(e,p,n);i(`Tokenization transaction prepared for ${e.length} asset(s)`),console.log("Tokenization transaction:",a),h(new Set),f(null),t(),s&&s()}catch(e){console.error("Error executing tokenization:",e),l("Tokenization failed. Please try again.")}finally{g(!1)}}else l("Please select assets and a fee token")},disabled:x||0===E||!p,children:x?"Processing...":`Tokenize ${E} Asset${1!==E?"s":""}`})]})]})}),document.body)},Ia=({asset:e,isOpen:t,onClose:s,onRedeem:n})=>{const{account:i}=_t(),{showError:r}=_e(),[l,c]=a.useState([]),[o,d]=a.useState(null),[u,m]=a.useState(!1),[h,p]=a.useState(!1),f=async()=>{try{const e=await Aa.getFeeTokens();c(e)}catch(e){console.error("Error loading fee tokens:",e),r("Failed to load fee tokens")}};a.useEffect(()=>{t&&e&&f()},[t,e,f]);return t&&e?A.jsx("div",{className:"modal-overlay",onClick:s,children:A.jsxs("div",{className:"asset-detail-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h2",{children:"Asset Details"}),A.jsx("button",{className:"close-button",onClick:s,children:"×"})]}),A.jsxs("div",{className:"modal-body",children:[A.jsxs("div",{className:"asset-main-info",children:[A.jsx("div",{className:"asset-image-section",children:A.jsx(Fe,{imageUrl:e.image,alt:e.name,className:"asset-image"})}),A.jsxs("div",{className:"asset-info-section",children:[A.jsx("h3",{className:"asset-name",children:e.name}),A.jsxs("div",{className:"asset-metadata",children:[A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Asset ID:"}),A.jsx("span",{className:"value",children:e.assetId})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Collection:"}),A.jsx("span",{className:"value",children:e.collection?.displayName||e.collection?.collectionName})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Schema:"}),A.jsx("span",{className:"value",children:e.schema})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Mint #:"}),A.jsx("span",{className:"value",children:e.mint})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Template ID:"}),A.jsx("span",{className:"value",children:e.template?.templateId})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"WPIXAL Amount:"}),A.jsxs("span",{className:"value highlight",children:[e.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),e.rarityScore&&A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Rarity Score:"}),A.jsx("span",{className:"value highlight",children:e.rarityScore.toFixed(2)})]}),e.attributesFloor&&A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Attributes Floor:"}),A.jsxs("span",{className:"value highlight",children:[e.attributesFloor.toFixed(8)," WPIXAL"]})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Contract:"}),A.jsx("span",{className:"value",children:e.contract})]}),A.jsxs("div",{className:"metadata-item",children:[A.jsx("span",{className:"label",children:"Owner:"}),A.jsx("span",{className:"value",children:e.owner})]})]}),e.immutableData&&e.immutableData.length>0&&A.jsxs("div",{className:"asset-attributes",children:[A.jsx("h4",{children:"NFT Traits"}),A.jsx("div",{className:"attributes-grid",children:e.immutableData.filter(({key:e,value:t})=>!["image","img","video","audio","model","description","name"].includes(e.toLowerCase())&&t&&null!==t[1]&&void 0!==t[1]&&""!==t[1]).map(({key:e,value:t})=>{const a=e.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),s=Array.isArray(t)?t[1]:t;return A.jsxs("div",{className:"trait-item",children:[A.jsx("div",{className:"trait-label",children:a}),A.jsx("div",{className:"trait-value",children:String(s)})]},e)})}),(()=>{const t=e.immutableData.find(e=>"description"===e.key.toLowerCase()),a=t?Array.isArray(t.value)?t.value[1]:t.value:null;return a&&String(a).trim()?A.jsxs("div",{className:"asset-description",children:[A.jsx("h4",{children:"Description"}),A.jsx("p",{children:String(a)})]}):null})()]})]})]}),i&&A.jsx("div",{className:"redemption-section",children:h?A.jsxs("div",{className:"redeem-form",children:[A.jsx("h4",{children:"Redeem Asset"}),A.jsxs("p",{className:"redeem-description",children:["Redeem this tokenized asset by paying ",e.rwax.redeemAmount.toFixed(8)," WPIXAL plus a fee."]}),A.jsxs("div",{className:"fee-selection",children:[A.jsx("h5",{children:"Select Fee Token:"}),A.jsx("div",{className:"fee-options",children:l.map((e,t)=>A.jsxs("div",{className:"fee-option "+(o===e?"selected":""),onClick:()=>d(e),children:[A.jsxs("div",{className:"fee-info",children:[A.jsx("span",{className:"fee-amount",children:e.fee}),A.jsxs("span",{className:"fee-contract",children:["(",e.contract,")"]})]}),e.wax_value&&"WAX"!==e.symbol&&A.jsxs("div",{className:"wax-equivalent",children:["≈ ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))})]}),A.jsxs("div",{className:"redeem-actions",children:[A.jsx("button",{className:"cancel-redeem-button",onClick:()=>p(!1),children:"Cancel"}),A.jsx("button",{className:"confirm-redeem-button",onClick:async()=>{if(e&&o&&i){m(!0);try{n&&await n(e,o),s()}catch(t){console.error("Error during redemption:",t),r("Redemption failed. Please try again.")}finally{m(!1)}}else r("Please select a fee token")},disabled:!o||u,children:u?"Processing...":"Confirm Redemption"})]})]}):A.jsx("button",{className:"show-redeem-button",onClick:()=>p(!0),children:"Redeem this Asset"})}),!i&&A.jsx("div",{className:"wallet-connect-message",children:A.jsx("p",{children:"Connect your wallet to redeem this asset"})})]})]})}):null},Fa=({limit:e=12,refreshInterval:t=3e4})=>{const[s,n]=a.useState([]),[i,r]=a.useState(!0),[l,c]=a.useState(null),[o,d]=a.useState(null),[u,m]=a.useState(1),[h,p]=a.useState(!0),[f,x]=a.useState(!1),g=a.useCallback(async(t=1,a=!1)=>{try{a?x(!0):(c(null),r(!0));const s=await ye.getRWAXTransfers({limit:e,page:t,order:"desc"});if(!s.success)throw new Error("Failed to fetch RWAX transactions");{const t=s.data;n(a?e=>[...e,...t]:t),p(t.length===e),d(new Date)}}catch(s){K("Error fetching RWAX transactions","RWAXLiveTransactions",s),a||c("Failed to load RWAX transactions")}finally{r(!1),x(!1)}},[e]);a.useEffect(()=>{g();const e=setInterval(()=>{g(1,!1),m(1)},t);return()=>clearInterval(e)},[e,t,g]);const v=e=>{try{const t=new Date(e);if(isNaN(t.getTime()))return"Unknown";const a=(new Date).getTime()-t.getTime(),s=Math.floor(a/6e4);return s<0||s<1?"Just now":s<60?`${s}m ago`:s<1440?`${Math.floor(s/60)}h ago`:`${Math.floor(s/1440)}d ago`}catch(t){return"Unknown"}},y=e=>"tokenization"===e?"Tokenized":"Redeemed";return i&&0===s.length?A.jsxs("div",{className:"rwax-live-transactions",children:[A.jsxs("div",{className:"rwax-live-transactions-header",children:[A.jsx("h3",{children:"Live RWAX Transactions"}),A.jsx("div",{className:"loading-spinner"})]}),A.jsx("div",{className:"transactions-loading",children:A.jsx("p",{children:"Loading RWAX transactions..."})})]}):l&&0===s.length?A.jsxs("div",{className:"rwax-live-transactions",children:[A.jsxs("div",{className:"rwax-live-transactions-header",children:[A.jsx("h3",{children:"Live RWAX Transactions"}),A.jsx("button",{onClick:()=>g(),className:"refresh-button",children:"🔄"})]}),A.jsxs("div",{className:"transactions-error",children:[A.jsx("p",{children:l}),A.jsx("button",{onClick:()=>g(),className:"retry-button",children:"Try Again"})]})]}):A.jsxs("div",{className:"rwax-live-transactions",children:[A.jsxs("div",{className:"rwax-live-transactions-header",children:[A.jsx("h3",{children:"Live RWAX Transactions"}),A.jsxs("div",{className:"header-actions",children:[o&&A.jsxs("span",{className:"last-update",children:["Updated ",v(o.toISOString())]}),A.jsx("button",{onClick:()=>{g(1,!1),m(1)},className:"refresh-button",disabled:i,children:i?"⏳":"🔄"})]})]}),A.jsx("div",{className:"rwax-transactions-grid",children:0===s.length?A.jsx("div",{className:"no-transactions",children:A.jsx("p",{children:"No recent RWAX transactions found"})}):s.map((e,t)=>{return A.jsxs("div",{className:"rwax-transaction-card",children:[A.jsxs("div",{className:"transaction-header",children:[A.jsxs("div",{className:"transaction-type",children:[A.jsx("span",{className:"transaction-icon",children:(a=e.type,"tokenization"===a?"🔄":"🎁")}),A.jsx("span",{className:`transaction-label ${e.type}`,children:y(e.type)})]}),A.jsx("span",{className:"transaction-time",children:v(e.created_at_time)})]}),A.jsxs("div",{className:"transaction-assets",children:[e.assets.slice(0,1).map(e=>{return A.jsxs("div",{className:"asset-preview",children:[A.jsx(Fe,{imageUrl:(t=e.data?.img,t?t.startsWith("Qm")||t.startsWith("baf")?`https://ipfs.io/ipfs/${t}`:t.startsWith("/")?`https://ipfs.io/ipfs${t}`:t:"/placeholder-nft.png"),alt:e.name||"Unknown Asset",className:"asset-image"}),A.jsxs("div",{className:"asset-info",children:[A.jsx("h4",{className:"asset-name",children:e.name||"Unknown Asset"}),A.jsxs("p",{className:"asset-mint",children:["#",e.template_mint||e.asset_id||"N/A"]})]})]},e.asset_id);var t}),e.assets.length>1&&A.jsxs("div",{className:"additional-assets",children:["+",e.assets.length-1," more"]})]}),A.jsxs("div",{className:"transaction-details",children:[A.jsxs("div",{className:"transaction-accounts",children:[A.jsxs("span",{className:"account from",children:["From: ",e.sender_name.length>8?`${e.sender_name.slice(0,6)}...`:e.sender_name]}),A.jsxs("span",{className:"account to",children:["To: ",e.recipient_name.length>8?`${e.recipient_name.slice(0,6)}...`:e.recipient_name]})]}),A.jsx("div",{className:"transaction-actions",children:A.jsx("button",{className:"view-tx-button",onClick:()=>window.open(`https://waxblock.io/transaction/${e.txid}`,"_blank"),title:"View on WAX Block Explorer",children:"🔗"})})]})]},`${e.txid}-${e.transfer_id}-${t}`);var a})}),h&&A.jsx("div",{className:"load-more-section",children:A.jsx("button",{onClick:async()=>{if(!f&&h){const e=u+1;m(e),await g(e,!0)}},className:"load-more-button",disabled:f,children:f?A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"loading-spinner small"}),"Loading more..."]}):"Load More Transactions"})})]})},$a={Background:["Nefty Spot","Blue Sky","Forest","Desert","Ocean","Mountain","City","Space","Sunset","Rainbow"],Body:["Pink-Blue Overalls","Red Shirt","Blue Hoodie","Green Jacket","Yellow Dress","Purple Suit","Orange Tank","Black Tee","White Polo","Gray Sweater"],Eyes:["Kawaii Green","Brown","Blue","Hazel","Gray","Amber","Violet","Red","Black","Gold"],Head:["Grey","Black Hair","Brown Hair","Blonde Hair","Red Hair","Blue Hair","Green Hair","Purple Hair","Bald","Hat"]},La=({onFiltersChange:e,initialFilters:t={}})=>{const[s,n]=a.useState({});a.useEffect(()=>{const e={};Object.keys($a).forEach(a=>{e[a]={isExpanded:!1,selectedValues:new Set(t[a]||[]),searchTerm:""}}),n(e)},[]);const i=a.useCallback((e,t)=>{n(a=>{const s={...a};s[e]||(s[e]={isExpanded:!1,selectedValues:new Set,searchTerm:""});const n=new Set(s[e].selectedValues);return n.has(t)?n.delete(t):n.add(t),s[e]={...s[e],selectedValues:n},s})},[]),r=a.useCallback(e=>{n(t=>({...t,[e]:{...t[e],isExpanded:!t[e]?.isExpanded}}))},[]),l=a.useCallback((e,t)=>{n(a=>({...a,[e]:{...a[e],searchTerm:t}}))},[]),c=a.useCallback(()=>{const e={};Object.keys($a).forEach(t=>{e[t]={isExpanded:!1,selectedValues:new Set,searchTerm:""}}),n(e)},[]);a.useEffect(()=>{const t={};Object.entries(s).forEach(([e,a])=>{a.selectedValues.size>0&&(t[e]=Array.from(a.selectedValues))}),e(t)},[s,e]);const o=Object.values(s).reduce((e,t)=>e+t.selectedValues.size,0);return A.jsxs("div",{className:"attribute-filter-container",children:[A.jsxs("div",{className:"filter-header",children:[A.jsx("h3",{children:"Pixal Traits"}),o>0&&A.jsxs("button",{className:"clear-all-button",onClick:c,children:["Clear All (",o,")"]})]}),Object.entries($a).map(([e])=>{const t=s[e],a=(e=>{const t=s[e]?.searchTerm?.toLowerCase()||"",a=$a[e]||[];return t?a.filter(e=>e.toLowerCase().includes(t)):a})(e),n=t?.selectedValues.size||0;return A.jsxs("div",{className:"filter-group",children:[A.jsxs("div",{className:"filter-group-header",onClick:()=>r(e),children:[A.jsxs("div",{className:"attribute-name",children:[e,n>0&&A.jsx("span",{className:"selected-count",children:n})]}),A.jsx("div",{className:"expand-icon "+(t?.isExpanded?"expanded":""),children:"▼"})]}),t?.isExpanded&&A.jsxs("div",{className:"filter-group-content",children:[A.jsx("input",{type:"text",placeholder:`Search ${e.toLowerCase()}...`,value:t.searchTerm,onChange:t=>l(e,t.target.value),className:"attribute-search"}),A.jsx("div",{className:"attribute-values",children:a.length>0?a.map(a=>{const s=t.selectedValues.has(a);return A.jsx("div",{className:"attribute-value-item "+(s?"selected":""),onClick:()=>i(e,a),children:A.jsx("span",{className:"attribute-value-text",children:a})},a)}):A.jsxs("div",{className:"no-results",children:["No ",e.toLowerCase(),' found matching "',t.searchTerm,'"']})})]})]},e)})]})},Ma=()=>{const e=i(),{account:t,session:s}=_t(),{showSuccess:n,showError:r}=_e(),[l,c]=a.useState("redeem"),[o,d]=a.useState([]),[u,m]=a.useState([]),[h,p]=a.useState(!1),[f,x]=a.useState(null),[g,v]=a.useState(!1),[y,j]=a.useState(!1),[b,N]=a.useState(!1),[w,k]=a.useState(!1),[_,S]=a.useState(!1),[C,E]=a.useState(null),[P,T]=a.useState(null),[I,F]=a.useState(null),[$,L]=a.useState("confirm"),[M,R]=a.useState(""),[W,O]=a.useState(new Set),[D,B]=a.useState(!1),[U,z]=a.useState(null),[X,H]=a.useState(!1),[q,J]=a.useState(0),[V,G]=a.useState(0),[Y,Q]=a.useState(0),[Z,ee]=a.useState(!1),[te,ae]=a.useState({min:"",max:""}),[se,ne]=a.useState(0),[re,le]=a.useState(!1),[ce]=a.useState(null),[oe,de]=a.useState(10),[ue,me]=a.useState(!1),[he,pe]=a.useState(""),[fe,xe]=a.useState("0.0000 WAX"),[ge,ve]=a.useState(1),[ye,je]=a.useState(!0),[be,we]=a.useState(!1),[ke,Se]=a.useState("rarity_score_desc"),[Ce,Ae]=a.useState(""),[Ee,Pe]=a.useState({}),[Te,$e]=a.useState(""),[Le,Me]=a.useState(new Set),[Re,We]=a.useState(new Map),Oe=a.useMemo(()=>{if(!Te.trim())return o;const e=Te.toLowerCase();return o.filter(t=>{if(t.name?.toLowerCase().includes(e))return!0;if(t.collection?.collectionName?.toLowerCase().includes(e)||t.collection?.displayName?.toLowerCase().includes(e))return!0;if(t.template?.templateId?.toString().includes(e))return!0;if(t.immutableData)for(const a of t.immutableData)if(a.key?.toLowerCase().includes(e)||a.value?.[1]?.toString().toLowerCase().includes(e))return!0;if(t.mutableData)for(const a of t.mutableData)if(a.key?.toLowerCase().includes(e)||a.value?.[1]?.toString().toLowerCase().includes(e))return!0;return!1})},[o,Te]),De=a.useCallback(async(e=1,t=!1)=>{console.log("Loading tokenized assets...",{page:e,append:t,sortBy:ke,attributeFilters:Ce});try{t?we(!0):(p(!0),x(null));const a=36,s=(e-1)*a;console.log("Calling rwaxService.getTokenizedAssets with:",{limit:a,offset:s,sortBy:ke,attributeFilters:Ce});const n=await Aa.getTokenizedAssets(a,s,ke,Ce);console.log("Received assets:",n),d(t?e=>[...e,...n]:n),je(n.length===a)}catch(a){K("Error loading tokenized assets","RWax",a),t||x("Failed to load tokenized assets. Please try again later.")}finally{p(!1),we(!1)}},[ke,Ce]),Be=a.useCallback(async()=>{const e=ge+1;await De(e,!0),ve(e)},[ge,De]),Ue=a.useCallback(e=>{Se(e),ve(1)},[]),ze=a.useCallback(e=>{Pe(e);const t=Ea.formatAttributesForQuery(e);Ae(t),ve(1)},[]);a.useEffect(()=>{const e=setTimeout(()=>{"redeem"===l&&De(1,!1)},300);return()=>clearTimeout(e)},[ke,Ce,l]);const Xe=a.useCallback(async()=>{try{const e=await Aa.getFeeTokens();m(e)}catch(e){K("Error loading fee tokens","RWax",e)}},[]),He=a.useCallback(async()=>{try{const[e,t,a]=await Promise.all([ie.getWpixalPriceWAX(),ie.getWpixalPriceUSD(),ie.getWaxPriceUSD()]);G(e),Q(t),ne(a)}catch(e){K("Error loading price data","RWax",e),G(.0177),Q(9e-4),ne(.051),r("Price Loading Error","Unable to fetch current prices. Using fallback values.")}},[r]),qe=a.useCallback(async()=>{if(t)try{const e=await Ne.getWaxBalance(t);xe(e)}catch(e){K("Error loading WAX balance","RWax",e),xe("0.0000 WAX")}else xe("0.0000 WAX")},[t]);a.useEffect(()=>{Xe(),He(),qe(),"redeem"===l&&De(1,!1)},[l,De,Xe,He,qe]),a.useEffect(()=>{const e=setInterval(He,3e5);return()=>clearInterval(e)},[He]);const Je=()=>{S(!1),L("confirm"),R(""),p(!1),E(null)},Ve=e=>{T(e),k(!0)},Ge=a.useCallback(()=>{ee(e=>!e)},[]),Ke=a.useCallback(()=>{ee(!1)},[]),Ye=e=>"rwax"in e&&e.rwax&&"redeemAmount"in e.rwax;a.useEffect(()=>{const e=localStorage.getItem("rwax-watchlist");if(e)try{const t=JSON.parse(e);Me(new Set(t))}catch(t){console.error("Error loading watchlist:",t)}},[]);const Qe=(e,t)=>{navigator.clipboard.writeText(`${t} ${e}`).then(()=>{n("Link copied to clipboard!")}).catch(()=>{r("Failed to copy link")})},Ze=a.useCallback((e,t)=>{const a=parseFloat(e.rwax.redeemAmount.toString()),s={assetId:e.assetId.toString(),assetName:e.name,originalPrice:a,alertPercentage:t,createdAt:Date.now()},i=new Map(Re);i.set(e.assetId.toString(),s),We(i);const r=Array.from(i.entries());localStorage.setItem("rwax-price-alerts",JSON.stringify(r)),n(`Price alert set for ${e.name} at ${t}% change`)},[Re,n]),et=a.useCallback(e=>{const t=new Map(Re);t.delete(e),We(t);const a=Array.from(t.entries());localStorage.setItem("rwax-price-alerts",JSON.stringify(a)),n("Price alert removed")},[Re,n]),tt=a.useCallback(()=>{0!==Re.size&&0!==o.length&&Re.forEach((e,t)=>{const a=o.find(e=>e.assetId.toString()===t);if(!a)return r(`Alert: ${e.assetName} is no longer available on RWAX!`),void et(t);const s=(parseFloat(a.rwax.redeemAmount.toString())-e.originalPrice)/e.originalPrice*100;if(Math.abs(s)>=e.alertPercentage){const t=s>0?"increased":"decreased";n(`Price Alert: ${e.assetName} has ${t} by ${Math.abs(s).toFixed(2)}%!`),Ze(a,e.alertPercentage)}})},[Re,o,r,n,et,Ze]);return a.useEffect(()=>{const e=localStorage.getItem("rwax-price-alerts");if(e)try{const t=JSON.parse(e);We(new Map(t))}catch(t){console.error("Error loading price alerts:",t)}},[]),a.useEffect(()=>{tt()},[tt]),A.jsxs("div",{className:"rwax-container",children:[A.jsxs("div",{className:"rwax-header",children:[A.jsxs("div",{className:"rwax-header-top",children:[A.jsxs("button",{className:"rwax-back-button",onClick:()=>e("/marketplace"),children:[A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Marketplace"]}),A.jsx("div",{className:"header-actions"})]}),A.jsx("h1",{children:"R-WAX Tokenization"}),A.jsx("p",{children:"Tokenize your Pixals to WPIXAL or redeem WPIXAL back to Pixals"}),A.jsxs("p",{style:{marginTop:"16px",fontSize:"0.9rem",color:"var(--text-secondary)"},children:["Visit the ",A.jsx("a",{href:"https://r-wax.io/token/pixeljourney/WPIXAL",target:"_blank",rel:"noopener noreferrer",style:{color:"var(--primary-purple)",textDecoration:"none",fontWeight:"500"},onMouseEnter:e=>e.target.style.textDecoration="underline",onMouseLeave:e=>e.target.style.textDecoration="none",children:"official RWAX website"})," for full WPIXAL markets and trading features."]})]}),A.jsxs("div",{className:"rwax-tabs",children:[A.jsx("button",{className:"tab-button "+("redeem"===l?"active":""),onClick:()=>c("redeem"),children:"WPIXAL to Pixal PFP"}),A.jsx("button",{className:"tab-button "+("other-collections"===l?"active":""),onClick:()=>c("other-collections"),children:"Other RWAX Collections"})]}),f&&A.jsx("div",{className:"error-message",children:f}),A.jsx("div",{className:"rwax-content",children:"redeem"===l?A.jsxs("div",{className:"redeem-section",children:[A.jsx("h2",{children:"Available Tokenized Pixals"}),A.jsx("p",{children:"Redeem your WPIXAL tokens back to original Pixal NFTs"}),A.jsxs("div",{className:"actions-and-controls-container",children:[A.jsxs("div",{className:"left-actions",children:[A.jsx("div",{className:"action-group",children:A.jsx("button",{className:"inventory-tokenize-button",onClick:()=>N(!0),children:"Tokenize from Inventory"})}),A.jsxs("div",{className:"action-group",children:[A.jsxs("button",{className:"wpixal-alert-button "+(localStorage.getItem("wpixalPriceAlert")?"has-alert":""),onClick:()=>me(!0),children:[A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"}),A.jsx("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),"WPIXAL Price Alert"]}),localStorage.getItem("wpixalPriceAlert")&&A.jsxs("div",{className:"current-alert-display",children:[A.jsxs("span",{children:["Current Alert: ",localStorage.getItem("wpixalPriceAlert")," WAX"]}),A.jsx("button",{className:"remove-alert",onClick:e=>{e.stopPropagation(),localStorage.removeItem("wpixalPriceAlert"),pe("")},title:"Remove Alert",children:"×"})]})]})]}),A.jsxs("div",{className:"sorting-and-filter-controls",children:[A.jsx("div",{className:"search-bar-container",children:A.jsxs("div",{className:"search-input-container",children:[A.jsx("svg",{className:"search-icon",viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"})}),A.jsx("input",{type:"text",placeholder:"Search R-WAX assets...",value:Te,onChange:e=>$e(e.target.value),className:"search-input"}),Te&&A.jsx("button",{onClick:()=>$e(""),className:"clear-search","aria-label":"Clear search",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]})}),A.jsxs("div",{className:"sorting-controls",children:[A.jsx("label",{htmlFor:"sort-select",children:"Sort by:"}),A.jsxs("select",{id:"sort-select",value:ke,onChange:e=>Ue(e.target.value),className:"sort-dropdown",children:[A.jsx("option",{value:"date_desc",children:"Date (Newest First)"}),A.jsx("option",{value:"date_asc",children:"Date (Oldest First)"}),A.jsx("option",{value:"price_desc",children:"Price (High to Low)"}),A.jsx("option",{value:"price_asc",children:"Price (Low to High)"}),A.jsx("option",{value:"floor_desc",children:"Floor Price (High to Low)"}),A.jsx("option",{value:"floor_asc",children:"Floor Price (Low to High)"}),A.jsx("option",{value:"mint_desc",children:"Mint Number (High to Low)"}),A.jsx("option",{value:"mint_asc",children:"Mint Number (Low to High)"}),A.jsx("option",{value:"rarity_score_desc",children:"Rarity Score (High to Low)"}),A.jsx("option",{value:"rarity_score_asc",children:"Rarity Score (Low to High)"})]})]}),A.jsx("button",{className:"filter-toggle-btn",onClick:Ge,title:"Open Filters",children:A.jsx("svg",{width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})})})]})]}),h?A.jsx("div",{className:"loading-spinner",children:"Loading tokenized assets..."}):A.jsxs(A.Fragment,{children:[Oe.length>0&&A.jsxs("div",{className:"multi-select-controls",children:[A.jsx("button",{className:"select-all-button",onClick:()=>{W.size===o.length?O(new Set):O(new Set(o.map(e=>e.assetId.toString())))},children:W.size===Oe.length?"Deselect All":"Select All"}),A.jsxs("div",{className:"selected-count-container",children:[A.jsxs("div",{className:"selected-count",children:[W.size," of ",Oe.length," selected"]}),ye&&A.jsx("button",{className:"load-more-small-button",onClick:Be,disabled:be,title:"Load More Assets",children:be?"Loading...":"Load More"})]}),A.jsxs("button",{className:"batch-redeem-button",onClick:async()=>{if(0!==W.size)try{p(!0);const a=o.filter(e=>W.has(e.assetId.toString())),s=u.length>0?u[0]:null;if(!s)return void r("No fee tokens available for batch redemption");for(const n of a){if(!t)return void r("Please connect your wallet");try{const e=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:s.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:s.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${n.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${n.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:n.assetId.toString(),fee_currency:`8,${s.symbol}`}}],a=await Ie.transact(e);console.log(`Redemption transaction result for ${n.name}:`,a)}catch(e){K(`Error redeeming asset ${n.assetId}`,"RWax",e)}}n(`Successfully processed redemption for ${W.size} assets!`),O(new Set),De()}catch(a){K("Batch redemption failed","RWax",a),r("Batch redemption failed. Please try again.")}finally{p(!1)}},disabled:0===W.size||!t,children:["Batch Redeem (",W.size,")"]})]}),A.jsx("div",{className:"rwax-assets-grid",children:Oe.map((e,a)=>A.jsxs("div",{className:"asset-card "+(W.has(e.assetId.toString())?"selected":""),children:[A.jsx("div",{className:"selection-checkbox "+(W.has(e.assetId.toString())?"checked":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(W);t.has(e)?t.delete(e):t.add(e),O(t)})(e.assetId.toString())},children:W.has(e.assetId.toString())&&A.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:A.jsx("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"})})}),A.jsxs("div",{className:"asset-card-content",onClick:()=>Ve(e),children:[A.jsxs("div",{className:"asset-image",children:[A.jsx(Fe,{imageUrl:e.image,alt:e.name,className:"nft-image"}),A.jsx("div",{className:"zoom-overlay",onClick:t=>{t.stopPropagation(),((e,t)=>{let a=e;e&&!e.startsWith("http")&&(e.startsWith("Qm")||e.startsWith("baf")?a=`https://ipfs.io/ipfs/${e}`:e.startsWith("/ipfs/")?a=`https://ipfs.io/ipfs/${e.replace("/ipfs/","")}`:e.startsWith("ipfs://")&&(a=e.replace("ipfs://","https://ipfs.io/ipfs/"))),z({url:a,name:t}),B(!0)})(e.image,e.name)},children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:[A.jsx("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}),A.jsx("path",{d:"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"})]})})]}),A.jsxs("div",{className:"asset-info",children:[A.jsx("h3",{children:e.name}),A.jsxs("div",{className:"pricing-info",children:[A.jsxs("div",{className:"wpixal-amount",onClick:t=>{var a;t.stopPropagation(),a=parseFloat(e.rwax.redeemAmount.toString()),J(a),H(!0)},title:`Exact amount: ${e.rwax.redeemAmount} WPIXAL`,children:[parseFloat(e.rwax.redeemAmount.toString()).toFixed(1)," WPIXAL"]}),A.jsxs("div",{className:"wax-price",children:["≈ ",(parseFloat(e.rwax.redeemAmount.toString())*V).toFixed(4)," WAX"]}),A.jsxs("div",{className:"usd-price",children:["≈ $",(parseFloat(e.rwax.redeemAmount.toString())*Y).toFixed(4)," USD"]})]})]})]}),A.jsxs("div",{className:"asset-actions",children:[A.jsx("button",{className:"redeem-button primary",onClick:t=>{t.stopPropagation(),(e=>{E(e),j(!0)})(e)},disabled:!t,children:"Redeem (WPIXAL)"}),A.jsxs("div",{className:"secondary-actions",children:[A.jsx("button",{className:"wax-redeem-button secondary",onClick:t=>{t.stopPropagation(),(e=>{E(e),S(!0),L("confirm"),R("")})(e)},disabled:!t,children:"Redeem (WAX)"}),A.jsx("button",{className:"info-button secondary",onClick:t=>{t.stopPropagation(),Ve(e)},children:"Info"})]}),A.jsxs("div",{className:"icon-actions",children:[A.jsx("button",{className:"btn-share icon-only",onClick:t=>{t.stopPropagation(),(async e=>{const t=`${window.location.origin}/rwax/asset/${e.assetId}`,a=`Check out this tokenized Pixal: ${e.name} - ${e.rwax.redeemAmount.toFixed(8)} WPIXAL`;if(navigator.share)try{await navigator.share({title:`${e.name} - RWAX`,text:a,url:t}),n("Shared successfully!")}catch(s){"AbortError"!==s.name&&(console.error("Error sharing:",s),Qe(t,a))}else Qe(t,a)})(e)},title:"Share Asset",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"}),A.jsx("polyline",{points:"16,6 12,2 8,6"}),A.jsx("line",{x1:"12",y1:"2",x2:"12",y2:"15"})]})}),A.jsx("button",{className:"btn-watchlist icon-only "+(Le.has(e.assetId.toString())?"active":""),onClick:t=>{t.stopPropagation(),(e=>{const t=new Set(Le);t.has(e)?(t.delete(e),n("Removed from watchlist")):(t.add(e),n("Added to watchlist")),Me(t),localStorage.setItem("rwax-watchlist",JSON.stringify(Array.from(t)))})(e.assetId.toString())},title:Le.has(e.assetId.toString())?"Remove from Watchlist":"Add to Watchlist",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:Le.has(e.assetId.toString())?"currentColor":"none",stroke:"currentColor",children:A.jsx("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"})})}),A.jsx("button",{className:"btn-copy-link icon-only",onClick:t=>{t.stopPropagation();const a=`${window.location.origin}/asset/${e.assetId}`;navigator.clipboard.writeText(a).then(()=>{n("Asset link copied to clipboard!")}).catch(()=>{r("Failed to copy link")})},title:"Copy Link",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),A.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})})]})]})]},`${e.assetId}-${a}`))}),ye&&A.jsx("div",{className:"load-more-section",children:A.jsx("button",{className:"load-more-button",onClick:Be,disabled:be,children:be?"Loading...":"Load More Assets"})})]})]}):"other-collections"===l?A.jsx("div",{className:"other-collections-section",children:A.jsxs("div",{className:"construction-message",children:[A.jsx("div",{className:"construction-icon",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:A.jsx("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"})})}),A.jsx("h2",{children:"Other RWAX Collections"}),A.jsx("p",{children:"Support for additional RWAX collections is coming soon!"}),A.jsx("div",{className:"construction-details",children:A.jsx("p",{children:"We're working on expanding RWAX tokenization to support more NFT collections beyond Pixals. Stay tuned for updates!"})})]})}):null}),g&&C&&A.jsx("div",{className:"rwax-modal-overlay",onClick:()=>v(!1),children:A.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"rwax-modal-header",children:[A.jsx("h2",{children:"Tokenize Pixal"}),A.jsx("button",{className:"rwax-close-button",onClick:()=>v(!1),children:"×"})]}),A.jsxs("div",{className:"rwax-modal-body",children:[A.jsxs("div",{className:"selected-asset",children:[A.jsx(Fe,{imageUrl:C.image,alt:C.name,className:"modal-asset-image"}),A.jsx("h3",{children:C.name})]}),A.jsxs("div",{className:"fee-selection",children:[A.jsx("h4",{children:"Select Fee Token:"}),u.map((e,t)=>A.jsxs("div",{className:"fee-option "+(I===e?"selected":""),onClick:()=>F(e),children:[A.jsx("span",{className:"fee-amount",children:e.fee}),e.wax_value&&"WAX"!==e.symbol&&A.jsxs("span",{className:"wax-equivalent",children:["≈ ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"cancel-button",onClick:()=>v(!1),children:"Cancel"}),A.jsx("button",{className:"confirm-button",onClick:async()=>{if(C&&I&&s&&t)try{const e=await Aa.executeTokenization([C.assetId.toString()],I,t);n("Tokenization transaction prepared"),console.log("Tokenization transaction:",e),v(!1),setTimeout(()=>{De()},2e3)}catch(e){K("Error during tokenization","RWax",e),r("Tokenization failed. Please try again.")}else r("Please select an asset and fee token")},disabled:!I,children:"Tokenize"})]})]})]})}),y&&C&&Ye(C)&&A.jsx("div",{className:"rwax-modal-overlay",onClick:()=>j(!1),children:A.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"rwax-modal-header",children:[A.jsx("h2",{children:"Redeem WPIXAL"}),A.jsx("button",{className:"rwax-close-button",onClick:()=>j(!1),children:"×"})]}),A.jsxs("div",{className:"rwax-modal-body",children:[A.jsxs("div",{className:"selected-asset",children:[A.jsx(Fe,{imageUrl:C.image,alt:C.name,className:"modal-asset-image"}),A.jsx("h3",{children:C.name}),Ye(C)&&A.jsxs("p",{className:"wpixal-required",children:["Required: ",C.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),A.jsxs("div",{className:"fee-selection",children:[A.jsx("h4",{children:"Select Fee Token:"}),u.map((e,t)=>A.jsxs("div",{className:"fee-option "+(I===e?"selected":""),onClick:()=>F(e),children:[A.jsx("span",{className:"fee-amount",children:e.fee}),e.wax_value&&"WAX"!==e.symbol&&A.jsxs("span",{className:"wax-equivalent",children:["≈ ",parseFloat(e.wax_value).toFixed(4)," WAX"]})]},t))]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"cancel-button",onClick:()=>j(!1),children:"Cancel"}),A.jsx("button",{className:"confirm-button",onClick:async()=>{if(C&&I&&s&&t&&Ye(C))try{p(!0);const e=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:I.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:I.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${C.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${C.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:C.assetId.toString(),fee_currency:`8,${I.symbol}`}}],a=await Ie.transact(e);n("Redemption transaction completed successfully!"),console.log("Redemption transaction result:",a),j(!1),setTimeout(()=>{De()},2e3)}catch(e){K("Error during redemption","RWax",e),r("Redemption failed. Please try again.")}finally{p(!1)}else r("Please select an asset and fee token")},disabled:!I,children:"Redeem"})]})]})]})}),A.jsx(Ta,{isOpen:b,onClose:()=>N(!1),onSuccess:()=>{"redeem"===l&&De()}}),A.jsx(Ia,{asset:P,isOpen:w,onClose:()=>{k(!1),T(null)},onRedeem:async(e,a)=>{if(t)try{p(!0);const s=[{account:"nft.hive",name:"boost",authorization:[{actor:t,permission:"active"}],data:{booster:t}},{account:a.contract,name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:a.fee,memo:"payfee"}},{account:"pixeljourney",name:"transfer",authorization:[{actor:t,permission:"active"}],data:{from:t,to:"rwax",quantity:`${e.rwax.redeemAmount.toFixed(8)} WPIXAL`,memo:"redeem"}},{account:"rwax",name:"redeem",authorization:[{actor:t,permission:"active"}],data:{redeemer:t,contract:"pixeljourney",quantity:`${e.rwax.redeemAmount.toFixed(8)} WPIXAL`,asset_id:e.assetId.toString(),fee_currency:`8,${a.symbol}`}}],i=await Ie.transact(s);n("Redemption transaction completed successfully!"),console.log("Redemption transaction result:",i),k(!1),T(null),De()}catch(s){K("Error during redemption","RWax",s),r("Redemption failed. Please try again.")}finally{p(!1)}else r("Please connect your wallet")}}),_&&C&&A.jsx("div",{className:"rwax-modal-overlay",onClick:Je,children:A.jsxs("div",{className:"rwax-modal-content rwax-wax-redeem-modal",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"rwax-modal-header",children:[A.jsx("h2",{children:"Pay with WAX"}),A.jsx("button",{className:"rwax-close-button",onClick:Je,children:"×"})]}),A.jsxs("div",{className:"rwax-modal-body",children:[A.jsxs("div",{className:"selected-asset",children:[A.jsx(Fe,{imageUrl:C.image,alt:C.name,className:"modal-asset-image"}),A.jsx("h3",{children:C.name}),Ye(C)&&A.jsxs(A.Fragment,{children:[A.jsxs("p",{className:"wpixal-required",children:["Required: ",C.rwax.redeemAmount.toFixed(8)," WPIXAL"]}),A.jsxs("p",{className:"wax-cost",children:["Cost: ",(C.rwax.redeemAmount*V).toFixed(4)," WAX"]}),A.jsxs("p",{className:"usd-cost",children:["USD: $",(C.rwax.redeemAmount*Y).toFixed(4)]})]})]}),"confirm"===$&&A.jsxs("div",{className:"wax-redeem-step",children:[A.jsx("h4",{children:"Step 1: Confirm WAX Payment"}),A.jsx("p",{className:"step-description",children:"This process will swap your WAX for WPIXAL via Alcor, then use that WPIXAL to redeem your NFT."}),A.jsxs("div",{className:"wax-calculator-section",children:[A.jsxs("div",{className:"available-wax",children:[A.jsx("h4",{children:"Your Available WAX"}),A.jsxs("div",{className:"wax-balance",children:[A.jsx("span",{className:"balance-amount",children:fe}),A.jsxs("span",{className:"balance-usd",children:["($",(parseFloat(fe.split(" ")[0])*se).toFixed(2)," USD)"]})]})]}),A.jsxs("div",{className:"wpixal-calculator",children:[A.jsx("h4",{children:"WPIXAL Calculator"}),A.jsxs("div",{className:"calculator-info",children:[A.jsx("p",{children:"With your available WAX, you can buy:"}),A.jsx("div",{className:"max-wpixal",children:A.jsxs("strong",{children:[V>0?(100/V).toFixed(4):"0.0000"," WPIXAL"]})}),A.jsx("div",{className:"rate-info",children:A.jsxs("small",{children:["Rate: 1 WPIXAL = ",V.toFixed(6)," WAX"]})})]}),A.jsxs("div",{className:"purchase-slider",children:[A.jsx("label",{children:"Amount to purchase:"}),A.jsx("input",{type:"range",min:"0",max:Math.min(100,V>0&&Ye(C)?C.rwax.redeemAmount*V:0),step:"0.0001",value:M?parseFloat(M):0,onChange:e=>R(parseFloat(e.target.value).toFixed(4)),className:"wpixal-slider"}),A.jsxs("div",{className:"slider-labels",children:[A.jsx("span",{children:"0 WAX"}),A.jsxs("span",{children:[Math.min(100,V>0&&Ye(C)?C.rwax.redeemAmount*V:0).toFixed(4)," WAX"]})]})]}),A.jsxs("div",{className:"purchase-summary",children:[A.jsxs("div",{className:"summary-row",children:[A.jsx("span",{children:"WPIXAL to buy:"}),A.jsxs("span",{children:[M?(parseFloat(M)/V).toFixed(4):"0.0000"," WPIXAL"]})]}),A.jsxs("div",{className:"summary-row",children:[A.jsx("span",{children:"WAX cost:"}),A.jsxs("span",{children:[M||"0.0000"," WAX"]})]}),A.jsxs("div",{className:"summary-row",children:[A.jsx("span",{children:"USD cost:"}),A.jsxs("span",{children:["$",M?(parseFloat(M)*se).toFixed(4):"0.0000"]})]})]})]})]}),A.jsxs("div",{className:"process-steps",children:[A.jsxs("div",{className:"step-item",children:[A.jsx("span",{className:"step-number",children:"1"}),A.jsx("span",{className:"step-text",children:"Swap WAX → WPIXAL via Alcor"})]}),A.jsxs("div",{className:"step-item",children:[A.jsx("span",{className:"step-number",children:"2"}),A.jsx("span",{className:"step-text",children:"Redeem NFT with WPIXAL"})]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"cancel-button",onClick:Je,children:"Cancel"}),A.jsx("button",{className:"confirm-button",onClick:async()=>{if(!(C&&t&&s&&Ye(C)))return void r("Missing required data for WAX redemption");const e=parseFloat(fe.split(" ")[0]),a=parseFloat(M);if(e<a)r(`Insufficient WAX balance. You have ${fe} but need ${a.toFixed(4)} WAX`);else try{p(!0),L("swap");const e=await Pa.executeSwap(M,t);n("Swap transaction prepared"),console.log("Swap transaction:",e),await new Promise(e=>setTimeout(e,2e3)),L("redeem");const a={fee:"0.00000000",contract:"eosio.token",exchange_rate:"1",symbol:"WAX",amount:"0.00000000"};if(!Ye(C))return void r("Selected asset is not a tokenized asset");const s=await Aa.executeRedemption(C.assetId.toString(),C.rwax.redeemAmount.toFixed(8)+" WPIXAL",a,t);n("Redemption transaction prepared"),console.log("Redemption transaction:",s),await new Promise(e=>setTimeout(e,2e3)),L("complete"),n("WAX redemption completed successfully!")}catch(i){K("Error during WAX redemption","RWax",i),r("WAX redemption failed. Please try again."),L("confirm")}finally{p(!1)}},disabled:!M||parseFloat(M)<=0||V<=0||!Ye(C)||parseFloat(M)/V>C.rwax.redeemAmount,children:"Buy WPIXAL & Redeem"})]})]}),"swap"===$&&A.jsxs("div",{className:"wax-redeem-step",children:[A.jsx("h4",{children:"Step 2: Swapping WAX to WPIXAL"}),A.jsxs("p",{className:"step-description",children:["Connecting to Alcor to swap ",M," WAX for WPIXAL..."]}),A.jsxs("div",{className:"swap-progress",children:[A.jsx("div",{className:"progress-spinner"}),A.jsx("p",{children:"Processing swap transaction..."})]}),A.jsx("div",{className:"modal-actions",children:A.jsx("button",{className:"cancel-button",onClick:Je,children:"Cancel"})})]}),"redeem"===$&&A.jsxs("div",{className:"wax-redeem-step",children:[A.jsx("h4",{children:"Step 3: Redeeming NFT"}),A.jsx("p",{className:"step-description",children:"Using WPIXAL to redeem your NFT..."}),A.jsxs("div",{className:"redeem-progress",children:[A.jsx("div",{className:"progress-spinner"}),A.jsx("p",{children:"Processing redemption transaction..."})]})]}),"complete"===$&&A.jsxs("div",{className:"wax-redeem-step",children:[A.jsx("h4",{children:"✅ Redemption Complete!"}),A.jsx("p",{className:"step-description success",children:"Your NFT has been successfully redeemed using WAX payment."}),A.jsx("div",{className:"modal-actions",children:A.jsx("button",{className:"confirm-button",onClick:()=>{Je(),De()},children:"Done"})})]})]})]})}),A.jsx("div",{className:"live-transactions-section",children:A.jsx(Fa,{limit:12,refreshInterval:3e4})}),D&&A.jsx("div",{className:"image-zoom-modal",onClick:()=>B(!1),children:A.jsxs("div",{className:"zoom-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsx("button",{className:"zoom-modal-close",onClick:()=>B(!1),children:"×"}),U&&A.jsxs(A.Fragment,{children:[A.jsx("img",{src:U.url,alt:U.name,className:"zoom-modal-image"}),A.jsx("div",{className:"zoom-modal-info",children:A.jsx("h3",{children:U.name})})]})]})}),X&&A.jsx("div",{className:"rwax-modal-overlay",onClick:()=>H(!1),children:A.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"rwax-modal-header",children:[A.jsx("h2",{children:"Purchase WPIXAL"}),A.jsx("button",{className:"rwax-close-button",onClick:()=>H(!1),children:"×"})]}),A.jsxs("div",{className:"rwax-modal-body",children:[A.jsxs("div",{className:"purchase-info",children:[A.jsxs("p",{children:["You want to purchase: ",A.jsxs("strong",{children:[q," WPIXAL"]})]}),A.jsxs("p",{children:["Estimated cost: ",A.jsxs("strong",{children:[(q*V).toFixed(4)," WAX"]})]}),A.jsxs("p",{children:["USD equivalent: ",A.jsxs("strong",{children:["$",(q*Y).toFixed(4)]})]})]}),A.jsxs("div",{className:"purchase-actions",children:[A.jsx("button",{className:"cancel-button",onClick:()=>H(!1),children:"Cancel"}),A.jsx("button",{className:"confirm-purchase-button",onClick:()=>{console.log("Purchase WPIXAL via Alcor DEX:",q),H(!1)},children:"Buy via Alcor DEX"})]})]})]})}),re&&ce&&A.jsx("div",{className:"rwax-modal-overlay",onClick:()=>le(!1),children:A.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"rwax-modal-header",children:[A.jsx("h2",{children:"Set Price Alert"}),A.jsx("button",{className:"rwax-close-button",onClick:()=>le(!1),children:"×"})]}),A.jsxs("div",{className:"rwax-modal-body",children:[ce&&A.jsxs("div",{className:"alert-asset-info",children:[A.jsx(Fe,{imageUrl:ce.image,alt:ce.name,className:"modal-asset-image"}),A.jsx("h3",{children:ce.name}),A.jsxs("p",{children:["Current Price: ",ce.rwax.redeemAmount.toFixed(8)," WPIXAL"]})]}),A.jsxs("div",{className:"alert-settings",children:[A.jsx("h4",{children:"Alert when price changes by:"}),A.jsx("div",{className:"percentage-options",children:[5,10,15,20,25].map(e=>A.jsxs("button",{className:"percentage-option "+(oe===e?"selected":""),onClick:()=>de(e),children:[e,"%"]},e))}),A.jsxs("div",{className:"custom-percentage",children:[A.jsx("label",{children:"Custom percentage:"}),A.jsx("input",{type:"number",min:"1",max:"100",value:oe,onChange:e=>de(parseInt(e.target.value)||10),className:"percentage-input"}),A.jsx("span",{children:"%"})]}),A.jsxs("div",{className:"alert-preview",children:[A.jsxs("p",{children:["You will be notified when the price moves ",oe,"% from the current value."]}),A.jsxs("div",{className:"price-thresholds",children:[A.jsxs("div",{className:"threshold-item",children:[A.jsx("span",{className:"threshold-label",children:"Alert above:"}),A.jsxs("span",{className:"threshold-value",children:[(ce.rwax.redeemAmount*(1+oe/100)).toFixed(4)," WPIXAL"]})]}),A.jsxs("div",{className:"threshold-item",children:[A.jsx("span",{className:"threshold-label",children:"Alert below:"}),A.jsxs("span",{className:"threshold-value",children:[(ce.rwax.redeemAmount*(1-oe/100)).toFixed(4)," WPIXAL"]})]})]})]})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"cancel-button",onClick:()=>le(!1),children:"Cancel"}),ce&&Re.has(ce.assetId.toString())&&A.jsx("button",{className:"remove-alert-button",onClick:()=>{ce&&(et(ce.assetId.toString()),le(!1))},children:"Remove Alert"}),A.jsx("button",{className:"confirm-button",onClick:()=>{ce&&(Ze(ce,oe),le(!1))},children:ce&&Re.has(ce.assetId.toString())?"Update Alert":"Set Alert"})]})]})]})}),ue&&A.jsx("div",{className:"rwax-modal-overlay",onClick:()=>me(!1),children:A.jsxs("div",{className:"rwax-modal-content",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"rwax-modal-header",children:[A.jsx("h2",{children:"WPIXAL Price Alert"}),A.jsx("button",{className:"rwax-close-button",onClick:()=>me(!1),children:"×"})]}),A.jsxs("div",{className:"rwax-modal-body",children:[A.jsxs("div",{className:"wpixal-alert-info",children:[A.jsx("h3",{children:"Set WPIXAL Price Alert"}),A.jsxs("div",{className:"current-wpixal-prices",children:[A.jsx("p",{children:"Current WPIXAL Price:"}),A.jsxs("div",{className:"price-display",children:[A.jsx("span",{className:"wax-price",children:V>0?`${V.toFixed(8)} WAX`:"Loading..."}),A.jsx("span",{className:"usd-price",children:Y>0?`($${Y.toFixed(6)} USD)`:""})]})]}),localStorage.getItem("wpixalPriceAlert")&&A.jsxs("div",{className:"existing-alert-info",children:[A.jsxs("p",{children:["Your Current Alert: ",localStorage.getItem("wpixalPriceAlert")," WAX"]}),A.jsx("p",{className:"price-comparison",children:V>0&&localStorage.getItem("wpixalPriceAlert")?`Current price is ${((V-parseFloat(localStorage.getItem("wpixalPriceAlert")))/parseFloat(localStorage.getItem("wpixalPriceAlert"))*100).toFixed(2)}% ${V>parseFloat(localStorage.getItem("wpixalPriceAlert"))?"above":"below"} your alert`:""})]}),A.jsx("p",{children:"Get notified when WPIXAL price drops below your target value"})]}),A.jsxs("div",{className:"alert-settings",children:[A.jsx("h4",{children:"Alert when WPIXAL price (in WAX) drops below:"}),A.jsxs("div",{className:"price-input-container",children:[A.jsx("input",{type:"number",step:"0.00000001",min:"0",value:he,onChange:e=>pe(e.target.value),placeholder:"Enter WAX amount",className:"price-alert-input"}),A.jsx("span",{className:"currency-label",children:"WAX"})]}),A.jsx("div",{className:"alert-preview",children:A.jsxs("p",{children:["You will be notified when WPIXAL price drops below ",he||"0"," WAX"]})})]}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"cancel-button",onClick:()=>me(!1),children:"Cancel"}),A.jsx("button",{className:"confirm-button",onClick:()=>{he&&parseFloat(he)>0&&(localStorage.setItem("wpixalPriceAlert",he),me(!1),pe(""),alert(`WPIXAL price alert set for ${he} WAX`))},disabled:!he||parseFloat(he)<=0,children:"Set Alert"})]})]})]})}),Z&&A.jsxs(A.Fragment,{children:[A.jsx("div",{className:"filter-sidebar-overlay",onClick:Ke}),A.jsxs("div",{className:"filter-sidebar",children:[A.jsxs("div",{className:"filter-sidebar-header",children:[A.jsx("h3",{children:"Advanced Filters"}),A.jsx("button",{className:"close-sidebar-btn",onClick:Ke,children:A.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),A.jsxs("div",{className:"filter-section",children:[A.jsx("h4",{children:"Price Range (WPIXAL)"}),A.jsxs("div",{className:"price-range-inputs",children:[A.jsx("input",{type:"number",placeholder:"Min",value:te.min,onChange:e=>ae(t=>({...t,min:e.target.value})),className:"price-input"}),A.jsx("span",{children:"to"}),A.jsx("input",{type:"number",placeholder:"Max",value:te.max,onChange:e=>ae(t=>({...t,max:e.target.value})),className:"price-input"})]})]}),A.jsx("div",{className:"filter-section",children:A.jsx(La,{onFiltersChange:ze,initialFilters:Ee})})]})]})]})},Ra=[{id:781515,pxj:1,wuf:22,pxjUpgrade:0,name:"Pixal PFP",type:"pixals"},{id:820134,pxj:2.22,wuf:5,pxjUpgrade:0,name:"Pixel Ingredient Pack",type:"pixelpack"},{id:858568,pxj:142,wuf:142,pxjUpgrade:0,name:"Black",type:"special"},{id:858569,pxj:.42,wuf:1,pxjUpgrade:0,name:"Blue",type:"primary ingredient"},{id:858570,pxj:.42,wuf:1,pxjUpgrade:0,name:"Red",type:"primary ingredient"},{id:858571,pxj:.42,wuf:1,pxjUpgrade:0,name:"Yellow",type:"primary ingredient"},{id:858572,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Green",type:"secondary ingredient"},{id:858573,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Orange",type:"secondary ingredient"},{id:858574,pxj:2.22,wuf:1,pxjUpgrade:25e3,name:"Purple",type:"secondary ingredient"},{id:858575,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Amber",type:"tertiary ingredient"},{id:858576,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Chartreuse",type:"tertiary ingredient"},{id:858577,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Violet",type:"tertiary ingredient"},{id:858578,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Teal",type:"tertiary ingredient"},{id:858580,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Vermillion",type:"tertiary ingredient"},{id:859273,pxj:14.2,wuf:14.2,pxjUpgrade:15e4,name:"Magenta",type:"tertiary ingredient"}],Wa=()=>{const[e,t]=a.useState("overview"),[s,n]=a.useState(!1),[i,r]=a.useState(.001),[l,c]=a.useState(5e-4),[o,d]=a.useState({ingredients:!0,governance:!0,collectibles:!0,overviewIngredients:!0}),u=e=>{const t=Ra.find(t=>t.id===e.resultTemplateId);if(!t)return{craftingCost:0,dailyEarnings:0,roiDays:0,profitMargin:0};const a=(e.ingredients.reduce((e,t)=>{const a=Ra.find(e=>e.id===t.templateId);return e+(a?a.pxj*t.quantity:0)},0)+t.pxjUpgrade)*i,s=24*t.pxj*i;return{craftingCost:a,dailyEarnings:s,roiDays:a>0?a/s:0,profitMargin:s>0?(s-a/365)/s*100+100:100}},m=a.useMemo(()=>{const e={special:[],"primary ingredient":[],"secondary ingredient":[],"tertiary ingredient":[],pixals:[],pixelpack:[]};return Ra.forEach(t=>{e[t.type]&&e[t.type].push(t)}),e},[]),h=()=>{n(!0)},p=e=>({858575:"http://pixeljourney.xyz/ingredients/Pixel_Amber_vid_25fps_300px.mp4",858576:"http://pixeljourney.xyz/ingredients/Pixel_Chartreuse_vid_25fps_300px.mp4",858577:"http://pixeljourney.xyz/ingredients/Pixel_Violet_vid_25fps_300px.mp4",858578:"http://pixeljourney.xyz/ingredients/Pixel_Teal_vid_25fps_300px.mp4",858580:"http://pixeljourney.xyz/ingredients/Pixel_Vermillion_vid_25fps_300px.mp4",859273:"http://pixeljourney.xyz/ingredients/Pixel_Magenta_vid_25fps_300px.mp4",858574:"http://pixeljourney.xyz/ingredients/Pixel_Purple_vid_25fps_300px.mp4",858573:"http://pixeljourney.xyz/ingredients/Pixel_Orange_vid_25fps_300px.mp4",858572:"http://pixeljourney.xyz/ingredients/Pixel_Green_vid_25fps_300px.mp4",858570:"http://pixeljourney.xyz/ingredients/Pixel_Red_vid_25fps_300px.mp4",858569:"http://pixeljourney.xyz/ingredients/Pixel_Blue_vid_25fps_300px.mp4",858571:"http://pixeljourney.xyz/ingredients/Pixel_Yellow_vid_25fps_300px.mp4",858568:"http://pixeljourney.xyz/ingredients/Pixel_Black_White_vid_25fps_300px.mp4"}[e.toString()]||`/img/ingredients/${e}.png`),f=e=>e.includes(".mp4")||e.includes(".webm");return A.jsxs("div",{className:"pxcrafting-container",children:[A.jsxs("div",{className:"pxcrafting-header",children:[A.jsx("h1",{children:"Pixel Ingredient Crafting"}),A.jsx("p",{className:"pxcrafting-subtitle",children:"Master the art of pixel ingredient crafting with comprehensive guides, ROI calculations, and staking insights."})]}),A.jsxs("div",{className:"pxcrafting-tabs",children:[A.jsx("button",{className:"tab-btn "+("overview"===e?"active":""),onClick:()=>t("overview"),children:"Overview"}),A.jsx("button",{className:"tab-btn "+("recipes"===e?"active":""),onClick:()=>t("recipes"),children:"Recipes"}),A.jsx("button",{className:"tab-btn "+("calculator"===e?"active":""),onClick:()=>t("calculator"),children:"ROI Calculator"}),A.jsx("button",{className:"tab-btn "+("staking"===e?"active":""),onClick:()=>t("staking"),children:"Staking Info"})]}),A.jsxs("div",{className:"pxcrafting-content",children:["overview"===e&&A.jsxs("div",{className:"overview-tab",children:[A.jsxs("div",{className:"overview-grid",children:[A.jsxs("div",{className:"overview-card",children:[A.jsx("h3",{children:"🎨 Crafting System"}),A.jsx("p",{children:"Create powerful pixel ingredients by combining primary colors into secondary and tertiary ingredients. Each tier offers increased staking rewards and unique properties."}),A.jsx("button",{className:"cta-button",onClick:()=>h(),children:"Start Crafting"})]}),A.jsxs("div",{className:"overview-card",children:[A.jsx("h3",{children:"💰 Staking Rewards"}),A.jsx("p",{children:"Stake your crafted ingredients to earn PXJ and WUF tokens. Higher tier ingredients provide significantly better returns on your investment."}),A.jsx("button",{className:"cta-button secondary",onClick:()=>t("staking"),children:"View Staking Info"})]}),A.jsxs("div",{className:"overview-card",children:[A.jsx("h3",{children:"📊 ROI Analysis"}),A.jsx("p",{children:"Calculate the return on investment for different crafting strategies. Optimize your crafting decisions with real-time profitability analysis."}),A.jsx("button",{className:"cta-button secondary",onClick:()=>t("calculator"),children:"Calculate ROI"})]})]}),A.jsx("div",{className:"main-staking-section",children:A.jsxs("div",{className:"main-staking-card",children:[A.jsx("h3",{children:"🏛️ Main Staking Platform"}),A.jsx("p",{children:"Visit the official Pixel Journey staking platform to stake all your NFT collectibles and earn rewards across the entire ecosystem."}),A.jsx("a",{href:"https://stake.pixeljourney.xyz",target:"_blank",rel:"noopener noreferrer",className:"main-staking-button",children:"Visit Staking Platform"})]})}),A.jsx("div",{className:"ingredient-tiers",children:A.jsxs("div",{className:"collapsible-section",children:[A.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,overviewIngredients:!e.overviewIngredients})),children:[A.jsx("h2",{children:"Staking Values"}),A.jsx("span",{className:"collapse-icon "+(o.overviewIngredients?"collapsed":""),children:"▼"})]}),!o.overviewIngredients&&A.jsxs("div",{className:"smart-tier-layout",children:[A.jsxs("div",{className:"tier-row tier-row-premium",children:[A.jsxs("div",{className:"tier-card pixelpack",children:[A.jsx("h4",{children:"Pixel Ingredient Pack"}),A.jsx("div",{className:"tier-ingredients",children:Ra.filter(e=>"pixelpack"===e.type).map(e=>{const t=p(e.id)||"https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif";return A.jsxs("div",{className:"ingredient-preview",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif"}}),A.jsxs("span",{children:[e.name," ",A.jsx("span",{className:"season-tag",children:"Season 1"})]}),A.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),A.jsxs("div",{className:"tier-card special",children:[A.jsx("h4",{children:"Special Ingredients"}),A.jsx("div",{className:"tier-ingredients",children:Ra.filter(e=>"special"===e.type).map(e=>{const t=p(e.id);return A.jsxs("div",{className:"ingredient-preview",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),A.jsxs("span",{children:[e.name," ",A.jsx("span",{className:"season-tag",children:"Season 1"})]}),A.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]})]}),A.jsxs("div",{className:"tier-row tier-row-standard",children:[A.jsxs("div",{className:"tier-card primary",children:[A.jsx("h4",{children:"Primary Ingredients"}),A.jsx("div",{className:"tier-ingredients",children:Ra.filter(e=>"primary ingredient"===e.type).map(e=>{const t=p(e.id);return A.jsxs("div",{className:"ingredient-preview",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),A.jsxs("span",{children:[e.name," ",A.jsx("span",{className:"season-tag",children:"Season 1"})]}),A.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),A.jsxs("div",{className:"tier-card secondary",children:[A.jsx("h4",{children:"Secondary Ingredients"}),A.jsx("div",{className:"tier-ingredients",children:Ra.filter(e=>"secondary ingredient"===e.type).map(e=>{const t=p(e.id);return A.jsxs("div",{className:"ingredient-preview",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),A.jsxs("span",{children:[e.name," ",A.jsx("span",{className:"season-tag",children:"Season 1"})]}),A.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]})]}),A.jsxs("div",{className:"tier-row tier-row-tertiary",children:[A.jsxs("div",{className:"tier-card tertiary",children:[A.jsx("h4",{children:"Tertiary Ingredients"}),A.jsx("div",{className:"tier-ingredients",children:Ra.filter(e=>"tertiary ingredient"===e.type).map(e=>{const t=p(e.id);return A.jsxs("div",{className:"ingredient-preview",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="/img/placeholder-ingredient.png",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),A.jsxs("span",{children:[e.name," ",A.jsx("span",{className:"season-tag",children:"Season 1"})]}),A.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})})]}),A.jsxs("div",{className:"tier-card collectibles",children:[A.jsx("h4",{children:"Collectibles"}),A.jsx("div",{className:"tier-ingredients",children:A.jsxs("div",{className:"sub-tier",children:[A.jsx("h5",{children:"PFPs"}),Ra.filter(e=>"pixals"===e.type).map(e=>{const t=p(e.id)||"https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp";return A.jsxs("div",{className:"ingredient-preview",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const a=document.createElement("img");a.src="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp",a.alt=e.name,t.currentTarget.parentNode?.appendChild(a)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp"}}),A.jsxs("span",{children:[e.name," ",A.jsx("span",{className:"season-tag",children:"Season 1"})]}),A.jsxs("small",{children:[e.pxj," PXJ/hr"]})]},e.id)})]})})]})]})]})]})})]}),"recipes"===e&&A.jsxs("div",{className:"recipes-tab",children:[A.jsxs("div",{className:"recipes-header",children:[A.jsx("h2",{children:"Crafting Recipes"}),A.jsxs("div",{className:"recipe-category-tabs",children:[A.jsx("button",{className:"recipe-tab active",children:"Ingredient"}),A.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Collectibles"}),A.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Event"}),A.jsx("button",{className:"recipe-tab disabled",title:"Coming Soon",children:"Governance"})]})]}),A.jsx("div",{className:"recipes-grid",children:xt.map((e,t)=>{const a=u(e),s=Ra.find(t=>t.id===e.resultTemplateId);return A.jsxs("div",{className:"recipe-card",children:[A.jsxs("div",{className:"recipe-header",children:[A.jsx("h3",{children:e.name}),A.jsx("span",{className:`tier-badge ${e.tier}`,children:e.tier})]}),A.jsxs("div",{className:"recipe-ingredients",children:[A.jsx("h4",{children:"Ingredients Required:"}),e.ingredients.map((e,t)=>{const a=Ra.find(t=>t.id===e.templateId),s=p(e.templateId);return A.jsxs("div",{className:"ingredient-requirement",children:[f(s)?A.jsx("video",{src:s,autoPlay:!0,loop:!0,muted:!0,onError:e=>{e.currentTarget.style.display="none";const t=document.createElement("img");t.src="/img/placeholder-ingredient.png",t.alt=a?.name||"Unknown",e.currentTarget.parentNode?.appendChild(t)}}):A.jsx("img",{src:s,alt:a?.name||"Unknown",onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}}),A.jsxs("span",{children:[e.quantity,"x ",a?.name||"Unknown"]})]},t)})]}),A.jsxs("div",{className:"recipe-result",children:[A.jsx("h4",{children:"Creates:"}),A.jsxs("div",{className:"result-item",children:[(()=>{const t=p(e.resultTemplateId);return f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:e=>{e.currentTarget.style.display="none";const t=document.createElement("img");t.src="/img/placeholder-ingredient.png",t.alt=s?.name||"Unknown",e.currentTarget.parentNode?.appendChild(t)}}):A.jsx("img",{src:t,alt:s?.name||"Unknown",onError:e=>{e.currentTarget.src="/img/placeholder-ingredient.png"}})})(),A.jsxs("span",{children:["1x ",s?.name||"Unknown"]})]})]}),A.jsxs("div",{className:"recipe-stats",children:[A.jsxs("div",{className:"stat",children:[A.jsx("label",{children:"Cost:"}),A.jsxs("span",{children:[a.craftingCost.toFixed(4)," WAX"]})]}),A.jsxs("div",{className:"stat",children:[A.jsx("label",{children:"Daily Earnings:"}),A.jsxs("span",{children:[a.dailyEarnings.toFixed(4)," WAX"]})]}),A.jsxs("div",{className:"stat",children:[A.jsx("label",{children:"ROI Period:"}),A.jsxs("span",{children:[a.roiDays.toFixed(1)," days"]})]})]}),A.jsx("button",{className:"craft-button",onClick:()=>{h()},children:"Craft This Recipe"})]},t)})})]}),"calculator"===e&&A.jsxs("div",{className:"calculator-tab",children:[A.jsx("h2",{children:"ROI Calculator"}),A.jsxs("div",{className:"price-inputs",children:[A.jsxs("div",{className:"input-group",children:[A.jsx("label",{children:"PXJ Price (WAX):"}),A.jsx("input",{type:"number",step:"0.0001",value:i,onChange:e=>r(parseFloat(e.target.value)||0)})]}),A.jsxs("div",{className:"input-group",children:[A.jsx("label",{children:"WUF Price (WAX):"}),A.jsx("input",{type:"number",step:"0.0001",value:l,onChange:e=>c(parseFloat(e.target.value)||0)})]})]}),A.jsx("div",{className:"roi-table",children:A.jsxs("table",{children:[A.jsx("thead",{children:A.jsxs("tr",{children:[A.jsx("th",{children:"Recipe"}),A.jsx("th",{children:"Tier"}),A.jsx("th",{children:"Crafting Cost"}),A.jsx("th",{children:"Daily Earnings"}),A.jsx("th",{children:"ROI Period"}),A.jsx("th",{children:"Profit Margin"})]})}),A.jsx("tbody",{children:xt.map((e,t)=>{const a=u(e);return A.jsxs("tr",{children:[A.jsx("td",{children:e.name}),A.jsx("td",{children:A.jsx("span",{className:`tier-badge ${e.tier}`,children:e.tier})}),A.jsxs("td",{children:[a.craftingCost.toFixed(4)," WAX"]}),A.jsxs("td",{children:[a.dailyEarnings.toFixed(4)," WAX"]}),A.jsxs("td",{children:[a.roiDays.toFixed(1)," days"]}),A.jsxs("td",{className:a.profitMargin>0?"positive":"negative",children:[a.profitMargin.toFixed(1),"%"]})]},t)})})]})})]}),"staking"===e&&A.jsxs("div",{className:"staking-tab",children:[A.jsx("h2",{children:"Staking Information"}),A.jsx("p",{className:"staking-description",children:"Stake your Pixel Journey NFTs to earn PXJ and WUF rewards. Use PXJ to infuse, upgrade, and unlock new journeys while earning returns over a 2-3 year period. Benefit from our yearly PXJ allocations (~25% of yearly inflation) that boost crafting incentives and reward active participants in the ecosystem."}),A.jsxs("div",{className:"staking-tiers",children:[A.jsxs("div",{className:"collapsible-section",children:[A.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,collectibles:!e.collectibles})),children:[A.jsx("h3",{children:"Collectibles"}),A.jsx("span",{className:"collapse-icon "+(o.collectibles?"collapsed":""),children:"▼"})]}),!o.collectibles&&A.jsx("div",{className:"tiers-grid",children:A.jsxs("div",{className:"tier-section",children:[A.jsx("h4",{className:"tier-title",children:"PFPs"}),A.jsx("div",{className:"tier-items",children:Ra.filter(e=>"pixals"===e.type).map(e=>{const t=p(e.id),a="https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp";return A.jsxs("div",{className:"tier-item",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const s=document.createElement("img");s.src=a,s.alt=e.name,t.currentTarget.parentNode?.appendChild(s)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),A.jsxs("div",{className:"tier-info",children:[A.jsx("h5",{children:e.name}),A.jsxs("div",{className:"tier-stats",children:[A.jsxs("span",{children:["PXJ: ",e.pxj]}),A.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&A.jsxs("span",{children:["Upgrade: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]})})]}),A.jsxs("div",{className:"collapsible-section",children:[A.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,ingredients:!e.ingredients})),children:[A.jsx("h3",{children:"Ingredients"}),A.jsx("span",{className:"collapse-icon "+(o.ingredients?"collapsed":""),children:"▼"})]}),!o.ingredients&&A.jsxs("div",{className:"tiers-grid",children:[m.pixelpack.length>0&&A.jsxs("div",{className:"tier-section",children:[A.jsx("h4",{className:"tier-title",children:"Pixel Ingredient Pack"}),A.jsx("div",{className:"tier-items",children:m.pixelpack.map(e=>{const t=p(e.id),a="https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif";return A.jsxs("div",{className:"tier-item",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const s=document.createElement("img");s.src=a,s.alt=e.name,t.currentTarget.parentNode?.appendChild(s)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),A.jsxs("div",{className:"ingredient-info",children:[A.jsx("h5",{children:e.name}),A.jsxs("div",{className:"ingredient-stats",children:[A.jsxs("span",{children:["PXJ: ",e.pxj]}),A.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&A.jsxs("span",{children:["Cost: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]}),Object.entries(m).filter(([e])=>"pixals"!==e&&"pixelpack"!==e).map(([e,t])=>A.jsxs("div",{className:"tier-section",children:[A.jsxs("h4",{className:"tier-title",children:[e.charAt(0).toUpperCase()+e.slice(1)," Ingredients"]}),A.jsx("div",{className:"tier-items",children:t.map(e=>{const t=p(e.id),a="pixelpack"===e.type?"https://pixeljourney.xyz/img/pixel_journey_pack_002_500x500.gif":"pixals"===e.type?"https://ipfs.io/ipfs/QmQKA9fxWBAsoDnMRZj1v1vsjwZeWZpHmnoEyujmeMi2rp":"/img/placeholder-ingredient.png";return A.jsxs("div",{className:"tier-item",children:[f(t)?A.jsx("video",{src:t,autoPlay:!0,loop:!0,muted:!0,onError:t=>{t.currentTarget.style.display="none";const s=document.createElement("img");s.src=a,s.alt=e.name,t.currentTarget.parentNode?.appendChild(s)}}):A.jsx("img",{src:t,alt:e.name,onError:e=>{e.currentTarget.src=a}}),A.jsxs("div",{className:"ingredient-info",children:[A.jsx("h5",{children:e.name}),A.jsxs("div",{className:"ingredient-stats",children:[A.jsxs("span",{children:["PXJ: ",e.pxj]}),A.jsxs("span",{children:["WUF: ",e.wuf]}),e.pxjUpgrade>0&&A.jsxs("span",{children:["Cost: ",e.pxjUpgrade.toLocaleString()," PXJ"]})]})]})]},e.id)})})]},e))]})]}),A.jsxs("div",{className:"collapsible-section",children:[A.jsxs("button",{className:"section-header",onClick:()=>d(e=>({...e,governance:!e.governance})),children:[A.jsx("h3",{children:"Governance NFTs"}),A.jsx("span",{className:"collapse-icon "+(o.governance?"collapsed":""),children:"▼"})]}),!o.governance&&A.jsx("div",{className:"coming-soon-content",children:A.jsx("p",{children:"Coming soon at next PixelDAO expansions"})})]})]})]})]}),A.jsx(yt,{isOpen:s,onClose:()=>n(!1),ingredient:null})]})},Oa=({alert:e,onClose:t})=>{const[s,n]=a.useState(!1),[i,r]=a.useState(!1),l=a.useCallback(()=>{r(!0),setTimeout(()=>{t()},300)},[t]);a.useEffect(()=>{const e=setTimeout(()=>n(!0),100),t=setTimeout(()=>{l()},8e3);return()=>{clearTimeout(e),clearTimeout(t)}},[l]);return A.jsx("div",{className:`price-alert-notification ${s&&!i?"visible":""} ${i?"closing":""}`,children:A.jsxs("div",{className:"notification-content",children:[A.jsxs("div",{className:"notification-header",children:[A.jsx("div",{className:"notification-icon",children:A.jsx("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:A.jsx("path",{d:"M15 17h5l-5 5-5-5h5v-5a7.5 7.5 0 1 0-15 0v5h5l-5 5-5-5h5v-5a12.5 12.5 0 1 1 25 0v5z"})})}),A.jsxs("div",{className:"notification-title",children:[A.jsx("h4",{children:"Price Alert"}),A.jsx("span",{className:"notification-time",children:(new Date).toLocaleTimeString()})]}),A.jsx("button",{className:"notification-close",onClick:l,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"notification-body",children:[A.jsx("div",{className:"nft-preview",children:A.jsx("img",{src:e.item.nft.image,alt:e.item.nft.name,onError:e=>{e.target.src="https://pixeljourney.xyz/img/toppixals/10.webp"}})}),A.jsxs("div",{className:"alert-details",children:[A.jsx("h5",{className:"nft-name",children:e.item.nft.name}),A.jsx("p",{className:"alert-message",children:e.message})]})]}),A.jsxs("div",{className:"notification-actions",children:[A.jsx("button",{className:"btn-secondary",onClick:l,children:"Dismiss"}),A.jsx("button",{className:"btn-primary",onClick:()=>{window.location.href="/watchlist",l()},children:"View Watchlist"})]})]})})},Da=()=>{const[e,t]=a.useState([]);a.useEffect(()=>{const e=e=>{t(t=>[...t,e.detail])};return window.addEventListener("priceAlert",e),()=>{window.removeEventListener("priceAlert",e)}},[]);return A.jsx("div",{className:"price-alert-manager",children:e.map((e,a)=>A.jsx(Oa,{alert:e,onClose:()=>(e=>{t(t=>t.filter((t,a)=>a!==e))})(a)},`${e.item.nft.asset_id}-${Date.now()}-${a}`))})},Ba=()=>{const{notifications:e,removeNotification:t,soundEnabled:s}=_e(),n=a.useRef(null),i=a.useRef({}),r=(e,t,a,s)=>{const n=e.sampleRate,i=n*a,r=e.createBuffer(1,i,n),l=r.getChannelData(0);for(let c=0;c<i;c++){const e=c/n;let a=0;switch(s){case"sine":a=Math.sin(2*Math.PI*t*e);break;case"square":a=Math.sign(Math.sin(2*Math.PI*t*e));break;case"triangle":a=2/Math.PI*Math.asin(Math.sin(2*Math.PI*t*e))}const i=Math.exp(5*-e);l[c]=a*i*.1}return r},l=a.useCallback(e=>{if(s&&n.current&&i.current[e])try{const t=n.current.createBufferSource();t.buffer=i.current[e],t.connect(n.current.destination),t.start()}catch(t){console.warn("Failed to play notification sound:",t)}},[s]);if(a.useEffect(()=>((async()=>{try{n.current=new(window.AudioContext||window.webkitAudioContext);const e={success:r(n.current,800,.1,"sine"),error:r(n.current,400,.2,"square"),warning:r(n.current,600,.15,"triangle"),info:r(n.current,500,.1,"sine")};i.current=e}catch(e){console.warn("Audio context initialization failed:",e)}})(),()=>{n.current&&n.current.close()}),[]),a.useEffect(()=>{if(e.length>0){const t=e[e.length-1];l(t.type)}},[e.length,e,l]),0===e.length)return null;return A.jsx("div",{className:"notification-container",children:e.map(e=>A.jsx("div",{className:`notification notification-${e.type}`,"data-notification-id":e.id,children:A.jsxs("div",{className:"notification-content",children:[A.jsxs("div",{className:"notification-header",children:[e.title&&A.jsx("h4",{className:"notification-title",children:e.title}),A.jsx("button",{className:"notification-close",onClick:()=>(e=>{const a=document.querySelector(`[data-notification-id="${e}"]`);a?(a.classList.add("removing"),setTimeout(()=>{t(e)},300)):t(e)})(e.id),"aria-label":"Close notification",children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsxs("div",{className:"notification-body",children:[A.jsxs("div",{className:"notification-icon",children:["success"===e.type&&A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),A.jsx("polyline",{points:"22,4 12,14.01 9,11.01"})]}),"error"===e.type&&A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),A.jsx("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]}),"warning"===e.type&&A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),A.jsx("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),A.jsx("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})]}),"info"===e.type&&A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("circle",{cx:"12",cy:"12",r:"10"}),A.jsx("path",{d:"M12 16v-4"}),A.jsx("path",{d:"M12 8h.01"})]})]}),A.jsxs("div",{className:"notification-message",children:[A.jsx("p",{children:e.message}),e.action&&A.jsx("button",{className:"notification-action",onClick:e.action.onClick,children:e.action.label})]})]})]})},e.id))})},Ua=()=>{const{confirmDialog:e,resolveConfirm:t}=_e();if(!e)return null;const a=()=>{t(!1)};return A.jsx("div",{className:"modal-overlay",onClick:a,children:A.jsxs("div",{className:"modal confirm-dialog",onClick:e=>e.stopPropagation(),children:[A.jsxs("div",{className:"modal-header",children:[A.jsx("h3",{children:e.title||"Confirm Action"}),A.jsx("button",{className:"modal-close",onClick:a,children:A.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:[A.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),A.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),A.jsx("div",{className:"modal-body",children:A.jsx("p",{children:e.message})}),A.jsxs("div",{className:"modal-actions",children:[A.jsx("button",{className:"btn-secondary",onClick:a,children:e.cancelText||"Cancel"}),A.jsx("button",{className:"btn-primary",onClick:()=>{t(!0)},children:e.confirmText||"Confirm"})]})]})})};class za extends a.Component{constructor(e){super(e),this.state={hasError:!1,retryCount:0}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){q.error("ErrorBoundary caught an error","ErrorBoundary",e,{componentStack:t.componentStack,errorBoundary:this.constructor.name}),this.props.onError&&this.props.onError(e,t),this.setState({error:e,errorInfo:t}),this.reportError(e,t)}reportError=async(e,t)=>{try{const a={message:e.message,stack:e.stack,componentStack:t.componentStack,timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,url:window.location.href};q.warn("Error Report generated","ErrorBoundary",a)}catch(a){q.error("Failed to report error","ErrorBoundary",a)}};handleRetry=()=>{const e=this.state.retryCount+1;e>3?q.warn("Maximum retry attempts reached","ErrorBoundary"):this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e})};render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=this.state.retryCount>=3;return A.jsx(st,{title:"Something went wrong",message:e?"Multiple errors occurred. Please refresh the page or contact support if the problem persists.":"An unexpected error occurred. Please try again or refresh the page.",onRetry:e?void 0:this.handleRetry,showRetry:!e})}return this.props.children}}class Xa extends a.Component{maxRetries=3;retryTimeouts=[];constructor(e){super(e),this.state={hasError:!1,retryCount:0,isRetrying:!1,errorCategory:"unknown"}}componentWillUnmount(){this.retryTimeouts.forEach(e=>clearTimeout(e))}static getDerivedStateFromError(e){const t=e.message.toLowerCase();let a="unknown";t.includes("fetch")||t.includes("network")||t.includes("connection")?a="network":t.includes("timeout")||t.includes("aborted")?a="timeout":(t.includes("http")||t.includes("api")||t.includes("failed to load"))&&(a="api");if(["network","api","timeout"].includes(a)||"ChunkLoadError"===e.name||"TypeError"===e.name&&t.includes("fetch"))return{hasError:!0,error:e,errorCategory:a};throw e}componentDidCatch(e,t){W.logError("APIErrorBoundary",e,{errorInfo:t,retryCount:this.state.retryCount,componentStack:t.componentStack}),this.setState({error:e,errorInfo:t}),this.props.onError&&this.props.onError(e,t)}handleRetry=()=>{if(this.state.retryCount>=this.maxRetries)return void console.warn("Max retries reached for API error boundary");const e=1e3*Math.pow(2,this.state.retryCount),t=.1*Math.random()*e,a=Math.min(e+t,3e4);this.setState({isRetrying:!0,lastRetryTime:Date.now()});const s=setTimeout(()=>{this.setState(e=>({hasError:!1,error:void 0,errorInfo:void 0,retryCount:e.retryCount+1,isRetrying:!1}))},a);this.retryTimeouts.push(s)};handleReset=()=>{this.setState({hasError:!1,error:void 0,errorInfo:void 0,retryCount:0})};render(){if(this.state.hasError){if(this.props.fallback)return this.props.fallback;const e=this.state.retryCount<this.maxRetries;let t;switch(this.state.errorCategory){case"network":t="NETWORK_ERROR";break;case"timeout":t="TIMEOUT_ERROR";break;case"api":t="API_ERROR";break;default:t="LOAD_FAILED"}return A.jsxs("div",{className:"error-boundary-container",children:[A.jsx(st,{errorType:t,onRetry:e?this.handleRetry:this.handleReset,showRetry:!0,isRetrying:this.state.isRetrying,retryCount:this.state.retryCount,maxRetries:this.maxRetries}),this.state.retryCount>0&&A.jsxs("div",{className:"error-retry-info",children:[A.jsxs("p",{children:["Retry attempt ",this.state.retryCount," of ",this.maxRetries]}),this.state.isRetrying&&A.jsxs("div",{className:"retry-progress",children:[A.jsx("div",{className:"retry-spinner"}),A.jsx("span",{children:"Retrying..."})]})]}),!1]})}return this.props.children}}const Ha=()=>{const{isConnected:e,account:t}=R();return a.useEffect(()=>{if(!e||!t)return;const a=setTimeout(async()=>{try{const e=`watchlist_last_check_${t}`,a=localStorage.getItem(e),s=a?parseInt(a):0,n=Date.now();if(n-s<3e5)return;const i=await Te.getWatchlist();if(0===i.length)return void localStorage.setItem(e,n.toString());const r=[];for(const t of i){const e=Te.getPriceAlert(t.nft.asset_id);if(e&&e.enabled&&e.lastTriggered&&e.lastTriggered>s){let a="";const s=t.lastPrice||parseFloat(t.nft.price||"0");switch(e.alertType){case"below":a=`${t.nft.name} price dropped to ${s.toFixed(2)} WAX (target: ${e.targetPrice} WAX)`;break;case"above":a=`${t.nft.name} price rose to ${s.toFixed(2)} WAX (target: ${e.targetPrice} WAX)`;break;case"any":{const e=Math.abs(t.priceChange||0),n=(t.priceChange||0)>0?"increased":"decreased";a=`${t.nft.name} price ${n} by ${e.toFixed(1)}% to ${s.toFixed(2)} WAX`;break}}r.push({alert:e,item:t,message:a,triggeredAt:e.lastTriggered})}}r.sort((e,t)=>t.triggeredAt-e.triggeredAt),r.forEach((e,t)=>{setTimeout(()=>{window.dispatchEvent(new CustomEvent("priceAlert",{detail:{item:e.item,message:e.message}}))},1e3*t)}),localStorage.setItem(e,n.toString()),r.length>0&&console.log(`Found ${r.length} triggered watchlist alerts since last visit`)}catch(e){console.error("Error checking watchlist alerts:",e)}},2e3);return()=>clearTimeout(a)},[e,t]),null},qa=()=>{const[e,t]=a.useState(null),[s,n]=a.useState(!1),[i,r]=a.useState(!1),[l,c]=a.useState(navigator.onLine),[o,d]=a.useState(!1);a.useEffect(()=>{(()=>{const e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");d(e),r(e)})();const e=e=>{e.preventDefault();t(e),n(!0)},a=()=>{r(!0),n(!1),t(null)},s=()=>c(!0),i=()=>c(!1);window.addEventListener("beforeinstallprompt",e),window.addEventListener("appinstalled",a),window.addEventListener("online",s),window.addEventListener("offline",i);const l=window.matchMedia("(display-mode: standalone)"),o=e=>{d(e.matches),r(e.matches)};return l.addEventListener?l.addEventListener("change",o):l.addListener(o),()=>{window.removeEventListener("beforeinstallprompt",e),window.removeEventListener("appinstalled",a),window.removeEventListener("online",s),window.removeEventListener("offline",i),l.removeEventListener?l.removeEventListener("change",o):l.removeListener(o)}},[]);return{isInstallable:s,isInstalled:i,isOnline:l,isStandalone:o,installPrompt:e,showInstallPrompt:async()=>{if(e)try{await e.prompt();const{outcome:a}=await e.userChoice;"accepted"===a?console.log("User accepted the install prompt"):console.log("User dismissed the install prompt"),t(null),n(!1)}catch(a){console.error("Error showing install prompt:",a)}},dismissInstallPrompt:()=>{t(null),n(!1)}}},Ja=({className:e=""})=>{const{isInstallable:t,isInstalled:a,isStandalone:s,showInstallPrompt:n,dismissInstallPrompt:i}=qa();return!t||a||s?null:A.jsx("div",{className:`pwa-install-banner ${e}`,role:"banner","aria-label":"Install app banner",children:A.jsxs("div",{className:"pwa-banner-content",children:[A.jsx("div",{className:"pwa-banner-icon",children:A.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[A.jsx("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",fill:"currentColor",fillOpacity:"0.1",stroke:"currentColor",strokeWidth:"1.5"}),A.jsx("path",{d:"M8 12l2 2 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),A.jsxs("div",{className:"pwa-banner-text",children:[A.jsx("h3",{className:"pwa-banner-title",children:"Install PxMarket"}),A.jsx("p",{className:"pwa-banner-description",children:"Get the full app experience with offline access and faster loading."})]}),A.jsxs("div",{className:"pwa-banner-actions",children:[A.jsxs("button",{type:"button",className:"pwa-install-button",onClick:n,"aria-label":"Install PxMarket app",children:[A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:A.jsx("path",{d:"M8 1v10M4 7l4 4 4-4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Install"]}),A.jsx("button",{type:"button",className:"pwa-dismiss-button",onClick:i,"aria-label":"Dismiss install banner",children:A.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:A.jsx("path",{d:"M12 4L4 12M4 4l8 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]})})},Va=({className:e=""})=>{const{isOnline:t}=qa();return t?null:A.jsx("div",{className:`offline-indicator ${e}`,role:"status","aria-live":"polite","aria-label":"You are currently offline",children:A.jsxs("div",{className:"offline-content",children:[A.jsx("div",{className:"offline-icon",children:A.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",children:[A.jsx("path",{d:"M3 7c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v6c0 1.1-.9 2-2 2H5c-1.1 0-2-.9-2-2V7z",stroke:"currentColor",strokeWidth:"1.5",fill:"none"}),A.jsx("path",{d:"M7 9l6 4M13 9l-6 4",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),A.jsxs("div",{className:"offline-text",children:[A.jsx("span",{className:"offline-title",children:"You're offline"}),A.jsx("span",{className:"offline-description",children:"Some features may be limited"})]}),A.jsx("div",{className:"offline-pulse","aria-hidden":"true"})]})})},Ga=()=>{const e=d(),[t,n]=a.useState("marketplace");s.useEffect(()=>{const t=e.pathname;"/"===t||"/marketplace"===t?n("marketplace"):"/rewards"===t?n("rewards"):"/inventory"===t?n("inventory"):"/packs"===t?n("packs"):t.startsWith("/collections")?n("collections"):"/activity"===t||"/stats"===t?n("activity"):"/staking"===t?n("staking"):"/profile"===t?n("profile"):"/watchlist"===t?n("watchlist"):"/auctions"===t?n("auctions"):"/learn"===t?n("learn"):"/journeymap"===t?n("journeymap"):"/pxcrafting"===t&&n("pxcrafting")},[e.pathname]);const i=e=>{n(e),window.history.pushState(null,"",`/${"marketplace"===e?"":e}`)};return A.jsxs("div",{className:"App",children:[A.jsx(Ee,{currentPage:t,onPageChange:i}),A.jsx("main",{id:"main-content",role:"main","aria-label":"Main content",className:"main-content",children:A.jsxs(u,{children:[A.jsx(m,{path:"/",element:A.jsx(Xa,{children:A.jsx(rt,{})})}),A.jsx(m,{path:"/marketplace",element:A.jsx(Xa,{children:A.jsx(rt,{})})}),A.jsx(m,{path:"/rewards",element:A.jsx(Xa,{children:A.jsx(lt,{onPageChange:i})})}),A.jsx(m,{path:"/inventory",element:A.jsx(Xa,{children:A.jsx(Et,{})})}),A.jsx(m,{path:"/packs",element:A.jsx(Xa,{children:A.jsx(ua,{})})}),A.jsx(m,{path:"/collections",element:A.jsx(Xa,{children:A.jsx(Ot,{})})}),A.jsx(m,{path:"/collections/:collectionName",element:A.jsx(Xa,{children:A.jsx(qt,{})})}),A.jsx(m,{path:"/collections/:collectionName/templates/:templateId",element:A.jsx(Xa,{children:A.jsx(Jt,{})})}),A.jsx(m,{path:"/assets/:assetId",element:A.jsx(Xa,{children:A.jsx(Vt,{})})}),A.jsx(m,{path:"/listings/:saleId",element:A.jsx(Xa,{children:A.jsx(Gt,{})})}),A.jsx(m,{path:"/transactions/:transactionId",element:A.jsx(Xa,{children:A.jsx(Kt,{})})}),A.jsx(m,{path:"/activity",element:A.jsx(Xa,{children:A.jsx(pa,{})})}),A.jsx(m,{path:"/stats",element:A.jsx(Xa,{children:A.jsx(pa,{})})}),A.jsx(m,{path:"/profile",element:A.jsx(Xa,{children:A.jsx(oa,{})})}),A.jsx(m,{path:"/profile/:account",element:A.jsx(Xa,{children:A.jsx(da,{})})}),A.jsx(m,{path:"/user-profile-lookup",element:A.jsx(Xa,{children:A.jsx(da,{})})}),A.jsx(m,{path:"/watchlist",element:A.jsx(Xa,{children:A.jsx(ma,{})})}),A.jsx(m,{path:"/auctions",element:A.jsx(Xa,{children:A.jsx(xa,{})})}),A.jsx(m,{path:"/auctions/:id",element:A.jsx(Xa,{children:A.jsx(ga,{})})}),A.jsx(m,{path:"/learn",element:A.jsx(Xa,{children:A.jsx(va,{})})}),A.jsx(m,{path:"/journeymap",element:A.jsx(Xa,{children:A.jsx(ya,{})})}),A.jsx(m,{path:"/staking",element:A.jsx(Xa,{children:A.jsx(Ca,{})})}),A.jsx(m,{path:"/rwax",element:A.jsx(Xa,{children:A.jsx(Ma,{})})}),A.jsx(m,{path:"/pxcrafting",element:A.jsx(Xa,{children:A.jsx(Wa,{})})})]})}),A.jsx(ha,{})]})};function Ka(){return s.useEffect(()=>{me.trackEvent("app_initialized",{timestamp:Date.now(),userAgent:navigator.userAgent,viewport:{width:window.innerWidth,height:window.innerHeight}}),Ce.initialize().then(()=>{V("Accessibility service ready","App"),me.trackEvent("accessibility_service_ready",{preferences:Ce.getPreferences()})}).catch(e=>{K("Failed to initialize accessibility service","App",e),me.reportError(e,"accessibility_init_error")}),Pe.initialize().then(e=>{e?(V("Push notification service initialized successfully","App"),me.trackEvent("push_service_ready",{supported:Pe.getPermissionState().supported})):G("Push notification service initialization failed","App")}).catch(e=>{K("Push notification service initialization error","App",e),me.reportError(e,"push_service_init_error")}),ae.preloadConfiguration().then(()=>{V("Marketplace configuration preloaded successfully","App"),me.trackEvent("marketplace_config_preloaded",{timestamp:Date.now()})}).catch(e=>{G("Failed to preload marketplace configuration","App",{error:e}),me.reportError(e,"marketplace_config_preload_error")})},[]),A.jsx(za,{children:A.jsx(kt,{children:A.jsx(de,{children:A.jsxs(ke,{children:[A.jsx(o,{children:A.jsx(Ga,{})}),A.jsx(Ha,{}),A.jsx(Da,{}),A.jsx(Ba,{}),A.jsx(Ua,{}),A.jsx(Xt,{}),A.jsx(Ja,{}),A.jsx(Va,{})]})})})})}L.createRoot(document.getElementById("root")).render(A.jsx(a.StrictMode,{children:A.jsx(Ka,{})}));
